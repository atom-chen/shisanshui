{"version":3,"sources":["CardTypeCombine.js"],"names":["KQCard","require","KQCardFindTypeExtension","AudioManager","play","KQCardScoretsHelper","cc","Class","extends","Component","statics","instances","properties","cardsLayout","Layout","btnDeleteTouDao","Button","btnDeleteZhongDao","btnDeleteWeiDao","btnCancelAll","btnDone","timeNode","Node","labelTime","Label","layoutTouDao","layoutZhongDao","layoutWeiDao","cardAllNode","cardPrefab","Prefab","cardTypePrefab","touDaoNode","zhongDaoNode","weiDaoNode","autoCardScrollView","ScrollView","autoCard","autoCardLayout","autoCardAnimation","LayoutWithEvent","BtnClickGongXiNiComfirm","cardsLayoutSortColor","_cardOffsetY","_kqCardModes","_allCardModes","_findCardTypeObject","_findCardIndex","_finishSelectCardsCallback","onLoad","_registerTouchEvents","_registerDaosLayoutClickEvent","reset","cardTime","cardSpriteAtlas","node","parent","getComponent","daoSpriteAtlas","onClickCardTypeCombineNode","_resetCardsPositionY","_hideDeleteButtons","clearCards","timeStop","cardsLayoutSort","e","nodeAyy","target","children","active","_resetCardsPositionX","addCards","cardNames","assert","forEach","card","index","addCard","bind","_reloadKQCardModesInner","_resetTypeButtonEnablesWithModels","cardName","autoChangePositionX","length","instantiate","name","setCard","addChild","setPositionY","addCardModes","newCard","push","reloadCards","log","removeAllChildren","removeCard","getChildByName","removeFromParent","setFinishSelectCardsCallback","callback","_typeButtons","cardModes","_stickOutFindCardType","title","findMethods","clickDuiZi","findDuiZi","clickLiangDui","findLiaDui","clickSanTiao","findSanTiao","clickShunZi","findShunZi","clickTongHua","findTongHua","clickHuLu","findHuLu","clickTieZhi","findTieZhi","clickWuTong","findWuTong","clickTongHuaShun","findTongHuaShun","clickCancelAll","clickDeleteTouDao","clickDeleteZhongDao","clickDeleteWeiDao","clickDone","sys","localStorage","removeItem","cardAlls","sort","a","b","y","map","i","touCardModels","_taoDaoCardModes","zhongCardModes","_zhongDaoCardModes","weiCardModes","_weiDaoCardModes","_didSelectedCards","onBtnGongXiNiComfirmClick","cards","teShuPaiCards","concat","teShuPaiCardsServerInfo","_convertCardsToServerModel2","result","touCards","zhongCards","weiCards","touServerInfo","_convertCardsToServerModel","zhongServerInfo","weiServerInfo","value","opacity","runAction","moveTo","p","scheduleOnce","action","spawn","fadeOut","_deleteDaoCardsOfLayout","timeStart","duration","timestamp","getItem","now","Date","parse","time","Math","floor","setItem","_timeRemainDuration","string","String","setTime","schedule","_timeMethod","unschedule","remain","max","chaoShiChuPai","_timeOutAutoSelectCards","gongXiNiShow","arr","slice","_cacleAutoSelectedCards","filter","resultCards","cardss","autoSelectCards","kq_excludes","type","cardsType","scoreOfCards","_typeCardsSortByNumberOfPoints1","convertToServerCards","cardMode","_typeCardsSortByNumberOfPoints","cardsFromArray","cca","point","number","suit","color","TYPE","SanTaoHua","moshi","isContainExtra","_isContainExtraCardsType","containTongHuaShun","SanShunZi","LiuDuiBan","containTieZhi","cacleAutoSelectedCardsIndex","testFind","s","j","cacleAutoSelectedCardsArray","indexs","selectedCard","cacleAutoSelectedCards2","cardsArray","resultArray","qwer","d","sC","a1","a2","cardsqe","ii","q","cardsq","splice","sortByPoint","card11","pop","cardss1","indexasdf","cardsTypeNames","resultArrays","typeName0","cardsTypeName","indexOf","touScore","zhongScore","weiScore","b0","parseInt","b1","b2","s0","s1","s2","scores","card20","contain20","asdf1","asdf2","asdf3","scrollToLeft","cardsNode","_setCardDaoSprite","cardArray","eventHandler","EventHandler","component","handler","customEventData","clickEvents","autoSelectedCardsOne","nodes","num","numBer","nodds1","anchorY","addComponent","Sprite","_cardModel","btnSprites","spriteFrame","maPai","nodds","loader","loadRes","SpriteFrame","err","error","message","btnSprite1","width","height","path","_loadCardFrame","clickAutoSelectedCards","event","instance","playPokerClick","Color","interactable","stopAllActions","detail","changeNodeSpaceAR","call","callFunc","sequence","SpritesNode","w","h","getSpriteFrame","stickOutFindCardType1","_touchCardLayout","_touchCardLayoutEnd","_cardPrefabInCardLayoutWithLocation","location","_changeSelectedCardPrefabsY","_changeCardPrefabsY","cardNodes","_selectedCardPrefabs","includeStickOut","_diseclectCardPrefabs","resetCardsPositionX1","cardBackWorldSpace1","convertToWorldSpaceAR","v2","convertToNodeSpaceAR","clickAllCard","unshift","typeName1","typeName2","n","_setGuiCard","_clickTouDaoLayout","_daoCardNodeInLayoutWithEvent","_clickZhongDaoLayout","_clickWeiDaoLayout","getLocation","cardNode","rect","getBoundingBox","rectContainsPoint","arrs","node1","node2","cardBackWorldSpace","_addDaoCardToLayout","maxNumberCard","_deleteDaoCard","cardTypeNode","reloadTypeButtonEnables","daoLayout","_isValidCardModes","touCardModes","_cardModesOfCardPrefabs","cardTypeNodes","_autoActiveDeleteDaoButtons","_autoActiveDeleteDaoButton","layout","button","_autoActiveTypeButtons"],"mappings":"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","file":"CardTypeCombine.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const KQCard = require('KQCard');\nconst KQCardFindTypeExtension = require('KQCardFindTypeExtension');\nconst AudioManager = require('AudioManager');\nconst play = require('play');\nconst KQCardScoretsHelper = require('KQCardScoretsHelper');\n// 牌类型 component\n//\ncc.Class({\n    extends: cc.Component,\n    statics: {\n        instances: null,\n    },\n    properties: {\n        cardsLayout: cc.Layout,\n        // btnDuiZi: cc.Button,\n        // btnLiangDui: cc.Button,\n        // btnSanTiao: cc.Button,\n        // btnShunZi: cc.Button,\n        // btnTongHua: cc.Button,\n        // btnHuLu: cc.Button,\n        // btnTieZhi: cc.Button,\n        // btnTongHuaShun: cc.Button,\n        // btnWuTong: cc.Button,\n        // typeButtonsNode: cc.Node,\n        btnDeleteTouDao: cc.Button,   // 头道\n        btnDeleteZhongDao: cc.Button, // 中道\n        btnDeleteWeiDao: cc.Button,   // 尾道\n        btnCancelAll: cc.Button,      // 全部取消\n        btnDone: cc.Button,           // 确定出牌\n        timeNode: cc.Node,\n        labelTime: cc.Label,\n        layoutTouDao: cc.Layout,\n        layoutZhongDao: cc.Layout,\n        layoutWeiDao: cc.Layout,\n        cardAllNode:cc.Node,\n        cardPrefab: cc.Prefab,\n        cardTypePrefab: cc.Prefab,\n\n        touDaoNode:cc.Node,\n        zhongDaoNode:cc.Node,\n        weiDaoNode:cc.Node,\n\n        autoCardScrollView: cc.ScrollView,\n        autoCard: cc.Prefab,\n        autoCardLayout: cc.Layout,\n        autoCardAnimation:cc.Node,\n\n\n        LayoutWithEvent: [],\n\n        BtnClickGongXiNiComfirm:false,  //用于检查用户是否点击了恭喜你页面的确定按钮\n        cardsLayoutSortColor: false,\n        /*#####*/\n\n        _cardOffsetY: null,\n\n        _kqCardModes: [],\n        _allCardModes: [],\n        _findCardTypeObject: null,  // 用来记录找到的牌型对象\n        _findCardIndex: null,  // 用来记录找到的牌型对象\n\n        _finishSelectCardsCallback: null,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.BtnClickGongXiNiComfirm = false;\n        this.cardsLayoutSortColor = false;\n        this._cardOffsetY = 0;\n        this._registerTouchEvents();\n        this._registerDaosLayoutClickEvent();\n        this.reset();\n        this._findCardIndex = {};\n        this.cardTime = 0.3;\n\n        this.cardSpriteAtlas = this.node.parent.getComponent('play').cardSpriteAtlas;\n        this.daoSpriteAtlas = this.node.parent.getComponent('play').daoSpriteAtlas;\n    },\n\n    /*#####点击空白地方将牌收回去*/\n    onClickCardTypeCombineNode: function () {\n        this._resetCardsPositionY();\n    },\n\n    _hideDeleteButtons: function () {\n        //this.btnDeleteTouDao.node.active = false;\n        //this.btnDeleteZhongDao.node.active = false;\n        //this.btnDeleteWeiDao.node.active = false;\n    },\n\n    // 重置，回到最初始有状态\n    reset: function () {\n        this._hideDeleteButtons();\n        this.clearCards();\n        this.timeStop();\n        //this._typeButtons().forEach(function (button) {\n        //    button.interactable = false;\n        //});\n        this._allCardModes = [];\n    },\n\n    cardsLayoutSort: function (e) {\n        var nodeAyy = e.target.children;\n        if(nodeAyy[0].active == true){//按大小\n            this.cardsLayoutSortColor = true;\n            nodeAyy[0].active = false;\n            nodeAyy[1].active = true;\n            this._resetCardsPositionX();\n            return;\n        }\n        else if(nodeAyy[1].active == true){//按花色\n            this.cardsLayoutSortColor = false;\n            nodeAyy[0].active = true;\n            nodeAyy[1].active = false;\n            this._resetCardsPositionX();\n        }\n        //this.cardsLayoutSortColor = nodeAyy[1].active == false;\n        //this.cardsLayoutSortColor == true\n    },\n\n    addCards: function (cardNames) {\n        cc.assert(cardNames);\n        this._resetCardsPositionY();\n        //cardNames.sort(function(a1,a2){\n        //    return a1.split('_')[0] - a2.split('_')[0];\n        //})\n        cardNames.forEach(function(card,index){\n            this.addCard(card,false,index)\n        }.bind(this));\n        //this.cardsLayoutSort();\n        this._resetCardsPositionX();\n        this._reloadKQCardModesInner();\n        this._resetTypeButtonEnablesWithModels(this._kqCardModes);\n    },\n\n    addCard: function (cardName, autoChangePositionX = false,index = null) {\n        cc.assert(cardName.length > 0);\n\n        let cardPrefab = cc.instantiate(this.cardPrefab);\n        cardPrefab.name = cardName;\n        // if(cc.maPai){\n        //     var cardMaPai = '3_' + cc.maPai;\n        //     if(cardName == cardMaPai){\n        //         cardPrefab.color = new cc.Color(226, 145, 145);\n        //     }\n        // }\n        cardPrefab.getComponent('CardPrefab').setCard(cardName,index);\n        this.cardsLayout.node.addChild(cardPrefab);\n        cardPrefab.setPositionY(this._cardOffsetY);\n\n        if (autoChangePositionX) {\n            this._resetCardsPositionX();\n        }\n        //let newCard = new KQCard(cardName,null,index);\n        //let originCard = this._allCardModes.find(function(card) {\n        //    return card.isEqual(newCard);\n        //});\n        //if (originCard == null && !autoChangePositionX) {\n        //    this._allCardModes.push(newCard);\n        //}\n    },\n\n    addCardModes: function (cardNames) {\n        cc.assert(cardNames.length > 0);\n        this._allCardModes = [];\n        cardNames.forEach(function(cardName,index){\n            let newCard = new KQCard(cardName,null,index);\n            this._allCardModes.push(newCard);\n        }.bind(this));\n    },\n\n    reloadCards: function (cardNames) {\n        //cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];\n        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];\n        //三度同花\n        // cardNames=['2_13', '2_5', '2_7', '3_1', '3_2', '3_4', '3_3', '3_13', '1_12', '1_6', '1_1', '1_4', '1_5'];\n        //三同花顺\n        //  cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '4_1', '4_2', '4_3'];\n        //一条龙\n        // cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '1_11', '1_12', '1_13'];\n        //三顺子\n        //cardNames=['4_1', '3_2', '4_3', '1_7', '4_5', '4_6', '3_9', '4_8', '3_1', '1_13', '4_12', '4_11', '2_10'];\n        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_9', '3_9', '4_8', '3_10', '1_13', '4_12', '4_11', '2_10'];\n        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_5', '3_6', '4_8', '3_6', '1_13', '4_12', '4_11', '2_7'];\n        //cardNames=['3_4', '3_4', '4_6', '2_20', '1_20', '1_20', '3_6', '4_8', '3_6', '1_8', '4_12', '4_11', '2_20'];\n        //三丰天下\n        //cardNames=['1_1', '2_1', '3_1', '1_2', '2_2', '3_2', '4_1', '4_2', '3_3', '2_3', '1_3', '4_3', '1_13'];\n        //4丰天下\n        // cardNames=['1_1', '2_1', '3_1', '1_4', '2_4', '3_2', '4_2', '1_2', '3_4', '2_3', '1_3', '4_3', '1_2'];\n        //六岁半\n        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];\n        //cardNames=['1_9', '2_11', '3_8', '1_12', '2_2', '3_2', '1_13', '2_5', '3_5','1_4', '2_4', '3_4', '3_10'];\n        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];\n        //   cardNames=['4_2', '2_3', '3_4', '3_5', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];\n        //cardNames=['4_1', '2_1', '1_4', '3_4', '1_6', '2_6', '1_8', '3_8', '2_8','2_12', '1_12', '2_13', '3_13'];\n        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_8', '2_9', '2_10', '2_11', '2_13','3_13', '3_12', '2_12', '1_12'];\n        // cardNames=['4_9', '2_9', '3_4', '3_6', '1_8', '2_1', '2_5', '2_4', '2_3','3_13', '3_12', '2_2', '1_12'];\n        //cardNames=['3_2', '4_2', '2_4', '3_5', '1_5', '3_7', '2_7', '3_10', '2_1','2_13', '2_10', '2_12', '2_11'];\n        //cardNames=['4_2', '4_3', '4_4', '4_5', '4_5', '4_6', '4_12', '4_13', '2_12','3_12', '2_8', '3_8', '2_11'];\n        //cardNames=['4_3', '1_3', '4_5', '4_5', '3_5', '2_5', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];\n        //cardNames=['4_3', '1_3', '4_5', '4_5', '2_20', '1_20', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];\n        //cardNames=['4_3', '3_4', '4_6', '4_5', '2_7', '1_20', '1_3', '4_4', '3_6','4_7', '4_8', '2_12', '1_12'];\n        cc.log(cardNames)\n        this.clearCards();\n        this._kqCardModes = [];\n        this.addCards(cardNames);\n    },\n\n    clearCards: function () {\n        this.cardsLayout.node.removeAllChildren();\n        this.layoutTouDao.node.removeAllChildren();\n        this.layoutZhongDao.node.removeAllChildren();\n        this.layoutWeiDao.node.removeAllChildren();\n    },\n\n    removeCard: function (cardName) {\n        if (!cardName.length) {\n            return;\n        }\n\n        this.cardsLayout.node.getChildByName(cardName).removeFromParent();\n    },\n\n    setFinishSelectCardsCallback: function (callback) {\n        this._finishSelectCardsCallback = callback;\n        this.node.active = false;\n    },\n\n    _reloadKQCardModesInner: function () {\n        //this._kqCardModes = this.cardsLayout.node.children.map(function (cardPrefabNode) {\n        //    let cardPrefab = cardPrefabNode.getComponent('CardPrefab');\n        //    return cardPrefab.cardMode();\n        //}).sort(KQCard.sort);\n        //this._findCardTypeObject = null;\n    },\n\n    _typeButtons: function () {\n        //return [\n        //    this.btnDuiZi,\n        //    this.btnLiangDui,\n        //    this.btnSanTiao,\n        //    this.btnShunZi,\n        //    this.btnTongHua,\n        //    this.btnHuLu,\n        //    this.btnTieZhi,\n        //    this.btnTongHuaShun,\n        //    /*#####*/\n        //    //this.btnWuTong,\n        //    /*#####*/\n        //];\n    },\n\n    _resetTypeButtonEnablesWithModels: function (cardModes) {\n        /*cardModes.length == 13*/\n        //cardModes = cardModes || this._kqCardModes;\n        //\n        ///*#####初始化牌*/\n        //var ButtonsLayoutChilds = this.typeButtonsNode.children;\n        //for(var i=0;i<ButtonsLayoutChilds.length;i++){\n        //    ButtonsLayoutChilds[i].interactable = false;\n        //}\n        //\n        //this.btnDuiZi.interactable = KQCard.containDuiZi(cardModes);\n        //this.btnLiangDui.interactable = KQCard.containLiaDui(cardModes);\n        //this.btnSanTiao.interactable = KQCard.containSanTiao(cardModes);\n        //this.btnShunZi.interactable = KQCard.containShunZi(cardModes);\n        //this.btnTongHua.interactable = KQCard.containTongHua(cardModes);\n        //this.btnHuLu.interactable = KQCard.containHuLu(cardModes);\n        //this.btnTieZhi.interactable = KQCard.containTieZhi(cardModes);\n        //this.btnTongHuaShun.interactable = KQCard.containTongHuaShun(cardModes);\n        ////this.btnWuTong.interactable = KQCard.containWuTong(cardModes);\n        ////KQCard.isTeShuPai(cardModes)\n        ////let typeName = KQCard.cardsTyp-eName(cardModes);\n        ////KQCard.isLiuDuiBan(cardModes);\n        ////alert(this.btnShunZi.interactable)\n        ///*#####如果有多一色，就是设置无同按钮的可交互性*/\n        ////if(cc.duoYiSe == 0) {\n        ////    this.wuTongNode = this.typeButtonsNode.getChildByName(\"btnWuTong\");\n        ////    this.btnWuTong = this.wuTongNode.getComponent(cc.Button);\n        ////    this.btnWuTong.interactable = KQCard.containWuTong(cardModes);\n        ////}\n        ///*#####*/\n        //\n        //this._autoActiveTypeButtons();\n        //\n        ///*#####设置按钮可交互和不可交互时的透明度*/\n        //for(var i=0;i<ButtonsLayoutChilds.length;i++){\n        //    if(ButtonsLayoutChilds[i].getComponent(cc.Button).interactable){\n        //        ButtonsLayoutChilds[i].opacity = 255;\n        //    }else{\n        //        ButtonsLayoutChilds[i].opacity = 125;\n        //    }\n        //}\n    },\n\n    // 将找到了牌类型的牌突出出来\n    _stickOutFindCardType: function (title, findMethods) {\n\n        // 先根据牌类型找出所有的索引集合\n        //var findedIndexsArray = null;\n        //this._findCardTypeObject = this._findCardTypeObject || {};\n        //if (this._findCardTypeObject.title != title) {\n        //    findedIndexsArray = (findMethods() || []).reverse();\n        //\n        //    for(var i =0;i<findedIndexsArray.length-1;i++){//删除同类型牌\n        //        var index = findedIndexsArray[i];\n        //        /*if(title == 'liangDui'){\n        //         let jStringspoint = index.map(function(indexs){\n        //         return this._kqCardModes[indexs].point;\n        //         }.bind(this));\n        //         var isBreak = false;\n        //         var repNum = jStringspoint.reduce(function(p,n){\n        //         if(!p[n]){\n        //         p[n] = 1;\n        //         }else{\n        //         p[n] += 1\n        //         }\n        //         return p\n        //         },{});\n        //         for(var y in repNum){\n        //         if(repNum[y] >= 3){\n        //         isBreak = true;\n        //         }\n        //         }\n        //         if(isBreak){\n        //         cc.log(repNum)\n        //         cc.log(findedIndexsArray)\n        //         cc.log(i)\n        //         cc.log('--------291')\n        //         findedIndexsArray.splice(i,1);\n        //         continue;\n        //         }\n        //         }*/\n        //        var iString = '';\n        //        for(var j =i+1;j<findedIndexsArray.length;j++){\n        //            var s = findedIndexsArray[j];\n        //            var jString = '';\n        //\n        //            let iStrings = s.map(function(index){\n        //                let cardModel = this._kqCardModes[index];\n        //                return cardModel.cardName();\n        //            }.bind(this));\n        //\n        //            let jStrings = index.map(function(indexs){\n        //                let cardModel = this._kqCardModes[indexs];\n        //                return cardModel.cardName();\n        //            }.bind(this));\n        //\n        //\n        //            for(var r = 0;r < index.length;r++){\n        //                jString = jString + iStrings[r];\n        //                iString = iString + jStrings[r];\n        //            }\n        //\n        //            if(jString == iString){\n        //                findedIndexsArray.splice(i,1);\n        //                break;\n        //            }\n        //        }\n        //    }\n        //\n        //    this._findCardTypeObject = {\n        //        title: title,\n        //        indexsArray: findedIndexsArray,\n        //        //index: title==\"duiZi\"?findedIndexsArray.length-1:0\n        //        index: 0\n        //    };\n        //}\n        //\n        //findedIndexsArray = this._findCardTypeObject.indexsArray;\n        //if (!findedIndexsArray || findedIndexsArray.length == 0) {\n        //    return;\n        //}\n        //// 将已有的突出的牌的位置重置回初始位置\n        //this._resetCardsPositionY();\n        //\n        //// 计算出要突出的牌数组\n        //var index = this._findCardTypeObject.index;\n        //let indexs = findedIndexsArray[index];\n        //\n        //let selectedCardNames = indexs.map(function(index){\n        //    let cardModel = this._kqCardModes[index];\n        //    return cardModel.cardName();\n        //}.bind(this));\n        //\n        //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {\n        //    let cardPrefab = cardNode.getComponent('CardPrefab');\n        //    if(selectedCardNames.includes(cardPrefab.cardName())) {\n        //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());\n        //        selectedCardNames.splice(nameIndex,1);\n        //        return true;\n        //    }\n        //    return false;\n        //});\n\n        //// 突出计算出来的牌数组\n        //this._changeCardPrefabsY(cardNodes);\n        //// 保存好，用于再次点击了突出下一组牌\n        //index = (index + 1) % findedIndexsArray.length;\n        //this._findCardTypeObject.index = index;\n    },\n\n    clickDuiZi: function () {\n        this._stickOutFindCardType(\"duiZi\", function () {\n            return KQCard.findDuiZi(this._kqCardModes);\n        }.bind(this));\n    },\n\n    clickLiangDui: function () {\n        this._stickOutFindCardType(\"liangDui\", function () {\n            return KQCard.findLiaDui(this._kqCardModes);\n        }.bind(this));\n    },\n\n    clickSanTiao: function () {\n        this._stickOutFindCardType(\"sanTiao\", function () {\n            return KQCard.findSanTiao(this._kqCardModes);\n        }.bind(this));\n    },\n\n    clickShunZi: function () {\n        this._stickOutFindCardType(\"shunZi\", function () {\n            return KQCard.findShunZi(this._kqCardModes);\n        }.bind(this));\n    },\n\n    clickTongHua: function () {\n        this._stickOutFindCardType(\"tongHua\", function () {\n            return KQCard.findTongHua(this._kqCardModes);\n        }.bind(this));\n    },\n\n    clickHuLu: function () {\n        this._stickOutFindCardType(\"huLu\", function () {\n            return KQCard.findHuLu(this._kqCardModes);\n        }.bind(this));\n    },\n\n    clickTieZhi: function () {\n        this._stickOutFindCardType(\"tieZhi\", function () {\n            return KQCard.findTieZhi(this._kqCardModes);\n        }.bind(this));\n    },\n\n    /*#####*/\n    clickWuTong: function () {\n        this._stickOutFindCardType(\"wuTong\", function () {\n            return KQCard.findWuTong(this._kqCardModes);\n        }.bind(this));\n    },\n    /*#####*/\n\n    clickTongHuaShun: function () {\n        this._stickOutFindCardType(\"tongHuaShun\", function () {\n            return KQCard.findTongHuaShun(this._kqCardModes);\n        }.bind(this));\n    },\n\n    clickCancelAll: function () {\n        this.clickDeleteTouDao();\n        this.clickDeleteZhongDao();\n        this.clickDeleteWeiDao();\n    },\n\n    /*点击完成按钮*/\n    clickDone: function () {\n        cc.sys.localStorage.removeItem(\"timestamp\");\n        this.cardAlls =  this.cardAllNode.children.sort(function(a,b){return b.y - a.y;}).map(function(i){return i.children[0];});\n\n        let touCardModels = this._taoDaoCardModes();\n        let zhongCardModes = this._zhongDaoCardModes();\n        let weiCardModes = this._weiDaoCardModes();\n        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);\n    },\n\n    /*点击恭喜你页面的确定按钮*/\n    onBtnGongXiNiComfirmClick:function () {\n        //记录玩家点击了确定按钮：\n        this.BtnClickGongXiNiComfirm = true;\n\n        var cards = [];\n\n        cc.teShuPaiCards.forEach(function(i){cards = cards.concat(i);});\n\n        var teShuPaiCardsServerInfo = this._convertCardsToServerModel2(cards);\n        var result = [teShuPaiCardsServerInfo];\n        if (this._finishSelectCardsCallback) {\n            this._finishSelectCardsCallback(result);\n        }\n    },\n\n    _didSelectedCards: function (touCards, zhongCards, weiCards) {\n        touCards = touCards || [];\n        zhongCards = zhongCards || [];\n        weiCards = weiCards || [];\n        let touServerInfo = this._convertCardsToServerModel(touCards);\n        let zhongServerInfo = this._convertCardsToServerModel(zhongCards);\n        let weiServerInfo = this._convertCardsToServerModel(weiCards);\n\n        //console.log(touServerInfo);\n        //console.log(zhongServerInfo);\n        //console.log(weiServerInfo);\n        //console.log(\"---------------------------------512\");\n        if(!(touServerInfo.value < zhongServerInfo.value && zhongServerInfo.value <= weiServerInfo.value)){\n            this.autoCardAnimation.y = -50;\n            this.autoCardAnimation.opacity = 255;\n            this.autoCardAnimation.runAction(cc.moveTo(1, cc.p(0, 0)));\n            this.scheduleOnce(function () {\n                var action = cc.spawn(cc.moveTo(this.cardTime, cc.p(0, 10)), cc.fadeOut(this.cardTime));\n                this.autoCardAnimation.runAction(action);\n            }.bind(this), 1.5);\n            return;\n        }\n        let result = [touServerInfo, zhongServerInfo, weiServerInfo];\n        //return;\n        if (this._finishSelectCardsCallback) {\n            this._finishSelectCardsCallback(result);\n        }\n    },\n\n    clickDeleteTouDao: function () {\n        this._deleteDaoCardsOfLayout(this.layoutTouDao.node);\n    },\n\n    clickDeleteZhongDao: function () {\n        this._deleteDaoCardsOfLayout(this.layoutZhongDao.node);\n    },\n\n    clickDeleteWeiDao: function () {\n        this._deleteDaoCardsOfLayout(this.layoutWeiDao.node);\n    },\n\n    // 计时器事件\n    timeStart: function (duration) {\n        cc.assert(duration > 0);\n        this.timeStop();\n        this.timeNode.active = true;\n        var timestamp = cc.sys.localStorage.getItem(\"timestamp\");  // 获取本地存储的时间戳\n        if(timestamp){  // 如果有则证明玩家是重新进来了的\n            var now = Date.parse(new Date());\n            var time = duration*1000;\n            if(now - timestamp > time){ // 超时\n                if(now - timestamp < 2*time){\n                    duration = 5;  // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。\n                }else{\n                    cc.sys.localStorage.removeItem(\"timestamp\");\n                }\n            }else{\n                duration = Math.floor( duration - (now - timestamp)/1000);\n            }\n        }else{  // 如果没有时间戳，则保存，为玩家退出游戏保留证据；\n            var timestamp = Date.parse(new Date());     \n            cc.sys.localStorage.setItem('timestamp',timestamp);\n        }\n        this._timeRemainDuration = duration;\n        this.labelTime.string = String(duration);\n        this.timeNode.getComponent(\"time\").setTime(duration * 0.5);\n        this.schedule(this._timeMethod, 1, duration);\n    },\n\n    timeStop: function () {\n        this.unschedule(this._timeMethod);\n        this.timeNode.active = false;\n    },\n\n    _timeMethod: function () {\n        this._timeRemainDuration = this._timeRemainDuration - 1;\n\n        var remain = Math.max(this._timeRemainDuration, 0);\n        this.labelTime.string = (remain < 10 && remain > 0) ? ('0' + remain) : remain;\n\n        if (this._timeRemainDuration <= 0) {\n            this.timeStop();\n            if(cc.chaoShiChuPai == true) this._timeOutAutoSelectCards();\n            cc.sys.localStorage.removeItem(\"timestamp\");\n            return;\n        }\n    },\n\n    // 超时后，自动选牌\n    _timeOutAutoSelectCards: function () {\n        /**\n         * 隐藏恭喜你\n         */\n        play.gongXiNiShow(false);\n        if (typeof(cc.teShuPaiCards) != \"undefined\" && cc.teShuPaiCards != null) {\n            this.onBtnGongXiNiComfirmClick();\n            return;\n        }\n\n        //let [touCardModels, zhongCardModes, weiCardModes] = this._cacleAutoSelectedCards();\n        let [touCardModels, zhongCardModes, weiCardModes] = this._findCardIndex.arr[0];\n\n\n        if (touCardModels == null || zhongCardModes == null || weiCardModes == null) {\n            touCardModels = this._allCardModes.slice(-3);\n            zhongCardModes = this._allCardModes.slice(5, 10);\n            weiCardModes = this._allCardModes.slice(0, 5);\n        }\n\n        // cc.log(touCardModels)\n        // cc.log(zhongCardModes)\n        // cc.log(weiCardModes)\n        // cc.log(this._allCardModes)\n        // cc.log(\"自动选牌 touCardModels zhongCardModes weiCardModes：\");\n        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);\n    },\n\n    _cacleAutoSelectedCards: function() {\n        let cards = this._allCardModes.filter(function(i){\n            return i;\n        });\n        var resultCards = [];\n        for(var i = 1;i < 3; i++){\n            let cardss = KQCard.autoSelectCards(cards, 5);\n            cards = cards.kq_excludes(cardss);\n            resultCards.push(cardss);\n        }\n        resultCards.push(cards);\n        //let touScore = KQCard.scoreOfCards(resultCards[2]);\n        //let zhongScore = KQCard.scoreOfCards(resultCards[1]);\n        //let weiScore = KQCard.scoreOfCards(resultCards[0]);\n        // cc.log(resultCards)\n        // cc.log(this._allCardModes)\n        // cc.log(\"牌分数自动选牌：\", touScore, zhongScore, weiScore);\n        //let weiCardModes = KQCard.autoSelectCards(cards, 5);\n        //cards = cards.kq_excludes(weiCardModes);\n        //\n        //let zhongCardModes = KQCard.autoSelectCards(cards, 5);\n        //\n        //let touCardModes = cards.kq_excludes(zhongCardModes);\n        //if (touCardModes.length == 3 && zhongCardModes.length == 5 && weiCardModes.length == 5) {\n        //    return [touCardModes, zhongCardModes, weiCardModes];\n        //}\n        if (resultCards[2].length == 3 && resultCards[1].length == 5 && resultCards[0].length == 5) {\n            return [resultCards[2], resultCards[1], resultCards[0]];\n        }\n\n        return [];\n    },\n\n    _convertCardsToServerModel: function (cards) {\n        let result = {};\n        result.type = KQCard.cardsType(cards);\n        result.value = KQCard.scoreOfCards(cards);\n        cards = KQCard._typeCardsSortByNumberOfPoints1(cards);\n        result.cards = KQCard.convertToServerCards(cards);\n\n        return result;\n    },\n\n    /*#####*/\n    _convertCardsToServerModel2: function (cards) {\n        var convertToServerCards = [];\n\n        cc.teShuPaiCards.forEach(function(cardMode){\n            var arr = [];\n            cardMode = KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(cardMode));\n            cardMode.forEach(function(cca){\n                var point = cca.point == 14 ? 1:cca.point;\n                arr.push({number:point,suit:cca.color});\n            });\n            convertToServerCards.push(arr);\n        });\n        let result = {};\n        result.type = KQCard.cardsType(cards);\n        result.value = 0;\n        result.cards = convertToServerCards;\n\n        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {\n            // 特殊牌\n            result.isContainExtra = true;\n        }\n\n        return result;\n    },\n    /*#####*/\n    // 特殊牌里是否还含有特殊牌\n    // 包含的情况有：\n    // 三桃花 可能含有同花顺\n    // 三顺子 可能含有同花顺\n    // 六对半 可能含有铁支\n    _isContainExtraCardsType: function (type, cards) {\n        if (type == KQCard.TYPE.SanTaoHua) {\n            return KQCard.containTongHuaShun(cards);\n        } else if (type == KQCard.TYPE.SanShunZi) {\n            return KQCard.containTongHuaShun(cards);\n        } else if (type == KQCard.TYPE.LiuDuiBan) {\n            return KQCard.containTieZhi(cards);\n        }\n        return false;\n    },\n\n    // 触摸事件\n    _registerTouchEvents: function () {\n        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_START, this._touchCardLayout.bind(this));\n        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_MOVE, this._touchCardLayout.bind(this));\n        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_END, this._touchCardLayoutEnd.bind(this));\n        //this.cardsLayout.node.on(cc.Node.EventType.TOUCH_CANCEL, this._touchCardLayoutEnd.bind(this));\n    },\n    cacleAutoSelectedCardsIndex: function(cards) {\n        //cc.log('------622')\n        let testFind = KQCard.testFind(cards) || [];\n        //cc.log('------6221')\n        var result = []\n        for(var i = 0;i < testFind.length; i++){\n            var s = testFind[i];\n            if(s.length >= 1){\n                for(var j = 0;j < s.length; j++){\n                    //result.push(s[0]);//只取一个\n                    result.push(s[j]);//\n                }\n            }\n        }\n        return result;\n    },\n\n    cacleAutoSelectedCardsArray: function(cards) {\n        var indexs = this.cacleAutoSelectedCardsIndex(cards);\n        if(indexs.length < 1){\n            return false;\n        }\n        let selectedCard = [];\n        for(var i = 0;i < indexs.length; i++){\n            let s = indexs[i];\n            let a = s.map(function(index){\n                return cards[index];\n            });\n            selectedCard.push(a);\n        }\n        return selectedCard;\n    },\n\n    cacleAutoSelectedCards2: function() {\n        let cards = this._allCardModes.slice();\n        var cardsArray = this.cacleAutoSelectedCardsArray(cards);\n        var resultArray = [];\n        for(var i = 0;i < cardsArray.length;i++){\n            let s = cardsArray[i] || [];\n            let qwer = [];\n            for(var j = 1;j < cardsArray.length;j++){\n                let d = cardsArray[j] || [];\n                let sC = s.kq_excludes(d);\n                if(sC.length == s.length && s.length > 0){//判断牌相同 即没有重复的\n                    qwer = [s,d];\n                }\n            }\n            if(qwer.length > 1){\n                resultArray.push(qwer);\n            }\n        }\n\n        //补全计划1\n        for(var i = 0;i < resultArray.length;i++){\n\n            let s = resultArray[i];\n\n            let cardss = this._allCardModes.slice();\n\n            cardss = cardss.kq_excludes(s[0]);\n\n            cardss = cardss.kq_excludes(s[1]);\n\n            if(cardss.length >= 5){\n                s[2] = KQCard.autoSelectCards(cardss, 5);\n            }else{\n                s[2] = KQCard.autoSelectCards(cardss, 3);\n            }\n\n            resultArray[i].sort(function (a1,a2) {\n                return KQCard.scoreOfCards(a1)-KQCard.scoreOfCards(a2);\n            });\n        }\n        //补全计划2\n        for(var i = 0;i < resultArray.length;i++){\n            var s = resultArray[i];\n            var cardsqe = this._allCardModes.filter(function(ii){//重新赋值cards\n                return ii;\n            });\n            //去重\n            var q = s[0].concat(s[1]).concat(s[2]);\n            var cardsq = cardsqe.kq_excludes(q);\n            s[0] = s[0].kq_excludes(s[1]);\n            s[0] = s[0].kq_excludes(s[2]);\n            s[1] = s[1].kq_excludes(s[0]);\n            s[1] = s[1].kq_excludes(s[2]);\n            s[2] = s[2].kq_excludes(s[1]);\n            s[2] = s[2].kq_excludes(s[0]);\n            //多余删除\n            if (s[2].length > 5) {//尾道\n                let a = s[2].splice(5, s[2].length-5);\n                for(var y in a){\n                    cardsq.push(a[y]);\n                }\n            }\n            if (s[1].length > 5) {//中道\n                let a = s[1].splice(5, s[1].length-5);\n                for(var y in a){\n                    cardsq.push(a[y]);\n                }\n            }\n            if (s[0].length > 3) {//头道\n                let a = s[0].splice(3, s[0].length-3);\n                for(var y in a){\n                    cardsq.push(a[y]);\n                }\n            }\n            //cardsq = KQCard._convertOneToA(cardsq);\n            cardsq.sort(KQCard.sortByPoint);\n            cardsq.forEach(function(card11){\n                if(card11.point == 14){\n                    card11.point = 1;\n                }\n            });\n            //有缺添加\n            while(s[2].length < 5) {//尾道\n                s[2].push(cardsq.pop() || []);\n            }\n            while(s[1].length < 5) {//中道\n                s[1].push(cardsq.pop() || []);\n            }\n            while(s[0].length < 3) {//头道\n                s[0].push(cardsq.pop() || []);\n            }\n            /*if(cardsq.length > 0){\n                while(s[2].length < 5) {//尾道\n                    s[2].push(cardsq.pop());\n                }\n            }\n            if(cardsq.length > 0){\n                while(s[1].length < 5) {//中道\n                    s[1].push(cardsq.pop());\n                }\n            }\n            if(cardsq.length > 0){\n                while(s[0].length < 3) {//头道\n                    s[0].push(cardsq.pop());\n                }\n            }*/\n            if(s[2][4] == null || s[1][4] == null || s[0][2] == null\n                || s[2][4] == '' || s[1][4] == '' || s[0][2] == ''){\n                resultArray.splice(i,1);\n            }\n        }\n\n        var resultCards = [];\n        let cardss1 = this._allCardModes.filter(function(i){return i;});\n        var indexasdf = 2;\n        for(var i = 0;i < 3; i++){\n            let length = indexasdf == 0? 3: 5;\n            let cardss = KQCard.autoSelectCards(cardss1, length) || [];\n            cardss1 = cardss1.kq_excludes(cardss);\n            resultCards[indexasdf] = cardss;\n            indexasdf--;\n        }\n\n        for(var i = 0;i < resultCards.length; i++){\n            let length = i == 0? 3: 5;\n            if (resultCards[i].length < length) {\n                cardss1 = cardss1.kq_excludes(resultCards[i]);\n                while(resultCards[i].length < length) {\n                    resultCards[i].push(cardss1.pop());\n                }\n            }\n        }\n\n        resultArray.push(resultCards);\n\n        var cardsTypeNames = [];\n        var resultArrays = [];\n\n        for(var i = 0;i < resultArray.length;i++){//删除类型相同的组合\n            let s = resultArray[i];\n            let typeName0 = KQCard.cardsTypeName(s[0]);\n            typeName0 += KQCard.cardsTypeName(s[1]);\n            typeName0 += KQCard.cardsTypeName(s[2]);\n            if(cardsTypeNames.indexOf(typeName0) == -1){\n                let touScore = KQCard.scoreOfCards(s[0]);\n                let zhongScore = KQCard.scoreOfCards(s[1]);\n                let weiScore = KQCard.scoreOfCards(s[2]);\n                if(zhongScore > touScore && zhongScore < weiScore){\n                    cardsTypeNames.push(typeName0);\n                    resultArrays.push(s);\n                }\n            }\n        }\n\n        resultArrays.sort(function (a1,a2) {\n            var b0 = parseInt(KQCard.cardsType(a2[0]) ) + \"\";\n            var b1 = parseInt(KQCard.cardsType(a2[1]) ) + \"\";\n            var b2 = parseInt(KQCard.cardsType(a2[2]) ) + \"\";\n\n            var s0 = parseInt(KQCard.cardsType(a1[0]) ) + \"\";\n            var s1 = parseInt(KQCard.cardsType(a1[1]) ) + \"\";\n            var s2 = parseInt(KQCard.cardsType(a1[2]) ) + \"\";\n\n            var s = parseInt(s2 + s1 + s0);\n            var b = parseInt(b2 + b1 + b0);\n\n            return b - s;\n        });\n\n        if(resultArrays.length > 7){\n            resultArrays = resultArrays.slice(0,7);\n        }\n        //for(var i = 0;i < resultArrays.length;i++){//如果有相公牌则删除\n        //    let s = resultArrays[i];\n        //    let touScore = KQCard.scoreOfCards(s[0]);\n        //    let zhongScore = KQCard.scoreOfCards(s[1]);\n        //    let weiScore = KQCard.scoreOfCards(s[2]);\n        //    cc.log(touScore,zhongScore,weiScore);\n        //    if(weiScore < touScore || weiScore < zhongScore){\n        //        resultArrays.splice(i,1);\n        //    }\n        //}\n        //cc.log(resultArrays)\n        //cc.log('-------897')\n\n        //if(cc.teShuPaiCards){\n        //    var TeShuCards = cc.teShuPaiCards.map(function(ca){\n        //       return KQCard._typeCardsSortByNumberOfPoints(KQCard.cardsFromArray(ca));\n        //    });\n        //    resultArrays.unshift(TeShuCards);\n        //\n        //}\n\n        if(resultArrays.length <= 0){\n\n            this._allCardModes.forEach(function(i){if(i.scores == 1) i.scores = 14;});\n\n            var card20 = KQCard.contain20(this._allCardModes);\n\n            this._allCardModes = this._allCardModes.kq_excludes(card20);\n\n            this._allCardModes = KQCard._typeCardsSortByNumberOfPoints(this._allCardModes);\n\n            this._allCardModes = card20.concat(this._allCardModes);\n\n            var asdf1 = this._allCardModes.slice(0,5);\n\n            var asdf2 = this._allCardModes.slice(5,10);\n\n            var asdf3 = this._allCardModes.slice(10,13);\n\n            resultArrays.push([asdf3,asdf2,asdf1])\n        }\n\n        this.autoCardLayout.node.removeAllChildren();\n        this.autoCardScrollView.scrollToLeft();\n        for(var i = 0;i < resultArrays.length;i++){//添加预制体\n            let s = resultArrays[i];\n            let autoCard = cc.instantiate(this.autoCard);\n            autoCard.y = 0;\n            s[0].forEach(function(i){if (i.point == 14) i.point = 1;})\n            s[1].forEach(function(i){if (i.point == 14) i.point = 1;})\n            s[2].forEach(function(i){if (i.point == 14) i.point = 1;})\n            var cardsNode = [autoCard.children[1],autoCard.children[3],autoCard.children[2]];\n\n            this._setCardDaoSprite(cardsNode,s);\n\n            autoCard.cardArray = s;\n            var eventHandler = new cc.Component.EventHandler();\n            eventHandler.target = this.node;\n            eventHandler.component = \"CardTypeCombine\";\n            eventHandler.handler = \"clickAutoSelectedCards\";\n            eventHandler.customEventData = i;\n            autoCard.getComponent(cc.Button).clickEvents.push(eventHandler);\n            this.autoCardLayout.node.addChild(autoCard);\n        }\n        this._findCardIndex.arr = resultArrays;\n\n        this.autoSelectedCardsOne();\n    },\n\n    //daoCancelAll: function () {\n    //    var nodes = [this.layoutTouDao.node,this.layoutZhongDao.node,this.layoutWeiDao.node];\n    //    for(var i = 0;i < nodes.length;i++){\n    //        nodes[i].removeAllChildren();\n    //    }\n    //},\n\n    autoSelectedCardsOne: function() {\n        this.cardsLayout.node.removeAllChildren();\n\n        var indexs = 0;\n\n        for(var i = 0; i < this.autoCardLayout.node.children.length;i++){\n\n            var nodes = this.autoCardLayout.node.children[i];\n\n            nodes.children[0].active = false;\n\n        }\n\n        this.autoCardLayout.node.children[indexs].children[0].active = true;\n\n        let resultArray = this._findCardIndex.arr[indexs];\n\n        this._findCardIndex.indexs = indexs;\n\n\n        for(var i = 0;i < resultArray.length;i++){\n\n            var cardModes = resultArray[i];\n\n            cardModes.sort(KQCard.sort);\n\n            var num = 0;\n            if(i == 1){\n                num = 3;\n            }\n            else if(i == 2){\n                num = 8;\n            }\n            //cardModes.forEach(function(i){if (i.point == 14) i.point = 1;})\n            cardModes.forEach(function (cardMode,index) {\n\n                var cardName = cardMode.cardName();\n\n                var numBer = num+index;\n\n                var nodds1 = new cc.Node(); //创建一个节点对象\n\n                nodds1.anchorY = 1;\n\n                nodds1.addComponent(cc.Sprite); //添加精灵组件\n\n                this.cardAllNode.children[numBer].addChild(nodds1);\n\n                this.cardAllNode.children[numBer].children[0].cardName = cardName;\n\n                this.cardAllNode.children[numBer].children[0]._cardModel = new KQCard(cardName,null,index);\n\n                var btnSprites =  this.cardAllNode.children[numBer].children[0].getComponent(cc.Sprite);\n\n                this.cardAllNode.children[numBer].getComponent(cc.Sprite).spriteFrame = '';\n\n                btnSprites.node.removeAllChildren();\n\n                if(cc.maPai == cardName){\n\n                    var nodds = new cc.Node(); //创建一个节点对象\n\n                    nodds.addComponent(cc.Sprite); //添加精灵组件\n\n                    cc.loader.loadRes('play/desk/img_red5_1', cc.SpriteFrame, function (err, spriteFrame) {\n\n                        if (err) {cc.error(err.message || err);return;}\n\n                        var btnSprite1 = nodds.getComponent(cc.Sprite);\n\n                        btnSprite1.spriteFrame = spriteFrame;\n\n                        btnSprite1.node.width = 107;\n\n                        btnSprite1.node.height = 155;\n\n                        btnSprite1.node.y = -65.5;\n\n                    }.bind(this));\n\n                    btnSprites.node.addChild(nodds);\n\n                }\n\n                var path = 'public-pic-card-poker-'+ cardName;\n\n                this._loadCardFrame(this.cardSpriteAtlas, path ,btnSprites, 95, 130);\n\n            }.bind(this));\n        }\n\n        this.clickAutoSelectedCards(null);\n\n        //this._setCardDaoSprite();\n\n    },\n\n    clickAutoSelectedCards: function(event,indexs = 0) {\n\n        for(var i = 0; i < this.autoCardLayout.node.children.length;i++){\n\n            var nodes = this.autoCardLayout.node.children[i];\n\n            nodes.children[0].active = false;\n\n        }\n\n        this.autoCardLayout.node.children[indexs].children[0].active = true;\n\n        AudioManager.instance.playPokerClick();\n\n        if(event){\n            var resultArray = event.target.cardArray;\n        }\n        else{\n            var resultArray = this._findCardIndex.arr[indexs];\n        }\n        let touScore = KQCard.scoreOfCards(resultArray[0]);\n        let zhongScore = KQCard.scoreOfCards(resultArray[1]);\n        let weiScore = KQCard.scoreOfCards(resultArray[2]);\n        //cc.log(touScore);\n        //cc.log(zhongScore);\n        //cc.log(weiScore);\n        //console.log('----------1180')\n        resultArray = resultArray.map(function (cardMode){\n\n            cardMode = KQCard._typeCardsSortByNumberOfPoints(cardMode);\n\n            return cardMode.map(function (cardModes){\n\n                return cardModes.cardName();\n\n            }.bind(this));\n\n        }.bind(this));\n        //console.log(resultArray)\n\n        this.LayoutWithEvent.forEach(function(nodes){\n\n            nodes.color = new cc.Color(255, 255, 255);\n\n            nodes.children.forEach(function(i){i.color = new cc.Color(255, 255, 255);});\n        });\n\n        this.LayoutWithEvent = [];\n\n        resultArray = resultArray[0].concat(resultArray[1]).concat(resultArray[2]);\n\n        var cardAllNode = this.cardAllNode.children.map(function(i){return i;});\n\n        for(var i = 0;i < resultArray.length;i++){\n\n            var s = resultArray[i];\n\n            for(var j = 0;j < cardAllNode.length;j++){\n\n                var d = cardAllNode[j];\n\n                d.getComponent(cc.Button).interactable = false;\n\n                if(d.children[0].cardName == s){\n\n                    d.stopAllActions();\n\n                    var detail = this.changeNodeSpaceAR[i];\n\n                    var call = cc.callFunc(function () {\n\n                        this.cardAllNode.children.forEach(function(nodes){\n                            nodes.getComponent(cc.Button).interactable = true;\n                        });\n\n                        this._setCardDaoSprite();\n\n                    }.bind(this), this);\n\n                    d.runAction(cc.sequence(cc.moveTo(this.cardTime,detail), call));\n\n                    cardAllNode.splice(j,1)\n\n                    break;\n\n                }\n\n            }\n\n        }\n\n    },\n\n    _loadCardFrame: function(SpriteFrame, path, SpritesNode, w, h) {\n\n        var Sprite = SpriteFrame.getSpriteFrame( path );\n\n        SpritesNode.spriteFrame = Sprite;\n\n        if(w) SpritesNode.node.width = w;\n\n        if(h) SpritesNode.node.height = h;\n    },\n\n    stickOutFindCardType1: function (cards,index = 0) {\n        //// 将已有的突出的牌的位置重置回初始位置\n        //this._resetCardsPositionY();\n        //let selectedCardNames = cards.map(function(cardModel){\n        //    return cardModel.cardName();\n        //}.bind(this));\n        //\n        //let cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {\n        //    let cardPrefab = cardNode.getComponent('CardPrefab');\n        //    if(selectedCardNames.includes(cardPrefab.cardName())) {\n        //        var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());\n        //        selectedCardNames.splice(nameIndex,1);\n        //        return true;\n        //    }\n        //    return false;\n        //});\n        //\n        //cc.log('-------696')\n        //this._changeCardPrefabsY(cardNodes);\n        //if(index == 1){\n        //    this._addDaoCardToLayout(this.layoutTouDao.node, 3);\n        //}\n        //else if(index == 2){\n        //    this._addDaoCardToLayout(this.layoutZhongDao.node);\n        //}\n        //else if(index == 3){\n        //    this._addDaoCardToLayout(this.layoutWeiDao.node);\n        //}\n\n    },\n\n    _touchCardLayout: function (event) {\n        //event.bubbles = true;\n        //let location = event.getLocation();\n        //let cardPrefab = this._cardPrefabInCardLayoutWithLocation(location);\n        //if (cardPrefab) {\n        //    cardPrefab.getComponent('CardPrefab').setSelected(true);\n        //    event.stopPropagation();\n        //}\n    },\n\n    _touchCardLayoutEnd: function (event) {\n        //this._changeSelectedCardPrefabsY();\n        //this._diseclectCardPrefabs();\n    },\n\n    _cardPrefabInCardLayoutWithLocation: function (location) {\n        //location = this.cardsLayout.node.convertToNodeSpaceAR(location);\n        //let cardNodes = this.cardsLayout.node.children.sort(function (cardNode1, cardNode2) {\n        //    let rect1 = cardNode1.getBoundingBox();\n        //    let rect2 = cardNode2.getBoundingBox();\n        //    return rect2.x - rect1.x;\n        //});\n        //for (let index in cardNodes) {\n        //    let cardNode = cardNodes[index];\n        //\n        //    let rect = cardNode.getBoundingBox();\n        //\n        //    if (cc.rectContainsPoint(rect, location)) {\n        //        return cardNode;\n        //    }\n        //}\n        //\n        //return null;\n    },\n\n    _changeSelectedCardPrefabsY: function () {\n        //let cardNodes = this._selectedCardPrefabs();\n        //this._changeCardPrefabsY(cardNodes);\n        //\n        //AudioManager.instance.playPokerClick();\n    },\n\n    _changeCardPrefabsY: function (cardNodes) {\n        //cardNodes.forEach(function (cardNode) {\n        //    let y = cardNode.getPositionY();\n        //    if (y == this._cardOffsetY) {\n        //        cardNode.setPositionY(this._cardOffsetY + 55);\n        //    } else {\n        //        cardNode.setPositionY(this._cardOffsetY);\n        //    }\n        //}.bind(this));\n    },\n\n    _selectedCardPrefabs: function (includeStickOut = false) {\n        //let cardNodes = this.cardsLayout.node.children || [];\n        //return cardNodes.filter(function (cardNode) {\n        //    let cardPrefab = cardNode.getComponent('CardPrefab');\n        //    let isSelected = cardPrefab.isSelected();\n        //    if (!isSelected && includeStickOut) {\n        //        isSelected = cardNode.getPositionY() > 10;\n        //    }\n        //\n        //    return isSelected;\n        //});\n    },\n\n    _diseclectCardPrefabs: function () {\n        //let cardNodes = this.cardsLayout.node.children;\n        //cardNodes.forEach(function (node) {\n        //    node.getComponent('CardPrefab').setSelected(false);\n        //});\n    },\n\n    // 重置 cards 的 X\n    _resetCardsPositionX: function () {\n        //let interval = 98;\n        //let interval = 78;\n        //let cardNodes = this.cardsLayout.node.children || [];\n        //let length = cardNodes.length;\n        //if (length == 0) {\n        //    return;\n        //}\n        //\n        //let middleIndex = length / 2;\n        //let cardWidth = 154;\n        //\n        //\n        ////this.cardsLayoutSort();\n        //if(this.cardsLayoutSortColor == true){\n        //    this.cardsLayout.node.children.sort(function (n1, n2) {\n        //        let component1 = n1.getComponent('CardPrefab');\n        //        let component2 = n2.getComponent('CardPrefab');\n        //        return component2.cardMode().color - component1.cardMode().color;\n        //    });\n        //}else{\n        //    this.cardsLayout.node.children.sort(function (n1, n2) {\n        //        let component1 = n1.getComponent('CardPrefab');\n        //        let component2 = n2.getComponent('CardPrefab');\n        //        return component1.cardMode().sort(component2.cardMode());\n        //    });\n        //}\n        ////cardNodes.sort(function (n1, n2) {\n        ////    let component1 = n1.getComponent('CardPrefab');\n        ////    let component2 = n2.getComponent('CardPrefab');\n        ////\n        ////    return component1.cardMode().sort(component2.cardMode());\n        ////});\n        //\n        //cardNodes.forEach(function (cardNode, index) {\n        //    cardNode.zIndex = index;\n        //    let x = (index - middleIndex) * interval + cardWidth / 3;\n        //    cardNode.setPositionX(x);\n        //});\n    },\n\n    // 重置 cards 的 X为0\n    resetCardsPositionX1: function () {\n        //let cardNodes = this.cardsLayout.node.children || [];\n        //let length = cardNodes.length;\n        //if (length == 0) {\n        //    return;\n        //}\n        //cardNodes.forEach(function (cardNode) {\n        //    cardNode.setPositionY(0);\n        //});\n    },\n\n    _resetCardsPositionY: function () {\n        //let cardNodes = this.cardsLayout.node.children || [];\n        //cardNodes.forEach(function (cardNode) {\n        //    cardNode.setPositionY(this._cardOffsetY);\n        //}.bind(this));\n    },\n\n    // 头、中、尾道 layout 的点击事件\n    _registerDaosLayoutClickEvent: function () {\n\n        this.changeNodeSpaceAR = [];//记录所有牌的坐标\n        this.cardAllNode.children.forEach(function(nodes){\n            //获取节点的世界坐标\n            var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));\n            //获取相对父节点所在的坐标\n            var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);\n\n            this.changeNodeSpaceAR.push(detail);\n\n        }.bind(this));\n    },\n\n    clickAllCard: function (event) {\n        AudioManager.instance.playPokerClick();\n        if(this.LayoutWithEvent.length <= 1){\n            this.LayoutWithEvent.push(event.target);\n            event.target.color = new cc.Color(182, 182, 182);\n            event.target.children.forEach(function(i){i.color = new cc.Color(182, 182, 182);});\n        }\n        if(this.LayoutWithEvent.length == 2){\n\n            var arr = [];\n\n            this.LayoutWithEvent.forEach(function(nodes){\n                //获取节点的世界坐标\n                var cardBackWorldSpace1 = nodes.convertToWorldSpaceAR(cc.v2(0, 0));\n                //获取相对父节点所在的坐标\n                var detail = nodes.parent.convertToNodeSpaceAR(cardBackWorldSpace1);\n\n                arr.unshift(detail);\n\n            }.bind(this));\n\n            this.LayoutWithEvent.forEach(function(nodes,index){\n\n                nodes.color = new cc.Color(255, 255, 255);\n\n                nodes.children.forEach(function(i){i.color = new cc.Color(255, 255, 255);});\n\n                nodes.getComponent(cc.Button).interactable = false;\n\n                this.scheduleOnce(function () {\n\n                    nodes.getComponent(cc.Button).interactable = true;\n\n                    this._setCardDaoSprite();\n\n                }.bind(this), this.cardTime);\n\n                nodes.stopAllActions();\n\n                var detail = arr[index];\n\n                nodes.runAction(cc.moveTo(this.cardTime,detail));\n\n            }.bind(this));\n\n            this.LayoutWithEvent = [];\n\n        }\n\n    },\n\n    _setCardDaoSprite: function (nodes = null ,cards = null) {\n\n        if(!nodes){\n\n            this.cardAlls =  this.cardAllNode.children.sort(function(a,b){return b.y - a.y;}).map(function(i){return i.children[0];});\n\n            cards = [this._taoDaoCardModes(),this._zhongDaoCardModes(),this._weiDaoCardModes()];\n\n            cards.forEach(function(card){card.forEach(function(i){if (i.scores == 14){i.scores = 1;}});});\n\n            nodes = [this.touDaoNode,this.zhongDaoNode,this.weiDaoNode];\n\n        }\n\n        //头道\n        let typeName0 = KQCard.cardsType(cards[0])+1;\n\n        typeName0 = typeName0>=10 ? typeName0 :\"0\"+typeName0;\n\n        typeName0 = typeName0=='04' ? '11' :typeName0;\n\n        var path = 'game_poker_type'+ typeName0;\n\n        this._loadCardFrame(this.daoSpriteAtlas, path ,nodes[0].getComponent(cc.Sprite));\n\n        //中道\n        let typeName1 = KQCard.cardsType(cards[1])+1;\n\n        typeName1 = typeName1>=10 ? typeName1 :\"0\"+typeName1;\n\n        typeName1 = typeName1=='07' ? '22' :typeName1;\n\n        path = 'game_poker_type'+ typeName1;\n\n        this._loadCardFrame(this.daoSpriteAtlas, path ,nodes[1].getComponent(cc.Sprite));\n\n        //尾道\n        let typeName2 = KQCard.cardsType(cards[2])+1;\n\n        typeName2 = typeName2>=10 ? typeName2 :\"0\"+typeName2;\n\n        path = 'game_poker_type'+ typeName2;\n\n        this._loadCardFrame(this.daoSpriteAtlas, path ,nodes[2].getComponent(cc.Sprite));\n\n        this.cardAllNode.children.forEach(function(n){n.getComponent(cc.Sprite).spriteFrame = \"\";});\n\n        if(cards){\n\n            if(typeName0) KQCard._setGuiCard(0, 0, 3, typeName0, cards, this.cardAllNode.children, this.cardSpriteAtlas);\n\n            if(typeName1) KQCard._setGuiCard(1, 3, 8, typeName1, cards, this.cardAllNode.children, this.cardSpriteAtlas);\n\n            if(typeName2) KQCard._setGuiCard(2, 8, 13, typeName2, cards, this.cardAllNode.children, this.cardSpriteAtlas);\n\n        }\n    },\n\n    _clickTouDaoLayout: function (event) {\n        this._daoCardNodeInLayoutWithEvent(this.layoutTouDao.node, event);\n    },\n\n    _clickZhongDaoLayout: function (event) {\n        this._daoCardNodeInLayoutWithEvent(this.layoutZhongDao.node, event);\n    },\n\n    _clickWeiDaoLayout: function (event) {\n        this._daoCardNodeInLayoutWithEvent(this.layoutWeiDao.node, event);\n    },\n\n    _daoCardNodeInLayoutWithEvent: function (node, event) {\n        let cardNodes = node.children || [];\n        var location = event.getLocation();\n        location = node.convertToNodeSpaceAR(location);\n        //var cardBackWorldSpace = this.layoutZhongDao.node.convertToWorldSpaceAR(cc.v2(0, 0));\n        ////获取节点的世界坐标\n        //var detail = this.layoutZhongDao.node.parent.convertToNodeSpaceAR(cardBackWorldSpace);\n        ////获取相对父节点所在的坐标\n        //this.layoutWeiDao.node.runAction(cc.moveTo(1,detail));\n        for (let index in cardNodes) {\n            let cardNode = cardNodes[index];\n            let rect = cardNode.getBoundingBox();\n            if (cc.rectContainsPoint(rect, location)) {\n                AudioManager.instance.playPokerClick();\n                let arrs = [node ,cardNode];\n                if(this.LayoutWithEvent.length == 1){\n                    if(this.LayoutWithEvent[0][0].name != node.name){\n                        cardNode.opacity = 200;\n                        this.LayoutWithEvent.push(arrs);\n                    }else{\n                        this.LayoutWithEvent[0][1].opacity = 255;\n                        this.LayoutWithEvent = [];\n                    }\n                }\n                else if(this.LayoutWithEvent.length == 0){\n                    //cc.log(cardNode)\n                    this.LayoutWithEvent.push(arrs);\n                    cardNode.opacity = 200;\n                }\n                if(this.LayoutWithEvent.length == 2){\n                    var node1 = this.LayoutWithEvent[0][1];\n                    var node2 = this.LayoutWithEvent[1][1];\n                    //获取节点的世界坐标\n                    var cardBackWorldSpace = node1.convertToWorldSpaceAR(cc.v2(0, 0));\n                    //获取相对父节点所在的坐标\n                    var detail = node1.parent.convertToNodeSpaceAR(cardBackWorldSpace);\n                    node2.runAction(cc.moveTo(1,detail));\n\n                }\n\n                return ;\n            }\n        }\n\n        //return null;\n    },\n\n    _addDaoCardToLayout: function (node, maxNumberCard = 5) {\n        //let cardNodes = node.children || [];\n        //if (cardNodes.length >= 5) {\n        //    return;\n        //}\n        //let remainCount = maxNumberCard - cardNodes.length;\n        //\n        //var selectedCards = this._selectedCardPrefabs(true) || [];\n        //\n        //if (selectedCards.length == 0) {\n        //    return;\n        //}\n        //if (selectedCards.length > remainCount) {\n        //    selectedCards = selectedCards.slice(0, remainCount);\n        //}\n        //\n        //let selectedCardNames = selectedCards.map(function (cardPrefab) {\n        //    return cardPrefab.getComponent('CardPrefab').cardName();\n        //});\n        //\n        //cardNodes.forEach(function (cardTypeNode) {\n        //    selectedCardNames.push(cardTypeNode.getComponent('CardTypeSprite').cardName());\n        //});\n        //\n        //let cardModes = selectedCardNames.map(function (cardName,index) {\n        //    return new KQCard(cardName,null,index);\n        //}).sort(function (c1, c2) {\n        //    return KQCard.sort(c1, c2, false);\n        //});\n\n        //let touCardModes = (node == this.layoutTouDao.node) ? cardModes : this._taoDaoCardModes();\n        //let zhongCardModes = (node == this.layoutZhongDao.node) ? cardModes : this._zhongDaoCardModes();\n        //let weiCardModes = (node == this.layoutWeiDao.node) ? cardModes : this._weiDaoCardModes();\n        //if (!this._isValidCardModes(touCardModes, zhongCardModes, weiCardModes)) {\n        //    this.cacleAutoSelectedCards1();\n        //    cc.log('相公牌：自动选择牌')\n        //    return;\n        //}\n        //\n        //node.removeAllChildren();\n        //\n        //cardModes.forEach(function (cardMode,index) {\n        //    let cardName = cardMode.cardName();\n        //    let cardTypeSprite = cc.instantiate(this.cardTypePrefab);\n        //    cardTypeSprite.names = cardName+'+'+index;\n        //    cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName,index);\n        //    node.addChild(cardTypeSprite);\n        //}.bind(this));\n        //\n        //\n        //selectedCards.forEach(function (node) {\n        //    node.removeFromParent();\n        //});\n        //this._resetCardsPositionY();\n        //this._resetCardsPositionX();\n        //\n        //this._autoActiveDeleteDaoButtons();\n        //\n        //this._reloadKQCardModesInner();\n        //this._resetTypeButtonEnablesWithModels();\n    },\n\n    // 删除 头、中或尾道中的某中牌\n    _deleteDaoCard: function (cardTypeNode, reloadTypeButtonEnables = false) {\n        //let cardName = cardTypeNode.getComponent('CardTypeSprite').cardName();\n        //this.addCard(cardName, true);\n        //\n        //this._resetCardsPositionY();\n        //\n        //cardTypeNode.removeFromParent(true);\n        //this._autoActiveDeleteDaoButtons();\n        //\n        //if (reloadTypeButtonEnables) {\n        //    this._reloadKQCardModesInner();\n        //    this._resetTypeButtonEnablesWithModels();\n        //}\n    },\n\n    // 删除 头道或中道或尾道上所有的 牌\n    _deleteDaoCardsOfLayout: function (daoLayout) {\n        //let cardNodes = Array.from(daoLayout.children);\n        //cardNodes.forEach(this._deleteDaoCard.bind(this));\n        //\n        //this._reloadKQCardModesInner();\n        //this._resetTypeButtonEnablesWithModels();\n    },\n\n    // 判断能否使用选择中的牌\n    // 即：头道要小于中道、中道要小于尾道\n    _isValidCardModes: function (touCardModes, zhongCardModes, weiCardModes) {\n        touCardModes = touCardModes || [];\n        zhongCardModes = zhongCardModes || [];\n        weiCardModes = weiCardModes || [];\n        if (touCardModes.length < 3 || zhongCardModes.length < 5 || weiCardModes.length < 5) {\n            return true;\n        }\n\n        let touScore = KQCard.scoreOfCards(touCardModes);\n        let zhongScore = KQCard.scoreOfCards(zhongCardModes);\n        let weiScore = KQCard.scoreOfCards(weiCardModes);\n        return (touScore < zhongScore) && (zhongScore <= weiScore);\n    },\n\n    // 头道上已有的牌\n    _taoDaoCardModes: function () {\n        return this._cardModesOfCardPrefabs(this.cardAlls.slice(0,3));\n    },\n\n    // 中道上已有的牌\n    _zhongDaoCardModes: function () {\n        //return this._cardModesOfCardPrefabs(this.layoutZhongDao.node.children);\n        return this._cardModesOfCardPrefabs(this.cardAlls.slice(3,8));\n    },\n\n    // 尾道上已有的牌\n    _weiDaoCardModes: function () {\n        //return this._cardModesOfCardPrefabs(this.layoutWeiDao.node.children);\n        return this._cardModesOfCardPrefabs(this.cardAlls.slice(8,13));\n    },\n\n    _cardModesOfCardPrefabs: function (cardTypeNodes) {\n        if (!cardTypeNodes) {\n            return [];\n        }\n\n        let cardModes = cardTypeNodes.map(function (node) {\n            //let component = node.getComponent('CardTypeSprite');\n            //return component.cardMode();._cardModel\n            return node._cardModel;\n        });\n\n        return cardModes || [];\n    },\n\n    // 自动设置 头、中、尾道的删除按钮的可见性\n    _autoActiveDeleteDaoButtons: function () {\n        //this._autoActiveDeleteDaoButton(this.layoutTouDao.node, this.btnDeleteTouDao.node);\n        //this._autoActiveDeleteDaoButton(this.layoutZhongDao.node, this.btnDeleteZhongDao.node);\n        //this._autoActiveDeleteDaoButton(this.layoutWeiDao.node, this.btnDeleteWeiDao.node);\n    },\n\n    _autoActiveDeleteDaoButton: function (layout, button) {\n        //button.active = layout.children.length > 0;\n    },\n\n    // 自动设置 “全部取消”、“确定出牌”、“类型选择”按钮的可见性\n    _autoActiveTypeButtons: function () {\n        //let cardNodes = this.cardsLayout.node.children || [];\n        //let hasCardUnSelected = cardNodes.length > 0;\n        //this.btnDone.node.active = !hasCardUnSelected;\n        //this.btnCancelAll.node.active = this.btnDone.node.active;\n        //this.typeButtonsNode.active = hasCardUnSelected;\n    },\n\n});\n"]}