{"version":3,"sources":["Countdown.js"],"names":["cc","Class","extends","Component","properties","labelTime","Label","_callback","onLoad","string","startCountdown","time","callback","stop","node","active","schedule","_countDown","getComponent","setTime","unschedule","isTimeout","Number","String"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAWL,GAAGM,KADN;AAER;;AAEAC,mBAAW;AAJH,KAHP;;AAUL;AACAC,YAAQ,kBAAY;AAChB,aAAKH,SAAL,CAAeI,MAAf,GAAwB,GAAxB;AACH,KAbI;;AAeL;;;;;;AAMAC,oBAAgB,wBAASC,IAAT,EAAeC,QAAf,EAAyB;AACrC,aAAKC,IAAL;AACA,aAAKN,SAAL,GAAiBK,QAAjB;;AAEA,aAAKE,IAAL,CAAUC,MAAV,GAAmB,IAAnB;AACA,aAAKV,SAAL,CAAeI,MAAf,GAAwB,KAAKE,IAA7B;AACA,aAAKK,QAAL,CAAc,KAAKC,UAAnB,EAA+B,CAA/B,EAAkCN,IAAlC;AACA,aAAKO,YAAL,CAAkB,MAAlB,EAA0BC,OAA1B,CAAkCR,OAAO,GAAzC;AACH,KA7BI;;AA+BLE,UAAM,gBAAW;AACb,aAAKO,UAAL,CAAgB,KAAKH,UAArB;AACA,aAAKH,IAAL,CAAUC,MAAV,GAAmB,KAAnB;;AAEA,YAAI,KAAKR,SAAT,EAAoB;AAChB,gBAAIc,YAAYC,OAAO,KAAKjB,SAAL,CAAeI,MAAtB,KAAiC,CAAjD;AACA,gBAAIG,WAAW,KAAKL,SAApB;AACA,iBAAKA,SAAL,GAAiB,IAAjB;AACAK,qBAASS,SAAT;AACH;;AAED,aAAKd,SAAL,GAAiB,IAAjB;AACH,KA3CI;;AA6CLU,gBAAY,sBAAW;AACnB,YAAIN,OAAOW,OAAO,KAAKjB,SAAL,CAAeI,MAAf,IAAyB,GAAhC,CAAX;AACAE,eAAOA,OAAO,CAAd;;AAEA,YAAIA,QAAQ,CAAZ,EAAe;AACX,iBAAKE,IAAL;AACH;;AAED,aAAKR,SAAL,CAAeI,MAAf,GAAwBc,OAAOZ,IAAP,CAAxB;AACH;;AAtDI,CAAT","file":"Countdown.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Pefabs","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        labelTime: cc.Label,\n        //timeNode: cc.Node,\n\n        _callback: null,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.labelTime.string = \"0\";\n    },\n\n    /**\n     * 开始倒计时\n     * \n     * @param  {Number} time 时长\n     * @param  {Function} callback 倒计时的回调\n     */\n    startCountdown: function(time, callback) {\n        this.stop();\n        this._callback = callback;\n\n        this.node.active = true;\n        this.labelTime.string = \"\" + time;\n        this.schedule(this._countDown, 1, time);\n        this.getComponent(\"time\").setTime(time * 0.5)\n    },\n\n    stop: function() {\n        this.unschedule(this._countDown);\n        this.node.active = false;\n\n        if (this._callback) {\n            let isTimeout = Number(this.labelTime.string) <= 0;\n            let callback = this._callback;\n            this._callback = null;\n            callback(isTimeout);\n        }\n\n        this._callback = null;\n    },\n\n    _countDown: function() {\n        var time = Number(this.labelTime.string || \"0\");\n        time = time - 1;\n\n        if (time <= 0) {\n            this.stop();\n        }\n\n        this.labelTime.string = String(time);\n    },\n\n\n});\n"]}