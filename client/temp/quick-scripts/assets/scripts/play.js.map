{"version":3,"sources":["play.js"],"names":["Socket","require","KQGlobalEvent","ArrayExtension","Manager","AudioManager","KQNativeInvoke","UserModelHelper","Playback","fecha","manager","KQCard","Player","TESHUPAITYPE","isTeShuPai","isLiuDuiBan","isSanShunZi","isSanTaoHua","isQingLong","isYiTiaoLong","isSanTongHuaShun","isSanFenTianXia","isCouYiSe","isSiTaoSanTiao","isWuDuiSanTiao","GAMESTATUS","WAIT_PEOPLE","WAIT_READY","PLAYING","sTitle","sDescription","sId","Play","cc","Class","extends","Component","properties","playerNodes","Node","chatNode","cardTypeCombineNode","typeButtonsNode","phone","Label","labelRoomNumber","labelOverview","labelRemainTime","btnShare","Button","btnReady","btnStartGame","beilv","btnChatVoice","btnChatText","againBtn","startCompareCardsNode","settingNode","VoiceMsgBg","exit","Dissolve","shareBg","totalGameResult","alertRequestExitNode","dissolveAlter","alertRequestExitCountdownNode","alertAnsowerExitNode","contentAnsowerExitNode","alertAnsowerExitResult","alertAnsowerExitCountdownNode","Countdown","labelTime","needCard","alert","coinsContainerNode","btnAlertRequestExitConfirmButton","btnAlertRequestExitCancelButton","autoTishi","Prefab","waitingPrefab","coinsPrefab","playerComps","gongXiNi","teShuPai","cardSpriteAtlas","SpriteAtlas","daoSpriteAtlas","_liuDuiBan","_sanShunZi","_sanTongHua","_yiTiaoLong","_QingLong","_SanTongHuaShun","_SanFenTianXia","_CouYiSe","_SiTaoSanTiao","_WuDuiSanTiao","_playerComponents","_msgControl","_nowTimeAgain","_socket","_userId","_playerInfos","_deskInfo","_gameStatus","_enterTime","_bigRecordInfo","_players","_isComparingCardsNow","_playedCompareCardsIndexs","fapaiNode","liuduiban","santonghua","sanshunzi","quanleida","keyBackListen","_this","systemEvent","on","SystemEvent","EventType","KEY_DOWN","e","keyCode","KEY","back","isNativeIOS","jsb","reflection","callStaticMethod","ANDRIODClassName","onLoad","headCardTime","bg","node","getChildByName","windowP","director","getWinSizeInPixels","scaleX","width","scaleY","height","scale","Math","max","BtnClickGongXiNiComfirm","getComponent","Date","now","forEach","playerComp","playedCompareCardsIndexs","instance","stopHallMusic","bgSound","sys","localStorage","getItem","audioManager","find","setEffectMusicVolum","_initPlayerComponents","_initSelectCardNode","_initOneGameResult","_remainTimeStartUpdate","userInfo","id","_userid","string","active","_registerVoiceNodeEvents","_registerSocketEvent","instances","_gongXiNiShow","isContainPlaybackDatas","startPlayback","playbackNode","_loadDeskInfo","preloadScene","clickOut","timeStart","duration","action","assert","timeStop","timestamp","parse","time","removeItem","floor","setItem","_timeRemainDuration","String","setTime","self","callback","_timeMethod","schedule","unschedule","remain","cIndex","clickReady","_globalMsg","data","roomId","wf","setting3","room","fk","gp","hs","zj","mp","sf","setting4","shareTitle","pj","ds","rs","setting2","js","setting1","desc","isBrowser","window","shareToTimeLine","shareToSession","_initMaPai","playerIndex","map","a","splice","i","length","index1","index2","tmp","push","bind","playsCoins","plays","name","x","y","addChild","cardTypeCombineComp","setFinishSelectCardsCallback","serverCardsInfo","reset","sendPlayCard","onDestroy","offTarget","clickLeaveDesk","createId","loadScene","sendLeaveDesk","clickDissolveDesk","unscheduleAllCallbacks","setMessage","clickExitOut","sendDissolveDesk","clickExit","isPlaybacking","isDeskOver","alert1","stop","clickShareBg","guanzhu","recordShare","recordId","createTime","isNative","IOSClassName","screenshotShare","clickDeskShare","title","description","isNativeAndroid","str","clickShare","wxBg","pyqBg","shareHallTimeline","sendReady","clickStartGame","sendStartGame","updateRoomNumber","roomNumber","gameNumberString","mMax","updateGameStatus","status","isReadyStatus","gameStatus","playerInfo","userInfoSelf","readyStatus","setReadyNodeVisible","players","maxNumber","hideReadyStatus","isGameStart","_startGame","playMusic","no","removeAllChildren","removeChild","_updateUserInfos","showCompareCard","_playFaPaiAnimation","cardTypeCombine","isPlayedCards","_findPlayerInfoByUserId","fapaiAnimation","scheduleOnce","_showCardTypeCombine","player","playFaPaiAnimation","playFaPai","cards","result","isSanTongHua","teShuPaiCards","reloadCards","_findCardsByUserId","moshi","s","number","cardNames","_convertCardsToCardNames","addCardModes","nodes","opacity","_showGongXiNiAndBtnTeShuPai","cacleAutoSelectedCards2","getIsTeShuPai","userId","_initTeShuPaiSprite","clickGongXiNiShow","statues","test","alterCom","dismissAction","children","runAction","repeatForever","rotateBy","_showOneGameResult","_updateUserScores","_isRandomRoom","_isTotalGameOver","_showTotalGameResult","oneGameResult","showDelay","totalGameResultComp","setPlayerInfos","setDismissCallback","sendOnceAgain","clickAgain","sendGetDesckInfo","Event","ReceiveDeskInfo","_socketReceiveDeskInfo","ReceiveOnlineStatus","_socketReciveOnlineStatus","ReceiveChatText","_socketReciveChatTextMessage","ReceiveChatEmoji","_socketReciveChatEmojiMessage","ReceiveRequestDissolve","_socketReceiveRequestExitMessage","ReceiveRequestDissolveResult","_socketReceiveRequestExitResultMessage","ReceiveAudioMessage","_socketReceiveAudioMessage","ReceivePlayCard","_socketReceivePlayCard","ReceiveGameOver","_socketReceiveGameOver","ReceiveFaPai","_socketReciveFaPai","ReceiveReady","_socketReciveReady","ReceiveDissolveDesk","_socketReceiveDissolveDesk","ReceiveLeaveDesk","_socketLeaveDesk","SocketDisconnect","_receiveSocketConnectError","SocketConnectSuccessed","_receiveSocketConnectSuccessed","ReceivePause","_socketReceivePause","ReceiveSelectBeiLv","_ReceiveSelectBeiLv","ReceiveBeiLv","_ReceiveBeiLv","ReceiveQingLi","_ReceiveQingLi","ReceiveOnceAgain","_ReceiveOnceAgain","response","reason","spawn","moveTo","p","fadeOut","sequence","B3","setting5","interactable","selectBl","bl","showBeilv","leaveId","qingli","ql","error","playersIndexAyy","maPai","huaSe","chaoShiChuPai","setting6","duoYiSe","_updatGameOverview","playerIndexs","playersIndex","_injectUserIdToPlayerComponents","_updateBanker","addPlayerInfos","currentUserInfo","showQingli","showFangZhuStatus","isCBegin","is","showReadyStatus","cardInfo","_handleUpdateDeskInfoAboutExitRoom","stopAllActions","readyToCompareCards","showAllCompareCards","logoutAction","setUserInfo","setUserOnlineStatus","message","msg","showChatText","addChatTextMessage","sex","user","playChatAudio","emoji","_loadEmojiFrame","frame","chatMessageNode","showEmoji","alert_bg","btnAgree","btnDisagree","dataInfos","info","alertComp","index","play","img","nickname","loader","load","url","avatarUrl","type","err","SpriteFrame","Sprite","spriteFrame","countdown","startCountdown","isTimeout","clickAgreeOtherPlayerExit","dataInfo","_hideReqestExitNode","cardTime","playSpeakAnimation","playAudioUrl","card","playCard","_getSelfReadyStatus","deskInfo","sendDidReceiveGameOverAction","_isDissvledRoom","bigRecordInfo","isUserReady","_findCurrentUserInfo","_startCompareCards","showNetworkMessage","hiddenNetworkMessage","updateDeskInfo","currentUserIdIndex","findIndex","fixedPlayerIndexs","translationWithStartIndex","playerComponent","userInfos","updateUserInfoWithUsers","updateScore","updateBanker","_findPlayerIndexByUserId","suitColorMap","h","c","d","cardNumber","color","suit","min","bihuase","zuozhuang","putong","wugui","renshu","dianShu","setting7","isRandomDesk","dissolveStatus","playStartCompare","_showCompareCardDetails","comparePlayers1","filter","compareCardsNode","_user","isContainExtra","teShuPlayers","_showCompareCardStep","shootDuration","shootDatas","_shootDatas","shotData","_shotData","homeRunUserId","_homeRunUserId","shotDataTimes","playShoot","fromUserId","toUserId","playHomeRun","_jinBiAction","nextTime","zTime","start","end","coinsContainerAyy","coinsAyy","cScore","numScore","_createJinBiPrefab","coinIncome","coinsAyys","initTime","interval","coins","round","random","cardBackWorldSpace1","convertToWorldSpaceAR","v2","convertToNodeSpaceAR","moveBy","concat","zcScore","coinsAyy1","parent","coinsNode","detail","nextFadeIn","moveSeq","_showCompareCardFinished","showScoreResult","v2Node","instantiate","startTime","comparePlayers","teshuTime","sort","player1","player2","nextCompareScore","co","showNextCompareCards","_santonghuaAnimation","_sanshunziAnimation","_liuduibanAnimation","_qinglongAniamtion","showNextCompareScore","_isGameOver","networkNode","removeSelfAction","removeSelf","comp","onDismissComplete","showAlertMessage","autoDismiss","showCheckMessage","checkNode","hiddenCheckMessage","chatVoiceNode","endRecordTime","TOUCH_START","event","runTime","tishi","fadeIn","finished","callFunc","removeFromParent","VoiceMsgBgAnimation","nativeRecordAction","scaleTo","_isRecording","TOUCH_END","nativeEndRecordAction","TOUCH_CANCEL","uploadFinish","sendAudioMessage","whileLayout","childWhile","whileLayoutInterval","clearInterval","setInterval","layout","cWhile","layoutInterval","pauseMusic","resumeMusic","isDissolving","dissolveAnswerInfo","dissolveLeftTime","dissolveUserId","clickConfirmForceExit","sendForceExitRoom","clickConfirmRequestExit","sendAnswerDissolve","clickDisagreeOtherPlayerExit","playHumanDaQiang","toUserIndex","playShootAnimation","playBulletHoleAnimation","_quanleidaAnimation","allShotData","_deskInfoGameWay","setting","names","_deskInfoNumberOfGame","infos","_deskInfoNumberOfPeople","_deskInfoPayInfo","_deskInfoJiaYiSeInfo","_deskInfoGuiPaiInfo","setting8","_remainTimeUpdate","isTaoShu","getTime","oneHour","mins","secs","minsString","secsString","_handleTheSameOfIPAdress","ipUserInfos","reduce","ips","users","ipAddress","sameIpUsers","ip","_alertSameIpUserInfos","userIds","_didAlertSameIpMessage","gongXiNiShow","module","exports"],"mappings":"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","file":"play.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const Socket = require('socket');\r\nconst KQGlobalEvent = require('KQGlobalEvent');\r\nconst ArrayExtension = require('ArrayExtension');\r\nconst Manager = require('manager');\r\nconst AudioManager = require('AudioManager');\r\nconst KQNativeInvoke = require('KQNativeInvoke');\r\nconst UserModelHelper = require('UserModelHelper');\r\nconst Playback = require('Playback');\r\nconst fecha = require('fecha');\r\nvar manager = require('manager');\r\n/*#####*/\r\nconst KQCard = require('KQCard');\r\n/**/\r\nconst Player = require('Player');\r\n/**/\r\n//const isTeShuPai = require('isTeShuPai'); \r\n//特殊牌类型\r\nvar TESHUPAITYPE = {\r\n    isTeShuPai:false,\r\n    isLiuDuiBan:false,\r\n    isSanShunZi:false,\r\n    isSanTaoHua:false,\r\n\r\n    isQingLong:false,\r\n    isYiTiaoLong:false,\r\n    isSanTongHuaShun:false,\r\n    isSanFenTianXia:false,\r\n    isCouYiSe:false,\r\n    isSiTaoSanTiao:false,\r\n    isWuDuiSanTiao:false\r\n};\r\n\r\nlet GAMESTATUS = {\r\n    WAIT_PEOPLE: 0,    // 等人\r\n    WAIT_READY: 1,     // 等待他人准备\r\n    PLAYING: 2,        // 正在玩游戏\r\n};\r\nvar sTitle = '';\r\nvar sDescription = '';\r\nvar sId = '';\r\n// 布局\r\n//          2\r\n//   3            1\r\n//     self 0\r\nlet Play = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        playerNodes: [cc.Node],\r\n        //playsCoins: [cc.Node],\r\n        chatNode: cc.Node,\r\n        cardTypeCombineNode: cc.Node,\r\n        typeButtonsNode: cc.Node,\r\n        phone:cc.Label,\r\n        labelRoomNumber: cc.Label,\r\n        labelOverview: cc.Label,\r\n        labelRemainTime: cc.Label,\r\n        btnShare: cc.Button,\r\n        btnReady: cc.Button,            // 准备按钮\r\n        btnStartGame: cc.Button,        // 开始按钮\r\n        beilv:cc.Node,                  // 选择倍率节点\r\n        btnChatVoice: cc.Button,\r\n        btnChatText: cc.Button,\r\n        againBtn:cc.Node,\r\n\r\n        startCompareCardsNode: cc.Node,\r\n        settingNode: cc.Node,\r\n        VoiceMsgBg:cc.Node,\r\n        exit:cc.Node,                               // 离开房间节点\r\n        Dissolve:cc.Node,                           // 解散房间节点\r\n        shareBg:cc.Node,                            // 分享背景\r\n        totalGameResult: cc.Node,                   // 结果节点\r\n        alertRequestExitNode: cc.Node,              // 申请退出 Node\r\n        dissolveAlter: cc.Node,                     // 申请退出 Node\r\n        alertRequestExitCountdownNode: cc.Node,     // 申请退出倒计时 Node\r\n        alertAnsowerExitNode: cc.Node,              // 回答申请退出  Node\r\n        contentAnsowerExitNode: cc.Node,            // 回答申请退出头像  Node\r\n        alertAnsowerExitResult: cc.Node,            // 回答申请退出结果  Node\r\n        alertAnsowerExitCountdownNode: cc.Node,     // 回答以上请退出的倒计时\r\n        Countdown:cc.Node,                          // 倒计时\r\n        labelTime:cc.Label,\r\n        needCard:cc.Label,\r\n        alert: cc.Node,\r\n        coinsContainerNode: cc.Node,\r\n        btnAlertRequestExitConfirmButton: cc.Button,\r\n        btnAlertRequestExitCancelButton: cc.Button,\r\n\r\n        autoTishi:cc.Prefab,\r\n        waitingPrefab: cc.Prefab,\r\n        coinsPrefab: cc.Prefab,\r\n        playerComps: [Player],\r\n\r\n        gongXiNi:cc.Node,\r\n        teShuPai:cc.Node,\r\n\r\n        cardSpriteAtlas:cc.SpriteAtlas,\r\n        daoSpriteAtlas:cc.SpriteAtlas,\r\n\r\n        _liuDuiBan:false,\r\n        _sanShunZi:false,\r\n        _sanTongHua:false,\r\n        _yiTiaoLong:false,\r\n\r\n        _QingLong:false,\r\n        _SanTongHuaShun:false,\r\n        _SanFenTianXia:false,\r\n        _CouYiSe:false,\r\n        _SiTaoSanTiao:false,\r\n        _WuDuiSanTiao:false,\r\n\r\n        _playerComponents: null,\r\n        _msgControl: null,\r\n        _nowTimeAgain:0,\r\n\r\n        _socket: null,\r\n        _userId: 0,\r\n        _playerInfos: null,\r\n        _deskInfo: null,   // createTime 创建时间  isDissolving 表示是否正在解散 dissolveLeftTime 离解散剩余多长时间 dissolveAnswerInfo [处理过的人的信息]\r\n        _gameStatus: GAMESTATUS.WAIT_PEOPLE,\r\n        _enterTime: null,\r\n        _bigRecordInfo:null,\r\n        _players:null,\r\n        /**/\r\n        _isComparingCardsNow: false, // 是否正在比牌\r\n        _playedCompareCardsIndexs: [], // 已经播放过比牌的局数\r\n        /**/\r\n        fapaiNode: cc.Prefab,\r\n        liuduiban:cc.Prefab,\r\n        santonghua:cc.Prefab,\r\n        sanshunzi:cc.Prefab,\r\n        quanleida:cc.Prefab,\r\n    },\r\n    keyBackListen:function () {\r\n        var _this = this;\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(e) {\r\n            if(e.keyCode == cc.KEY.back) {\r\n                if(!KQNativeInvoke.isNativeIOS()){\r\n                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"backToDesk\", \"()V\");\r\n                }\r\n            }\r\n        },this);\r\n    },\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this.keyBackListen();\r\n        this.headCardTime = 0.85;\r\n        var bg = this.node.getChildByName(\"room_bg\");\r\n        var windowP = cc.director.getWinSizeInPixels();\r\n        var scaleX = windowP.width/bg.width;\r\n        var scaleY = windowP.height/bg.height;\r\n        var scale = Math.max(scaleX,scaleY);\r\n        bg.scaleX = scale;\r\n        bg.scaleY = scale;\r\n\r\n        this.BtnClickGongXiNiComfirm = this.cardTypeCombineNode.getComponent(\"CardTypeCombine\").BtnClickGongXiNiComfirm;\r\n        this._enterTime = Date.now();\r\n        /**/\r\n        this.playerComps.forEach(playerComp => {\r\n            playerComp.playedCompareCardsIndexs = this._playedCompareCardsIndexs;\r\n        });\r\n        /**/\r\n        /*AudioManager.instance.playDeskMusic();*/\r\n\r\n        AudioManager.instance.stopHallMusic();\r\n        var bgSound = cc.sys.localStorage.getItem(\"bgSound\");\r\n        if(bgSound == 0){\r\n            var audioManager = cc.find('AudioManager');\r\n            audioManager = audioManager.getComponent('AudioManager');\r\n            audioManager.setEffectMusicVolum(bgSound);\r\n        }\r\n\r\n        this._initPlayerComponents();\r\n        this._initSelectCardNode();\r\n        this._initOneGameResult();\r\n        this._remainTimeStartUpdate();\r\n\r\n        this._userId = Socket.instance.userInfo.id;\r\n        this._msgControl = this.chatNode.getComponent('MsgControl');\r\n        this._userId = Socket.instance.userInfo.id;\r\n        this.beilv.getComponent(\"selectbeilv\")._userid = this._userId;\r\n        //this.settingNode.getComponent(\"Setting\").hideSwitch();\r\n        this.labelRoomNumber.string = \"\";\r\n        this.labelRemainTime.node.active = false;\r\n\r\n        this._registerVoiceNodeEvents();\r\n        this._registerSocketEvent();\r\n\r\n        Play.instances = this;\r\n        this._gongXiNiShow(false);\r\n        if (Playback.instance.isContainPlaybackDatas()) {\r\n            Playback.instance.startPlayback();\r\n            this.playbackNode.active = true;\r\n            this.btnChatVoice.node.active = false;\r\n            //this.cardsFromArray.node.active = false;\r\n        } else {\r\n            this._loadDeskInfo();\r\n        }\r\n\r\n\r\n        this._socket = Socket.instance;\r\n\r\n\r\n        cc.director.preloadScene('hall',function(){\r\n            cc.director.preloadScene('login');\r\n        });\r\n\r\n        cc.clickOut = false;\r\n        //this.timeStart(5);\r\n    },\r\n\r\n    timeStart: function (duration,action) {\r\n        cc.assert(duration > 0);\r\n        this.timeStop();\r\n        this.Countdown.active = true;\r\n        if(action != \"ready\"){\r\n            var timestamp = cc.sys.localStorage.getItem(\"timestamp\");  // 获取本地存储的时间戳\r\n            if(timestamp){  // 如果有则证明玩家是重新进来了的\r\n                var now = Date.parse(new Date());\r\n                var time = duration*1000;\r\n                if(now - timestamp > time){ // 超时\r\n                    if(now - timestamp < 2*time){\r\n                        duration = 5;  // 玩家可能出于其他原因退出游戏导致超时，为其提供5秒时间整理牌型（这已经是很仁慈的了）。\r\n                    }else{\r\n                        cc.sys.localStorage.removeItem(\"timestamp\");\r\n                    }\r\n                }else{\r\n                    duration = Math.floor( duration - (now - timestamp)/1000);\r\n                }\r\n            }else{  // 如果没有时间戳，则保存，为玩家退出游戏保留证据；\r\n                var timestamp = Date.parse(new Date());     \r\n                cc.sys.localStorage.setItem('timestamp',timestamp);\r\n            }\r\n        }\r\n        this._timeRemainDuration = duration;\r\n        this.labelTime.string = String(duration);\r\n        this.Countdown.getComponent(\"time\").setTime(duration * 0.5);\r\n        var self = this;\r\n        this.callback = function(){\r\n            self._timeMethod(action);\r\n        };\r\n         this.schedule(this.callback, 1, duration);\r\n    },\r\n\r\n    timeStop: function () {\r\n        this.unschedule(this.callback);\r\n        this.Countdown.active = false;\r\n    },\r\n\r\n    _timeMethod: function (action) {\r\n        this._timeRemainDuration = this._timeRemainDuration - 1;\r\n\r\n        var remain = Math.max(this._timeRemainDuration, 0);\r\n        this.labelTime.string = (remain < 10 && remain > 0) ? ('0' + remain) : remain;\r\n\r\n        if (this._timeRemainDuration <= 0) {\r\n            this.timeStop();\r\n            if(action == \"ready\"){\r\n                if(this._deskInfo.cIndex>0){\r\n                    this.clickReady();\r\n                }\r\n            }\r\n            cc.sys.localStorage.removeItem(\"timestamp\");\r\n            return;\r\n        }\r\n    },\r\n    \r\n    _globalMsg:function(data){\r\n        //if(!cc.sys.isNative){\r\n        var roomId = data.roomId;\r\n        var wf = data.setting3;  ///[疯狂场,鬼牌,比花色,坐庄,马牌]\r\n        var room = \"房号：\"+roomId;\r\n        var fk = wf[0]?\"疯狂场 \":\"普通场 \";         // 疯狂场\r\n        var gp = wf[1]?\"鬼牌 \":\"无鬼 \";             // 鬼牌\r\n        var hs = wf[2]?\"比花色 \":\"不比花色 \";       // 比花色\r\n        var zj = wf[3]?\"坐庄 \":\"不坐庄 \";           // 庄家\r\n        var mp = wf[4]?\"买马 \":\"不买马 \";           // 马牌\r\n        var sf = \"房费:\"+(data.setting4?((data.setting4==1)?\"赢者扣 \":\"房主扣 \"):\"平摊 \");  //收费\r\n        var shareTitle = room+\" 模式:\"+zj+sf;\r\n\r\n        var pj = [\"5局 \",\"10局 \",\"20局 \"];  //牌局\r\n        var ds = [\"4人不加色 \",\"5人加一色 \",\"6人二色 \",\"7人加三色 \"];  //多色\r\n        var rs = ds[data.setting2]+\"\";\r\n        var js = pj[data.setting1-2];\r\n        var desc = '[大众十三水] '+zj+fk+mp+gp+sf+rs+js+\" 点击直接进入房间\";\r\n\r\n        sTitle = shareTitle;\r\n        sDescription = desc;\r\n        sId = 'roomId='+roomId;\r\n\r\n        cc.sys.localStorage.setItem('roomId',roomId);\r\n        cc.sys.localStorage.setItem('shareTitle',shareTitle);\r\n        cc.sys.localStorage.setItem('desc',desc);\r\n\r\n        if(cc.sys.isBrowser) {\r\n            if(window.shareToTimeLine) {\r\n                window.shareToTimeLine();\r\n            }\r\n            if(window.shareToSession) {\r\n                window.shareToSession();\r\n            }\r\n        }\r\n        //}\r\n    },\r\n\r\n\r\n\r\n    /*#####*/\r\n    /*显示马牌*/\r\n    _initMaPai:function () {\r\n\r\n    },\r\n\r\n    _initPlayerComponents: function (playerIndex) {\r\n        this._playerComponents = this.playerNodes.map(function (node) {\r\n            return node.getComponent('Player');\r\n        });\r\n\r\n        if(!playerIndex) {\r\n            playerIndex = [0,1,2,3,4,5];\r\n        }\r\n\r\n        var a = this._playerComponents.splice(1,7);\r\n\r\n        for(var i = 0; i < playerIndex.length - 1; i++){\r\n            var index1 = playerIndex[i];\r\n            var index2 = playerIndex[i + 1];\r\n            var tmp = null;\r\n            tmp = a[index1];\r\n            a[index1] = a[index2];\r\n            a[index2] = tmp ;\r\n        }\r\n\r\n        a.forEach(function(node){this._playerComponents.push(node);}.bind(this));\r\n\r\n        if(this.playsCoins && this.playsCoins.length > 0){\r\n            this.playsCoins.forEach(function(node){\r\n                node.active = false;\r\n            }.bind(this));\r\n        }\r\n\r\n        this.playsCoins = [];\r\n\r\n        this._playerComponents.forEach(function(plays,i){\r\n            var name = \"coins\" + i;\r\n\r\n            var node = new cc.Node();\r\n\r\n            node.name = name;\r\n\r\n            node.x = plays.node.x;\r\n\r\n            node.y = plays.node.y;\r\n\r\n            this.node.addChild(node);\r\n\r\n            this.playsCoins.push(node);\r\n\r\n        }.bind(this));\r\n\r\n    },\r\n\r\n    _initSelectCardNode: function () {\r\n        let self = this;\r\n        let cardTypeCombineComp = this.cardTypeCombineNode.getComponent('CardTypeCombine');\r\n        cardTypeCombineComp.setFinishSelectCardsCallback(function (serverCardsInfo) {\r\n            cardTypeCombineComp.reset();\r\n            Socket.sendPlayCard(self._userId, serverCardsInfo);\r\n            self.cardTypeCombineNode.active = false;\r\n        });\r\n    },\r\n\r\n    /**/\r\n    _initOneGameResult: function () {\r\n        const self = this;\r\n        // this.oneGameResult.setCloseCallback = function () {\r\n        //     if (self._isRandomRoom()) {\r\n        //         cc.director.loadScene('hall');\r\n        //     }\r\n        // };\r\n    },\r\n\r\n\r\n    onDestroy: function () {\r\n        KQGlobalEvent.offTarget(this);\r\n    },\r\n\r\n    clickLeaveDesk:function(){                          // 点击离开桌子\r\n        if (this._deskInfo.cIndex == 0) {               // 还没开始可以退出房间\r\n            if(this._deskInfo.createId == this._userId){\r\n                cc.director.loadScene('hall');\r\n            }else{\r\n                Socket.sendLeaveDesk(this._userId);\r\n            }\r\n        }\r\n    },\r\n    clickDissolveDesk :function(){                      // 点击解散桌子\r\n        if(this._deskInfo.createId == this._userId){    // 只有房主才能解散桌子\r\n            this.btnAlertRequestExitCancelButton.node.active = true;\r\n            this.btnAlertRequestExitConfirmButton.node.active = true;\r\n            let alert = this.alertRequestExitNode.getComponent('alert');\r\n            alert.unscheduleAllCallbacks();\r\n            alert.setMessage(\"是否要解散房间\");\r\n            alert.alert();\r\n        }\r\n    },\r\n\r\n    clickExitOut:function(){\r\n        Socket.sendDissolveDesk(this._userId);\r\n    },\r\n\r\n    //解散退出房间\r\n    clickExit: function () {\r\n        if (Playback.instance.isPlaybacking()) {\r\n            cc.director.loadScene('hall');\r\n            return;\r\n        }\r\n        /**/\r\n        if (this._deskInfo && this._deskInfo.isDeskOver) {\r\n            if (!this._isComparingCardsNow) {\r\n                // 如果房间已结束，并且不是正在播放打牌动画, 则直接离开房间\r\n                cc.director.loadScene('hall');\r\n            }\r\n            return;\r\n        }\r\n        /**/\r\n        //if (this._isRandomRoom()) {\r\n        //    this.alertForceExitNode.getComponent('alert').alert();\r\n        //    return;\r\n        //}\r\n        if (this._deskInfo.cIndex == 0) {\r\n            if (this._deskInfo.createId == this._userId) {\r\n                let alert1 = this.dissolveAlter.getComponent('alert');\r\n                alert1.alert();\r\n            } else {\r\n                Socket.sendLeaveDesk(this._userId);\r\n            }\r\n            return;\r\n        }\r\n        this.btnAlertRequestExitCancelButton.node.active = true;\r\n        this.btnAlertRequestExitConfirmButton.node.active = true;\r\n\r\n        let alert = this.alertRequestExitNode.getComponent('alert');\r\n        alert.unscheduleAllCallbacks();\r\n        alert.setMessage(\"是否解散房间？\");\r\n        alert.alert();\r\n\r\n        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();\r\n    },\r\n    //不解散退出房间\r\n    clickOut: function () {\r\n        if (this._deskInfo.cIndex == 0) {\r\n            if (this._deskInfo.createId == this._userId) {\r\n                cc.clickOut = true;\r\n                cc.director.loadScene('hall');\r\n                return;\r\n            } else {\r\n                Socket.sendLeaveDesk(this._userId);\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    clickShareBg:function(){\r\n        cc.find(\"Canvas/shareBg\").active = false; \r\n        this.shareBg.active = false;\r\n    },\r\n     guanzhu:function(){\r\n        // var url = \"http://www.honggefeng.cn/gzh/index.html\";\r\n        // cc.sys.openURL(url)\r\n    },\r\n    recordShare:function(){\r\n        if(this._deskInfo.recordId){\r\n            var shareTitle = \"[大众十三水]战绩\";\r\n            var roomId =\"房间号：\"+this._deskInfo.roomId;\r\n            var pj = [\"5 \",\"10 \",\"20 \"];  //牌局\r\n            var js = \"局数：\"+pj[this._deskInfo.setting1-2];\r\n            var time = \"时间：\"+this._deskInfo.createTime ;\r\n            var desc = roomId+js+time+\"点击查看详情\";\r\n\r\n            var recordId = this._deskInfo.recordId;\r\n            cc.sys.localStorage.setItem(\"shareTitle\",shareTitle);\r\n            cc.sys.localStorage.setItem(\"desc\",desc);\r\n            cc.sys.localStorage.setItem(\"recordId\",recordId);\r\n            cc.sys.localStorage.setItem(\"roomId\",'');\r\n\r\n            sTitle = shareTitle;\r\n            sDescription = desc;\r\n            sId = 'roomId='+roomId;\r\n            if(recordId){\r\n                sId = 'recordId='+recordId;\r\n            }\r\n\r\n            if(cc.sys.isBrowser){\r\n                if(window.shareToTimeLine) {\r\n                    window.shareToTimeLine();\r\n                }\r\n                if(window.shareToSession) {\r\n                    window.shareToSession();\r\n                }\r\n            }\r\n        };\r\n        if(!cc.sys.isNative){\r\n             cc.find(\"Canvas/shareBg\").active = true;\r\n        }else{\r\n            if (KQNativeInvoke.isNativeIOS()) {\r\n                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxScreenShareFriend\",);\r\n            }\r\n            else {//Android\r\n                KQNativeInvoke.screenshotShare();\r\n            }\r\n        }\r\n    },\r\n    // 点击桌面分享\r\n    clickDeskShare :function(){\r\n        //this._globalMsg(this._deskInfo);\r\n        if(!cc.sys.isNative){\r\n            var shareBg = cc.find(\"Canvas/shareBg\"); \r\n            shareBg.active = true;\r\n            //var wxBg = this.shareBg.getChildByName(\"wx\");\r\n            //var pyqBg = this.shareBg.getChildByName(\"PYQ\");\r\n            //wxBg.active = true;\r\n            //pyqBg.active = false;\r\n            //this.shareBg.active = true;\r\n        }\r\n        var id=sId;\r\n        var title = sTitle;\r\n        var description = sDescription;\r\n        if (KQNativeInvoke.isNativeIOS()) {\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxShareFriend:description:\",id, description,title);\r\n        } else if (KQNativeInvoke.isNativeAndroid()) {//Android\r\n            var str = \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\";\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxShareFriend\",str, id, description,title);\r\n        }\r\n    },\r\n    //点击分享按钮\r\n    clickShare: function () {\r\n        //this._globalMsg(this._deskInfo);\r\n        if(!cc.sys.isNative){\r\n            var wxBg = this.shareBg.getChildByName(\"wx\");\r\n            var pyqBg = this.shareBg.getChildByName(\"PYQ\");\r\n            wxBg.active = true;\r\n            pyqBg.active = false;\r\n            this.shareBg.active = true;\r\n        }\r\n        var id=sId;\r\n        var title = sTitle;\r\n        var description = sDescription;\r\n\r\n        // let roomId = String(this._deskInfo.roomId);\r\n        // var description = \"大众十三水 玩法:\"\r\n        // description = description + \" \" + this._deskInfoNumberOfPeople();\r\n        // description = description + \",\" + this._deskInfoPayInfo();\r\n        // description = description + \" \" + this._deskInfoNumberOfGame();\r\n\r\n\r\n        if (KQNativeInvoke.isNativeIOS()) {\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxShareFriend:description:\",id, description,title);\r\n        } else if (KQNativeInvoke.isNativeAndroid()) {//Android\r\n            var str = \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\";\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxShareFriend\",str, id, description,title);\r\n        }\r\n    },\r\n\r\n    //分享到朋友圈\r\n    shareHallTimeline:function(){\r\n        if(!cc.sys.isNative){\r\n            var wxBg = this.shareBg.getChildByName(\"wx\");\r\n            var pyqBg = this.shareBg.getChildByName(\"PYQ\");\r\n            wxBg.active = false;\r\n            pyqBg.active = true;\r\n            this.shareBg.active = true;\r\n        }else{\r\n            var id=sId;\r\n            var title = sTitle;\r\n            var description = sDescription;\r\n\r\n            if (KQNativeInvoke.isNativeIOS()) {\r\n                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxShareHallTimeline\",id, description,title);\r\n            }\r\n            else {//Android\r\n                var str = \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\";\r\n                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxShareHallTimeline\", str,id, description,title);\r\n            }\r\n        }\r\n    },\r\n\r\n    //点击准备按钮\r\n    clickReady: function () {\r\n        this.btnReady.node.active = false;\r\n        this.btnShare.node.active = false;\r\n        this.timeStop();\r\n        Socket.sendReady(this._userId);\r\n    },\r\n\r\n    //点击开始按钮\r\n    clickStartGame: function () {\r\n        this.btnReady.node.active = false;\r\n        this.btnShare.node.active = false;\r\n        this.btnStartGame.node.active = false;\r\n        Socket.sendStartGame(this._userId);\r\n    },\r\n\r\n    updateRoomNumber: function (roomNumber) {\r\n        let gameNumberString = \"\";\r\n        if (this._deskInfo.setting1 != 0 && this._deskInfo.setting1 != 1) {\r\n            gameNumberString = \"局数 : \" + \"\" + this._deskInfo.cIndex + \"/\" + this._deskInfo.mMax;\r\n        } else if (this._deskInfo.setting1 == 0) {\r\n            gameNumberString = \"局数 : 10局\";\r\n        } else if (this._deskInfo.setting1 == 1) {\r\n            gameNumberString = \"局数 : 20局\";\r\n        }\r\n        this.labelRoomNumber.string = \"房号 : \" + \"\" + roomNumber + \"    \" + gameNumberString;\r\n    },\r\n\r\n    updateGameStatus: function (status = GAMESTATUS.WAIT_PEOPLE) {\r\n        this._gameStatus = status;\r\n\r\n        this.btnShare.node.active = (status == GAMESTATUS.WAIT_PEOPLE);\r\n        this.btnReady.node.active = (status == GAMESTATUS.WAIT_READY);\r\n        this.isReadyStatus();\r\n    },\r\n\r\n    gameStatus: function () {\r\n        return this._gameStatus;\r\n    },\r\n    isReadyStatus: function () {\r\n        if(this._playerInfos && this._playerInfos.length>0) {\r\n            this._playerInfos.forEach(function(playerInfo){\r\n                var userInfoSelf=cc.find('Canvas/playSelf/userInfoSelf');\r\n                if(playerInfo.id == this._userId) {\r\n                    if(!playerInfo.readyStatus && !this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas()) {\r\n                        userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);\r\n                        if (this._deskInfo.cIndex == 0) {//一局还没开始\r\n                            this.btnReady.node.active = false;\r\n                            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {\r\n                                this.btnShare.node.active = true;\r\n                            }else{\r\n                                this.btnShare.node.active = false;\r\n                            }\r\n\r\n                            if(this._deskInfo.players.length >= 2 && this._deskInfo.createId == this._userId){//是否是房主\r\n                                this.btnStartGame.node.active = true;\r\n                            }else{\r\n                                this.btnStartGame.node.active = false;\r\n                            }\r\n                        }else{\r\n                            this.btnReady.node.active = true;\r\n                            this.btnShare.node.active = false;\r\n                            this.btnStartGame.node.active = false;\r\n                            this.btnStartGame.node.active = false;\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.btnReady.node.active = false;\r\n                        this.btnShare.node.active = false;\r\n                        this.btnStartGame.node.active = false;\r\n                        if(!this._isComparingCardsNow) {\r\n                            userInfoSelf.getComponent('userInfo').setReadyNodeVisible(true);\r\n                        }else{\r\n                            this._playerComponents.forEach(function(playerComp){\r\n                                playerComp.hideReadyStatus();\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                //console.log(this._isComparingCardsNow)\r\n                //console.log(\"准备状态--------\")\r\n                if(this._isComparingCardsNow) {//\r\n                    this._playerComponents.forEach(function(playerComp){\r\n                        playerComp.hideReadyStatus();\r\n                    });\r\n                }\r\n            }.bind(this));\r\n        }\r\n    },\r\n\r\n    isGameStart: function () {\r\n        if (this._deskInfo.cIndex == 0) {//一局还没开始\r\n            if(this._deskInfo.createId == this._userId){//是否是房主\r\n                if(!this._isComparingCardsNow && !Playback.instance.isPlaybacking()\r\n                    && !Playback.instance.isContainPlaybackDatas() && this._deskInfo.players.length >= 2){\r\n                    this.btnStartGame.node.active = true;\r\n                    this.btnReady.node.active = false;\r\n                }else{\r\n                    this.btnStartGame.node.active = false;\r\n                }\r\n            }\r\n            else{\r\n                this.btnStartGame.node.active = false;\r\n            }\r\n\r\n            if(this._deskInfo.players.length < this._deskInfo.maxNumber){\r\n                this.btnShare.node.active = true;\r\n            }else{\r\n                this.btnShare.node.active = false;\r\n            }\r\n        }else{\r\n            this.btnStartGame.node.active = false;\r\n            this.btnShare.node.active = false;\r\n        }\r\n    },\r\n\r\n    /// 游戏动画\r\n    _startGame: function (playMusic) {\r\n\r\n        if (this.gameStatus() == GAMESTATUS.PLAYING) {\r\n            return;\r\n        }\r\n        //this._playerInfos = players;\r\n        //this._playerComponents.forEach(function (player) {\r\n        //\r\n        //});\r\n        this._playerComponents.forEach(function (playerComp) {\r\n            playerComp.reset();  //#####\r\n            playerComp.hideReadyStatus();\r\n        });\r\n        this.teShuPai.active = false;\r\n\r\n        this.unscheduleAllCallbacks();\r\n\r\n        this.playsCoins.forEach(function(no){if(no) no.removeAllChildren();});\r\n\r\n        this._playerComponents.forEach(function(plays,i){\r\n\r\n            var name = \"coins\" + i;\r\n\r\n            var node = this.node.getChildByName(name);\r\n\r\n            if(node){\r\n                node.removeAllChildren();\r\n                this.node.removeChild(node);\r\n            }\r\n\r\n        }.bind(this));\r\n        // cc.log(this.node)\r\n        // cc.log('------709')\r\n        this._updateUserInfos(this._playerInfos);\r\n        this.showCompareCard();\r\n        this._isComparingCardsNow = true;\r\n        this.updateGameStatus(GAMESTATUS.PLAYING);\r\n        this._playFaPaiAnimation(playMusic);\r\n\r\n        let cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');\r\n\r\n        cardTypeCombine.reset();\r\n\r\n        cardTypeCombine.node.active = false;\r\n\r\n        if (!UserModelHelper.isPlayedCards(this._findPlayerInfoByUserId(this._userId))) {\r\n            this.node.getComponent(\"animation\").fapaiAnimation();\r\n            this.scheduleOnce(function () {\r\n                this._showCardTypeCombine();\r\n            }.bind(this), 1.9);\r\n        }\r\n\r\n    },\r\n\r\n    _playFaPaiAnimation: function (playMusic) {\r\n        this._playerComponents.forEach(function (player){\r\n            player.playFaPaiAnimation();\r\n        });\r\n        if(playMusic){\r\n            AudioManager.instance.playFaPai();\r\n        }\r\n    },\r\n\r\n    /*#####*/\r\n    //是否特殊牌\r\n    isTeShuPai: function(cards){\r\n        var result = KQCard.isTeShuPai(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isTeShuPai = true;\r\n        }else{\r\n            TESHUPAITYPE.isTeShuPai = false;\r\n        }\r\n        return result;\r\n    },\r\n    //是否一条龙\r\n    isYiTiaoLong: function(cards) {\r\n        var result = KQCard.isYiTiaoLong(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isYiTiaoLong = true;\r\n        }else{\r\n            TESHUPAITYPE.isYiTiaoLong = false;\r\n        }\r\n        return result;\r\n    },\r\n    //是否六对半\r\n    isLiuDuiBan: function(cards) {\r\n        var result = KQCard.isLiuDuiBan(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isLiuDuiBan = true;\r\n        }else{\r\n            TESHUPAITYPE.isLiuDuiBan = false;\r\n        }\r\n    },\r\n    //是否三顺子\r\n    isSanShunZi: function(cards){\r\n        var result = KQCard.isSanShunZi(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isSanShunZi = true;\r\n        }else{\r\n            TESHUPAITYPE.isSanShunZi = false;\r\n        }\r\n    },\r\n    //是否三同花\r\n    isSanTongHua: function(cards) {\r\n        var result = KQCard.isSanTongHua(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isSanTaoHua = true;\r\n        }else{\r\n            TESHUPAITYPE.isSanTaoHua = false;\r\n        }\r\n    },\r\n    //是否三同花顺\r\n    isSanTongHuaShun: function(cards) {\r\n        var result = KQCard.isSanTongHuaShun(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isSanTongHuaShun = true;\r\n        }else{\r\n            TESHUPAITYPE.isSanTongHuaShun = false;\r\n        }\r\n    },\r\n    //是否是清龙\r\n    isQingLong: function(cards) {\r\n        var result = KQCard.isQingLong(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isQingLong = true;\r\n        }else{\r\n            TESHUPAITYPE.isQingLong = false;\r\n        }\r\n    },\r\n    //是否是 “三分天下”\r\n    isSanFenTianXia: function(cards) {\r\n        var result = KQCard.isSanFenTianXia(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isSanFenTianXia = true;\r\n        }else{\r\n            TESHUPAITYPE.isSanFenTianXia = false;\r\n        }\r\n    },\r\n    //是否是 “四套三条”\r\n    isSiTaoSanTiao: function(cards) {\r\n        var result = KQCard.isSiTaoSanTiao(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isSiTaoSanTiao = true;\r\n        }else{\r\n            TESHUPAITYPE.isSiTaoSanTiao = false;\r\n        }\r\n    },\r\n    //是否是五对三条\r\n    isWuDuiSanTiao: function(cards) {\r\n        var result = KQCard.isWuDuiSanTiao(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isWuDuiSanTiao = true;\r\n        }else{\r\n            TESHUPAITYPE.isWuDuiSanTiao = false;\r\n        }\r\n    },\r\n    //是否是凑一色\r\n    isCouYiSe: function(cards) {\r\n        var result = KQCard.isCouYiSe(cards);\r\n        if(result){\r\n            TESHUPAITYPE.isCouYiSe = true;\r\n        }else{\r\n            TESHUPAITYPE.isCouYiSe = false;\r\n        }\r\n    },\r\n    /*#####*/\r\n\r\n    /*显示配牌页面*/\r\n    _showCardTypeCombine: function () {\r\n        if (Playback.instance.isPlaybacking()) {\r\n            return;\r\n        }\r\n        if (this.cardTypeCombineNode.active) {\r\n            return;\r\n        }\r\n\r\n        this.startCompareCardsNode.active = false;\r\n        this.btnReady.node.active = false;\r\n        this.btnShare.node.active = false;\r\n\r\n        cc.teShuPaiCards = null;\r\n\r\n        let cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');\r\n        cardTypeCombine.reset();\r\n        cardTypeCombine.reloadCards([]);\r\n        cardTypeCombine.node.active = true;\r\n        cardTypeCombine.timeStart(60);\r\n        this.timeStart(60,\"\");\r\n        this.cardTypeCombineNode.scale = 1;\r\n\r\n        let cards = this._findCardsByUserId(this._userId);\r\n        //\"1_9\"\"3_9\"\"2_9\"\r\n        // \"2_7\"\"1_7\"\"3_3\"\"2_12\"\r\n        //\"1_1\"\"1_3\"\"2_6\"\"1_11\"\"2_1\"\"3_4\"//\r\n        // if(this._userId == 2){\r\n        //     cards = [{suit: \"d\", number:2},{suit: \"d\", number:2}, {suit: \"d\", number:2},//青龙\r\n\r\n        //         {suit: \"h\", number:2}, {suit: \"d\", number:2},\r\n        //         {suit: \"c\", number:3}, {suit: \"c\", number:3}, {suit: \"c\", number:3},\r\n\r\n        //         {suit: \"d\", number:3}, {suit: \"d\", number:4},\r\n        //         {suit: \"d\", number:4}, {suit: \"d\", number:4}, {suit: \"d\", number:4}];\r\n        // }\r\n        //if(this._userId == 1){d\r\n        //    cards = [{suit: \"c\", number:1},{suit: \"h\", number:1}, {suit: \"s\", number:1},//青龙\r\n        //\r\n        //        {suit: \"h\", number:8}, {suit: \"c\", number:2},\r\n        //        {suit: \"d\", number:8}, {suit: \"h\", number:8}, {suit: \"d\", number:20},\r\n        //        {suit: \"h\", number:9}, {suit: \"s\", number:9},\r\n        //        {suit: \"s\", number:9}, {suit: \"s\", number:9}, {suit: \"h\", number:9}];\r\n        //}\r\n        // else if(this._userId == 6){\r\n        //     cards = [{suit: \"d\", number:11},{suit: \"d\", number:13}, {suit: \"d\", number:11},//青龙\r\n        //         {suit: \"d\", number:1}, {suit: \"d\", number:1},\r\n        //         {suit: \"h\", number:2}, {suit: \"h\", number:4}, {suit: \"h\", number:9},\r\n        //         {suit: \"s\", number:7}, {suit: \"s\", number:7},\r\n        //         {suit: \"s\", number:5}, {suit: \"s\", number:5}, {suit: \"s\", number:5},];\r\n        // }\r\n\r\n        //else if(this._userId == 3){\r\n        //    cards = [{suit: \"d\", number:4},{suit: \"d\", number:13}, {suit: \"s\", number:13},//青龙\r\n        //        {suit: \"d\", number:6}, {suit: \"s\", number:7},\r\n        //        {suit: \"d\", number:8}, {suit: \"c\", number:9}, {suit: \"c\", number:10},\r\n        //        {suit: \"s\", number:1}, {suit: \"s\", number:3},\r\n        //        {suit: \"s\", number:10}, {suit: \"s\", number:8}, {suit: \"s\", number:12},];\r\n        //}\r\n        cc.moshi = 0;\r\n        for(var i = 0; i < cards.length; i++){\r\n            var s = cards[i].number;\r\n            if(s >= 20){\r\n                cc.moshi = 1;\r\n                break;\r\n            }\r\n        }\r\n        let cardNames = this._convertCardsToCardNames(cards);\r\n        cardTypeCombine.reloadCards(cardNames);\r\n        cardTypeCombine.addCardModes(cardNames);\r\n\r\n        //cc.from.moshi == 0选择了庄家模式\r\n\r\n        if(cc.moshi != 1){\r\n            this.isTeShuPai(cards);\r\n            this.isQingLong(cards);\r\n            this.isYiTiaoLong(cards);\r\n            this.isLiuDuiBan(cards);\r\n            this.isSanShunZi(cards);\r\n            this.isSanTongHua(cards);\r\n            if(TESHUPAITYPE.isTeShuPai){\r\n                this.cardTypeCombineNode.scale = 0;\r\n                var nodes = this.gongXiNi.getChildByName(\"bg\");\r\n                nodes.opacity = 240;\r\n            }\r\n            //this.isSanTongHuaShun(cards);\r\n            //this.isSanFenTianXia(cards);\r\n            //this.isSiTaoSanTiao(cards);\r\n            //this.isWuDuiSanTiao(cards);\r\n            //this.isCouYiSe(cards);\r\n            this._showGongXiNiAndBtnTeShuPai();\r\n        }\r\n        cardTypeCombine.cacleAutoSelectedCards2();\r\n\r\n        if(cc.moshi == 1) cc.teShuPaiCards = null;\r\n        this._playerComponents.forEach(function (playerComp) {\r\n            playerComp.reset();  //#####\r\n            playerComp.hideReadyStatus();\r\n        });\r\n    },\r\n\r\n    getIsTeShuPai: function (userId) {\r\n        var cards = this._findCardsByUserId(userId);\r\n        return this.isTeShuPai(cards);\r\n    },\r\n\r\n    /*#####检测特殊牌类型，显示相对应的恭喜你页面和特殊牌精灵*/\r\n    _showGongXiNiAndBtnTeShuPai: function () {\r\n        /*如果有特殊牌*/\r\n        if(TESHUPAITYPE.isTeShuPai){\r\n            if(TESHUPAITYPE.isQingLong){\r\n                this._gongXiNiShow(true, \"同花十三水\");\r\n                this._sanTongHua = true;\r\n            }\r\n            else if(TESHUPAITYPE.isYiTiaoLong){\r\n                this._gongXiNiShow(true, \"十三水\");\r\n                this._yiTiaoLong = true;\r\n            }\r\n            else if(TESHUPAITYPE.isLiuDuiBan){\r\n                this._gongXiNiShow(true, \"六对半\");\r\n                this._liuDuiBan = true;\r\n            }\r\n            else if(TESHUPAITYPE.isSanShunZi){\r\n                this._gongXiNiShow(true, \"三顺子\");\r\n                this._sanShunZi = true;\r\n            }\r\n            else if(TESHUPAITYPE.isSanTaoHua){\r\n                this._gongXiNiShow(true, \"三同花\");\r\n                this._sanTongHua = true;\r\n            }\r\n            //else if(TESHUPAITYPE.isSanTongHuaShun){\r\n            //    this._gongXiNiShow(true);\r\n            //    this._SanTongHuaShun = true;\r\n            //}\r\n            //else if(TESHUPAITYPE.isSanFenTianXia){\r\n            //    this._gongXiNiShow(true);\r\n            //    this._SanFenTianXia = true;\r\n            //}\r\n            //else if(TESHUPAITYPE.isCouYiSe){\r\n            //    this._gongXiNiShow(true);\r\n            //    this._CouYiSe = true;\r\n            //}\r\n            //else if(TESHUPAITYPE.isSiTaoSanTiao){\r\n            //    this._gongXiNiShow(true);\r\n            //    this._SiTaoSanTiao = true;\r\n            //}\r\n            //else if(TESHUPAITYPE.isWuDuiSanTiao){\r\n            //    this._gongXiNiShow(true);\r\n            //    this._WuDuiSanTiao = true;\r\n            //}\r\n            else{\r\n                this._gongXiNiShow(false);\r\n            }\r\n        }\r\n        //this._initTeShuPaiSprite();\r\n    },\r\n\r\n    /*#####控制特殊牌精灵的显示*/\r\n    _initTeShuPaiSprite:function () {\r\n        /*把所有的特殊牌精灵都隐藏掉*/\r\n        //for(var i=0;i<this.teshupai_min.length;i++){\r\n        //    this.teshupai_min[i].active = false;\r\n        //    this.teshupai_max[i].active = false;\r\n        //}\r\n        ///*如果是一条龙，就显示一条龙的精灵*/\r\n        //if(this._yiTiaoLong){\r\n        //    this.teshupai_min[3].active = true;\r\n        //    this.teshupai_max[3].active = true;\r\n        //}\r\n        ///*如果是六对半就显示六对半的精灵*/\r\n        //else if(this._liuDuiBan){\r\n        //    this.teshupai_min[0].active = true;\r\n        //    this.teshupai_max[0].active = true;\r\n        //}\r\n        ///*如果是三顺子就显示三顺子的精灵*/\r\n        //else if(this._sanShunZi){\r\n        //    this.teshupai_min[1].active = true;\r\n        //    this.teshupai_max[1].active = true;\r\n        //}\r\n        ///*如果是三同花，就显示三同花的精灵*/\r\n        //else if(this._sanTongHua){\r\n        //    this.teshupai_min[2].active = true;\r\n        //    this.teshupai_max[2].active = true;\r\n        //}\r\n        ///*如果是三同花，就显示三同花的精灵*/\r\n        //else if(this._QingLong){\r\n        //    this.teshupai_min[4].active = true;\r\n        //    this.teshupai_max[4].active = true;\r\n        //}_gongXiNiShow\r\n        ///*如果是三同花，就显示三同花的精灵*/\r\n        //else if(this._SanTongHuaShun){\r\n        //    this.teshupai_min[5].active = true;\r\n        //    this.teshupai_max[5].active = true;\r\n        //}\r\n        ///*如果是三同花，就显示三同花的精灵*/\r\n        //else if(this._SanFenTianXia){\r\n        //    this.teshupai_min[6].active = true;\r\n        //    this.teshupai_max[6].active = true;\r\n        //}\r\n        ///*如果是三同花，就显示三同花的精灵*/\r\n        //else if(this._CouYiSe){\r\n        //    this.teshupai_min[7].active = true;\r\n        //    this.teshupai_max[7].active = true;\r\n        //}\r\n        ///*如果是三同花，就显示三同花的精灵*/\r\n        //else if(this._SiTaoSanTiao){\r\n        //    this.teshupai_min[8].active = true;\r\n        //    this.teshupai_max[8].active = true;\r\n        //}\r\n        ///*如果是三同花，就显示三同花的精灵*/\r\n        //else if(this._WuDuiSanTiao){\r\n        //    this.teshupai_min[9].active = true;\r\n        //    this.teshupai_max[9].active = true;\r\n        //}\r\n    },\r\n\r\n    /*#####*/\r\n    //显示gongXiNi 页面和teShuPai\r\n    clickGongXiNiShow:function () {\r\n        this.cardTypeCombineNode.scale = 1;\r\n        var nodes = this.gongXiNi.getChildByName(\"bg\");\r\n        nodes.opacity = 0;\r\n    },\r\n\r\n    _gongXiNiShow:function (statues, test = \"\") {\r\n        //var alterCom = this.gongXiNi.getComponent(\"alert\");\r\n        let alterCom = this.gongXiNi.getComponent('alert');\r\n        alterCom.unscheduleAllCallbacks();\r\n        test = \"是否按特殊牌型[\" + test + \"]出牌？\" +\"\\n\"+ \"(取消后点击左下角可再报道)\";\r\n        alterCom.setMessage(test);\r\n        if(statues){\r\n            alterCom.alert();\r\n        }else{\r\n            alterCom.dismissAction();\r\n        }\r\n        this.teShuPai.active = statues;\r\n        var nodes = this.teShuPai.getChildByName(\"btnTeshupai\");\r\n        nodes.children[0].runAction(cc.repeatForever(cc.rotateBy(1, -360)));\r\n        nodes.children[1].runAction(cc.repeatForever(cc.rotateBy(1, 360)));\r\n    },\r\n    /*#####*/\r\n\r\n    //  结果相关\r\n    // 显示一局结果\r\n    _showOneGameResult: function () {\r\n        /**/\r\n        this._isComparingCardsNow = false;\r\n        /**/\r\n        this.updateGameStatus(GAMESTATUS.WAIT_PEOPLE);\r\n        //let oneGameResult = this.oneGameResult.getComponent('GameResult');\r\n        //oneGameResult.unscheduleAllCallbacks();\r\n        //oneGameResult.showResults(this._deskInfo, this._userId);\r\n        this._updateUserScores();\r\n        //this._updateBanker();\r\n        //\r\n        const self = this;\r\n        this.scheduleOnce(function () {\r\n            //self._playerComponents.forEach(function (playerComp) {\r\n            //  //playerComp.reset();\r\n            //  //playerComp.reset2();  //#####\r\n            //});\r\n\r\n            if (!self._isRandomRoom()) {\r\n                //if (self._deskInfo.cIndex == 0) {//一局还没开始\r\n                //    self.btnReady.node.active = true;\r\n                //}\r\n                if (self._isTotalGameOver()) {\r\n                    self._showTotalGameResult();\r\n                }\r\n            }\r\n        }, 0.5);\r\n\r\n        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {\r\n            this.scheduleOnce(function () {\r\n                oneGameResult.getComponent('alert').dismissAction();\r\n                cc.director.loadScene('hall');\r\n            }, 2);\r\n            return true;\r\n        }\r\n    },\r\n\r\n    // 显示总结果\r\n    _showTotalGameResult: function (showDelay = 2) {\r\n        this.timeStop();\r\n        //cc.find(\"Canvas/show_result\").active = false;\r\n        this.btnReady.node.active = false;\r\n        this.btnShare.node.active = false;\r\n        this.alertAnsowerExitNode.active = false;\r\n        this.alertRequestExitNode.active = false;\r\n        if(this._deskInfo.cIndex == this._deskInfo.mMax){\r\n            this.againBtn.active = true;\r\n        }else{\r\n            this.againBtn.active = false;\r\n        }\r\n\r\n        let totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');\r\n        if( totalGameResultComp.node.active ){\r\n            return;\r\n        } \r\n\r\n        if(this._bigRecordInfo == null){\r\n            this._bigRecordInfo = this._deskInfo.players;\r\n        }\r\n        totalGameResultComp.setPlayerInfos(this._bigRecordInfo, this._deskInfo);\r\n\r\n        let alert = this.totalGameResult.getComponent('alert');\r\n        this.scheduleOnce(function () {\r\n            //this.oneGameResult.active = false;\r\n            //alert.alert();\r\n            /**/\r\n            if (!this.totalGameResult.active) {\r\n                alert.alert();\r\n            }\r\n            /**/\r\n        }.bind(this), showDelay);\r\n\r\n        alert.setDismissCallback(function (){\r\n            Socket.sendOnceAgain('false',this._userId);\r\n            //cc.director.loadScene('hall');\r\n        });\r\n    },\r\n    clickAgain:function(){\r\n        Socket.sendOnceAgain('true',this._userId);\r\n    },\r\n\r\n    // MARK: Socket 相关\r\n    _loadDeskInfo: function () {\r\n        Socket.sendGetDesckInfo(this._userId);\r\n    },\r\n    _registerSocketEvent: function () {\r\n        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveOnlineStatus, this._socketReciveOnlineStatus, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveChatText, this._socketReciveChatTextMessage, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveChatEmoji, this._socketReciveChatEmojiMessage, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolve, this._socketReceiveRequestExitMessage, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolveResult, this._socketReceiveRequestExitResultMessage, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveAudioMessage, this._socketReceiveAudioMessage, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceivePlayCard, this._socketReceivePlayCard, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveGameOver, this._socketReceiveGameOver, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveFaPai, this._socketReciveFaPai, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveReady, this._socketReciveReady, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveDissolveDesk, this._socketReceiveDissolveDesk, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveLeaveDesk, this._socketLeaveDesk, this);\r\n        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._receiveSocketConnectError, this);\r\n        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._receiveSocketConnectSuccessed, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceivePause, this._socketReceivePause, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveSelectBeiLv, this._ReceiveSelectBeiLv, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveBeiLv, this._ReceiveBeiLv, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveQingLi, this._ReceiveQingLi, this);\r\n        KQGlobalEvent.on(Socket.Event.ReceiveOnceAgain, this._ReceiveOnceAgain, this);\r\n    },\r\n\r\n    _ReceiveOnceAgain:function(response){\r\n        /**\r\n         * 再来一局\r\n         * 总结果要隐藏掉\r\n         * 比牌要隐藏掉\r\n         * 发牌要显示\r\n         */\r\n        this._playedCompareCardsIndexs = [];\r\n        this.playerComps.forEach(playerComp => {\r\n            playerComp.playedCompareCardsIndexs = this._playedCompareCardsIndexs;\r\n    });\r\n        var data = response.data;\r\n        if(!data.reason){\r\n            this.totalGameResult.active = false;\r\n            this.startCompareCardsNode.active = false;\r\n            this._playerComponents.forEach(function (playerComp) {\r\n                playerComp.reset();  //#####\r\n            });\r\n            this._socketReceiveDeskInfo(response);\r\n        }else{\r\n            var now = Date.now();\r\n            if(now - this._nowTimeAgain > 1500){\r\n                this._nowTimeAgain = now;\r\n                this.alertAnsowerExitResult.y = -143;\r\n                this.alertAnsowerExitResult.opacity = 255;\r\n                this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = '房卡不足';\r\n                var action = cc.spawn(cc.moveTo(0.3, cc.p(0, 20)), cc.fadeOut(0.3));\r\n                this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    _ReceiveSelectBeiLv:function(){\r\n        if(this._deskInfo.createId != this._userId){\r\n            this.beilv.active = true;\r\n            var B3 = this.beilv.getChildByName('bg').getChildByName('btn3').getComponent(cc.Button);\r\n            if(this._deskInfo.setting5==1){\r\n                /**\r\n                 * 庄家选择两倍的时候 3倍按钮是不能响应的\r\n                 * 选择三倍不用管，全部显示，\r\n                 * 选择一倍也不用管，直接发牌，\r\n                 */\r\n                B3.interactable = false;\r\n            }\r\n            var selectBl = this.beilv.getComponent('selectBeilv');\r\n            selectBl._userid = this._userid;\r\n        }\r\n    },\r\n\r\n    _ReceiveBeiLv:function(response){\r\n        let userId = response.data.userId;\r\n        let bl = response.data.beilv;\r\n        this._playerComponents.forEach(function (player) {\r\n            player.showBeilv(userId,bl);\r\n        });\r\n    },\r\n\r\n    _ReceiveQingLi:function(response){\r\n        var leaveId = response.data.leaveId;\r\n        if(leaveId == this._userId){\r\n            if(cc.qingli == null){\r\n                var ql = response.action;\r\n                cc.qingli = '';\r\n                cc.qingli = ql;\r\n            }\r\n            cc.director.loadScene('hall');\r\n        }\r\n\r\n    },\r\n\r\n    _socketReceiveDeskInfo: function (response) {\r\n        if (!response.result) {\r\n            cc.error(\"错误：\", response);\r\n            return;\r\n        }\r\n        let data = response.data;\r\n\r\n        this._initPlayerComponents(data.playersIndexAyy);\r\n        /*#####添加五同按钮*/\r\n        // cc.moshi = 0;\r\n\r\n        // if(data.setting3[1] == true) cc.moshi = 1;  //  ？？？\r\n\r\n        cc.maPai = null;\r\n\r\n        if(data.maPai.length == 2) cc.maPai = data.maPai[0] + \"_\" + data.maPai[1];\r\n\r\n        cc.huaSe = data.setting3[2];\r\n\r\n        cc.chaoShiChuPai = data.setting6;\r\n\r\n        cc.duoYiSe = response.data.setting2;   //setting2为 4~7 人（0~3）\r\n\r\n        this._deskInfo = data;\r\n        this._globalMsg(data);\r\n        this._updatGameOverview(this._deskInfo);\r\n        this.updateRoomNumber(data.roomId);\r\n        this.needCard.string =  data.needCard;         // 开放需要的房卡\r\n        let playerIndexs = data.playersIndex;   // [100049]\r\n        this._injectUserIdToPlayerComponents(playerIndexs);\r\n\r\n        let players = data.players;\r\n        this._playerInfos = players;\r\n        this._updateUserInfos(players);\r\n        this._updateUserScores();\r\n        this._updateBanker();\r\n        this._msgControl.addPlayerInfos(this._playerInfos);\r\n\r\n        let currentUserInfo = players.find(function (playerInfo) {\r\n            return playerInfo.id == this._userId;\r\n        }.bind(this));\r\n\r\n        if(data.createId == this._userId){\r\n            if(data.cIndex>0){  // 开始游戏了，请离按钮全部隐藏\r\n                this._playerComponents.forEach(function (player) {\r\n                    player.showQingli(false,data.cIndex);\r\n                })\r\n            }else{              // 游戏没开始，房主的请离按钮不显示\r\n                this._playerComponents.forEach(function (player) {\r\n                    if(data.createId == player.userId ){  // 我是房主，不显示我的请离按钮\r\n                        player.showQingli(true,data.cIndex);\r\n                    }else{\r\n                        player.showQingli(false,data.cIndex);\r\n                    }\r\n                })\r\n            }\r\n        }\r\n\r\n        this._playerComponents.forEach(function (player) {\r\n            if(data.createId == player.userId){//显示房主\r\n                player.showFangZhuStatus(data.createId,true);\r\n            }else{\r\n                player.showFangZhuStatus(player.userId,false);\r\n            }\r\n        });\r\n\r\n        if( this._deskInfo.createId != this._userId ){  // 非庄家\r\n            if(this._deskInfo.cIndex == 0 ){            // 如果还没开始游戏，显示退出按钮，隐藏解散按钮\r\n                this.exit.active =  true;\r\n                this.Dissolve.active = false;\r\n            }else{                                      // 反之\r\n                this.exit.active =  false;\r\n                this.Dissolve.active = true;\r\n            }\r\n        }\r\n        else {                                         // 庄家\r\n            if(this._deskInfo.cIndex > 0 ){             // 开局了 隐藏退出按钮\r\n                this.exit.active =  false;\r\n                this.Dissolve.active = true;\r\n            }\r\n            else{                                      // 没开局 两个都显示\r\n                this.exit.active =  true;\r\n                this.Dissolve.active = true;\r\n            }\r\n        }\r\n\r\n        if (!this._deskInfo.isCBegin) {\r\n            this._gameStatus = GAMESTATUS.WAIT_READY;\r\n        }\r\n        for(var i=0;i<players.length;i++){\r\n            var s = players[i];\r\n            var is = s.readyStatus;//true/false\r\n            var userId = s.id;\r\n            this._playerComponents.forEach(function (player) {\r\n                if(!this._deskInfo.isCBegin) player.showReadyStatus(userId,is);\r\n            }.bind(this));\r\n        }\r\n        if (currentUserInfo && currentUserInfo.cards.length > 0 && this._deskInfo.isCBegin) {\r\n            if(!currentUserInfo.cardInfo.length){\r\n                this._startGame(true);\r\n            }else{\r\n                this._startGame(false);\r\n            }\r\n        }\r\n        else if (UserModelHelper.isPlayedCards(currentUserInfo) && !this._deskInfo.isCBegin) {\r\n            this._socketReceiveGameOver(response);\r\n        }\r\n        this.isReadyStatus();\r\n        this._handleUpdateDeskInfoAboutExitRoom(this._deskInfo);\r\n        this.showCompareCard();\r\n    },\r\n\r\n    showCompareCard: function () {\r\n        if(this._deskInfo.cIndex == 0 || this._deskInfo.isCBegin ||\r\n            !this._deskInfo.players || this._deskInfo.players.length <= 0 || this._deskInfo.players[0].cardInfo <= 0){\r\n            return;\r\n        }\r\n\r\n        this.playsCoins.forEach(function(no){if(no) no.removeAllChildren();});\r\n\r\n        this.unscheduleAllCallbacks();\r\n\r\n        this.node.stopAllActions();\r\n\r\n        this._playerComponents.forEach(function (playerComp) {playerComp.readyToCompareCards();});\r\n\r\n        this._playerComponents.forEach(function (player) {\r\n\r\n            if(player.node.active)player.showAllCompareCards(this._deskInfo.players);\r\n\r\n        }.bind(this));\r\n\r\n        this.startCompareCardsNode.active = false;\r\n\r\n        this._isComparingCardsNow = false;\r\n\r\n        this.isReadyStatus();\r\n\r\n        this.scheduleOnce(function () {\r\n\r\n            if (this._isTotalGameOver()) this._showTotalGameResult();\r\n\r\n        }.bind(this), 0.5);\r\n\r\n    },\r\n\r\n    _socketReciveFaPai: function (response) {\r\n        //  发牌了开始比牌隐藏掉\r\n        this.startCompareCardsNode.active = false;\r\n        this.timeStop();\r\n        this._isComparingCardsNow = true;\r\n        this._gameStatus = GAMESTATUS.WAIT_READY;\r\n        this._socketReceiveDeskInfo(response);\r\n    },\r\n    logoutAction: function() {\r\n        cc.director.loadScene('login');\r\n        manager.setUserInfo('');\r\n        //hall.cacheImageInfo = null;\r\n    },\r\n    _socketReciveOnlineStatus: function (response) {\r\n        //{\"action\":\"sendOnlineStatus\",\"result\":true,\"data\":{\"userId\":100049,\"status\":1}}\r\n        if (!response.result) {\r\n            cc.error(\"错误：\", response);\r\n            return;\r\n        }\r\n\r\n        let data = response.data;\r\n        let userId = data.userId;\r\n        let status = data.status;\r\n\r\n        this._playerComponents.forEach(function (player) {\r\n            player.setUserOnlineStatus(userId, status);\r\n        });\r\n    },\r\n\r\n    _socketReciveChatTextMessage: function (response) {\r\n        let userId = response.data.userId;\r\n        let message = response.data.msg;\r\n\r\n        this._playerComponents.forEach(function (player) {\r\n            player.showChatText(userId, message);\r\n        });\r\n\r\n        this._msgControl.addChatTextMessage(userId, message);\r\n\r\n        let sex = this._playerInfos.find(function (user) {\r\n            return user.id == userId;\r\n        }).sex;\r\n        AudioManager.instance.playChatAudio(sex, message);\r\n    },\r\n    _socketReciveChatEmojiMessage :function(response){\r\n        let userId = response.data.userId;\r\n        let emoji = response.data.emoji;\r\n\r\n        //this._playerComponents.forEach(function (player) {\r\n        //    player.showChatText(userId, emoji);\r\n        //});\r\n        //this._msgControl.addChatEmojiMessage(userId, emoji);\r\n        this._msgControl._loadEmojiFrame(emoji,function(frame){\r\n            this._playerComponents.forEach(function (player) {\r\n                if(player.userId == userId) player.chatMessageNode.getComponent('ChatMessage').showEmoji(frame);\r\n            });\r\n        }.bind(this))\r\n    },\r\n\r\n    _socketReceiveRequestExitMessage: function (response) {\r\n        //if (response.data.userId == this._userId) {\r\n        //    return;\r\n        //}\r\n\r\n\r\n        var alert_bg = this.alertAnsowerExitNode.getChildByName(\"alert_bg\");\r\n\r\n        var btnAgree = alert_bg.getChildByName(\"btnAgree\");\r\n\r\n        var btnDisagree = alert_bg.getChildByName(\"btnDisagree\");\r\n\r\n        btnAgree.active = true;\r\n\r\n        btnDisagree.active = true;\r\n\r\n        var dataInfos = response.data.info;\r\n\r\n        if(!this.alertAnsowerExitNode.active){\r\n\r\n            let alertComp = this.alertAnsowerExitNode.getComponent('alert');\r\n\r\n            alertComp.alert();\r\n\r\n            alertComp.unscheduleAllCallbacks();\r\n\r\n            this.contentAnsowerExitNode.children.forEach(function(i){i.active = false;});\r\n\r\n            this._playerInfos.forEach(function(playerInfo,index){\r\n\r\n                var play = this.contentAnsowerExitNode.children[index];\r\n\r\n                var name = play.getChildByName(\"nickname\");\r\n\r\n                var back = play.getChildByName(\"fanzhu\");\r\n\r\n                var img = play.getChildByName(\"avatar_bg\");\r\n\r\n                play.active = true;\r\n\r\n                name.getComponent(cc.Label).string = playerInfo.nickname;\r\n\r\n                if(this._deskInfo.createId == playerInfo.id){//显示房主\r\n\r\n                    back.active = true;\r\n                }\r\n                else{\r\n\r\n                    back.active = false;\r\n                }\r\n\r\n                cc.loader.load({url:playerInfo.avatarUrl,type:\"jpg\"}, function (err, data) {\r\n\r\n                    if (err) return;\r\n\r\n                    var frame = new cc.SpriteFrame(data);\r\n\r\n                    img.getComponent(cc.Sprite).spriteFrame = frame;\r\n\r\n                }.bind(this));\r\n\r\n\r\n            }.bind(this));\r\n\r\n            let countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');\r\n\r\n            countdown.startCountdown(60, function(isTimeout) {\r\n\r\n                if (isTimeout) {\r\n\r\n                    this.clickAgreeOtherPlayerExit();\r\n\r\n                    return;\r\n                }\r\n            }.bind(this));\r\n\r\n        }\r\n\r\n\r\n        this._playerInfos.forEach(function(playerInfo,index){\r\n\r\n            var dataInfo = dataInfos[index];\r\n\r\n            var play = this.contentAnsowerExitNode.children[index];\r\n\r\n            var str = play.getChildByName(\"id\");\r\n\r\n            var dataInfo = dataInfos[index];\r\n\r\n            if(dataInfo == 1){\r\n\r\n                if(this._userId == playerInfo.id){//显示房主\r\n\r\n                    btnAgree.active = false;\r\n\r\n                    btnDisagree.active = false;\r\n                }\r\n\r\n                str.getComponent(cc.Label).string = \"同意\";\r\n            }\r\n            else{\r\n\r\n                str.getComponent(cc.Label).string = \"\";\r\n            }\r\n\r\n        }.bind(this));\r\n\r\n    },\r\n\r\n    _socketReceiveRequestExitResultMessage: function (response) {\r\n        this._hideReqestExitNode();\r\n        if (this.alertAnsowerExitNode.active) {\r\n            this.alertAnsowerExitNode.getComponent('alert').dismissAction();\r\n            this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();\r\n        }\r\n\r\n\r\n        if (response.data.result) {\r\n            // 解散成功\r\n        } else {\r\n            let userId = response.data.userId;\r\n            let nickname = this._findPlayerInfoByUserId(userId).nickname;\r\n            this.alertAnsowerExitResult.y = -143;\r\n            this.alertAnsowerExitResult.opacity = 255;\r\n            this.alertAnsowerExitResult.children[0].getComponent(cc.Label).string = nickname + '不同意退出';\r\n            var action = cc.spawn(cc.moveTo(.3, cc.p(0, 20)), cc.fadeOut(this.cardTime));\r\n            this.alertAnsowerExitResult.runAction(cc.sequence(cc.moveTo(1, cc.p(0, 0)), action));\r\n\r\n            //this.showAlertMessage('解散失败，因为' + nickname + '不同意退出');\r\n        }\r\n    },\r\n\r\n    _socketReceiveAudioMessage: function (response) {\r\n        let userId = response.data.userId;\r\n        this.playSpeakAnimation(userId);\r\n\r\n        if (userId == this._userId) {\r\n            return;\r\n        }\r\n\r\n        let url = response.data.url;\r\n        this.playAudioUrl(url);\r\n    },\r\n\r\n    _socketReceivePlayCard: function (response) {\r\n        // 有用户已经准备好了牌\r\n        var userId = response.data[0].userId;\r\n        var cardInfo = response.data[1].card;\r\n        this._deskInfo = response.data[2].s;\r\n        let players = response.data[2].s.players;\r\n        this._playerInfos = players;\r\n        this._updateUserInfos(players);\r\n        this._playerComponents.forEach(function (player) {\r\n            player.playCard(userId,cardInfo);\r\n        });\r\n\r\n        if (userId == this._userId) {\r\n            this.cardTypeCombineNode.active = false;\r\n        }\r\n    },\r\n    _getSelfReadyStatus:function() {\r\n        var self = this._findPlayerInfoByUserId(this._userId);\r\n        return self.readyStatus;\r\n    },\r\n    _socketReciveReady: function (response) {\r\n        let userId = response.data.userId;\r\n        this._playerComponents.forEach(function (player) {\r\n            if(!this._deskInfo.isCBegin) player.showReadyStatus(userId);\r\n        }.bind(this));\r\n    },\r\n\r\n    //收到游戏结束\r\n    _socketReceiveGameOver: function (response) {\r\n        this.timeStop();\r\n        cc.sys.localStorage.removeItem(\"timestamp\");\r\n\r\n        this._hideReqestExitNode();\r\n\r\n        // 一局游戏结束\r\n        if (!response.result) {\r\n            cc.error(\"错误：\", response);\r\n            return;\r\n        }\r\n        /**/\r\n        const deskInfo = response.data;\r\n        if (response.action == 'gameOver' && deskInfo.isDeskOver) {\r\n            \r\n            Socket.sendDidReceiveGameOverAction(this._userId);\r\n        }\r\n        /**/\r\n        this._deskInfo = response.data;\r\n\r\n        // 如果是强制解散房间，则直接显示总成绩\r\n        if (this._isDissvledRoom() && !Playback.instance.isPlaybacking()) {\r\n            this._showTotalGameResult(0.1);\r\n            return;\r\n        }\r\n\r\n\r\n        if (Date.now() - this._enterTime < 1000 * 4) {\r\n            // 刚进来的话，不展示比牌动画\r\n            //  let oneGameResult = this.oneGameResult.getComponent('GameResult');\r\n            //  oneGameResult.unscheduleAllCallbacks();\r\n            //  oneGameResult.showResults(this._deskInfo, this._userId);\r\n            this.isReadyStatus();\r\n            this.btnShare.node.active = false;\r\n            this.btnReady.node.active = true;\r\n            this._playerComponents.forEach(function (playerComp) {\r\n                playerComp.reset();\r\n            });\r\n            /**/\r\n            this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);\r\n            /**/\r\n            return;\r\n        }\r\n\r\n        let data = response.data;\r\n        this._deskInfo = data;\r\n        this._bigRecordInfo = data.bigRecordInfo\r\n        //console.log(data);\r\n        //console.log(\"-----------------------------------1709\");\r\n        this._updatGameOverview(this._deskInfo);\r\n        //let playerIndexs = data.playersIndex; // [100049]\r\n\r\n        let players = data.players;\r\n        this._playerInfos = players;\r\n        this._updateUserInfos(players);\r\n        //this._updateRecordInfo(players);\r\n\r\n        if (UserModelHelper.isUserReady(this._findCurrentUserInfo())) {\r\n            this._playerComponents.forEach(function (playerComp) {\r\n                playerComp.reset();\r\n            });\r\n        } else {\r\n            this._startCompareCards(response);\r\n        }\r\n\r\n        if (Date.now() - this._enterTime < 1000 * 4) {\r\n            this.showCompareCard();\r\n            return;\r\n        }\r\n    },\r\n    // _updateRecordInfo:function(players){\r\n\r\n    //     // this._bigRecordInfo.push();\r\n    // },\r\n    _socketReceiveDissolveDesk: function(response) {\r\n        this.cardTypeCombineNode.active = false;\r\n        cc.director.loadScene('hall');\r\n\r\n        // this.alert.getComponent('alert').setWillDismissCallback(function(){\r\n\r\n        //   return true;\r\n        // });\r\n\r\n        // let message = \"房主已解散房间\";\r\n        // if (this._isRandomRoom()) {\r\n        //   message = \"有玩家已强制退出房间，游戏结束。本局游戏不会扣除您的钻石。\";\r\n        // }\r\n\r\n        // this.showAlertMessage(message, false);\r\n    },\r\n    /**/\r\n    _socketLeaveDesk: function (response) {\r\n        if (!response.result) {\r\n            return;\r\n        }\r\n\r\n        if (this._deskInfo.isDeskOver) {\r\n            // 如果房间已结束，也不用再自动退回到大厅了\r\n            return;\r\n        }\r\n\r\n        cc.director.loadScene('hall');\r\n    },\r\n    /**/\r\n    // socket 收到有人手机进入后台消息\r\n    _socketReceivePause: function(response) {\r\n        if (!response.result) {\r\n            return;\r\n        }\r\n\r\n        let userId = response.data.userId;\r\n        this._playerComponents.forEach(function(player) {\r\n            if (player.userId == userId) {\r\n                player.setUserOnlineStatus(userId, 0);\r\n            }\r\n        });\r\n    },\r\n\r\n    _receiveSocketConnectError: function(response) {\r\n        this.showNetworkMessage();\r\n    },\r\n\r\n    _receiveSocketConnectSuccessed: function(response) {\r\n        this.hiddenNetworkMessage();\r\n\r\n        if (!Playback.instance.isPlaybacking()) {\r\n            this._loadDeskInfo();\r\n        }\r\n    },\r\n    /**/\r\n    // MARK: 更新房间信息\r\n    updateDeskInfo: function (deskInfo) {\r\n        this._deskInfo = deskInfo;\r\n        this._updatGameOverview(this._deskInfo);\r\n        this.updateRoomNumber(deskInfo.roomId);\r\n\r\n        let playerIndexs = deskInfo.playersIndex; // [100049]\r\n        this._injectUserIdToPlayerComponents(playerIndexs);\r\n\r\n        let players = deskInfo.players;\r\n        this._playerInfos = players;\r\n        this._updateUserInfos(players);\r\n        this._msgControl.addPlayerInfos(this._playerInfos);\r\n        if (deskInfo.cIndex == 0 && this._deskInfo.players.length < this._deskInfo.maxNumber) {\r\n            this.btnShare.node.active = true;\r\n        }\r\n    },\r\n    /**/\r\n    _injectUserIdToPlayerComponents: function (playerIndexs) {\r\n        let currentUserIdIndex = playerIndexs.findIndex(function (userId) {\r\n            return userId == this._userId;\r\n        }.bind(this));\r\n\r\n        let fixedPlayerIndexs = playerIndexs.translationWithStartIndex(currentUserIdIndex);\r\n        this._playerComponents.forEach(function (playerComponent, index) {\r\n            let userId = fixedPlayerIndexs.length > index ? fixedPlayerIndexs[index] : null;\r\n            playerComponent.userId = userId;\r\n        });\r\n    },\r\n\r\n    _updateUserInfos: function (userInfos) {\r\n        let self = this;\r\n        this._playerComponents.forEach(function (playerComponent, index) {\r\n            //playerComponent.setDeskInfo(self._deskInfo);\r\n            /**/\r\n            playerComponent.updateDeskInfo(self._deskInfo);\r\n            /**/\r\n            playerComponent.updateUserInfoWithUsers(userInfos);\r\n        });\r\n\r\n        //this._handleTheSameOfIPAdress(userInfos);\r\n    },\r\n\r\n    _updateUserScores: function(userInfos) {\r\n        this._playerComponents.forEach(function(player) {\r\n            player.updateScore();\r\n        });\r\n    },\r\n\r\n\r\n    _updateBanker: function() {\r\n        this._playerComponents.forEach(function(player) {\r\n            player.updateBanker();\r\n        });\r\n    },\r\n\r\n    // 私有方法\r\n    _findCardsByUserId: function (userId) {\r\n        let player = this._findPlayerInfoByUserId(userId);\r\n\r\n        return (player != null) ? player.cards : null;\r\n    },\r\n\r\n    _findPlayerInfoByUserId: function (userId) {\r\n        let player = (this._playerInfos || []).find(function (playerInfo) {\r\n            return userId == playerInfo.id;\r\n        });\r\n\r\n        return player;\r\n    },\r\n\r\n    _findPlayerIndexByUserId: function (userId) {\r\n        //let index = this._playerComponents.findIndex(function (playerComp) {\r\n        //    return playerComp.userId == userId;\r\n        //});\r\n        let index = this.playerNodes.findIndex(function (node) {\r\n            return node.getComponent('Player').userId == userId;\r\n        });\r\n        return index;\r\n    },\r\n\r\n    _findCurrentUserInfo: function () {\r\n        return this._findPlayerInfoByUserId(this._userId);\r\n    },\r\n\r\n    _convertCardsToCardNames: function (cards) {\r\n        // [{\"suit\":\"s\",\"number\":10}]\r\n        let suitColorMap = {\r\n            s: 4,\r\n            h: 3,\r\n            c: 2,\r\n            d: 1,\r\n        };\r\n        return cards.map(function (card) {\r\n            var cardNumber = card.number;\r\n\r\n            // 服务器中的 14 是 A\r\n            if (card.number == 14) {\r\n                cardNumber = 1;\r\n            }\r\n            let color = suitColorMap[card.suit];\r\n            let number = Math.max(Math.min(cardNumber, 21), 1);\r\n            return color + \"_\" + number;\r\n        });\r\n    },\r\n\r\n    // 更新游戏总览信息\r\n    _updatGameOverview: function (deskInfo) {\r\n        if (Playback.instance.isPlaybacking()) {\r\n            this.labelOverview.string = \"回放\";\r\n            return;\r\n        }\r\n\r\n        if (this._isRandomRoom()) {\r\n            this.labelOverview.string = \"\";\r\n            return;\r\n        }\r\n        var bihuase = \"不比花色 \";\r\n        var zuozhuang = \"不坐庄 \";\r\n        var putong  = \"普通场 \";\r\n        var wugui =  \"无鬼 \";\r\n        var maPai = '不买马 ';\r\n        var renshu = \"4人不加色 \";\r\n        var card = \"平摊\";\r\n\r\n        //[疯狂场,鬼牌,比花色,坐庄,马牌]\r\n        if(this._deskInfo.setting3[2]){\r\n            bihuase = \"比花色  \";\r\n        }\r\n        if(this._deskInfo.setting3[3]){\r\n            zuozhuang = \"坐庄 \";\r\n        }\r\n        if(this._deskInfo.setting3[0]){\r\n            putong = \"疯狂场  \";\r\n        }\r\n        if(this._deskInfo.setting3[1]){\r\n            wugui = \"有鬼  \";\r\n        }\r\n        if(this._deskInfo.setting3[4]){\r\n            maPai = \"买马\";\r\n            var huaSe = \"方块\";\r\n            var dianShu = 1\r\n            switch(this._deskInfo.setting7[0]){ //setting7 [1~4,1~13] 表示 [花色，点数]\r\n                case 1: huaSe = \"方块\";break;\r\n                case 2: huaSe = \"梅花\";break;\r\n                case 3: huaSe = \"红心\";break;\r\n                case 4: huaSe = \"黑桃\";break;\r\n            }\r\n            switch(this._deskInfo.setting7[1]){\r\n                case 1: dianShu = 'A';break;\r\n                case 2: dianShu = 2;break;\r\n                case 3: dianShu = 3;break;\r\n                case 4: dianShu = 4;break;\r\n                case 5: dianShu = 5;break;\r\n                case 6: dianShu = 6;break;\r\n                case 7: dianShu = 7;break;\r\n                case 8: dianShu = 8;break;\r\n                case 9: dianShu = 9;break;\r\n                case 10: dianShu = 10;break;\r\n                case 11: dianShu = 'J';break;\r\n                case 12: dianShu = 'Q';break;\r\n                case 13: dianShu = 'K';break;\r\n            }\r\n            maPai = huaSe+dianShu+maPai;\r\n        }\r\n\r\n        if(this._deskInfo.setting2 == 1){\r\n            renshu = \"5人加一色 \";\r\n        }else if(this._deskInfo.setting2 == 2){\r\n            renshu = \"6人加二色 \";\r\n        }else if(this._deskInfo.setting2 == 3){\r\n            renshu = \"7人加三色 \";\r\n        }\r\n        if(this._deskInfo.setting4 == 1){\r\n            card = \"赢者扣 \";\r\n        }else if(this._deskInfo.setting4 == 2){\r\n            card = \"房主扣 \";\r\n        }\r\n\r\n        this.labelOverview.string = \"模式 : \"+bihuase+zuozhuang+putong+wugui+maPai+\"\\n\"+\"其他：\"+renshu+card;\r\n        //this.labelOverview.string = \"模式 : \" + \"\" + deskInfo.maxNumber + \"人\" +bihuase+zuozhuang+putong+wugui+maPai;\r\n    },\r\n\r\n    // 是否是随机房\r\n    _isRandomRoom: function () {\r\n        if (this._deskInfo == null) {\r\n            return true;\r\n        }\r\n\r\n        return this._deskInfo.isRandomDesk;\r\n    },\r\n\r\n    // 是否所有局数都用完了\r\n    _isTotalGameOver: function () {\r\n        if (this._deskInfo == null) {\r\n            return false;\r\n        }\r\n\r\n        if (this._deskInfo.isDeskOver) {\r\n            return true;\r\n        }\r\n\r\n        return this._deskInfo.mMax <= this._deskInfo.cIndex;\r\n    },\r\n\r\n    // 是否已解散房间\r\n    _isDissvledRoom: function () {\r\n        if (this._deskInfo) {\r\n            return this._deskInfo.dissolveStatus;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n\r\n    _startCompareCards: function (data) {\r\n        this._isComparingCardsNow = true;\r\n        this._gongXiNiShow(false);\r\n        this._players = data.data.players;\r\n        let user = this._findPlayerInfoByUserId(this._userId);\r\n        if(!this.totalGameResult.active){\r\n            AudioManager.instance.playStartCompare(user.sex);\r\n        }\r\n        \r\n        this.startCompareCardsNode.getComponent('alert').alert();\r\n        this._playerComponents.forEach(function (playerComp) {playerComp.readyToCompareCards();});\r\n        this.unscheduleAllCallbacks();\r\n        this.scheduleOnce(function () {\r\n            this.startCompareCardsNode.active = false;\r\n            this._showCompareCardDetails(data);\r\n        }.bind(this), 1.0);\r\n    },\r\n\r\n    _showCompareCardDetails: function (data) {\r\n\r\n        this._playerComponents.forEach(function (playerComp) {\r\n            playerComp.reset();\r\n            playerComp.readyToCompareCards();\r\n        });\r\n\r\n        let cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');\r\n\r\n        cardTypeCombine.reset();\r\n\r\n        cardTypeCombine.node.active = false;\r\n\r\n        let comparePlayers1 = this._playerComponents.filter(function (player) {\r\n\r\n            if(player.node.active){\r\n\r\n                var user = player.compareCardsNode.getComponent('CompareCards')._user;\r\n\r\n                if(!user.isContainExtra) return player.node.active;\r\n\r\n            }\r\n        });\r\n\r\n        let teShuPlayers = this._playerComponents.filter(function (player) {\r\n\r\n            if(player.node.active){\r\n\r\n                var user = player.compareCardsNode.getComponent('CompareCards')._user;\r\n\r\n                if(user.isContainExtra) return player.node.active;\r\n\r\n            }\r\n        });\r\n        let self = this;\r\n        var duration = this._showCompareCardStep(0, comparePlayers1);\r\n\r\n        this.scheduleOnce(function () {self._showCompareCardStep(0, comparePlayers1);}, duration);\r\n\r\n        this.scheduleOnce(function () {self._showCompareCardStep(0, comparePlayers1);}, duration * 2);\r\n\r\n        if(teShuPlayers.length > 0){\r\n            this.scheduleOnce(function () {self._showCompareCardStep(0, teShuPlayers, true);}, duration * 3);\r\n        }\r\n\r\n\r\n        duration = duration * 3 + 0.5;\r\n\r\n        for(var i = 0; i < teShuPlayers.length; i++){\r\n\r\n            var user = teShuPlayers[i].compareCardsNode.getComponent('CompareCards')._user;\r\n\r\n            if(user.isContainExtra)duration = duration + 2.5\r\n\r\n        }\r\n\r\n        let shootDuration = this.headCardTime;\r\n\r\n        let shootDatas = this._shootDatas() || [];\r\n\r\n        let shotData = this._shotData() || [];\r\n\r\n        let homeRunUserId = this._homeRunUserId();\r\n\r\n        var shotDataTimes = 0;\r\n\r\n        shotData.forEach(function (data, index) {\r\n\r\n            self.scheduleOnce(function () {\r\n\r\n                self.playShoot(data.fromUserId, data.toUserId);\r\n\r\n            }, duration + index * shootDuration);\r\n\r\n            shotDataTimes += self.headCardTime;\r\n\r\n            duration += self.headCardTime;\r\n\r\n        });\r\n\r\n        if(homeRunUserId.length >= 1){\r\n\r\n            shootDatas.forEach(function (data, index) {\r\n\r\n                self.scheduleOnce(function () {\r\n\r\n                    self.playShoot(data.fromUserId, data.toUserId);\r\n\r\n                }, duration + (index + shotDataTimes) * shootDuration);\r\n\r\n                duration += self.headCardTime;\r\n\r\n            });\r\n\r\n        }\r\n\r\n        duration = duration + shootDatas.length * shootDuration + shotData.length * shootDuration;\r\n\r\n        if (homeRunUserId > 0) {\r\n\r\n            self.scheduleOnce(function () {self.playHomeRun(homeRunUserId);}, duration);\r\n\r\n            duration = duration + 1;\r\n        }\r\n\r\n        if (homeRunUserId) {\r\n            duration = duration + 1;\r\n        }\r\n\r\n        //this.scheduleOnce(function () {this._jinBiAction();}.bind(this), duration);//显示结算金币//显示结果\r\n        this._jinBiAction(duration);\r\n        //this.scheduleOnce(function () {\r\n        //\r\n        //    this._playerComponents.forEach(function (playerComp) {playerComp.showScoreResult();});\r\n        //\r\n        //    self._showCompareCardFinished();\r\n        //\r\n        //}.bind(this), duration);\r\n\r\n    },\r\n\r\n    _jinBiAction: function (duration) {\r\n        var comparePlayers1 = this._playerComponents.filter(function (player) {return player.node.active;});\r\n\r\n        var nextTime = 0;//下一个动作开始的时间\r\n\r\n        var zTime = 0;//下下一个动作开始的时间\r\n\r\n        var start = 0;\r\n\r\n        var end = 0;\r\n\r\n        var coinsContainerAyy = []; //所有的用户的金币 一个用户一个数组\r\n\r\n        var coinsAyy = []; //所有的金币，一个数组\r\n\r\n        this.playsCoins.forEach(function(no){if(no) no.removeAllChildren();});\r\n\r\n        comparePlayers1.forEach(function(plays, index){//根据积分创建金币\r\n\r\n            var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;\r\n\r\n            if(cScore < 0){\r\n\r\n\r\n                cScore *= -1;\r\n\r\n                var node = new cc.Node();\r\n\r\n                node.name = \"coinsContainer\";\r\n\r\n                var numScore =  cScore > 30 ? 30:cScore;\r\n                for(var i = 0 ;i < numScore ;i++){\r\n                    this._createJinBiPrefab(node, node);//根据积分创建金币\r\n                }\r\n\r\n                this.playsCoins[index].addChild(node);\r\n\r\n                coinsContainerAyy.push(node.children);\r\n\r\n            }\r\n\r\n        }.bind(this));\r\n\r\n        this.playsCoins.forEach(function(no){if(no) no.active = false;});\r\n\r\n        this.scheduleOnce(function() {//显示结果\r\n\r\n            this.playsCoins.forEach(function(no){if(no) no.active = true;});\r\n\r\n            AudioManager.instance.coinIncome();\r\n\r\n            coinsContainerAyy.forEach(function(coinsAyys){//把金币移动到容器\r\n\r\n                var initTime = 0;\r\n\r\n                var interval = 0.002;\r\n\r\n                coinsAyys.forEach(function(coins){//把金币移动到容器\r\n\r\n                    var y = Math.round(Math.random()) == 0 ? -1 : 1;\r\n\r\n                    y = Math.floor(Math.random()*38) * y;\r\n\r\n                    var x = Math.round(Math.random()) == 0 ? -1 : 1;\r\n\r\n                    x = Math.floor(Math.random()*38) * x;\r\n\r\n                    var cardBackWorldSpace1 = this.node.convertToWorldSpaceAR(cc.v2(x, y));\r\n\r\n                    var v2 = coins.convertToNodeSpaceAR(cardBackWorldSpace1);\r\n\r\n                    this.scheduleOnce(function() {\r\n\r\n                        coins.runAction(cc.moveBy(0.2, v2));\r\n\r\n                    }, initTime);\r\n\r\n                    initTime = initTime + interval;\r\n\r\n                }.bind(this));\r\n\r\n                nextTime = initTime;\r\n\r\n                coinsAyy = coinsAyy.concat(coinsAyys);//把金币集合到一个数组\r\n\r\n            }.bind(this));\r\n\r\n            var zcScore = 0;\r\n\r\n            comparePlayers1.forEach(function(plays){//计算金币\r\n\r\n                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;\r\n\r\n                cScore =  cScore > 30 ? 30:cScore;\r\n\r\n                if(cScore > 0) zcScore += cScore * 1;\r\n\r\n            }.bind(this));\r\n\r\n            var coinsAyy1 = coinsAyy.splice(zcScore, coinsAyy.length);\r\n\r\n            coinsAyy1.forEach(function(node){node.parent.removeChild(node);});\r\n\r\n            comparePlayers1.forEach(function(plays){//把金币到用户头像附近\r\n\r\n                var cScore = plays.compareCardsNode.getComponent('CompareCards')._user.cScore;\r\n\r\n                if(cScore > 0){\r\n\r\n                    var interval = 0.0025;\r\n\r\n                    var initTime = nextTime + 1;\r\n\r\n                    var numScore =  cScore > 30 ? 30:cScore;\r\n\r\n                    //end += numScore;\r\n\r\n                    coinsAyy.splice(0, numScore).forEach(function(coinsNode){//把金币到用户头像附近\r\n\r\n                        this.scheduleOnce(function() {\r\n\r\n                            //获取节点的世界坐标\r\n                            var cardBackWorldSpace1 = plays.node.convertToWorldSpaceAR(cc.v2(0, 0));\r\n                            //获取相对父节点所在的坐标\r\n                            var detail = coinsNode.convertToNodeSpaceAR(cardBackWorldSpace1);\r\n\r\n                            var moveBy = cc.moveBy(0.25, detail);\r\n\r\n                            var nextFadeIn = cc.fadeOut(0.13);\r\n\r\n                            var moveSeq =cc.sequence(moveBy,nextFadeIn);\r\n\r\n                            coinsNode.runAction(moveSeq) ;\r\n\r\n                        }, initTime);\r\n\r\n                        initTime = initTime + interval;\r\n\r\n                    }.bind(this));\r\n\r\n                    //start += cScore;\r\n\r\n                    zTime = initTime;\r\n\r\n                }\r\n\r\n            }.bind(this));\r\n\r\n            this.scheduleOnce(function() {//显示结果\r\n\r\n                //this.playsCoins.forEach(function(no){if(no) no.active = false;});\r\n\r\n                this._showCompareCardFinished();\r\n\r\n                comparePlayers1.forEach(function (playerComp) {playerComp.showScoreResult();});\r\n\r\n            }.bind(this), zTime);\r\n\r\n\r\n            this.scheduleOnce(function() {//显示结果\r\n\r\n                this.playsCoins.forEach(function(no){if(no) no.removeAllChildren();});\r\n\r\n            }.bind(this), zTime + 5);\r\n\r\n        }.bind(this), duration);\r\n\r\n    },\r\n\r\n    _createJinBiPrefab: function (node,v2Node) {\r\n\r\n        var nodes = cc.instantiate(this.coinsPrefab);\r\n\r\n        var y = Math.round(Math.random()) == 0 ? -1 : 1;\r\n\r\n        y = Math.floor(Math.random()*38) * y + v2Node.y;\r\n\r\n        var x = Math.round(Math.random()) == 0 ? -1 : 1;\r\n\r\n        x = Math.floor(Math.random()*38) * x + v2Node.x;\r\n\r\n        nodes.x = x;\r\n\r\n        nodes.y = y;\r\n\r\n        node.addChild(nodes);\r\n    },\r\n\r\n    _showCompareCardStep: function (startTime = 0, comparePlayers = [], isContainExtra = false) {\r\n        var duration = startTime;\r\n        let interval = this.headCardTime;\r\n        let teshuTime = 0;\r\n        let self = this;\r\n\r\n        comparePlayers = comparePlayers.sort(function (player1, player2) {\r\n            return player1.nextCompareScore() - player2.nextCompareScore();\r\n        });\r\n\r\n        var co=comparePlayers;\r\n        //console.log(co)\r\n        //console.log('-------------执行了几次')\r\n\r\n        co.forEach(function (player) {\r\n\r\n            self.scheduleOnce(function () {\r\n                player.showNextCompareCards();\r\n            }, duration + teshuTime);\r\n\r\n            duration = duration + interval;\r\n            var user = player.compareCardsNode.getComponent('CompareCards')._user;\r\n            if(user.isContainExtra){\r\n                if(user.cardInfo[0].type == 10){\r\n\r\n                    self.scheduleOnce(function () {this.node.getComponent(\"animation\")._santonghuaAnimation();},duration - 1 + teshuTime);\r\n\r\n                    teshuTime += 2.5;\r\n\r\n                }\r\n                else if(user.cardInfo[0].type == 11){\r\n\r\n                    self.scheduleOnce(function () {this.node.getComponent(\"animation\")._sanshunziAnimation(); }, duration - 1 + teshuTime);\r\n\r\n                    teshuTime += 2.5;\r\n\r\n                }\r\n                else if(user.cardInfo[0].type == 12){\r\n\r\n                    self.scheduleOnce(function () {this.node.getComponent(\"animation\")._liuduibanAnimation();}, duration - 1 + teshuTime);\r\n\r\n                    teshuTime += 2.5;\r\n\r\n                }else if(user.cardInfo[0].type == 18){\r\n\r\n                    self.scheduleOnce(function () {this.node.getComponent(\"animation\")._qinglongAniamtion('long');}, duration - 1 + teshuTime);\r\n\r\n                    teshuTime += 2.5;\r\n\r\n                }\r\n                else if(user.cardInfo[0].type == 19){\r\n\r\n                    self.scheduleOnce(function () {this.node.getComponent(\"animation\")._qinglongAniamtion(\"ql\");}, duration - 1 + teshuTime);\r\n\r\n                    teshuTime += 2.5;\r\n\r\n                }\r\n            }\r\n        });\r\n\r\n        if(isContainExtra){\r\n\r\n            for(var i = 0; i < co.length; i++) duration = duration + 2.5\r\n\r\n            this._playerComponents.forEach(function (player) {\r\n                if(player.node.active){\r\n                    self.scheduleOnce(function () {\r\n                        player.showNextCompareScore(isContainExtra);\r\n                    }, duration - interval);\r\n                }\r\n            });\r\n\r\n        }else{\r\n            co.forEach(function (player) {\r\n                self.scheduleOnce(function () {\r\n                    player.showNextCompareScore();\r\n                }, duration - interval);\r\n            });\r\n        }\r\n\r\n        return duration + teshuTime;\r\n    },\r\n\r\n    _isGameOver: function () {\r\n\r\n    },\r\n\r\n    // 比牌完成后会调用的方法\r\n    _showCompareCardFinished: function () {\r\n        this.timeStart(5,\"ready\");\r\n        this._showOneGameResult();\r\n        /**/\r\n        this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);\r\n        /**/\r\n    },\r\n\r\n    //network\r\n    showNetworkMessage:function(msg = \"网络链接断开，重新连接中...\") {\r\n        if (this.networkNode && this.networkNode.active) {\r\n            return;\r\n        }\r\n\r\n        if (this.networkNode != null) {\r\n            var removeSelfAction = cc.removeSelf();\r\n            this.networkNode.runAction(removeSelfAction);\r\n            this.networkNode = null;\r\n        }\r\n        this.networkNode = cc.instantiate(this.waitingPrefab);\r\n        this.node.addChild(this.networkNode);\r\n        var comp = this.networkNode.getComponent('alert');\r\n        var self = this;\r\n        comp.onDismissComplete = function() {\r\n            self.networkNode = null;\r\n        };\r\n        comp.setMessage(msg);\r\n        comp.alert();\r\n    },\r\n\r\n    hiddenNetworkMessage:function() {\r\n        if (this.networkNode != null) {\r\n            this.networkNode.getComponent('alert').dismissAction();\r\n        }\r\n    },\r\n\r\n    showAlertMessage: function(msg, autoDismiss) {\r\n        let alertComp = this.alert.getComponent('alert');\r\n        if (!this.alert.active) {\r\n            alertComp.alert();\r\n        }\r\n\r\n        alertComp.setMessage(msg);\r\n        alertComp.unscheduleAllCallbacks();\r\n        if (autoDismiss) {\r\n            alertComp.scheduleOnce(function () {\r\n                alertComp.dismissAction();\r\n            }, 5);\r\n        }\r\n    },\r\n\r\n    //checkNode\r\n    showCheckMessage:function(msg = '检查网络中...') {\r\n        if (this.checkNode != null) {\r\n            var removeSelfAction = cc.removeSelf();\r\n            this.checkNode.runAction(removeSelfAction);\r\n            this.checkNode = null;\r\n        }\r\n        this.checkNode = cc.instantiate(this.waitingPrefab);\r\n        this.node.addChild(this.checkNode);\r\n        var comp = this.checkNode.getComponent('alert');\r\n        var self = this;\r\n        comp.onDismissComplete = function() {\r\n            self.checkNode = null;\r\n        };\r\n        comp.setMessage(msg);\r\n        comp.alert();\r\n    },\r\n\r\n    hiddenCheckMessage:function() {\r\n        if (this.checkNode != null && this.checkNode.active) {\r\n            this.checkNode.getComponent('alert').dismissAction();\r\n        }\r\n    },\r\n\r\n    /////  聊天语音逻辑\r\n    // _registerVoiceNodeEvents: function () {\r\n    //     let self = this;\r\n    //     let chatVoiceNode = this.btnChatVoice.node;\r\n    //     this.endRecordTime = Date.now();\r\n    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_START,function(event) {\r\n    //         if (Date.now() - self.endRecordTime >= 1000) {\r\n    //             self.nativeRecordAction();\r\n    //             //self.voiceRecordAnimationNode.active = true;\r\n\r\n    //             let action = cc.scaleTo(0.12, 1.2);\r\n    //             self.btnChatVoice.node.runAction(action);\r\n\r\n    //             self._isRecording = true;\r\n    //         }\r\n    //     });\r\n    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_END,function(event) {\r\n    //         if (self._isRecording) {\r\n    //             self.endRecordTime = Date.now();\r\n    //         }\r\n    //         self._isRecording = false;\r\n\r\n    //         self.nativeEndRecordAction();\r\n    //         //self.voiceRecordAnimationNode.active = false;\r\n\r\n    //         let action = cc.scaleTo(0.12, 1);\r\n    //         self.btnChatVoice.node.runAction(action);\r\n    //     });\r\n    //     chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL,function(event) {\r\n    //         if (self._isRecording) {\r\n    //             self.endRecordTime = Date.now();\r\n    //         }\r\n    //         self._isRecording = false;\r\n\r\n    //         self.nativeEndRecordAction();\r\n    //         //self.voiceRecordAnimationNode.active = false;\r\n\r\n    //         let action = cc.scaleTo(0.12, 1);\r\n    //         self.btnChatVoice.node.runAction(action);\r\n    //     });\r\n    //     Socket.instance.uploadFinish = function(url) {\r\n    //         let userId = self._userId;\r\n    //         Socket.sendAudioMessage(userId, url);\r\n    //         self.playSpeakAnimation(self._userId);\r\n    //     };\r\n    // },\r\n\r\n    _registerVoiceNodeEvents: function () {\r\n        let self = this;\r\n        let chatVoiceNode = this.btnChatVoice.node;\r\n        this.endRecordTime = Date.now();\r\n        chatVoiceNode.on(cc.Node.EventType.TOUCH_START,function(event) {\r\n            // self.VoiceMsgBgAnimation();\r\n            if(!cc.sys.isNative){\r\n                var runTime = 0.3\r\n                var tishi = cc.instantiate(self.autoTishi);\r\n                self.node.addChild(tishi);\r\n                var action = cc.spawn( cc.moveTo(0.3, cc.v2(0, 0)),cc.fadeIn(0.3));\r\n                tishi.runAction(action);\r\n                self.scheduleOnce(function () {\r\n                    var finished = cc.callFunc(function(){\r\n                         tishi.removeFromParent(true);\r\n                    });\r\n                    var action = cc.sequence( cc.spawn(cc.fadeOut(runTime),cc.moveTo(runTime,cc.v2(0, 50))),finished);\r\n                    tishi.runAction( action );\r\n                   \r\n                }.bind(this), 1.5);\r\n                //var url = \"www.baidu.com\";\r\n                //let userId = self._userId;\r\n                //Socket.sendAudioMessage(userId, url);\r\n            }else{\r\n                if (Date.now() - self.endRecordTime >= 1000) {\r\n                    self.VoiceMsgBgAnimation();\r\n                    self.nativeRecordAction();\r\n                    let action = cc.scaleTo(0.12, 1.2);\r\n                    self.btnChatVoice.node.runAction(action);\r\n                    self._isRecording = true;\r\n                }\r\n            }\r\n        });\r\n        chatVoiceNode.on(cc.Node.EventType.TOUCH_END,function(event) {\r\n            self.VoiceMsgBg.active = false;\r\n            if (self._isRecording) {\r\n                self.endRecordTime = Date.now();\r\n            }\r\n            self._isRecording = false;\r\n\r\n            self.nativeEndRecordAction();\r\n            //self.voiceRecordAnimationNode.active = false;\r\n\r\n            let action = cc.scaleTo(0.12, 1);\r\n            self.btnChatVoice.node.runAction(action);\r\n        });\r\n        chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL,function(event) {\r\n            self.VoiceMsgBg.active = false;\r\n            if (self._isRecording) {\r\n                self.endRecordTime = Date.now();\r\n            }\r\n            self._isRecording = false;\r\n\r\n            self.nativeEndRecordAction();\r\n            //self.voiceRecordAnimationNode.active = false;\r\n\r\n            let action = cc.scaleTo(0.12, 1);\r\n            self.btnChatVoice.node.runAction(action);\r\n        });\r\n        Socket.instance.uploadFinish = function(url) {\r\n            let userId = self._userId;\r\n            Socket.sendAudioMessage(userId, url);\r\n            self.playSpeakAnimation(self._userId);\r\n        };\r\n    },\r\n    VoiceMsgBgAnimation:function(){\r\n        this.VoiceMsgBg.active = true;\r\n        var whileLayout = this.VoiceMsgBg.getChildByName(\"whileLayout\");\r\n        var childWhile = whileLayout.getChildByName(\"childWhile\");\r\n        if( this.whileLayoutInterval ){\r\n            clearInterval(this.whileLayoutInterval);\r\n        }\r\n\r\n        this.whileLayoutInterval =  setInterval(function(){\r\n            var node = cc.instantiate(childWhile);\r\n            if(whileLayout.children.length>5){\r\n                whileLayout.removeAllChildren();\r\n            }\r\n            whileLayout.addChild(node);\r\n        },200)\r\n\r\n        var layout = this.VoiceMsgBg.getChildByName(\"layout\");\r\n        var cWhile = layout.getChildByName(\"while\");\r\n        \r\n\r\n        if( this.layoutInterval ){\r\n            clearInterval(this.layoutInterval);\r\n        }\r\n\r\n        this.layoutInterval = setInterval(function(){\r\n            var node = cc.instantiate(cWhile);\r\n            if(layout.children.length>3){\r\n                layout.removeAllChildren();\r\n            }\r\n            layout.addChild(node);\r\n        },300)\r\n    },\r\n    nativeRecordAction:function() {\r\n        if (KQNativeInvoke.isNativeIOS()) {\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"record\");\r\n        } else if (KQNativeInvoke.isNativeAndroid()) {//Android com.lling.qianjianglzg\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"record\", \"()V\");\r\n            AudioManager.instance.pauseMusic();\r\n        }\r\n    },\r\n\r\n    nativeEndRecordAction:function() {\r\n        if (KQNativeInvoke.isNativeIOS()) {\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"endRecord\");\r\n        } else if (KQNativeInvoke.isNativeAndroid()) {//Android\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"endRecord\", \"()V\");\r\n            AudioManager.instance.resumeMusic();\r\n        }\r\n    },\r\n\r\n    playAudioUrl:function(url) {\r\n        //console.log(\"---------------------------2553\");\r\n        if (KQNativeInvoke.isNativeIOS()) {\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"playUrl:\",url);\r\n        } else if(KQNativeInvoke.isNativeAndroid()) {//Android\r\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"playUrl\", \"(Ljava/lang/String;)V\", url);\r\n        }\r\n    },\r\n\r\n    // MARK:  退出游戏逻辑\r\n    _handleUpdateDeskInfoAboutExitRoom: function(deskInfo) {\r\n        if (!deskInfo.isDissolving) {\r\n            return;\r\n        }\r\n        var dataInfos = deskInfo.dissolveAnswerInfo;\r\n\r\n        let alertComp = this.alertAnsowerExitNode.getComponent('alert');\r\n\r\n        alertComp.alert();\r\n\r\n        alertComp.unscheduleAllCallbacks();\r\n\r\n        this.contentAnsowerExitNode.children.forEach(function(i){i.active = false;});\r\n\r\n        this._playerInfos.forEach(function(playerInfo,index){\r\n\r\n            var play = this.contentAnsowerExitNode.children[index];\r\n\r\n            var name = play.getChildByName(\"nickname\");\r\n\r\n            var back = play.getChildByName(\"fanzhu\");\r\n\r\n            var img = play.getChildByName(\"avatar_bg\");\r\n\r\n            var str = play.getChildByName(\"id\");\r\n\r\n            var dataInfo = dataInfos[index];\r\n\r\n            play.active = true;\r\n\r\n            name.getComponent(cc.Label).string = playerInfo.nickname;\r\n\r\n            if(this._deskInfo.createId == playerInfo.id){//显示房主\r\n\r\n                back.active = true;\r\n            }\r\n            else{\r\n\r\n                back.active = false;\r\n            }\r\n\r\n            cc.loader.load({url:playerInfo.avatarUrl,type:\"jpg\"}, function (err, data) {\r\n\r\n                if (err) return;\r\n\r\n                var frame = new cc.SpriteFrame(data);\r\n\r\n                img.getComponent(cc.Sprite).spriteFrame = frame;\r\n\r\n            }.bind(this));\r\n\r\n            if(dataInfo == 1){\r\n\r\n                str.getComponent(cc.Label).string = \"同意\";\r\n            }\r\n            else{\r\n\r\n                str.getComponent(cc.Label).string = \"\";\r\n            }\r\n\r\n        }.bind(this));\r\n\r\n        let dissolveLeftTime = deskInfo.dissolveLeftTime || 60;\r\n\r\n        let countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');\r\n\r\n        countdown.startCountdown(dissolveLeftTime, function(isTimeout) {\r\n\r\n            if (isTimeout) {\r\n                this.clickAgreeOtherPlayerExit();\r\n                return;\r\n            }\r\n\r\n        }.bind(this));\r\n\r\n        let dissolveUserId = deskInfo.dissolveUserId;\r\n\r\n        if (dissolveUserId == this._userId) {\r\n\r\n            var alert_bg = this.alertAnsowerExitNode.getChildByName(\"alert_bg\");\r\n\r\n            var btnAgree = alert_bg.getChildByName(\"btnAgree\");\r\n\r\n            var btnDisagree = alert_bg.getChildByName(\"btnDisagree\");\r\n\r\n            btnAgree.active = false;\r\n\r\n            btnDisagree.active = false;\r\n            //this.alertRequestExitNode.active = true;\r\n            //this.btnAlertRequestExitCancelButton.node.active = false;\r\n            //this.btnAlertRequestExitConfirmButton.node.active = false;\r\n            //let alert = this.alertRequestExitNode.getComponent('alert');\r\n            //alert.setMessage(\"您正在申请协商退出，等待其他玩家同意\");\r\n            //this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(dissolveLeftTime);\r\n            return;\r\n        }\r\n\r\n\r\n        //let dissolveAnswerInfos = deskInfo.dissolveAnswerInfo;\r\n        //let currentUserIdIndex = deskInfo.playersIndex.findIndex(function(userId) {\r\n        //    return this._userId == userId;\r\n        //}.bind(this));\r\n        //\r\n        //let answerResult = dissolveAnswerInfos[currentUserIdIndex];\r\n        //\r\n        //if (answerResult == -1) {\r\n        //    // -1 表示未处理  0 表示拒绝  1表示同意\r\n        //    this.alertAnsowerExitNode.active = true;\r\n        //\r\n        //    let countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');\r\n        //\r\n        //    countdown.startCountdown(dissolveLeftTime, function(isTimeout) {\r\n        //        if (isTimeout) {\r\n        //            this.clickAgreeOtherPlayerExit();\r\n        //        }\r\n        //    }.bind(this));\r\n        //\r\n        //}\r\n    },\r\n\r\n\r\n    // 确定要强制退出游戏\r\n    clickConfirmForceExit: function() {\r\n        Socket.sendForceExitRoom(this._userId);\r\n        cc.director.loadScene('hall');\r\n    },\r\n\r\n    // 确认请求退出游戏\r\n    clickConfirmRequestExit: function () {\r\n        this.btnAlertRequestExitCancelButton.node.active = false;\r\n        this.btnAlertRequestExitConfirmButton.node.active = false;\r\n        let alert = this.alertRequestExitNode.getComponent('alert');\r\n        if(this._deskInfo.cIndex>0){\r\n            alert.setMessage(\"您正在申请协商退出，等待其他玩家同意\");\r\n            this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(60);\r\n        }\r\n        Socket.sendLeaveDesk(this._userId);\r\n    },\r\n\r\n    // 同意他人退出\r\n    clickAgreeOtherPlayerExit: function () {\r\n        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();\r\n        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();\r\n        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();\r\n        var alert_bg = this.alertAnsowerExitNode.getChildByName(\"alert_bg\");\r\n        var btnAgree = alert_bg.getChildByName(\"btnAgree\");\r\n        var btnDisagree = alert_bg.getChildByName(\"btnDisagree\");\r\n        btnAgree.active = false;\r\n        btnDisagree.active = false;\r\n        Socket.sendAnswerDissolve(this._userId, 1);\r\n    },\r\n\r\n    // 不同意他人退出\r\n    clickDisagreeOtherPlayerExit: function () {\r\n        //this.alertAnsowerExitNode.getComponent('alert').dismissAction();\r\n        //this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();\r\n        //this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();\r\n        var alert_bg = this.alertAnsowerExitNode.getChildByName(\"alert_bg\");\r\n        var btnAgree = alert_bg.getChildByName(\"btnAgree\");\r\n        var btnDisagree = alert_bg.getChildByName(\"btnDisagree\");\r\n        btnAgree.active = false;\r\n        btnDisagree.active = false;\r\n        Socket.sendAnswerDissolve(this._userId, 0);\r\n    },\r\n\r\n    // 隐藏请求退出 Node\r\n    _hideReqestExitNode: function () {\r\n        if (!this.alertRequestExitNode.active) {\r\n            return;\r\n        }\r\n\r\n        this.alertRequestExitNode.active = false;\r\n        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();\r\n    },\r\n\r\n    //// 打枪\r\n    playShoot: function (fromUserId, toUserId) {\r\n        let user = this._findPlayerInfoByUserId(fromUserId);\r\n        if (user) {\r\n            AudioManager.instance.playHumanDaQiang(user.sex);\r\n        }\r\n\r\n        let toUserIndex = this._findPlayerIndexByUserId(toUserId);\r\n\r\n        this._playerComponents.forEach(function (player) {\r\n            if(this._userId == fromUserId || this._userId == toUserId) player.showNextCompareScore();\r\n            player.playShootAnimation(fromUserId, toUserIndex);\r\n            player.playBulletHoleAnimation(toUserId);\r\n        }.bind(this));\r\n    },\r\n\r\n    // 播放全垒打动效\r\n    playHomeRun: function (userId) {\r\n        let user = this._findPlayerInfoByUserId(userId);\r\n        if (user) {\r\n            AudioManager.instance.playHomeRun(user.sex);\r\n        }\r\n        this.node.getComponent(\"animation\")._quanleidaAnimation('long');\r\n\r\n        this._playerComponents.forEach(function (player) {\r\n\r\n            player.showNextCompareScore();\r\n\r\n        }.bind(this));\r\n\r\n    },\r\n\r\n    playSpeakAnimation: function (userId) {\r\n        this._playerComponents.forEach(function (player) {\r\n            player.playSpeakAnimation(userId);\r\n        });\r\n    },\r\n\r\n    _shootDatas: function () {\r\n        let homeRunUserId = this._homeRunUserId(); // 全垒打\r\n        let shootDatas = this._deskInfo.shotData.filter(function (data) {\r\n            return data.fromUserId == homeRunUserId;\r\n        });\r\n        return shootDatas;\r\n    },\r\n\r\n    _shotData: function () {\r\n        let homeRunUserId = this._homeRunUserId(); // 打枪\r\n        let shotData = this._deskInfo.shotData.filter(function (data) {\r\n            return data.fromUserId != homeRunUserId;\r\n        });\r\n        return shotData;\r\n    },\r\n\r\n    _homeRunUserId: function () {\r\n        return this._deskInfo.allShotData;\r\n    },\r\n\r\n    // MARK: 房间信息部分\r\n\r\n    // 获取房间的玩法\r\n    _deskInfoGameWay: function() {\r\n        let setting = this._deskInfo.setting3;\r\n        if(setting == null){\r\n            setting = 2;\r\n        }\r\n        let names = [\"庄家模式\", \"无特殊牌\",\"普通模式\"];\r\n        return names[setting];\r\n    },\r\n\r\n    _deskInfoNumberOfGame: function() {\r\n        let setting = this._deskInfo.setting1;\r\n        let infos = ['10局', '20局', '40局', '5局'];\r\n        /*if (setting <= 1) {\r\n         return '条数：' + infos[setting];\r\n         }*/\r\n        if(setting == 2){\r\n            setting = 0;\r\n        }\r\n        else if(setting == 3){\r\n            setting = 1;\r\n        }\r\n        else if(setting == 4){\r\n            setting = 2;\r\n        }\r\n        else if(setting == 5){\r\n            setting = 3;\r\n        }\r\n        return '局数：' + infos[setting];\r\n    },\r\n\r\n    _deskInfoNumberOfPeople: function() {\r\n        let setting = this._deskInfo.setting2;\r\n        let infos = ['2人', '3人', '4人', '5人'];\r\n        return infos[setting];\r\n    },\r\n\r\n    _deskInfoPayInfo: function() {\r\n        let setting = this._deskInfo.setting4;\r\n        if(setting == null){\r\n            setting = 0;\r\n        }\r\n        if(setting == 0){\r\n            setting = 1;\r\n        }\r\n        let infos = ['房主霸主庄', '房费AA'];\r\n        return infos[setting];\r\n    },\r\n\r\n    _deskInfoJiaYiSeInfo: function() {\r\n        let setting = this._deskInfo.setting7 == 0 ? 1 : 0;\r\n        let infos = ['无多一色', '多一色'];\r\n        return infos[setting];\r\n    },\r\n\r\n    _deskInfoGuiPaiInfo: function() {\r\n        let setting;\r\n        if(this._deskInfo.setting8 == null){\r\n            setting = 0;\r\n        }\r\n        else if(this._deskInfo.setting8 == 0){\r\n            setting = 1;\r\n        }\r\n        else if(this._deskInfo.setting8 == 1){\r\n            setting = 2;\r\n        }\r\n        let infos = ['无王牌', '两张王牌', '四张王牌'];\r\n        return infos[setting];\r\n    },\r\n\r\n    // MARK: 剩余时间\r\n    _remainTimeStartUpdate: function() {\r\n        //this.schedule(this._remainTimeUpdate, 1.0, cc.macro.REPEAT_FOREVER);\r\n    },\r\n\r\n    _remainTimeUpdate: function() {\r\n        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {\r\n            this.labelRemainTime.string = \"\";\r\n            this.labelRemainTime.node.active = false;\r\n            return;\r\n        }\r\n\r\n        if (this._deskInfo == null) {\r\n            this.labelRemainTime.string = \"\";\r\n            this.labelRemainTime.node.active = false;\r\n            return;\r\n        }\r\n\r\n        let isTaoShu = (this._deskInfo.setting1 == 0) || (this._deskInfo.setting1 == 1);\r\n        if (isTaoShu) {\r\n            this.labelRemainTime.node.active = false;\r\n            return;\r\n        }\r\n\r\n        if (!this._deskInfo.createTime) {\r\n            return;\r\n        }\r\n\r\n        this.labelRemainTime.node.active = true;\r\n        let createTime = fecha.parse(this._deskInfo.createTime, 'YYYY-MM-DD HH:mm:ss').getTime();\r\n        let oneHour = 60 * 60;\r\n        let remain = (Date.now() - createTime) / 1000;\r\n        remain = Math.max(oneHour - remain, 0);\r\n\r\n        let mins = Math.floor(remain / 60);\r\n        let secs = Math.floor(remain % 60);\r\n        if (mins == 0 && secs == 0) {\r\n            this.labelRemainTime.string = \"\";\r\n            return;\r\n        }\r\n\r\n        var minsString = \"\" + mins;\r\n        if (minsString.length < 2) {\r\n            minsString = \"0\" + minsString;\r\n        }\r\n\r\n        var secsString = \"\" + secs;\r\n        if (secsString.length < 2) {\r\n            secsString = \"0\" + secsString;\r\n        }\r\n\r\n        let string = \"剩余时间：00:\" + minsString + \":\" + secsString;\r\n        this.labelRemainTime.string = string;\r\n    },\r\n\r\n    // MARK: 处理同 IP 的用户\r\n    _handleTheSameOfIPAdress: function(userInfos) {\r\n        if (!userInfos || userInfos.length == 0) {\r\n            return;\r\n        }\r\n\r\n        let ipUserInfos = userInfos.reduce(function(ips, userInfo) {\r\n            let users = ips[userInfo.ipAddress] || [];\r\n            users.push(userInfo);\r\n\r\n            ips[userInfo.ipAddress] = users;\r\n            return ips;\r\n        }, {});\r\n\r\n        let sameIpUsers = null;\r\n        for (let ip in ipUserInfos) {\r\n            let users = ipUserInfos[ip];\r\n            if (users.length > 1) {\r\n                sameIpUsers = users;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (sameIpUsers == null) {\r\n            return;\r\n        }\r\n\r\n        this._alertSameIpUserInfos(sameIpUsers);\r\n    },\r\n\r\n    _alertSameIpUserInfos: function(users) {\r\n        let message = \"\";\r\n        let userIds = \"\";\r\n        users.forEach(function(user, index) {\r\n            message = message + (index > 0 ? ' 和 ' : '') + user.nickname;\r\n            userIds = userIds + user.id;\r\n        });\r\n        message = message + ' 在同一 IP 下！';\r\n\r\n        this._didAlertSameIpMessage = this._didAlertSameIpMessage || {};\r\n        if (this._didAlertSameIpMessage[userIds]) {\r\n            return;\r\n        }\r\n\r\n        this.showAlertMessage(message, true);\r\n        this._didAlertSameIpMessage[userIds] = true;\r\n    },\r\n\r\n});\r\nPlay.gongXiNiShow = function (type) {\r\n    this.instances._gongXiNiShow(type);\r\n};\r\nmodule.exports = Play;\r\n"]}