{"version":3,"sources":["TotalGameResult.js"],"names":["KQNativeInvoke","require","Socket","cc","Class","extends","Component","properties","itemLayout","Layout","itemPrefab","Prefab","timeLabel","Label","jushuLabel","roomId","nicknameLabels","recordInfo_sview","Node","sharrBg","btnWeiXin","btnGongXuoHao","btnZhuShou","btnZongFen","suanfen_sview","suanFenPrefab","suanFenBgPrefab","onLoad","onDisable","shareTitle","desc","sys","localStorage","setItem","removeItem","window","shareToTimeLine","shareToSession","js","setting2","jushu","creator","players","i","length","id","_clickBtn","active","clickZongFen","forEach","node","_globalMsg","recordInfo","pj","setting1","time","createAt","createTime","recordId","undefined","setPlayerInfos","playerInfos","deskInfo","sort","a","b","totalScore","_playerInfos","_deskInfo","createId","createUserId","nickname","string","substr","removeAllChildren","user","item","instantiate","getComponent","setUserInfo","children","addChild","bind","clickSuanFen","playersRigth","filter","player","playersLeft","playersRigthScore","map","playersLeftScore","playersIndex","arrs","indexs","index","_ctarePrefab","x","y","j","s","d","indexOf","plays","splice","childrenCount","fen","getChildByName","q","w","addScore","arr","push","t","r","shu","color","Color","str","sprite","Sprite","headUrl","avatarUrl","loader","load","url","type","err","tex","frame","SpriteFrame","spriteFrame","height","width","clickExit","sendOnceAgain","_userId","director","loadScene","clickShareWeiChat","isNative","isNativeIOS","jsb","reflection","callStaticMethod","IOSClassName","screenshotShare","clickShareBg","clickSharePengYouQuan","ANDRIODClassName","getCombBySum","array","sum","tolerance","targetCount","util","getCombination","num","f","n","l","concat","slice","getArrayIndex","logic","init","_array","core","arrayIndex","count","k","combArray","_sum","_cca","_cache","_returnMark","Math","abs","_tolerance","_targetCount"],"mappings":"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","file":"TotalGameResult.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Play","sourcesContent":["const KQNativeInvoke = require('KQNativeInvoke');\nconst Socket = require('socket');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        itemLayout: cc.Layout,\n        itemPrefab: cc.Prefab,\n        timeLabel:cc.Label,   // 时间\n        jushuLabel:cc.Label,  // 局数\n        roomId:cc.Label,      // 房间号\n        nicknameLabels:cc.Label,\n        recordInfo_sview:[cc.Node],\n\n        sharrBg:cc.Node,\n        btnWeiXin:cc.Node,\n        btnGongXuoHao:cc.Node,\n        btnZhuShou:cc.Node,\n        btnZongFen:cc.Node,\n\n        suanfen_sview:cc.Node,\n        suanFenPrefab: cc.Prefab,\n        suanFenBgPrefab: cc.Prefab,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n\n    },\n\n    onDisable:function(){\n        //if(cc.sys.isBrowser){\n        //\n            var shareTitle = '开房玩[大众十三水]';\n            var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~'; \n            cc.sys.localStorage.setItem('shareTitle',shareTitle);\n            cc.sys.localStorage.setItem('desc',desc);\n            \n            // cc.sys.localStorage.removeItem(\"shareTitle\");\n            // cc.sys.localStorage.removeItem(\"desc\");\n            cc.sys.localStorage.removeItem(\"recordId\");\n            //cc.sys.localStorage.setItem(\"roomId\",'');\n            if(window.shareToTimeLine) {\n                window.shareToTimeLine();\n            }\n            if(window.shareToSession) {\n                window.shareToSession();\n            }\n        //}\n\n    },\n    js: function(setting2){\n        var jushu = 5;\n        switch(setting2){\n            case 0: jushu = 5; break;case 1: jushu = 10; break;\n            case 2: jushu = 20; break;case 3: jushu = 30; break;\n        }\n        return jushu;\n    },\n\n    creator :function(creator,players){    //创房者\n        for(var i =0; i<players.length;i++){\n            if(players[i].id == creator){\n                return i;\n            }\n        }\n    },\n\n    _clickBtn :function(){\n        this.btnZhuShou.active = true;\n        this.btnZongFen.active = false;\n    },\n\n    clickZongFen :function(){\n\n        this.btnZhuShou.active = true;\n\n        this.btnZongFen.active = false;\n\n        this.recordInfo_sview.forEach(function (node) {node.active = true;});\n\n        this.suanfen_sview.active = false;\n    },\n    _globalMsg:function(recordInfo){\n        //if(cc.sys.isBrowser) {\n            var roomId =\"房间号：\"+recordInfo.roomId;\n            var pj = [\"5 \",\"10 \",\"20 \"];  \n            var js = \"局数：\"+pj[recordInfo.setting1-2];\n            var time = \"时间：\"+(recordInfo.createAt?recordInfo.createAt:recordInfo.createTime);\n            var shareTitle = \"[大众十三水]战绩\";\n            var desc = roomId+js+time+\" 点击查看详情\";\n            var recordId = (recordInfo.id!=undefined)?recordInfo.id:recordInfo.recordId;  \n            cc.sys.localStorage.setItem(\"shareTitle\",shareTitle);\n            cc.sys.localStorage.setItem(\"desc\",desc);\n            cc.sys.localStorage.setItem(\"recordId\",recordId);\n            cc.sys.localStorage.setItem(\"roomId\",'');\n\n            if(window.shareToTimeLine) {\n                window.shareToTimeLine();\n            }\n            if(window.shareToSession) {\n                window.shareToSession();\n            }\n        //}\n    },\n    //大局\n    setPlayerInfos: function (playerInfos, deskInfo){\n        playerInfos.sort(function(a,b){return b.totalScore-a.totalScore}); // 排序\n        // cc.log(playerInfos)\n        // cc.log(deskInfo)\n        // cc.log('--65')\n         \n        this._globalMsg(deskInfo);\n        this.recordInfo_sview.forEach(function (node) {node.active = true;});\n\n        this.suanfen_sview.active = false;\n\n        this.btnZhuShou.active = true;\n\n        this.btnZongFen.active = false;\n\n        this._playerInfos = playerInfos;\n\n        this._deskInfo = deskInfo;\n\n        var createId = deskInfo.createUserId? deskInfo.createUserId: deskInfo.createId;\n\n        var nickname = playerInfos[ this.creator(createId, playerInfos) ].nickname;\n\n        this.roomId.string = deskInfo.roomId;\n\n        var createAt = deskInfo.createAt? deskInfo.createAt: deskInfo.createTime;\n\n        this.timeLabel.string = createAt.substr(0,11);\n\n        this.jushuLabel.string = this.js(deskInfo.setting1-2);\n\n        this.nicknameLabels.string = nickname;\n\n        this.itemLayout.node.removeAllChildren();\n\n        playerInfos.forEach(function (user) {\n\n            let item = cc.instantiate(this.itemPrefab);\n\n            item.getComponent('TotalGameResultItem').setUserInfo(user, deskInfo);\n\n            if(deskInfo.createUserId == user.id || deskInfo.createId == user.id){\n\n                item.children[1].children[0].active = true;\n\n            }else{\n\n                item.children[1].children[0].active = false;\n\n            }\n\n            this.itemLayout.node.addChild(item);\n\n        }.bind(this));\n\n    },\n\n    //算分能手\n    clickSuanFen: function () {\n\n        this.btnZhuShou.active = false;\n\n        this.btnZongFen.active = true;\n\n        this.recordInfo_sview.forEach(function (node) {node.active = false;});\n\n        this.suanfen_sview.active = true;\n\n        var playersRigth = this._playerInfos.filter(function (player) {return player.totalScore > 0;});\n\n        var playersLeft = this._playerInfos.filter(function (player) {return player.totalScore < 0;});\n\n        var playersRigthScore = playersRigth.map(function (player) {return player.totalScore;});\n\n        var playersLeftScore = playersLeft.map(function (player) {return player.totalScore * -1;});\n\n        var playersIndex = [],\n\n            arrs = [playersRigthScore.filter(function(i){return i;}),playersLeftScore.filter(function(i){return i;})],\n\n            indexs = playersLeftScore.length > playersRigthScore.length? 0: 1;//1是赢的人 0输的人\n\n        // for(var i = 0;i < arrs[indexs].length; i++){\n\n        //     var score = arrs[indexs][i];\n\n        //     var d = this.getCombBySum(arrs[indexs==1?0:1], score)[0] || [];\n\n        //     if(d.length > 0){\n\n        //         playersIndex.push([score,d]);\n\n        //         d.forEach(function (s) {\n\n        //             var index = arrs[indexs==1?0:1].indexOf(s);\n\n        //             if(index != -1) arrs[indexs==1?0:1].splice(index,1);\n\n        //         });\n        //     }\n        // }\n\n        // if(playersIndex.length == 0) indexs = 2;\n        indexs = 2\n        this.suanfen_sview.children[0].removeAllChildren();\n\n        playersLeft.forEach(function (user, index) {\n\n            var suanFenBgPrefab = cc.instantiate(this.suanFenBgPrefab);\n\n            suanFenBgPrefab.removeAllChildren();\n\n            this._ctarePrefab(1 ,suanFenBgPrefab, user, user.totalScore, this._deskInfo ,-200 ,0);\n\n            var x = 0, y = 0;\n\n            if(indexs == 1){\n                for(var j = 0; j < playersIndex[index][1].length; j++){\n\n                    var s = playersIndex[index][1][j];\n\n                    var d = playersRigthScore.indexOf(s);\n\n                    if(d != -1){\n\n                        var plays = playersRigth.splice(d,1)[0];\n\n                        playersRigthScore.splice(d,1);\n\n                        if(plays){\n\n                            if(suanFenBgPrefab.childrenCount >= 3) y = -90;\n\n                            if(suanFenBgPrefab.childrenCount == 3) x = 0;\n\n                            if(suanFenBgPrefab.childrenCount >= 5) y = -180;\n\n                            if(suanFenBgPrefab.childrenCount == 5) x = 0;\n\n                            this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x ,y);\n\n                            x += 200;\n\n                        }\n                    }\n                }\n            }\n            else if(indexs == 0){\n                var fen = suanFenBgPrefab.children[0].getChildByName(\"fen\").getComponent(cc.Label).string.substr(3) * -1;\n\n                for(var j = 0; j < playersIndex.length; j++){\n\n                    var s = playersIndex[j];\n\n                    var d = s[1].indexOf(fen);\n\n                    var q = s[0];\n\n                    var w = playersRigthScore.indexOf(q);\n\n                    if(d != -1 && w != -1){\n\n                        var plays = playersRigth[w];\n\n                        this._ctarePrefab(0, suanFenBgPrefab, plays, plays.totalScore, this._deskInfo, x, y, fen);\n                    }\n                }\n            }\n            else {\n                var q = playersLeftScore[index];\n                var addScore = 0;\n                var arr = [];\n                for(var j = 0; j < playersRigthScore.length; j++){\n                    var w = playersRigthScore[j];\n                    if(addScore < q){\n                        addScore += w;\n                        if(addScore > q){\n                            arr.push(w - (addScore - q));\n                        }else{\n                            arr.push(w);\n                        }\n                        if(q - w >= 0){\n                            playersRigthScore[j] = 0;\n                        }\n                    }\n                    if(addScore > q){\n                        playersRigthScore[j] = addScore - q;\n                        break;\n                    }\n                }\n\n                for(var t = 0; t < arr.length; t++){\n                    var r = arr[t];\n                    if(r == 0) continue;\n                    if(suanFenBgPrefab.childrenCount >= 3) y = -90;\n\n                    if(suanFenBgPrefab.childrenCount == 3) x = 0;\n\n                    if(suanFenBgPrefab.childrenCount >= 5) y = -180;\n\n                    if(suanFenBgPrefab.childrenCount == 5) x = 0;\n\n                    var plays = playersRigth[t];\n\n                    this._ctarePrefab(0, suanFenBgPrefab, plays, r, this._deskInfo, x, y);\n\n                    x += 200;\n                }\n\n            }\n\n            this.suanfen_sview.children[0].addChild(suanFenBgPrefab);\n\n        }.bind(this));\n\n    },\n\n    _ctarePrefab: function (shu, node, user, totalScore, deskInfo, x, y, fen = null) {\n\n        var suanFenPrefab = cc.instantiate(this.suanFenPrefab);\n\n        suanFenPrefab.getChildByName(\"ID\").getComponent(cc.Label).string = \"ID:\"+user.id;\n\n        if(deskInfo.createUserId == user.id)suanFenPrefab.getChildByName(\"ID\").color = new cc.Color(235, 115, 122);\n\n        suanFenPrefab.getChildByName(\"shu\").getComponent(cc.Label).string = shu == 0? \"输\": \"\";\n\n        var str = shu == 0? totalScore+\"分\": \"总分:\"+totalScore;\n\n        if(fen) str = fen+\"分\";\n\n        suanFenPrefab.getChildByName(\"fen\").getComponent(cc.Label).string = str;\n\n        var sprite = suanFenPrefab.getChildByName(\"haed\").getComponent(cc.Sprite);\n\n        var headUrl = user.avatarUrl; // 头像URL\n\n        cc.loader.load({url:headUrl,type:\"jpg\"}, function (err, tex) {\n\n            if (!err) {\n\n                var frame = new cc.SpriteFrame(tex);\n\n                sprite.spriteFrame = frame;\n\n                sprite.node.height = 55;\n\n                sprite.node.width = 55;\n\n            }\n\n        });\n\n        suanFenPrefab.x = x;\n\n        suanFenPrefab.y = y;\n\n        node.height = 90 + y * -1;\n\n        node.addChild(suanFenPrefab);\n\n    },\n\n    clickExit: function () {\n        Socket.sendOnceAgain('false',this._userId);\n        cc.director.loadScene('hall');\n    },\n\n    clickShareWeiChat: function () {\n        if(!cc.sys.isNative){\n            this.sharrBg.active = true;\n        }else{\n            if (KQNativeInvoke.isNativeIOS()) {\n                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxScreenShareFriend\",);\n            }\n             else {//Android\n                  KQNativeInvoke.screenshotShare();\n            }\n       }\n    },\n    clickShareBg :function () {\n        this.sharrBg.active = false;\n    },\n    clickSharePengYouQuan: function () {\n      if (KQNativeInvoke.isNativeIOS()) {\n          jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxScreenShare\",);\n      }\n      else {//Android\n          jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxScreenShare\", \"()V\");\n      }\n    },\n\n    getCombBySum: function (array,sum,tolerance,targetCount) {\n        var util = {\n                /*\n                 get combination from array\n                 arr: target array\n                 num: combination item length\n                 return: one array that contain combination arrays\n                 */\n                getCombination: function(arr, num) {\n                    var r=[];\n                    (function f(t,a,n)\n                    {\n                        if (n==0)\n                        {\n                            return r.push(t);\n                        }\n                        for (var i=0,l=a.length; i<=l-n; i++)\n                        {\n                            f(t.concat(a[i]), a.slice(i+1), n-1);\n                        }\n                    })([],arr,num);\n                    return r;\n                },\n                //take array index to a array\n                getArrayIndex: function(array) {\n                    var i = 0,\n                        r = [];\n                    for(i = 0;i<array.length;i++){\n                        r.push(i);\n                    }\n\n                    return r;\n                }\n            },logic = {\n                //sort the array,then get what's we need\n                init: function(array,sum) {\n                    //clone array\n                    var _array = array.concat(),\n                        r = [],\n                        i = 0;\n                    //sort by asc\n                    _array.sort(function(a,b){\n                        return a - b;\n                    });\n                    //get all number when it's less than or equal sum\n                    for(i = 0;i<_array.length;i++){\n                        if(_array[i]<=sum){\n                            r.push(_array[i]);\n                        }else{\n                            break;\n                        }\n                    }\n\n                    return r;\n                },\n                //important function\n                core: function(array,sum,arrayIndex,count,r){\n                    var i = 0,\n                        k = 0,\n                        combArray = [],\n                        _sum = 0,\n                        _cca = [],\n                        _cache = [];\n\n                    if(count == _returnMark){\n                        return;\n                    }\n                    //get current count combination\n                    combArray = util.getCombination(arrayIndex,count);\n                    for(i = 0;i<combArray.length;i++){\n                        _cca = combArray[i];\n                        _sum = 0;\n                        _cache = [];\n                        //calculate the sum from combination\n                        for(k = 0;k<_cca.length;k++){\n                            _sum += array[_cca[k]];\n                            _cache.push(array[_cca[k]]);\n                        }\n                        if(Math.abs(_sum-sum) <= _tolerance){\n                            r.push(_cache);\n                        }\n                    }\n\n                    logic.core(array,sum,arrayIndex,count-1,r);\n                }\n\n            },\n            r = [],\n            _array = [],\n            _targetCount = 0,\n            _tolerance = 0,\n            _returnMark = 0;\n\n        //check data\n        _targetCount = targetCount || _targetCount;\n        _tolerance = tolerance || _tolerance;\n\n        _array = logic.init(array,sum);\n        if(_targetCount){\n            _returnMark = _targetCount-1;\n        }\n\n        logic.core(_array,sum,util.getArrayIndex(_array),(_targetCount || _array.length),r);\n\n        return r;\n    },\n});\n"]}