{"version":3,"sources":["Setting.js"],"names":["Manager","require","KQNativeInvoke","cc","Class","extends","Component","properties","phone","Label","musicSlider","Node","effectSlider","btnSwitchAccount","Button","shareBg","wx","pyq","music","sounds","_audioManager","_musicOn","_soundsOn","_phone","onLoad","find","getComponent","_initSliders","string","bgMusic","sys","localStorage","getItem","bgSound","parseInt","getChildByName","active","setEffectMusicVolum","clickWx","isNative","title","description","recordId","roomId","id","isNativeIOS","jsb","reflection","callStaticMethod","IOSClassName","isNativeAndroid","str","ANDRIODClassName","clickPyq","clickshareBg","clickMusic","children","volume","setBgMusicVolumn","playMusic","setItem","clickSounds","clickSetting","_initSliderEvents","musicVal","getMusicValue","effectVal","getMusicEffectValue","setValue","self","onValueChange","value","setMusicValue","setMusicEffectValue","clickSwitch","hideSwitch","node"],"mappings":"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","file":"Setting.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Setting","sourcesContent":["const Manager = require('manager');\nconst KQNativeInvoke = require('KQNativeInvoke');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n      phone:cc.Label,\n      musicSlider:cc.Node,\n      effectSlider:cc.Node,\n      btnSwitchAccount: cc.Button,\n      shareBg:cc.Node,\n      wx:cc.Node,\n      pyq:cc.Node,\n      music:cc.Node,\n      sounds:cc.Node,\n      _audioManager: null,\n      _musicOn : 1,\n      _soundsOn : 1,\n      _phone:null,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n      this._audioManager = cc.find('AudioManager') || {};\n      this._audioManager = this._audioManager.getComponent('AudioManager');\n      this._initSliders();\n      this.phone.string = this._phone?this._phone:\"无\";\n        var bgMusic = cc.sys.localStorage.getItem(\"bgMusic\");\n        var bgSound = cc.sys.localStorage.getItem(\"bgSound\");\n        //console.log(bgMusic);\n        if(bgMusic != '') {\n            if (parseInt(bgMusic) == 1) {\n                this._musicOn = 1;\n                this.music.getChildByName('music_on').active = true;\n                this.music.getChildByName('music_off').active = false;\n            }\n            else {\n                this._musicOn = 0;\n                this.music.getChildByName('music_on').active = false;\n                this.music.getChildByName('music_off').active = true;\n            }\n        }\n        if(bgSound == 0){ // 如果背景音效是关闭的\n            if (parseInt(bgSound) == 0) {\n                this._soundsOn = 0;\n                this.sounds.getChildByName('sounds_on').active = false;\n                this.sounds.getChildByName('sounds_off').active = true;\n            }\n            else {\n                this._soundsOn = 1;\n                this.sounds.getChildByName('sounds_on').active = true;\n                this.sounds.getChildByName('sounds_off').active = false;\n            }\n            this._audioManager.setEffectMusicVolum(this._soundsOn);\n        }\n    },\n    clickWx: function(){  //点击微信\n      if(!cc.sys.isNative){\n        this.shareBg.active = true;\n        this.wx.active = true;\n      }else{\n        var title = cc.sys.localStorage.getItem('shareTitle');\n        var description = cc.sys.localStorage.getItem('desc');\n        var recordId = cc.sys.localStorage.getItem('recordId');\n        var roomId = cc.sys.localStorage.getItem('roomId');\n        var id= '';\n        if(roomId){\n            id = 'roomId='+roomId;\n        }\n        if(recordId){\n            id = 'recordId='+recordId;\n        }\n        if (KQNativeInvoke.isNativeIOS()) {\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxShareFriend:description:\",id, description,title);\n        } else if (KQNativeInvoke.isNativeAndroid()) {//Android\n            var str = \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\";\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxShareFriend\",str, id, description,title);\n        }\n      }\n      \n    },\n    clickPyq: function(){ //点击朋友圈\n      if(!cc.sys.isNative){\n        this.shareBg.active = true;\n        this.pyq.active = true;\n      }else{\n        var title = cc.sys.localStorage.getItem('shareTitle');\n        var description = cc.sys.localStorage.getItem('desc');\n        var recordId = cc.sys.localStorage.getItem('recordId');\n        var roomId = cc.sys.localStorage.getItem('roomId');\n        var id= '';\n        if(roomId){\n            id = 'roomId='+roomId;\n        }\n        if(recordId){\n            id = 'recordId='+recordId;\n        }\n        if (KQNativeInvoke.isNativeIOS()) {\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxShareHallTimeline:description:\",id, description,title);\n        } else if (KQNativeInvoke.isNativeAndroid()) {//Android\n            var str = \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\";\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxShareHallTimeline\",str, id, description,title);\n        }\n      }\n      \n    },\n\n    clickshareBg: function(){  // 点击分享背景图\n      this.shareBg.active = false;\n      this.wx.active = false;\n      this.pyq.active = false;\n    },\n    clickMusic :function(){   //点击音乐\n      this.music.children[1].active = (this._musicOn = !this._musicOn);   \n      this.music.children[2].active = !this._musicOn;\n        var volume = 0;\n      if(this._musicOn){\n        this._audioManager.setBgMusicVolumn(1);\n          this._audioManager.playMusic();\n          volume = 1;\n      }else{\n        this._audioManager.setBgMusicVolumn(0);\n          volume = 0;\n      }\n        cc.sys.localStorage.setItem(\"bgMusic\",volume);\n    },\n\n    clickSounds :function(){  //点击了音效\n      this.sounds.children[1].active = (this._soundsOn = !this._soundsOn);\n      this.sounds.children[2].active = !this._soundsOn;\n      var volume=0;\n      if(this._soundsOn){\n        this._audioManager.setEffectMusicVolum(1);\n        volume = 1;\n      }else{\n        this._audioManager.setEffectMusicVolum(0);\n        volume = 0;\n      }\n      cc.sys.localStorage.setItem(\"bgSound\",volume);\n    },\n    clickSetting:function(){  //点击设置\n        \n    },\n    _initSliders: function () {\n      this._initSliderEvents();\n\n      let musicVal = Manager.getMusicValue();\n      let effectVal = Manager.getMusicEffectValue();\n\n      this._audioManager.setBgMusicVolumn(musicVal);\n      this._audioManager.setEffectMusicVolum(effectVal);\n\n      this.musicSlider.getComponent('slider').setValue(musicVal);\n      this.effectSlider.getComponent('slider').setValue(effectVal);\n    },\n\n    _initSliderEvents: function () {\n      let self = this;\n      this.musicSlider.getComponent('slider').onValueChange = function(value) {\n        Manager.setMusicValue(value);\n        self._audioManager.setBgMusicVolumn(value);\n      };\n\n      this.effectSlider.getComponent('slider').onValueChange = function(value) {\n        Manager.setMusicEffectValue(value);\n        self._audioManager.setEffectMusicVolum(value);\n      };\n    },\n\n    clickSwitch: function () {\n\n    },\n\n    hideSwitch: function() {\n      if (this.btnSwitchAccount) {\n        this.btnSwitchAccount.node.active = false;\n      }\n    },\n});\n"]}