{"version":3,"sources":["hall.js"],"names":["manager","require","Socket","KQGlobalEvent","AudioManager","KQNativeInvoke","Playback","hall","cc","Class","extends","Component","properties","shopAlertNode","Node","createNode","joinNode","gengxin","alertPrefab","Prefab","tsSingleSelect","tsCheckSeclect","selectMoShi","selectGuiPai","overTime","labelBanner","Label","recordNode","waitingPrefab","setting","avatarNode","nickNameLabel","cardNumberLabel","userIdLabel","codeLabel","logoutNode","recordMsgNode","feedbackEditBox","EditBox","feedbackNode","wxshare","_userId","_openId","_help","_close","iosUrl","aUrl","statics","lastHallInfo","cacheImageInfo","onLoad","keyBackListen","sys","isBrowser","window","shareToTimeLine","shareToSession","localStorage","removeItem","bg","node","getChildByName","windowP","director","getWinSizeInPixels","scaleX","width","scaleY","height","scale","Math","max","clearLocalStorage","from","isUseMa","ma","isRoomViewShow","_btn","_buttons","volume","getItem","parseInt","instance","playMusic","bgSound","audioManager","find","getComponent","setEffectMusicVolum","removePlaybackDatas","_registerSocketEvent","_startBannerAnimation","_initJoinRoom","userInfo","id","openId","_inviteCode","inviteCode","self","socket","receviceMessage","response","data","JSON","parse","connectionSuccess","hiddenNetworkMessage","hiddenCheckMessage","connectionDisconnect","showNetworkMessage","checkNetworkNow","showCheckMessage","checkNetworkEnd","updateUserInfo","sendGetUserInfo","schedule","bind","sendGetHallInfo","updateBanner","info","onShareWXResp","preloadScene","joinDesk","result","reason","alertMessage","qingli","_this","systemEvent","on","SystemEvent","EventType","KEY_DOWN","e","keyCode","KEY","back","isNativeIOS","jsb","reflection","callStaticMethod","ANDRIODClassName","clickWxShare","isNative","active","title","description","recordId","IOSClassName","str","shareHallTimeline","shareBg","shareTitle","desc","setItem","onDestroy","offTarget","Event","JoinDesk","_jiinRoomSocketCallback","ReceiveDeskInfo","ReceiveCreateDesk","_createRoomSocketCallback","ReceiveHallInfo","_socketReceiveHallInfo","ReceiveGetUserInfo","_socketReceiveUserInfo","SocketDisconnect","_socketDisconnect","SocketConnectSuccessed","_socketConnected","guanzhu","anim","Animation","play","downLoad","url","openURL","joinRoom","callbackJoinRoom","number","userId","sendJoinDesk","hiddenWaitingMessage","setAlertCallbck","clickClear","maPai","loadScene","reasonInfo","_joinReasonMap","isIOS","isAndroid","isA","vIOS","vA","notice","broadcast","banner","downloadNewVersion","notExist","cardNumber","shopAction","comp","alert","msg","instantiate","addChild","setMessage","string","createDoneAction","key","i","length","tsIndex","selectedIndex","_select","_selected","_cards","set","sendMessage","dismissAction","showWaitingMessage","scheduleOnce","clickRecord","sendGetRecrod","clickPlayRule","help","clickPlay","clickOut","clickCancelLation","logoutAction","setUserInfo","exitAction","isNativeAndroid","end","error","_phone","phone","nickname","sprite","Sprite","loader","load","avatarUrl","type","err","tex","frame","SpriteFrame","spriteFrame","texture","feedbackAcion","text","sendFeedback","waitingNode","isObjectValid","destory","networkNode","getMessage","removeSelfAction","removeSelf","runAction","onDismissComplete","checkNode","onBtnClick","module","exports"],"mappings":"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","file":"hall.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["var manager = require('manager');\nconst Socket = require('socket');\nconst KQGlobalEvent = require('KQGlobalEvent');\nconst AudioManager = require('AudioManager');\nconst KQNativeInvoke = require('KQNativeInvoke');\nconst Playback = require('Playback');\n\nlet hall = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        //productNodes:[cc.Node],\n        shopAlertNode:cc.Node,\n        createNode:cc.Node,\n        joinNode:cc.Node,\n        gengxin:cc.Node,\n        alertPrefab:cc.Prefab,\n        tsSingleSelect:[cc.Node],   // 创建房间信息，单选\n        tsCheckSeclect:[cc.Node],   // 创建房间信息，复选\n        selectMoShi:cc.Node,        // 创建房间信息，模式（庄家模式和无特殊牌）\n        selectGuiPai:cc.Node,       // 创建房间信息，模式（庄家模式和无特殊牌）\n        overTime:cc.Node,           // 超时出牌\n        //labelNotice: cc.Label,      // 公告\n        labelBanner: cc.Label,      // banner label\n        recordNode:cc.Node,\n        waitingPrefab:cc.Prefab,\n        setting:cc.Node,\n        //用户信息\n        avatarNode:cc.Node,\n        nickNameLabel:cc.Label,\n        cardNumberLabel:cc.Label,\n        userIdLabel:cc.Label,\n        codeLabel:cc.Label,\n        //phone:cc.Label,\n        // userInfoMsgNode:cc.Node,\n        logoutNode: cc.Node,\n        //战绩\n        recordMsgNode:cc.Node,\n        feedbackEditBox:cc.EditBox,//反馈\n        feedbackNode:cc.Node,\n        wxshare:cc.Node,\n        _userId:0,\n        _openId:null,\n        _help:null,\n        _close:null,\n        iosUrl:null,\n        aUrl:null,\n\n    },\n\n    statics: {\n        lastHallInfo: null,   // 上一次收到的大厅信息\n        cacheImageInfo: null,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.keyBackListen();\n        if(cc.sys.isBrowser) {\n            if(window.shareToTimeLine) {\n                window.shareToTimeLine();\n            }\n            if(window.shareToSession) {\n                window.shareToSession();\n            }\n        }\n        cc.sys.localStorage.removeItem(\"timestamp\");\n        var bg = this.node.getChildByName(\"room_bg\");\n        var windowP = cc.director.getWinSizeInPixels();\n        var scaleX = windowP.width/bg.width;\n        var scaleY = windowP.height/bg.height;\n        var scale = Math.max(scaleX,scaleY);\n        bg.scaleX = scale;\n        bg.scaleY = scale;\n        this.clearLocalStorage();\n        cc.from = {};\n        cc.from.isUseMa = true;\n        cc.from.ma = 0;\n        cc.isRoomViewShow = false;\n        this._btn = this.node.getChildByName(\"btn\");\n        this._buttons = this.node.getChildByName(\"buttons\");\n        var volume = cc.sys.localStorage.getItem(\"bgVolume\");\n        if(volume!=null && parseInt(volume)) {\n            AudioManager.instance.playMusic();\n        }\n\n        var bgSound = cc.sys.localStorage.getItem(\"bgSound\");\n        if(bgSound == 0){\n            var audioManager = cc.find('AudioManager');\n            audioManager = audioManager.getComponent('AudioManager');\n            audioManager.setEffectMusicVolum(bgSound);\n        }\n        Playback.instance.removePlaybackDatas();\n\n        hall.cacheImageInfo = hall.cacheImageInfo || {};\n\n        this._registerSocketEvent();\n        this._startBannerAnimation();\n        this._initJoinRoom();\n\n        this._userId = Socket.instance.userInfo.id;\n        this._openId = Socket.instance.userInfo.openId;\n        this._inviteCode = Socket.instance.userInfo.inviteCode;  //邀请码\n        var self = this;\n        this.socket = cc.find('GameSocket').getComponent('socket');\n        this.socket.receviceMessage = function(response) {\n            var data = JSON.parse(response);\n        };\n\n        this.socket.connectionSuccess = function() {\n            self.hiddenNetworkMessage();\n            self.hiddenCheckMessage();\n        };\n        this.socket.connectionDisconnect = function() {\n            self.showNetworkMessage('网络链接断开，重新连接中...');\n        };\n        this.socket.checkNetworkNow = function() {\n            self.showCheckMessage('检查网络中...');\n        };\n        this.socket.checkNetworkEnd = function() {\n            self.hiddenCheckMessage();\n            self.hiddenNetworkMessage();\n        };\n\n        //  /*设置用户信息*/\n        this.updateUserInfo();\n        /*刷新用户信息*/\n        Socket.sendGetUserInfo(this._userId,this._openId);\n        /*定时刷新用户信息*/\n        this.schedule(function(){\n            Socket.sendGetUserInfo(this._userId,this._openId);\n        }.bind(this),10);//10s一次\n        Socket.sendGetHallInfo(this.socket.userInfo.id);\n        if (hall.lastHallInfo) {\n            this.updateBanner(hall.lastHallInfo.info);\n        }\n        cc.onShareWXResp = null;\n        cc.director.preloadScene('play',function(){\n            cc.director.preloadScene('login');\n        });\n        if(cc.joinDesk!=null){\n            if(!cc.joinDesk.result){\n                var reason = cc.joinDesk.reason;\n                this.alertMessage(reason);\n            }\n            cc.joinDesk = null;\n        }\n        if(cc.qingli != null){\n            this.alertMessage(\"您被房主请出房间\");\n            cc.qingli = null;\n        }\n        //var creatAnima = this.node.getChildByName(\"create_room\");\n    },\n\n    keyBackListen:function () {\n        var _this = this;\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(e) {\n            if(e.keyCode == cc.KEY.back) {\n                if(!KQNativeInvoke.isNativeIOS()){\n                    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"backToDesk\", \"()V\");\n                }\n            }\n        },this);\n    },\n\n    clickWxShare:function(){\n        if(!cc.sys.isNative){\n            this.wxshare.active = true;\n        }else{\n            var title = cc.sys.localStorage.getItem('shareTitle');\n            var description = cc.sys.localStorage.getItem('desc');\n            var recordId = cc.sys.localStorage.getItem('recordId');\n            var id= '';\n            if(recordId){\n                id = 'recordId='+recordId;\n            }\n\n            if (KQNativeInvoke.isNativeIOS()) {\n                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxShareFriend\",id, description,title);\n            }\n            else {//Android\n                var str = \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\";\n                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxShareFriend\", str,id, description,title);\n            }\n        }\n    },\n\n    //分享到朋友圈\n    shareHallTimeline:function(){\n        if(!cc.sys.isNative){\n            this.wxshare.active = true;\n        }else{\n            var title = cc.sys.localStorage.getItem('shareTitle');\n            var description = cc.sys.localStorage.getItem('desc');\n            var recordId = cc.sys.localStorage.getItem('recordId');\n            var id= '';\n            if(recordId){\n                id = 'recordId='+recordId;\n            }\n\n            if (KQNativeInvoke.isNativeIOS()) {\n                jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxShareHallTimeline\",id, description,title);\n            }\n            else {//Android\n                var str = \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\";\n                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxShareHallTimeline\", str,id, description,title);\n            }\n        }\n    },\n    \n    shareBg:function(){\n        if(!cc.sys.isNative){\n            this.wxshare.active = false;\n        }else{\n            // if (KQNativeInvoke.isNativeIOS()) {\n            //     jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"wxShareHallTimeline\",id, description,title);\n            // }\n            // else {//Android\n            //     var str = \"(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V\";\n            //     jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"wxShareHallTimeline\", str,id, description,title);\n            // }\n        }\n    },\n\n    clearLocalStorage: function () {\n        var shareTitle = '开房玩[大众十三水]';\n        var desc = '开好房了，就等你们一起来[大众十三水]啦！晚了位置就没了哟~'; \n        cc.sys.localStorage.removeItem('roomId');\n        cc.sys.localStorage.setItem('shareTitle',shareTitle);\n        cc.sys.localStorage.setItem('desc',desc);\n    },\n\n    onDestroy: function () {\n        this.socket.receviceMessage = function() {};\n        this.socket.connectionSuccess = function() {};\n        this.socket.connectionDisconnect = function() {};\n        this.socket.checkNetworkNow = function(){};\n        this.socket.checkNetworkEnd = function() {};\n        \n      KQGlobalEvent.offTarget(this);\n    },\n\n    _registerSocketEvent: function () {\n        KQGlobalEvent.on(Socket.Event.JoinDesk, this._jiinRoomSocketCallback, this);\n        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._jiinRoomSocketCallback, this);\n        KQGlobalEvent.on(Socket.Event.ReceiveCreateDesk, this._createRoomSocketCallback, this);\n        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);\n        KQGlobalEvent.on(Socket.Event.ReceiveGetUserInfo, this._socketReceiveUserInfo, this);\n        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);\n        //KQGlobalEvent.on(Socket.Event.ReceiveInviteCode, this._socketReceiveInviteCode, this);\n        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);\n        //KQGlobalEvent.on(Socket.Event.ReceiveSharePng, this._socketSharePng, this);\n    },\n\n\n    // 跳转到公众号\n    guanzhu:function(){\n        // var url = \"http://www.honggefeng.cn/gzh/index.html\";\n        // cc.sys.openURL(url)\n    },\n    _startBannerAnimation: function () {\n        var anim = this.labelBanner.getComponent(cc.Animation);\n        anim.play('banner');\n    },\n    downLoad:function(){\n        var url ='https://fir.im/5tne';\n        cc.sys.openURL(url);\n\n        //window.location.href = \"http://www.baidu.com\";\n        //console.log(\"？？？？？？？？\");\n    },\n\n    _initJoinRoom: function () {\n        var self = this;\n        let joinRoom = this.joinNode.getComponent('joinRoom');\n\n        joinRoom.callbackJoinRoom = function (number) {\n            // self.joinNode.getComponent('alert').dismissAction();\n            // self.showWaitingMessage('加入中...');\n            // self.scheduleOnce(function() {\n            //     self.hiddenWaitingMessage();\n            // }, 2.0);\n\n            /*加入房间请求*/\n            let userId = Socket.instance.userInfo.id;\n            Socket.sendJoinDesk(number, userId);\n        };\n    },\n\n\n    _jiinRoomSocketCallback: function (response) {\n        if(cc.isRoomViewShow){\n            return;\n        }\n        this.hiddenWaitingMessage();\n\n        if (response.result) {\n            if(cc.from == null) {\n                cc.from = {};\n            }\n            let joinRoom = this.joinNode.getComponent('joinRoom');\n\n            this.joinNode.getComponent('alert').setAlertCallbck(function () {\n                joinRoom.clickClear();\n            });\n            cc.from.ma = response.data.maPai;\n            cc.director.loadScene('play');\n        } else {\n            let reasonInfo = this._joinReasonMap(response.data.reason);\n            this.alertMessage(reasonInfo);\n        }\n    },\n\n    _socketReceiveHallInfo: function (response) {\n        if(cc.isRoomViewShow){\n            return;\n        }\n        if (!response.result) {\n            return;\n        }\n        let data = response.data;\n        hall.lastHallInfo = data;\n        let isIOS = data.isIOS;\n        let isAndroid = data.isA;\n        let vIOS = data.vIOS;\n        let vA = data.vA;\n        this.iosUrl = data.iosUrl;\n        this.aUrl = data.aUrl;\n        if(cc.sys.isNative){\n            if (KQNativeInvoke.isNativeIOS()) {\n                if(isIOS == 1){\n                    if(vIOS != '1.0.3' ){\n                        this.gengxin.active = true;\n                    }\n                }\n            }\n            else {//Android\n                if(isAndroid == 1){\n                    if(vA != '1.0.4' ){\n                        this.gengxin.active = true;\n                    }\n                }\n\n            }\n        }\n        let notice = data.broadcast;\n        let banner = data.info;\n        //this.updateNotice(notice);\n        this.updateBanner(banner);\n    },\n    downloadNewVersion:function () {\n        if (KQNativeInvoke.isNativeIOS()) {\n            cc.sys.openURL(this.iosUrl);\n            // jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, \"downloadNewVersion:\", this.iosUrl);\n        } else { //Android\n            cc.sys.openURL(this.aUrl);\n            // jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"downloadNewVersion\", \"(Ljava/lang/String;)V\", this.aUrl);\n        }\n    },\n    _createRoomSocketCallback: function (response) {\n        if(cc.isRoomViewShow){\n            return;\n        }\n        this.hiddenWaitingMessage();\n\n        if (response.result) {\n            cc.director.loadScene('play');\n        }\n        /*如果钻石不足，则提示*/\n        else {\n            this.alertMessage(\"您的钻石不足\");\n        }\n    },\n\n    _joinReasonMap: function (reason) {\n      let reasonInfo = {\n        notExist: \"房间不存在!\",\n        cardNumber: \"您房卡不足!\",\n      };\n\n      let info = reasonInfo[reason] || \"房间已满!\";\n      return info;\n    },\n\n    /*shop*/\n    shopAction:function() {\n        var comp = this.shopAlertNode.getComponent('alert');\n        comp.alert();\n    },\n    /*提示*/\n    alertMessage:function(msg) {\n        var node = cc.instantiate(this.alertPrefab);\n        this.node.addChild(node);\n        var comp = node.getComponent('alert');\n        comp.setMessage(msg);\n        comp.alert();\n    },\n\n    //updateNotice: function (notice) {\n    //    if(this.labelNotice == null){\n    //        return;\n    //    }\n    //  this.labelNotice.string = notice || \"\";\n    //},\n\n    updateBanner: function (banner = \"\") {\n        if(this.labelBanner == null){\n            return;\n        }\n      this.labelBanner.string = banner;\n    },\n\n\n    /*#####\n    * setting1 局数  (0 | 1 | 2 )\n    * setting2 人数  (0 | 1 | 2 | 3)\n    * setting3 玩法  (0 | 1 | 2 | 3 | 4)\n    * setting4 AA制收取房费  (0 | 1 | 2 )\n    * setting5 其他  (0)\n    * setting6  \n    * setting7\n    * */\n    createDoneAction:function() {\n        var info = {};\n        var self = this;\n        var key = ['setting1','setting2','setting4','setting5'];\n        for (var i = 0; i < this.tsSingleSelect.length; i++) {\n            var tsIndex = self.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;\n            info[key[i]] = tsIndex;\n        }\n        \n        info['setting3'] = this.selectMoShi.getComponent('selectMoShi')._select;\n        info['setting6'] = this.overTime.getComponent('overTime')._selected;\n        //console.log( info['setting6'] );\n        if( !info['setting3'][3] ){   // 玩法 [疯狂场,鬼牌,比花色,坐庄,马牌] info['setting3'][3]第三项表示坐庄模式，非坐庄模式的倍率是1倍\n            info['setting5'] = 0;     // 倍率 (0~1) == (1~3倍)\n        }\n        info['setting8'] = null;\n     \n        info['setting7'] = this.selectMoShi.getComponent('change_mapai')._cards;\n        cc.set = info;\n        info['userId'] = this.socket.userInfo.id;      //用户Id\n        this.socket.sendMessage('createDesk',info);\n\n        this.createNode.getComponent('alert').dismissAction();\n\n        //let self = this;\n        this.showWaitingMessage('创建中...');\n        this.scheduleOnce(function() {\n            self.hiddenWaitingMessage();\n        }, 2.0);\n    },\n\n    // 随机场\n    /*clickRandRoom: function () {\n      cc.director.loadScene('randRoom');\n    },*/\n\n    clickRecord: function () {\n        var comp = this.recordNode.getComponent('alert');\n        comp.alert();\n        Socket.sendGetRecrod(Socket.instance.userInfo.id);\n\n    },\n\n    clickPlayRule: function () {\n        //cc.director.loadScene('rule');\n        this.help = this.node.getChildByName(\"help\");\n        var comp = this.help.getComponent('alert');\n        comp.alert();\n    },\n\n    clickPlay: function () {\n        if(cc.clickOut) cc.director.loadScene('play');\n    },\n\n    /*切换账号*/\n    clickCancelLation:function () {\n        this.logoutNode.getComponent('alert').alert();\n    },\n\n    logoutAction: function() {\n        manager.setUserInfo('');\n        cc.director.loadScene('login');\n        hall.cacheImageInfo = null;\n    },\n\n    exitAction:function() {\n      manager.setUserInfo('');\n      if (!cc.sys.isNative) {\n        cc.director.loadScene('login');\n        hall.cacheImageInfo = null;\n        return;\n      }\n\n        if (KQNativeInvoke.isNativeIOS()) {\n            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName,\"exitApp\");\n        } else if (KQNativeInvoke.isNativeAndroid()) {//Android com.lling.qianjianglzg\n            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, \"exitApp\", \"()V\");\n        }\n        cc.director.end();\n\n    },\n\n    //接收处理用户数据\n    _socketReceiveUserInfo:function(response) {\n        if(cc.isRoomViewShow){\n            return;\n        }\n      if (!this.socket.userInfo) {\n        cc.error(\"this.socket.userInfo 为空!!!\");\n        return;\n      }\n      //console.log(response,\"----------------------用户信息\");\n      //this.phone.string = response.data.phone ? response.data.phone : \"无\";\n      this.setting.getComponent('Setting')._phone = response.data.phone?response.data.phone:null;\n      this.setting.getComponent('Setting').phone.string = response.data.phone?response.data.phone:'无';\n      this.nickNameLabel.string = response.data.nickname;   // 用户名\n      this.userIdLabel.string = 'ID: ' + response.data.id;  // ID\n      this.cardNumberLabel.string = response.data.cardNumber;\n      var sprite = this.avatarNode.getComponent(cc.Sprite);\n      cc.loader.load({url:response.data.avatarUrl,type:\"jpg\"}, function (err, tex) {\n          if (!err) {\n              var frame = new cc.SpriteFrame(tex);\n              sprite.spriteFrame=frame;\n          }\n      });\n    },\n\n    _socketDisconnect: function() {\n        this.showNetworkMessage(\"网络链接断开，重新连接中...\");\n    },\n\n    _socketConnected: function() {\n        this.hiddenNetworkMessage();\n    },\n\n    //更新用户信息\n    updateUserInfo:function() {\n        var info = this.socket.userInfo;\n        if (!info) {\n          cc.error(\"this.socket.userInfo 为空!!!\");\n          return;\n        }\n\n        this.nickNameLabel.string = info.nickname;\n        this.userIdLabel.string = 'ID: ' + info.id;\n        this.cardNumberLabel.string = info.cardNumber;\n\n        let avatarUrl = info.avatarUrl + \".jpg\";\n        var sprite = this.avatarNode.getComponent(cc.Sprite);\n        var texture = hall.cacheImageInfo[avatarUrl];\n        if (texture) {\n            let frame = new cc.SpriteFrame(texture);\n            if (frame) {\n                //cc.log(\"从缓存中加载头像\");\n                sprite.spriteFrame = frame;\n                return;\n            }\n        }\n\n        cc.loader.load({url:info.avatarUrl,type:\"jpg\"}, function (err, tex) {\n            if (!err) {\n                var frame = new cc.SpriteFrame(tex);\n                sprite.spriteFrame=frame;\n\n                hall.cacheImageInfo[avatarUrl] = tex;\n            }\n        });\n    },\n\n    /*提交意见*/\n    feedbackAcion:function () {\n      var userId = this.socket.userInfo.id;\n      var text = this.feedbackEditBox.string;\n      if (text.length > 0) {\n        this.feedbackNode.getComponent('alert').dismissAction();\n        Socket.sendFeedback(userId,text);\n        this.feedbackEditBox.string = '';\n      }\n    },\n\n    showWaitingMessage:function(msg) {\n      if (this.waitingNode != null && cc.sys.isNative && cc.sys.isObjectValid(this.waitingNode)) {\n          this.waitingNode.destory();\n          this.waitingNode = null;\n      }\n      this.waitingNode = cc.instantiate(this.waitingPrefab);\n      this.node.addChild(this.waitingNode);\n      var comp = this.waitingNode.getComponent('alert');\n      comp.setMessage(msg);\n      comp.alert();\n    },\n\n    hiddenWaitingMessage:function() {\n      if (this.waitingNode != null) {\n          this.waitingNode.getComponent('alert').dismissAction();\n      }\n    },\n\n    //network\n    showNetworkMessage:function(msg) {\n        if (this.networkNode && this.networkNode.active) {\n            let alert = this.networkNode.getComponent('alert');\n            if (alert.getMessage() == msg) {\n                return;\n            }\n        }\n\n        if (this.networkNode != null) {\n            var removeSelfAction = cc.removeSelf();\n            this.networkNode.runAction(removeSelfAction);\n            this.networkNode = null;\n        }\n        this.networkNode = cc.instantiate(this.waitingPrefab);\n        this.node.addChild(this.networkNode);\n        var comp = this.networkNode.getComponent('alert');\n        var self = this;\n        comp.onDismissComplete = function() {\n            self.networkNode = null;\n        };\n        comp.setMessage(msg);\n        comp.alert();\n    },\n\n    hiddenNetworkMessage:function() {\n        if (this.networkNode != null) {\n            this.networkNode.getComponent('alert').dismissAction();\n        }\n    },\n\n    //checkNode\n    showCheckMessage:function(msg) {\n        if (!(this.checkNode && this.checkNode.active)) {\n        } else {\n            let alert = this.checkNode.getComponent('alert');\n            if (alert.getMessage() == msg) {\n                return;\n            }\n        }\n        \n        if (this.checkNode != null) {\n            var removeSelfAction = cc.removeSelf();\n            this.checkNode.runAction(removeSelfAction);\n            this.checkNode = null;\n        }\n        this.checkNode = cc.instantiate(this.waitingPrefab);\n        this.node.addChild(this.checkNode);\n        var comp = this.checkNode.getComponent('alert');\n        var self = this;\n        comp.onDismissComplete = function() {\n            self.checkNode = null;\n        };\n        comp.setMessage(msg);\n        comp.alert();\n    },\n\n    hiddenCheckMessage:function() {\n        if (this.checkNode != null) {\n            this.checkNode.getComponent('alert').dismissAction();\n        }\n    },\n    onBtnClick: function() {\n        if(this._buttons.active) {\n            this._buttons.active = false;\n        }else{\n            this._buttons.active = true;\n        }\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\nmodule.exports = hall;\n"]}