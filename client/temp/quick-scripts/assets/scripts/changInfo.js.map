{"version":3,"sources":["changInfo.js"],"names":["Socket","require","KQGlobalEvent","cc","Class","extends","Component","properties","phoneEditBox","EditBox","wxEditBox","alert","Prefab","canvas","Node","_userId","onLoad","instance","userInfo","id","_registerSocketEvent","on","Event","ReceiveOnChangeInfo","_ReceiveChangeInfo","response","changedRows","data","msg","alertMsg","clickAction","wx","string","phone","info","test","length","sendChangeInfo","instantiate","addChild","comp","getComponent","setMessage"],"mappings":";;;;;;AAAA,IAAMA,SAASC,QAAQ,QAAR,CAAf;AACA,IAAMC,gBAAgBD,QAAQ,eAAR,CAAtB;;AAEAE,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,sBAAaL,GAAGM,OAXR;AAYRC,mBAAUP,GAAGM,OAZL;AAaRE,eAAMR,GAAGS,MAbD;AAcRC,gBAAOV,GAAGW,IAdF;AAeRC,iBAAQ;AAfA,KAHP;;AAqBL;AACAC,YAAQ,kBAAY;AAChB,aAAKD,OAAL,GAAef,OAAOiB,QAAP,CAAgBC,QAAhB,CAAyBC,EAAxC;AACA,aAAKC,oBAAL;AACH,KAzBI;;AA2BJA,0BAAsB,gCAAY;AAC/BlB,sBAAcmB,EAAd,CAAiBrB,OAAOsB,KAAP,CAAaC,mBAA9B,EAAmD,KAAKC,kBAAxD,EAA4E,IAA5E;AACH,KA7BI;AA8BLA,wBAAoB,4BAASC,QAAT,EAAkB;AAClC,YAAIC,cAAcD,SAASE,IAA3B;AACA,YAAIC,MAAM,EAAV;AACA;AACA;AACA;AACA,YAAGF,WAAH,EAAe;AACXE,kBAAM,MAAN;AACH,SAFD,MAEK;AACDA,kBAAM,iBAAN;AACH;AACD,aAAKC,QAAL,CAAcD,GAAd;AACH,KA1CI;AA2CLE,iBAAa,uBAAU;AACnB,YAAIC,KAAK,KAAKrB,SAAL,CAAesB,MAAxB;AACA,YAAIC,QAAQ,KAAKzB,YAAL,CAAkBwB,MAA9B;AACA,YAAIE,OAAO,EAAX;AACA,YAAIN,MAAM,EAAV;AACA,YAAG,CAACG,EAAD,IAAO,CAACE,KAAX,EAAiB;AACbL,kBAAM,YAAN;AACAK,oBAAQ,EAAR;AACA,iBAAKJ,QAAL,CAAcD,GAAd;AACA;AACH;AACD,YAAI,CAAE,eAAeO,IAAf,CAAoBF,KAApB,CAAN,EAAmC;AAC/BL,kBAAM,oBAAN;AACAK,oBAAQ,EAAR;AACA,iBAAKJ,QAAL,CAAcD,GAAd;AACA;AACH;AACD,YAAIK,MAAMG,MAAN,IAAe,EAAnB,EAAuB;AACnBR,kBAAM,qBAAN;AACAK,oBAAQ,EAAR;AACA,iBAAKJ,QAAL,CAAcD,GAAd;AACA;AACH;AACD,YAAG,CAAE,qBAAqBO,IAArB,CAA0BJ,EAA1B,CAAL,EAAqC;AACjCH,kBAAM,mBAAN;AACAG,iBAAK,EAAL;AACA,iBAAKF,QAAL,CAAcD,GAAd;AACA;AACH;AACD,YAAIG,GAAGK,MAAH,GAAU,CAAV,IAAeL,GAAGK,MAAH,GAAU,EAA7B,EAAiC;AAC7BR,kBAAM,4BAAN;AACAG,iBAAK,EAAL;AACA,iBAAKF,QAAL,CAAcD,GAAd;AACA;AACH;AACDM,aAAKH,EAAL,GAAUA,EAAV;AACAG,aAAKD,KAAL,GAAaA,KAAb;AACAjC,eAAOqC,cAAP,CAAsB,KAAKtB,OAA3B,EAAmCmB,IAAnC;AACH,KAjFI;;AAmFLL,cAAU,kBAASD,GAAT,EAAa;AACnB,YAAIjB,QAAQR,GAAGmC,WAAH,CAAe,KAAK3B,KAApB,CAAZ;AACA,aAAKE,MAAL,CAAY0B,QAAZ,CAAqB5B,KAArB;AACA,YAAI6B,OAAO7B,MAAM8B,YAAN,CAAmB,OAAnB,CAAX;AACAD,aAAKE,UAAL,CAAgBd,GAAhB;AACH;AAxFI,CAAT","file":"changInfo.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const Socket = require('socket');\r\nconst KQGlobalEvent = require('KQGlobalEvent');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        phoneEditBox:cc.EditBox,\r\n        wxEditBox:cc.EditBox,\r\n        alert:cc.Prefab,\r\n        canvas:cc.Node,\r\n        _userId:null,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._userId = Socket.instance.userInfo.id;\r\n        this._registerSocketEvent();\r\n    },\r\n\r\n     _registerSocketEvent: function () {\r\n        KQGlobalEvent.on(Socket.Event.ReceiveOnChangeInfo, this._ReceiveChangeInfo, this);\r\n    },\r\n    _ReceiveChangeInfo :function(response){\r\n        var changedRows = response.data;\r\n        var msg = '';\r\n        //console.log(response);\r\n        //console.log(changedRows);\r\n        //console.log(\"-------------------------------38\");\r\n        if(changedRows){\r\n            msg = \"更改成功\";\r\n        }else{\r\n            msg = \"今天已经更新过了，请明天再更新\";\r\n        }\r\n        this.alertMsg(msg);\r\n    },\r\n    clickAction :function(){\r\n        var wx = this.wxEditBox.string;\r\n        var phone = this.phoneEditBox.string;\r\n        var info = {};\r\n        var msg = '';\r\n        if(!wx && !phone){\r\n            msg = \"请填写微信号和手机号\";\r\n            phone = \"\";\r\n            this.alertMsg(msg);\r\n            return;\r\n        }\r\n        if( !(/(^[1-9]\\d*$)/.test(phone)) ){\r\n            msg = \"您输入的手机号码格式不对，请重新输入\";\r\n            phone = \"\";\r\n            this.alertMsg(msg);\r\n            return;\r\n        }\r\n        if( phone.length !=11 ){\r\n            msg = \"您输入的手机号码不够11位，请重新输入\";\r\n            phone = \"\";\r\n            this.alertMsg(msg);\r\n            return;\r\n        }\r\n        if(!(/(^[1-9a-zA-Z]\\d*$)/.test(wx)) ){\r\n            msg = \"您输入的微信号格式不对，请重新输入\";\r\n            wx = \"\";\r\n            this.alertMsg(msg);\r\n            return;\r\n        }\r\n        if( wx.length<6 || wx.length>20 ){\r\n            msg = \"您输入的微信号格式超出范围，请输入6~20位的微信号\";\r\n            wx = \"\";\r\n            this.alertMsg(msg);\r\n            return;\r\n        }\r\n        info.wx = wx;\r\n        info.phone = phone;\r\n        Socket.sendChangeInfo(this._userId,info);\r\n    },\r\n\r\n    alertMsg: function(msg){\r\n        var alert = cc.instantiate(this.alert);\r\n        this.canvas.addChild(alert);\r\n        let comp = alert.getComponent('alert');\r\n        comp.setMessage(msg);\r\n    },\r\n});\r\n"]}