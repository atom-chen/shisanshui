require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"ArrayExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4fd85NSsFJLd4qHrH0UjHzl', 'ArrayExtension');
// scripts\Extensions\ArrayExtension.js

'use strict';

// 给 Array 添加方法
// arr.find(...)
// arr.findIndex(...)
// arr.includes(e)
// arr.unique(equalFunction, isNewArray)
// Array.from
// Array.equal
// arr.isEqual(otherArray, isStrict)
// Array.sortByNumber
// arr.findSubArrayIndexs([])   用于查找数组内的部分元素的索引
// arr.translationWithStartIndex(startIndex) 将数组内的元素平移
// 如：[1, 2, 3, 4, 5].translationWithStartIndex(3) => [4,5,1,2,3]
// arr.kq_insert(index, e)   插入一个元素
// arr.kq_excludes(array)   // 除了array数组中的元素


module.exports = {};

if (!Array.prototype.find) {
  Array.prototype.find = function (predicate) {
    'use strict';

    if (this == null) {
      throw new TypeError('Array.prototype.find called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return value;
      }
    }
    return undefined;
  };
}

if (!Array.prototype.findIndex) {
  Array.prototype.findIndex = function (predicate) {
    if (this === null) {
      throw new TypeError('Array.prototype.findIndex called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return i;
      }
    }
    return -1;
  };
}

// https://tc39.github.io/ecma262/#sec-array.prototype.includes
if (!Array.prototype.includes) {
  Object.defineProperty(Array.prototype, 'includes', {
    enumerable: false,
    value: function value(searchElement, fromIndex) {

      // 1. Let O be ? ToObject(this value).
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let len be ? ToLength(? Get(O, "length")).
      var len = o.length >>> 0;

      // 3. If len is 0, return false.
      if (len === 0) {
        return false;
      }

      // 4. Let n be ? ToInteger(fromIndex).
      //    (If fromIndex is undefined, this step produces the value 0.)
      var n = fromIndex | 0;

      // 5. If n ≥ 0, then
      //  a. Let k be n.
      // 6. Else n < 0,
      //  a. Let k be len + n.
      //  b. If k < 0, let k be 0.
      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

      // 7. Repeat, while k < len
      while (k < len) {
        // a. Let elementK be the result of ? Get(O, ! ToString(k)).
        // b. If SameValueZero(searchElement, elementK) is true, return true.
        // c. Increase k by 1.
        // NOTE: === provides the correct "SameValueZero" comparison needed here.
        if (o[k] === searchElement) {
          return true;
        }
        k++;
      }

      // 8. Return false
      return false;
    }
  });
}

// unique
if (!Array.prototype.unique) {
  Object.defineProperty(Array.prototype, 'unique', {
    enumerable: false,
    value: function value(equalFunction) {
      var newArray = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      if (newArray) {
        return this._unqiue_new(equalFunction);
      }

      return this._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue_new', {
    enumerable: false,
    value: function value(equalFunction) {
      var array = Array.from(this);

      return array._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue', {
    enumerable: false,
    value: function value(equalFunction) {
      var len = this.length;
      var i = -1;

      while (i++ < len) {
        var j = i + 1;

        for (; j < this.length; ++j) {
          var isEqual = false;
          if (equalFunction) {
            isEqual = equalFunction(this[i], this[j]);
          } else {
            isEqual = this[i] === this[j];
          }

          if (isEqual) {
            this.splice(j--, 1);
          }
        }
      }
      return this;
    }
  });
}

// Production steps of ECMA-262, Edition 6, 22.1.2.1
// Reference: https://people.mozilla.org/~jorendorff/es6-draft.html#sec-array.from
if (!Array.from) {
  Array.from = function () {
    var toStr = Object.prototype.toString;
    var isCallable = function isCallable(fn) {
      return typeof fn === 'function' || toStr.call(fn) === '[object Function]';
    };
    var toInteger = function toInteger(value) {
      var number = Number(value);
      if (isNaN(number)) {
        return 0;
      }
      if (number === 0 || !isFinite(number)) {
        return number;
      }
      return (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));
    };
    var maxSafeInteger = Math.pow(2, 53) - 1;
    var toLength = function toLength(value) {
      var len = toInteger(value);
      return Math.min(Math.max(len, 0), maxSafeInteger);
    };

    // The length property of the from method is 1.
    return function from(arrayLike /*, mapFn, thisArg */) {
      // 1. Let C be the this value.
      var C = this;

      // 2. Let items be ToObject(arrayLike).
      var items = Object(arrayLike);

      // 3. ReturnIfAbrupt(items).
      if (arrayLike == null) {
        throw new TypeError("Array.from requires an array-like object - not null or undefined");
      }

      // 4. If mapfn is undefined, then let mapping be false.
      var mapFn = arguments.length > 1 ? arguments[1] : void undefined;
      var T;
      if (typeof mapFn !== 'undefined') {
        // 5. else
        // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.
        if (!isCallable(mapFn)) {
          throw new TypeError('Array.from: when provided, the second argument must be a function');
        }

        // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.
        if (arguments.length > 2) {
          T = arguments[2];
        }
      }

      // 10. Let lenValue be Get(items, "length").
      // 11. Let len be ToLength(lenValue).
      var len = toLength(items.length);

      // 13. If IsConstructor(C) is true, then
      // 13. a. Let A be the result of calling the [[Construct]] internal method of C with an argument list containing the single item len.
      // 14. a. Else, Let A be ArrayCreate(len).
      var A = isCallable(C) ? Object(new C(len)) : new Array(len);

      // 16. Let k be 0.
      var k = 0;
      // 17. Repeat, while k < len… (also steps a - h)
      var kValue;
      while (k < len) {
        kValue = items[k];
        if (mapFn) {
          A[k] = typeof T === 'undefined' ? mapFn(kValue, k) : mapFn.call(T, kValue, k);
        } else {
          A[k] = kValue;
        }
        k += 1;
      }
      // 18. Let putStatus be Put(A, "length", len, true).
      A.length = len;
      // 20. Return A.
      return A;
    };
  }();
}

if (!Array.equal) {
  Array.equal = function (arr1, arr2) {
    var strict = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

    if (arr1 === undefined || arr2 === undefined) {
      return false;
    }

    var length = arr1.length;
    if (length !== arr2.length) return false;
    for (var i = 0; i < length; i++) {
      if (strict) {
        if (arr1[i] !== arr2[i]) {
          return false;
        }
      } else {
        var value1 = arr1[i];
        var value2 = arr2[i];
        var result = true;
        if (Array.isArray(value1) && Array.isArray(value2)) {
          result = Array.equal(value1, value2, strict);
        } else {
          result = value1 == value2;
        }
      }
    }

    return true;
  };
}

if (!Array.prototype.isEqual) {
  Object.defineProperty(Array.prototype, 'isEqual', {
    enumerable: false,
    value: function value(otherArray) {
      var strict = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

      return Array.equal(this, otherArray, strict);
    }
  });
}

if (!Array.sortByNumber) {
  Array.sortByNumber = function (n1, n2) {
    var asc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;

    return (n1 - n2) * (asc ? 1 : -1);
  };
}

if (!Array.prototype.findSubArrayIndexs) {
  Object.defineProperty(Array.prototype, 'findSubArrayIndexs', {
    enumerable: false,
    value: function value(subArray, f) {
      var _this = this;

      var indexs = [];

      var _loop = function _loop() {
        var subValue = subArray[i];
        var findFunc = f || function (thisValue) {
          return subValue === thisValue;
        };
        var index = _this.findIndex(findFunc);
        if (index >= 0) {
          indexs.push(index);
        } else {
          indexs = [];
          return 'break';
        }
      };

      for (var i in subArray) {
        var _ret = _loop();

        if (_ret === 'break') break;
      }

      return indexs.length > 0 ? indexs : null;
    }
  });
}

if (!Array.prototype.translationWithStartIndex) {
  Object.defineProperty(Array.prototype, 'translationWithStartIndex', {
    enumerable: false,
    value: function value(startIndex) {
      if (startIndex == 0) {
        return this;
      }

      if (startIndex >= this.length) {
        return this;
      }

      var pre = this.slice(startIndex);
      var last = this.slice(0, startIndex);
      var result = pre.concat(last);

      return result;
    }
  });
}

if (!Array.prototype.kq_insert) {
  Object.defineProperty(Array.prototype, 'kq_insert', {
    enumerable: false,
    value: function value(index, e) {
      if (e == null) {
        return this;
      }

      if (index >= this.length) {
        this.push(e);
        return;
      }

      this.splice(index, 0, e);

      return this;
    }
  });
}

if (!Array.prototype.kq_excludes) {
  Object.defineProperty(Array.prototype, 'kq_excludes', {
    enumerable: false,
    value: function value(otherArray) {
      if (otherArray == null) {
        return this;
      }

      var result = [];
      this.forEach(function (element) {
        if (!otherArray.includes(element)) {
          result.push(element);
        }
      });

      return result;
    }
  });
}

cc._RFpop();
},{}],"AudioManager":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd5deKFuSZAC4Ky0zI4+z6O', 'AudioManager');
// scripts\Audio\AudioManager.js

var manager = require('manager');

var AudioManager = cc.Class({
    'extends': cc.Component,

    properties: {
        hall_bgm: {
            'default': null,
            url: cc.AudioClip
        },

        game_bgm: {
            'default': null,
            url: cc.AudioClip
        },

        compare_bgm: {
            'default': null,
            url: cc.AudioClip
        },

        // 打枪
        daQiang: {
            'default': null,
            url: cc.AudioClip
        },

        buttonClickSure: {
            'default': null,
            url: cc.AudioClip
        },

        fapai: {
            'default': null,
            url: cc.AudioClip
        },

        click_public: {
            'default': null,
            url: cc.AudioClip
        },
        click_cancel: {
            'default': null,
            url: cc.AudioClip
        },
        click_createRoom: {
            'default': null,
            url: cc.AudioClip
        },
        window: {
            'default': null,
            url: cc.AudioClip
        },
        click_weixin_login: {
            'default': null,
            url: cc.AudioClip
        },
        fangPai: {
            'default': null,
            url: cc.AudioClip
        }
    },

    statics: {
        instance: null
    },

    onLoad: function onLoad() {
        AudioManager.instance = this;
        this._registerAppActiveChange();

        this.soundOn = true;
        cc.game.addPersistRootNode(this.node);
        if (cc.game.isPersistRootNode(this.node)) {
            cc.log('添加全局节点成功');
        }
        this.mValue = manager.getMusicValue();
        this.mEValue = manager.getMusicEffectValue();
        this.bgAudioId = -1;
    },

    stopHallMusic: function stopHallMusic() {
        cc.audioEngine.stop(this.bgAudioId);
    },

    playMusic: function playMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            cc.log('play');
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
        //cc.audioEngine.playMusic( url, true )
    },

    /*playDeskMusic: function() {
        this.bgAudioId = cc.audioEngine.playMusic( this.game_bgm, true);
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId,this.mValue);
        }
    },*/

    playCompareCardsMusic: function playCompareCardsMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.compare_bgm, true);
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
    },

    playDaQiang: function playDaQiang() {
        for (var start = 0; start <= 1.6; start = start + 0.5) {
            this.scheduleOnce((function () {
                this._playSFX(this.daQiang);
            }).bind(this), start);
        }
    },

    // “打枪”
    playHumanDaQiang: function playHumanDaQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/" + (sex == 1 ? "man" : "woman");
        path = path + "/daqiang1.wav";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playPokerClick: function playPokerClick() {
        var url = cc.url.raw('resources/sounds/public/poker_click.wav');
        this._playSFX(url);
    },

    // 播放全垒打音效
    playHomeRun: function playHomeRun() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "special1.wav";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放发牌音效
    playFaPai: function playFaPai() {
        this._playSFX(this.fapai);
        for (var index = 0; index < 6; index++) {
            this.scheduleOnce((function () {
                this._playSFX(this.fapai);
            }).bind(this), index * 0.1);
        }
    },

    playCardType: function playCardType() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];
        var type = arguments.length <= 1 || arguments[1] === undefined ? -1 : arguments[1];

        // 只播放普通类型的语音
        if (type >= 10 || type < 0) {
            // 10 及以上是特殊牌
            var _path = this._soundsHumanPath(sex) + type + ".wav";
            var _url = cc.url.raw(_path);
            this._playSFX(_url);
            return;
        }

        var path = this._soundsHumanPath(sex) + "common" + (type + 1) + ".wav";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放 开始比牌
    playStartCompare: function playStartCompare() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "start_compare.wav";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playWin: function playWin() {
        var url = cc.url.raw('resources/sounds/openface/win.mp3');
        this._playSFX(url);
    },

    playLose: function playLose() {
        var url = cc.url.raw('resources/sounds/openface/lose.mp3');
        this._playSFX(url);
    },

    _soundsHumanPath: function _soundsHumanPath(sex) {
        var path = "resources/sounds/" + (sex == 1 ? "man" : "woman") + "/";
        return path;
    },

    setBgMusicVolumn: function setBgMusicVolumn(value) {
        this.mValue = value;
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, value);
        }
    },

    setEffectMusicVolum: function setEffectMusicVolum(value) {
        this.mEValue = value;
    },

    /*聊天*/
    playChatAudio: function playChatAudio(sex, str) {
        var index = this.chatTexts().indexOf(str);
        if (index === -1) {
            return;
        }

        var number = (sex == 1 ? 1000 : 2000) + index;
        var path = "resources/sounds/chat/" + number + ".wav";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    /*'很高兴和你们一起打牌！',
        '快点儿吧，我等得花儿都谢了~！',
        '急什么，让我想想怎么打！',
        '这牌真好，全垒打有希望啊！',
        '我是一个神枪手，打抢本领大！',
        '这把牌敢不敢再水一点啊！',
        '又输啦！大爷给条活路吧！',
        '你是妹妹 还是哥哥啊',
        '交个朋友吧。。',
        '我有事先走了，下次再玩吧！',
        '再见了 我会想念大家的，，',
        '怎么又断线了  网络怎么这么差啊，，'
    */
    chatTexts: function chatTexts() {
        return ['不要吵了，专心玩游戏吧！', '大家不要走，决战到天亮~！', '大家好，很高兴见到各位！', '各位不好意思，我离开一会！', '和你合作真是太愉快了！', '快点儿啊，都等得我花都谢了！', '你的牌打得太好了！', '你是妹妹 还是哥哥啊', '交个朋友吧。。', '我有事先走了，下次再玩吧！', '再见了 我会想念大家的，，', '怎么又断线了  网络怎么这么差啊，，'];
    },

    pauseMusic: function pauseMusic() {
        this.soundOn = false;
        cc.audioEngine.pauseMusic();
    },

    resumeMusic: function resumeMusic() {
        this.soundOn = true;
        cc.audioEngine.resumeMusic();
    },

    _playSFX: function _playSFX(clip) {
        if (this.soundOn) {
            var audioId = cc.audioEngine.playEffect(clip, false);
            cc.audioEngine.setVolume(audioId, this.mEValue);
            return audioId;
        }

        return null;
    },

    // MARK: 前后台操作
    _registerAppActiveChange: function _registerAppActiveChange() {
        cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
        cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
    },

    /**
      * 进入后台
      */
    _appEnterBackground: function _appEnterBackground() {
        var now = cc.sys.now();
        if (now - this._lastAppEnterBackgroundTime < 100) {
            return;
        }
        this._lastAppEnterBackgroundTime = now;

        this.pauseMusic();
    },

    /**
     * 进入前台 
     */
    _appBecomActive: function _appBecomActive() {
        var now = cc.sys.now();
        if (now - this._lastAppBecomActiveTime < 100) {
            return;
        }
        this._lastAppBecomActiveTime = now;

        this.resumeMusic();
    },

    /*确定按钮音效*/
    playBtnClickSFX: function playBtnClickSFX() {
        this._playSFX(this.buttonClickSure);
    },
    /*公共按钮，按键或者关闭按钮之类的音效*/
    palyBtnPublicSFX: function palyBtnPublicSFX() {
        this._playSFX(this.click_public);
    },

    /*取消按钮音效*/
    palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
        this._playSFX(this.click_cancel);
    },
    palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
        this._playSFX(this.click_createRoom);
    },
    palyWindowSFX: function palyWindowSFX() {
        this._playSFX(this.window);
    },
    palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyFangPaiSFX: function palyFangPaiSFX() {
        this._playSFX(this.fangPai);
    }
});

module.exports = AudioManager;

cc._RFpop();
},{"manager":"manager"}],"CardPrefab":[function(require,module,exports){
"use strict";
cc._RFpush(module, '94cdbrbPc9KRqx+1sHumWI3', 'CardPrefab');
// scripts\CardPrefab.js

'use strict';

var KQCard = require('KQCard');

cc.Class({
  extends: cc.Component,

  properties: {
    graySprite: cc.Sprite,

    _cardName: null,
    _kqCardMode: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.graySprite.node.active = false;
  },

  // 通过牌名设置牌
  setCard: function setCard(cardName) {
    this._setCardName(cardName);

    this._loadCardFrame(cardName, function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }.bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._kqCardMode;
  },

  _setCardName: function _setCardName(cardName) {
    this._cardName = cardName;
    this._kqCardMode = new KQCard(cardName);
  },

  // 设置选择状态
  setSelected: function setSelected() {
    var selected = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

    this.graySprite.node.active = selected;
  },

  isSelected: function isSelected() {
    return this.graySprite.node.active;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("images/pokerList/pockList", cc.SpriteAtlas, function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }.bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"CardTypeCombine":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45c41vwAhFNYYSXDvaKpEP0', 'CardTypeCombine');
// scripts\CardTypeCombine.js

var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var AudioManager = require('AudioManager');
var play = require('play');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
// 牌类型 component
//
cc.Class({
    'extends': cc.Component,
    statics: {
        instances: null
    },
    properties: {
        cardsLayout: cc.Layout,
        btnDuiZi: cc.Button,
        btnLiangDui: cc.Button,
        btnSanTiao: cc.Button,
        btnShunZi: cc.Button,
        btnTongHua: cc.Button,
        btnHuLu: cc.Button,
        btnTieZhi: cc.Button,
        btnTongHuaShun: cc.Button,
        btnWuTong: cc.Button,
        typeButtonsNode: cc.Node,
        btnDeleteTouDao: cc.Button, // 头道
        btnDeleteZhongDao: cc.Button, // 中道
        btnDeleteWeiDao: cc.Button, // 尾道
        btnCancelAll: cc.Button, // 全部取消
        btnDone: cc.Button, // 确定出牌
        timeNode: cc.Node,
        labelTime: cc.Label,
        layoutTouDao: cc.Layout,
        layoutZhongDao: cc.Layout,
        layoutWeiDao: cc.Layout,

        cardPrefab: cc.Prefab,
        cardTypePrefab: cc.Prefab,
        gongXiNi: cc.Node,
        teShuPai: cc.Node,
        /*#####*/
        wuTong_img: cc.SpriteFrame,
        tongHuaShun_img: cc.SpriteFrame,
        BtnClickGongXiNiComfirm: false, //用于检查用户是否点击了恭喜你页面的确定按钮
        cardsLayoutSortColor: false,
        /*#####*/

        _cardOffsetY: null,

        _kqCardModes: [],
        _allCardModes: [],
        _findCardTypeObject: null, // 用来记录找到的牌型对象

        _finishSelectCardsCallback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.BtnClickGongXiNiComfirm = false;
        this.cardsLayoutSortColor = false;
        this._cardOffsetY = 0;
        this._registerTouchEvents();
        this._registerDaosLayoutClickEvent();
        this.reset();
    },

    /*#####点击空白地方将牌收回去*/
    onClickCardTypeCombineNode: function onClickCardTypeCombineNode() {
        this._resetCardsPositionY();
    },

    _hideDeleteButtons: function _hideDeleteButtons() {
        this.btnDeleteTouDao.node.active = false;
        this.btnDeleteZhongDao.node.active = false;
        this.btnDeleteWeiDao.node.active = false;
    },

    // 重置，回到最初始有状态
    reset: function reset() {
        this._hideDeleteButtons();
        this.clearCards();
        this.timeStop();
        this._typeButtons().forEach(function (button) {
            button.interactable = false;
        });
        this._allCardModes = [];
    },

    cardsLayoutSort: function cardsLayoutSort(e) {
        cc.log(cc.maPai);
        var nodeAyy = e.target.children;
        if (nodeAyy[0].active == true) {
            //按大小
            this.cardsLayoutSortColor = true;
            nodeAyy[0].active = false;
            nodeAyy[1].active = true;
            this._resetCardsPositionX();
            return;
        } else if (nodeAyy[1].active == true) {
            //按花色
            this.cardsLayoutSortColor = false;
            nodeAyy[0].active = true;
            nodeAyy[1].active = false;
            this._resetCardsPositionX();
        }
        //this.cardsLayoutSortColor = nodeAyy[1].active == false;
        //this.cardsLayoutSortColor == true
    },

    addCards: function addCards(cardNames) {
        cc.assert(cardNames);
        this._resetCardsPositionY();
        //cardNames.sort(function(a1,a2){
        //    return a1.split('_')[0] - a2.split('_')[0];
        //})
        cardNames.forEach((function (card, index) {
            this.addCard(card, false, index);
        }).bind(this));
        //this.cardsLayoutSort();
        this._resetCardsPositionX();
        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels(this._kqCardModes);
    },

    addCard: function addCard(cardName) {
        var autoChangePositionX = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var index = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];

        cc.assert(cardName.length > 0);

        var cardPrefab = cc.instantiate(this.cardPrefab);
        cardPrefab.name = cardName;
        if (cc.maPai) {
            var cardMaPai = '3_' + cc.maPai;
            if (cardName == cardMaPai) {
                cardPrefab.color = new cc.Color(226, 145, 145);
            }
        }
        cardPrefab.getComponent('CardPrefab').setCard(cardName, index);
        this.cardsLayout.node.addChild(cardPrefab);
        cardPrefab.setPositionY(this._cardOffsetY);

        if (autoChangePositionX) {
            this._resetCardsPositionX();
        }
        //let newCard = new KQCard(cardName,null,index);
        //let originCard = this._allCardModes.find(function(card) {
        //    return card.isEqual(newCard);
        //});
        //if (originCard == null && !autoChangePositionX) {
        //    this._allCardModes.push(newCard);
        //}
    },

    addCardModes: function addCardModes(cardNames) {
        cc.assert(cardNames.length > 0);
        this._allCardModes = [];
        cardNames.forEach((function (cardName, index) {
            var newCard = new KQCard(cardName, null, index);
            this._allCardModes.push(newCard);
        }).bind(this));
    },

    reloadCards: function reloadCards(cardNames) {
        //cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //三度同花
        // cardNames=['2_13', '2_5', '2_7', '3_1', '3_2', '3_4', '3_3', '3_13', '1_12', '1_6', '1_1', '1_4', '1_5'];
        //三同花顺
        //  cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '4_1', '4_2', '4_3'];
        //一条龙
        // cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '1_11', '1_12', '1_13'];
        //三顺子
        //cardNames=['4_1', '3_2', '4_3', '1_7', '4_5', '4_6', '3_9', '4_8', '3_1', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_9', '3_9', '4_8', '3_10', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_5', '3_6', '4_8', '3_6', '1_13', '4_12', '4_11', '2_7'];
        //cardNames=['3_4', '3_4', '4_6', '2_20', '1_20', '1_20', '3_6', '4_8', '3_6', '1_8', '4_12', '4_11', '2_20'];
        //三丰天下
        //cardNames=['1_1', '2_1', '3_1', '1_2', '2_2', '3_2', '4_1', '4_2', '3_3', '2_3', '1_3', '4_3', '1_13'];
        //4丰天下
        // cardNames=['1_1', '2_1', '3_1', '1_4', '2_4', '3_2', '4_2', '1_2', '3_4', '2_3', '1_3', '4_3', '1_2'];
        //六岁半
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //cardNames=['1_9', '2_11', '3_8', '1_12', '2_2', '3_2', '1_13', '2_5', '3_5','1_4', '2_4', '3_4', '3_10'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //   cardNames=['4_2', '2_3', '3_4', '3_5', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //cardNames=['4_1', '2_1', '1_4', '3_4', '1_6', '2_6', '1_8', '3_8', '2_8','2_12', '1_12', '2_13', '3_13'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_8', '2_9', '2_10', '2_11', '2_13','3_13', '3_12', '2_12', '1_12'];
        // cardNames=['4_9', '2_9', '3_4', '3_6', '1_8', '2_1', '2_5', '2_4', '2_3','3_13', '3_12', '2_2', '1_12'];
        //cardNames=['3_2', '4_2', '2_4', '3_5', '1_5', '3_7', '2_7', '3_10', '2_1','2_13', '2_10', '2_12', '2_11'];
        //cardNames=['4_2', '4_3', '4_4', '4_5', '4_5', '4_6', '4_12', '4_13', '2_12','3_12', '2_8', '3_8', '2_11'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '3_5', '2_5', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '2_20', '1_20', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_10', '4_11', '4_13', '4_5', '2_20', '1_20', '1_20', '4_12', '3_12','4_12', '4_8', '2_12', '1_12'];
        this.clearCards();
        this._kqCardModes = [];
        this.addCards(cardNames);
    },

    clearCards: function clearCards() {
        this.cardsLayout.node.removeAllChildren();
        this.layoutTouDao.node.removeAllChildren();
        this.layoutZhongDao.node.removeAllChildren();
        this.layoutWeiDao.node.removeAllChildren();
    },

    removeCard: function removeCard(cardName) {
        if (!cardName.length) {
            return;
        }

        this.cardsLayout.node.getChildByName(cardName).removeFromParent();
    },

    setFinishSelectCardsCallback: function setFinishSelectCardsCallback(callback) {
        this._finishSelectCardsCallback = callback;
        this.node.active = false;
    },

    _reloadKQCardModesInner: function _reloadKQCardModesInner() {
        this._kqCardModes = this.cardsLayout.node.children.map(function (cardPrefabNode) {
            var cardPrefab = cardPrefabNode.getComponent('CardPrefab');
            return cardPrefab.cardMode();
        }).sort(KQCard.sort);
        this._findCardTypeObject = null;
    },

    _typeButtons: function _typeButtons() {
        return [this.btnDuiZi, this.btnLiangDui, this.btnSanTiao, this.btnShunZi, this.btnTongHua, this.btnHuLu, this.btnTieZhi, this.btnTongHuaShun];
    },

    /*#####*/
    //this.btnWuTong,
    /*#####*/
    _resetTypeButtonEnablesWithModels: function _resetTypeButtonEnablesWithModels(cardModes) {
        /*cardModes.length == 13*/
        cardModes = cardModes || this._kqCardModes;

        /*#####初始化牌*/
        var ButtonsLayoutChilds = this.typeButtonsNode.children;
        for (var i = 0; i < ButtonsLayoutChilds.length; i++) {
            ButtonsLayoutChilds[i].interactable = false;
        }

        this.btnDuiZi.interactable = KQCard.containDuiZi(cardModes);
        this.btnLiangDui.interactable = KQCard.containLiaDui(cardModes);
        this.btnSanTiao.interactable = KQCard.containSanTiao(cardModes);
        this.btnShunZi.interactable = KQCard.containShunZi(cardModes);
        this.btnTongHua.interactable = KQCard.containTongHua(cardModes);
        this.btnHuLu.interactable = KQCard.containHuLu(cardModes);
        this.btnTieZhi.interactable = KQCard.containTieZhi(cardModes);
        this.btnTongHuaShun.interactable = KQCard.containTongHuaShun(cardModes);
        //this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        //KQCard.isTeShuPai(cardModes)
        //let typeName = KQCard.cardsTypeName(cardModes);
        //KQCard.isLiuDuiBan(cardModes);
        //cc.log(typeName); cc.log('特殊牌name');
        //alert(this.btnShunZi.interactable)
        /*#####如果有多一色，就是设置无同按钮的可交互性*/
        //if(cc.duoYiSe == 0) {
        //    this.wuTongNode = this.typeButtonsNode.getChildByName("btnWuTong");
        //    this.btnWuTong = this.wuTongNode.getComponent(cc.Button);
        //    this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        //}
        /*#####*/

        this._autoActiveTypeButtons();

        /*#####设置按钮可交互和不可交互时的透明度*/
        for (var i = 0; i < ButtonsLayoutChilds.length; i++) {
            if (ButtonsLayoutChilds[i].getComponent(cc.Button).interactable) {
                ButtonsLayoutChilds[i].opacity = 255;
            } else {
                ButtonsLayoutChilds[i].opacity = 125;
            }
        }
    },

    // 将找到了牌类型的牌突出出来
    _stickOutFindCardType: function _stickOutFindCardType(title, findMethods) {

        // 先根据牌类型找出所有的索引集合
        var findedIndexsArray = null;
        this._findCardTypeObject = this._findCardTypeObject || {};
        if (this._findCardTypeObject.title != title) {
            findedIndexsArray = (findMethods() || []).reverse();

            for (var i = 0; i < findedIndexsArray.length - 1; i++) {
                //删除同类型牌
                var index = findedIndexsArray[i];
                /*if(title == 'liangDui'){
                 let jStringspoint = index.map(function(indexs){
                 return this._kqCardModes[indexs].point;
                 }.bind(this));
                 var isBreak = false;
                 var repNum = jStringspoint.reduce(function(p,n){
                 if(!p[n]){
                 p[n] = 1;
                 }else{
                 p[n] += 1
                 }
                 return p
                 },{});
                 for(var y in repNum){
                 if(repNum[y] >= 3){
                 isBreak = true;
                 }
                 }
                 if(isBreak){
                 cc.log(repNum)
                 cc.log(findedIndexsArray)
                 cc.log(i)
                 cc.log('--------291')
                 findedIndexsArray.splice(i,1);
                 continue;
                 }
                 }*/
                var iString = '';
                for (var j = i + 1; j < findedIndexsArray.length; j++) {
                    var s = findedIndexsArray[j];
                    var jString = '';

                    var iStrings = s.map((function (index) {
                        var cardModel = this._kqCardModes[index];
                        return cardModel.cardName();
                    }).bind(this));

                    var jStrings = index.map((function (indexs) {
                        var cardModel = this._kqCardModes[indexs];
                        return cardModel.cardName();
                    }).bind(this));

                    for (var r = 0; r < index.length; r++) {
                        jString = jString + iStrings[r];
                        iString = iString + jStrings[r];
                    }

                    if (jString == iString) {
                        findedIndexsArray.splice(i, 1);
                        break;
                    }
                }
            }

            this._findCardTypeObject = {
                title: title,
                indexsArray: findedIndexsArray,
                //index: title=="duiZi"?findedIndexsArray.length-1:0
                index: 0
            };
        }

        findedIndexsArray = this._findCardTypeObject.indexsArray;
        if (!findedIndexsArray || findedIndexsArray.length == 0) {
            return;
        }
        // 将已有的突出的牌的位置重置回初始位置
        this._resetCardsPositionY();

        // 计算出要突出的牌数组
        var index = this._findCardTypeObject.index;
        var indexs = findedIndexsArray[index];

        var selectedCardNames = indexs.map((function (index) {
            var cardModel = this._kqCardModes[index];
            return cardModel.cardName();
        }).bind(this));

        //cc.log(selectedCardNames)
        var cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
            var cardPrefab = cardNode.getComponent('CardPrefab');
            if (selectedCardNames.includes(cardPrefab.cardName())) {
                var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
                selectedCardNames.splice(nameIndex, 1);
                return true;
            }
            return false;
        });
        //cc.log(cardNodes)
        //cc.log(index)
        //cc.log(findedIndexsArray)
        //cc.log('----------248')
        // 突出计算出来的牌数组
        this._changeCardPrefabsY(cardNodes);
        // 保存好，用于再次点击了突出下一组牌
        index = (index + 1) % findedIndexsArray.length;
        this._findCardTypeObject.index = index;
    },

    clickDuiZi: function clickDuiZi() {
        this._stickOutFindCardType("duiZi", (function () {
            return KQCard.findDuiZi(this._kqCardModes);
        }).bind(this));
    },

    clickLiangDui: function clickLiangDui() {
        this._stickOutFindCardType("liangDui", (function () {
            return KQCard.findLiaDui(this._kqCardModes);
        }).bind(this));
    },

    clickSanTiao: function clickSanTiao() {
        this._stickOutFindCardType("sanTiao", (function () {
            return KQCard.findSanTiao(this._kqCardModes);
        }).bind(this));
    },

    clickShunZi: function clickShunZi() {
        this._stickOutFindCardType("shunZi", (function () {
            return KQCard.findShunZi(this._kqCardModes);
        }).bind(this));
    },

    clickTongHua: function clickTongHua() {
        this._stickOutFindCardType("tongHua", (function () {
            return KQCard.findTongHua(this._kqCardModes);
        }).bind(this));
    },

    clickHuLu: function clickHuLu() {
        this._stickOutFindCardType("huLu", (function () {
            return KQCard.findHuLu(this._kqCardModes);
        }).bind(this));
    },

    clickTieZhi: function clickTieZhi() {
        this._stickOutFindCardType("tieZhi", (function () {
            return KQCard.findTieZhi(this._kqCardModes);
        }).bind(this));
    },

    /*#####*/
    clickWuTong: function clickWuTong() {
        //console.log("点击了五同按钮");
        this._stickOutFindCardType("wuTong", (function () {
            return KQCard.findWuTong(this._kqCardModes);
        }).bind(this));
    },
    /*#####*/

    clickTongHuaShun: function clickTongHuaShun() {
        this._stickOutFindCardType("tongHuaShun", (function () {
            return KQCard.findTongHuaShun(this._kqCardModes);
        }).bind(this));
    },

    clickCancelAll: function clickCancelAll() {
        this.clickDeleteTouDao();
        this.clickDeleteZhongDao();
        this.clickDeleteWeiDao();
    },

    /*点击完成按钮*/
    clickDone: function clickDone() {
        var touCardModels = this._taoDaoCardModes();
        var zhongCardModes = this._zhongDaoCardModes();
        var weiCardModes = this._weiDaoCardModes();
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    /*点击恭喜你页面的确定按钮*/
    onBtnGongXiNiComfirmClick: function onBtnGongXiNiComfirmClick() {
        //记录玩家点击了确定按钮：
        this.BtnClickGongXiNiComfirm = true;
        //先要得到玩家的13张牌 teShuPaiCards[{'number':1,'suit':'s'},{...},{...}]
        var teShuPaiCards = cc.teShuPaiCards;
        console.log(teShuPaiCards);
        var teShuPaiCardsServerInfo = this._convertCardsToServerModel2(teShuPaiCards);
        var result = [teShuPaiCardsServerInfo];
        console.log("点击了恭喜你页面的确定按钮");
        console.log(teShuPaiCardsServerInfo);
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    _didSelectedCards: function _didSelectedCards(touCards, zhongCards, weiCards) {
        touCards = touCards || [];
        zhongCards = zhongCards || [];
        weiCards = weiCards || [];
        var touServerInfo = this._convertCardsToServerModel(touCards);
        var zhongServerInfo = this._convertCardsToServerModel(zhongCards);
        var weiServerInfo = this._convertCardsToServerModel(weiCards);
        var result = [touServerInfo, zhongServerInfo, weiServerInfo];

        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    clickDeleteTouDao: function clickDeleteTouDao() {
        this._deleteDaoCardsOfLayout(this.layoutTouDao.node);
    },

    clickDeleteZhongDao: function clickDeleteZhongDao() {
        this._deleteDaoCardsOfLayout(this.layoutZhongDao.node);
    },

    clickDeleteWeiDao: function clickDeleteWeiDao() {
        this._deleteDaoCardsOfLayout(this.layoutWeiDao.node);
    },

    // 计时器事件
    timeStart: function timeStart(duration) {
        cc.assert(duration > 0);
        this.timeStop();
        this.timeNode.active = true;

        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.schedule(this._timeMethod, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this._timeMethod);
        this.timeNode.active = false;
    },

    _timeMethod: function _timeMethod() {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            this._timeOutAutoSelectCards();
            return;
        }
    },

    // 超时后，自动选牌
    _timeOutAutoSelectCards: function _timeOutAutoSelectCards() {
        /**
         * 隐藏恭喜你
         */
        play.gongXiNiShow(false);
        if (typeof cc.teShuPaiCards != "undefined" && cc.teShuPaiCards != null && cc.teShuPaiCards != '') {
            this.onBtnGongXiNiComfirmClick();
            return;
        }

        var _cacleAutoSelectedCards2 = this._cacleAutoSelectedCards();

        var _cacleAutoSelectedCards22 = _slicedToArray(_cacleAutoSelectedCards2, 3);

        var touCardModels = _cacleAutoSelectedCards22[0];
        var zhongCardModes = _cacleAutoSelectedCards22[1];
        var weiCardModes = _cacleAutoSelectedCards22[2];

        if (touCardModels == null || zhongCardModes == null || weiCardModes == null) {
            touCardModels = this._allCardModes.slice(-3);
            zhongCardModes = this._allCardModes.slice(5, 10);
            weiCardModes = this._allCardModes.slice(0, 5);
        }

        cc.log(touCardModels);
        cc.log(zhongCardModes);
        cc.log(weiCardModes);
        cc.log(this._allCardModes);
        cc.log("自动选牌 touCardModels zhongCardModes weiCardModes：");
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    _cacleAutoSelectedCards: function _cacleAutoSelectedCards() {
        var cards = this._allCardModes.filter(function (i) {
            return i;
        });
        var resultCards = [];
        for (var i = 1; i < 3; i++) {
            var cardss = KQCard.autoSelectCards(cards, 5);
            cards = cards.kq_excludes(cardss);
            resultCards.push(cardss);
        }
        resultCards.push(cards);
        var touScore = KQCard.scoreOfCards(resultCards[2]);
        var zhongScore = KQCard.scoreOfCards(resultCards[1]);
        var weiScore = KQCard.scoreOfCards(resultCards[0]);
        cc.log(resultCards);
        cc.log(this._allCardModes);
        cc.log("牌分数自动选牌：", touScore, zhongScore, weiScore);
        //let weiCardModes = KQCard.autoSelectCards(cards, 5);
        //cards = cards.kq_excludes(weiCardModes);
        //
        //let zhongCardModes = KQCard.autoSelectCards(cards, 5);
        //
        //let touCardModes = cards.kq_excludes(zhongCardModes);
        //if (touCardModes.length == 3 && zhongCardModes.length == 5 && weiCardModes.length == 5) {
        //    return [touCardModes, zhongCardModes, weiCardModes];
        //}
        if (resultCards[2].length == 3 && resultCards[1].length == 5 && resultCards[0].length == 5) {
            return [resultCards[2], resultCards[1], resultCards[0]];
        }

        return [];
    },

    _convertCardsToServerModel: function _convertCardsToServerModel(cards) {
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = KQCard.scoreOfCards(cards);
        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {
            // 特殊牌
            result.isContainExtra = this._isContainExtraCardsType(result.type, cards);
            //result.isContainExtra = true;
            result.cards = cards;
        } else {
            result.cards = KQCard.convertToServerCards(cards);
        }
        return result;
    },

    /*#####*/
    _convertCardsToServerModel2: function _convertCardsToServerModel2(cards) {
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = KQCard.scoreOfCards2(cards);
        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {
            // 特殊牌
            result.isContainExtra = true;
            result.cards = cards;
        }

        return result;
    },
    /*#####*/
    // 特殊牌里是否还含有特殊牌
    // 包含的情况有：
    // 三桃花 可能含有同花顺
    // 三顺子 可能含有同花顺
    // 六对半 可能含有铁支
    _isContainExtraCardsType: function _isContainExtraCardsType(type, cards) {
        if (type == KQCard.TYPE.SanTaoHua) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.SanShunZi) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.LiuDuiBan) {
            return KQCard.containTieZhi(cards);
        }
        return false;
    },

    // 触摸事件
    _registerTouchEvents: function _registerTouchEvents() {
        this.cardsLayout.node.on(cc.Node.EventType.TOUCH_START, this._touchCardLayout.bind(this));
        this.cardsLayout.node.on(cc.Node.EventType.TOUCH_MOVE, this._touchCardLayout.bind(this));
        this.cardsLayout.node.on(cc.Node.EventType.TOUCH_END, this._touchCardLayoutEnd.bind(this));
        this.cardsLayout.node.on(cc.Node.EventType.TOUCH_CANCEL, this._touchCardLayoutEnd.bind(this));
    },

    _touchCardLayout: function _touchCardLayout(event) {
        event.bubbles = true;
        var location = event.getLocation();
        var cardPrefab = this._cardPrefabInCardLayoutWithLocation(location);
        if (cardPrefab) {
            cardPrefab.getComponent('CardPrefab').setSelected(true);
            event.stopPropagation();
        }
    },

    _touchCardLayoutEnd: function _touchCardLayoutEnd(event) {
        this._changeSelectedCardPrefabsY();
        this._diseclectCardPrefabs();
    },

    _cardPrefabInCardLayoutWithLocation: function _cardPrefabInCardLayoutWithLocation(location) {
        location = this.cardsLayout.node.convertToNodeSpaceAR(location);
        var cardNodes = this.cardsLayout.node.children.sort(function (cardNode1, cardNode2) {
            var rect1 = cardNode1.getBoundingBox();
            var rect2 = cardNode2.getBoundingBox();
            return rect2.x - rect1.x;
        });
        for (var index in cardNodes) {
            var cardNode = cardNodes[index];

            var rect = cardNode.getBoundingBox();

            if (cc.rectContainsPoint(rect, location)) {
                return cardNode;
            }
        }

        return null;
    },

    _changeSelectedCardPrefabsY: function _changeSelectedCardPrefabsY() {
        var cardNodes = this._selectedCardPrefabs();
        this._changeCardPrefabsY(cardNodes);

        AudioManager.instance.playPokerClick();
    },

    _changeCardPrefabsY: function _changeCardPrefabsY(cardNodes) {
        cardNodes.forEach((function (cardNode) {
            var y = cardNode.getPositionY();
            if (y == this._cardOffsetY) {
                cardNode.setPositionY(this._cardOffsetY + 55);
            } else {
                cardNode.setPositionY(this._cardOffsetY);
            }
        }).bind(this));
    },

    _selectedCardPrefabs: function _selectedCardPrefabs() {
        var includeStickOut = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

        var cardNodes = this.cardsLayout.node.children || [];
        return cardNodes.filter(function (cardNode) {
            var cardPrefab = cardNode.getComponent('CardPrefab');
            var isSelected = cardPrefab.isSelected();
            if (!isSelected && includeStickOut) {
                isSelected = cardNode.getPositionY() > 10;
            }

            return isSelected;
        });
    },

    _diseclectCardPrefabs: function _diseclectCardPrefabs() {
        var cardNodes = this.cardsLayout.node.children;
        cardNodes.forEach(function (node) {
            node.getComponent('CardPrefab').setSelected(false);
        });
    },

    // 重置 cards 的 X
    _resetCardsPositionX: function _resetCardsPositionX() {
        //let interval = 98;
        var interval = 78;
        var cardNodes = this.cardsLayout.node.children || [];
        var length = cardNodes.length;
        if (length == 0) {
            return;
        }

        var middleIndex = length / 2;
        var cardWidth = 154;

        //this.cardsLayoutSort();
        if (this.cardsLayoutSortColor == true) {
            this.cardsLayout.node.children.sort(function (n1, n2) {
                var component1 = n1.getComponent('CardPrefab');
                var component2 = n2.getComponent('CardPrefab');
                return component2.cardMode().color - component1.cardMode().color;
            });
        } else {
            this.cardsLayout.node.children.sort(function (n1, n2) {
                var component1 = n1.getComponent('CardPrefab');
                var component2 = n2.getComponent('CardPrefab');
                return component1.cardMode().sort(component2.cardMode());
            });
        }
        //cardNodes.sort(function (n1, n2) {
        //    let component1 = n1.getComponent('CardPrefab');
        //    let component2 = n2.getComponent('CardPrefab');
        //
        //    return component1.cardMode().sort(component2.cardMode());
        //});

        cardNodes.forEach(function (cardNode, index) {
            cardNode.zIndex = index;
            var x = (index - middleIndex) * interval + cardWidth / 3;
            cardNode.setPositionX(x);
        });
    },

    // 重置 cards 的 X为0
    resetCardsPositionX1: function resetCardsPositionX1() {
        var cardNodes = this.cardsLayout.node.children || [];
        var length = cardNodes.length;
        if (length == 0) {
            return;
        }
        cardNodes.forEach(function (cardNode) {
            cardNode.setPositionY(0);
        });
    },

    _resetCardsPositionY: function _resetCardsPositionY() {
        var cardNodes = this.cardsLayout.node.children || [];
        cardNodes.forEach((function (cardNode) {
            cardNode.setPositionY(this._cardOffsetY);
        }).bind(this));
    },

    // 头、中、尾道 layout 的点击事件
    _registerDaosLayoutClickEvent: function _registerDaosLayoutClickEvent() {
        var layoutTouDao = this.layoutTouDao;
        var layoutZhongDao = this.layoutZhongDao;
        var layoutWeiDao = this.layoutWeiDao;
        var self = this;
        //头道点击
        this.layoutTouDao.node.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickTouDaoLayout(event);
            /*#####点击第二道剩下的牌自动选上去##### begin*/
            //如果剩下的牌小于5张
            if (this.cardsLayout.node.children.length <= 5) {
                //如果尾道填满，把它放入中道
                if (layoutZhongDao.node.children.length < 5 && layoutWeiDao.node.children.length == 5) {
                    // 突出计算出来的牌数组
                    var cardNodes = this.cardsLayout.node.children;
                    self._changeCardPrefabsY(cardNodes);
                    self._addDaoCardToLayout(layoutZhongDao.node);
                }
                //如果中道填满，把它放入尾道
                else if (layoutWeiDao.node.children.length < 5 && layoutZhongDao.node.children.length == 5) {
                        var cardNodes = this.cardsLayout.node.children;
                        self._changeCardPrefabsY(cardNodes);
                        self._addDaoCardToLayout(layoutWeiDao.node);
                    }
            }
            /*#####end*/
        }).bind(this));
        //中道点击
        this.layoutZhongDao.node.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickZhongDaoLayout(event);
            /*#####begin*/
            //中道必须填满才来执行
            if (layoutZhongDao.node.children.length == 5) {
                //如果剩下的牌小于等于5张
                if (this.cardsLayout.node.children.length <= 5) {
                    //如果尾道填满，把它放入头道
                    if (layoutTouDao.node.children.length < 3 && layoutWeiDao.node.children.length == 5) {
                        // 突出计算出来的牌数组
                        var cardNodes = this.cardsLayout.node.children;
                        self._changeCardPrefabsY(cardNodes);
                        self._addDaoCardToLayout(layoutTouDao.node);
                    }
                    //如果头道填满，把它放入尾道
                    else if (layoutWeiDao.node.children.length < 5 && layoutTouDao.node.children.length == 3) {
                            var cardNodes = this.cardsLayout.node.children;
                            self._changeCardPrefabsY(cardNodes);
                            self._addDaoCardToLayout(layoutWeiDao.node);
                        }
                }
            }

            /*#####end*/
        }).bind(this));
        //尾道点击
        this.layoutWeiDao.node.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickWeiDaoLayout(event);
            /*#####begin*/
            //尾道必须填满才来执行
            if (layoutWeiDao.node.children.length == 5) {
                //如果剩下的牌小于等于5张
                if (this.cardsLayout.node.children.length <= 5) {
                    //如果中道填满，把它放入头道
                    if (layoutTouDao.node.children.length < 3 && layoutZhongDao.node.children.length == 5) {
                        // 突出计算出来的牌数组
                        var cardNodes = this.cardsLayout.node.children;
                        self._changeCardPrefabsY(cardNodes);
                        self._addDaoCardToLayout(layoutTouDao.node);
                    }
                    //如果头道填满，把它放入中道
                    else if (layoutZhongDao.node.children.length < 5 && layoutTouDao.node.children.length == 3) {
                            var cardNodes = this.cardsLayout.node.children;
                            self._changeCardPrefabsY(cardNodes);
                            self._addDaoCardToLayout(layoutZhongDao.node);
                        }
                }
            }

            /*#####end*/
        }).bind(this));
    },

    _clickTouDaoLayout: function _clickTouDaoLayout(event) {
        var clickCard = this._daoCardNodeInLayoutWithEvent(this.layoutTouDao.node, event);
        if (clickCard) {
            this._deleteDaoCard(clickCard, true);
            return;
        }
        this._addDaoCardToLayout(this.layoutTouDao.node, 3);
    },

    _clickZhongDaoLayout: function _clickZhongDaoLayout(event) {
        var clickCard = this._daoCardNodeInLayoutWithEvent(this.layoutZhongDao.node, event);
        if (clickCard) {
            this._deleteDaoCard(clickCard, true);
            return;
        }

        this._addDaoCardToLayout(this.layoutZhongDao.node);
    },

    _clickWeiDaoLayout: function _clickWeiDaoLayout(event) {
        var clickCard = this._daoCardNodeInLayoutWithEvent(this.layoutWeiDao.node, event);
        if (clickCard) {
            this._deleteDaoCard(clickCard, true);
            return;
        }
        this._addDaoCardToLayout(this.layoutWeiDao.node);
    },

    _daoCardNodeInLayoutWithEvent: function _daoCardNodeInLayoutWithEvent(node, event) {
        var cardNodes = node.children || [];
        var location = event.getLocation();
        location = node.convertToNodeSpaceAR(location);
        for (var index in cardNodes) {
            var cardNode = cardNodes[index];
            var rect = cardNode.getBoundingBox();
            if (cc.rectContainsPoint(rect, location)) {
                return cardNode;
            }
        }

        return null;
    },

    _addDaoCardToLayout: function _addDaoCardToLayout(node) {
        var maxNumberCard = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

        var cardNodes = node.children || [];
        if (cardNodes.length >= 5) {
            return;
        }

        var remainCount = maxNumberCard - cardNodes.length;
        var selectedCards = this._selectedCardPrefabs(true) || [];
        if (selectedCards.length == 0) {
            return;
        }

        if (selectedCards.length > remainCount) {
            selectedCards = selectedCards.slice(0, remainCount);
        }

        var selectedCardNames = selectedCards.map(function (cardPrefab) {
            return cardPrefab.getComponent('CardPrefab').cardName();
        });

        cardNodes.forEach(function (cardTypeNode) {
            selectedCardNames.push(cardTypeNode.getComponent('CardTypeSprite').cardName());
        });

        var cardModes = selectedCardNames.map(function (cardName, index) {
            return new KQCard(cardName, null, index);
        }).sort(function (c1, c2) {
            return KQCard.sort(c1, c2, false);
        });

        var touCardModes = node == this.layoutTouDao.node ? cardModes : this._taoDaoCardModes();
        var zhongCardModes = node == this.layoutZhongDao.node ? cardModes : this._zhongDaoCardModes();
        var weiCardModes = node == this.layoutWeiDao.node ? cardModes : this._weiDaoCardModes();
        if (!this._isValidCardModes(touCardModes, zhongCardModes, weiCardModes)) {
            return;
        }

        node.removeAllChildren();

        cardModes.forEach((function (cardMode) {
            var cardName = cardMode.cardName();
            var cardTypeSprite = cc.instantiate(this.cardTypePrefab);
            if (cc.maPai) {
                var cardMaPai = '3_' + cc.maPai;
                if (cardName == cardMaPai) {
                    cardTypeSprite.color = new cc.Color(226, 145, 145);
                }
            }
            cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName);
            node.addChild(cardTypeSprite);
        }).bind(this));

        selectedCards.forEach(function (node) {
            node.removeFromParent();
        });
        this._resetCardsPositionY();
        this._resetCardsPositionX();

        this._autoActiveDeleteDaoButtons();

        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels();
    },

    // 删除 头、中或尾道中的某中牌
    _deleteDaoCard: function _deleteDaoCard(cardTypeNode) {
        var reloadTypeButtonEnables = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];

        var cardName = cardTypeNode.getComponent('CardTypeSprite').cardName();
        this.addCard(cardName, true);

        this._resetCardsPositionY();

        cardTypeNode.removeFromParent(true);
        this._autoActiveDeleteDaoButtons();

        if (reloadTypeButtonEnables) {
            this._reloadKQCardModesInner();
            this._resetTypeButtonEnablesWithModels();
        }
    },

    // 删除 头道或中道或尾道上所有的 牌
    _deleteDaoCardsOfLayout: function _deleteDaoCardsOfLayout(daoLayout) {
        var cardNodes = Array.from(daoLayout.children);
        cardNodes.forEach(this._deleteDaoCard.bind(this));

        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels();
    },

    // 判断能否使用选择中的牌
    // 即：头道要小于中道、中道要小于尾道
    _isValidCardModes: function _isValidCardModes(touCardModes, zhongCardModes, weiCardModes) {
        touCardModes = touCardModes || [];
        zhongCardModes = zhongCardModes || [];
        weiCardModes = weiCardModes || [];
        cc.log(touCardModes.length, zhongCardModes.length, weiCardModes.length);
        if (touCardModes.length < 3 || zhongCardModes.length < 5 || weiCardModes.length < 5) {
            return true;
        }

        var touScore = KQCard.scoreOfCards(touCardModes);
        var zhongScore = KQCard.scoreOfCards(zhongCardModes);
        var weiScore = KQCard.scoreOfCards(weiCardModes);
        cc.log("牌分数：", touScore, zhongScore, weiScore);
        return touScore < zhongScore && zhongScore <= weiScore;
    },

    // 头道上已有的牌
    _taoDaoCardModes: function _taoDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.layoutTouDao.node.children);
    },

    // 中道上已有的牌
    _zhongDaoCardModes: function _zhongDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.layoutZhongDao.node.children);
    },

    // 尾道上已有的牌
    _weiDaoCardModes: function _weiDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.layoutWeiDao.node.children);
    },

    _cardModesOfCardPrefabs: function _cardModesOfCardPrefabs(cardTypeNodes) {
        if (!cardTypeNodes) {
            return [];
        }

        var cardModes = cardTypeNodes.map(function (node) {
            var component = node.getComponent('CardTypeSprite');
            return component.cardMode();
        });

        return cardModes || [];
    },

    // 自动设置 头、中、尾道的删除按钮的可见性
    _autoActiveDeleteDaoButtons: function _autoActiveDeleteDaoButtons() {
        this._autoActiveDeleteDaoButton(this.layoutTouDao.node, this.btnDeleteTouDao.node);
        this._autoActiveDeleteDaoButton(this.layoutZhongDao.node, this.btnDeleteZhongDao.node);
        this._autoActiveDeleteDaoButton(this.layoutWeiDao.node, this.btnDeleteWeiDao.node);
    },

    _autoActiveDeleteDaoButton: function _autoActiveDeleteDaoButton(layout, button) {
        button.active = layout.children.length > 0;
    },

    // 自动设置 “全部取消”、“确定出牌”、“类型选择”按钮的可见性
    _autoActiveTypeButtons: function _autoActiveTypeButtons() {
        var cardNodes = this.cardsLayout.node.children || [];
        var hasCardUnSelected = cardNodes.length > 0;
        this.btnDone.node.active = !hasCardUnSelected;
        this.btnCancelAll.node.active = this.btnDone.node.active;
        this.typeButtonsNode.active = hasCardUnSelected;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardScoretsHelper":"KQCardScoretsHelper","play":"play"}],"CardTypeSprite":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e614c0FMndAtrOMcy8/PcZw', 'CardTypeSprite');
// scripts\CardTypeSprite.js

'use strict';

var KQCard = require('KQCard');
cc.Class({
  extends: cc.Component,

  properties: {
    _cardName: null,
    _cardModel: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setCard: function setCard(cardName) {
    this._cardName = cardName;
    this._cardModel = new KQCard(cardName);
    this._loadCardFrame(cardName, function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }.bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._cardModel;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("images/pokerList/pockList", cc.SpriteAtlas, function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }.bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"ChatMessage":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dc8980X2ZVNKrH9BsIsSE4D', 'ChatMessage');
// scripts\Chat\ChatMessage.js

"use strict";

// 用于在游戏过程中，展示用户的聊天消息

var ChatMessage = cc.Class({
  extends: cc.Component,

  properties: {
    richText: cc.RichText,
    spriteBackground: cc.Sprite
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setString: function setString() {
    var string = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
    var autoHide = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

    if (string.length == 0) {
      return;
    }

    this.node.active = true;

    var maxWidth = 300;
    var realStr = ChatMessage.parseString(string);

    // 由于 cc.RichText 在指定 maxWidth 后，该结点的 width 会一直
    // 是 maxWidth 值。而在将 maxWidth 指定为0时，其 contentSize.width 会
    // 是内容的真正所需的宽度
    //
    // 所以这里先将 maxWidth 设为 0，获取其实际内容 width 后再调整
    this.richText.maxWidth = 0;
    this.richText.string = realStr;

    var contentWidth = this.richText.node.getContentSize().width;
    if (contentWidth > maxWidth) {
      this.richText.maxWidth = maxWidth;
      this.richText.string = realStr;
      contentWidth = maxWidth;
    }

    this.node.width = contentWidth + 28;
    this.node.height = this.richText.node.getContentSize().height + 20;

    this.spriteBackground.node.width = this.node.width;
    this.spriteBackground.node.height = this.node.height;

    if (autoHide) {
      this.unscheduleAllCallbacks();
      this.scheduleOnce(this._hideNode.bind(this), 3);
    }
  },

  _hideNode: function _hideNode() {
    this.node.active = false;
  }

});

// 将 <bq10> 改为： <img src='bg10'/>
ChatMessage.parseString = function (str) {
  var result = str.replace(/<bq\d{1,2}>/g, function (match) {
    var bq = match.replace("<", " <img src='").replace(">", "'/> ");
    return bq;
  });

  return result;
}, module.exports = ChatMessage;

cc._RFpop();
},{}],"ChatTextRecord":[function(require,module,exports){
"use strict";
cc._RFpush(module, '88d10U9tIpHNK1entoUH0Ju', 'ChatTextRecord');
// scripts\Pefabs\ChatTextRecord.js

'use strict';

cc.Class({
  extends: cc.Component,

  properties: {},

  // use this for initialization
  onLoad: function onLoad() {},

  setString: function setString(str) {
    this._richText().string = str;
  },

  _richText: function _richText() {
    return this.node.getComponent('cc.RichText');
  }

});

cc._RFpop();
},{}],"CompareCards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9aa4aH/Ha1JfaEeY5nFj5P1', 'CompareCards');
// scripts\Pefabs\CompareCards.js

var KQCardResHelper = require('KQCardResHelper');
var AudioManager = require('AudioManager');
var KQCard = require('KQCard');

cc.Class({
    'extends': cc.Component,

    properties: {
        touLayout: cc.Layout,
        zhongLayout: cc.Layout,
        weiLayout: cc.Layout,
        labelTouScore: cc.Label,
        labelTouScoreRight: cc.Label,
        labelZhongScore: cc.Label,
        labelZhongScoreRight: cc.Label,
        labelWeiScore: cc.Label,
        labelWeiScoreRight: cc.Label,

        touScroeTitle: cc.Node, //头道字
        zhongScroeTitle: cc.Node, //中道字
        weiScroeTitle: cc.Node, //尾道字

        scoreStyle: 0, // 0 表示分数在左边  1 表示分数在右边 2不显示分数
        _daoLayouts: null, // 头、中、尾集合
        _labelScores: null,
        _scores: null,

        teShuLayout: cc.Layout,
        labelTeShuPaiTitle: cc.Label,
        pNum: 0, //玩家人数
        teShuTime: 0, //特殊牌出牌顺序
        teShuNum: 0, //特殊牌人数
        // [{
        //     'cards':[{'suit':suit,'number':number},{}],//特殊牌不用传
        //     'type':0,
        //     'value':4,
        //     'isContainExtra':true,//is Special 特殊牌传
        //    },
        //    {
        //     'cards':[{'suit':suit,'number':number},{}],
        //     'type':0,
        //     'value':4
        //   }]
        _user: null, // 用于比牌的数据
        _cardsInfo: null,
        _compareIndex: 0 },

    // 将要比较的 索引  0~2
    // use this for initialization
    onLoad: function onLoad() {
        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._labelScores = [[this.labelTouScore, this.labelTouScoreRight], [this.labelZhongScore, this.labelZhongScoreRight], [this.labelWeiScore, this.labelWeiScoreRight]];
        this.reset();

        if (this._scores) {
            this.setScores(this._scores);
        }
    },

    reset: function reset() {
        this._compareIndex = 0;
        this.teShuLayout.node.active = false;
        this.labelTeShuPaiTitle.string = '';
        this.node.children.forEach(function (node) {
            node.active = false;
        });
    },

    _setCardsToLayout: function _setCardsToLayout(layout, cards) {
        var node = layout.node;
        node.children.forEach(function (spriteNode, index) {
            var sprite = spriteNode.getComponent('cc.Sprite');
            var card = cards[index];
            if (!card) {
                return;
            }
            KQCardResHelper.setCardSpriteFrame(sprite, card.cardName());
            spriteNode.color = new cc.Color(255, 255, 255);
            if (cc.maPai) {
                var cardMaPai = '3_' + cc.maPai;
                if (card.cardName() == cardMaPai) {
                    spriteNode.color = new cc.Color(226, 145, 145);
                }
            }
        });
    },

    setCompareData: function setCompareData(user) {
        this._user = user;
        this._cardsInfo = user.cardInfo;
        var cardsInfo = user.cardInfo;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        //特殊牌
        this.teShuLayout.node.active = false;
        this.labelTeShuPaiTitle.string = '';
        this.pNum = user.playerNum; //玩家人数
        this.teShuTime = user.teShuTime; //特殊牌出牌顺序人数
        this.teShuNum = user.TeShuNum; //特殊牌人数
        var scores = [user.score1 || 0, user.score2 || 0, user.score3 || 0];
        this.setCards(cards);
        this.setScores(scores);
    },

    // 下一个要比较的分数
    // 如果没有要比较的了，则返回 0
    nextCompareScore: function nextCompareScore() {
        if (!this._user) {
            return 0;
        }

        var data = this._cardsInfo[this._compareIndex];
        if (!data) {
            return 0;
        }

        return data.value;
    },

    setTeShuCards: function setTeShuCards(cards, cardsNames) {
        cards.forEach(function (card) {
            if (card.point == 14) {
                card.point = 1;
            }
        });
        var time = (this.pNum - this.teShuNum) * 3 + this.teShuTime; //3 是3道牌的时间
        var typeName = KQCard.cardsTypeName(cardsNames);
        if (typeName == "三同花") {
            cards.sort(KQCard.sortByColor);
        } else {
            cards.sort(KQCard.sortByPoint);
        }
        this.scheduleOnce(function () {
            this.teShuLayout.node.active = true;
            this._setCardsToLayout(this.teShuLayout, cards);
            this.labelTeShuPaiTitle.string = typeName;
            AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[0].type);
        }, time);
    },
    _convertCardsToCardNames: function _convertCardsToCardNames(cards) {
        // [{"suit":"s","number":10}]
        var suitColorMap = ['', 'd', 'c', 'h', 's'];
        return cards.map(function (card) {
            var cardNumber = card.point;
            var color = suitColorMap[card.color];
            var number = Math.max(Math.min(cardNumber, 13), 1);
            return { number: number, suit: color };
        });
    },
    setCards: function setCards(cards) {

        // 不会再有特殊牌了
        this.teShuLayout.node.active = false;

        if (this._user.isContainExtra == true) {
            var cardsNames = this._convertCardsToCardNames(cards);
            if (KQCard.isTeShuPai(cardsNames) && cc.moshi != 1) {
                this.setTeShuCards(cards, cardsNames);
                return;
            }
        }

        var cardSprites = this._allCardSprites();
        cards.forEach(function (kqCard, index) {
            if (index >= cardSprites.length) {
                return;
            }

            var cardSprite = cardSprites[index];

            KQCardResHelper.loadCardSpriteFrame(kqCard.cardName(), function (spriteFrame) {
                cardSprite.spriteFrame = spriteFrame;
                cardSprite.node.color = new cc.Color(255, 255, 255);
                if (cc.maPai) {
                    var cardMaPai = 'public-pic-card-poker-3_' + cc.maPai;
                    if (spriteFrame.name == cardMaPai) {
                        cardSprite.node.color = new cc.Color(226, 145, 145);
                    }
                }
            });
        });
    },

    setScores: function setScores(scores) {
        if (this._labelScores == null) {
            this._scores = scores;
            return;
        }

        var scoreStrings = scores.map(function (score) {
            score = Number(score);
            var result = score > 0 ? "+ " + score : "- " + score * -1;
            return result;
        });

        scoreStrings.forEach((function (string, index) {
            var labels = this._labelScores[index];
            labels.forEach(function (label) {
                label.string = string;
            });
        }).bind(this));
    },

    showTouCards: function showTouCards() {
        if (this._user.isContainExtra == true) {
            return;
        }
        this.touLayout.node.active = true;
        if (this.scoreStyle == 1) {
            this.labelTouScoreRight.node.active = true;
        } else if (this.scoreStyle == 0) {
            this.labelTouScore.node.active = true;
            if (this.touScroeTitle) {
                this.touScroeTitle.active = true;
            }
        }
        var types = this._cardsInfo[this._compareIndex].type == 3 ? 333 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showZhongCards: function showZhongCards() {
        if (this._user.isContainExtra == true) {
            return;
        }
        this.zhongLayout.node.active = true;
        if (this.scoreStyle == 1) {
            this.labelZhongScoreRight.node.active = true;
        } else if (this.scoreStyle == 0) {
            this.labelZhongScore.node.active = true;
            if (this.zhongScroeTitle) {
                this.zhongScroeTitle.active = true;
            }
        }
        var types = this._cardsInfo[this._compareIndex].type == 6 ? 555 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showWeiCards: function showWeiCards() {
        if (this._user.isContainExtra == true) {
            return;
        }
        this.weiLayout.node.active = true;
        if (this.scoreStyle == 1) {
            this.labelWeiScoreRight.node.active = true;
        } else if (this.scoreStyle == 0) {
            this.labelWeiScore.node.active = true;
            if (this.weiScroeTitle) {
                this.weiScroeTitle.active = true;
            }
        }

        AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[this._compareIndex].type);
        this._compareIndex += 1;
    },

    showNextCards: function showNextCards() {
        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        var layout = this._daoLayouts.find(function (layout) {
            return !layout.node.active;
        });

        if (layout == this.touLayout) {
            this.showTouCards();
        } else if (layout == this.zhongLayout) {
            this.showZhongCards();
        } else if (layout == this.weiLayout) {
            this.showWeiCards();
        }
    },

    _clearCards: function _clearCards() {
        this._clearLayoutCards(this.touLayout);
        this._clearLayoutCards(this.zhongLayout);
        this._clearLayoutCards(this.weiLayout);
    },

    _clearLayoutCards: function _clearLayoutCards(layout) {
        this._cardSpritesWithLayout(layout).forEach(function (sprite) {
            sprite.spriteFrame = null;
        });
    },

    _cardSpritesWithLayout: function _cardSpritesWithLayout(layout) {
        var node = layout.node;
        return node.children.map(function (node) {
            return node.getComponent('cc.Sprite');
        });
    },

    _allCardSprites: function _allCardSprites() {
        var touCardSprites = this._cardSpritesWithLayout(this.touLayout);
        var zhongCardSprites = this._cardSpritesWithLayout(this.zhongLayout);
        var weiCardSprites = this._cardSpritesWithLayout(this.weiLayout);
        var result = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        return result;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper"}],"Countdown":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6406dyBk8tKVrlJ1+mg7cLt', 'Countdown');
// scripts\Pefabs\Countdown.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {
        labelTime: cc.Label,

        _callback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.labelTime.string = "0";
    },

    /**
     * 开始倒计时
     * 
     * @param  {Number} time 时长
     * @param  {Function} callback 倒计时的回调
     */
    startCountdown: function startCountdown(time, callback) {
        this.stop();
        this._callback = callback;

        this.node.active = true;
        this.labelTime.string = "" + time;
        this.schedule(this._countDown, 1, time);
    },

    stop: function stop() {
        this.unschedule(this._countDown);
        this.node.active = false;

        if (this._callback) {
            var isTimeout = Number(this.labelTime.string) <= 0;
            var callback = this._callback;
            this._callback = null;
            callback(isTimeout);
        }

        this._callback = null;
    },

    _countDown: function _countDown() {
        var time = Number(this.labelTime.string || "0");
        time = time - 1;

        if (time <= 0) {
            this.stop();
        }

        this.labelTime.string = String(time);
    }

});

cc._RFpop();
},{}],1:[function(require,module,exports){
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function placeHoldersCount (b64) {
  var len = b64.length
  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // the number of equal signs (place holders)
  // if there are two placeholders, than the two characters before it
  // represent one byte
  // if there is only one, then the three characters before it represent 2 bytes
  // this is just a cheap hack to not do indexOf twice
  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0
}

function byteLength (b64) {
  // base64 is 4/3 + up to two characters of the original data
  return b64.length * 3 / 4 - placeHoldersCount(b64)
}

function toByteArray (b64) {
  var i, j, l, tmp, placeHolders, arr
  var len = b64.length
  placeHolders = placeHoldersCount(b64)

  arr = new Arr(len * 3 / 4 - placeHolders)

  // if there are placeholders, only get up to the last complete 4 chars
  l = placeHolders > 0 ? len - 4 : len

  var L = 0

  for (i = 0, j = 0; i < l; i += 4, j += 3) {
    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]
    arr[L++] = (tmp >> 16) & 0xFF
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  if (placeHolders === 2) {
    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[L++] = tmp & 0xFF
  } else if (placeHolders === 1) {
    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var output = ''
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    output += lookup[tmp >> 2]
    output += lookup[(tmp << 4) & 0x3F]
    output += '=='
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])
    output += lookup[tmp >> 10]
    output += lookup[(tmp >> 4) & 0x3F]
    output += lookup[(tmp << 2) & 0x3F]
    output += '='
  }

  parts.push(output)

  return parts.join('')
}

},{}],2:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":1,"ieee754":3,"isarray":4}],3:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],4:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],"GameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6a3cdd+2shGlZ+jeI3trSsB', 'GameResult');
// scripts\Play\GameResult.js

var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

var ResultStatus = {
  WIN: 2,
  DRAW: 1,
  LOSE: 0
};

var GameResult = cc.Class({
  'extends': cc.Component,

  properties: {
    winNode: cc.Node,
    loseNode: cc.Node,
    drawNode: cc.Node,
    contentNode: cc.Node,

    resultItems: [cc.Node],

    _deskInfo: null,
    _userId: null,
    _closeCallback: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._hideResultItems();
  },

  showResults: function showResults(deskInfo, currentUserId) {
    this._deskInfo = deskInfo;
    this._userId = currentUserId;

    var resultStatus = this._resultStatus();
    this.contentNode.active = true;
    this.winNode.active = resultStatus == ResultStatus.WIN;
    this.drawNode.active = resultStatus == ResultStatus.DRAW;
    this.loseNode.active = resultStatus == ResultStatus.LOSE;

    if (this.winNode.active) {
      AudioManager.instance.playWin();
    } else if (this.loseNode.active) {
      AudioManager.instance.playLose();
    }

    this.node.getComponent('alert').alert();
    this.node.getComponent('alert').setDismissCallback((function () {
      this._closeCallback;
    }).bind(this));

    var playerInfos = deskInfo.players.sort(function (p1, p2) {
      return p2.cScore - p1.cScore;
    });
    var itemComps = this.resultItems.map(function (node) {
      return node.getComponent('ResultItem');
    });
    itemComps.forEach((function (itemComp, index) {
      itemComp.node.active = index < playerInfos.length;
      if (!itemComp.node.active) {
        return;
      }

      var user = playerInfos[index];
      itemComp.updateWithPlayerInfo(user, deskInfo.isRandomDesk);
      var cards = this._cardsFromUser(user);
      itemComp.setCards(cards);
    }).bind(this));
  },

  setCloseCallback: function setCloseCallback(callback) {
    this._closeCallback = callback;
  },

  _cardsFromUser: function _cardsFromUser(user) {
    var cards = user.cardInfo.map(function (cardInfoItem) {
      return KQCard.cardsFromArray(cardInfoItem.cards);
    }).reduce(function (array, subCards) {
      return array.concat(subCards);
    }, []);

    return cards;
  },

  _hideResultItems: function _hideResultItems() {
    this.resultItems.forEach(function (node) {
      node.acitve = false;
    });
  },

  _resultStatus: function _resultStatus() {
    var playerInfos = this._deskInfo.players;
    var user = playerInfos.find((function (user) {
      return user.id == this._userId;
    }).bind(this));

    var score = user.cScore;
    if (this._deskInfo.isRandomDesk) {
      // 如果是随机场的话，应该用钻石来判断输赢
      score = user.diamond;
    }

    if (score > 0) {
      return ResultStatus.WIN;
    } else if (score < 0) {
      return ResultStatus.LOSE;
    }

    return ResultStatus.DRAW;
  }
});

module.exports = GameResult;

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard"}],"GetCardPointsSameCount":[function(require,module,exports){
"use strict";
cc._RFpush(module, '64665arSbVGtqTVZeISv/TD', 'GetCardPointsSameCount');
// scripts\KQCard\GetCardPointsSameCount.js

/*#####*/
//��������һ���������ڵ���ͬ�������Ƶ�����
var GetCardPointsSameCount = function GetCardPointsSameCount(cards) {
    this.cardNumbers = {};
    for (var i in cards) {
        var s;
        if (typeof cards[i].number == 'undefined') {
            s = cards[i].point;
        } else {
            s = cards[i].number;
        }
        if (this.cardNumbers[s]) {
            this.cardNumbers[s]++;
        } else {
            this.cardNumbers[s] = 1;
        }
        //cc.log(this.cardNumbers[cards[i].number])
        //cc.log(cards)
        //cc.log(cards[i].number)
        //cc.log('---7')
    }
    return this.cardNumbers;
};

module.exports = GetCardPointsSameCount;

cc._RFpop();
},{}],"Invit":[function(require,module,exports){
"use strict";
cc._RFpush(module, '37d962bf0NPxaQIYUcZDwR3', 'Invit');
// scripts\Invit.js

var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }
    var isComplete = this._lastEmptyLabel() == null;
    var inviteNumber = this._roomNumber();
    if (inviteNumber.length == 6) {
      this.callbackJoinRoom = inviteNumber;
    }
  },

  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackJoinRoom;
    console.log(inviteNumber, "------------------------");
    if (inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackJoinRoom = ''; //清空邀请码
    }
  },

  clickClear: function clickClear() {
    this.callbackJoinRoom = '';
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"KQCardColorsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf1deKQQ4NMMYVV+7xEr9Jf', 'KQCardColorsHelper');
// scripts\KQCard\KQCardColorsHelper.js

"use strict";

// 牌花色帮助类
// 用于计算一个牌数组的花色相同的牌的张数
var KQCardColorsHelper = function KQCardColorsHelper(cards) {
  this.colorNumber = {};

  cards.forEach(function (card) {
    var color = card.color;
    var number = this.colorNumber[color] || 0;
    this.colorNumber[color] = number + 1;
  }.bind(this));
};

// 相同花色的牌的最大数量
KQCardColorsHelper.prototype.maxNumber = function () {
  var result = 0;
  for (var prop in this.colorNumber) {
    var number = this.colorNumber[prop];
    result = Math.max(number, result);
  }

  return result;
};

module.exports = KQCardColorsHelper;

cc._RFpop();
},{}],"KQCardFindTypeExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '54a95JOLVRACIP91XEFodqF', 'KQCardFindTypeExtension');
// scripts\KQCard\KQCardFindTypeExtension.js

var KQCard = require('KQCard');
var ArrayExtension = require('ArrayExtension');
var KQCardPointsHelper = require('KQCardPointsHelper');

module.exports = {};

// 寻找 cardModes 中的 对子
// 这会返回 对子 的索引数组
// 如：[[1, 3], [4, 5]]
KQCard.findDuiZi = function (cardModes) {
  var sDuiZiIndexs = KQCard.findSanTiao(cardModes) || [];
  var result = KQCard._findPointLength(cardModes, 2) || [];
  if (result.length < 2) {
    if (sDuiZiIndexs.length > 0) {
      sDuiZiIndexs.forEach(function (indexs) {
        var s1 = [indexs[0], indexs[1]];
        //var s2 = [indexs[1],indexs[2]];
        //result.push(s2);
        result.push(s1);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 2);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }

  result = KQCard.repeat(result);

  return result.length > 0 ? result : [];
};

KQCard._findPointLength = function (cardModes, length) {
  if (cardModes.length < length) {
    return [];
  }

  var obj = cardModes.reduce(function (obj, card, index) {
    var pointIndexs = obj[card.point] || [];
    obj[card.point] = pointIndexs;
    pointIndexs.push(index);
    return obj;
  }, {});

  var result = [];
  for (var prop in obj) {
    var pointIndexs = obj[prop];
    if (pointIndexs.length == length) {
      pointIndexs.sort(function (n1, n2) {
        return n1 - n2;
      });
      result.push(pointIndexs);
    }
  }

  result.sort(function (arr1, arr2) {
    var n1 = arr1[0];
    var n2 = arr2[0];
    return n2 - n1;
  });
  return result.length > 0 ? result : [];
};

// 找 两对 的索引数组
// 如：[[1, 2, 3, 4], [5, 6, 7, 8]]
KQCard.findLiaDui = function (cardModes) {
  var duiZiIndexs = KQCard.findDuiZi(cardModes) || [];
  var duiZiIndex = KQCard.findGuiPai(cardModes, 2) || [];

  if (duiZiIndexs.length < 1 && duiZiIndex.length > 0) {
    duiZiIndex.forEach(function (indexs) {
      duiZiIndexs.unshift(indexs);
    });
  }
  if (duiZiIndexs.length < 2) {
    return [];
  }

  var result = [];
  for (var i = 0; i < duiZiIndexs.length; ++i) {
    for (var j = i + 1; j < duiZiIndexs.length; ++j) {
      if (result.length < 10) {
        var pre = duiZiIndexs[i];
        var next = duiZiIndexs[j];
        var s = pre.concat(next);
        var newS = [];
        for (var q = 0; q < s.length; q++) {
          if (newS.indexOf(s[q]) == -1) {
            newS.push(s[q]);
          } else {
            break;
          }
        }
        if (newS.length == 4) {
          newS.sort(function (n1, n2) {
            return n1 - n2;
          });
          result.unshift(newS);
        }
      } else {
        break;
      }
    }
  }
  result = KQCard.repeat(result);
  if (result.length > 6) {
    result = result.slice(0, 6);
  }
  return result;
};

// 找三条
// 如：[[1, 2, 3]];
KQCard.findSanTiao = function (cardModes) {
  if (cardModes.length < 3) {
    return [];
  }
  var result = KQCard._findPointLength(cardModes, 3) || [];
  //for(var q =0;q<result.length;q++){
  //  var indexs = result[q][0];
  //  if(cardModes[indexs].point >= 20){
  //    result.splice(q,1);
  //  }
  //}
  if (result.length < 2) {
    var tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray.length > 0) {
      tieZhiIndexsArray.forEach(function (indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        var sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 3);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }
  /*if(result.length < 1){
    // 铁支是包含三条的
    let tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray) {
      tieZhiIndexsArray.forEach(function(indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        let sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
  }*/

  //if(result.length > 10){
  //  result = result.slice(0,10);
  //}

  result = KQCard.repeat(result);
  return result.length > 0 ? result : [];
};

// 找同花顺
KQCard.findTongHuaShun = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  var result = [];
  var sanShunZi = KQCard.sanShunZi1(cardModes, length);
  if (sanShunZi[0] == null) {
    return false;
  }
  for (var i = 0; i < sanShunZi[0].length; i++) {
    var s = sanShunZi[0][i];
    if (KQCard.isTongHuaShun(s, length)) {
      result.push(sanShunZi[1][i]);
    }
  }
  if (result.length > 0) {
    return result;
  } else {
    return KQCard.findTongHuaShun1(cardModes);
  }
};
KQCard.findTongHuaShun1 = function (cards) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cards.length < length) {
    return [];
  }
  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= 5) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var start = 0; start + 5 <= s.length; ++start) {
      var subCards = s.slice(start, start + 5);
      if (KQCard.isTongHuaShun(subCards)) {
        (function () {
          var indexs = [];
          subCards.forEach(function (ca) {
            for (var q = 0; q < cards.length; q++) {
              var r = cards[q];
              if (r === ca) {
                indexs.push(q);
                break;
              }
            }
          });
          indexs.sort(Array.sortByPoint);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
      cards.forEach(function (adfs) {
        if (adfs.point == 14) {
          adfs.point = 1;
          adfs.scores = 1;
        }
      });
      return KQCard.findTongHuaShun20(cards);
    }
    return KQCard.findTongHuaShun1(convertedCards);
  }
  //return result.length > 0 ? result : null;
};
KQCard.findTongHuaShun20 = function (card) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (card.length < length) {
    return false;
  }
  var card20 = KQCard.contain20(card) || [];
  var cards = card.kq_excludes(card20);

  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= parseInt(5 - card20.length)) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  cc.log(colorSum);

  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var j = 1; j <= card20.length; ++j) {
      var num = 5 - j;
      for (var start = 0; start + num <= s.length; ++start) {
        var subCards = s.slice(start, start + num);
        var bool = parseInt(subCards[num - 1]['scores']) - parseInt(subCards[0]['scores']) < 5;
        if (bool) {
          var newCard20;

          (function () {
            var indexs = [];
            newCard20 = card20.slice(0, j);

            subCards = subCards.concat(newCard20);
            subCards.forEach(function (ca) {
              for (var q = 0; q < card.length; q++) {
                var r = card[q];
                if (r === ca) {
                  indexs.push(q);
                  break;
                }
              }
            });
            indexs.sort(Array.sortByNumber);

            result.unshift(indexs);
          })();
        }
      }
    }
  }
  cc.log(result);
  cc.log('--------357');
  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
      return [];
    }
    return KQCard.findTongHuaShun20(convertedCards);
  }
  //return result.length > 0 ? result : null;
};

// 找铁支
// 如：[[1,2,3,4]]
KQCard.findTieZhi = function (cardModes) {
  var result = KQCard._findPointLength(cardModes, 4);
  if (result.length > 0) {
    return result;
  }
  result = [];
  // 五同是包含铁支的
  var wuTongIndexsArray = KQCard.findWuTong(cardModes);
  if (wuTongIndexsArray) {
    wuTongIndexsArray.forEach(function (indexs) {
      var tieZhiIndexs0 = [indexs[0], indexs[1], indexs[2], indexs[3]];
      var tieZhiIndexs1 = [indexs[0], indexs[1], indexs[2], indexs[4]];
      var tieZhiIndexs2 = [indexs[0], indexs[1], indexs[3], indexs[4]];
      var tieZhiIndexs3 = [indexs[0], indexs[2], indexs[3], indexs[4]];
      var tieZhiIndexs4 = [indexs[1], indexs[2], indexs[3], indexs[4]];
      result.push(tieZhiIndexs0);
      result.push(tieZhiIndexs1);
      result.push(tieZhiIndexs2);
      result.push(tieZhiIndexs3);
      result.push(tieZhiIndexs4);
    });
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result);
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 4);
};
//找五同
KQCard.findWuTong = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var result = this._findPointLength(cardModes, 5) || [];
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 5);
};
// 找顺子
// 如：[[1, 2, 3, 4, 5]]
KQCard.findShunZi = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  if (typeof cardModes[0]['point'] == "undefined") {
    cardModes = KQCard.cardsFromArray(cardModes);
  }
  // 先根据点数去重
  var uniqueCards = cardModes.unique(function (card1, card2) {
    return card1.point == card2.point;
  });
  uniqueCards.sort(KQCard.sortByPoint);

  // 如果有 A，则在最后添加 14
  var cardA = cardModes.find(function (card) {
    return card.point == 1;
  });
  if (cardA) {
    var cardAPlus = new KQCard(cardA);
    cardAPlus.point = 14;
    uniqueCards.push(cardAPlus);
  }

  var result = [];

  // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
  for (var start = 0; start + length <= uniqueCards.length; ++start) {
    var subCards = uniqueCards.slice(start, start + length);
    if (KQCard.isShunZi(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {

            if (card.point == 14) {
              return originCard.point == 1;
            }

            return card === originCard;
          });
          indexs.push(index);
        });

        indexs.sort(Array.sortByNumber);
        result.push(indexs);
      })();
    }
  }

  // 处理点数重复的情况
  // 比如 A A K Q J 10 这种
  var repeatIndexsArray = KQCard._findRepeatPointIndexsArray(result, cardModes);
  repeatIndexsArray.forEach(function (indexs) {
    result.push(indexs);
  });

  result.sort(function (arr1, arr2) {
    return arr1[0] - arr2[0];
  });

  return result.length > 0 ? result : KQCard.findShunZi20(cardModes);
};
KQCard.findShunZi20 = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return false;
  }
  var card20 = KQCard.contain20(cardModes);
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  var newArr = [];
  var newArrs = [];
  for (var i = 0; i < cards.length; i++) {
    if (newArrs.indexOf(cards[i]['point']) == -1) {
      newArr.push(cards[i]);
      newArrs.push(cards[i].point);
    }
  }

  newArr.sort(function (n1, n2) {
    return n1.point - n2.point;
  });
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = length - j;
    for (var start = 0; start + num <= newArr.length; ++start) {
      var subCards = newArr.slice(start, start + num);
      var bool = parseInt(subCards[num - 1]['point']) - parseInt(subCards[0]['point']) < length;
      if (bool) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cardModes);
    if (cardModes === convertedCards) {
      return false;
    }
    return KQCard.findShunZi20(convertedCards);
  }
};
KQCard._findRepeatPointIndexsArray = function (indexsArray, originCards) {
  var repeatIndexsArray = [];
  indexsArray.forEach(function (indexs) {
    var cards = indexs.map(function (index) {
      return originCards[index];
    });

    cards.forEach(function (card, index) {
      var originIndex = originCards.findIndex(function (originCard) {
        if (typeof card == 'undefined') {
          return;
        }
        if (originCard !== card && originCard.point == card.point) {
          return true;
        }
        return false;
      });

      if (originIndex < 0) {
        return;
      }

      var repeatIndexs = indexs.slice();
      repeatIndexs[index] = originIndex;
      repeatIndexsArray.push(repeatIndexs);
    });
  });

  return repeatIndexsArray;
};

// 找同花
// 如：[[1, 2, 3, 4, 5]]
KQCard.findTongHua = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }

  var cards = Array.from(cardModes);
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var start = 0; start + length <= cards.length; ++start) {
    var subCards = cards.slice(start, start + length);
    if (KQCard.isTongHua(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {
            return card === originCard;
          });
          indexs.push(index);
        });
        //indexs = indexs.length > 5 ? indexs.splice(1,1) : indexs;
        indexs.sort(Array.sortByNumber);
        result.push(indexs);
      })();
    }
  }
  return result.length > 0 ? result : KQCard.findTongHua20(cardModes);
};
KQCard.findTongHua20 = function (cardModes) {
  if (cardModes.length < 5) {
    return false;
  }
  var card20 = KQCard.contain20(cardModes);
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = 5 - j;
    for (var start = 0; start + num <= cards.length; ++start) {
      var subCards = cards.slice(start, start + num);
      if (KQCard.isTongHua(subCards, num)) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  return result.length > 0 ? result : [];
};

KQCard.findHuLu = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }

  var p_3 = KQCard.findSanTiao(cardModes);
  var p_4 = KQCard.findTieZhi(cardModes);
  var p2 = KQCard.findDuiZi(cardModes) || [];
  //var p_3 =  this._findPointLength(cardModes, 3) || [];
  //var p_4 = this._findPointLength(cardModes, 4) || [];
  //var p2 = this._findPointLength(cardModes, 2) || [];
  if (p2.length <= 0) {
    if (p_3) {
      p_3.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        var sanTiaoIndexs3 = [indexs[1], indexs[2]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        p2.push(sanTiaoIndexs3);
      });
    }

    if (p_4) {
      p_4.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[1], indexs[2]];
        //let sanTiaoIndexs4 = [indexs[1], indexs[3]];
        var sanTiaoIndexs6 = [indexs[2], indexs[3]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        //p2.unshift(sanTiaoIndexs2);
        //p2.unshift(sanTiaoIndexs3);
        //p2.unshift(sanTiaoIndexs4);
        p2.push(sanTiaoIndexs6);
      });
    }
  }

  if (p2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.push(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : KQCard.findHuLu20(cardModes);
};
KQCard.findHuLu20 = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }
  var p_3 = KQCard.findGuiPai(cardModes, 3);
  var p_4 = KQCard.findGuiPai(cardModes, 4);
  var p_2 = KQCard.findGuiPai(cardModes, 2);
  if (p_2 == null) {
    p_2 = [];
  }
  if (p_3) {
    p_3.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs3 = [indexs[1], indexs[2]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs3);
    });
  }

  if (p_4) {
    p_4.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs6 = [indexs[2], indexs[3]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs6);
    });
  }

  if (p_2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p_2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : [];
};

KQCard.findGuiPai = function (cardModes) {
  var numBer = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

  var card20 = KQCard.contain20(cardModes).map(function (card) {
    //得到鬼牌的索引
    for (var q = 0; q < cardModes.length; q++) {
      var r = cardModes[q];
      if (r === card) {
        return q;
      }
    }
  });

  var cards = cardModes.kq_excludes(KQCard.contain20(cardModes)); //删除所有牌的鬼牌
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = numBer - j; //除鬼牌外 我应该找多少张牌匹配
    var indexs = KQCard._findPointLength(cardModes, num) || [];
    for (var t = 0; t < indexs.length; t++) {
      if (numBer == 2) {
        //是对子的时候把鬼牌和单张匹配都循环一遍
        for (var o = 0; o < card20.length; ++o) {
          var s = indexs[t].concat(card20[o]);
          if (s.length == numBer) {
            result.push(s);
          }
        }
      } else {
        var s = indexs[t].concat(card20.slice(0, j)); //依次相加鬼牌第一次加一张 递增
        if (s.length == numBer) {
          result.push(s);
        }
      }
    }
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result); //去重
  return result.length > 0 ? result : [];
};

KQCard.repeat = function (result) {
  for (var i = 0; i < result.length; i++) {
    var index = result[i];

    var newAyy = [];
    for (var o = 0; o < index.length; o++) {
      //有重复干掉你
      if (newAyy.indexOf(index[o]) == -1) {
        newAyy.push(index[o]);
      } else {
        result.splice(i, 1);
        break;
      }
    }

    for (var j = i + 1; j < result.length - 1; j++) {
      var s = result[j];
      var jString = '';
      var iString = '';
      for (var r = 0; r < s.length; r++) {
        jString = jString + s[r];
        iString = iString + index[r];
      }
      if (jString == iString) {
        //有重复干掉你
        result.splice(i, 1);
        break;
      }
    }
  }
  return result;
};

KQCard.testFind = function (cardModes) {
  var WuTong = KQCard.findWuTong(cardModes) || [];
  var TongHuaShun = KQCard.findTongHuaShun(cardModes) || [];
  var TieZhi = KQCard.findTieZhi(cardModes) || [];
  var HuLu = KQCard.findHuLu(cardModes) || [];
  var TongHua = KQCard.findTongHua(cardModes) || [];
  var ShunZi = KQCard.findShunZi(cardModes) || [];
  var SanTiao = KQCard.findSanTiao(cardModes) || [];
  var LiaDui = KQCard.findLiaDui(cardModes) || [];
  var DuiZi = KQCard.findDuiZi(cardModes) || [];
  var result = [WuTong, TongHuaShun, TieZhi, HuLu, TongHua, ShunZi, SanTiao, LiaDui, DuiZi];
  return result;
};

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","KQCard":"KQCard","KQCardPointsHelper":"KQCardPointsHelper"}],"KQCardPointsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '42d3e866XhHdbkspy3Qytap', 'KQCardPointsHelper');
// scripts\KQCard\KQCardPointsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardPointsHelper = function KQCardPointsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.point;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardPointsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardPointsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardResHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'be420vtWaJOHoxQcZwP2xN2', 'KQCardResHelper');
// scripts\KQCard\KQCardResHelper.js

"use strict";

var Helper = {
  loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
    this._loadCardFrame(cardName, callback);
  },

  setCardSpriteFrame: function setCardSpriteFrame(sprite, cardName) {
    this.loadCardSpriteFrame(cardName, function (spriteFrame) {
      sprite.spriteFrame = spriteFrame;
    });
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("images/pokerList/pockList", cc.SpriteAtlas, function (err, atlas) {
      if (err) {
        callback(null, err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }.bind(this));
  }
};

module.exports = Helper;

cc._RFpop();
},{}],"KQCardScoreExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3f5d8wDA+tMPbPd/k4hBAAR', 'KQCardScoreExtension');
// scripts\KQCard\KQCardScoreExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardScoretsHelper = require('KQCardScoretsHelper');

KQCard.scoreOfCards = function (cards) {
  if (cards == null || cards.length == null) {
    cards = [];
  }

  var isTou = cards.length == 3;
  var typeScore = KQCard._typeScoreOfCards(cards);
  var caleCards = KQCard._convertOneToA(cards.slice());
  caleCards.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  //caleCards = KQCard.Sort(caleCards);
  var card20 = KQCard.contain20(caleCards);
  var pointHelper = new KQCardScoretsHelper(caleCards.kq_excludes(card20));
  var maxNum = pointHelper.maxNumber() /*-card20.length == 0 ? 1: pointHelper.maxNumber()-card20.length*/;

  var maxScore = 0; //获取除鬼牌外最大的的点数
  for (var i in pointHelper.pointNumbers) {
    if (parseInt(i) > maxScore && pointHelper.pointNumbers[i] == maxNum) {
      maxScore = parseInt(i);
    }
  }
  caleCards.forEach(function (card) {
    if (card.scores >= 20) {
      card.scores = maxScore;
    }
  });
  card20.forEach(function (card) {
    card.scores = maxScore;
  });
  //cc.log(maxNum)
  //cc.log(maxScore)
  //cc.log(caleCards.kq_excludes(card20))
  //cc.log('----35')
  caleCards.sort(KQCard.sort);
  if (typeScore == 9000000000000000) {
    //五同
    caleCards.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var totalValue = "";
    //var totalColor = "";
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      //var c = caleCards[i].color;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      //totalColor = c+totalColor;
    }
    //totalValue = totalValue+totalColor;
    //cc.log(totalValue)
    //cc.log(parseInt(totalValue))
    //cc.log(typeScore+parseInt(totalValue))
    return typeScore + parseInt(totalValue);
  } else if (typeScore == 8000000000000000) {
    //同花顺比最大的那张，如果两张相同那就是相同
    if (card20.length > 0) {
      //有鬼牌的时候要改变鬼牌的分数
      caleCards = KQCard._changeCardScors(caleCards);
    }
    var totalValue = "";
    var valueColor = ""; //牌色
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      var c = caleCards[i].color; //牌色
      valueColor = c + valueColor; //牌色
    }
    return typeScore + parseInt(totalValue + valueColor);
  } else if (typeScore == 7000000000000000) {
    //铁支,找出那四张是什么牌

    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }
    var qwe = '';
    qwe = oneValueColor.substr(0, oneValueColor.length - 1);
    oneValueColor = oneValueColor.substr(oneValueColor.length - 1);
    str = str + oneValue + oneValueColor + valueColor + qwe;
    return typeScore + parseInt(str);
  } else if (typeScore == 6000000000000000) {
    //葫芦
    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }

    if (isTou) {
      oneValue = oneValue + '0000';
      oneValueColor = oneValueColor + '00';
    }

    str = str + oneValue + valueColor + oneValueColor;
    return typeScore + parseInt(str);
  } else if (typeScore == 5000000000000000) {
    //同花,有可能需要比5张牌
    var totalScore = "";
    var totalColor = "";
    //var colors = 0;//获取牌的类型颜色
    //for(var i in caleCards) {
    //  if(parseInt(caleCards[i].point) < 20){
    //    colors = parseInt(caleCards[i].color);
    //    break;
    //  }
    //}

    for (var i in caleCards) {
      var paiPoint = parseInt(caleCards[i].point);
      var colors = parseInt(caleCards[i].point) < 20 ? caleCards[i].color : 5;
      totalColor = colors + totalColor;
      totalScore = (paiPoint >= 10 ? paiPoint : "0" + paiPoint) + totalScore;
    }
    return typeScore + parseInt(totalScore + totalColor);
  } else if (typeScore == 4000000000000000) {
    //顺子
    if (card20.length > 0) {
      //有鬼牌的时候要改变鬼牌的分数
      caleCards = KQCard._changeCardScors(caleCards);
    }
    var totalValue = "";
    var valueColor = ""; //牌色
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;

      var c = caleCards[i].color; //牌色
      valueColor = c + valueColor; //牌色
    }
    return typeScore + parseInt(totalValue + valueColor);
  } else if (typeScore == 3000000000000000) {
    //三条，找出是哪张牌有3张
    //caleCards.sort(KQCard.sort);
    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    var oneValueColor20 = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          if (parseInt(s) < 20) {
            oneValueColor = c + oneValueColor; //牌色
          } else {
              oneValueColor20 = c + oneValueColor20; //牌色
            }
        }
    }
    if (isTou) {
      oneValue = oneValue + '0000';
      valueColor = valueColor + '00';
    }
    str = str + oneValue + oneValueColor + valueColor + oneValueColor20;
    return typeScore + parseInt(str);
  } else if (typeScore == 2000000000000000) {
    //caleCards.sort(KQCard.sort);
    //两对,有可能需要比5张牌
    var str = "";
    var oneValue = '';
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var i in pointHelper.pointNumbers) {
      if (pointHelper.pointNumbers[i] == 2) {
        //两对
        for (var w in caleCards) {
          if (i == caleCards[w].scores) {
            var s = caleCards[w].scores;
            str = (parseInt(s) >= 10 ? s : "0" + s) + str;
            var c = caleCards[w].color; //牌色
            valueColor = c + valueColor; //牌色
          }
        }
      } else {
          for (var q in caleCards) {
            //单张加花色
            if (i == caleCards[q].scores) {
              var s = caleCards[q].scores;
              oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

              var c = caleCards[q].color; //牌色
              oneValueColor = oneValueColor + c; //牌色
            }
          }
        }
    }
    cc.log(str);
    cc.log(oneValue);
    str = str + oneValue + oneValueColor + valueColor;
    return typeScore + parseInt(str);
  } else if (typeScore == 1000000000000000) {
    //对子
    //caleCards.sort(KQCard.sort);
    var str = "";
    var oneValue = "";
    var oneValueColor = "";
    var valueColor = "";

    if (card20.length > 0) {
      caleCards.sort(function (card1, card2) {
        return card2.point - card1.point;
      });
      caleCards = caleCards.kq_excludes(card20);
      caleCards.forEach(function (card, index) {
        var s = card.scores;
        var c = card.color;
        str = str + (parseInt(s) >= 10 ? s : "0" + s);
        if (index == 0) {
          var s20 = card20[0].scores;
          str = str + (parseInt(s20) >= 10 ? s20 : "0" + s20);
          valueColor = valueColor + c;
          valueColor = valueColor + card20[0].color;
        } else {
          oneValueColor = oneValueColor + c;
        }
      });
      cc.log(str);
      cc.log('--------274');
      if (isTou) {
        str = str + '0000';
        valueColor = valueColor + '00';
      }
      str = str + oneValueColor + valueColor;
      return typeScore + parseInt(str);
    }

    for (var i in pointHelper.pointNumbers) {
      if (pointHelper.pointNumbers[i] == maxNum) {
        //对子
        for (var w in caleCards) {
          //对子加花色
          if (i == caleCards[w].scores) {
            var s = caleCards[w].scores;
            valueColor = caleCards[w].color + valueColor;
            str = (parseInt(s) >= 10 ? s : "0" + s) + str;
          }
        }
      } else {
        for (var q in caleCards) {
          //单张加花色
          if (i == caleCards[q].scores) {
            var s = caleCards[q].scores;
            oneValueColor = caleCards[q].color + oneValueColor;
            oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;
          }
        }
      }
    }
    //cc.log(oneValueColor)
    //cc.log(valueColor)
    if (isTou) {
      oneValue = oneValue + '0000';
      valueColor = valueColor + '00';
    }
    str = str + oneValue + oneValueColor + valueColor;
    return typeScore + parseInt(str);
  } else if (typeScore == 0) {
    //乌龙
    var valuePoint = "";
    var valueColor = "";
    for (var q in caleCards) {
      var s = caleCards[q].scores;
      var c = caleCards[q].color; //单张加花色
      valuePoint = (parseInt(s) >= 10 ? s : "0" + s) + valuePoint;
      valueColor = c + valueColor;
    }
    if (isTou) {
      valuePoint = valuePoint + '0000';
      valueColor = valueColor + '00';
    }
    valuePoint = valuePoint + valueColor;
    return typeScore + parseInt(valuePoint);
  }

  var cardsTotalPoint = 0;
  caleCards.forEach(function (card) {
    cardsTotalPoint += card.point;
  });

  var result = typeScore + cardsTotalPoint;
  return result;
};
KQCard._changeCardScors = function (cardModel) {
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 14) {
      card.scores = 1;
    }
  });
  var is14 = false; //是 k q j 10 A;
  var is1 = false; //不是1 2 3 4 5
  cardModel.forEach(function (card) {
    if (card.scores < 9) {
      is14 = true; //不是 k q j 10 A;
      if (card.scores < 6 && card.scores > 1) {
        is1 = true; //是1 2 3 4 5
      }
    }
  });

  if (is14) {
    //不是 k q j 10 A;
    cardModel.forEach(function (card) {
      if (card.scores == 14) {
        card.scores = 1;
      }
    });
  }
  if (is14 && !is1) {
    //不是 k q j 10 A;
    cardModel.sort(function (a1, a2) {
      return a1.scores - a2.scores;
    });

    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数
      scoresAyy.push(s);
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    cardModel.forEach((function (card) {
      //改变牌的分数
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else {
    //是 k q j 10 A;
    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 14;
    if (is1) {
      //是1 2 3 4 5
      num = 5;
    }
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    cc.log(scoresAyy);
    cc.log(cardModel);
    cc.log('----------412');
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
    cc.log(cardModel);
  }

  cardModel.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  cardModel.sort(function (a1, a2) {
    return a1.scores - a2.scores;
  });
  return cardModel;
};
/*#####*/
KQCard.scoreOfCards2 = function (cards) {
  if (cards == null || cards.length == null) {
    cards = [];
  }
  if (typeof cards[0].point == 'undefined') {
    cards = KQCard.cardsFromArray(cards);
  }
  var caleCards = KQCard._convertOneToA(cards.slice());
  caleCards.sort(KQCard.sort);
  //var pointHelper = new KQCardPointsHelper(caleCards);
  var valueStr = "";
  for (var i in caleCards) {
    var s = caleCards[i].point;
    valueStr = (parseInt(s) >= 10 ? s : "0" + s) + valueStr;
    if (i == 4) {
      valueStr = '.' + valueStr;
    }
  }
  //cc.log(Number(valueStr))
  //cc.log(valueStr)
  //cc.log('---------特殊牌算分')
  return valueStr;
};

KQCard._typeScoreOfCards = function (cards) {
  var typeScore = 0;
  if (KQCard.containWuTong(cards)) {
    typeScore = 9000000000000000;
  } else if (KQCard.containTongHuaShun(cards)) {
    typeScore = 8000000000000000;
  } else if (KQCard.containTieZhi(cards)) {
    typeScore = 7000000000000000;
  } else if (KQCard.containHuLu(cards)) {
    typeScore = 6000000000000000;
  } else if (KQCard.containTongHua(cards)) {
    typeScore = 5000000000000000;
  } else if (KQCard.containShunZi(cards)) {
    typeScore = 4000000000000000;
  } else if (KQCard.containSanTiao(cards)) {
    typeScore = 3000000000000000;
  } else if (KQCard.containLiaDui(cards)) {
    typeScore = 2000000000000000;
  } else if (KQCard.containDuiZi(cards)) {
    typeScore = 1000000000000000;
  }

  return typeScore;
};

// 根据牌型进行排序
KQCard._typeCardsSort = function (cards) {
  if (cards == null || cards.length == 0) {
    return cards;
  }
  if (KQCard.containWuTong(cards)) {
    return KQCard._typeCardsSortWutong(cards);
  } else if (KQCard.containTongHuaShun(cards)) {
    return KQCard._typeCardsSortShunZi(cards);
  } else if (KQCard.containTieZhi(cards)) {
    return KQCard._typeCardsSortTieZhi(cards);
  } else if (KQCard.containHuLu(cards)) {
    return KQCard._typeCardsSortHuLu(cards);
  } else if (KQCard.containTongHua(cards)) {
    return KQCard._typeCardsSortTongHua(cards);
  } else if (KQCard.containShunZi(cards)) {
    return KQCard._typeCardsSortShunZi(cards);
  } else if (KQCard.containSanTiao(cards)) {
    return KQCard._typeCardsSortSanTiao(cards);
  } else if (KQCard.containLiaDui(cards)) {
    return KQCard._typeCardsSortLiangDui(cards);
  } else if (KQCard.containDuiZi(cards)) {
    return KQCard._typeCardsSortDuiZi(cards);
  }

  return cards.sort(KQCard.sortByPoint).reverse();
};

KQCard._typeCardsSortShunZi = function (cards) {
  return cards.sort(KQCard.sortByPoint).reverse();
};

KQCard._typeCardsSortTieZhi = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

/*#####*/
KQCard._typeCardsSortWutong = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};
/*#####*/

KQCard._typeCardsSortHuLu = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

KQCard._typeCardsSortTongHua = function (cards) {
  return cards.sort(KQCard.sortByPoint).reverse();
};

KQCard._typeCardsSortSanTiao = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

KQCard._typeCardsSortLiangDui = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

KQCard._typeCardsSortDuiZi = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

KQCard._typeCardsSortByNumberOfPoints = function (cards) {
  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.point];
    var numberOfCard2 = pointHelper.pointNumbers[card2.point];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard2 - numberOfCard1;
    }

    return card2.point - card1.point;
  });

  return newCards;
};

KQCard.testScore = function () {};

cc._RFpop();
},{"KQCard":"KQCard","KQCardColorsHelper":"KQCardColorsHelper","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardScoretsHelper":"KQCardScoretsHelper"}],"KQCardScoretsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3d3b5YPHXhN44h/B0miZFRE', 'KQCardScoretsHelper');
// scripts\KQCard\KQCardScoretsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardScoretsHelper = function KQCardScoretsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.scores;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardScoretsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardScoretsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardSelectExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '66642YNpFVIzb+JM2CkwEgS', 'KQCardSelectExtension');
// scripts\KQCard\KQCardSelectExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');

// 牌自动选择的扩展

/**
 * 自动选择牌，由大到小
 *
 * @param  {[KQCard]} originCards  被选择的原始牌数组
 *
 * @return {[KQCard]}
 */
KQCard.autoSelectCards = function (originCards, maxLength) {
    if (originCards.length <= maxLength) {
        return originCards;
    }
    originCards.forEach(function (card) {
        if (card.scores == 1) {
            card.scores = 14;
        }
    });
    var cards = originCards.slice().sort(function (a, b) {
        return a.scores - b.scores;
    });
    //cc.log(cards)
    //cc.log(originCards)
    //cc.log('--------25')
    //cards.sort(function(a,b){
    //    return a.scores - b.scores;
    //});
    //originCards = KQCard._convertOneToA(originCards);

    var findFuncs = [KQCard.findWuTong, KQCard.findTongHuaShun, KQCard.findTieZhi, KQCard.findHuLu, KQCard.findTongHua, KQCard.findShunZi, KQCard.findSanTiao, KQCard.findLiaDui, KQCard.findDuiZi];

    var indexArrays = null;
    for (var i = 0; i < findFuncs.length; ++i) {
        var func = findFuncs[i];
        indexArrays = func.bind(KQCard)(cards);
        if (indexArrays && indexArrays.length > 0) {
            break;
        }
    }

    var indexs = [];
    if (indexArrays && indexArrays.length > 0) {
        // 找出同类型的牌里的分数最大的牌
        var maxScore = 0;
        indexArrays.forEach(function (tempIndexs) {
            var tempCards = tempIndexs.map(function (index) {
                return cards[index];
            });
            var score = KQCard.scoreOfCards(tempCards);
            if (score > maxScore) {
                maxScore = score;
                indexs = tempIndexs;
            }
        });
    }

    var targetCards = indexs.map(function (index) {
        return cards[index];
    });

    if (targetCards.length < maxLength) {
        cards = cards.kq_excludes(targetCards);
        while (targetCards.length < maxLength) {
            targetCards.push(cards.pop());
        }
    } else if (targetCards.length > maxLength) {
        targetCards = targetCards.slice(o, maxLength);
    }

    return targetCards;
};

KQCard.testAutoSelect = function (cards) {};

cc._RFpop();
},{"KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension"}],"KQCard":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c548c0gMf5BGIH4309MULw+', 'KQCard');
// scripts\KQCard\KQCard.js

var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardPointsHelper = require('KQCardPointsHelper');
var NumberExtension = require('NumberExtension');
var GetCardPointsSameCount = require('GetCardPointsSameCount');

cc = cc || {};
cc.assert = cc.assert || console.assert || function () {};
cc.log = cc.log || console.log || function () {};
cc.error = cc.error || console.error || function () {};

// 牌 Model 类，封装了花色和点数
// 使用：
// new KQCard(22);
var KQCard = function KQCard(point, color, index) {
    this.color = null;
    this.point = null;
    this.sindex = index;
    this._initWithColorAndPoint = function (color, point) {
        if (color == 's') {
            color = 4;
        }
        if (color == 'h') {
            color = 3;
        }
        if (color == 'c') {
            color = 2;
        }
        if (color == 'd') {
            color = 1;
        }

        this.point = Number(point);
        this.scores = Number(point);
        this.color = Number(color);
        this.colorScores = Number(color);

        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithNumber = function (number) {
        this.point = Math.floor(number / 10);
        this.color = number % 10;
        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithObject = function (object) {
        if (object.point) {
            this._initWithColorAndPoint(object.color, object.point);
        } else if (object.suit) {
            this._initWithColorAndPoint(object.suit, object.number);
        }
    };

    this.description = function () {
        return this.cardName();
    };

    this.cardName = function () {
        return this.color + "_" + this.point;
    };

    this.sort = function (otherCard) {
        var asc = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var AisMax = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

        return KQCard.sort(this, otherCard, asc, AisMax);
    };

    this.isEqual = function (otherCard) {
        if (!otherCard) {
            return false;
        }
        return this.point == otherCard.point && this.color == otherCard.color && this.sindex == otherCard.sindex;
    };

    if (point && color) {
        this._initWithColorAndPoint(color, point);
        return;
    }

    var number = Number(point);
    if (!Number.isNaN(number)) {
        this._initWithNumber(number);
        return;
    }

    if (typeof point == 'string') {
        // 解析 xxxxd_d 形式
        var found = point.match(/(\.)*\d_\d+/);
        if (found instanceof Array && found.length > 0) {
            var result = found[0];
            var numbers = result.split('_');

            var _color = Number(numbers[0]);
            var _point = Number(numbers[1]);
            this._initWithColorAndPoint(_color, _point);
        }

        return;
    }

    if (typeof point == 'object') {
        this._initWithObject(point);
        return;
    }

    cc.error("初始化错误：" + point + " " + color);
};

// 转换成服务器的牌 model
KQCard.prototype.toServerCard = function () {
    return {
        'suit': this.color,
        'number': this.point
    };
};

KQCard.COLOR_SPADE = 4;
KQCard.COLOR_HEART = 3;
KQCard.COLOR_CLUB = 2;
KQCard.COLOR_DIAMOND = 1;

module.exports = KQCard;

KQCard.cardsFromArray = function (cardNames) {
    return cardNames.map(function (cardName, index) {
        return new KQCard(cardName, null, index);
    });
};

// 将多张牌转换成服务器的形式
KQCard.convertToServerCards = function (cards) {
    return cards.map(function (card) {
        return card.toServerCard();
    });
};

KQCard.TYPE = {
    WuLong: 0,
    DuiZi: 1,
    LiangDui: 2,
    SanTiao: 3,
    ShunZi: 4,
    TongHua: 5,
    HuLu: 6,
    TieZhi: 7,
    TongHuaShun: 8,
    /*#####*/
    WuTong: 9,
    /*#####*/
    SanTaoHua: 10, // 特殊牌
    SanShunZi: 11,
    LiuDuiBan: 12,

    WuDuiSanTiao: 13,
    SiTaoSanTiao: 14,

    CouYiSe: 15,
    SanFenTianXia: 16,
    SanTongHuaShun: 17,
    YiTiaoLong: 18,
    QingLong: 19
};

// 牌类型名
KQCard.cardsTypeName = function (cards) {
    var names = ['乌龙', '对子', '两对', '三条', '顺子', '同花', '葫芦', '铁支', '同花顺', '五同', '三同花', '三顺子', '六对半', '五对三条', '四套三条', '凑一色', '三分天下', '三同花顺', '一条龙', '清龙'];
    var type = KQCard.cardsType(cards);
    return names[type];
};

// 找出牌的类型
KQCard.cardsType = function (cards) {
    if (KQCard.isQingLong(cards)) {
        return KQCard.TYPE.QingLong;
    }

    if (KQCard.isYiTiaoLong(cards)) {
        return KQCard.TYPE.YiTiaoLong;
    }

    if (KQCard.isSanTongHuaShun(cards)) {
        return KQCard.TYPE.SanTongHuaShun;
    }

    if (KQCard.isSanFenTianXia(cards)) {
        return KQCard.TYPE.SanFenTianXia;
    }

    if (KQCard.isLiuDuiBan(cards)) {
        return KQCard.TYPE.LiuDuiBan;
    }

    if (KQCard.isSanTongHua(cards)) {
        return KQCard.TYPE.SanTaoHua;
    }

    if (KQCard.isSanShunZi(cards)) {
        return KQCard.TYPE.SanShunZi;
    }

    if (KQCard.isSanShunZi1(cards)) {
        return KQCard.TYPE.SanShunZi;
    }

    if (KQCard.isCouYiSe(cards)) {
        return KQCard.TYPE.CouYiSe;
    }

    if (KQCard.isWuDuiSanTiao(cards)) {
        return KQCard.TYPE.WuDuiSanTiao;
    }

    if (KQCard.isSiTaoSanTiao(cards)) {
        return KQCard.TYPE.SiTaoSanTiao;
    }

    /*#####*/
    if (KQCard.containWuTong(cards, 5)) {
        return KQCard.TYPE.WuTong;
    }

    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    //
    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    /*#####*/

    if (KQCard.containTongHuaShun(cards, 5)) {
        return KQCard.TYPE.TongHuaShun;
    }

    if (KQCard.containTieZhi(cards)) {
        return KQCard.TYPE.TieZhi;
    }

    if (KQCard.containHuLu(cards)) {
        return KQCard.TYPE.HuLu;
    }

    if (KQCard.containTongHua(cards)) {
        return KQCard.TYPE.TongHua;
    }

    if (KQCard.containShunZi(cards)) {
        return KQCard.TYPE.ShunZi;
    }

    if (KQCard.containSanTiao(cards)) {
        return KQCard.TYPE.SanTiao;
    }

    if (KQCard.containLiaDui(cards)) {
        return KQCard.TYPE.LiangDui;
    }

    if (KQCard.containDuiZi(cards)) {
        return KQCard.TYPE.DuiZi;
    }

    return KQCard.TYPE.WuLong;
};

// 判断是否是同花
KQCard.isTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    var colors = cards.map(function (card) {
        return card.color;
    });

    var color = colors[0];
    for (var index in colors) {
        var e = colors[index];
        if (e != color) {
            return false;
        }
    }
    return true;
};

// 是否包含同花
KQCard.containTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findTongHua(cards).length > 0) {
        return true;
    }
    return false;
    //cards = Array.from(cards);
    //cards.sort(KQCard.sortByColor);
    //
    //for (var start = 0; (start + minLength) <= cards.length; ++start) {
    //    let subCards = cards.slice(start, start + minLength);
    //    if (KQCard.isTongHua(subCards, minLength)) {
    //        return true;
    //    }
    //}

    //return KQCard.containTongHua20(cards);
};
KQCard.containTongHua20 = function (card) {
    if (card.length < 5) {
        return false;
    }
    var card20 = KQCard.contain20(card);
    var cards = card.kq_excludes(card20);
    cards.sort(KQCard.sortByColor);

    for (var j = 1; j <= card20.length; ++j) {
        var num = 5 - j;
        for (var start = 0; start + num <= cards.length; ++start) {
            var subCards = cards.slice(start, start + num);
            if (KQCard.isTongHua(subCards, num)) {
                return true;
            }
        }
    }
    return false;
};
// 判断是否是顺子
KQCard.isShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    if (KQCard._isShunZiAKQ(cards)) {
        return true;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });

    var point = points[0];
    for (var index in points) {
        var e = points[index];
        if (e != point) {
            return false;
        }

        point = point + 1;
    }

    return true;
};

// 判断是否是 A K Q J 10 这个顺子
KQCard._isShunZiAKQ = function (cards) {
    var length = cards.length;
    if (length.length < 3) {
        return false;
    }

    var point1s = [1];
    var point14s = [14];
    var pointK = 13;

    Number(length - 1).kq_times(function (times) {
        point1s.push(pointK - times);
        point14s.push(pointK - times);
    });

    return KQCard._isCardsContainPoints(cards, point1s) || KQCard._isCardsContainPoints(cards, point14s);
};

// cards 中是否包含 points 这些点数

KQCard._isCardsContainPoints = function (cards, points) {
    var _loop = function (index) {
        var point = points[index];
        var pointCardIndex = cards.findIndex(function (card) {
            return card.point == point;
        });

        if (pointCardIndex < 0) {
            return {
                v: false
            };
        }
    };

    for (var index = 0; index < points.length; ++index) {
        var _ret = _loop(index);

        if (typeof _ret === 'object') return _ret.v;
    }

    return true;
};
KQCard.contain20 = function (cards) {
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var newCard = cards.filter(function (card) {
        //重新赋值cards
        if (card.point >= 20) {
            return card;
        }
    });
    return newCard || [];
};
// 是否包含顺子
KQCard.containShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findShunZi(cards).length > 0) {
        return true;
    }
    return false;
    //let uniqueCards = cards.unique(function(card1, card2) {
    //    return card1.point == card2.point;
    //});
    //uniqueCards.sort(KQCard.sortByPoint);
    //
    //let minPointCard = uniqueCards[0];
    //if (minPointCard.point == 1) {
    //    let APlusCard = new KQCard(minPointCard);
    //    APlusCard.point = 14;
    //    uniqueCards.push(APlusCard);
    //}
    //
    //for (var start = 0; (start + minLength) <= uniqueCards.length; ++start) {
    //    let subCards = uniqueCards.slice(start, start + minLength);
    //    if (KQCard.isShunZi(subCards, minLength)) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containShunZi20(cards);
};
/*KQCard.containShunZi20 = function (card) {
    if (card.length < 5) {
        return false;
    }
    var card20 = KQCard.contain20(card);
    var cards = card.kq_excludes(card20);
    // 先根据点数去重
    var newArr = [];
    var newArrs = [];
    for (var i = 0; i < cards.length; i++) {
        if (newArrs.indexOf(cards[i].point) == -1) {
            newArr.push(cards[i]);
            newArrs.push(cards[i].point);
        }
    }
    //newArr.forEach(function(card){
    //    if(card.scores == 14){
    //        card.scores = 1;
    //    }
    //})
    newArr.sort(function (n1, n2) {
        return n1.point - n2.point;
    });
    for(var j = 1;j <= card20.length;++j){
        var num = 5 - j;
        for (var start = 0; (start + num) <= newArr.length; ++start) {
            var subCards = newArr.slice(start, start + num);
            var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
            if(bool){
                return true;
            }
        }
    }
    // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
    let convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
        return false;
    }
    return KQCard.containShunZi20(convertedCards);
};*/
// 是否是同花顺
KQCard.isTongHuaShun = function (cards) {
    return KQCard.isTongHua(cards) && KQCard.isShunZi(cards);
};

// 是否包含有同花顺
KQCard.containTongHuaShun = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findTongHuaShun(cards).length > 0) {
        return true;
    }
    return false;
    //var sanShunZi = KQCard.sanShunZi1(cards,minLength)[0];
    //if(sanShunZi == null){
    //    return false;
    //}
    //var result = false;
    //for(var i=0;i<sanShunZi.length;i++) {
    //    var s = sanShunZi[i];
    //    if (KQCard.isTongHuaShun(s, minLength)) {
    //        return true;
    //    }
    //}
    //return KQCard.containTongHuaShun1(cards);
};
/*KQCard.containTongHuaShun1 = function (cards, minLength = 5) {
    if (cards.length < minLength) {
        return false;
    }
    let tempCards = Array.from(cards).sort(KQCard.sortByColor);
    for (var start = 0; (start + minLength) <= tempCards.length; ++start) {
        let subCards = tempCards.slice(start, start + minLength);
        if (KQCard.isTongHuaShun(subCards, minLength)) {
            return true;
        }
    }

    let convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
        return KQCard.containTongHuaShun20(cards);
    }
    return KQCard.containTongHuaShun1(convertedCards);
    //return false;
};
KQCard.containTongHuaShun20 = function (card, minLength = 5) {
    if (card.length < minLength) {
        return false;
    }
    var card20 = KQCard.contain20(card) || [];
    var cards = card.kq_excludes(card20);

    cards = Array.from(cards);
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    var pointS = []; //黑桃
    var pointH = []; //红心
    var pointC = []; //梅花
    var pointD = []; //方块
    for(var i=0;i<cards.length;i++){
        if(cards[i].color == '4'){
            if(pointS.indexOf(cards[i].point) == -1){
                pointS.push(cards[i].point);
                colorS.push(cards[i]);
            }

        }else if(cards[i].color == '3'){
            if(pointH.indexOf(cards[i].point) == -1){
                pointH.push(cards[i].point);
                colorH.push(cards[i]);
            }
        }else if(cards[i].color == '2'){
            if(pointC.indexOf(cards[i].point) == -1){
                pointC.push(cards[i].point);
                colorC.push(cards[i]);
            }
        }else if(cards[i].color == '1'){
            if(pointD.indexOf(cards[i].point) == -1){
                pointD.push(cards[i].point);
                colorD.push(cards[i]);
            }
        }
    }

    var color = [colorS,colorH,colorC,colorD];
    var colorSum = [];    //总共有几种花色 [5,3,0....]
    for(var i=0;i<color.length;i++){
        if(color[i].length >= parseInt(5 - card20.length)){
            //color[i].forEach(function(ca){
            //    if(ca.scores == 14){
            //        ca.scores = 1;
            //    }
            //})
            color[i].sort(function(a1,a2){
                return a1 - a2;
            })
            colorSum.push(color[i]);
        }
    }

    for(var i=0;i<colorSum.length;i++) {
        var s = colorSum[i]
        for(var j = 1;j <= card20.length;++j){
            var num = 5 - j;
            for (var start = 0; (start + num) <= s.length; ++start) {
                var subCards = s.slice(start, start + num);
                var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
                if(bool){
                    return true;
                }
            }
        }
    }



    let convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
        return false;
    }
    return KQCard.containTongHuaShun20(convertedCards);
};*/

// 是否是清龙
KQCard.isQingLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    /**
     *
     */
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
        }
    }
    if (colorSum.length == 1) {
        if (colorSum[0] == 13) {
            return KQCard.isYiTiaoLong(cards);
        }
    }
    //return KQCard.isTongHuaShun(cards);
    return false;
};

// 是否是一条龙
KQCard.isLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    return KQCard.isShunZi(cards);
};

/*#####*/
/*是否一条龙*/
KQCard.isYiTiaoLong = function (cards) {
    //cards:{number:1~13 ,'suit':'h'...}
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].number == 'undefined') {
        cards = KQCard.convertToServerCards(cards);
    }
    var number = cards.map(function (card) {
        return card.number;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });
    for (var i = 0; i < cards.length - 1; i++) {
        if (number[i] != number[i + 1] - 1) {
            return false;
        }
    }
    return true;
};
/*#####*/
/*是否三同花*/
KQCard.isSanTongHua = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == "undefined") {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
        }
    }

    //如果牌中包含四种花色就不可能是三同花
    if (colorSum.length == 4) {
        return false;
    }

    //三种花色
    if (colorSum.length == 3) {
        for (var i = 0; i < colorSum.length; i++) {
            if (colorSum[i] != 5 && colorSum[i] != 3) {
                return false;
            }
        }
        return true;
    }
    //两种花色
    else if (colorSum.length == 2) {
            for (var i = 0; i < colorSum.length; i++) {
                if (colorSum[i] != 10 && colorSum[i] != 3 && colorSum[i] != 8 && colorSum[i] != 5) {
                    return false;
                }
            }

            return true;
        }
        //一种花色
        else if (colorSum.length == 1) {
                if (colorSum[0] == 13) {
                    return true;
                }
            }
};
/*是否凑一色*/
KQCard.isCouYiSe = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's' || cards[i].suit == 'c') {
            colorS.push(cards[i]); //全黑
        } else if (cards[i].suit == 'h' || cards[i].suit == 'd') {
                colorH.push(cards[i]); //全红
            }
    }

    //如果牌中包含四种花色就不可能是三同花
    if (colorS.length == 13 || colorH.length == 13) {
        return true;
    }
    //else if(colorH.length == 13){
    //    return true;
    //}
    return false;
};
/*#####*/
// 是否是六对半
KQCard.isLiuDuiBan = function (cards) {
    var length = 12;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfYi = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value >= 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        } else if (value == 1) {
            numberOfYi += 1;
        }
    }
    return numberOfDuiZi == 6;
};

KQCard.isWuDuiSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    var sanTiaoLength = 3;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfSanTiao = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        } else if (value >= 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
    }
    return numberOfDuiZi == 5 && numberOfSanTiao == 1;
};
/*#####*/
KQCard.isSanShunZi1 = function (cards) {
    if (cards.length != 13) {
        return false;
    }

    //取出牌的点数
    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    //var card20 = KQCard.contain20(cards);
    //if(card20.length > 0) {
    //    return false;
    //}
    var number = cards.map(function (card) {
        return card.number;
    });
    //排序
    number.sort(function (n1, n2) {
        return n1 - n2;
    });
    if (KQCard.fenZhu(number, 5, 5) == false) {
        var number = cards.map(function (card) {
            return card.number;
        });
        //排序
        number.sort(function (n1, n2) {
            return n1 - n2;
        });
        if (KQCard.fenZhu(number, 5, 3) == false) {
            var number = cards.map(function (card) {
                return card.number;
            });
            //排序
            number.sort(function (n1, n2) {
                return n1 - n2;
            });
            if (KQCard.fenZhu(number, 3, 5) == false) {
                var AIsExist = false; //是否存在A
                for (var i in cards) {
                    if (cards[i].number == 1) {
                        AIsExist = true;
                        break;
                    }
                }
                if (!AIsExist) {
                    return false;
                }

                for (var i in cards) {
                    if (cards[i].number == 1) {
                        cards[i].number = 14;
                        break;
                    }
                }
                return KQCard.isSanShunZi1(cards);
            } else {
                return true;
            }
        } else {
            return true;
        }
    } else {
        return true;
    }
};

//判断5张或者3张是否顺子
KQCard.isShunZi1 = function (arr) {
    for (var i = 0; i < arr.length - 1; i++) {
        if (arr[i + 1] - arr[i] != 1) {
            //不是顺子
            return false;
        }
    }
    return true;
};

KQCard.fenZhu = function (number, num1, num2) {
    var arr1 = [];
    var arr2 = [];
    for (var i = 0; i < number.length - 1; i++) {
        if (i == 0) {
            arr1.push(number[0]);
        }
        if (number[i + 1] - number[i] == 0) {
            continue;
        }
        arr1.push(number[i + 1]);
        if (arr1.length == num1) {
            //取第一组是顺子
            if (KQCard.isShunZi1(arr1)) {
                //这5个是顺子,从数组中移除
                for (var i = 0; i < arr1.length; i++) {
                    for (var j = 0; j < number.length - 1; j++) {
                        if (number[j] == arr1[i]) {
                            //两个数一样的只删除一个
                            if (number[j] == number[j + 1]) {
                                continue;
                            }
                            number.splice(j, 1); //从number中移除
                        }
                    }
                }
                //接下来取第二组
                for (var i = 0; i < number.length - 1; i++) {
                    if (i == 0) {
                        arr2.push(number[0]);
                    }
                    if (number[i + 1] - number[i] == 0) {
                        continue;
                    }
                    arr2.push(number[i + 1]);
                    if (arr2.length == num2) {
                        //取第二组是顺子
                        if (KQCard.isShunZi1(arr2)) {
                            for (var i = 0; i < arr2.length; i++) {
                                for (var j = 0; j < number.length - 1; j++) {
                                    if (number[j] == arr2[i]) {
                                        //两个数一样的只删除一个
                                        if (number[j] == number[j + 1]) {
                                            continue;
                                        }
                                        number.splice(j, 1); //从number中移除
                                    }
                                }
                            }
                            //接下来就是剩下的了
                            if (KQCard.isShunZi1(number)) {
                                //第三组也是顺子
                                return true;
                            }
                            //第三组不是顺子
                            return false;
                        }
                        //第二组不是顺子
                        return false;
                    }
                }
            }
            //第一组不是顺子
            return false;
        }
    }
};
// isSanShunZi2是我写的
KQCard.isSanShunZi = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    cards = Array.from(cards);
    cards.sort(KQCard.sortByPoint);
    var wei = [];
    var zhong = [];
    var tou = [];
    var sanShunZi = KQCard.sanShunZi1(cards)[0]; //获取所有组合的头道
    if (!sanShunZi) {
        //你连头道都没有 怎么更我混
        return false;
    }

    var newCard = cards.filter(function (i) {
        //重新赋值cards
        return i;
    });
    var newCards1 = [];
    var newPoint = []; //判断point是否相同
    var duiZi = []; //取出有对子当中的一张牌
    for (var s in cards) {
        if (newPoint.indexOf(cards[s].point) < 0) {
            newCards1.push(cards[s]);
            newPoint.push(cards[s].point);
        } else {
            //取出有对子当中的一张牌
            duiZi.push(cards[s]);
        }
    }

    for (var j = 0; j < sanShunZi.length; ++j) {
        //循环所有头道
        var number3 = sanShunZi[j];
        if (typeof number3 == 'undefined') {
            continue;
        }
        for (var i = 0; i < cards.length; ++i) {
            var newCards = newCards1.filter(function (i) {
                //重新赋值cards
                return i;
            });

            newCards = newCards.kq_excludes(number3); //删除牌里的头道
            if (wei.length != 5) {
                var subCards = newCards.slice(i, i + 5);
                if (KQCard.isShunZi(subCards)) {
                    //得到尾道 删除牌里的尾道
                    wei = subCards;
                    newCards = newCards.kq_excludes(subCards);
                }
            }
            if (wei.length == 5) {
                //把剩余的牌和对子的单张合并
                var tasks = duiZi.filter(function (i) {
                    //重新赋值对子
                    return i;
                });
                tasks = tasks.kq_excludes(number3); //判断头道和对子的单张是否有相同 有的话就删除
                newCards = newCards.concat(tasks); //把剩余的牌和对子的单张合并
            }
            if (zhong.length != 5 && newCards.length == 5) {
                if (KQCard.isShunZi(newCards)) {
                    //是三顺子
                    zhong = newCards;
                }
            }
            if (wei.length == 5 && zhong.length == 5) {
                //是三顺子终止循环
                break;
            } else {
                //来吧 继续吧
                zhong = [];wei = [];tou = [];
            }
        }
        if (wei.length == 5 && zhong.length == 5) {
            //是三顺子终止循环
            tou = number3;
            break;
        } else {
            //来吧 继续吧
            zhong = [];wei = [];tou = [];
        }
    }

    cards = newCard;
    if (KQCard._isSanShunZi(tou, zhong, wei)) {
        //是三顺子
        return true;
    }
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
        return false;
    }
    return KQCard.isSanShunZi(convertedCards);
};

KQCard.sanShunZi1 = function (cards) {
    var length = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    var shunzi = KQCard.findShunZi(cards, length);
    var cardsT = [];
    var cardsIndex = [];
    if (shunzi == null) {
        return false;
    }
    for (var i = 0; i < shunzi.length; i++) {
        var a = shunzi[i];
        var cardsShunzi = [];
        // var cardsIndex = [];
        for (var j = 0; j < a.length; j++) {
            var index = a[j];
            if (typeof cards[index] == 'undefined') {
                continue;
            }
            cardsShunzi.push(cards[index]);
        }
        cardsIndex.push(a);
        cardsT.push(cardsShunzi);
    }
    return [cardsT, cardsIndex];
};

KQCard._isSanShunZi = function (touCards, zhongCards, weiCards) {
    return KQCard.isShunZi(touCards) && KQCard.isShunZi(zhongCards) && KQCard.isShunZi(weiCards);
};
// 是否是三同花顺
KQCard.isSanTongHuaShun = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorCardsObject = KQCard._colorClassCards(cards);

    var subCards = [];
    for (var prop in colorCardsObject) {
        var _cards = colorCardsObject[prop];
        subCards.push(_cards);
    }

    if (subCards.length != 3) {
        return false;
    }

    subCards = subCards.sort(function (s1, s2) {
        return s1.length > s2.length;
    });

    var touCards = subCards[0];
    var zhongCards = subCards[1];
    var weiCards = subCards[2];

    if (touCards.length != 3 || zhongCards.length != 5 || weiCards.length != 5) {
        return false;
    }

    return KQCard._isSanTongHuaShun(touCards, zhongCards, weiCards);
};

// 将牌根据 color 进行分类
KQCard._colorClassCards = function (cards) {
    var colorCardsObject = {};
    cards.forEach(function (card) {
        var color = card.color;
        var subCards = colorCardsObject[color];
        if (!subCards) {
            subCards = [];
            colorCardsObject[color] = subCards;
        }
        subCards.push(card);
    });

    return colorCardsObject;
};

// 是否是三同花顺
KQCard._isSanTongHuaShun = function (touCards, zhongCards, weiCards) {
    return KQCard.isTongHuaShun(touCards) && KQCard.isTongHuaShun(zhongCards) && KQCard.isTongHuaShun(weiCards);
};

// 是否是 “三分天下”
KQCard.isSanFenTianXia = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var tieZhiLength = 4;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfTieZhi = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == tieZhiLength) {
            numberOfTieZhi = numberOfTieZhi + 1;
        }
    }
    return numberOfTieZhi === 3;
};

// 是否是 “四套三条”
KQCard.isSiTaoSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var sanTiaoLength = 3;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfSanTiao = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        }
    }

    return numberOfSanTiao == 4;
};

// 是否是 “三桃花”
// 头、中、尾道为相同花色的牌
KQCard.isSanTaoHua = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorHelper = new KQCardColorsHelper(cards);
    var colorNumbers = [];
    for (var prop in colorHelper.colorNumber) {
        colorNumbers.push(colorHelper.colorNumber[prop]);
    }

    colorNumbers.sort(function (n1, n2) {
        return n1 - n2;
    });

    if (colorNumbers.length != 3) {
        return false;
    }

    if (colorNumbers[0] == 3 && colorNumbers[1] == 5 && colorNumbers[2] == 5) {
        return true;
    }

    return false;
};

// 判断是否包含铁支
// 四张同样点数的牌
KQCard.containTieZhi = function (cards) {
    var length = 4;
    if (cards.length < length) {
        return false;
    }
    //let helper = new KQCardPointsHelper(cards);
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}else{
    //    return KQCard.containGuiPai(cards,4);
    //}
    if (KQCard.findTieZhi(cards).length > 0) {
        return true;
    }
    return false;
};

// 判断是否是铁支
KQCard.isTieZhi = function (cards) {
    var length = 4;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};

/*#####是否包含五同*/
//五张同样点数的牌
KQCard.containWuTong = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    //五张牌相同的
    //let helper = new KQCardPocontain20intsHelper(cards);
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}else{
    //    return KQCard.containGuiPai(cards,5);
    //}
    if (KQCard.findWuTong(cards).length > 0) {
        return true;
    }
    return false;
};

/*判断是否五同*/
KQCard.isWuTong = function (cards) {
    var length = 5;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};
/*#####*/

// 是否是 “葫芦”
// 三张相同 + 一对
KQCard.containHuLu = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    if (KQCard.findHuLu(cards).length > 0) {
        return true;
    }
    //let pointHelper = new KQCardPointsHelper(cards);
    //var pointNumbers = [];
    //var index = 0;
    //for (let prop in pointHelper.pointNumbers) {
    //    pointNumbers[index] = pointHelper.pointNumbers[prop];
    //    index = index + 1;
    //}
    //var h=[];
    //var h1=[];
    //for(var i in pointNumbers){
    //    var s=pointNumbers[i];
    //    if(s == 3){
    //        h.push(s)
    //    }
    //    else if(s==4){
    //        h1.push(s)
    //    }
    //
    //}
    //
    //if ((pointNumbers.indexOf(3) != -1) && (pointNumbers.indexOf(2) != -1)
    // || h.length > 1 || h1.length > 1 ||(pointNumbers.indexOf(4) != -1)
    // && (pointNumbers.indexOf(2) != -1)) {
    //    return true;
    //}

    return false;
};

// 判断是否是 葫芦
KQCard.isHuLu = function (cards) {
    if (cards.length != 5) {
        return false;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (p1, p2) {
        return p1 - p2;
    });

    var p1 = points[0];
    var p2 = p1;
    var numberP1 = 0;
    var numberP2 = 0;

    points.forEach(function (point) {
        if (point != p1 && point != p2) {
            p2 = point;
            numberP2 = 0;
        }

        numberP1 = numberP1 + (point == p1 ? 1 : 0);
        numberP2 = numberP2 + (point == p2 ? 1 : 0);
    });

    var maxNumber = Math.max(numberP1);
    var minNumber = Math.min(numberP2);

    return minNumber == 2 && maxNumber == 3;
};

// 是否包含有 “三条”
KQCard.containSanTiao = function (cards) {
    if (cards.length < 3) {
        return false;
    }
    if (KQCard.findSanTiao(cards).length > 0) {
        return true;
    }
    return false;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= 3) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containGuiPai(cards,3);
};

// 是否是 “三条”
KQCard.isSanTiao = function (cards) {
    if (cards.length != 3) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (card.point == point) {
            return point;
        }

        return -1;
    }, cards[0].point);

    return result != -1;
};

// 是否包含有 ：两对
KQCard.containLiaDui = function (cards) {
    if (cards.length < 4) {
        return false;
    }
    if (KQCard.findLiaDui(cards).length > 0) {
        return true;
    }
    //var numberOfDuiZi = 0;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] == 2) {
    //        numberOfDuiZi = numberOfDuiZi + 1;
    //        if (numberOfDuiZi == 2) {
    //            return true;
    //        }
    //    }
    //}

    return false;
};

// 是否是 两对
KQCard.isLiaDui = function (cards) {
    if (cards.length != 4) {
        return false;
    }

    var pointHelper = new KQCardPointsHelper(cards);
    for (var prop in pointHelper.pointNumbers) {
        if (pointHelper.pointNumbers[prop] != 2) {
            return false;
        }
    }
    return true;
};

// 是不是对子
KQCard.isDuiZi = function (cards) {
    if (cards.length != 2) {
        return false;
    }

    var card1 = cards[0];
    var card2 = cards[1];

    return card1.point == card2.point;
};

// 是否包含对子
KQCard.containDuiZi = function (cards) {
    if (cards.length < 2) {
        return false;
    }
    if (KQCard.findDuiZi(cards).length > 0) {
        return true;
    }
    return false;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] == 2) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containGuiPai(cards,2);
};

KQCard.containGuiPai = function (cards, length) {
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    var helper = new KQCardPointsHelper(cards);
    var maxNumber = helper.maxNumber() + card20.length;
    return maxNumber >= length;
};
/*#####*/
// 是否是特殊牌
KQCard.isTeShuPai = function (cards) {
    if (cards.length < 13) {
        return false;
    }

    return KQCard.isQingLong(cards) || KQCard.isYiTiaoLong(cards)
    /*|| KQCard.isSanTongHuaShun(cards)
    || KQCard.isSanFenTianXia(cards)
    || KQCard.isSiTaoSanTiao(cards)
    || KQCard.isLiuDuiBan(cards)
    || KQCard.isSanShunZi(cards)
    || KQCard.isSanShunZi1(cards)
    || KQCard.isSanTongHua(cards)
    || KQCard.isWuDuiSanTiao(cards)
    || KQCard.isCouYiSe(cards)*/;
};

// 将牌中的 1 变化为 A（14)
KQCard._convertOneToA = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var result = cards.map(function (card) {
        if (card.point == 1) {
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

KQCard._convertOneToA1 = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var num = 0;
    var result = cards.map(function (card) {
        if (card.point == 1 && num == 0) {
            num++;
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

// KQCard 的排序方法
KQCard.sortByPoint = function (card1, card2) {
    var result = Number(card1.point) - Number(card2.point);
    return result;
};

KQCard.sortByColor = function (card1, card2) {
    var pointAsc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (card2.color == card1.color) {
        return (card1.point - card2.point) * (pointAsc ? 1 : -1);
    }
    return card2.color - card1.color;
};

KQCard.sort = function (card1, card2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
    var AisMax = arguments.length <= 3 || arguments[3] === undefined ? true : arguments[3];

    var result = 1;
    if (card1.point == card2.point) {
        result = card1.color - card2.color;
    } else {
        var point1 = card1.point;
        var point2 = card2.point;
        if (AisMax && point1 == 1) {
            point1 = 14;
        }

        if (AisMax && point2 == 1) {
            point2 = 14;
        }

        result = point1 - point2;
    }

    return result * (asc ? 1 : -1);
};

//转为客户端的牌
KQCard._convertCardsToCardNames = function (cards) {
    // [{"suit":"s","number":10}]
    var suitColorMap = ['', 'd', 'c', 'h', 's'];
    return cards.map(function (card) {
        var cardNumber = card.point;
        var color = suitColorMap[card.color];
        var number = Math.max(Math.min(cardNumber, 13), 1);
        return { number: number, suit: color };
    });
};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCardColorsHelper":"KQCardColorsHelper","KQCardPointsHelper":"KQCardPointsHelper","NumberExtension":"NumberExtension"}],"KQGlabolSocketEventHander":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'babea3CWj9G1pWM9AkXao0n', 'KQGlabolSocketEventHander');
// scripts\Socket\KQGlabolSocketEventHander.js

'use strict';

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var KQGlabolSocketEventHander = {
    start: function start() {
        if (this._didStart) {
            return;
        }
        this._didStart = true;

        KQGlobalEvent.on(Socket.Event.ReceiveForceExit, this._forceExitApp, this);
    },

    _forceExitApp: function _forceExitApp(response) {
        KQNativeInvoke.forceExitApp();
    }
};

module.exports = KQGlabolSocketEventHander;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"KQGlobalEvent":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd90d6OrggVEXa29ffA+vZY0', 'KQGlobalEvent');
// scripts\Event\KQGlobalEvent.js

'use strict';

var KQGlobalEvent = {
    _handles: {},
    //发送事件
    emit: function emit(eventName) {
        var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        if (typeof data == 'string') {
            data = { 'data': data };
        }

        var returns = []; //返回值
        data.eventName = eventName; //保存一下事件名字

        for (var findEvenName in this._handles) {
            if (findEvenName == eventName) {
                for (var i = 0; i < this._handles[findEvenName].length; i++) {
                    var returnValue = this._handles[findEvenName][i](data);
                    returns.push(returnValue);
                }
            }
        }

        return returns;
    },
    //添加普通事件
    on: function on(eventName, callback, target) {
        // console.log('收到事件', eventName);
        this._handles[eventName] = this._handles[eventName] || [];

        this._handles[eventName].push(callback.bind(target));
        callback._caller = target;
    },

    //通过事件名移除一个监听器
    off: function off(eventName) {
        for (var i = 0; i < this._handles[eventName].length; i++) {
            this._handles[eventName][i] = null;
        }
    },

    // 移动一个 target 上所有的监听
    offTarget: function offTarget(target) {
        for (var name in this._handles) {
            var eventHandlers = this._handles[name];
            var indexs = eventHandlers.filter(function (callback) {
                return callback._caller = target;
            }).map(function (callback, index) {
                return index;
            });

            var indexOffset = 0;
            indexs.forEach(function (index) {
                eventHandlers.splice(index + indexOffset, 1);
                indexOffset = indexOffset + 1;
            });
        }
    }
};

module.exports = KQGlobalEvent;

cc._RFpop();
},{}],"KQNativeInvoke":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7327dLBqWVNaJ14fJQ4jq6Y', 'KQNativeInvoke');
// scripts\Utils\KQNativeInvoke.js

var KQNativeInvoke = {
  IOSClassName: "AppController",
  ANDRIODClassName: "com/lling/ssz/AppActivity",

  isNativeIOS: function isNativeIOS() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.IPHONE || platform == cc.sys.IPAD) {
      return true;
    }
    return false;
  },

  isNativeAndroid: function isNativeAndroid() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.ANDROID) {
      return true;
    }
    return false;
  },

  isNative: function isNative() {
    return cc.sys.isNative == true;
  }
};

// MARK: 可调用的本地方法
/**
 * 微信登录
 */
KQNativeInvoke.wxLogin = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
  } else if (KQNativeInvoke.isNativeAndroid()) {
      //Android
      jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
    }
};

/**
 * 分享大厅信息到微信好友
 * 
 */
KQNativeInvoke.shareHallToWeChatFriend = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallFriend", "()V");
  }
};

/**
 * 分享大厅信息到朋友圈
 * 
 */
KQNativeInvoke.shareHallToWeChatTimeline = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", "()V");
  }
};

/**
 * 强制退出 APP
 * 
 */
KQNativeInvoke.forceExitApp = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
  }
};

/**
 * 下载新版本
 * 
 * @param {String} iosUrl      iOS 版本地址
 * @param {String} androidUrl  安卓版本地址
 */
KQNativeInvoke.downloadNewVersion = function (iosUrl, androidUrl) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", iosUrl);
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", androidUrl);
  }
};

/**
 * 分享房间给微信好友
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatFriend = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", "(Ljava/lang/String;Ljava/lang/String;)V", id, description);
  }
};

/**
 * 分享房间到微信朋友圈
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatTimeline = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShare:description:", id, description);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShare", "(Ljava/lang/String;Ljava/lang/String;)V", id, description);
  }
};

/**
 * 分享屏幕截图到微信好友
 */
KQNativeInvoke.shareScreenToWeChatFriend = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShareFriend", "()V");
  }
};

/**
 * 分享屏幕截图到微信朋友圈
 */
KQNativeInvoke.shareScreenToWeChatTimeline = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
  }
};

/**
 * 开始录音
 */
KQNativeInvoke.startRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
  }
};

/**
 * 结束录音
 */
KQNativeInvoke.endRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
  }
};

KQNativeInvoke.screenshotShare = function () {
  var strings = arguments.length <= 0 || arguments[0] === undefined ? 'shareIMG' : arguments[0];

  if (this._isCapturing) {
    return;
  }
  this._isCapturing = true;
  var size = cc.director.getWinSize();
  var fileName = "result_share.jpg";
  var fullPath = jsb.fileUtils.getWritablePath() + fileName;
  if (jsb.fileUtils.isFileExist(fullPath)) {
    jsb.fileUtils.removeFile(fullPath);
  }
  var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height), cc.IMAGE_FORMAT_PNG, gl.DEPTH24_STENCIL8_OES);
  texture.setPosition(cc.p(size.width / 2, size.height / 2));
  texture.begin();
  cc.director.getRunningScene().visit();
  texture.end();
  texture.saveToFile(fileName, cc.IMAGE_FORMAT_PNG);

  var self = this;
  var tryTimes = 0;
  var fn = function fn() {
    if (jsb.fileUtils.isFileExist(fullPath)) {

      if (cc.sys.os == cc.sys.OS_ANDROID) {
        jsb.reflection.callStaticMethod(self.ANDRIODClassName, strings, "(Ljava/lang/String;)V", fullPath);
      }
      self._isCapturing = false;
    } else {
      tryTimes++;
      if (tryTimes > 10) {
        console.log("time out...");
        return;
      }
      setTimeout(fn, 50);
    }
  };
  setTimeout(fn, 50);
};

/**
 * 播放网络语音
 * 
 * @param {String} audioUrl 语音地址
 */
KQNativeInvoke.playAudioWithUrl = function (audioUrl) {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", audioUrl);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", audioUrl);
  }
};

module.exports = KQNativeInvoke;

cc._RFpop();
},{}],"MsgControl":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd242dsY+hBG5LpL7ZF7Kn6', 'MsgControl');
// scripts\Chat\MsgControl.js

var Socket = require('socket');
var ChatMessage = require('ChatMessage');
var AudioManager = require('AudioManager');

// 用来发送消息的 component
cc.Class({
  'extends': cc.Component,

  properties: {
    bqNode: cc.Node,
    bqNode1: cc.Node,
    btnLanguageNode: cc.Node,
    btnLanguageNode1: cc.Node,
    btnChartNode: cc.Node,
    btnChartNode1: cc.Node,
    textScrollView: cc.Node,
    imageContentNode: cc.Node,

    editBox: cc.EditBox,

    textRecordScrollView: cc.ScrollView,
    textRecordLayout: cc.Layout,

    textPrefab: cc.Prefab,
    chatTextRecordPrefab: cc.Prefab,
    // imagePrefab:cc.Prefab,

    inputNode: cc.Node,

    _userId: null,

    _playerInfos: null, // 记录用户信息
    _chatTextMessageRecords: null },

  // 聊天文本消息记录
  // use this for initialization
  onLoad: function onLoad() {
    this._userId = Socket.instance.userInfo.id;
    this._playerInfos = [];
    this.textContent = this.textScrollView.getComponent(cc.ScrollView).content;
    // this.imageContent = this.imageScrollView.getComponent(cc.ScrollView).content;

    var self = this;

    var textData = AudioManager.instance.chatTexts();
    for (var i = 0; i < textData.length; i++) {
      var item = cc.instantiate(this.textPrefab);
      item.getComponent('cellText').setText(textData[i]);
      item.getComponent('cellText').onSelectAction = function (text) {
        self.onTextClickAction(text);
      };
      this.textContent.h = 1000;
      this.textContent.addChild(item);
    }
  },

  onTextClickAction: function onTextClickAction() {
    var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    this.editBox.string = "";
    this.sendText(text);
  },

  clickEmoji: function clickEmoji(event, emojiName) {
    var string = this.editBox.string;
    this.editBox.string = string + "<" + emojiName + ">";
  },

  clickSend: function clickSend() {
    var string = this.editBox.string || "";
    if (string.length == 0) {
      return;
    }

    this.editBox.string = "";
    this.sendText(string);
  },

  sendText: function sendText() {
    var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    if (text.length == 0) {
      return;
    }

    Socket.sendText(this._userId, text);
    this.dismiss();
  },

  dismiss: function dismiss() {
    this.node.active = false;
  },

  bqAction: function bqAction() {
    this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode1.active = true;
    this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode.active = false;
    this.textScrollView.active = false;
    this.imageContentNode.active = true;
    this.textRecordScrollView.node.active = false;
  },

  textAction: function textAction() {
    this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode.active = false;
    this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode1.active = true;
    this.textScrollView.active = true;
    this.imageContentNode.active = false;
    this.textRecordScrollView.node.active = false;
  },

  chartAction: function chartAction() {
    this.bqNode1.active = this.btnLanguageNode1.active = this.btnChartNode1.active = false;
    this.bqNode.active = this.btnLanguageNode.active = this.btnChartNode.active = true;
    this.textScrollView.active = this.imageContentNode.active = false;
    this.textRecordScrollView.node.active = true;
  },

  addPlayerInfos: function addPlayerInfos(playerInfos) {
    this._playerInfos = this._playerInfos || [];

    playerInfos.forEach((function (userInfo) {
      var haveUserInfo = this._playerInfos.find(function (ownUserInfo) {
        return ownUserInfo.id == userInfo.id;
      });

      if (haveUserInfo == null) {
        this._playerInfos.push(userInfo);
      }
    }).bind(this));
  },

  addChatTextMessage: function addChatTextMessage(userId, text) {
    this._playerInfos = this._playerInfos || [];

    var nickname = "[ID:" + userId + "说]：";
    var userInfo = this._playerInfos.find(function (userInfo) {
      return userInfo.id == userId;
    });

    if (userInfo) {
      nickname = "[" + userInfo.nickname + "说]：";
    }

    var str = nickname + text;
    str = ChatMessage.parseString(str);
    this._addChatTextToRecord(str);
  },

  _addChatTextToRecord: function _addChatTextToRecord(text) {
    var item = cc.instantiate(this.chatTextRecordPrefab);
    var chatTextRecord = item.getComponent('ChatTextRecord');
    chatTextRecord.setString(text);

    this.textRecordLayout.node.addChild(item);
    this.textRecordScrollView.scrollToBottom();
  }
});

cc._RFpop();
},{"AudioManager":"AudioManager","ChatMessage":"ChatMessage","socket":"socket"}],"NetworkError":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c99d35Sy6hDPbrte9nVczxP', 'NetworkError');
// scripts\NetworkError.js

'use strict';

var manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    exitAction: function exitAction() {
        cc.director.end();
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
    }

});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"NumberExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '80e21gZRpNM4pIiCpZ+7s8m', 'NumberExtension');
// scripts\Extensions\NumberExtension.js

"use strict";

// number.kq_times(f)   调用多次


if (!Number.prototype.kq_times) {

    /**
     * 调用一个方法 this 次
     * 
     * @param  {Function} f 要调用的方法
     * @param  {Object}   thisArg   可选； f 的 this值
     */
    Number.prototype.kq_times = function (f, thisArg) {
        if (!f) {
            return;
        }

        for (var i = 0; i < this; ++i) {
            if (thisArg) {
                f.apply(thisArg, i);
            } else {
                f(i);
            }
        }
    };
}

cc._RFpop();
},{}],"Playback":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0d3095dnBVFo5D1hEDDa5KQ', 'Playback');
// scripts\Playback\Playback.js

var Socket = require('socket');

// 用于回放的组件
var Playback = cc.Class({
  "extends": cc.Component,

  properties: {
    _playbackDatas: null, // 用于回放的数据
    _isPlaybacking: false
  },

  statics: {
    instance: null
  },

  onLoad: function onLoad() {
    Playback.instance = this;
    cc.game.addPersistRootNode(this.node);
  },

  // 设置回放数据
  setPlaybackDatas: function setPlaybackDatas(datas) {
    this._playbackDatas = datas;
  },

  // 清空回放数据。同时会清空回放
  removePlaybackDatas: function removePlaybackDatas() {
    this.setPlaybackDatas(null);
    this.stopPlayback();
  },

  // 是否包含回放数据
  isContainPlaybackDatas: function isContainPlaybackDatas() {
    return this._playbackDatas != null;
  },

  // 开始回放
  startPlayback: function startPlayback() {
    // 模拟 socket 接收到了事件即可
    cc.log("Playback 开始回放");

    this._isPlaybacking = true;

    if (!this._playbackDatas) {
      cc.error("想回放，却没有回放数据");
      this.stopPlayback();
      return;
    }

    this._executePlayback();
  },

  // 停止回放
  stopPlayback: function stopPlayback() {
    this._isPlaybacking = false;
    this.unscheduleAllCallbacks();
  },

  // 是否正在回放
  isPlaybacking: function isPlaybacking() {
    return this._isPlaybacking;
  },

  // 执行真正的回放操作
  _executePlayback: function _executePlayback() {
    var startTime = 1.0;
    var interval = 3.0;
    cc.log(this._playbackDatas);

    // 在某些特殊情况下
    // 回放数据里会包含两套 gameOver action
    // 所以需要过滤掉其中一个
    this._playbackDatas = this._playbackDatas.filter((function (string, index) {
      if (index == this._playbackDatas.length - 1) {
        return true;
      }

      return string.indexOf('"action":"gameOver') == -1;
    }).bind(this));

    this._playbackDatas.forEach((function (data, index) {
      var delay = startTime + index * interval;
      if (index == this._playbackDatas.length - 1) {
        // 如果是最后一个，则应该只间隔一秒
        delay = startTime + (index - 1) * interval + 1;
      }

      this.scheduleOnce(function () {
        cc.log("回放开始模拟 Socket 接收到服务器消息, ", index);
        Socket.instance._dispatchResponse(data);
      }, delay);
    }).bind(this));
  }

});

module.exports = Playback;

cc._RFpop();
},{"socket":"socket"}],"Player":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6ffa0O02PFOp78QADTW5zGf', 'Player');
// scripts\Play\Player.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
cc.Class({
  'extends': cc.Component,

  properties: {
    foldCardNode: cc.Node, // 牌盖着时的样子
    foldCardNode1: cc.Node, // 牌盖着时的样子
    cardsBackLayout: cc.Layout, // 13张牌背影，可用来展示发牌动画 含 cardsBack Component
    compareCardsNode: cc.Node, // compareCards   含 CompareCards Component
    userInfoNode: cc.Node, // 包含用户信息 含 userInfo Component
    chatMessageNode: cc.Node, // 聊天消息 包含 ChatMessage Component
    userAvatarNode: cc.Node,
    userSampleInfoNode: cc.Node,
    userId: 0,
    /*#####*/
    teShuPaiLabel: cc.Node,
    cardTypePrefab: cc.Prefab,
    // 用户信息
    // 1、 如果 包含：cardInfo:[]，表明用户已经出牌
    //
    _userInfo: null,
    _deskInfo: null,
    /**/
    playedCompareCardsIndexs: {
      visible: false,
      'default': undefined
    }
    /**/
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.userAvatarNode.on(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
    this.reset();
  },

  onDestroy: function onDestroy() {
    this.userAvatarNode.off(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
  },

  _showUserInfo: function _showUserInfo() {
    this.userSampleInfoNode.getComponent('UserSampleInfo').updateWithUser(this._userInfo);
  },

  reset: function reset() {
    this.foldCardNode.active = false;
    this.foldCardNode1.active = false;
    this.teShuPaiLabel.active = false;
    this.cardsBackLayout.active = false;
    this.compareCardsNode.active = false;
    this.compareCardsNode.getComponent('CompareCards').reset();
  },

  /*####*/
  reset2: function reset2() {
    this.foldCardNode.active = false;
    this.foldCardNode1.active = false;
    this.teShuPaiLabel.active = false;
    this.cardsBackLayout.active = false;
    //this.compareCardsNode.active = false;
    //this.compareCardsNode.getComponent('CompareCards').reset();
  },
  /*#####*/

  updateUserInfoWithUsers: function updateUserInfoWithUsers(users) {
    var user = users.find((function (e) {
      return this.userId == e.id;
    }).bind(this));

    this.updateUserInfo(user);
  },

  updateUserInfo: function updateUserInfo(user) {
    this._userInfo = user;
    this.node.active = user != null;
    this.userInfoNode.active = this.node.active;
    if (!user) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.updateAvatar(user.avatarUrl);
    userInfo.updateNickname(user.nickname);
    userInfo.setOfflineVisible(!user.onlineStatus);

    //if (this._deskInfo && this._deskInfo.cIndex > 0) {
    //  if (UserModelHelper.isPlayedCards(user)) {
    //    this.playCard(user.id);
    //    this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
    //  }
    //}
    /**/
    var cIndex = this._deskInfo.cIndex;
    if (this._deskInfo && cIndex > 0 && this.playedCompareCardsIndexs.indexOf(cIndex) == -1) {
      if (UserModelHelper.isPlayedCards(user)) {
        this.playCard(user.id, user.cardInfo);
        this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
      }
    }
    /**/
  },

  // 更新房主信息
  updateBanker: function updateBanker() {
    var userInfoComp = this.userInfoNode.getComponent('userInfo');
    if (!this._userInfo) {
      userInfoComp.setIsBanker(false);
      return;
    }

    var isBanker = this._userInfo ? this._userInfo.isBanker : false;
    userInfoComp.setIsBanker(isBanker);
  },

  showFangZhuStatus: function showFangZhuStatus(createId) {
    var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

    if (!this.node.active) {
      return;
    }
    if (this._userInfo.id == createId) {
      this.userInfoNode.getComponent('userInfo').setFangZhuNodeVisible(visible);
    }
  },

  /**
   * 更新分数 
   * 
   * @param {Number} score 用户分数、可选
   */
  updateScore: function updateScore(score) {
    if (!score && this._userInfo) {
      score = this._userInfo.totalScore;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.updateScore(score);
  },

  showReadyStatus: function showReadyStatus(userId) {
    var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

    if (!this.node.active) {
      return;
    }

    if (this._userInfo.id == userId) {
      this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(visible);
    }
  },

  /*setDeskInfo: function (deskInfo) {
   this._deskInfo = deskInfo;
   },*/
  updateDeskInfo: function updateDeskInfo(deskInfo) {
    this._deskInfo = deskInfo;

    if (deskInfo && !deskInfo.isCBegin) {
      this.reset();
    }
  },
  /**/

  hideReadyStatus: function hideReadyStatus() {
    this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(false);
  },

  playFaPaiAnimation: function playFaPaiAnimation() {
    cc.log("playFaPaiAnimation");
    if (!this.node.active) {
      return;
    }

    if (UserModelHelper.isPlayedCards(this._userInfo)) {
      return;
    }

    var cardsBack = this.cardsBackLayout.getComponent('cardsBack');
    cardsBack.showPlayCardBacks();
  },

  shouldShowFaPaiAnimation: function shouldShowFaPaiAnimation() {
    return UserModelHelper.isPlayedCards(this._userInfo);
  },

  setUserOnlineStatus: function setUserOnlineStatus(userId) {
    var status = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.setOfflineVisible(status != 1);
  },

  showChatText: function showChatText(userId, message) {
    if (userId != this.userId) {
      return;
    }

    var chatMessage = this.chatMessageNode.getComponent('ChatMessage');
    chatMessage.setString(message);
  },

  // 用户已经出牌，处于三堆盖着牌的状态
  playCard: function playCard(userId, cardInfo) {
    if (this.userId != userId) {
      return;
    }

    this.cardsBackLayout.node.active = false;
    this.compareCardsNode.active = false;
    this.teShuPaiLabel.active = false;
    /*#####如果是特殊牌就显示特殊牌型这四个字在盖着牌的上面*/
    var play = cc.find("Canvas").getComponent("play"); //play组件
    //如果点击了恭喜你页面的确定按钮
    //if(this.compareCardsNode.getComponent("CardTypeCombine").BtnClickGongXiNiComfirm){
    if (cc.moshi != 1) {
      if (play.getIsTeShuPai(this.userId)) {
        this.teShuPaiLabel.active = true;
      } else {
        this.teShuPaiLabel.active = false;
      }
    }
    cc.log(this);
    cc.log('------229');
    if (Playback.instance.isPlaybacking()) {
      //"回放";
      this.foldCardNode1.active = true;
      return;
    }
    this.foldCardNode.active = true;
    this.foldCardNode1.active = true;
    if (this.foldCardNode.name != "foldCardNodeSelf") {
      return;
    }
    for (var i = 0; i < 3; i++) {
      var node = this.foldCardNode.children[i];

      node.removeAllChildren();
      var cardModes = [];
      for (var j = 0; j < cardInfo[i].cards.length; j++) {
        var s = cardInfo[i].cards[j];
        cardModes.push(s);
      }
      cardModes = cardModes.map(function (serCard) {
        return serCard.suit + '_' + serCard.number;
      });
      cardModes.forEach((function (cardName) {
        var cardTypeSprite = cc.instantiate(this.cardTypePrefab);
        if (cc.maPai) {
          var cardMaPai = '3_' + cc.maPai;
          if (cardName == cardMaPai) {
            cardTypeSprite.color = new cc.Color(226, 145, 145);
          }
        }
        if (i == 0) {
          cardTypeSprite.y = 0;
        } else if (i == 1) {
          cardTypeSprite.y = 0;
        } else if (i == 2) {
          cardTypeSprite.y = 9;
        }
        cardTypeSprite.width = 66;
        cardTypeSprite.height = 92;
        cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName);
        node.addChild(cardTypeSprite);
      }).bind(this));
      cc.log(node);
      cc.log(this.foldCardNode);
      cc.log(this.foldCardNode1);
      cc.log('-------239');
    }
    //}
  },

  // 准备好开始比牌
  readyToCompareCards: function readyToCompareCards() {
    this.cardsBackLayout.node.active = false;
    this.compareCardsNode.active = true;
    this.foldCardNode.active = false;
    this.foldCardNode1.active = false;
    this.teShuPaiLabel.active = false;
  },

  // 播放打枪动画
  // @param userId   要主动打枪的用户id
  // @param toUserIndex  挨枪的用户的 index
  playShootAnimation: function playShootAnimation(userId, toUserIndex) {
    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.playShootAnimation(toUserIndex);
  },

  // 播放中枪动画
  playBulletHoleAnimation: function playBulletHoleAnimation(userId) {
    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.playBulletHoleAnimation();
  },

  // 播放全垒打动画
  playHomeRunAimation: function playHomeRunAimation(userId) {
    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.playHomeRunAimation();
  },

  playSpeakAnimation: function playSpeakAnimation(userId) {
    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.playSpeakAnimation();
  },

  nextCompareScore: function nextCompareScore() {
    if (!this.node.active) {
      return 0;
    }

    var score = this.compareCardsNode.getComponent('CompareCards').nextCompareScore();
    return score;
  },

  showNextCompareCards: function showNextCompareCards() {
    if (this.nextCompareScore() <= 0) {
      return;
    }

    this.compareCardsNode.getComponent('CompareCards').showNextCards();
  }
});

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","KQGlobalEvent":"KQGlobalEvent","Playback":"Playback","UserModelHelper":"UserModelHelper","socket":"socket"}],"ResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9b2behcoUlLYL1MIMs+04wI', 'ResultItem');
// scripts\Play\ResultItem.js

var KQCardResHelper = require('KQCardResHelper');
var SpriteHelper = require('SpriteHelper');
var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelNickname: cc.Label,
    labelResultNumber: cc.Label,
    layoutTouDao: cc.Layout,
    layoutZhongDao: cc.Layout,
    layoutWeiDao: cc.Layout,
    layoutTeShu: cc.Layout,

    labelTeShuPaiTitle: cc.Label,

    scoreUnitNode: cc.Node, // 积分
    diamondUnitNode: cc.Node },

  // 钻石
  onLoad: function onLoad() {},

  //{"id":100049,"nickname":"imya","openId":"xx","avatarUrl":"xx","sex":1,
  // "cardNumber":3,"onlineStatus":1,"inviteCode":"","ipAddress":"::ffff:222.244.65.201",
  // "lastLoginTime":"2017-04-13 22:09:01","createAt":"2017-04-11 22:39:30",
  // "updateAt":"2017-04-13 22:09:01",
  // "cards":[],"roomId":"598883","readyStatus":true,"totalScore":0,
  // "cScore":0,"isBanker":false}
  updateWithPlayerInfo: function updateWithPlayerInfo(playerInfo) {
    var isRandomRoom = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];

    SpriteHelper.setImageUrl(this.avatarSprite, playerInfo.avatarUrl);
    this.labelNickname.string = playerInfo.nickname;
    //cc.log(this.labelResultNumber.string)
    //cc.log(playerInfo)
    //cc.log(playerInfo.cScore)
    //cc.log('---36')
    this.labelResultNumber.string = playerInfo.cScore;

    this.scoreUnitNode.active = !isRandomRoom;
    this.diamondUnitNode.active = isRandomRoom;
    var Number = playerInfo.cScore;
    if (isRandomRoom) {
      // 如果是随机场的话，则显示钻石数量
      Number = playerInfo.cScore * 5;
    }
    this.labelResultNumber.string = Number;
  },

  setCards: function setCards(cards) {
    cc.assert(cards.length == 13);

    // 不会再有特殊牌了
    /*if (KQCard.isTeShuPai(cards)) {
      this.setTeShuCards(cards);
      return;
      }
    */

    //let touCards = cards.slice(0, 3);
    //let zhongCards = cards.slice(3, 3 + 5);
    //let weiCards = cards.slice(8);
    //this.setTouCards(touCards);
    //this.setZhongCards(zhongCards);
    //this.setWeiCards(weiCards);
  }

});
/*setTouCards: function (cards) {
  this._setCardsToLayout(this.layoutTouDao, cards);
},
 setZhongCards: function (cards) {
  this._setCardsToLayout(this.layoutZhongDao, cards);
},
  setWeiCards: function (cards) {
  this._setCardsToLayout(this.layoutWeiDao, cards);
},*/

//结算  将特殊牌放入Layout
/*setTeShuCards: function (cards) {
  this.layoutTeShu.node.active = true;
  this.layoutTouDao.node.active = false;
  this.layoutZhongDao.node.active = false;
  this.layoutWeiDao.node.active = false;
  this._setCardsToLayout(this.layoutTeShu, cards);
   let typeName = KQCard.cardsTypeName(cards);
  this.labelTeShuPaiTitle.string = typeName;
},*/

//结算将牌放到Layout里面
/*_setCardsToLayout: function (layout, cards) {
  let node = layout.node;
  node.children.forEach(function (spriteNode, index) {
    let sprite = spriteNode.getComponent('cc.Sprite');
    let card = cards[index];
    if (!card) {
      return;
    }
     KQCardResHelper.setCardSpriteFrame(sprite, card.cardName());
  });
},*/

cc._RFpop();
},{"KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","SpriteHelper":"SpriteHelper"}],"Setting":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3ad6mNk4BMBZzipGQDNlr4', 'Setting');
// scripts\Setting\Setting.js

'use strict';

var Manager = require('manager');

cc.Class({
  extends: cc.Component,

  properties: {
    musicSlider: cc.Node,
    effectSlider: cc.Node,
    btnSwitchAccount: cc.Button,

    _audioManager: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._audioManager = cc.find('AudioManager') || {};
    this._audioManager = this._audioManager.getComponent('AudioManager');

    this._initSliders();
  },

  _initSliders: function _initSliders() {
    this._initSliderEvents();

    var musicVal = Manager.getMusicValue();
    var effectVal = Manager.getMusicEffectValue();

    this._audioManager.setBgMusicVolumn(musicVal);
    this._audioManager.setEffectMusicVolum(effectVal);

    this.musicSlider.getComponent('slider').setValue(musicVal);
    this.effectSlider.getComponent('slider').setValue(effectVal);
  },

  _initSliderEvents: function _initSliderEvents() {
    var self = this;
    this.musicSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicValue(value);
      self._audioManager.setBgMusicVolumn(value);
    };

    this.effectSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicEffectValue(value);
      self._audioManager.setEffectMusicVolum(value);
    };
  },

  clickSwitch: function clickSwitch() {},

  hideSwitch: function hideSwitch() {
    if (this.btnSwitchAccount) {
      this.btnSwitchAccount.node.active = false;
    }
  }
});

cc._RFpop();
},{"manager":"manager"}],"SpriteHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '936f2uPA8NAuqUZv0R8ZxgP', 'SpriteHelper');
// scripts\Extensions\SpriteHelper.js

"use strict";

var SpriteHelper = {
  setImageUrl: function setImageUrl(sprite, url) {
    if (url.endsWith("png") || url.endsWith("jpg") || url.endsWith("gif")) {} else {
      url = url + ".png";
    }

    cc.loader.load(url, function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      sprite.spriteFrame = frame;
    });
  }
};

module.exports = SpriteHelper;

cc._RFpop();
},{}],"StringExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7b106eQ/I5F1J85hMxFBIlw', 'StringExtension');
// scripts\Extensions\StringExtension.js

'use strict';

// 给 String 添加功能

// str.startsWith("");
// str.endsWith("");

if (!String.prototype.startsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`

		var defineProperty = function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		}();
		var toString = {}.toString;
		var startsWith = function startsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var position = arguments.length > 1 ? arguments[1] : undefined;
			// `ToInteger`
			var pos = position ? Number(position) : 0;
			if (pos != pos) {
				// better `isNaN`
				pos = 0;
			}
			var start = Math.min(Math.max(pos, 0), stringLength);
			// Avoid the `indexOf` call if no match is possible
			if (searchLength + start > stringLength) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'startsWith', {
				'value': startsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.startsWith = startsWith;
		}
	})();
}

// str.endsWith("");
if (!String.prototype.endsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`

		var defineProperty = function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		}();
		var toString = {}.toString;
		var endsWith = function endsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var pos = stringLength;
			if (arguments.length > 1) {
				var position = arguments[1];
				if (position !== undefined) {
					// `ToInteger`
					pos = position ? Number(position) : 0;
					if (pos != pos) {
						// better `isNaN`
						pos = 0;
					}
				}
			}
			var end = Math.min(Math.max(pos, 0), stringLength);
			var start = end - searchLength;
			if (start < 0) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'endsWith', {
				'value': endsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.endsWith = endsWith;
		}
	})();
}

cc._RFpop();
},{}],"TotalGameResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1c6f93a1BOnoSiX6kJ0Efn', 'TotalGameResultItem');
// scripts\Play\TotalGameResultItem.js

"use strict";

var SpriteHelper = require('SpriteHelper');
cc.Class({
  extends: cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelUserId: cc.Label,
    labelScore: cc.Label,
    labelNickname: cc.Label,

    _deskInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setUserInfo: function setUserInfo(user, deskInfo) {
    if (!user) {
      return;
    }

    var totalScore = user.totalScore;
    if (deskInfo && (deskInfo.setting1 == 0 || deskInfo.setting1 == 1)) {
      var baseScore = deskInfo.setting1 == 0 ? 100 : 200;
      totalScore = totalScore - baseScore;
    }

    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);
    this.labelUserId.string = "" + user.id;
    this.labelScore.string = totalScore > 0 ? "+ " + totalScore : "- " + totalScore * -1;
    if (totalScore == 0) {
      this.labelScore.string = "0";
    }
    this.labelNickname.string = user.nickname;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"TotalGameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f7fb2e7foJFNJzjdtbAtk7O', 'TotalGameResult');
// scripts\Play\TotalGameResult.js

var KQNativeInvoke = require('KQNativeInvoke');
cc.Class({
    'extends': cc.Component,

    properties: {
        itemLayout: cc.Layout,
        itemPrefab: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setPlayerInfos: function setPlayerInfos(playerInfos, deskInfo) {
        this.itemLayout.node.removeAllChildren();
        playerInfos.forEach((function (user) {
            var item = cc.instantiate(this.itemPrefab);
            item.getComponent('TotalGameResultItem').setUserInfo(user, deskInfo);
            if (deskInfo.createId == user.id) {
                item.children[6].active = true;
            } else {
                item.children[6].active = false;
            }
            this.itemLayout.node.addChild(item);
        }).bind(this));
    },

    clickShareWeiChat: function clickShareWeiChat() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
        } else {
            //Android
            KQNativeInvoke.screenshotShare();
        }
    },

    clickSharePengYouQuan: function clickSharePengYouQuan() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
        }
    }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke"}],"UserModelHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98854aScapF5oQnHKxJsvmF', 'UserModelHelper');
// scripts\ModelUtils\UserModelHelper.js

"use strict";

var UserModelHelper = {
  // 用户是否已出牌
  isPlayedCards: function isPlayedCards(user) {
    cc.assert(user);

    if (user && user.cardInfo && user.cardInfo.length > 0) {
      return true;
    }

    return false;
  },

  // 用户是否已准备
  isUserReady: function isUserReady(user) {
    return user.readyStatus == true;
  }
};

module.exports = UserModelHelper;

cc._RFpop();
},{}],"UserSampleInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3a9f7A0IgRGPrAZvy1p9s4i', 'UserSampleInfo');
// scripts\Play\UserSampleInfo.js

var SpriteHelper = require('SpriteHelper');

cc.Class({
  'extends': cc.Component,

  properties: {
    labelUserId: cc.Label,
    labelUserIP: cc.Label,
    labelNickname: cc.Label,
    avatarSprite: cc.Sprite,
    manSprite: cc.Sprite,
    womenSprite: cc.Sprite,

    _didShowUserInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  updateWithUser: function updateWithUser(user) {
    if (!user) {
      return;
    }

    if (this._didShowUserInfo == user) {
      this.unscheduleAllCallbacks();
      this._disappearUserInfo();
      return;
    }

    this._didShowUserInfo = user;
    if (!this.node.active) {
      this.node.getComponent('alert').alert();
    }

    this.unscheduleAllCallbacks();
    this.scheduleOnce((function () {
      this._disappearUserInfo();
    }).bind(this), 5);

    this.labelUserId.string = "UID:\n" + user.id;
    this.labelUserIP.string = "用户IP:\n" + user.ipAddress.replace("::ffff:", "");
    this.labelNickname.string = user.nickname;
    this.avatarSprite.spriteFrame = null;
    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);

    var sex = user.sex; // sex: 1 男  2 女
    this.manSprite.node.active = sex == 1;
    this.womenSprite.node.active = sex != 1;
  },

  _disappearUserInfo: function _disappearUserInfo() {
    this.node.active = false;
    this._didShowUserInfo = null;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"agreement":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8f601dzNnZLtq+KGT0uqDqF', 'agreement');
// scripts\agreement.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');
cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        agreement: {
            'default': null,
            type: cc.Label
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        cc.log('----61');
        cc.log(this.agreement);
    },
    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (!response.result) {
            return;
        }
        var s = cc.find('Canvas/agreement');
        var data = response.data;
        //this._info1 = response.data;
        cc.log(this.agreement);
        cc.log(s);
        cc.log('----61');
        this.agreement.string = data.info1 || "";
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"alert":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16cd2qs73lByZaHhJkQAEee', 'alert');
// scripts\alert.js

var AudioManager = require('AudioManager');
cc.Class({
  'extends': cc.Component,

  properties: {
    // foo: {
    //    default: null,      // The default value will be used only when the component attaching
    //                           to a node for the first time
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    popNode: cc.Node,
    label: cc.Label,

    _alertCallback: null,
    _willDismissCallback: null,
    _dismissCallback: null,
    _confirmCallback: null, // 点击确定后的回调
    _tishi: null,
    _card_num: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  alert: function alert() {
    this.node.active = true;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },
  /*#####弹出结果*/
  alertResult: function alertResult() {
    this.node.active = true;
    cc.find("Canvas/show_result").active = false;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },

  /*#####点击确定*/
  playBtnClickSFX: function playBtnClickSFX() {
    AudioManager.instance.playBtnClickSFX();
  },

  /*#####点击取消*/
  palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
    AudioManager.instance.palyBtnCancelClickSFX();
  },

  /*#####点击关闭或者按键之类的按钮，播放音效*/
  palyBtnPublicSFX: function palyBtnPublicSFX() {
    AudioManager.instance.palyBtnPublicSFX();
  },

  /*#####点击创建房间，播放音效*/
  palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
    AudioManager.instance.palyBtnCreateRoomSFX();
  },
  /*#####点击创建房间，播放音效*/
  palyWindowSFX: function palyWindowSFX() {
    AudioManager.instance.palyWindowSFX();
  },

  palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
    AudioManager.instance.palyWeiXinLoginSFX();
  },
  palyFangPaiSFX: function palyFangPaiSFX() {
    AudioManager.instance.palyFangPaiSFX();
  },

  dismissAction: function dismissAction() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
  },

  /*#####隐藏结果页面*/
  dismissActionResult: function dismissActionResult() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
    cc.find("Canvas/show_result").active = true;
  },

  dismissComplete: function dismissComplete() {
    this.node.active = false;

    if (this.onDismissComplete) {
      this.onDismissComplete();
    }

    if (this._dismissCallback) {
      this._dismissCallback(this.node);
    }
  },
  dismissPlay: function dismissPlay() {
    cc.director.loadScene("hall");
  },

  onDismissComplete: function onDismissComplete() {
    cc.log("onDismissComplete");
  },

  doneAction: function doneAction() {
    this.dismissAction();
    this.onDoneAction();

    var confirmCallback = this._confirmCallback;
    if (confirmCallback) {
      confirmCallback(this.node);
    }
  },

  onDoneAction: function onDoneAction() {},

  setMessage: function setMessage(msg) {
    this.label.string = msg;
  },

  getMessage: function getMessage() {
    return this.label.string;
  },

  setAlertCallbck: function setAlertCallbck(callback) {
    this._alertCallback = callback;
  },

  setWillDismissCallback: function setWillDismissCallback(callback) {
    this._willDismissCallback = callback;
  },

  setDismissCallback: function setDismissCallback(callback) {
    this._dismissCallback = callback;
  },

  setConfirmCallback: function setConfirmCallback(callback) {
    this._confirmCallback = callback;
  }

});
/*setMessage: function (message) {
  this.label.getComponent('cc.Label').string = message;
},*/

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"AudioManager":"AudioManager"}],"cardsBack":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98986IsXIdHiqLGEVIG2CWP', 'cardsBack');
// scripts\cardsBack.js

"use strict";

// 牌背影列表 component
// 可以显示、隐藏牌背影列表
cc.Class({
  extends: cc.Component,

  properties: {
    cardsBackLayout: cc.Layout,
    cardsBackList: [cc.Sprite]
  },

  // use this for initialization
  onLoad: function onLoad() {},

  // 以动画的方式显示牌背影
  showPlayCardBacks: function showPlayCardBacks() {
    cc.log("显示牌背影");
    this.hideCardBacks();
    this.cardsBackLayout.node.active = true;

    var interval = 0.05;
    var startTime = 0;
    this.cardsBackList.forEach(function (cardBack) {
      this.scheduleOnce(function () {
        cardBack.node.active = true;
      }, startTime);
      startTime = startTime + interval;
    }.bind(this));
  },

  // 隐藏显示牌背影
  hideCardBacks: function hideCardBacks() {
    this.cardsBackLayout.node.active = false;
    this.cardsBackList.forEach(function (cardBack) {
      cardBack.node.active = false;
    });
  }
});

cc._RFpop();
},{}],"cards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0fcbct/TBxC742saKLuFviQ', 'cards');
// scripts\cards.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        /*牌花色*/
        spadesImages: [cc.SpriteFrame],
        heartsImages: [cc.SpriteFrame],
        clubImages: [cc.SpriteFrame],
        diamondImages: [cc.SpriteFrame]
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"cellText":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9c9fd3OxWNEp4rijfjJv05t', 'cellText');
// scripts\cellText.js

"use strict";

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        labelMsg: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setText: function setText(text) {
        this.labelMsg.getComponent(cc.Label).string = text;
    },

    clickAction: function clickAction() {
        var text = this.labelMsg.getComponent(cc.Label).string;
        this.onSelectAction(text);
    },

    onSelectAction: function onSelectAction(msg) {}

});

cc._RFpop();
},{}],"checkSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '974a0c6jzZPRI5AeaAb4U0z', 'checkSelect');
// scripts\checkSelect.js

cc.Class({
    "extends": cc.Component,

    properties: {
        selectedIndex: 0,
        selectedNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selected = true;
        this.selectedIndex = 0;
        this.selectedNode.active = true;
    },
    clickAction: function clickAction(e, data) {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        this.selectedIndex = this.selected ? 0 : null;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"choujiang":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f64e0whLhNLmbOHtPpK94CG', 'choujiang');
// scripts\choujiang.js

var socket = require("socket");
cc.Class({
    "extends": cc.Component,

    properties: {
        option: {
            "default": [],
            type: cc.Node
        }
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickBtnchoujiang: function clickBtnchoujiang() {
        for (var i = 0; i < this.option.length; i++) {
            this.option[i].opacity = 255;
        }
        var index = 0;
        this._tishi = this.node.getChildByName("choujiang_bg").getChildByName("tishi");
        this._card_num = cc.find("Canvas/user/shop_bg/card_num");
        var comp = this._card_num.getComponent(cc.Label);
        this.callback = function () {
            if (index == 0) {
                this.option[index].opacity = 128;
                this.option[this.option.length - 1].opacity = 255;
            } else if (index == 1) {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            } else {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            }
            index++;
            if (index == this.option.length) {
                index = 0;
            }
        };
        if (comp.string < 20) {
            this._tishi.active = true;
        } else {
            //choujiang
            this.schedule(this.callback, 0.05);
            this.schedule(function () {
                this.unschedule(this.callback);
                for (var i = 0; i < this.option.length; i++) {
                    this.option[i].opacity = 255;
                }
                var i = Math.floor(Math.random() * 12);
                this.option[i].opacity = 128;
            }, 3, 0, 1);
        }
    },

    //***
    clickBtnComfirm: function clickBtnComfirm() {
        this._tishi.active = false;
        //this.node.active = false;
    }
});
//****

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"socket":"socket"}],"fecha":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e517077l0xMarB9uQsXGzvk', 'fecha');
// scripts\Extensions\fecha.js

'use strict';

(function (main) {
  'use strict';

  /**
   * Parse or format dates
   * @class fecha
   */

  var fecha = {};
  var token = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g;
  var twoDigits = /\d\d?/;
  var threeDigits = /\d{3}/;
  var fourDigits = /\d{4}/;
  var word = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;
  var literal = /\[([^]*?)\]/gm;
  var noop = function noop() {};

  function shorten(arr, sLen) {
    var newArr = [];
    for (var i = 0, len = arr.length; i < len; i++) {
      newArr.push(arr[i].substr(0, sLen));
    }
    return newArr;
  }

  function monthUpdate(arrName) {
    return function (d, v, i18n) {
      var index = i18n[arrName].indexOf(v.charAt(0).toUpperCase() + v.substr(1).toLowerCase());
      if (~index) {
        d.month = index;
      }
    };
  }

  function pad(val, len) {
    val = String(val);
    len = len || 2;
    while (val.length < len) {
      val = '0' + val;
    }
    return val;
  }

  var dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  var monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  var monthNamesShort = shorten(monthNames, 3);
  var dayNamesShort = shorten(dayNames, 3);
  fecha.i18n = {
    dayNamesShort: dayNamesShort,
    dayNames: dayNames,
    monthNamesShort: monthNamesShort,
    monthNames: monthNames,
    amPm: ['am', 'pm'],
    DoFn: function DoFn(D) {
      return D + ['th', 'st', 'nd', 'rd'][D % 10 > 3 ? 0 : (D - D % 10 !== 10) * D % 10];
    }
  };

  var formatFlags = {
    D: function D(dateObj) {
      return dateObj.getDate();
    },
    DD: function DD(dateObj) {
      return pad(dateObj.getDate());
    },
    Do: function Do(dateObj, i18n) {
      return i18n.DoFn(dateObj.getDate());
    },
    d: function d(dateObj) {
      return dateObj.getDay();
    },
    dd: function dd(dateObj) {
      return pad(dateObj.getDay());
    },
    ddd: function ddd(dateObj, i18n) {
      return i18n.dayNamesShort[dateObj.getDay()];
    },
    dddd: function dddd(dateObj, i18n) {
      return i18n.dayNames[dateObj.getDay()];
    },
    M: function M(dateObj) {
      return dateObj.getMonth() + 1;
    },
    MM: function MM(dateObj) {
      return pad(dateObj.getMonth() + 1);
    },
    MMM: function MMM(dateObj, i18n) {
      return i18n.monthNamesShort[dateObj.getMonth()];
    },
    MMMM: function MMMM(dateObj, i18n) {
      return i18n.monthNames[dateObj.getMonth()];
    },
    YY: function YY(dateObj) {
      return String(dateObj.getFullYear()).substr(2);
    },
    YYYY: function YYYY(dateObj) {
      return dateObj.getFullYear();
    },
    h: function h(dateObj) {
      return dateObj.getHours() % 12 || 12;
    },
    hh: function hh(dateObj) {
      return pad(dateObj.getHours() % 12 || 12);
    },
    H: function H(dateObj) {
      return dateObj.getHours();
    },
    HH: function HH(dateObj) {
      return pad(dateObj.getHours());
    },
    m: function m(dateObj) {
      return dateObj.getMinutes();
    },
    mm: function mm(dateObj) {
      return pad(dateObj.getMinutes());
    },
    s: function s(dateObj) {
      return dateObj.getSeconds();
    },
    ss: function ss(dateObj) {
      return pad(dateObj.getSeconds());
    },
    S: function S(dateObj) {
      return Math.round(dateObj.getMilliseconds() / 100);
    },
    SS: function SS(dateObj) {
      return pad(Math.round(dateObj.getMilliseconds() / 10), 2);
    },
    SSS: function SSS(dateObj) {
      return pad(dateObj.getMilliseconds(), 3);
    },
    a: function a(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0] : i18n.amPm[1];
    },
    A: function A(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0].toUpperCase() : i18n.amPm[1].toUpperCase();
    },
    ZZ: function ZZ(dateObj) {
      var o = dateObj.getTimezoneOffset();
      return (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4);
    }
  };

  var parseFlags = {
    D: [twoDigits, function (d, v) {
      d.day = v;
    }],
    Do: [new RegExp(twoDigits.source + word.source), function (d, v) {
      d.day = parseInt(v, 10);
    }],
    M: [twoDigits, function (d, v) {
      d.month = v - 1;
    }],
    YY: [twoDigits, function (d, v) {
      var da = new Date(),
          cent = +('' + da.getFullYear()).substr(0, 2);
      d.year = '' + (v > 68 ? cent - 1 : cent) + v;
    }],
    h: [twoDigits, function (d, v) {
      d.hour = v;
    }],
    m: [twoDigits, function (d, v) {
      d.minute = v;
    }],
    s: [twoDigits, function (d, v) {
      d.second = v;
    }],
    YYYY: [fourDigits, function (d, v) {
      d.year = v;
    }],
    S: [/\d/, function (d, v) {
      d.millisecond = v * 100;
    }],
    SS: [/\d{2}/, function (d, v) {
      d.millisecond = v * 10;
    }],
    SSS: [threeDigits, function (d, v) {
      d.millisecond = v;
    }],
    d: [twoDigits, noop],
    ddd: [word, noop],
    MMM: [word, monthUpdate('monthNamesShort')],
    MMMM: [word, monthUpdate('monthNames')],
    a: [word, function (d, v, i18n) {
      var val = v.toLowerCase();
      if (val === i18n.amPm[0]) {
        d.isPm = false;
      } else if (val === i18n.amPm[1]) {
        d.isPm = true;
      }
    }],
    ZZ: [/([\+\-]\d\d:?\d\d|Z)/, function (d, v) {
      if (v === 'Z') v = '+00:00';
      var parts = (v + '').match(/([\+\-]|\d\d)/gi),
          minutes;

      if (parts) {
        minutes = +(parts[1] * 60) + parseInt(parts[2], 10);
        d.timezoneOffset = parts[0] === '+' ? minutes : -minutes;
      }
    }]
  };
  parseFlags.dd = parseFlags.d;
  parseFlags.dddd = parseFlags.ddd;
  parseFlags.DD = parseFlags.D;
  parseFlags.mm = parseFlags.m;
  parseFlags.hh = parseFlags.H = parseFlags.HH = parseFlags.h;
  parseFlags.MM = parseFlags.M;
  parseFlags.ss = parseFlags.s;
  parseFlags.A = parseFlags.a;

  // Some common format strings
  fecha.masks = {
    default: 'ddd MMM DD YYYY HH:mm:ss',
    shortDate: 'M/D/YY',
    mediumDate: 'MMM D, YYYY',
    longDate: 'MMMM D, YYYY',
    fullDate: 'dddd, MMMM D, YYYY',
    shortTime: 'HH:mm',
    mediumTime: 'HH:mm:ss',
    longTime: 'HH:mm:ss.SSS'
  };

  /***
   * Format a date
   * @method format
   * @param {Date|number} dateObj
   * @param {string} mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'
   */
  fecha.format = function (dateObj, mask, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof dateObj === 'number') {
      dateObj = new Date(dateObj);
    }

    if (Object.prototype.toString.call(dateObj) !== '[object Date]' || isNaN(dateObj.getTime())) {
      throw new Error('Invalid Date in fecha.format');
    }

    mask = fecha.masks[mask] || mask || fecha.masks['default'];

    var literals = [];

    // Make literals inactive by replacing them with ??
    mask = mask.replace(literal, function ($0, $1) {
      literals.push($1);
      return '??';
    });
    // Apply formatting rules
    mask = mask.replace(token, function ($0) {
      return $0 in formatFlags ? formatFlags[$0](dateObj, i18n) : $0.slice(1, $0.length - 1);
    });
    // Inline literal values back into the formatted value
    return mask.replace(/\?\?/g, function () {
      return literals.shift();
    });
  };

  /**
   * Parse a date string into an object, changes - into /
   * @method parse
   * @param {string} dateStr Date string
   * @param {string} format Date parse format
   * @returns {Date|boolean}
   */
  fecha.parse = function (dateStr, format, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof format !== 'string') {
      throw new Error('Invalid format in fecha.parse');
    }

    format = fecha.masks[format] || format;

    // Avoid regular expression denial of service, fail early for really long strings
    // https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
    if (dateStr.length > 1000) {
      return false;
    }

    var isValid = true;
    var dateInfo = {};
    format.replace(token, function ($0) {
      if (parseFlags[$0]) {
        var info = parseFlags[$0];
        var index = dateStr.search(info[0]);
        if (!~index) {
          isValid = false;
        } else {
          dateStr.replace(info[0], function (result) {
            info[1](dateInfo, result, i18n);
            dateStr = dateStr.substr(index + result.length);
            return result;
          });
        }
      }

      return parseFlags[$0] ? '' : $0.slice(1, $0.length - 1);
    });

    if (!isValid) {
      return false;
    }

    var today = new Date();
    if (dateInfo.isPm === true && dateInfo.hour != null && +dateInfo.hour !== 12) {
      dateInfo.hour = +dateInfo.hour + 12;
    } else if (dateInfo.isPm === false && +dateInfo.hour === 12) {
      dateInfo.hour = 0;
    }

    var date;
    if (dateInfo.timezoneOffset != null) {
      dateInfo.minute = +(dateInfo.minute || 0) - +dateInfo.timezoneOffset;
      date = new Date(Date.UTC(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0));
    } else {
      date = new Date(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0);
    }
    return date;
  };

  /* istanbul ignore next */
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = fecha;
  } else if (typeof define === 'function' && define.amd) {
    define(function () {
      return fecha;
    });
  } else {
    main.fecha = fecha;
  }
})(undefined);

cc._RFpop();
},{}],"game":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45811N61jFFA6UrygQla5+x', 'game');
// scripts\game.js

'use strict';

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        messageNode: cc.Node,
        playNode: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {},

    showMessageAlert: function showMessageAlert() {
        this.messageNode.active = true;
        var comp = this.messageNode.getComponent(cc.Animation);
        comp.play('pop');
    },

    dismissMessageAlert: function dismissMessageAlert() {
        var self = this;
        this.scheduleOnce(function () {
            self.messageNode.active = false;
        }, 0.3);
    }

});

cc._RFpop();
},{}],"hall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1e6741Q2VFGDLupV88mg60Z', 'hall');
// scripts\hall.js

var manager = require('manager');
var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var Playback = require('Playback');

var hall = cc.Class({
    'extends': cc.Component,

    properties: {

        productNodes: [cc.Node],
        shopAlertNode: cc.Node,
        createNode: cc.Node,
        joinNode: cc.Node,
        invitNode: cc.Node,
        hasCode: cc.Node,
        gengxin: cc.Node,
        alertPrefab: cc.Prefab,
        tsSingleSelect: [cc.Node], //创建房间信息，单选
        tsCheckSeclect: [cc.Node], //创建房间信息，复选
        selectMoShi: cc.Node, //创建房间信息，模式（庄家模式和无特殊牌）
        selectGuiPai: cc.Node, //创建房间信息，模式（庄家模式和无特殊牌）
        labelNotice: cc.Label, // 公告
        labelBanner: cc.Label, // banner label
        shareAlertNode: cc.Node,
        shareAlertNode1: cc.Node,
        shareAlertNodeBg: cc.Node,
        shareAlertButton: cc.Button,
        recordNode: cc.Node,
        waitingPrefab: cc.Prefab,
        //用户信息
        avatarNode: cc.Node,
        nickNameLabel: cc.Label,
        cardNumberLabel: cc.Label,
        userIdLabel: cc.Label,
        codeLabel: cc.Label,
        // userInfoMsgNode:cc.Node,
        //退出
        exitNode: cc.Node,
        logoutNode: cc.Node,
        //战绩
        recordMsgNode: cc.Node,
        feedbackEditBox: cc.EditBox, //反馈
        feedbackNode: cc.Node,

        _userId: 0,
        _openId: null,
        _help: null,
        _close: null,
        iosUrl: null,
        aUrl: null

    },

    statics: {
        lastHallInfo: null, // 上一次收到的大厅信息
        cacheImageInfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        cc.from = {};
        cc.from.isUseMa = true;
        cc.from.ma = 0;
        cc.isRoomViewShow = false;
        this._btn = this.node.getChildByName("btn");
        this._buttons = this.node.getChildByName("buttons");
        AudioManager.instance.playMusic();
        Playback.instance.removePlaybackDatas();

        hall.cacheImageInfo = hall.cacheImageInfo || {};

        this._registerSocketEvent();
        this._startBannerAnimation();
        this._initJoinRoom();
        this._initInvit();

        this._userId = Socket.instance.userInfo.id;
        this._openId = Socket.instance.userInfo.openId;
        this._inviteCode = Socket.instance.userInfo.inviteCode; //邀请码
        //cc.log(this._inviteCode,"邀请码---------------------");
        if (this._inviteCode) {
            //邀请码处理
            this.codeLabel.string = "CODE：" + this._inviteCode;
            this.hasCode.active = true;
            this.invitNode.active = false;
        } else {
            this.hasCode.active = false;
            this.invitNode.active = true;
            this.codeLabel.string = '';
        }

        var self = this;

        for (var i = 0; i < this.productNodes.length; i++) {
            var comp = this.productNodes[i].getComponent('product');
            comp.onClickAction = function (productId) {};
        }
        this.socket = cc.find('GameSocket').getComponent('socket');
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
        };

        this.socket.connectionSuccess = function () {
            self.hiddenNetworkMessage();
            self.hiddenCheckMessage();
        };
        this.socket.connectionDisconnect = function () {
            self.showNetworkMessage('网络链接断开，重新连接中...');
        };
        this.socket.checkNetworkNow = function () {
            self.showCheckMessage('检查网络中...');
        };
        this.socket.checkNetworkEnd = function () {
            self.hiddenCheckMessage();
            self.hiddenNetworkMessage();
        };

        //  /*设置用户信息*/
        this.updateUserInfo();
        /*刷新用户信息*/
        Socket.sendGetUserInfo(this._userId, this._openId);
        /*定时刷新用户信息*/
        this.schedule((function () {
            Socket.sendGetUserInfo(this._userId, this._openId);
        }).bind(this), 10); //10s一次

        Socket.sendGetHallInfo(this.socket.userInfo.id);
        //hall.lastHallInfo = cc._loginInfo;
        if (hall.lastHallInfo) {
            this.updateBanner(hall.lastHallInfo.info);
            this.updateNotice(hall.lastHallInfo.broadcast);
            //this.labelBanner.string = hall.lastHallInfo.info;
            //this.labelNotice.string = hall.lastHallInfo.broadcast;
        }
        cc.onShareWXResp = this._shareResult.bind(this);
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
        this.socket.connectionSuccess = function () {};
        this.socket.connectionDisconnect = function () {};
        this.socket.checkNetworkNow = function () {};
        this.socket.checkNetworkEnd = function () {};

        KQGlobalEvent.offTarget(this);
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.JoinDesk, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveCreateDesk, this._createRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGetUserInfo, this._socketReceiveUserInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        KQGlobalEvent.on(Socket.Event.ReceiveInviteCode, this._socketReceiveInviteCode, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        KQGlobalEvent.on(Socket.Event.ReceiveSharePng, this._socketSharePng, this);
    },
    //接受邀请码数据
    _socketReceiveInviteCode: function _socketReceiveInviteCode(response) {
        var inviteCode = response.data;
        //cc.log(inviteCode,"------------ 邀请码 ------------");
        if (inviteCode) {
            //邀请码处理
            this._inviteCode = inviteCode;
            this.codeLabel.string = "CODE：" + inviteCode;
            this.hasCode.active = true;
            this.invitNode.active = false;
        } else {
            this.alertMessage("输入的邀请码不存在");
            this.hasCode.active = false;
            this.invitNode.active = true;
            this.codeLabel.string = '';
        }
    },

    _startBannerAnimation: function _startBannerAnimation() {
        var anim = this.labelBanner.getComponent(cc.Animation);
        anim.play('banner');
    },

    _initJoinRoom: function _initJoinRoom() {
        var self = this;
        var joinRoom = this.joinNode.getComponent('joinRoom');

        joinRoom.callbackJoinRoom = function (number) {
            self.joinNode.getComponent('alert').dismissAction();
            self.showWaitingMessage('加入中...');
            self.scheduleOnce(function () {
                self.hiddenWaitingMessage();
            }, 2.0);

            /*加入房间请求*/
            var userId = Socket.instance.userInfo.id;
            Socket.sendJoinDesk(number, userId);
        };
    },

    _initInvit: function _initInvit() {
        //var self = this;
        //let Invit = this.invitNode.getComponent('Invit');

        // Invit.callbackJoinRoom = function (number) {
        //     self.invitNode.getComponent('alert').dismissAction();
        //     self.scheduleOnce(function() {
        //         self.hiddenWaitingMessage();
        //     }, 2.0);
        //     cc.log(number)
        //     cc.log('------191')
        //     let userId = Socket.instance.userInfo.id;
        // };
    },

    _jiinRoomSocketCallback: function _jiinRoomSocketCallback(response) {
        var _this = this;

        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            (function () {
                if (cc.from == null) {
                    cc.from = {};
                }
                var joinRoom = _this.joinNode.getComponent('joinRoom');

                _this.joinNode.getComponent('alert').setAlertCallbck(function () {
                    joinRoom.clickClear();
                });
                cc.from.ma = response.data.maPai;
                cc.director.loadScene('play');
            })();
        } else {
            var reasonInfo = this._joinReasonMap(response.data.reason);
            this.alertMessage(reasonInfo);
        }
    },

    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!response.result) {
            return;
        }
        var data = response.data;
        hall.lastHallInfo = data;

        var isIOS = data.isIOS;
        var isAndroid = data.isA;
        var vIOS = data.vIOS;
        var vA = data.vA;
        this.iosUrl = data.iosUrl;
        this.aUrl = data.aUrl;

        if (KQNativeInvoke.isNativeIOS()) {
            if (isIOS == 1) {
                if (vIOS != '1.0.1') {
                    this.gengxin.active = true;
                }
            }
        } else {
            //Android
            if (isAndroid == 1) {
                if (vA != '1.0.1') {
                    this.gengxin.active = true;
                }
            }
        }

        var notice = data.broadcast;
        var banner = data.info;
        this.updateNotice(notice);
        this.updateBanner(banner);
    },
    downloadNewVersion: function downloadNewVersion() {
        if (KQNativeInvoke.isNativeIOS()) {
            cc.sys.openURL(this.iosUrl);
            // jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", this.iosUrl);
        } else {
                //Android
                cc.sys.openURL(this.aUrl);
                // jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", this.aUrl);
            }
    },
    _createRoomSocketCallback: function _createRoomSocketCallback(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            cc.director.loadScene('play');
        }
        /*如果钻石不足，则提示*/
        else {
                this.alertMessage("您的钻石不足");
            }
    },

    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };

        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    /*shop*/
    shopAction: function shopAction() {
        var comp = this.shopAlertNode.getComponent('alert');
        comp.alert();
    },
    /*提示*/
    alertMessage: function alertMessage(msg) {
        var node = cc.instantiate(this.alertPrefab);
        this.node.addChild(node);
        var comp = node.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    updateNotice: function updateNotice(notice) {
        if (this.labelNotice == null) {
            return;
        }
        this.labelNotice.string = notice || "";
    },

    updateBanner: function updateBanner() {
        var banner = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (this.labelBanner == null) {
            return;
        }
        this.labelBanner.string = banner;
    },

    /*
    createDoneAction:function() {
        var info = {};
        var key = ['setting1','setting2','setting3','setting4'];
        for (var i = 0; i < this.tsSingleSelect.length; i++) {
            var tsIndex =  this.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;
            info[key[i]] = tsIndex;
        }
        info['userId'] = this.socket.userInfo.id;
        this.socket.sendMessage('createDesk',info);
         this.createNode.getComponent('alert').dismissAction();
         let self = this;
        this.showWaitingMessage('创建中...');
        this.scheduleOnce(function() {
            self.hiddenWaitingMessage();
        }, 2.0);
    },
    */
    /*#####
    * setting1 局数  (0 | 1 | 2)
    * setting2 人数  (0 | 1 | 2 |3)
    * setting3 玩法  (0 | 1)
    * setting4 AA制收取房费  (null | 0)
    * setting5 马牌   （null | 0 | 1 | 2）
    * setting6 打枪计分 (0 | 1)
    * setting7 多一色  (null | 0)
    * */
    createDoneAction: function createDoneAction() {
        var info = {};
        //单选
        var key = ['setting1', 'setting2', 'setting6'];
        for (var i = 0; i < this.tsSingleSelect.length; i++) {
            var tsIndex = this.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;
            info[key[i]] = tsIndex;
        }
        //可选可不选
        var key1 = ['setting4', 'setting7'];
        for (var i = 0; i < this.tsCheckSeclect.length - 1; i++) {
            var tsCheckIndex = this.tsCheckSeclect[i].getComponent('checkSelect').selectedIndex;
            info[key1[i]] = tsCheckIndex;
        }
        if (cc.from.isUseMa && cc.from.ma == null) {
            cc.from.ma = 0;
        }
        if (cc.from.isUseMa) {
            info['setting5'] = cc.from.ma;
        }
        //setting3 selectMoShiIndex为 ：null || 0 || 1
        var selectMoShiIndex = this.selectMoShi.getComponent('selectMoShi').selectIndex;
        info['setting3'] = selectMoShiIndex;

        var selectMoShiIndex = this.selectGuiPai.getComponent('selectMoShi').selectIndex;
        //info['setting8'] = selectMoShiIndex;
        info['setting8'] = null;
        //用户Id
        info['userId'] = this.socket.userInfo.id;

        if (info['setting6'] == 0) {
            info['setting6'] = 1;
        } else {
            info['setting6'] = 0;
        }
        if (info['setting2'] == 3) {
            //五人场必须多一色
            info['setting7'] = 0;
        }
        info['setting7'] = null;
        console.log("打印出创建房间信息");
        console.log(info);
        //return;
        this.socket.sendMessage('createDesk', info);

        this.createNode.getComponent('alert').dismissAction();

        var self = this;
        this.showWaitingMessage('创建中...');
        this.scheduleOnce(function () {
            self.hiddenWaitingMessage();
        }, 2.0);
    },

    // 随机场
    /*clickRandRoom: function () {
      cc.director.loadScene('randRoom');
    },*/

    clickShare: function clickShare() {
        this.shareAlertNode.getComponent('alert').alert();
    },

    clickShare1: function clickShare1() {
        this.shareAlertNode1.getComponent('alert').alert();
    },

    clickRecord: function clickRecord() {
        var comp = this.recordNode.getComponent('alert');
        comp.alert();
        Socket.sendGetRecrod(Socket.instance.userInfo.id);
    },

    clickPlayRule: function clickPlayRule() {
        //cc.director.loadScene('rule');
        this.help = this.node.getChildByName("help");
        var comp = this.help.getComponent('alert');
        comp.alert();
    },

    /*share*/
    shareToFriend: function shareToFriend() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallFriend");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallFriend", "()V");
        }
    },

    shareToTimeline: function shareToTimeline() {
        this.shareAlertNode.getComponent('alert').dismissAction();
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", "()V");
        }
    },
    //点击分享
    shareToTimelinePng: function shareToTimelinePng() {

        this.shareAlertNodeBg.active = true;
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
        } else {
            //Android
            KQNativeInvoke.screenshotShare("shareIMGTimeline");
        }
        this.scheduleOnce((function () {
            this.shareAlertNodeBg.active = false;
        }).bind(this), 0.01); //10s一次
    },
    //点击分享返回值 1：成功  0：已经领取
    _socketSharePng: function _socketSharePng(data) {
        this.shareAlertNodeBg.active = false;
        var self = this;
        var sting;
        if (data.data == 1) {
            Socket.sendGetUserInfo(this._userId, this._openId);
            sting = '分享成功！';
            //this.scheduleOnce(function(){
            self.showCheckMessage(sting);
            //}.bind(this),0.5);//10s一次
            this.scheduleOnce((function () {
                self.hiddenCheckMessage();
            }).bind(this), 2); //10s一次
        } else {
                sting = '今天已经分享了！';
                self.showCheckMessage(sting);
                this.scheduleOnce((function () {
                    self.hiddenCheckMessage();
                }).bind(this), 1.5); //10s一次
            }
    },

    _shareResult: function _shareResult() {
        if (this.shareAlertNode1.active == false) {
            return;
        }
        Socket.sendSharePng(this._userId);
    },

    clickExit: function clickExit() {
        var comp = this.exitNode.getComponent('alert');
        comp.alert();
    },
    /*切换账号*/
    clickCancelLation: function clickCancelLation() {
        this.logoutNode.getComponent('alert').alert();
    },

    logoutAction: function logoutAction() {
        manager.setUserInfo('');
        cc.director.loadScene('login');

        hall.cacheImageInfo = null;
    },

    exitAction: function exitAction() {
        manager.setUserInfo('');
        if (!cc.sys.isNative) {
            cc.director.loadScene('login');
            hall.cacheImageInfo = null;
            return;
        }

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
        cc.director.end();
    },

    //接收处理用户数据
    _socketReceiveUserInfo: function _socketReceiveUserInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!this.socket.userInfo) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }
        this.nickNameLabel.string = response.data.nickname;
        this.userIdLabel.string = 'ID: ' + response.data.id;
        this.cardNumberLabel.string = response.data.cardNumber;
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load(response.data.avatarUrl + ".jpg", function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });
    },

    _socketDisconnect: function _socketDisconnect() {
        this.showNetworkMessage("网络链接断开，重新连接中...");
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    //更新用户信息
    updateUserInfo: function updateUserInfo() {
        var info = this.socket.userInfo;
        if (!info) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }

        this.nickNameLabel.string = info.nickname;
        this.userIdLabel.string = 'ID: ' + info.id;
        this.cardNumberLabel.string = info.cardNumber;

        var avatarUrl = info.avatarUrl + ".jpg";
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        var texture = hall.cacheImageInfo[avatarUrl];
        if (texture) {
            var frame = new cc.SpriteFrame(texture);
            if (frame) {
                cc.log("从缓存中加载头像");
                sprite.spriteFrame = frame;
                return;
            }
        }

        cc.loader.load(info.avatarUrl + ".jpg", function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;

                hall.cacheImageInfo[avatarUrl] = tex;
            }
        });
    },

    /*提交意见*/
    feedbackAcion: function feedbackAcion() {
        var userId = this.socket.userInfo.id;
        var text = this.feedbackEditBox.string;
        if (text.length > 0) {
            this.feedbackNode.getComponent('alert').dismissAction();
            Socket.sendFeedback(userId, text);
            this.feedbackEditBox.string = '';
        }
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.sys.isObjectValid(this.waitingNode)) {
            this.waitingNode.destory();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    //network
    showNetworkMessage: function showNetworkMessage(msg) {
        if (this.networkNode && this.networkNode.active) {
            var _alert = this.networkNode.getComponent('alert');
            if (_alert.getMessage() == msg) {
                return;
            }
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage(msg) {
        if (!(this.checkNode && this.checkNode.active)) {} else {
            var _alert2 = this.checkNode.getComponent('alert');
            if (_alert2.getMessage() == msg) {
                return;
            }
        }

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },
    onBtnClick: function onBtnClick() {
        if (this._buttons.active) {
            this._buttons.active = false;
        } else {
            this._buttons.active = true;
        }
    }

});

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },
module.exports = hall;

cc._RFpop();
},{"AudioManager":"AudioManager","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","manager":"manager","socket":"socket"}],"help":[function(require,module,exports){
"use strict";
cc._RFpush(module, '09981CwNMZOI4DHUg8u9kcj', 'help');
// scripts\help.js

cc.Class({
    "extends": cc.Component,
    properties: {
        /*sprites: {
            default: null,
            type: cc.SpriteAtlas
        },*/
        play_method_before: cc.Node, //玩法介绍
        play_method_content_label: cc.Node, //玩法介绍内容
        introduce_pai_before: cc.Node, //牌型介绍
        details: cc.Node, //牌型介绍内容
        caozuo_before: cc.Node, //操作介绍
        caozuo_content: cc.Node, //操作介绍内容
        _btn: null,
        _content: null,
        _buttonCom: null,
        _play_method_button: null,
        _introduce_pai_button: null,
        _caozuo_button: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._play_method_button = this.play_method_before.getComponent(cc.Button);
        this._introduce_pai_button = this.introduce_pai_before.getComponent(cc.Button);
        this._caozuo_button = this.caozuo_before.getComponent(cc.Button);
        this._btn = [this.play_method_before, this.introduce_pai_before, this.caozuo_before];
        this._content = [this.play_method_content_label, this.details, this.caozuo_content];
        this._buttonCom = [this._play_method_button, this._introduce_pai_button, this._caozuo_button];
        //刚开始牌型介绍的按钮不可用
        this._buttonCom[1].interactable = false;
    },
    // 点击玩法介绍
    onBtnPlayMethodClick: function onBtnPlayMethodClick() {
        for (var i = 0; i < 3; i++) {
            //所有按钮设置为可用
            this._buttonCom[i].interactable = true;
            //所有的内容都隐藏掉
            this._content[i].active = false;
        }
        //当前点击的设置为不可用
        this._buttonCom[0].interactable = false;
        //当前点击的对应的内容可见
        this._content[0].active = true;
    },
    //点击牌型介绍
    onBtnIntroducePaiClick: function onBtnIntroducePaiClick() {
        for (var i = 0; i < 3; i++) {
            //所有按钮设置为可用
            this._buttonCom[i].interactable = true;
            //所有的内容都隐藏掉
            this._content[i].active = false;
        }
        //当前点击的设置为不可用
        this._buttonCom[1].interactable = false;
        //当前点击的对应的内容可见
        this._content[1].active = true;
    },
    //点击操作介绍
    onBtnCaozuoClick: function onBtnCaozuoClick() {
        for (var i = 0; i < 3; i++) {
            //所有按钮设置为可用
            this._buttonCom[i].interactable = true;
            //所有的内容都隐藏掉
            this._content[i].active = false;
        }
        //当前点击的设置为不可用
        this._buttonCom[2].interactable = false;
        //当前点击的对应的内容可见
        this._content[2].active = true;
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"inviteCode":[function(require,module,exports){
"use strict";
cc._RFpush(module, '777f9/eB7RKK4aO7FmNYFgO', 'inviteCode');
// scripts\inviteCode.js

/**
 * 邀请码
 * @authors 黄成(you@example.org)
 * @date    2017-06-16 09:44:10
 * @version $Id$
 */
var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackInviteCode: ''
  },

  onLoad: function onLoad() {
    this.clickClear(); //清除数字
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
      cc.log(label.string, "----------------");
    } else {
      return;
    }
    var isComplete = this._lastEmptyLabel() == null;
    cc.log("isComplete-------------", this.callbackInviteCode);
    var inviteNumber = this._inviteNumber();

    if (inviteNumber.length == 6) {
      cc.log(inviteNumber, "--------------------38"); //邀请码
      var userId = Socket.instance.userInfo.id;
      //Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = inviteNumber;
    }
  },
  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackInviteCode;
    //cc.log(inviteNumber,"--------------------38")
    if (inviteNumber && inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = ''; //清空邀请码
    }
  },
  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _inviteNumber: function _inviteNumber() {
    return this.labelNumbers.reduce(function (inviteNumber, label) {
      //cc.log(inviteNumber,"-----------------");
      return inviteNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"joinRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd5dcb9CJvpPJpnsCQ/q197x', 'joinRoom');
// scripts\joinRoom.js

cc.Class({
  "extends": cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }

    var isComplete = this._lastEmptyLabel() == null;
    if (isComplete && this.callbackJoinRoom) {
      var roomNumber = this._roomNumber();
      // cc.log("要加入的房间号是：", roomNumber);
      this.callbackJoinRoom(roomNumber);
    }
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{}],"launch":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0efb2ngHglDtK2A+W4dmfzt', 'launch');
// scripts\launch.js

'use strict';

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.scheduleOnce(function () {
            cc.director.loadScene('login');
        }, 0.5);
    }

});

cc._RFpop();
},{}],"login":[function(require,module,exports){
(function (Buffer){
"use strict";
cc._RFpush(module, '9c72dn88ytPxZWrZRaxt5cr', 'login');
// scripts\login.js

var manager = require('manager');
var KQCard = require('KQCard');
var Socket = require('socket');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');

cc.Class({
    'extends': cc.Component,

    properties: {
        selectNode: cc.Node,
        alertPrefab: cc.Prefab,
        canvasNode: cc.Node,
        //agreement: {
        //    default: null,
        //    type: cc.Label
        //},
        vLabel: cc.Label,
        scroll_View: {
            'default': null,
            type: cc.ScrollView
        },
        agreementLabel: cc.Label,
        agreementNode: cc.Node,
        waitingPrefab: cc.Prefab
    },

    goUpdateAction: function goUpdateAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod("AppController", "downloadNewVersion:", this.iosUrl);
        } else {
            //Android
            jsb.reflection.callStaticMethod("com/lling/ssz/AppActivity", "downloadNewVersion", "(Ljava/lang/String;)V", this.androidUrl);
        }
    },

    checkVersion: function checkVersion(vData) {
        //var version = vData.version;
        cc.info1 = vData.version;
        this.iosUrl = vData.iosUrl;
        this.androidUrl = vData.androidUrl;
        //if (manager.version != version) {//更新版本
        //    this.versionEnable = false;
        //    this.goUpdateAction();
        //    //this.versionLabel.string = '请到服务器更新到最新版本';
        //}
        //else {
        //this.versionLabel.string = '当前版本 ' + manager.version;
        this.versionEnable = true;
        var self = this;
        var info = manager.getUserInfo();
        if (info.length == 0) {
            this.loginEnable = true;
        }
        this.scheduleOnce(function () {
            if (info.length > 0) {
                this.loginEnable = true;
                self.loginAction();
            }
        }, 0.5);
        //}
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.scroll_View.scrollToTop();
        KQGlabolSocketEventHander.start();
        var self = this;
        this.loginEnable = false;
        this.socket = cc.find('GameSocket').getComponent('socket');
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
            if (data.action == 'checkVersion') {
                self.checkVersion(data.data);
            } else if (data.action == 'login') {
                if (data.result) {
                    //成功
                    self.socket.userInfo = data.data; //运行时态信息
                    //cc.log(JSON.stringify(data));
                    //cc.log(data.data);
                    //cc.log(data.data.roomId);
                    //cc.log(data.data.roomId.length);
                    //cc.log('----76');
                    if (data.data.roomId.length > 0) {
                        self.scheduleOnce(function () {
                            cc.director.preloadScene('hall');
                            cc.director.loadScene('play');
                        }, 1);
                    } else {
                        self.scheduleOnce(function () {
                            cc.director.preloadScene('play');
                            cc.director.loadScene('hall');
                        }, 1);
                    }
                } else {
                    self.alertMessage('登录失败!');
                }
            }
        };

        //从本地调
        this.socket.getWxInfo = function (info) {
            manager.setUserInfo(info); //保存本地
            var data = JSON.parse(info); //str -> json(obj)
            self.scheduleOnce(function () {
                //延迟执行 1s
                self.sendLoginRequest(data); //登录请求
            }, 1);
        };
        //debug
        var testData = '{"openid":"oJ752t_0-D7ieMcQPR1m7khElguQ0011","nickname":"imya","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/BVyz4R8q6puJibEv1hrsaTmIKQhkaTS9FyvcevvC5hlxFnfOuspDjicG0GtzyJXOhNT7g1WZDeCDQhnRdEOgz3QMnP0F9iboQGy\/0","privilege":[]}';
        if (!cc.sys.isNative && window.location) {
            var search = window.location.search;
            if (search) {
                var url;
                var loc;

                (function () {
                    var query = search.substring(1);
                    var attrs = query.split('&');
                    var obj = JSON.parse(testData);

                    url = window.location.search;
                    loc = url.substring(url.lastIndexOf('=') + 1, url.length);

                    if (loc == 1) {
                        obj.openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjEzJw==';
                        obj.nickname = loc;
                    } else if (loc == 2) {
                        obj.openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjM4OjMzJw==';
                        obj.nickname = loc;
                    } else if (loc == 3) {
                        obj.openid = 'JzIwMTctNi0xNiAwOTo0NTo1OSc=';
                        obj.nickname = loc;
                    } else if (loc == 4) {
                        obj.openid = 'JzIwMTcvNi8xNiDkuIrljYg5OjQ2OjAwJw==';
                        obj.nickname = loc;
                    } else if (loc == 5) {
                        obj.openid = 'JzIwMTcvNi8xNiDkuIrljYgxMDowMzowOCc=';
                        obj.nickname = loc;
                    }

                    attrs.forEach(function (attr) {
                        var keyValueArr = attr.split('=');
                        var key = keyValueArr[0];
                        var value = keyValueArr[1];
                        obj[key] = value;
                    });

                    testData = JSON.stringify(obj);
                })();
            }
        }

        if (!cc.sys.isNative) {
            manager.setUserInfo(testData);
        }
        //if (KQNativeInvoke.isNativeIOS()) {
        //    this.vLabel.string = cc._loginInfo.vIOS || "";
        //} else if (KQNativeInvoke.isNativeAndroid()) {//Android
        //    this.vLabel.string = cc._loginInfo.vA || "";
        //}
        //cc.log(cc._loginInfo)
        //cc.log('---139')
    },

    agreements: function agreements() {
        this.agreementNode.active = true;
        //this.agreementLabel.string = cc.info1;
        this.agreementLabel.node.y = 0;
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
    },

    sendLoginRequest: function sendLoginRequest(data) {
        this.showWaitingMessage('登录中...');
        this.socket.sendMessage('login', data);
    },

    loginAction: function loginAction() {
        var comp = this.selectNode.getComponent('select');
        if (!comp.selected) {
            this.showMsg = cc.instantiate(this.alertPrefab);
            this.canvasNode.addChild(this.showMsg);
            var _comp = this.showMsg.getComponent('alert');
            _comp.setMessage('请同意用户协议');
            return;
        }

        var info = manager.getUserInfo();
        if (info.length > 0) {
            var data = JSON.parse(info);
            this.sendLoginRequest(data);
            return;
        }

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
        } else if (KQNativeInvoke.isNativeAndroid()) {
                //Android
                jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
            }
    },

    loginYkAction: function loginYkAction() {
        var comp = this.selectNode.getComponent('select');
        if (!comp.selected) {
            this.showMsg = cc.instantiate(this.alertPrefab);
            this.canvasNode.addChild(this.showMsg);
            var _comp2 = this.showMsg.getComponent('alert');
            _comp2.setMessage('请同意用户协议');
            return;
        }
        var testDate = new Date();
        var time = "'" + testDate.toLocaleString() + "'";
        var openid = new Buffer(time).toString('base64');
        var testData = '{"openid":"' + openid + '","nickname":"游客","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/BVyz4R8q6puJibEv1hrsaTmIKQhkaTS9FyvcevvC5hlxFnfOuspDjicG0GtzyJXOhNT7g1WZDeCDQhnRdEOgz3QMnP0F9iboQGy\/0","privilege":[]}';
        //if (!cc.sys.isNative && window.location) {
        var search = '  ';
        if (search) {
            (function () {
                var query = search.substring(1);
                var attrs = query.split('&');
                var obj = JSON.parse(testData);
                attrs.forEach(function (attr) {
                    var keyValueArr = attr.split('=');
                    var key = keyValueArr[0];
                    var value = keyValueArr[1];
                    obj[key] = value;
                });
                testData = JSON.stringify(obj);
            })();
        }
        //}

        //var info = manager.getUserInfo();
        //if (info.length > 0) {
        var data = JSON.parse(testData);
        this.sendLoginRequest(data);
        //    return;
        //}else{
        manager.setUserInfo(testData);
        //}
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.isValid(this.waitingNode)) {
            if (msg == this.waitingNode.getComponent('alert').getMessage()) {
                return;
            }

            this.waitingNode.removeFromParent();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.canvasNode.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    protocolAction: function protocolAction() {
        cc.log('protocol action');
    }
});

cc._RFpop();
}).call(this,require("buffer").Buffer)

},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","buffer":2,"manager":"manager","socket":"socket"}],"maPai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8b896xHkCtE1IzD8BDK4cWL', 'maPai');
// scripts\Play\maPai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        maPaiSprite: [cc.SpriteFrame],
        spriteNode: cc.Sprite,
        labelNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"manager":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4a47fj0J/VHup24OT7njkko', 'manager');
// scripts\manager.js

'use strict';

module.exports = {
    version: 'v1.0.0',

    setUserInfo: function setUserInfo(str) {
        cc.sys.localStorage.setItem('userinfo', str);
    },

    getUserInfo: function getUserInfo() {
        var value = cc.sys.localStorage.getItem('userinfo');
        if (!value) {
            return "";
        }
        return value;
    },

    setMusicValue: function setMusicValue(value) {
        cc.sys.localStorage.setItem('musicVolumn', value);
    },

    getMusicValue: function getMusicValue() {
        var value = cc.sys.localStorage.getItem('musicVolumn');
        if (!value) {
            return 1;
        }
        return value;
    },

    setMusicEffectValue: function setMusicEffectValue(value) {
        cc.sys.localStorage.setItem('musicEffectVolumn', value);
    },

    getMusicEffectValue: function getMusicEffectValue() {
        var value = cc.sys.localStorage.getItem('musicEffectVolumn');
        if (!value) {
            return 1;
        }
        return value;
    }
};

cc._RFpop();
},{}],"play":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16c65H2Pw9PBaQSvw69LGLQ', 'play');
// scripts\play.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var Manager = require('manager');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var fecha = require('fecha');
/*#####*/
var KQCard = require('KQCard');
/**/
var Player = require('Player');
/**/
//const isTeShuPai = require('isTeShuPai');
//特殊牌类型
var TESHUPAITYPE = {
    isTeShuPai: false,
    isLiuDuiBan: false,
    isSanShunZi: false,
    isSanTaoHua: false,

    isQingLong: false,
    isYiTiaoLong: false,
    isSanTongHuaShun: false,
    isSanFenTianXia: false,
    isCouYiSe: false,
    isSiTaoSanTiao: false,
    isWuDuiSanTiao: false
};

var GAMESTATUS = {
    WAIT_PEOPLE: 0, // 等人
    WAIT_READY: 1, // 等待他人准备
    PLAYING: 2 };

// 布局
//          2
//   3            1
//     self 0
// 正在玩游戏
var Play = cc.Class({
    'extends': cc.Component,

    properties: {
        playerNodes: [cc.Node],
        chatNode: cc.Node,
        cardTypeCombineNode: cc.Node,
        /*#####*/
        typeButtonsNode: cc.Node,
        /*#####*/

        labelRoomNumber: cc.Label,
        labelOverview: cc.Label,
        labelRemainTime: cc.Label,
        btnShare: cc.Button,
        btnReady: cc.Button, // 准备开始按钮
        fapaiNode: cc.Node,
        btnChatVoice: cc.Button,
        btnChatText: cc.Button,
        startCompareCardsNode: cc.Node,
        voiceRecordAnimationNode: cc.Node,
        settingNode: cc.Node,
        playbackNode: cc.Node,

        oneGameResult: cc.Node, // 一局结果
        totalGameResult: cc.Node,

        alertRequestExitNode: cc.Node, // 申请退出 Node
        alertRequestExitCountdownNode: cc.Node, // 申请退出倒计时 Node
        btnAlertRequestExitConfirmButton: cc.Button,
        btnAlertRequestExitCancelButton: cc.Button,
        btnButtonNode: cc.Node,
        btnButtons: cc.Node,

        alertAnsowerExitNode: cc.Node, // 回答申请退出  Node
        alertAnsowerExitCountdownNode: cc.Node, // 回答以上请退出的倒计时

        alert: cc.Node,

        alertForceExitNode: cc.Node, // 强制退出 Node

        waitingPrefab: cc.Prefab,
        /**/
        playerComps: [Player],
        /**/
        /*#####*/
        teshupai_min: [cc.Node],
        teshupai_max: [cc.Node],
        gongXiNi: cc.Node,
        teShuPai: cc.Node,
        _liuDuiBan: false,
        _sanShunZi: false,
        _sanTongHua: false,
        _yiTiaoLong: false,

        _QingLong: false,
        _SanTongHuaShun: false,
        _SanFenTianXia: false,
        _CouYiSe: false,
        _SiTaoSanTiao: false,
        _WuDuiSanTiao: false,

        wuTong_img: cc.SpriteFrame,
        tongHuaShun_img: cc.SpriteFrame,
        /*#####*/

        _playerComponents: null,
        _msgControl: null,

        _socket: null,
        _userId: 0,
        _playerInfos: null,
        _deskInfo: null, // createTime 创建时间  isDissolving 表示是否正在解散 dissolveLeftTime 离解散剩余多长时间 dissolveAnswerInfo [处理过的人的信息]
        _gameStatus: GAMESTATUS.WAIT_PEOPLE,
        _enterTime: null,
        _players: null,
        /**/
        _isComparingCardsNow: false, // 是否正在比牌
        _playedCompareCardsIndexs: [] },

    // 已经播放过比牌的局数
    /**/
    // use this for initialization
    onLoad: function onLoad() {
        var _this = this;

        this.BtnClickGongXiNiComfirm = this.cardTypeCombineNode.getComponent("CardTypeCombine").BtnClickGongXiNiComfirm;
        this._enterTime = Date.now();
        /**/
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this._playedCompareCardsIndexs;
        });
        /**/
        /*AudioManager.instance.playDeskMusic();*/
        AudioManager.instance.stopHallMusic();
        this._initPlayerComponents();
        this._initSelectCardNode();
        this._initOneGameResult();
        this._remainTimeStartUpdate();

        this._userId = Socket.instance.userInfo.id;
        this._msgControl = this.chatNode.getComponent('MsgControl');

        this.settingNode.getComponent("Setting").hideSwitch();
        this.labelRoomNumber.string = "";
        this.labelRemainTime.node.active = false;

        this._registerVoiceNodeEvents();
        this._registerSocketEvent();

        /*#####*/
        this._initMaPai();
        Play.instances = this;
        this._gongXiNiShow(false);
        /*#####*/
        if (Playback.instance.isContainPlaybackDatas()) {
            Playback.instance.startPlayback();
            this.playbackNode.active = true;
            this.btnChatVoice.node.active = false;
            //this.cardsFromArray.node.active = false;
        } else {
                this._loadDeskInfo();
            }

        this._socket = Socket.instance;

        // this.scheduleOnce(function () {
        //   // this._showOneGameResult();
        //   // this._startCompareCards();
        // }.bind(this), 2);
    },

    /*#####*/
    /*显示马牌*/
    _initMaPai: function _initMaPai() {
        //"mapai"脚本上挂着马牌精灵
        var maPaiCom = this.node.getComponent("maPai");
        var spriteNode = maPaiCom.spriteNode; //马牌精灵节点
        var labelNode = maPaiCom.labelNode; //马牌文字节点
        if (this.maPai != null) {
            labelNode.active = true;
        }
        if (this.maPai == 1) {
            spriteNode.spriteFrame = maPaiCom.maPaiSprite[0];
        } else if (this.maPai == 5) {
            spriteNode.spriteFrame = maPaiCom.maPaiSprite[1];
        } else if (this.maPai == 10) {
            spriteNode.spriteFrame = maPaiCom.maPaiSprite[2];
        } else {
            spriteNode.spriteFrame = null;
            labelNode.active = false;
        }
    },

    _initPlayerComponents: function _initPlayerComponents() {
        this._playerComponents = this.playerNodes.map(function (node) {
            return node.getComponent('Player');
        });
    },

    _initSelectCardNode: function _initSelectCardNode() {
        var self = this;
        var cardTypeCombineComp = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombineComp.setFinishSelectCardsCallback(function (serverCardsInfo) {
            cardTypeCombineComp.reset();
            Socket.sendPlayCard(self._userId, serverCardsInfo);
            self.cardTypeCombineNode.active = false;
        });
    },
    /**/
    _initOneGameResult: function _initOneGameResult() {
        var self = this;
        this.oneGameResult.setCloseCallback = function () {
            if (self._isRandomRoom()) {
                cc.director.loadScene('hall');
            }
        };
    },
    /**/
    //_initOneGameResult: function () {
    //  const self = this;
    //  this.oneGameResult.setCloseCallback = function () {
    //    if (self._isRandomRoom()) {
    //      cc.director.loadScene('hall');
    //    }
    //  };
    //},

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickExit: function clickExit() {
        if (Playback.instance.isPlaybacking()) {
            cc.director.loadScene('hall');
            return;
        }
        /**/
        if (this._deskInfo && this._deskInfo.isDeskOver) {
            if (!this._isComparingCardsNow) {
                // 如果房间已结束，并且不是正在播放打牌动画, 则直接离开房间
                cc.director.loadScene('hall');
            }
            return;
        }
        /**/
        //if (this._isRandomRoom()) {
        //    this.alertForceExitNode.getComponent('alert').alert();
        //    return;
        //}

        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                Socket.sendDissolveDesk(this._userId);
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
            return;
        }

        this.btnAlertRequestExitCancelButton.node.active = true;
        this.btnAlertRequestExitConfirmButton.node.active = true;

        var alert = this.alertRequestExitNode.getComponent('alert');
        alert.unscheduleAllCallbacks();
        alert.setMessage("您在申请协商退出，如果所有玩家同意，您将退出游戏。");
        alert.alert();

        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },

    //点击分享按钮
    clickShare: function clickShare() {
        var roomId = String(this._deskInfo.roomId);
        var description = "金麟十三道 玩法:";
        //+ this._deskInfoGameWay();
        description = description + " " + this._deskInfoNumberOfPeople();
        description = description + "," + this._deskInfoPayInfo();
        //description = description + "," + this._deskInfoJiaYiSeInfo();
        //description = description + "," + this._deskInfoGuiPaiInfo();
        description = description + " " + this._deskInfoNumberOfGame();

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", roomId, description);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", "(Ljava/lang/String;Ljava/lang/String;)V", roomId, description);
        }
    },

    //点击准备按钮
    clickReady: function clickReady() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        /*#####点击准备的时候，上一局比牌的数据消失*/
        this._playerComponents.forEach(function (playerComp) {
            //playerComp.reset();
            playerComp.reset(); //#####
        });
        cc.find("Canvas/show_result").active = false;
        Socket.sendReady(this._userId);
    },

    updateRoomNumber: function updateRoomNumber(roomNumber) {
        var gameNumberString = "";
        if (this._deskInfo.setting1 != 0 && this._deskInfo.setting1 != 1) {
            gameNumberString = "局数 : " + "" + this._deskInfo.cIndex + "/" + this._deskInfo.mMax;
        } else if (this._deskInfo.setting1 == 0) {
            gameNumberString = "局数 : 10局";
        } else if (this._deskInfo.setting1 == 1) {
            gameNumberString = "局数 : 20局";
        }
        this.labelRoomNumber.string = "房号 : " + "" + roomNumber + "\n" + gameNumberString;
    },

    updateGameStatus: function updateGameStatus() {
        var status = arguments.length <= 0 || arguments[0] === undefined ? GAMESTATUS.WAIT_PEOPLE : arguments[0];

        this._gameStatus = status;

        this.btnShare.node.active = status == GAMESTATUS.WAIT_PEOPLE;
        this.btnReady.node.active = status == GAMESTATUS.WAIT_READY;
        this.isReadyStatus();
        //if (status == GAMESTATUS.PLAYING) {
        //  this._playerComponents.forEach(function(playerComp){
        //    //playerComp.hideReadyStatus();
        //  });
        //}
    },

    gameStatus: function gameStatus() {
        return this._gameStatus;
    },
    isReadyStatus: function isReadyStatus() {
        //console.log(this._playerInfos)
        if (this._playerInfos && this._playerInfos.length > 0) {
            this._playerInfos.forEach((function (playerInfo) {
                var userInfoSelf = cc.find('Canvas/playSelf/userInfoSelf');
                if (playerInfo.id == this._userId) {
                    if (!playerInfo.readyStatus && !this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas()) {
                        userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);
                        if (this._deskInfo.cIndex == 0) {
                            //一局还没开始
                            //if(this._deskInfo.createId != this._userId){////是否是房主
                            this.btnReady.node.active = true;
                            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                                this.btnShare.node.active = true;
                            } else {
                                this.btnShare.node.active = false;
                            }
                            //}else{
                            //    this.btnReady.node.active = false;
                            //}
                        } else {
                                var oneGameResult = this.oneGameResult.getComponent('GameResult');
                                oneGameResult.unscheduleAllCallbacks();
                                oneGameResult.showResults(this._deskInfo, this._userId);
                                this.btnShare.node.active = false;
                                this.btnReady.node.active = false;
                            }
                        console.log("未曾准备");
                    } else {
                        this.btnReady.node.active = false;
                        this.btnShare.node.active = false;
                        cc.find("Canvas/show_result").active = false;
                        if (!this._isComparingCardsNow) {
                            userInfoSelf.getComponent('userInfo').setReadyNodeVisible(true);
                        } else {
                            //userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);
                            this._playerComponents.forEach(function (playerComp) {
                                playerComp.hideReadyStatus();
                            });
                        }
                        console.log("已准备");
                    }
                }
            }).bind(this));
        }
    },
    /// 游戏动画
    _startGame: function _startGame() {
        if (this.gameStatus() == GAMESTATUS.PLAYING) {
            return;
        }
        this._isComparingCardsNow = true;
        this.updateGameStatus(GAMESTATUS.PLAYING);
        this._playFaPaiAnimation();

        if (!UserModelHelper.isPlayedCards(this._findPlayerInfoByUserId(this._userId))) {
            this.scheduleOnce((function () {
                this._showCardTypeCombine();
            }).bind(this), 1.0);

            //let self = this;
            //  //this.fapaiNode.getComponent('alert').alert();
            //  self.fapaiNode.active = true;
            //  var anim = this.fapaiNode.getComponent(cc.Animation);
            //  anim.play('fapai');
            //this.scheduleOnce(function () {
            //  self.fapaiNode.active = false;
            //}, 2.0);
        }
    },

    _playFaPaiAnimation: function _playFaPaiAnimation() {
        this._playerComponents.forEach(function (player) {
            player.playFaPaiAnimation();
        });

        AudioManager.instance.playFaPai();
    },

    /*#####*/
    //是否特殊牌
    isTeShuPai: function isTeShuPai(cards) {
        var result = KQCard.isTeShuPai(cards);
        if (result) {
            TESHUPAITYPE.isTeShuPai = true;
        } else {
            TESHUPAITYPE.isTeShuPai = false;
        }
        return result;
    },
    //是否一条龙
    isYiTiaoLong: function isYiTiaoLong(cards) {
        var result = KQCard.isYiTiaoLong(cards);
        if (result) {
            TESHUPAITYPE.isYiTiaoLong = true;
        } else {
            TESHUPAITYPE.isYiTiaoLong = false;
        }
        return result;
    },
    //是否六对半
    isLiuDuiBan: function isLiuDuiBan(cards) {
        var result = KQCard.isLiuDuiBan(cards);
        if (result) {
            TESHUPAITYPE.isLiuDuiBan = true;
        } else {
            TESHUPAITYPE.isLiuDuiBan = false;
        }
    },
    //是否三顺子
    isSanShunZi: function isSanShunZi(cards) {
        var result = KQCard.isSanShunZi(cards);
        if (result) {
            TESHUPAITYPE.isSanShunZi = true;
        } else {
            TESHUPAITYPE.isSanShunZi = false;
        }
    },
    //是否三同花
    isSanTongHua: function isSanTongHua(cards) {
        var result = KQCard.isSanTongHua(cards);
        if (result) {
            TESHUPAITYPE.isSanTaoHua = true;
        } else {
            TESHUPAITYPE.isSanTaoHua = false;
        }
    },
    //是否三同花顺
    isSanTongHuaShun: function isSanTongHuaShun(cards) {
        var result = KQCard.isSanTongHuaShun(cards);
        if (result) {
            TESHUPAITYPE.isSanTongHuaShun = true;
        } else {
            TESHUPAITYPE.isSanTongHuaShun = false;
        }
    },
    //是否是清龙
    isQingLong: function isQingLong(cards) {
        var result = KQCard.isQingLong(cards);
        if (result) {
            TESHUPAITYPE.isQingLong = true;
        } else {
            TESHUPAITYPE.isQingLong = false;
        }
    },
    //是否是 “三分天下”
    isSanFenTianXia: function isSanFenTianXia(cards) {
        var result = KQCard.isSanFenTianXia(cards);
        if (result) {
            TESHUPAITYPE.isSanFenTianXia = true;
        } else {
            TESHUPAITYPE.isSanFenTianXia = false;
        }
    },
    //是否是 “四套三条”
    isSiTaoSanTiao: function isSiTaoSanTiao(cards) {
        var result = KQCard.isSiTaoSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isSiTaoSanTiao = true;
        } else {
            TESHUPAITYPE.isSiTaoSanTiao = false;
        }
    },
    //是否是五对三条
    isWuDuiSanTiao: function isWuDuiSanTiao(cards) {
        var result = KQCard.isWuDuiSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isWuDuiSanTiao = true;
        } else {
            TESHUPAITYPE.isWuDuiSanTiao = false;
        }
    },
    //是否是凑一色
    isCouYiSe: function isCouYiSe(cards) {
        var result = KQCard.isCouYiSe(cards);
        if (result) {
            TESHUPAITYPE.isCouYiSe = true;
        } else {
            TESHUPAITYPE.isCouYiSe = false;
        }
    },
    /*#####*/

    /*显示配牌页面*/
    _showCardTypeCombine: function _showCardTypeCombine() {
        if (Playback.instance.isPlaybacking()) {
            return;
        }

        if (this.cardTypeCombineNode.active) {
            return;
        }

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombine.reloadCards([]);
        cardTypeCombine.node.active = true;
        cardTypeCombine.timeStart(120); //sd

        var cards = this._findCardsByUserId(this._userId);
        //cards = [{suit: "c", number:20},{suit: "d", number:12}, {suit: "s", number:12},//青龙
        //    {suit: "c", number:12}, {suit: "s", number:10},
        //    {suit: "d", number:10}, {suit: "h", number:8}, {suit: "h", number:6},
        //    {suit: "d", number:6}, {suit: "s", number:5},
        //    {suit: "s", number:2}, {suit: "s", number:2}, {suit: "h", number:2},];
        /*if(this._userId == 1){
            cards = [{suit: "s", number:3},{suit: "s", number:6}, {suit: "s", number:7},//青龙
                {suit: "s", number:9}, {suit: "s", number:13},
                {suit: "h", number:10}, {suit: "h", number:12}, {suit: "h", number:13},
                {suit: "d", number:2}, {suit: "d", number:5},
                {suit: "d", number:3}, {suit: "d", number:7}, {suit: "d", number:8},];
        }
        else if(this._userId == 2){
            cards = [{suit: "s", number:1},{suit: "s", number:2}, {suit: "s", number:2},//青龙
                {suit: "h", number:4}, {suit: "s", number:4},
                {suit: "d", number:6}, {suit: "h", number:6}, {suit: "h", number:9},
                {suit: "c", number:9}, {suit: "s", number:10},
                {suit: "c", number:10}, {suit: "c", number:12}, {suit: "d", number:12},];
        }
        else if(this._userId == 3){
            cards = [{suit: "c", number:1},{suit: "h", number:3}, {suit: "s", number:12},//青龙
                {suit: "h", number:2}, {suit: "c", number:3},
                {suit: "d", number:4}, {suit: "h", number:5}, {suit: "s", number:6},
                {suit: "h", number:8}, {suit: "s", number:8},
                {suit: "s", number:11}, {suit: "s", number:11}, {suit: "h", number:11},];
        }
        else if(this._userId == 4){
            cards = [{suit: "c", number:11},{suit: "d", number:13}, {suit: "d", number:11},//青龙
                {suit: "d", number:1}, {suit: "h", number:1},
                {suit: "c", number:2}, {suit: "s", number:4}, {suit: "s", number:9},
                {suit: "c", number:7}, {suit: "h", number:7},
                {suit: "s", number:5}, {suit: "s", number:5}, {suit: "c", number:5},];
        }
        else if(this._userId == 5){
            cards = [{suit: "d", number:4},{suit: "d", number:13}, {suit: "s", number:13},//青龙
                {suit: "d", number:6}, {suit: "s", number:7},
                {suit: "d", number:8}, {suit: "c", number:9}, {suit: "c", number:10},
                {suit: "s", number:1}, {suit: "s", number:3},
                {suit: "s", number:10}, {suit: "s", number:8}, {suit: "s", number:12},];
        }*/

        var cardNames = this._convertCardsToCardNames(cards);
        cardTypeCombine.reloadCards(cardNames);
        cardTypeCombine.addCardModes(cardNames);

        /*#####发牌完执行*/

        //cards:[{'number':1~13,'suit':'s' | 'h' | 'c' | 'd'}]
        //cc.from.moshi == 0选择了庄家模式
        if (cc.moshi != 1) {
            this.isTeShuPai(cards);
            this.isYiTiaoLong(cards);
            this.isQingLong(cards);
            //this.isLiuDuiBan(cards);
            //this.isSanShunZi(cards);
            //this.isSanTongHua(cards);
            //
            //this.isSanTongHuaShun(cards);
            //this.isSanFenTianXia(cards);
            //this.isSiTaoSanTiao(cards);
            //this.isWuDuiSanTiao(cards);
            //this.isCouYiSe(cards);

            this._showGongXiNiAndBtnTeShuPai();
        }
        cc.teShuPaiCards = '';
        if (TESHUPAITYPE.isTeShuPai) {
            //如果是特殊牌将牌存起来
            cc.teShuPaiCards = cards;
        }

        /*#####*/
    },

    getIsTeShuPai: function getIsTeShuPai(userId) {
        var cards = this._findCardsByUserId(userId);
        return this.isTeShuPai(cards);
    },

    /*#####检测特殊牌类型，显示相对应的恭喜你页面和特殊牌精灵*/
    _showGongXiNiAndBtnTeShuPai: function _showGongXiNiAndBtnTeShuPai() {
        /*如果有特殊牌*/
        if (TESHUPAITYPE.isTeShuPai) {
            if (TESHUPAITYPE.isYiTiaoLong) {
                this._gongXiNiShow(true);
                this._yiTiaoLong = true;
            } else if (TESHUPAITYPE.isQingLong) {
                this._gongXiNiShow(true);
                this._sanTongHua = true;
            }
            //else if(TESHUPAITYPE.isLiuDuiBan){
            //    this._gongXiNiShow(true);
            //    this._liuDuiBan = true;
            //}
            //else if(TESHUPAITYPE.isSanShunZi){
            //    this._gongXiNiShow(true);
            //    this._sanShunZi = true;
            //}
            //else if(TESHUPAITYPE.isSanTaoHua){
            //    this._gongXiNiShow(true);
            //    this._sanTongHua = true;
            //}
            //else if(TESHUPAITYPE.isSanTongHuaShun){
            //    this._gongXiNiShow(true);
            //    this._SanTongHuaShun = true;
            //}
            //else if(TESHUPAITYPE.isSanFenTianXia){
            //    this._gongXiNiShow(true);
            //    this._SanFenTianXia = true;
            //}
            //else if(TESHUPAITYPE.isCouYiSe){
            //    this._gongXiNiShow(true);
            //    this._CouYiSe = true;
            //}
            //else if(TESHUPAITYPE.isSiTaoSanTiao){
            //    this._gongXiNiShow(true);
            //    this._SiTaoSanTiao = true;
            //}
            //else if(TESHUPAITYPE.isWuDuiSanTiao){
            //    this._gongXiNiShow(true);
            //    this._WuDuiSanTiao = true;
            //}
            else {
                    this._gongXiNiShow(false);
                }
        }
        this._initTeShuPaiSprite();
    },

    /*#####控制特殊牌精灵的显示*/
    _initTeShuPaiSprite: function _initTeShuPaiSprite() {
        /*把所有的特殊牌精灵都隐藏掉*/
        for (var i = 0; i < this.teshupai_min.length; i++) {
            this.teshupai_min[i].active = false;
            this.teshupai_max[i].active = false;
        }
        /*如果是一条龙，就显示一条龙的精灵*/
        if (this._yiTiaoLong) {
            this.teshupai_min[3].active = true;
            this.teshupai_max[3].active = true;
        }
        /*如果是六对半就显示六对半的精灵*/
        else if (this._liuDuiBan) {
                this.teshupai_min[0].active = true;
                this.teshupai_max[0].active = true;
            }
            /*如果是三顺子就显示三顺子的精灵*/
            else if (this._sanShunZi) {
                    this.teshupai_min[1].active = true;
                    this.teshupai_max[1].active = true;
                }
                /*如果是三同花，就显示三同花的精灵*/
                else if (this._sanTongHua) {
                        this.teshupai_min[2].active = true;
                        this.teshupai_max[2].active = true;
                    }
                    /*如果是三同花，就显示三同花的精灵*/
                    else if (this._QingLong) {
                            this.teshupai_min[4].active = true;
                            this.teshupai_max[4].active = true;
                        }
                        /*如果是三同花，就显示三同花的精灵*/
                        else if (this._SanTongHuaShun) {
                                this.teshupai_min[5].active = true;
                                this.teshupai_max[5].active = true;
                            }
                            /*如果是三同花，就显示三同花的精灵*/
                            else if (this._SanFenTianXia) {
                                    this.teshupai_min[6].active = true;
                                    this.teshupai_max[6].active = true;
                                }
                                /*如果是三同花，就显示三同花的精灵*/
                                else if (this._CouYiSe) {
                                        this.teshupai_min[7].active = true;
                                        this.teshupai_max[7].active = true;
                                    }
                                    /*如果是三同花，就显示三同花的精灵*/
                                    else if (this._SiTaoSanTiao) {
                                            this.teshupai_min[8].active = true;
                                            this.teshupai_max[8].active = true;
                                        }
                                        /*如果是三同花，就显示三同花的精灵*/
                                        else if (this._WuDuiSanTiao) {
                                                this.teshupai_min[9].active = true;
                                                this.teshupai_max[9].active = true;
                                            }
    },

    /*#####*/
    //显示gongXiNi 页面和teShuPai
    _gongXiNiShow: function _gongXiNiShow(statues) {
        var alterCom = this.gongXiNi.getComponent("alert");
        if (statues) {
            alterCom.alert();
        } else {
            alterCom.dismissAction();
        }

        this.teShuPai.active = statues;
    },
    /*#####*/

    //  结果相关
    // 显示一局结果
    _showOneGameResult: function _showOneGameResult() {
        /**/
        this._isComparingCardsNow = false;
        /**/
        this.updateGameStatus(GAMESTATUS.WAIT_PEOPLE);
        var oneGameResult = this.oneGameResult.getComponent('GameResult');
        oneGameResult.unscheduleAllCallbacks();
        oneGameResult.showResults(this._deskInfo, this._userId);
        this._updateUserScores();
        this._updateBanker();

        var self = this;
        this.scheduleOnce(function () {
            self._playerComponents.forEach(function (playerComp) {
                //playerComp.reset();
                //playerComp.reset2();  //#####
            });

            if (!self._isRandomRoom()) {
                //if (self._deskInfo.cIndex == 0) {//一局还没开始
                //    self.btnReady.node.active = true;
                //}
                if (self._isTotalGameOver()) {
                    self._showTotalGameResult();
                }
            }
        }, 0.5);

        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.scheduleOnce(function () {
                oneGameResult.getComponent('alert').dismissAction();
                cc.director.loadScene('hall');
            }, 2);
            return true;
        }
    },

    // 显示总结果
    _showTotalGameResult: function _showTotalGameResult() {
        var showDelay = arguments.length <= 0 || arguments[0] === undefined ? 2 : arguments[0];

        cc.find("Canvas/show_result").active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.alertAnsowerExitNode.active = false;
        this.alertRequestExitNode.active = false;

        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        totalGameResultComp.setPlayerInfos(this._deskInfo.players, this._deskInfo);

        var alert = this.totalGameResult.getComponent('alert');
        this.scheduleOnce((function () {
            this.oneGameResult.active = false;
            //alert.alert();
            /**/
            if (!this.totalGameResult.active) {
                alert.alert();
            }
            /**/
        }).bind(this), showDelay);

        alert.setDismissCallback(function () {
            cc.director.loadScene('hall');
        });
    },

    // MARK: Socket 相关
    _loadDeskInfo: function _loadDeskInfo() {
        Socket.sendGetDesckInfo(this._userId);
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnlineStatus, this._socketReciveOnlineStatus, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatText, this._socketReciveChatTextMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolve, this._socketReceiveRequestExitMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolveResult, this._socketReceiveRequestExitResultMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveAudioMessage, this._socketReceiveAudioMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceivePlayCard, this._socketReceivePlayCard, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGameOver, this._socketReceiveGameOver, this);
        KQGlobalEvent.on(Socket.Event.ReceiveFaPai, this._socketReciveFaPai, this);
        KQGlobalEvent.on(Socket.Event.ReceiveReady, this._socketReciveReady, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDissolveDesk, this._socketReceiveDissolveDesk, this);
        /**/
        KQGlobalEvent.on(Socket.Event.ReceiveLeaveDesk, this._socketLeaveDesk, this);
        /**/
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._receiveSocketConnectError, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._receiveSocketConnectSuccessed, this);
        KQGlobalEvent.on(Socket.Event.ReceivePause, this._socketReceivePause, this);
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        var data = response.data;
        /*#####添加五同按钮*/
        cc.moshi = response.data.setting3;
        if (data.setting8 != null) {
            cc.moshi = 1;
        }
        cc.maPai = response.data.maPai;
        cc.duoYiSe = response.data.setting7; //setting7为  0 || null  0就是选择了多一色
        /*if(cc.duoYiSe == 0){
            this.btnWuTong = new cc.Node(); //创建一个节点对象
            this.btnWuTong.addComponent(cc.Sprite); //添加精灵组件
            this.btnWuTong.addComponent(cc.Button); //添加Button组件
            var btnSprite = this.btnWuTong.getComponent(cc.Sprite);
            btnSprite.spriteFrame = this.wuTong_img;
            this.btnWuTong.name = "btnWuTong";
            if(!this.typeButtonsNode.getChildByName("btnWuTong")){
                this.typeButtonsNode.addChild(this.btnWuTong);
                this.btnWuTong.interactable = true;
            }
            var tongHuaShunSpriteCom = this.typeButtonsNode.getChildByName("btnTongHuaShun").getComponent(cc.Sprite);
            tongHuaShunSpriteCom.spriteFrame = this.tongHuaShun_img;  //改变同花顺的精灵
              //给五同按钮添加事件：
            var clickEventWuTong = new cc.Component.EventHandler();
            clickEventWuTong.target = this.cardTypeCombineNode;
            clickEventWuTong.component = "CardTypeCombine"; //脚本名
            clickEventWuTong.handler = "clickWuTong";  //执行的函数
              var ButtonsClickEvents = this.btnWuTong.getComponent(cc.Button).clickEvents;
            ButtonsClickEvents.push(clickEventWuTong);
        }*/
        /*#####*/
        this.maPai = data.maPai;
        /*#####*/
        this._initMaPai();
        /*#####*/
        this._deskInfo = data;
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(data.roomId);

        var playerIndexs = data.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._updateUserScores();
        this._updateBanker();
        this._msgControl.addPlayerInfos(this._playerInfos);

        var currentUserInfo = players.find((function (playerInfo) {
            return playerInfo.id == this._userId;
        }).bind(this));
        this._playerComponents.forEach(function (player) {
            if (data.createId == player.userId) {
                //显示房主
                player.showFangZhuStatus(data.createId, true);
            } else {
                player.showFangZhuStatus(player.userId, false);
            }
        });
        //if (this._deskInfo.cIndex == 0) {
        //  return;
        //}
        /**/

        if (!this._deskInfo.isCBegin) {
            this._gameStatus = GAMESTATUS.WAIT_READY;
        }

        ////没有发牌，不是随机场,不是回放，显示准备按钮
        //if (!this._deskInfo.isCBegin
        //    && !this._isRandomRoom()
        //    && !Playback.instance.isPlaybacking()
        //    && !this._getSelfReadyStatus()
        //) {
        //    this.btnReady.node.active = true;
        //    if(this._deskInfo.cIndex != 0) {
        //        this.btnReady.node.x = 0;
        //        this.btnReady.node.y = 0;
        //    }
        //    else {
        //        this.btnReady.node.x = -150;
        //        this.btnReady.node.y = -24;
        //    }
        //}
        for (var i = 0; i < players.length; i++) {
            var s = players[i];
            var is = s.readyStatus; //true/false
            var userId = s.id;
            this._playerComponents.forEach(function (player) {
                player.showReadyStatus(userId, is);
            });
        }
        if (currentUserInfo && currentUserInfo.cards.length > 0 && this._deskInfo.isCBegin) {
            this._startGame();
        } else if (UserModelHelper.isPlayedCards(currentUserInfo) && !this._deskInfo.isCBegin) {
            this._socketReceiveGameOver(response);
        }
        this.isReadyStatus();
        //if (!this._deskInfo.isCBegin && !this._isRandomRoom()) {
        //  this.btnReaduy.node.active = true;
        //}
        /**/
        //if (!this._deskInfo.isCBegin && !this._isRandomRoom() && !this._deskInfo.isDeskOver) {
        //    //this.btnReady.node.active = true;
        //    cc.log(this._deskInfo)
        //    cc.log('那就是你了------')
        //    if (this._isComparingCardsNow) {
        //        this.btnReady.node.active = false;
        //    }
        //} else {
        //    this.btnReady.node.active = false;
        //}
        /**/
        this._handleUpdateDeskInfoAboutExitRoom(this._deskInfo);
    },

    _socketReciveFaPai: function _socketReciveFaPai(response) {
        this._socketReceiveDeskInfo(response);
    },

    _socketReciveOnlineStatus: function _socketReciveOnlineStatus(response) {
        //{"action":"sendOnlineStatus","result":true,"data":{"userId":100049,"status":1}}
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }

        var data = response.data;
        var userId = data.userId;
        var status = data.status;

        this._playerComponents.forEach(function (player) {
            player.setUserOnlineStatus(userId, status);
        });
    },

    _socketReciveChatTextMessage: function _socketReciveChatTextMessage(response) {
        var userId = response.data.userId;
        var message = response.data.msg;

        this._playerComponents.forEach(function (player) {
            player.showChatText(userId, message);
        });

        this._msgControl.addChatTextMessage(userId, message);

        var sex = this._playerInfos.find(function (user) {
            return user.id == userId;
        }).sex;
        AudioManager.instance.playChatAudio(sex, message);
    },

    _socketReceiveRequestExitMessage: function _socketReceiveRequestExitMessage(response) {
        if (response.data.userId == this._userId) {
            return;
        }

        var alertComp = this.alertAnsowerExitNode.getComponent('alert');
        alertComp.alert();
        alertComp.unscheduleAllCallbacks();

        var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');
        countdown.startCountdown(120, (function (isTimeout) {
            if (isTimeout) {
                this.clickAgreeOtherPlayerExit();
                return;
            }
        }).bind(this));
    },

    _socketReceiveRequestExitResultMessage: function _socketReceiveRequestExitResultMessage(response) {
        this._hideReqestExitNode();
        if (this.alertAnsowerExitNode.active) {
            this.alertAnsowerExitNode.getComponent('alert').dismissAction();
            this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        }

        if (response.data.result) {
            // 解散成功
        } else {
                var userId = response.data.userId;
                var nickname = this._findPlayerInfoByUserId(userId).nickname;
                this.showAlertMessage('解散失败，因为' + nickname + '不同意退出');
            }
    },

    _socketReceiveAudioMessage: function _socketReceiveAudioMessage(response) {
        var userId = response.data.userId;
        this.playSpeakAnimation(userId);

        if (userId == this._userId) {
            return;
        }

        var url = response.data.url;
        this.playAudioUrl(url);
    },

    _socketReceivePlayCard: function _socketReceivePlayCard(response) {
        // 有用户已经准备好了牌
        cc.log(response);
        cc.log('--------972');
        var userId = response.data[0].userId;
        var cardInfo = response.data[1].card;
        this._playerComponents.forEach(function (player) {
            player.playCard(userId, cardInfo);
        });

        if (userId == this._userId) {
            this.cardTypeCombineNode.active = false;
        }
    },
    _getSelfReadyStatus: function _getSelfReadyStatus() {
        var self = this._findPlayerInfoByUserId(this._userId);
        return self.readyStatus;
    },
    _socketReciveReady: function _socketReciveReady(response) {
        var userId = response.data.userId;
        this._playerComponents.forEach(function (player) {
            player.showReadyStatus(userId);
        });
    },

    //收到游戏结束
    _socketReceiveGameOver: function _socketReceiveGameOver(response) {
        this._hideReqestExitNode();

        // 一局游戏结束
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        /**/
        var deskInfo = response.data;
        if (response.action == 'gameOver' && deskInfo.isDeskOver) {
            Socket.sendDidReceiveGameOverAction(this._userId);
        }
        /**/
        this._deskInfo = response.data;

        // 如果是强制解散房间，则直接显示总成绩
        if (this._isDissvledRoom() && !Playback.instance.isPlaybacking()) {
            this._showTotalGameResult(0.1);
            return;
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            // 刚进来的话，不展示比牌动画
            var oneGameResult = this.oneGameResult.getComponent('GameResult');
            oneGameResult.unscheduleAllCallbacks();
            oneGameResult.showResults(this._deskInfo, this._userId);
            this.btnShare.node.active = false;
            this.btnReady.node.active = false;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
            /**/
            this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
            /**/
            return;
        }

        var data = response.data;
        this._deskInfo = data;
        this._updatGameOverview(this._deskInfo);

        var playerIndexs = data.playersIndex; // [100049]

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);

        if (UserModelHelper.isUserReady(this._findCurrentUserInfo())) {
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
        } else {
            this._startCompareCards(response);
        }
    },

    _socketReceiveDissolveDesk: function _socketReceiveDissolveDesk(response) {
        this.cardTypeCombineNode.active = false;

        var message = "房主已解散房间";
        if (this._isRandomRoom()) {
            message = "有玩家已强制退出房间，游戏结束。本局游戏不会扣除您的钻石。";
        }

        this.showAlertMessage(message, false);
        this.alert.getComponent('alert').setWillDismissCallback(function () {
            cc.director.loadScene('hall');
            return true;
        });
    },
    /**/
    _socketLeaveDesk: function _socketLeaveDesk(response) {
        if (!response.result) {
            return;
        }

        if (this._deskInfo.isDeskOver) {
            // 如果房间已结束，也不用再自动退回到大厅了
            return;
        }

        cc.director.loadScene('hall');
    },
    /**/
    // socket 收到有人手机进入后台消息
    _socketReceivePause: function _socketReceivePause(response) {
        if (!response.result) {
            return;
        }

        var userId = response.data.userId;
        this._playerComponents.forEach(function (player) {
            if (player.userId == userId) {
                player.setUserOnlineStatus(userId, 0);
            }
        });
    },

    _receiveSocketConnectError: function _receiveSocketConnectError(response) {
        this.showNetworkMessage();
    },

    _receiveSocketConnectSuccessed: function _receiveSocketConnectSuccessed(response) {
        this.hiddenNetworkMessage();

        if (!Playback.instance.isPlaybacking()) {
            this._loadDeskInfo();
        }
    },
    /**/
    // MARK: 更新房间信息
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(deskInfo.roomId);

        var playerIndexs = deskInfo.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = deskInfo.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._msgControl.addPlayerInfos(this._playerInfos);
        if (deskInfo.cIndex == 0 && this._deskInfo.players.length < this._deskInfo.maxNumber) {
            this.btnShare.node.active = true;
        }
    },
    /**/
    _injectUserIdToPlayerComponents: function _injectUserIdToPlayerComponents(playerIndexs) {
        var currentUserIdIndex = playerIndexs.findIndex((function (userId) {
            return userId == this._userId;
        }).bind(this));

        var fixedPlayerIndexs = playerIndexs.translationWithStartIndex(currentUserIdIndex);
        this._playerComponents.forEach(function (playerComponent, index) {
            var userId = fixedPlayerIndexs.length > index ? fixedPlayerIndexs[index] : null;
            playerComponent.userId = userId;
        });
    },

    _updateUserInfos: function _updateUserInfos(userInfos) {
        var self = this;
        this._playerComponents.forEach(function (playerComponent, index) {
            //playerComponent.setDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateUserInfoWithUsers(userInfos);
        });

        this._handleTheSameOfIPAdress(userInfos);
    },

    _updateUserScores: function _updateUserScores(userInfos) {
        this._playerComponents.forEach(function (player) {
            player.updateScore();
        });
    },

    _updateBanker: function _updateBanker() {
        this._playerComponents.forEach(function (player) {
            player.updateBanker();
        });
    },

    // 私有方法
    _findCardsByUserId: function _findCardsByUserId(userId) {
        var player = this._findPlayerInfoByUserId(userId);

        return player != null ? player.cards : null;
    },

    _findPlayerInfoByUserId: function _findPlayerInfoByUserId(userId) {
        var player = (this._playerInfos || []).find(function (playerInfo) {
            return userId == playerInfo.id;
        });

        return player;
    },

    _findPlayerIndexByUserId: function _findPlayerIndexByUserId(userId) {
        var index = this._playerComponents.findIndex(function (playerComp) {
            return playerComp.userId == userId;
        });

        return index;
    },

    _findCurrentUserInfo: function _findCurrentUserInfo() {
        return this._findPlayerInfoByUserId(this._userId);
    },

    _convertCardsToCardNames: function _convertCardsToCardNames(cards) {
        // [{"suit":"s","number":10}]
        var suitColorMap = {
            s: 4,
            h: 3,
            c: 2,
            d: 1
        };
        return cards.map(function (card) {
            var cardNumber = card.number;

            // 服务器中的 14 是 A
            if (card.number == 14) {
                cardNumber = 1;
            }
            var color = suitColorMap[card.suit];
            var number = Math.max(Math.min(cardNumber, 21), 1);
            return color + "_" + number;
        });
    },

    // 更新游戏总览信息
    _updatGameOverview: function _updatGameOverview(deskInfo) {
        if (Playback.instance.isPlaybacking()) {
            this.labelOverview.string = "回放";
            return;
        }

        if (this._isRandomRoom()) {
            this.labelOverview.string = "";
            return;
        }

        //let gameNumberString = "";
        //if (deskInfo.setting1 != 0 && deskInfo.setting1 != 1) {
        //  gameNumberString = "局数 : " + "" + deskInfo.cIndex + "/" + deskInfo.mMax;
        //} else if (deskInfo.setting1 == 0) {
        //  gameNumberString = "局数 : 10局";
        //} else if (deskInfo.setting1 == 1) {
        //  gameNumberString = "局数 : 20局";
        //}

        //let gameWayName = this._deskInfoGameWay();
        this.labelOverview.string = /*+ gameWayName " " + gameNumberString +"\n"+*/
        "模式 : " + "" + deskInfo.maxNumber + "人";
    },

    /*+ "\n " + this._deskInfoJiaYiSeInfo()
    + "，"  + this._deskInfoGuiPaiInfo()*/ // 是否是随机房
    _isRandomRoom: function _isRandomRoom() {
        if (this._deskInfo == null) {
            return true;
        }

        return this._deskInfo.isRandomDesk;
    },

    // 是否所有局数都用完了
    _isTotalGameOver: function _isTotalGameOver() {
        if (this._deskInfo == null) {
            return false;
        }

        if (this._deskInfo.isDeskOver) {
            return true;
        }

        return this._deskInfo.mMax <= this._deskInfo.cIndex;
    },

    // 是否已解散房间
    _isDissvledRoom: function _isDissvledRoom() {
        if (this._deskInfo) {
            return this._deskInfo.dissolveStatus;
        }

        return false;
    },

    //// 比牌逻辑
    // 开始比牌
    _startCompareCards: function _startCompareCards(data) {
        console.log("打印data信息");
        console.log(data);
        /**/
        this._isComparingCardsNow = true;
        this._gongXiNiShow(false);
        /**/
        this._players = data.data.players;
        var user = this._findPlayerInfoByUserId(this._userId);
        AudioManager.instance.playStartCompare(user.sex);

        this.startCompareCardsNode.getComponent('alert').alert();
        this.scheduleOnce((function () {
            this.startCompareCardsNode.active = false;
            this._showCompareCardDetails(data);
        }).bind(this), 2.0);
    },

    _showCompareCardDetails: function _showCompareCardDetails(data) {
        //var _this = this;
        //this._playerComponents.forEach(function (playerComp) {
        //    playerComp.readyToCompareCards();
        //});
        //let comparePlayers = this._playerComponents.filter(function (player) {
        //    if(player.userId == null) {
        //        return false;
        //    }
        //    for(var i in _this._players) {
        //        if(_this._players[i].id == player.userId) {
        //            if(_this._players[i].cardInfo.length <= 1) {
        //                //将是特殊牌的玩家存起来
        //                if(_this._players[i].cardInfo.length == 1){
        //                    _this.teShuPlayId = _this._players[i].id;
        //                }
        //                return false;
        //            }
        //            else if(_this._players[i].cardInfo.length == 3) {
        //                return true;
        //            }
        //        }
        //    }
        //});
        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });

        var comparePlayers = this._playerComponents.filter(function (player) {
            return player.node.active;
        });
        var self = this;
        var duration = this._showCompareCardStep(0, comparePlayers);
        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers);
        }, duration);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers);
        }, duration * 2);

        /**
         * 如果有特殊牌的话就改变时间 duration
         */
        var players = data.data.players;
        for (var i = 0; i < players.length; i++) {
            var s = players[i];
            if (s.cardInfo.length == 1) {
                duration += 1.5;
            }
        }

        duration = duration * 3 + 0.5;
        var shootDuration = 1.5;

        var shootDatas = this._shootDatas() || [];

        var shotData = this._shotData() || [];

        var homeRunUserId = this._homeRunUserId();

        var shotDataTimes = 0;
        shotData.forEach(function (data, index) {
            self.scheduleOnce(function () {
                self.playShoot(data.fromUserId, data.toUserId);
            }, duration + index * shootDuration);
            shotDataTimes += 1;
            duration += 1;
        });
        if (homeRunUserId.length >= 1) {
            shootDatas.forEach(function (data, index) {
                self.scheduleOnce(function () {
                    self.playShoot(data.fromUserId, data.toUserId);
                }, duration + (index + shotDataTimes) * shootDuration);
                duration += 1;
            });
        }

        duration = duration + shootDatas.length * shootDuration + shotData.length * shootDuration;

        if (homeRunUserId > 0) {
            self.scheduleOnce(function () {
                self.playHomeRun(homeRunUserId);
            }, duration);
            duration = duration + 1.0;
        }

        if (homeRunUserId) {
            duration = duration + 1;
        }

        //显示结果
        this.scheduleOnce(function () {
            self._showCompareCardFinished();
        }, duration);
    },

    _showCompareCardStep: function _showCompareCardStep() {
        var startTime = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];
        var comparePlayers = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];

        var duration = startTime;
        var interval = 1;
        var self = this;

        comparePlayers = comparePlayers.sort(function (player1, player2) {
            return player1.nextCompareScore() - player2.nextCompareScore();
        });
        // 干掉特殊牌的时间
        var co = comparePlayers;
        for (var i = 0; i < co.length; i++) {
            var s = co[i]._userInfo;
            if (s.isContainExtra) {
                co.splice(i, 1);
            }
        }
        co.forEach(function (player) {
            self.scheduleOnce(function () {
                player.showNextCompareCards();
            }, duration);
            duration = duration + interval;
        });

        return duration;
    },

    _isGameOver: function _isGameOver() {},

    // 比牌完成后会调用的方法
    _showCompareCardFinished: function _showCompareCardFinished() {
        this._showOneGameResult();
        /**/
        this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
        /**/
    },

    //network
    showNetworkMessage: function showNetworkMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? "网络链接断开，重新连接中..." : arguments[0];

        if (this.networkNode && this.networkNode.active) {
            return;
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg, autoDismiss) {
        var alertComp = this.alert.getComponent('alert');
        if (!this.alert.active) {
            alertComp.alert();
        }

        alertComp.setMessage(msg);
        alertComp.unscheduleAllCallbacks();
        if (autoDismiss) {
            alertComp.scheduleOnce(function () {
                alertComp.dismissAction();
            }, 5);
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? '检查网络中...' : arguments[0];

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null && this.checkNode.active) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },

    /////  聊天语音逻辑
    _registerVoiceNodeEvents: function _registerVoiceNodeEvents() {
        var self = this;
        var chatVoiceNode = this.btnChatVoice.node;
        this.endRecordTime = Date.now();
        chatVoiceNode.on(cc.Node.EventType.TOUCH_START, function (event) {
            if (Date.now() - self.endRecordTime >= 1000) {
                self.nativeRecordAction();
                self.voiceRecordAnimationNode.active = true;

                var action = cc.scaleTo(0.12, 1.2);
                self.btnChatVoice.node.runAction(action);

                self._isRecording = true;
            }
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        Socket.instance.uploadFinish = function (url) {
            var userId = self._userId;
            Socket.sendAudioMessage(userId, url);
            self.playSpeakAnimation(self._userId);
        };
    },

    nativeRecordAction: function nativeRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
            AudioManager.instance.pauseMusic();
        }
    },

    nativeEndRecordAction: function nativeEndRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
            AudioManager.instance.resumeMusic();
        }
    },

    playAudioUrl: function playAudioUrl(url) {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", url);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", url);
        }
    },

    // MARK:  退出游戏逻辑
    _handleUpdateDeskInfoAboutExitRoom: function _handleUpdateDeskInfoAboutExitRoom(deskInfo) {
        if (!deskInfo.isDissolving) {
            return;
        }

        var dissolveLeftTime = deskInfo.dissolveLeftTime || 120;
        var dissolveUserId = deskInfo.dissolveUserId;
        if (dissolveUserId == this._userId) {
            this.alertRequestExitNode.active = true;
            this.btnAlertRequestExitCancelButton.node.active = false;
            this.btnAlertRequestExitConfirmButton.node.active = false;
            var _alert = this.alertRequestExitNode.getComponent('alert');
            _alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(dissolveLeftTime);
            return;
        }

        var dissolveAnswerInfos = deskInfo.dissolveAnswerInfo;
        var currentUserIdIndex = deskInfo.playersIndex.findIndex((function (userId) {
            return this._userId == userId;
        }).bind(this));

        var answerResult = dissolveAnswerInfos[currentUserIdIndex];
        if (answerResult == -1) {
            // -1 表示未处理  0 表示拒绝  1表示同意
            this.alertAnsowerExitNode.active = true;

            var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');
            countdown.startCountdown(dissolveLeftTime, (function (isTimeout) {
                if (isTimeout) {
                    this.clickAgreeOtherPlayerExit();
                }
            }).bind(this));
        }
    },

    // 确定要强制退出游戏
    clickButton: function clickButton() {
        var anim = this.btnButtonNode.getComponent(cc.Animation);
        if (this.btnButtons.rotation == 270) {
            anim.play('topRightButtonsLayout');
            this.btnButtons.rotation = 90;
        } else {
            //anim.stop('topRightButtonsLayout');
            this.btnButtonNode.x = 891;
            this.btnButtons.rotation = 270;
        }
    },

    // 确定要强制退出游戏
    clickConfirmForceExit: function clickConfirmForceExit() {
        Socket.sendForceExitRoom(this._userId);
        cc.director.loadScene('hall');
    },

    // 确认请求退出游戏
    clickConfirmRequestExit: function clickConfirmRequestExit() {
        this.btnAlertRequestExitCancelButton.node.active = false;
        this.btnAlertRequestExitConfirmButton.node.active = false;

        var alert = this.alertRequestExitNode.getComponent('alert');
        alert.setMessage("您正在申请协商退出，等待其他玩家同意");
        this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(120);

        Socket.sendLeaveDesk(this._userId);
    },

    // 同意他人退出
    clickAgreeOtherPlayerExit: function clickAgreeOtherPlayerExit() {
        this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();

        Socket.sendAnswerDissolve(this._userId, 1);
    },

    // 不同意他人退出
    clickDisagreeOtherPlayerExit: function clickDisagreeOtherPlayerExit() {
        this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        Socket.sendAnswerDissolve(this._userId, 0);
    },

    // 隐藏请求退出 Node
    _hideReqestExitNode: function _hideReqestExitNode() {
        if (!this.alertRequestExitNode.active) {
            return;
        }

        this.alertRequestExitNode.active = false;
        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },

    //// 打枪
    playShoot: function playShoot(fromUserId, toUserId) {
        var user = this._findPlayerInfoByUserId(fromUserId);
        if (user) {
            AudioManager.instance.playHumanDaQiang(user.sex);
        }

        var toUserIndex = this._findPlayerIndexByUserId(toUserId);

        this._playerComponents.forEach(function (player) {
            player.playShootAnimation(fromUserId, toUserIndex);
            player.playBulletHoleAnimation(toUserId);
        });
    },

    // 播放全垒打动效
    playHomeRun: function playHomeRun(userId) {
        var user = this._findPlayerInfoByUserId(userId);
        if (user) {
            AudioManager.instance.playHomeRun(user.sex);
        }

        this._playerComponents.forEach(function (player) {
            player.playHomeRunAimation(userId);
        });
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        this._playerComponents.forEach(function (player) {
            player.playSpeakAnimation(userId);
        });
    },

    _shootDatas: function _shootDatas() {
        var homeRunUserId = this._homeRunUserId(); // 全垒打
        var shootDatas = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId == homeRunUserId;
        });
        return shootDatas;
    },

    _shotData: function _shotData() {
        var homeRunUserId = this._homeRunUserId(); // 打枪
        var shotData = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId != homeRunUserId;
        });
        return shotData;
    },

    _homeRunUserId: function _homeRunUserId() {
        return this._deskInfo.allShotData;
    },

    // MARK: 房间信息部分

    // 获取房间的玩法
    _deskInfoGameWay: function _deskInfoGameWay() {
        var setting = this._deskInfo.setting3;
        if (setting == null) {
            setting = 2;
        }
        var names = ["庄家模式", "无特殊牌", "普通模式"];
        return names[setting];
    },

    _deskInfoNumberOfGame: function _deskInfoNumberOfGame() {
        var setting = this._deskInfo.setting1;
        var infos = ['10局', '20局', '40局', '5局'];
        /*if (setting <= 1) {
          return '条数：' + infos[setting];
        }*/
        if (setting == 2) {
            setting = 0;
        } else if (setting == 3) {
            setting = 1;
        } else if (setting == 4) {
            setting = 2;
        } else if (setting == 5) {
            setting = 3;
        }
        return '局数：' + infos[setting];
    },

    _deskInfoNumberOfPeople: function _deskInfoNumberOfPeople() {
        var setting = this._deskInfo.setting2;
        var infos = ['2人', '3人', '4人', '5人'];
        return infos[setting];
    },

    _deskInfoPayInfo: function _deskInfoPayInfo() {
        var setting = this._deskInfo.setting4;
        if (setting == null) {
            setting = 0;
        }
        if (setting == 0) {
            setting = 1;
        }
        var infos = ['房主霸主庄', '房费AA'];
        return infos[setting];
    },

    _deskInfoJiaYiSeInfo: function _deskInfoJiaYiSeInfo() {
        var setting = this._deskInfo.setting7 == 0 ? 1 : 0;
        var infos = ['无多一色', '多一色'];
        return infos[setting];
    },

    _deskInfoGuiPaiInfo: function _deskInfoGuiPaiInfo() {
        var setting = undefined;
        if (this._deskInfo.setting8 == null) {
            setting = 0;
        } else if (this._deskInfo.setting8 == 0) {
            setting = 1;
        } else if (this._deskInfo.setting8 == 1) {
            setting = 2;
        }
        var infos = ['无王牌', '两张王牌', '四张王牌'];
        return infos[setting];
    },

    // MARK: 剩余时间
    _remainTimeStartUpdate: function _remainTimeStartUpdate() {
        //this.schedule(this._remainTimeUpdate, 1.0, cc.macro.REPEAT_FOREVER);
    },

    _remainTimeUpdate: function _remainTimeUpdate() {
        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        if (this._deskInfo == null) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        var isTaoShu = this._deskInfo.setting1 == 0 || this._deskInfo.setting1 == 1;
        if (isTaoShu) {
            this.labelRemainTime.node.active = false;
            return;
        }

        if (!this._deskInfo.createTime) {
            return;
        }

        this.labelRemainTime.node.active = true;
        var createTime = fecha.parse(this._deskInfo.createTime, 'YYYY-MM-DD HH:mm:ss').getTime();
        var oneHour = 60 * 60;
        var remain = (Date.now() - createTime) / 1000;
        remain = Math.max(oneHour - remain, 0);

        var mins = Math.floor(remain / 60);
        var secs = Math.floor(remain % 60);
        if (mins == 0 && secs == 0) {
            this.labelRemainTime.string = "";
            return;
        }

        var minsString = "" + mins;
        if (minsString.length < 2) {
            minsString = "0" + minsString;
        }

        var secsString = "" + secs;
        if (secsString.length < 2) {
            secsString = "0" + secsString;
        }

        var string = "剩余时间：00:" + minsString + ":" + secsString;
        this.labelRemainTime.string = string;
    },

    // MARK: 处理同 IP 的用户
    _handleTheSameOfIPAdress: function _handleTheSameOfIPAdress(userInfos) {
        if (!userInfos || userInfos.length == 0) {
            return;
        }

        var ipUserInfos = userInfos.reduce(function (ips, userInfo) {
            var users = ips[userInfo.ipAddress] || [];
            users.push(userInfo);

            ips[userInfo.ipAddress] = users;
            return ips;
        }, {});

        var sameIpUsers = null;
        for (var ip in ipUserInfos) {
            var users = ipUserInfos[ip];
            if (users.length > 1) {
                sameIpUsers = users;
                break;
            }
        }

        if (sameIpUsers == null) {
            return;
        }

        this._alertSameIpUserInfos(sameIpUsers);
    },

    _alertSameIpUserInfos: function _alertSameIpUserInfos(users) {
        var message = "";
        var userIds = "";
        users.forEach(function (user, index) {
            message = message + (index > 0 ? ' 和 ' : '') + user.nickname;
            userIds = userIds + user.id;
        });
        message = message + ' 在同一 IP 下！';

        this._didAlertSameIpMessage = this._didAlertSameIpMessage || {};
        if (this._didAlertSameIpMessage[userIds]) {
            return;
        }

        this.showAlertMessage(message, true);
        this._didAlertSameIpMessage[userIds] = true;
    }

});
Play.gongXiNiShow = function (type) {
    this.instances._gongXiNiShow(type);
};
module.exports = Play;

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","Player":"Player","UserModelHelper":"UserModelHelper","fecha":"fecha","manager":"manager","socket":"socket"}],"product":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a9ad2cC2BdEiaFSqV4XCWQV', 'product');
// scripts\product.js

'use strict';

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        productId: ''
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickAction: function clickAction() {
        this.onClickAction(this.productId);
    },

    onClickAction: function onClickAction(productId) {}

});

cc._RFpop();
},{}],"randRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4d298BlaelCHqiV5dTDjhuY', 'randRoom');
// scripts\randRoom.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        matchingLabel: cc.Label,
        timeNode: cc.Node,
        matchingNode: cc.Node,
        waitingPrefab: cc.Prefab,
        alertPrefab: cc.Prefab,

        tishi: cc.Node,

        _userId: null,
        _response: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        cc.isRoomViewShow = true;
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        KQGlobalEvent.on(Socket.Event.ReceiveInterRandom, this._socketReceiveInterRandom, this);
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            return;
        }

        cc.director.loadScene('play');
    },

    _socketReceiveInterRandom: function _socketReceiveInterRandom(response) {
        //服务器发送  {'action':'interRandom','result':false,'data':{'reason':reason}}
        this._response = response;
        this.unschedule(this._timeoutRandomAction);
        // 处理随机场匹配不成功的情况
        if (response.result) {
            return;
        }

        var reason = response.data.reason || "加入随机场失败";
        this.showAlertMessage(reason);

        if (reason == '你已经在匹配队列') {
            this._showMatching();
        } else {
            this._hideMatching();
        }
    },

    _socketDisconnect: function _socketDisconnect() {
        // 连接已断开
        this.matchingNode.active = false;
        this.showNetworkMessage('网络链接断开，重新连接中...');
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    },

    clickStart: function clickStart() {
        Socket.sendEnterRandom(this._userId);
        this._showMatching();

        /*#####begin*/
        //reason是服务器发送回来的
        /*if(this._response.data.reason == "你的钻石不足"){
            this.tishi.active = true;
        }*/
        /*#####end*/

        this.scheduleOnce(this._timeoutRandomAction, 5);
    },
    /*#####点击空白地方，砖石不足提示消失*/
    /*onBtnKong:function () {
        if(this.tishi.active){
            this.tishi.active = false;
        }else{
            //什么也不做
        }
    },*/
    /*取消匹配*/
    clickCancel: function clickCancel() {
        Socket.sendCancelRandom(this._userId);

        this._hideMatching();
    },

    _timeoutRandomAction: function _timeoutRandomAction() {
        this._hideMatching();
        this.showAlertMessage('进入匹配失败');
    },

    _showMatching: function _showMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.alert();
        this.matchingLabel.string = '正在匹配中，请稍后...';
        var num = 0;
        this.schedule(function () {
            num = num + 0.5;
            this.timeNode.rotation = num;
        }, 0.01);
    },

    _hideMatching: function _hideMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.dismissAction();
    },

    showNetworkMessage: function showNetworkMessage(msg) {
        this.unschedule(this._timeoutRandomAction);

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg) {
        if (!msg) {
            cc.error("不能显示为空的信息");
            return;
        }

        if (!this.alertMessageNode) {
            this.alertMessageNode = cc.instantiate(this.alertPrefab);
            this.node.addChild(this.alertMessageNode);
        }

        this.alertMessageNode.getComponent('alert').setMessage(msg);
        this.alertMessageNode.getComponent('alert').alert();
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"recordInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1457gdvd5I5aENjKvCTkCd', 'recordInfo');
// scripts\recordInfo.js

'use strict';

var Socket = require('socket');
var Playback = require('Playback');

cc.Class({
  extends: cc.Component,

  properties: {
    timeLabel: cc.Label,
    nicknameLabels: [cc.Label],
    scoreLabels: [cc.Label],
    numNode: cc.Label,
    _parentId: null,
    playbackNode: cc.Node, //回放按钮
    watchNode: cc.Node, //查看按钮

    _recordItemInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setInfo: function setInfo(recordInfo) {
    this._parentId = recordInfo.id;
    this.playbackNode.active = false;
    this.watchNode.active = true;
    if (recordInfo.playersInfo.length == 0) {
      return;
    }

    var playersInfo = JSON.parse(recordInfo.playersInfo);
    this.timeLabel.string = "对战时间：" + playersInfo.time;
    for (var i = 0; i < playersInfo.players.length; i++) {
      this.nicknameLabels[i].string = playersInfo.players[i].nickname;
      this.scoreLabels[i].string = playersInfo.players[i].totalScore;
    }
  },

  clickAction: function clickAction() {
    if (this._recordItemInfo) {
      cc.log("点击了记录详情 item，开启回放");
      this._startPlayback(this._recordItemInfo._info8Array);
      return;
    }

    Socket.sendGetItemRecord(Socket.instance.userInfo.id, this._parentId);
  },

  _startPlayback: function _startPlayback(playBackInfo) {
    Playback.instance.setPlaybackDatas(playBackInfo);
    cc.director.loadScene('play');
  },

  detailAction: function detailAction(recordItemInfo, index) {
    this._recordItemInfo = recordItemInfo;
    this.playbackNode.active = true;
    this.watchNode.active = false;
    this.numNode.string = "第" + (index + 1) + "局";
    this.timeLabel.string = "对战时间：" + recordItemInfo.creatAt;
    var objArray = JSON.parse(recordItemInfo.info8);
    this._recordItemInfo._info8Array = objArray;
    var playersArray = objArray.map(function (str) {
      return JSON.parse(str);
    });

    var players = playersArray[playersArray.length - 1].data.players;
    for (var i = 0; i < players.length; i++) {
      this.nicknameLabels[i].string = players[i].nickname;
      this.scoreLabels[i].string = players[i].cScore;
    }
  }

});

cc._RFpop();
},{"Playback":"Playback","socket":"socket"}],"record":[function(require,module,exports){
"use strict";
cc._RFpush(module, '452f4rFUqRLFYlGEJS5kEWs', 'record');
// scripts\record.js

'use strict';

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    extends: cc.Component,

    properties: {
        scrollView: cc.Node,
        subScrollView: cc.Node,
        recordItem: cc.Prefab,
        subRecordItem: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.isSubPage = false;
        this.subScrollView.active = false;
        this.scrollViewContent = this.scrollView.getComponent(cc.ScrollView).content;
        this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;

        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.GetRecord, this._ReceiveRecordInfo, this);
        KQGlobalEvent.on(Socket.Event.GetItemRecord, this._ReceiveRecordItem, this);
    },

    _ReceiveRecordInfo: function _ReceiveRecordInfo(response) {
        this.isSubPage = false;
        this.subScrollView.active = false;
        this.scrollView.active = true;

        this.scrollViewContent.removeAllChildren();

        response.data.filter(function (record) {
            return record.playersInfo.length > 0;
        }).forEach(function (recordInfo) {
            var item = cc.instantiate(this.recordItem);
            this.scrollViewContent.addChild(item);
            var comp = item.getComponent('recordInfo');
            comp.setInfo(recordInfo);
        }.bind(this));
    },

    _ReceiveRecordItem: function _ReceiveRecordItem(RecordItemInfo) {
        this.isSubPage = true;
        this.subScrollView.active = true;
        this.scrollView.active = false;

        this.subScrollViewContent.removeAllChildren();
        for (var i = 0; i < RecordItemInfo.data.length; i++) {
            var item = cc.instantiate(this.recordItem);
            this.subScrollViewContent.addChild(item);
            var comp = item.getComponent('recordInfo');
            var info = RecordItemInfo.data[i];
            comp.detailAction(info, i);
        }
    },

    closeAction: function closeAction() {
        if (this.isSubPage) {
            this.isSubPage = false;
            this.subScrollView.active = false;
            this.scrollView.active = true;
        } else {
            this.node.getComponent('alert').dismissAction();
        }
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"rule":[function(require,module,exports){
"use strict";
cc._RFpush(module, '92f6eNs7RdDRJIRLCZnyulJ', 'rule');
// scripts\rule.js

'use strict';

cc.Class({
    extends: cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    }
});

cc._RFpop();
},{}],"selectMoShi":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0030eDrh7xEm6AeR3FCg5WU', 'selectMoShi');
// scripts\selectMoShi.js

cc.Class({
    "extends": cc.Component,

    properties: {
        selectZhuangBg: cc.Node,
        selectZhuangRight: cc.Node,
        selectTeShuPaiBg: cc.Node,
        selectTeShuPaiRight: cc.Node,
        _zhuangSelected: null, //庄家模式是否选择  null为不选择，0为选择
        _teShuPaiSelected: null, //无特殊牌模式是否选择  null为不选择，1为选择
        selectIndex: null },

    //是否选择庄家模式或者无特殊牌  null为两者都不选  0为选择了庄家模式  1为选择了无特殊牌模式
    onLoad: function onLoad() {},

    /*#####点击庄家模式*/
    clickZhuanJiaKuang: function clickZhuanJiaKuang() {
        if (this._zhuangSelected == 0) {
            //没选上庄家模式
            this.selectZhuangRight.active = false;
            this._zhuangSelected = null;

            if (this._teShuPaiSelected == null) {
                this.selectIndex = null;
            }

            //选了无特殊牌就不能选庄家模式
            if (this._teShuPaiSelected == 0) {
                this.selectIndex = 1;
            }
        } else if (this._zhuangSelected == null) {
            //选上状态
            this.selectZhuangRight.active = true;
            this._zhuangSelected = 0;
            //庄家模式选上的时候无特殊牌必须为不选
            if (this._teShuPaiSelected == 0) {
                this.selectTeShuPaiRight.active = false;
                this._teShuPaiSelected = null;
            }
            this.selectIndex = 0;
        }
        console.log(this.selectIndex);
    },

    /*#####点击无特殊牌的选择框*/
    clickTeShuPaiKuang: function clickTeShuPaiKuang() {
        if (this._teShuPaiSelected == 0) {
            //没选上
            this.selectTeShuPaiRight.active = false;
            this._teShuPaiSelected = null;

            //如果庄家模式也没选上
            if (this._zhuangSelected == null) {
                this.selectIndex = null;
            } else {
                this.selectIndex = 0;
            }
        }
        //点击的时候把勾号打开，就是选上状态
        else if (this._teShuPaiSelected == null) {
                this.selectTeShuPaiRight.active = true;
                this._teShuPaiSelected = 0;
                this.selectIndex = 1;

                if (this._zhuangSelected == 0) {
                    this.selectZhuangRight.active = false;
                    this._zhuangSelected = null;
                    this.selectIndex = 1;
                }
            }
        console.log(this.selectIndex);
    }
});

cc._RFpop();
},{}],"select_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8e7e53kJcJK9rwMSxnloqI5', 'select_mapai');
// scripts\select_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        pai: cc.Node,
        mapai: {
            "default": [],
            type: cc.SpriteFrame
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selectMa = this.node.getComponent("select_ma");
        this.selectMa.onLoad();
        this.com = this.pai.getComponent(cc.Sprite);
    },

    clickBtnComfirm: function clickBtnComfirm() {
        this.com.spriteFrame = this.mapai[cc.from.ma];
        //console.log(this.com.spriteFrame);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"select_ma":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4bc0b2bZGRGXoAfdO3Y6Squ', 'select_ma');
// scripts\select_ma.js

cc.Class({
    "extends": cc.Component,

    properties: {
        rightIcon: [cc.Node],
        mapaiRight: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.from == null) {
            cc.from = {};
        }
        //如果不带马，则马牌为空
        if (this.mapaiRight.active == false) {
            cc.from.isUseMa = false;
            cc.from.ma = null;
        } else {
            cc.from.isUseMa = true;
            //否则马牌默认为第0个，即黑桃5
            cc.from.ma = 0;
        }
        for (var i = 0; i < this.rightIcon.length; i++) {
            if (i == 0) {
                this.rightIcon[i].active = true;
                cc.from.ma = 0;
                this.select = this.rightIcon[i];
            } else {
                this.rightIcon[i].active = false;
            }
        }
    },
    onMaPaiClick: function onMaPaiClick(e) {
        var targetName = e.target.name;
        cc.log(targetName);
        if (targetName != this.select.parent.name) {
            if (targetName == "select_kuang1") {
                this.select = this.rightIcon[2];
                cc.from.ma = 2;
            } else if (targetName == "select_kuang2") {
                this.select = this.rightIcon[1];
                cc.from.ma = 1;
            } else if (targetName == "select_kuang3") {
                this.select = this.rightIcon[0];
                cc.from.ma = 0;
            }
            for (var i = 0; i < this.rightIcon.length; i++) {
                this.rightIcon[i].active = false;
            }
            this.select.active = true;
        }
        console.log(cc.from.ma);
    }

});

cc._RFpop();
},{}],"select":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e913aIwAtVEo5jMrf40D5rw', 'select');
// scripts\select.js

cc.Class({
    "extends": cc.Component,

    properties: {
        bgNode: cc.Node, //选择框
        selectedNode: cc.Node, //对号
        pai: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selected = true;
    },

    clickAction: function clickAction() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
    },

    setSelected: function setSelected(selected) {
        this.selected = selected;
        this.selectedNode.active = this.selected;
    },

    /*#####*/
    clickSelectKuang: function clickSelectKuang() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        cc.from.isUseMa = this.selected;
        var mapaiCom = this.pai.getComponent(cc.Button);
        if (this.selectedNode.active === false) {
            mapaiCom.interactable = false;
        } else {
            mapaiCom.interactable = true;
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"singleSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '194a8h4vXFO+bXX92yzqbfq', 'singleSelect');
// scripts\singleSelect.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0
    },
    /*原来的*/
    /*    onLoad: function () {
            var self = this;
            for (var i = 0; i < this.nodes.length; i++) {
                let isSelected = (this.selectedIndex == i);
                this.nodes[i].getComponent('select').setSelected(isSelected);
            }
            for (var i = 0; i < this.nodes.length; i++) {
                var tComp = this.nodes[i].getComponent('select');
                tComp.index = i;
                tComp.clickAction = function() {
                    for (var i = 0; i < self.nodes.length; i++) {
                        var comp = self.nodes[i].getComponent('select');
                        comp.setSelected(false);
                    }
                    this.setSelected(true);
                    self.selectedIndex = this.index;
                    self.onSelectChange(this.index);
                };
            }
        },
    */
    /*####*/
    onLoad: function onLoad() {
        var self = this;
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = this.selectedIndex == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                    comp.setSelected(false);
                }
                this.setSelected(true);
                self.selectedIndex = this.index;
                self.onSelectChange(this.index);
            };
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"slider":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1c921w7bEFKUIdNwItOX3oG', 'slider');
// scripts\slider.js

cc.Class({
    "extends": cc.Component,

    properties: {
        indicatorNode: cc.Node,
        backgroundNode: cc.Node,
        selectedNode: cc.Node,

        value: 0
    },

    // use this for initialization
    onLoad: function onLoad() {
        var self = this;
        this.indicatorNode.on(cc.Node.EventType.TOUCH_START, function (event) {});
        this.indicatorNode.on(cc.Node.EventType.TOUCH_MOVE, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });

        //this.maxWidth = this.node.width - 40;
        this.maxWidth = this.node.width - 28;
        this.setValue(this.value);
    },

    updateSlider: function updateSlider(pt) {
        var x = pt.x;
        if (x < 0) {
            x = 0;
        }

        if (x > this.maxWidth) {
            x = this.maxWidth;
        }
        this.setValue(x / this.maxWidth);
        this.onValueChange(this.value);
    },

    /*0 - 1*/
    setValue: function setValue(value) {
        this.value = value;
        if (this.value < 0) {
            this.value = 0;
        }
        if (this.value > 1) {
            this.value = 1;
        }
        //this.maxWidth = this.node.width - 38;
        this.maxWidth = this.node.width - 28;
        this.indicatorNode.x = this.value * this.maxWidth + 10;
        this.selectedNode.width = this.value * this.maxWidth + this.indicatorNode.width / 2;
    },

    onValueChange: function onValueChange(value) {
        cc.log(value);
    }
});

cc._RFpop();
},{}],"socket":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf75cLLNo1ETbJFrx/23i/H', 'socket');
// scripts\socket.js

var manager = require('manager');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var SocketConstant = {
  MaxReconnectCheckInterval: 5 };

/**
 * 这是对 WebSocket 的一个封装
 * 
 * 里面包含自动重连的功能
 */
// 重连检测时间片
var Socket = cc.Class({
  'extends': cc.Component,

  properties: {
    _lastReceiveMsgTime: 0, // 最后一次收到消息时间(毫秒)
    _timeout: 8 },

  // 超时时长 （秒）
  statics: {
    instance: null,
    url: 'ws://39.108.112.11:5001'
  },

  //url:"ws://192.168.0.120:5001",
  //url:"ws://183.3.205.149:5002",
  // use this for initialization
  onLoad: function onLoad() {
    Socket.instance = this;

    this.name = "socket";

    cc.game.addPersistRootNode(this.node);
    if (cc.game.isPersistRootNode(this.node)) {
      cc.log('添加全局节点 Socket 成功');
    }

    this._registerAppActiveChange();

    this.isCreating = false;
    this.createIndex = 0;
    this.createSocket();

    this.schedule(function () {
      this.checkConnection();
    }, 5);

    this.recvTime = Date.now(); //接收到最新一条服务器的信息的时间
    //cc.log(manager.version);

    this._checkSocket();
  },

  checkConnection: function checkConnection() {
    //客户端定时给服务端发送点数据，防止连接由于长时间没有通讯而被某些节点的防火墙关闭导致连接断开的情况。
    this.sendMessage('checkAction', '');
  },

  createSocket: function createSocket() {
    var self = this;
    this.createIndex++; //创建次数加1
    if (this.createIndex > 5) {
      this.networkError();
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.isCreating = true;

    KQGlobalEvent.emit(Socket.Event.SocketConnecting);
    this.ws = new WebSocket(Socket.url);
    if (this.ws === null) {
      this.networkError();
      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { 'data': 'Socket 创建失败' });
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.socketError = false;

    // socket 连接成功
    this.ws.onopen = function (event) {
      //cc.log("WebSocket 连接成功：", event);

      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketConnectSuccessed, event);

      self.isCreating = false;
      self.socketError = false;
      self.createIndex = 0;
      self.connectionSuccess();
      self.sendReconnectInfo();
    };

    // socket 接收到消息
    this.ws.onmessage = function (event) {
      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketReceiveMessage, event.data);

      self.isCreating = false;
      self.socketError = false;
      self.receviceMessage(event.data);
      self._dispatchResponse(event.data);
      self.recvTime = Date.now(); //接收最新一条信息的时间

      /**/
    };

    /**
     * socket 发生错误
     * 
     * socket 本身有 `onerror` 回调，但事实证明，其不靠谱，
     * 有很大的机率有误报的行为，常常在没有错误时，会给错误回调。
     * 且不能定制超时时长
     * 
     * @param {String} message 
     */
    this.ws._kq_onerror = function (message) {
      cc.error('WebSocket 连接错误：' + message);

      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { data: message });
      self.ws.close();
      if (!self.ws) {
        return;
      }

      // 虽然调用了 websocket 的 close 方法，但是
      // 它并会立即调用 onclose 回调，而是在未来的某
      // 一时间再回调 onclose；但这里明显可以直接回调了。
      var ws = self.ws;

      self.ws.onclose();
      ws.onclose = function () {};
    };

    // socke 已关闭
    this.ws.onclose = function (event) {
      //cc.log('WebSocket 已关闭 close time=' + Date.now() + " event: " + event);

      self.isCreating = false;
      self.socketError = true;
      self.ws = null;
      self.connectionDisconnect();
      KQGlobalEvent.emit(Socket.Event.SocketDisconnect, event);
      //cc.log('socket close'+JSON.stringify(event));
    };
  },

  reconnect: function reconnect() {
    var self = this;
    this.scheduleOnce(function () {
      if (!self.isCreating && self.socketError) {
        self.createSocket();
      }
    }, 2);
  },

  sendReconnectInfo: function sendReconnectInfo() {
    var self = this;
    this.scheduleOnce(function () {
      if (this.userInfo != null) {
        var userId = self.userInfo.user_id || self.userInfo.id;
        self.sendMessage('reconnect', {
          'userId': userId
        });
      }
    }, 1);
  },

  receviceMessage: function receviceMessage(response) {},

  connectionDisconnect: function connectionDisconnect() {},

  connectionSuccess: function connectionSuccess() {},

  networkError: function networkError() {},

  checkNetworkStart: function checkNetworkStart() {},

  checkNetworkEnd: function checkNetworkEnd() {},

  _dispatchResponse: function _dispatchResponse(responseString) {
    //cc.log("WebSocket 接收到服务器消息：", responseString);
    var response = JSON.parse(responseString);
    var action = response["action"];
    if (action) {
      KQGlobalEvent.emit(action, response);
    }
  },

  // MARK: 前后台操作
  _registerAppActiveChange: function _registerAppActiveChange() {
    //cc.log("WebSocket 注册应用进入前、后台事件");
    cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
    cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
  },

  /**
   * 进入后台
   */
  _appEnterBackground: function _appEnterBackground() {
    var now = cc.sys.now();
    if (now - this._lastAppEnterBackgroundTime < 100) {
      return;
    }
    this._lastAppEnterBackgroundTime = now;

    //cc.log("WebSocket 检测到应用进入后台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppPause(id);
    this._cancelCheckSocket();
  },

  /**
   * 进入前台 
   */
  _appBecomActive: function _appBecomActive() {
    var now = cc.sys.now();
    if (now - this._lastAppBecomActiveTime < 100) {
      return;
    }
    this._lastAppBecomActiveTime = now;

    //cc.log("WebSocket 检测到应用进入前台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppActive(id);
    this._checkSocket();

    this.scheduleOnce((function () {
      this._checkSocketExecute();
    }).bind(this), 1.5);
  },

  //进入后台操作
  enterbackgroudAction: function enterbackgroudAction() {
    this._appEnterBackground();
  },

  //进入前台操作
  resumeAction: function resumeAction() {
    //检查网络
    this._checkNetwork();
    this._appBecomActive();
  },

  sendMessage: function sendMessage(action, data) {
    data = this._strongVerifyData(data);

    if (this.socketError) {
      cc.error("socket 连接错误：" + this.socketError);
      this.reconnect();
      return;
    }
    //cc.log('WebSocket 发送消息：' + action, data);
    if (cc.sys.isObjectValid(this.ws)) {
      if (this.ws.readyState === WebSocket.OPEN) {
        this.ws.send(this._convertParameterToString(action, data));
      }
    } else {
      this.connectionDisconnect();
    }
  },

  _strongVerifyData: function _strongVerifyData() {
    var data = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

    if (typeof data == 'string') {
      data = { "string": data };
    }

    if (data == null) {
      data = {};
    }

    if (!data["userId"]) {
      if (this.userInfo && typeof this.userInfo == 'object' && this.userInfo.id) {
        data["userId"] = this.userInfo.id;
      }
    }
    return data;
  },

  _convertParameterToString: function _convertParameterToString(action) {
    var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var obj = {};
    obj.action = action;
    obj.data = data;

    return JSON.stringify(obj);
  },

  // 检查网络
  _checkNetwork: function _checkNetwork() {
    if (this.checkNetworkNow) {
      this.checkNetworkNow();
    }

    this.shouldCheck = true;
    if (!this.socketError) {
      this.recvTime = 0;
      this.sendMessage('checkAction', '');
      this.scheduleOnce(function () {
        this.checkNetworkEnd();
        this.shouldCheck = false;
        if (this.recvTime === 0) {
          this.connectionDisconnect();
        }
      }, 2.5);
    } else {
      this.connectionDisconnect();
    }
  },

  // MARK: socket 掉线尽早确认
  _checkSocket: function _checkSocket() {
    this.schedule(this._checkSocketExecute, SocketConstant.MaxReconnectCheckInterval, cc.macro.REPEAT_FOREVER);
  },

  _cancelCheckSocket: function _cancelCheckSocket() {
    this.unschedule(this._checkSocketExecute);
  },

  _checkSocketExecute: function _checkSocketExecute() {
    if (this._isSocketTimeout() && this.ws) {
      this.ws._kq_onerror('连接超时');
      return;
    }
  },

  // socket 是否已超时
  _isSocketTimeout: function _isSocketTimeout() {
    return this._lastReceiveMessageInterval() >= this._timeout;
  },

  // 上一次收到消息到现在的时间间隔
  _lastReceiveMessageInterval: function _lastReceiveMessageInterval() {
    var now = cc.sys.now();
    var interval = (now - this._lastReceiveMsgTime) / 1000;
    //cc.log(`WebSocket 现在距上一条收到消息的时间间隔是：${interval} 秒`);
    return interval;
  }

});

// MARK: Socket 事件定义
Socket.Event = {
  SocketConnecting: "SocketConnecting", // Socket 正在连接
  SocketConnectSuccessed: "SocketConnectSuccessed", // 连接成功
  SocketDisconnect: "SocketDisconnect", // Socket 断开连接
  SocketConnectError: "SocketConnectError", // Socket 连接错误
  SocketReceiveMessage: "SocketReceiveMessage", // Socket 接收到消息

  InviteCode: "inviteCode", // 客户端发送   邀请码
  JoinDesk: "joinDesk", // 客户端发送
  CreateDesk: "createDesk", // 客户端发送
  LeaveDesk: "leaveDesk", // 离开桌子
  DissolveDesk: "dissolveDesk", // 解散桌子
  AnswerDissolve: "answerDissolve", // 回答请求退出命令
  GetDeskInfo: "getDeskInfo", // 客户端发送
  SendImage: "sendImage", // 客户端发送
  SendText: "sendText", // 客户端发送
  SendAudioMessage: "sendAudioMessage", // 客户端发送  发送语音消息
  GetRecord: "getRecord", // 获取战绩信息
  GetItemRecord: "getItemRecord", // 获取战绩信息
  PlayCard: "playCard", // 客户端发送，用户打出牌
  TimeoutDissolve: "timeoutDissolve", // 请求退出超时时，需要发出的消息
  Feedback: "feedback", // 客户端发送  反馈信息
  SharePng: "sharePng", // 客户端发送  分享领取砖石
  EnterRandom: "interRandom", // 客户端发送  进入随机场
  CancelRandom: "cancelRandom", // 客户端发送  取消进入随机场
  ForceExitRandom: "dissolve", // 客户端发送 强制退出随机场
  Ready: "ready", // 客户端发送 准备
  GetHallInfo: "getHallInfo", // 客户端发送 获取大厅信息
  GetUserInfo: "getUserInfo", // 客户端发送 获取用户信息
  CheckAction: "checkAction", // 客户端发送，用来检测与服务器的连通性
  Pause: "pause", // 客户端进入后台时要发送的消息
  Active: "active", // 客户端回到前台时要发送的消息

  ReceiveRequestDissolve: "requestDissolve", // 请求解散桌子 服务器发送
  ReceiveRequestDissolveResult: "requestDissolveResult", // 请求解散桌子结果
  ReceiveChatText: "sendText", // 服务器发送
  ReceiveDeskInfo: "deskInfo", // 服务器发送
  ReceiveGameOver: "gameOver", // 服务器发送
  ReceiveFaPai: "fapai", // 服务器发送
  ReceiveSharePng: "sharePngs", // 服务器发送
  ReceiveOnlineStatus: "sendOnlineStatus", // 服务器发送
  ReceiveAudioMessage: "sendAudioMessage", // 服务器发送，接收到用户发送了语音消息
  ReceivePlayCard: "playCard", // 服务器发送，有用户已经准备好牌
  ReceiveCreateDesk: "createDesk", // 服务器发送，创建房间的回调
  ReceiveReady: "ready", // 服务器发送，有用户点击了准备
  ReceiveHallInfo: "getHallInfo", // 服务器发送
  ReceiveGetUserInfo: "getUserInfo", // 服务器发送 获取用户信息
  ReceiveCheckAction: "checkAction", // 服务器发送  用来确认 Socket 还在连着
  ReceiveForceExit: "forceExit", // 服务器发送  用来使客户端强退
  ReceiveDissolveDesk: "dissolveDesk", // 服务器发送   当房主退出时，解散桌子
  ReceiveInterRandom: "interRandom", // 服务器发送   进入随机场的反馈
  ReceivePause: "pause", // 服务器发送   当有用户设备进入后台时，会收到这条消息
  ReceiveInviteCode: 'inviteCode', // 服务器发送，收到邀请码的消息
  /**/
  ReceiveLeaveDesk: 'leaveDesk' };

// MARK: Socket 提供的可发给服务器消息的方法

// 服务器发送，收到需要离开桌子的消息
/**/
Socket.sendCheckAction = function () {
  this.instance.sendMessage(this.Event.CheckAction, null);
};
/**/
Socket.sendDidReceiveGameOverAction = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(Socket.Event.DidReceiveGameOverAction, param);
};
/**/

/**
 * 当 APP 进入后台时要发送的消息
 */
Socket.sendAppPause = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Pause, param);
};

/**
 * 当 APP 进入前台时发送的消息
 */
Socket.sendAppActive = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Active, param);
};

// 开房
Socket.sendCreateDesk = function (createDescInfo, userId) {
  cc.assert(createDescInfo);
  cc.assert(userId);

  createDescInfo["userId"] = userId;
  this.instance.sendMessage(this.Event.CreateDesk, createDescInfo);
};

// 加入房间
Socket.sendJoinDesk = function (roomId, userId) {
  cc.assert(roomId);
  cc.assert(userId);

  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.JoinDesk, param);
};

// 发送邀请码
Socket.sendInviteCode = function (inviteCode, userId) {
  var param = {
    "inviteCode": inviteCode,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.InviteCode, param);
};

// 获取房间信息
Socket.sendGetDesckInfo = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetDeskInfo, param);
};

Socket.sendText = function (userId, text) {
  cc.assert(userId);
  cc.assert(text);
  var param = {
    "msg": text,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendText, param);
};

Socket.sendAudioMessage = function (userId) {
  var url = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

  cc.assert(userId);
  cc.assert(url.length > 0);

  if (url.length == 0) {
    return;
  }

  var param = {
    "url": url,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendAudioMessage, param);
};

Socket.sendImage = function (userId, image) {
  cc.assert(userId);
  cc.assert(image);
  var param = {
    "msg": image,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendImage, param);
};

Socket.sendGetRecrod = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetRecord, param);
};

Socket.sendDissolveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.DissolveDesk, param);
};

Socket.sendGetItemRecord = function (userId, parentId) {
  cc.assert(userId);
  cc.assert(parentId);
  var param = {
    "userId": userId,
    "parentId": parentId
  };

  this.instance.sendMessage(this.Event.GetItemRecord, param);
};

Socket.sendLeaveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.LeaveDesk, param);
},

/**
 * 回答退房请求
 * 
 * @param  {Number} userId 当前用户 id
 * @param  {NUmber} answer=1 回答。1 表示同意； 0 表示拒绝； -1 表示未选择
 */
Socket.sendAnswerDissolve = function (userId) {
  var answer = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

  cc.assert(userId);
  var param = {
    "userId": userId,
    "answer": answer
  };

  this.instance.sendMessage(this.Event.AnswerDissolve, param);
}, Socket.sendForceExitRoom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.DissolveDesk, param);
},

// 十三张中
// cardInfo 类似于：
// [{
//         'cards':[{'suit':suit,'number':number},{}],//特殊牌不用传
//         'type':0,
//         'value':4,
//         'isContainExtra':true,// 特殊牌是否包含特殊牌
//     },
//     {
//         'cards':[{'suit':suit,'number':number},{}],
//         'type':0,
//         'value':4
//     }]
Socket.sendPlayCard = function (userId, cardInfo) {
  cc.assert(userId);
  var param = {
    "userId": userId,
    "card": cardInfo
  };

  this.instance.sendMessage(this.Event.PlayCard, param);
};

Socket.sendTimeoutDissolve = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.TimeoutDissolve, param);
};

Socket.sendFeedback = function (userId, text) {
  cc.assert(userId);
  cc.assert(text);
  var param = {
    "userId": userId,
    "text": text
  };

  this.instance.sendMessage(this.Event.Feedback, param);
};

Socket.sendSharePng = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SharePng, param);
};
// 开始匹配随机场
Socket.sendEnterRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.EnterRandom, param);
};

// 取消匹配随机场
Socket.sendCancelRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.CancelRandom, param);
};

// 准备
Socket.sendReady = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.Ready, param);
},

// 获取大厅信息
Socket.sendGetHallInfo = function (userId) {
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetHallInfo, param);
},

// 获取用户信息
Socket.sendGetUserInfo = function (userId, openId) {
  var param = {
    "userId": userId,
    "openId": openId
  };

  this.instance.sendMessage(this.Event.GetUserInfo, param);
}, module.exports = Socket;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"test":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3a5ah1deZEh6HfPdghRXyA', 'test');
// scripts\KQCard\test.js

console.log(2 < 2);

cc._RFpop();
},{}],"userInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e8d10xRGnJAn42wJsuC6aBi', 'userInfo');
// scripts\userInfo.js

var AudioManager = require('AudioManager');
var Playback = require('Playback');

cc.Class({
  'extends': cc.Component,

  properties: {
    spriteAvatar: cc.Sprite,
    labelNickname: cc.Label,
    labelScore: cc.Label,
    spriteOffline: cc.Sprite,
    voiceNode: cc.Node,
    homeRunNode: cc.Node,
    readyNode: cc.Node,
    shootNodes: [cc.Node],
    bankerNode: cc.Node,
    fangZhuNode: cc.Node
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.updateScore();
  },

  setReadyNodeVisible: function setReadyNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.readyNode.active = visible != false;
  },

  setFangZhuNodeVisible: function setFangZhuNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.fangZhuNode.active = visible != false;
  },

  updateScore: function updateScore() {
    var score = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    this.labelScore.string = "" + score;
  },

  updateNickname: function updateNickname() {
    var nickname = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    this.labelNickname.string = nickname;
  },

  updateAvatar: function updateAvatar(avatar) {
    if (avatar.endsWith("png") || avatar.endsWith("jpg") || avatar.endsWith("gif")) {} else {
      avatar = avatar + ".png";
    }

    cc.loader.load(avatar, (function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      this.spriteAvatar.spriteFrame = frame;
    }).bind(this));
  },

  setOfflineVisible: function setOfflineVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    if (Playback.instance.isPlaybacking()) {
      // 如果是处理回放状态，就不用再处理离线消息了
      return;
    }

    this.spriteOffline.node.active = visible;
  },

  setIsBanker: function setIsBanker() {
    var isBanker = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.bankerNode.active = isBanker;
  },

  playShootAnimation: function playShootAnimation() {
    var toIndex = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    var shootNode = this.shootNodes[toIndex];
    shootNode.active = true;
    var anim = shootNode.getComponent(cc.Animation);
    anim.play('shoot').on('finished', function () {
      shootNode.active = false;
    }, this);

    AudioManager.instance.playDaQiang();
  },

  playBulletHoleAnimation: function playBulletHoleAnimation() {
    var bulletHoleNode = this.node.getChildByName('bulletHole');
    bulletHoleNode.active = true;
    var anim = bulletHoleNode.getComponent(cc.Animation);
    anim.play('bulletHole').on('finished', function () {
      bulletHoleNode.active = false;
    }, this);
  },

  playSpeakAnimation: function playSpeakAnimation() {
    this.voiceNode.active = true;
    this.scheduleOnce((function () {
      this.voiceNode.active = false;
    }).bind(this), 4);
  },

  // 播放全垒打动画
  playHomeRunAimation: function playHomeRunAimation() {
    var alert = this.homeRunNode.getComponent('alert');
    alert.alert();
    this.scheduleOnce((function () {
      this.homeRunNode.active = false;
    }).bind(this), 2);
  }
});

cc._RFpop();
},{"AudioManager":"AudioManager","Playback":"Playback"}],"zhuanNumCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1b0dfWuicJLYJDmjjT1lmQc', 'zhuanNumCtrl');
// scripts\zhuanNumCtrl.js

cc.Class({
    "extends": cc.Component,

    properties: {
        zhuanNumLabel: cc.Label,
        jushu: cc.Node,
        AA: cc.Node,
        _selectedPeopleIndex: null,
        _selectedJushuIndex: null,
        _selectedAAIndex: null
    },

    onLoad: function onLoad() {
        this._ctrl();
    },

    clickPeopleAction: function clickPeopleAction() {
        this._ctrl();
    },

    clickAAAction: function clickAAAction() {
        this._ctrl();
    },

    clickJushuAction: function clickJushuAction() {
        this._ctrl();
    },

    _ctrl: function _ctrl() {
        this._selectedPeopleIndex = this.node.getComponent("singleSelect").selectedIndex;
        this._selectedJushuIndex = this.jushu.getComponent("singleSelect").selectedIndex;
        this._selectedAAIndex = this.AA.getComponent("checkSelect").selectedIndex;
        //人数选2人时且没选上AA制收费
        var renShu = 2;
        if (this._selectedPeopleIndex == 0) {
            renShu = 2;
        } else if (this._selectedPeopleIndex == 1) {
            renShu = 3;
        } else if (this._selectedPeopleIndex == 2) {
            renShu = 4;
        } else if (this._selectedPeopleIndex == 3) {
            renShu = 5;
        }
        var zhuangShi = 20;
        if (this._selectedJushuIndex == 0) {
            zhuangShi = 20;
        } else if (this._selectedJushuIndex == 1) {
            zhuangShi = 40;
        } else if (this._selectedJushuIndex == 2) {
            zhuangShi = 80;
        } else if (this._selectedJushuIndex == 3) {
            zhuangShi = 10;
        }
        //AA
        if (this._selectedAAIndex != null) {
            zhuangShi = Math.ceil(zhuangShi / renShu);
        }
        this.zhuanNumLabel.string = zhuangShi;
        //if(this._selectedPeopleIndex == 0){
        //    if(this._selectedAAIndex == null){
        //局数选10局时
        //if(this._selectedJushuIndex == 0){
        //    this.zhuanNumLabel.string = "10";
        //}
        ////局数选20局时
        //if(this._selectedJushuIndex == 1){
        //    this.zhuanNumLabel.string = "30";
        //}
        ////局数选30局时
        //if(this._selectedJushuIndex == 2){
        //    this.zhuanNumLabel.string = "80";
        //}
        //}
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "8";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "15";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "23";
        //        }
        //    }
        //
        //}
        //人数选3人
        //else if(this._selectedPeopleIndex == 1){
        //    //没选上AA制收费
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "42";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "60";
        //        }
        //    }
        //    //选了AA收费
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "20";
        //        }
        //    }
        //
        //}
        ////人数选4人且没选上AA制收费
        //else{
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "28";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "56";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "84";
        //        }
        //    }
        //    //AA制收费选上了
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //    }
        //}
    }
});

cc._RFpop();
},{}]},{},["AudioManager","CardPrefab","CardTypeCombine","CardTypeSprite","ChatMessage","MsgControl","KQGlobalEvent","ArrayExtension","NumberExtension","SpriteHelper","StringExtension","fecha","Invit","GetCardPointsSameCount","KQCard","KQCardColorsHelper","KQCardFindTypeExtension","KQCardPointsHelper","KQCardResHelper","KQCardScoreExtension","KQCardScoretsHelper","KQCardSelectExtension","test","UserModelHelper","NetworkError","ChatTextRecord","CompareCards","Countdown","GameResult","Player","ResultItem","TotalGameResult","TotalGameResultItem","UserSampleInfo","maPai","Playback","Setting","KQGlabolSocketEventHander","KQNativeInvoke","agreement","alert","cards","cardsBack","cellText","checkSelect","choujiang","game","hall","help","inviteCode","joinRoom","launch","login","manager","play","product","randRoom","record","recordInfo","rule","select","selectMoShi","select_ma","select_mapai","singleSelect","slider","socket","userInfo","zhuanNumCtrl"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkU6L0NvY29zQ3JlYXRvci9yZXNvdXJjZXMvYXBwLmFzYXIvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvQXJyYXlFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9BdWRpby9BdWRpb01hbmFnZXIuanMiLCJhc3NldHMvc2NyaXB0cy9DYXJkUHJlZmFiLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2FyZFR5cGVDb21iaW5lLmpzIiwiYXNzZXRzL3NjcmlwdHMvQ2FyZFR5cGVTcHJpdGUuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L0NoYXRNZXNzYWdlLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NoYXRUZXh0UmVjb3JkLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NvbXBhcmVDYXJkcy5qcyIsImFzc2V0cy9zY3JpcHRzL1BlZmFicy9Db3VudGRvd24uanMiLCJFOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvaW5kZXguanMiLCJFOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanMiLCJFOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzIiwiRTovQ29jb3NDcmVhdG9yL3Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvR2FtZVJlc3VsdC5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9HZXRDYXJkUG9pbnRzU2FtZUNvdW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvSW52aXQuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkQ29sb3JzSGVscGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZFBvaW50c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRSZXNIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmVFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmV0c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRTZWxlY3RFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkLmpzIiwiYXNzZXRzL3NjcmlwdHMvU29ja2V0L0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIuanMiLCJhc3NldHMvc2NyaXB0cy9FdmVudC9LUUdsb2JhbEV2ZW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvVXRpbHMvS1FOYXRpdmVJbnZva2UuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L01zZ0NvbnRyb2wuanMiLCJhc3NldHMvc2NyaXB0cy9OZXR3b3JrRXJyb3IuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL051bWJlckV4dGVuc2lvbi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXliYWNrL1BsYXliYWNrLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9QbGF5ZXIuanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L1Jlc3VsdEl0ZW0uanMiLCJhc3NldHMvc2NyaXB0cy9TZXR0aW5nL1NldHRpbmcuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL1Nwcml0ZUhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvU3RyaW5nRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHRJdGVtLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHQuanMiLCJhc3NldHMvc2NyaXB0cy9Nb2RlbFV0aWxzL1VzZXJNb2RlbEhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvVXNlclNhbXBsZUluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9hZ3JlZW1lbnQuanMiLCJhc3NldHMvc2NyaXB0cy9hbGVydC5qcyIsImFzc2V0cy9zY3JpcHRzL2NhcmRzQmFjay5qcyIsImFzc2V0cy9zY3JpcHRzL2NhcmRzLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2VsbFRleHQuanMiLCJhc3NldHMvc2NyaXB0cy9jaGVja1NlbGVjdC5qcyIsImFzc2V0cy9zY3JpcHRzL2Nob3VqaWFuZy5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvZmVjaGEuanMiLCJhc3NldHMvc2NyaXB0cy9nYW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvaGFsbC5qcyIsImFzc2V0cy9zY3JpcHRzL2hlbHAuanMiLCJhc3NldHMvc2NyaXB0cy9pbnZpdGVDb2RlLmpzIiwiYXNzZXRzL3NjcmlwdHMvam9pblJvb20uanMiLCJhc3NldHMvc2NyaXB0cy9sYXVuY2guanMiLCJhc3NldHMvc2NyaXB0cy9sb2dpbi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvbWFQYWkuanMiLCJhc3NldHMvc2NyaXB0cy9tYW5hZ2VyLmpzIiwiYXNzZXRzL3NjcmlwdHMvcGxheS5qcyIsImFzc2V0cy9zY3JpcHRzL3Byb2R1Y3QuanMiLCJhc3NldHMvc2NyaXB0cy9yYW5kUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL3JlY29yZEluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9yZWNvcmQuanMiLCJhc3NldHMvc2NyaXB0cy9ydWxlLmpzIiwiYXNzZXRzL3NjcmlwdHMvc2VsZWN0TW9TaGkuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RfbWFwYWkuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RfbWEuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3QuanMiLCJhc3NldHMvc2NyaXB0cy9zaW5nbGVTZWxlY3QuanMiLCJhc3NldHMvc2NyaXB0cy9zbGlkZXIuanMiLCJhc3NldHMvc2NyaXB0cy9zb2NrZXQuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvdGVzdC5qcyIsImFzc2V0cy9zY3JpcHRzL3VzZXJJbmZvLmpzIiwiYXNzZXRzL3NjcmlwdHMvemh1YW5OdW1DdHJsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7OztBQ0FBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQURBO0FBR0E7QUFEQTtBQUNFO0FBQ0U7QUFHSjtBQUZJO0FBQ0U7QUFDRDtBQUNEO0FBQ0U7QUFDRDtBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBSUo7QUFGSTtBQUNFO0FBQ0E7QUFDRTtBQUNEO0FBQ0Y7QUFDRDtBQUNEO0FBQ0Y7QUFJRDtBQUZBO0FBQ0U7QUFDRTtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUlKO0FBRkk7QUFDRTtBQUNBO0FBQ0U7QUFDRDtBQUNGO0FBQ0Q7QUFDRDtBQUNGO0FBSUQ7QUFEQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBR0o7QUFETTtBQUNBO0FBQ0U7QUFDRDtBQUdQO0FBRE07QUFHTjtBQURNO0FBQ0E7QUFHTjtBQURNO0FBQ0E7QUFDRTtBQUNEO0FBR1A7QUFETTtBQUNBO0FBQ0E7QUFHTjtBQURNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdOO0FBRE07QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNEO0FBQ0Q7QUFDRDtBQUdQO0FBRE07QUFDQTtBQUNEO0FBNUNnRDtBQThDcEQ7QUFHRDtBQURBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFBZ0Q7QUFJcEQ7QUFITTtBQUNFO0FBQ0Q7QUFLUDtBQUhNO0FBQ0Q7QUFSOEM7QUFjbkQ7QUFIRTtBQUNFO0FBQ0E7QUFDRTtBQUtOO0FBSE07QUFDRDtBQU5tRDtBQVl4RDtBQUhFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFLTjtBQUhNO0FBQ0U7QUFLUjtBQUhRO0FBQ0U7QUFDQTtBQUNFO0FBQ0Q7QUFDQztBQUNEO0FBS1g7QUFIVTtBQUNFO0FBQ0Q7QUFDRjtBQUNGO0FBQ0Q7QUFDRDtBQXZCK0M7QUF5Qm5EO0FBS0Q7QUFGQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNEO0FBQ0Q7QUFDRTtBQUNBO0FBQ0U7QUFDRDtBQUNEO0FBQ0U7QUFDRDtBQUNEO0FBQ0Q7QUFDRDtBQUNBO0FBQ0U7QUFDQTtBQUNEO0FBSUw7QUFGSTtBQUNBO0FBQ0U7QUFDQTtBQUlOO0FBRk07QUFDQTtBQUlOO0FBRk07QUFDQTtBQUNFO0FBQ0Q7QUFJUDtBQUZNO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDRDtBQUlUO0FBRlE7QUFDQTtBQUNFO0FBQ0Q7QUFDRjtBQUlQO0FBRk07QUFDQTtBQUNBO0FBSU47QUFGTTtBQUNBO0FBQ0E7QUFDQTtBQUlOO0FBRk07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNEO0FBQ0M7QUFDRDtBQUNEO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0Y7QUFDRjtBQUlEO0FBRkE7QUFDRTtBQUFrRDtBQUtwRDtBQUpJO0FBQ0U7QUFDRDtBQU1MO0FBSkk7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0Q7QUFDRjtBQUNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRDtBQUNDO0FBQ0Q7QUFDRjtBQUVGO0FBS0w7QUFISTtBQUNEO0FBQ0Y7QUFLRDtBQUhBO0FBQ0U7QUFDRTtBQUNBO0FBQTJDO0FBTS9DO0FBTE07QUFDRDtBQUorQztBQU1uRDtBQU9EO0FBTEE7QUFDRTtBQUFtRDtBQVFyRDtBQVBJO0FBQ0Q7QUFDRjtBQVNEO0FBUEE7QUFDRTtBQUNFO0FBQ0E7QUFBOEI7QUFVbEM7QUFUTTtBQVdOO0FBWmtDO0FBRzFCO0FBQ0E7QUFDRTtBQUNEO0FBQ0Q7QUFDQTtBQUNFO0FBQ0Q7QUFDQztBQUNBO0FBQ0Q7QUFieUI7QUEwQmxDO0FBeEJNO0FBQXdCO0FBMkI5QjtBQTNCOEI7QUFZdkI7QUFrQlA7QUFoQk07QUFDRDtBQW5CMEQ7QUFxQjlEO0FBa0JEO0FBaEJBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNEO0FBa0JQO0FBaEJNO0FBQ0U7QUFDRDtBQWtCUDtBQWhCTTtBQUNBO0FBQ0E7QUFrQk47QUFoQk07QUFDRDtBQWhCaUU7QUFrQnJFO0FBa0JEO0FBaEJBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNEO0FBa0JQO0FBaEJNO0FBQ0U7QUFDQTtBQUNEO0FBa0JQO0FBaEJNO0FBa0JOO0FBaEJNO0FBQ0Q7QUFmaUQ7QUFpQnJEO0FBa0JEO0FBaEJBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNEO0FBa0JQO0FBaEJNO0FBQ0E7QUFDRTtBQUNFO0FBQ0Q7QUFDRjtBQWtCUDtBQWhCTTtBQUNEO0FBZm1EO0FBaUJ2RDtBQWtCRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFpBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1E7QUFDRTtBQUNBO0FBQ1Y7QUFDQTtBQUNRO0FBQ0U7QUFDQTtBQUNWO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDUTtBQUNHO0FBQ0E7QUFDWDtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDRztBQUNBO0FBQ1g7QUFDUTtBQUNHO0FBQ0E7QUFDWDtBQUNRO0FBQ0c7QUFDQTtBQUNYO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDUTtBQUNBO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNFO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURNO0FBQ0E7QUFHTjtBQURNO0FBQ0E7QUFHTjtBQUNBO0FBREk7QUFDRTtBQUNBO0FBR047QUFDQTtBQUNBO0FBREk7QUFHSjtBQUNBO0FBSE07QUFDQTtBQUNBO0FBS047QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUtoQjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUNBO0FBQ0E7QUFOTTtBQVFOO0FBTlU7QUFDQTtBQUNBO0FBQ0Y7QUFRUjtBQUNBO0FBTk07QUFDQTtBQUNBO0FBUU47QUFDQTtBQUNBO0FBTkk7QUFRSjtBQUNBO0FBUk07QUFDQTtBQUNBO0FBVU47QUFDQTtBQVJJO0FBQ0U7QUFDQTtBQVVOO0FBQ0E7QUFSSTtBQUNFO0FBQ0E7QUFVTjtBQUNBO0FBUkk7QUFDRTtBQUNBO0FBVU47QUFDQTtBQVJJO0FBQ0k7QUFDQTtBQUNFO0FBVVY7QUFDQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBQ0E7QUFDQTtBQVJJO0FBQ0U7QUFDQTtBQUNFO0FBVVI7QUFDQTtBQVJRO0FBQ0E7QUFDQTtBQUNBO0FBVVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkk7QUFDRTtBQVVOO0FBQ0E7QUFLSTtBQUNJO0FBQ0E7QUFIUjtBQUNBO0FBS0k7QUFDSTtBQUNBO0FBSFI7QUFDQTtBQUtJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFIWjtBQUNBO0FBS1E7QUFIUjtBQUNBO0FBQ0E7QUFLSTtBQUNJO0FBQ0E7QUFIUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUNBO0FBQ0k7QUFIWjtBQUtRO0FBSFI7QUFLUTtBQUhSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLRTtBQUNFO0FBQ0E7QUFDRTtBQUhOO0FBS0k7QUFISjtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUhSO0FBQ0E7QUFLSTtBQUNJO0FBSFI7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUhSO0FBQ0E7QUFDQTtBQUtBO0FBSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9UQTtBQUNBO0FBREE7QUFHQTtBQURBO0FBQ0k7QUFHSjtBQURJO0FBQ0k7QUFHUjtBQURRO0FBQ0E7QUFKUTtBQVFoQjtBQURJO0FBQ0E7QUFDRTtBQUNEO0FBR0w7QUFESTtBQUNBO0FBQ0U7QUFHTjtBQURNO0FBQ0U7QUFDRDtBQUNGO0FBR0w7QUFESTtBQUNFO0FBQ0Q7QUFHTDtBQURJO0FBQ0U7QUFDRDtBQUdMO0FBREk7QUFDRTtBQUNBO0FBQ0Q7QUFHTDtBQURJO0FBQ0E7QUFBeUM7QUFJN0M7QUFITTtBQUNEO0FBS0w7QUFISTtBQUNFO0FBQ0Q7QUFLTDtBQUhJO0FBQ0U7QUFDQTtBQUNFO0FBQ0Q7QUFLUDtBQUhNO0FBQ0Q7QUFLTDtBQUhJO0FBQ0U7QUFLTjtBQUhNO0FBQ0U7QUFDRTtBQUNBO0FBQ0Q7QUFLVDtBQUhRO0FBQ0E7QUFDQTtBQUNEO0FBQ0Y7QUFwRUk7QUEwRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pGQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFEQTtBQUNJO0FBQ0E7QUFDSTtBQUdSO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFEUTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUdaO0FBRFE7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFHUjtBQUZZO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJWjtBQUNBO0FBRlk7QUFDQTtBQUNBO0FBQ0E7QUFJWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBRlE7QUFDSTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFJSjtBQUNBO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBT2hCO0FBQ0E7QUFMUTtBQUNBO0FBQ0E7QUFPUjtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQU9aO0FBQ0E7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBT1I7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFPUjtBQUNBO0FBTEk7QUFDSTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUxJO0FBQ0k7QUFDQTtBQU9SO0FBQ0E7QUFMSTtBQUNJO0FBQ0k7QUFDQTtBQU9aO0FBTFE7QUFPUjtBQUNBO0FBTEk7QUFDSTtBQU9SO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBSVE7QUFGUjtBQUNBO0FBSVE7QUFDQTtBQUNJO0FBRlo7QUFDQTtBQUlRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSVE7QUFGUjtBQUNBO0FBSVE7QUFDSTtBQUNJO0FBRmhCO0FBSWdCO0FBRmhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBQ0E7QUFJUTtBQUNBO0FBQ0E7QUFDSTtBQUZaO0FBSVk7QUFGWjtBQUdnQjtBQURoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHZ0I7QUFDQTtBQUNJO0FBQ0E7QUFEcEI7QUFHb0I7QUFDSTtBQUNBO0FBRHhCO0FBQ0E7QUFHb0I7QUFDSTtBQUNBO0FBRHhCO0FBQ0E7QUFJb0I7QUFDSTtBQUNBO0FBRnhCO0FBQ0E7QUFJb0I7QUFDSTtBQUNBO0FBRnhCO0FBQ0E7QUFDQTtBQUNBO0FBSVk7QUFDSTtBQUNBO0FBRmhCO0FBSWdCO0FBRmhCO0FBQ0E7QUFDQTtBQUlRO0FBQ0E7QUFDSTtBQUZaO0FBQ0E7QUFJUTtBQUZSO0FBQ0E7QUFJUTtBQUNBO0FBRlI7QUFJUTtBQUNJO0FBQ0E7QUFGWjtBQUNBO0FBQ0E7QUFJUTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFGaEI7QUFJWTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlRO0FBRlI7QUFJUTtBQUNBO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFGSjtBQUlRO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUNBO0FBRlI7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUZSO0FBQ0E7QUFDQTtBQUlJO0FBRko7QUFJUTtBQUZSO0FBSVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGUjtBQUlRO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUNBO0FBSUk7QUFDSTtBQUZSO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUNBO0FBRlI7QUFJUTtBQUNBO0FBQ0E7QUFGUjtBQUNBO0FBSUk7QUFDSTtBQUNBO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUlRO0FBQ0E7QUFGUjtBQUlRO0FBQ0k7QUFDQTtBQUNBO0FBRlo7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBQ0E7QUFDQTtBQUlRO0FBQ0E7QUFDSTtBQUNBO0FBRlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGUTtBQUNJO0FBQ0E7QUFDQTtBQUlaO0FBQ0E7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNJO0FBSVo7QUFGUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBSVo7QUFGUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZRO0FBQ0k7QUFJWjtBQUNBO0FBRlE7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBRlk7QUFJWjtBQUZZO0FBSVo7QUFGWTtBQUlaO0FBRlE7QUFJUjtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSVI7QUFGWTtBQUNBO0FBSVo7QUFDQTtBQUZRO0FBSVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0k7QUFJWjtBQUZZO0FBSVo7QUFGWTtBQUlaO0FBRlE7QUFJUjtBQUNBO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBSVo7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUlaO0FBRlE7QUFDSTtBQUlaO0FBRlk7QUFJWjtBQUZZO0FBQ0k7QUFJaEI7QUFDQTtBQUNBO0FBRlE7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBSVI7QUFGUTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBSWhCO0FBRmdCO0FBSWhCO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFJSjtBQUNBO0FBSlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBTWhCO0FBQ0E7QUFKWTtBQU1aO0FBQ0E7QUFDQTtBQUpJO0FBQ0k7QUFDQTtBQUNJO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBSlE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU1aO0FBQ0E7QUFKUTtBQUNBO0FBTVI7QUFDQTtBQUhRO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFLaEI7QUFDQTtBQUhZO0FBQ0k7QUFDQTtBQUNBO0FBS2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhRO0FBQ0k7QUFDQTtBQUNBO0FBS1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBS1o7QUFIUTtBQUNJO0FBS1o7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0k7QUFLWjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFLUjtBQUhRO0FBQ0k7QUFLWjtBQUNBO0FBSFk7QUFLWjtBQUhnQjtBQUtoQjtBQUhvQjtBQUNBO0FBQ0E7QUFLcEI7QUFDQTtBQUNBO0FBSG9CO0FBQ0E7QUFDQTtBQUtwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSFE7QUFDSTtBQUtaO0FBQ0E7QUFIWTtBQUtaO0FBSGdCO0FBS2hCO0FBSG9CO0FBS3BCO0FBSHdCO0FBQ0E7QUFDQTtBQUt4QjtBQUNBO0FBQ0E7QUFId0I7QUFDQTtBQUNBO0FBS3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSFE7QUFDSTtBQUtaO0FBQ0E7QUFIWTtBQUtaO0FBSGdCO0FBS2hCO0FBSG9CO0FBS3BCO0FBSHdCO0FBQ0E7QUFDQTtBQUt4QjtBQUNBO0FBQ0E7QUFId0I7QUFDQTtBQUNBO0FBS3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBS1o7QUFIUTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBS1o7QUFDQTtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFLWjtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUtoQjtBQUNBO0FBQ0E7QUFIUTtBQUtSO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFMUTtBQUNBO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDSTtBQU9aO0FBTFk7QUFPWjtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQU9SO0FBTFE7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFPcEI7QUFDQTtBQUxZO0FBQ0E7QUFPWjtBQUNBO0FBTFE7QUFDSTtBQU9aO0FBTFE7QUFDQTtBQU9SO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFPUjtBQUNBO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFOUTtBQUNBO0FBUVI7QUFOUTtBQVFSO0FBTlE7QUFDQTtBQVFSO0FBTlE7QUFDSTtBQUNBO0FBUVo7QUFDQTtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFRUjtBQU5RO0FBQ0E7QUFRUjtBQUNBO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFDQTtBQU5RO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRUjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBTkk7QUFDSTtBQUNJO0FBUVo7QUFDQTtBQU5RO0FBQ0k7QUFDQTtBQVFaO0FBQ0E7QUFOUTtBQVFSO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFDQTtBQUNBO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcGpDQTtBQUNBO0FBREE7QUFDQTtBQUNJO0FBR0o7QUFESTtBQUNFO0FBQ0E7QUFGVTtBQU1oQjtBQURJO0FBQ0E7QUFHSjtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDRDtBQUNGO0FBQ0w7QUFDSTtBQUNFO0FBQ0Q7QUFDTDtBQUNJO0FBQ0U7QUFDRDtBQUNMO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDRDtBQUNQO0FBQ007QUFDRDtBQUNMO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDRTtBQUNFO0FBQ0E7QUFDRDtBQUNUO0FBQ1E7QUFDQTtBQUNBO0FBQ0Q7QUFDRjtBQW5ESTtBQXFEVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0RBO0FBQ0E7QUFEQTtBQUdBO0FBREE7QUFDSTtBQUdKO0FBREk7QUFDRTtBQUNBO0FBRlU7QUFNaEI7QUFESTtBQUNBO0FBR0o7QUFDSTtBQUFtRDtBQUFBO0FBR3ZEO0FBRk07QUFDRTtBQUNEO0FBSVA7QUFGTTtBQUlOO0FBRk07QUFDQTtBQUlOO0FBRk07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJTjtBQUZNO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRDtBQUlQO0FBRk07QUFDQTtBQUlOO0FBRk07QUFDQTtBQUlOO0FBRk07QUFDRTtBQUNBO0FBQ0Q7QUFDRjtBQUlMO0FBRkk7QUFDRTtBQUNEO0FBSUw7QUF4RDJCO0FBMEQzQjtBQUZBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRDtBQUlIO0FBRkU7QUFDRDtBQUlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRUE7QUFDQTtBQURBO0FBQ0k7QUFHSjtBQURJO0FBR0o7QUFBSTtBQUNBO0FBRUo7QUFFSTtBQUNFO0FBQ0Q7QUFBTDtBQUVJO0FBQ0U7QUFDRDtBQUFMO0FBakJTO0FBbUJUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFUTtBQUNBO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDQTtBQUFSO0FBRVE7QUFDSTtBQUFaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQWhCO0FBRVk7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQXBCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBWjtBQUVZO0FBQVo7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUNJO0FBRlo7QUFDQTtBQUlRO0FBQ0E7QUFDSTtBQUZaO0FBQ0E7QUFJUTtBQUZSO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFDSTtBQUZoQjtBQUNBO0FBSVE7QUFDQTtBQUNBO0FBQ0k7QUFGWjtBQUtZO0FBSFo7QUFLUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSFo7QUFDQTtBQU1JO0FBSko7QUFNUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFKWjtBQUNBO0FBTUk7QUFKSjtBQUNBO0FBTVE7QUFKUjtBQU1RO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFKaEI7QUFDQTtBQUNBO0FBT1E7QUFDQTtBQUNJO0FBQ0k7QUFMaEI7QUFDQTtBQU9ZO0FBTFo7QUFPWTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUx4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTSTtBQUNJO0FBQ0k7QUFDQTtBQVBaO0FBQ0E7QUFTUTtBQUNJO0FBQ0E7QUFDQTtBQVBaO0FBQ0E7QUFTUTtBQUNJO0FBQ0E7QUFDSTtBQVBoQjtBQUNBO0FBQ0E7QUFDQTtBQVNJO0FBQ0k7QUFDSTtBQVBaO0FBU1E7QUFDQTtBQUNJO0FBUFo7QUFVWTtBQUNBO0FBQ0k7QUFSaEI7QUFDQTtBQVVRO0FBQ0E7QUFDQTtBQVJSO0FBQ0E7QUFXSTtBQUNJO0FBQ0k7QUFUWjtBQVdRO0FBQ0E7QUFDSTtBQVRaO0FBV1k7QUFDQTtBQUNJO0FBVGhCO0FBQ0E7QUFXUTtBQUNBO0FBQ0E7QUFUUjtBQUNBO0FBV0k7QUFDSTtBQUNJO0FBVFo7QUFXUTtBQUNBO0FBQ0k7QUFUWjtBQVdZO0FBQ0E7QUFDSTtBQVRoQjtBQUNBO0FBQ0E7QUFXUTtBQUNBO0FBVFI7QUFDQTtBQVdJO0FBQ0k7QUFDQTtBQUNJO0FBVFo7QUFDQTtBQVdRO0FBQ0k7QUFUWjtBQVdZO0FBVFo7QUFXWTtBQVRaO0FBQ0E7QUFDQTtBQVlJO0FBQ0k7QUFDQTtBQUNBO0FBVlI7QUFDQTtBQVlJO0FBQ0k7QUFDSTtBQVZaO0FBQ0E7QUFDQTtBQVlJO0FBQ0k7QUFDQTtBQUNJO0FBVlo7QUFDQTtBQUNBO0FBWUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JUQTtBQUNBO0FBREE7QUFDSTtBQUdKO0FBREk7QUFDSTtBQUdSO0FBRFE7QUFIUTtBQU9oQjtBQURJO0FBQ0E7QUFDSTtBQUNIO0FBR0w7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUNIO0FBR0w7QUFESTtBQUNJO0FBQ0E7QUFHUjtBQURRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSDtBQUdUO0FBRFE7QUFDSDtBQUdMO0FBREk7QUFDSTtBQUNBO0FBR1I7QUFEUTtBQUNJO0FBQ0g7QUFHVDtBQURRO0FBQ0g7QUFHTDtBQXZEUztBQXlEVDtBQUNBO0FBQ0E7QUMzREEsQUQ0REE7QUMzREEsQUQ0REE7QUMzREEsQUQ0REE7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2xIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDN3ZEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNGO0FBQ0E7QUFFQTtBQUNFO0FBQUY7QUFFRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQUo7QUFFSTtBQUFKO0FBRUk7QUFDQTtBQUNBO0FBQUo7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUFKO0FBQ0E7QUFFRTtBQUNFO0FBQ0E7QUFBSjtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSjtBQUVJO0FBQ0U7QUFBTjtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0E7QUFDRTtBQUFOO0FBQ0E7QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBQ0E7QUFFTTtBQUNBO0FBQ0E7QUFDQTtBQUFOO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFBSjtBQUNBO0FBRUU7QUFDRTtBQUNFO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0E7QUFDRTtBQUFOO0FBQ0E7QUFFSTtBQUNBO0FBQUo7QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUNFO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RIQTtBQUNBO0FBQ0M7QUFDRztBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ1E7QUFDSTtBQUNaO0FBQ1k7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5QkE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNFO0FBQ1I7QUFDUTtBQUNSO0FBQ007QUFDQTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQU07QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0U7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDRTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDRTtBQUNBO0FBRUU7QUFDVjtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNWO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRkE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNFO0FBR0Y7QUFERTtBQUNFO0FBQ0E7QUFDQTtBQUNEO0FBQ0Y7QUFHRDtBQURBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNEO0FBR0g7QUFERTtBQUNEO0FBR0Q7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDQTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNSO0FBQ007QUFDTjtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNKO0FBQ0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNGO0FBQ0U7QUFDRTtBQUNJO0FBQ1I7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNaO0FBQ1k7QUFDWjtBQUNBO0FBQ1E7QUFDRTtBQUNFO0FBQ1o7QUFDVTtBQUNWO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUdFO0FBQ0E7QUFDRTtBQURKO0FBR0U7QUFERjtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0U7QUFDRTtBQURKO0FBR0U7QUFERjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHRTtBQUNFO0FBQ0E7QUFDRTtBQUROO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0k7QUFDQTtBQUNFO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdFO0FBQ0E7QUFERjtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNKO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNBO0FBRUU7QUFDRTtBQUFKO0FBRUk7QUFBSjtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFDTTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ1I7QUFDTTtBQUNOO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDTjtBQUFRO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRWQ7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFERTtBQUNFO0FBR0o7QUFESTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBRE07QUFHTjtBQURJO0FBR0o7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBSEU7QUFDRTtBQUtKO0FBSEU7QUFDQTtBQUtGO0FBSEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUtSO0FBQ0E7QUFGTTtBQUNFO0FBQ0E7QUFJUjtBQUNBO0FBRk07QUFDRTtBQUNBO0FBSVI7QUFDQTtBQUZNO0FBQ0U7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUNBO0FBRkU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBSVI7QUFGTTtBQUlOO0FBQ0E7QUFGRTtBQUlGO0FBRkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUNBO0FBTFU7QUFDSTtBQU9kO0FBTlU7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFRaEI7QUFDQTtBQUNBO0FBTFU7QUFPVjtBQUxVO0FBT1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxFO0FBQ0E7QUFDQTtBQUNFO0FBT0o7QUFMSTtBQUNBO0FBQ0U7QUFPTjtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDRTtBQUNBO0FBQ0U7QUFPSjtBQUxFO0FBT0Y7QUFMRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9OO0FBQ0E7QUFMRTtBQUNFO0FBT0o7QUFMRTtBQUNBO0FBT0Y7QUFDQTtBQUxBO0FBQ0U7QUFDRTtBQU9KO0FBTEU7QUFDQTtBQU9GO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQVBFO0FBQ0U7QUFTSjtBQVBFO0FBQ0U7QUFTSjtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFTRjtBQUNBO0FBUEU7QUFDRTtBQVNKO0FBUEU7QUFDRTtBQUNBO0FBQ0E7QUFTSjtBQUNBO0FBUEU7QUFTRjtBQUNBO0FBUEU7QUFDRTtBQUNBO0FBU0o7QUFSTTtBQUNBO0FBQ0U7QUFVUjtBQVJVO0FBQ0U7QUFVWjtBQUNBO0FBUlU7QUFVVjtBQVJRO0FBVVI7QUFDQTtBQVJNO0FBQ0E7QUFVTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFURTtBQUNBO0FBQ0U7QUFXSjtBQUNBO0FBVEU7QUFDRTtBQVdKO0FBQ0E7QUFURTtBQVdGO0FBVEE7QUFXQTtBQUNBO0FBWEU7QUFDRTtBQWFKO0FBWEU7QUFDQTtBQWFGO0FBWEU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBYU47QUFDQTtBQUNBO0FBWEU7QUFDRTtBQWFKO0FBWEU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFhTjtBQUNBO0FBQ0E7QUFkUTtBQUNJO0FBZ0JaO0FBZlE7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFpQmQ7QUFDQTtBQUNBO0FBQ0E7QUFkUTtBQUNBO0FBZ0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmRTtBQUNFO0FBaUJKO0FBZkk7QUFDQTtBQUNFO0FBaUJOO0FBZkk7QUFpQko7QUFDQTtBQWZBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFpQk47QUFDQTtBQWZJO0FBQ0U7QUFDRTtBQUNFO0FBaUJWO0FBZlE7QUFDRTtBQWlCVjtBQWZRO0FBaUJSO0FBQ0E7QUFmTTtBQUNFO0FBaUJSO0FBQ0E7QUFmTTtBQUNBO0FBQ0E7QUFpQk47QUFDQTtBQUNBO0FBZkU7QUFpQkY7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQWlCQTtBQUNBO0FBakJFO0FBQ0U7QUFtQko7QUFDQTtBQWpCRTtBQUNBO0FBbUJGO0FBakJFO0FBQ0E7QUFDRTtBQUNBO0FBbUJKO0FBbEJNO0FBQ0E7QUFDRTtBQUNFO0FBb0JWO0FBbEJVO0FBb0JWO0FBQ0E7QUFsQk07QUFDQTtBQW9CTjtBQUNBO0FBQ0E7QUFuQkU7QUFxQkY7QUFuQkE7QUFDRTtBQUNFO0FBcUJKO0FBbkJFO0FBQ0E7QUFxQkY7QUFuQkU7QUFxQkY7QUFuQkU7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBcUJOO0FBQ0E7QUFDQTtBQXRCUTtBQUNJO0FBd0JaO0FBdkJRO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBeUJkO0FBQ0E7QUFDQTtBQUNBO0FBdEJRO0FBQ0E7QUF3QlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZCRTtBQXlCRjtBQUNBO0FBdkJBO0FBQ0U7QUFDQTtBQUNFO0FBeUJKO0FBQ0E7QUF0QkU7QUFDQTtBQUNBO0FBd0JGO0FBQ0E7QUFDQTtBQXRCRTtBQUNFO0FBQ0U7QUFDRTtBQXdCUjtBQXRCUTtBQUNBO0FBd0JSO0FBdEJRO0FBd0JSO0FBQ0E7QUFDQTtBQXRCSTtBQUNFO0FBQ0U7QUF3QlI7QUFDQTtBQUNBO0FBQ0E7QUF0QlE7QUFDQTtBQXdCUjtBQUNBO0FBQ0E7QUFDQTtBQXRCUTtBQXdCUjtBQUNBO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFzQlo7QUFDQTtBQXBCUTtBQUNFO0FBc0JWO0FBQ0E7QUFwQk07QUFDRTtBQXNCUjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQXNCSjtBQXBCRTtBQXNCRjtBQXBCQTtBQUNFO0FBQ0E7QUFDRTtBQXNCSjtBQXBCRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQXNCTjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBc0JOO0FBQ0E7QUFDQTtBQXBCRTtBQUNFO0FBc0JKO0FBcEJFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFzQlo7QUFDQTtBQXBCUTtBQUNFO0FBc0JWO0FBQ0E7QUFwQk07QUFDRTtBQXNCUjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQXNCSjtBQXBCRTtBQXNCRjtBQUNBO0FBcEJBO0FBc0JBO0FBQ0E7QUF0QkU7QUF3QkY7QUF2Qkk7QUFDRTtBQUNBO0FBQ0U7QUF5QlI7QUFDQTtBQUNBO0FBQ0E7QUF2QkU7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUF5Qk47QUF4QlE7QUFDRTtBQUNBO0FBQ0U7QUEwQlo7QUFDQTtBQUNBO0FBeEJRO0FBQ0E7QUFDRTtBQTBCVjtBQUNBO0FBQ0E7QUFDQTtBQXhCRTtBQUNFO0FBMEJKO0FBeEJFO0FBQ0E7QUEwQkY7QUFDQTtBQXhCQTtBQUNFO0FBQ0U7QUEwQko7QUF4Qkk7QUFDQTtBQTBCSjtBQXpCTTtBQUNFO0FBMkJSO0FBekJRO0FBQ0E7QUEyQlI7QUFDQTtBQUNBO0FBekJJO0FBQ0k7QUFDQTtBQUNBO0FBQ0Y7QUFDSTtBQUNBO0FBMkJWO0FBekJNO0FBMkJOO0FBMUJRO0FBQ0E7QUE0QlI7QUFDQTtBQUNBO0FBekJFO0FBMkJGO0FBQ0E7QUF4QkE7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBZ0JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy8yQkE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDSjtBQUNVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFEQTtBQUNFO0FBQ0U7QUFDRDtBQUdIO0FBREU7QUFDRTtBQUNFO0FBQ0Q7QUFDRjtBQUdIO0FBREU7QUFDRTtBQUNBO0FBQ0U7QUFDRDtBQUdMO0FBREk7QUFDRDtBQUdIO0FBREU7QUFDRTtBQUdKO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFDRDtBQUdQO0FBRE07QUFDQTtBQUNBO0FBQ0Q7QUFDRjtBQWpDVTtBQXFDYjtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNGO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDTjtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNGO0FBQ0k7QUFDRTtBQUNOO0FBQ0k7QUFDSjtBQUNJO0FBQ0U7QUFDTjtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRUk7QUFBSjtBQUNNO0FBQ047QUFDSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFBTjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBQ0E7QUFHSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFETjtBQUVRO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFETjtBQUNBO0FBR0k7QUFDQTtBQURKO0FBQ0E7QUFLSTtBQUNBO0FBSEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFITjtBQUtJO0FBSEo7QUFDQTtBQU1JO0FBSko7QUFLTTtBQUhOO0FBS0k7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUhOO0FBS007QUFDQTtBQUhOO0FBS0k7QUFISjtBQUNBO0FBQ0E7QUFNSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUpOO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUNFO0FBSFY7QUFLVTtBQUhWO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDQTtBQUhOO0FBS0k7QUFDQTtBQUhKO0FBQ0E7QUFDQTtBQU9JO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUxOO0FBTVE7QUFDRTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBSlo7QUFDQTtBQUNBO0FBUVE7QUFOUjtBQU9VO0FBQ0U7QUFDQTtBQUxaO0FBT1k7QUFDQTtBQUxaO0FBQ0E7QUFDQTtBQUNBO0FBVUk7QUFDQTtBQUNBO0FBQ0E7QUFSSjtBQUNBO0FBQ0E7QUFXSTtBQUNBO0FBQ0E7QUFDQTtBQVRKO0FBV0k7QUFDRTtBQUNFO0FBVFI7QUFXTTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQVRWO0FBV1U7QUFUVjtBQUNBO0FBV007QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQVRSO0FBV007QUFDQTtBQVROO0FBQ0E7QUFXSTtBQUNFO0FBVE47QUFVUTtBQVJSO0FBU1U7QUFDRTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBQ0E7QUFVUTtBQVJSO0FBU1U7QUFDRTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXSTtBQUNFO0FBQ0E7QUFUTjtBQVdJO0FBQ0E7QUFUSjtBQUNBO0FBWUk7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFWTjtBQVlJO0FBQ0U7QUFDQTtBQVZOO0FBWUk7QUFDQTtBQVZKO0FBQ0E7QUFhRTtBQUNBO0FBQ0U7QUFYSjtBQUNBO0FBYUU7QUFDQTtBQVhGO0FBYUE7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQVhOO0FBQ0E7QUFhRTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQVhSO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFaRjtBQWFJO0FBQ0U7QUFDRTtBQVhSO0FBQ0E7QUFDQTtBQWFFO0FBWEY7QUFZSTtBQUNFO0FBVk47QUFDQTtBQVlJO0FBQ0E7QUFDRTtBQUNBO0FBVk47QUFZSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBVlY7QUFDQTtBQUNBO0FBWUk7QUFWSjtBQVdNO0FBQ0U7QUFUUjtBQUNBO0FBQ0E7QUFDQTtBQVVJO0FBQ0U7QUFSTjtBQVVJO0FBQ0E7QUFSSjtBQVNNO0FBUE47QUFTSTtBQUNBO0FBQ0U7QUFDQTtBQVBOO0FBU0k7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQVBWO0FBQ0E7QUFDQTtBQVNJO0FBQ0E7QUFDQTtBQUNBO0FBUEo7QUFRTTtBQUNFO0FBTlI7QUFDQTtBQVFJO0FBTko7QUFDQTtBQVFFO0FBQ0U7QUFDRTtBQU5OO0FBQ0E7QUFRRTtBQUNFO0FBTko7QUFRRTtBQU5GO0FBQ0E7QUFRQTtBQUNFO0FBQ0U7QUFOSjtBQVFFO0FBQ0U7QUFOSjtBQVFFO0FBQ0E7QUFORjtBQVFFO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQU5OO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRRTtBQU5GO0FBQ0E7QUFRQTtBQUNFO0FBQ0E7QUFDRTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFDQTtBQVFFO0FBTkY7QUFDQTtBQUNBO0FBUUE7QUFDRTtBQUNFO0FBTko7QUFRRTtBQUNFO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQUNBO0FBUUU7QUFORjtBQUNBO0FBUUE7QUFDRTtBQU5GO0FBQ0E7QUFRQTtBQUNFO0FBTkY7QUFDQTtBQUNBO0FBUUE7QUFDRTtBQU5GO0FBQ0E7QUFDQTtBQVFBO0FBQ0U7QUFORjtBQUNBO0FBUUE7QUFDRTtBQU5GO0FBQ0E7QUFRQTtBQUNFO0FBTkY7QUFDQTtBQVFBO0FBQ0U7QUFORjtBQUNBO0FBUUE7QUFDRTtBQU5GO0FBQ0E7QUFRQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBTko7QUFRSTtBQUNFO0FBTk47QUFDQTtBQVFJO0FBTko7QUFDQTtBQVFFO0FBTkY7QUFDQTtBQVFBO0FBTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9pQkE7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDSjtBQUNVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0U7QUFDRjtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBV0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBVFo7QUFDQTtBQUNBO0FBV0k7QUFDQTtBQVRKO0FBV1E7QUFDQTtBQUNJO0FBVFo7QUFDQTtBQVNZO0FBQ0E7QUFDSTtBQUNBO0FBUGhCO0FBQ0E7QUFDQTtBQUNBO0FBU0k7QUFDSTtBQVBSO0FBQ0E7QUFTSTtBQUNJO0FBQ0E7QUFDSTtBQVBaO0FBQ0E7QUFTUTtBQVBSO0FBQ0E7QUFTSTtBQVBKO0FBQ0E7QUFTQTtBQVBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBb0I7QUFFNUI7QUFEUTtBQUFvQjtBQUk1QjtBQUhRO0FBQW9CO0FBTTVCO0FBTFE7QUFBb0I7QUFRNUI7QUFDQTtBQVBRO0FBQ0E7QUFDQTtBQUNBO0FBU1I7QUFQUTtBQUNBO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQUNJO0FBU1o7QUFQWTtBQVNaO0FBQ0E7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQVNKO0FBQ0E7QUFDQTtBQVZRO0FBWVI7QUFDQTtBQVZJO0FBQ0k7QUFDSTtBQVlaO0FBVlE7QUFZUjtBQUNBO0FBVEk7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBQ0E7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQVRJO0FBV0o7QUFUUTtBQUNBO0FBQ0k7QUFDQTtBQVdaO0FBVFk7QUFDQTtBQUNBO0FBV1o7QUFDQTtBQVRRO0FBV1I7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQVdKO0FBQ0E7QUFDQTtBQVRBO0FBQ0k7QUFDSTtBQUNBO0FBV1I7QUFDQTtBQUNBO0FBVEE7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQVRBO0FBV0E7QUFUQTtBQUNJO0FBQ0k7QUFXUjtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBQ0k7QUFDSTtBQVdSO0FBQ0E7QUFDQTtBQVRBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0o7QUFUSTtBQVdKO0FBVEk7QUFDQTtBQUNBO0FBV0o7QUFUSTtBQUNBO0FBV0o7QUFUSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0o7QUFDQTtBQUNBO0FBVEE7QUFDSTtBQUdBO0FBQ0E7QUFTSjtBQUNBO0FBQ0E7QUFQQTtBQUNJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBU0o7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBVEk7QUFDSTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBV1I7QUFDQTtBQVRJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFXWjtBQUNBO0FBVEk7QUFXSjtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQ0E7QUFYSTtBQUNJO0FBYVI7QUFYSTtBQUNJO0FBYVI7QUFYSTtBQWFKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBQ0k7QUFDSTtBQWFSO0FBWEk7QUFDQTtBQUNBO0FBYUo7QUFYSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFhaEI7QUFDQTtBQUNBO0FBWEk7QUFhSjtBQUNBO0FBWEE7QUFhQTtBQUNBO0FBYkk7QUFDSTtBQWVSO0FBQ0E7QUFiSTtBQUNJO0FBZVI7QUFDQTtBQWJJO0FBQ0k7QUFlUjtBQWJRO0FBZVI7QUFDQTtBQWJJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFlWjtBQUNBO0FBYlE7QUFlUjtBQUNBO0FBYkk7QUFlSjtBQUNBO0FBQ0E7QUFiQTtBQUNJO0FBQ0E7QUFDSTtBQWVSO0FBQ0E7QUFiSTtBQUNBO0FBQ0E7QUFlSjtBQWJJO0FBQ0k7QUFDQTtBQWVSO0FBQ0E7QUFiSTtBQWVKO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFlQTtBQWJRO0FBQ0E7QUFDSTtBQWVaO0FBQ0E7QUFiUTtBQUNJO0FBZVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFCSTtBQTRCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBckJJO0FBdUJKO0FBckJBO0FBQ0k7QUFDSTtBQXVCUjtBQXJCSTtBQXVCSjtBQXRCUTtBQUNJO0FBd0JaO0FBQ0E7QUF0Qkk7QUF3Qko7QUFDQTtBQXRCQTtBQXdCQTtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBMEJBO0FBQ0E7QUExQkk7QUFDSTtBQTRCUjtBQTFCSTtBQUNJO0FBNEJSO0FBMUJJO0FBNEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNBO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUFDQTtBQUNBO0FBeEJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBMEJaO0FBeEJZO0FBMEJaO0FBeEJZO0FBMEJaO0FBeEJZO0FBMEJaO0FBQ0E7QUF4Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNBO0FBQ0k7QUEwQlI7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUFDQTtBQXhCQTtBQTBCQTtBQXhCSTtBQUNBO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDQTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCUTtBQTBCUjtBQXhCSTtBQUNJO0FBQ0k7QUEwQlo7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNBO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDQTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUEwQlo7QUF4Qlk7QUEwQlo7QUF4Qlk7QUEwQlo7QUF4Qlk7QUEwQlo7QUFDQTtBQXhCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUEwQlo7QUFDQTtBQUNBO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBQ0E7QUF4Qkk7QUFDSTtBQUNJO0FBQ0k7QUEwQmhCO0FBQ0E7QUF4QlE7QUEwQlI7QUFDQTtBQUNBO0FBeEJRO0FBQ0k7QUFDSTtBQTBCaEI7QUFDQTtBQUNBO0FBeEJRO0FBMEJSO0FBQ0E7QUFDQTtBQXhCUTtBQUNJO0FBMEJaO0FBQ0E7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUEwQlo7QUF4Qlk7QUEwQlo7QUFDQTtBQUNBO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBQ0E7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNBO0FBQ0k7QUEwQlI7QUFDQTtBQXhCSTtBQTBCSjtBQXhCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQTBCWjtBQXZCWTtBQXlCWjtBQXRCWTtBQXdCWjtBQUNBO0FBdEJJO0FBd0JKO0FBQ0E7QUF0QkE7QUFDSTtBQUNBO0FBQ0k7QUF3QlI7QUFDQTtBQXRCSTtBQUNBO0FBd0JKO0FBdEJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBd0JaO0FBckJZO0FBdUJaO0FBcEJZO0FBc0JaO0FBQ0E7QUFwQkk7QUFzQko7QUFDQTtBQXBCQTtBQUNJO0FBQ0k7QUFzQlI7QUFDQTtBQUNBO0FBcEJJO0FBQ0k7QUFzQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBCSTtBQUNJO0FBc0JSO0FBQ0E7QUFwQkk7QUFDSTtBQXNCUjtBQXBCSTtBQUNJO0FBQ0k7QUFzQlo7QUFDQTtBQXBCUTtBQUNJO0FBc0JaO0FBcEJRO0FBQ0k7QUFDSTtBQXNCaEI7QUFDQTtBQXBCWTtBQUNJO0FBc0JoQjtBQXBCWTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFzQnhCO0FBQ0E7QUFwQmdCO0FBQ0k7QUFzQnBCO0FBQ0E7QUFwQmdCO0FBQ0k7QUFDSTtBQUNBO0FBc0J4QjtBQUNBO0FBcEJnQjtBQXNCaEI7QUFwQmdCO0FBc0JoQjtBQUNBO0FBcEJZO0FBc0JaO0FBQ0E7QUFwQlE7QUFzQlI7QUFDQTtBQUNBO0FBQ0E7QUFwQkE7QUFDSTtBQUNJO0FBc0JSO0FBcEJZO0FBc0JaO0FBQ0E7QUFwQkk7QUFzQko7QUFDQTtBQXBCQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFzQlo7QUFwQlE7QUFDSTtBQXNCWjtBQXBCUTtBQUNBO0FBc0JSO0FBcEJZO0FBc0JaO0FBcEJnQjtBQUNJO0FBQ0k7QUFzQnhCO0FBcEI0QjtBQUNJO0FBc0JoQztBQXBCNEI7QUFzQjVCO0FBQ0E7QUFDQTtBQUNBO0FBcEJnQjtBQUNJO0FBQ0k7QUFzQnhCO0FBcEJvQjtBQUNJO0FBc0J4QjtBQXBCb0I7QUFDQTtBQXNCcEI7QUFwQndCO0FBQ0k7QUFDSTtBQUNJO0FBc0JwQztBQXBCd0M7QUFDSTtBQXNCNUM7QUFwQndDO0FBc0J4QztBQUNBO0FBQ0E7QUFDQTtBQXBCNEI7QUFzQjVCO0FBcEJnQztBQXNCaEM7QUFDQTtBQXBCNEI7QUFzQjVCO0FBQ0E7QUFwQndCO0FBc0J4QjtBQUNBO0FBQ0E7QUFDQTtBQXBCWTtBQXNCWjtBQUNBO0FBQ0E7QUFDQTtBQXBCQTtBQUNJO0FBQ0E7QUFDSTtBQXNCUjtBQXBCSTtBQUNJO0FBc0JSO0FBcEJJO0FBQ0E7QUFDSTtBQXNCUjtBQXBCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXNCSjtBQXJCUTtBQXVCUjtBQUNBO0FBckJJO0FBdUJKO0FBdEJRO0FBd0JSO0FBdEJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBd0JaO0FBQ0E7QUF2Qlk7QUF5Qlo7QUFDQTtBQUNBO0FBdkJJO0FBeUJKO0FBeEJRO0FBQ0E7QUFDSTtBQTBCWjtBQXhCUTtBQUNJO0FBMEJaO0FBekJnQjtBQTJCaEI7QUFDQTtBQXpCWTtBQUNBO0FBQ0k7QUFDQTtBQTJCaEI7QUExQm9CO0FBQ0E7QUE0QnBCO0FBQ0E7QUExQlk7QUE0Qlo7QUEzQmdCO0FBNkJoQjtBQTVCb0I7QUE4QnBCO0FBNUJnQjtBQUNBO0FBOEJoQjtBQTVCWTtBQUNJO0FBOEJoQjtBQTdCb0I7QUErQnBCO0FBQ0E7QUE3Qlk7QUErQlo7QUE5QmdCO0FBZ0NoQjtBQUNBO0FBOUJnQjtBQWdDaEI7QUFDQTtBQTlCUTtBQWdDUjtBQS9CWTtBQUNBO0FBaUNaO0FBQ0E7QUEvQlk7QUFpQ1o7QUFDQTtBQUNBO0FBL0JJO0FBQ0E7QUFpQ0o7QUFoQ1E7QUFrQ1I7QUFoQ0k7QUFDQTtBQUNJO0FBa0NSO0FBaENJO0FBa0NKO0FBQ0E7QUFoQ0E7QUFrQ0E7QUFDQTtBQWxDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBb0NSO0FBbENJO0FBQ0k7QUFDQTtBQW9DUjtBQWxDUTtBQUNJO0FBQ0E7QUFDSTtBQW9DaEI7QUFsQ1k7QUFvQ1o7QUFqQ1E7QUFDQTtBQW1DUjtBQWpDSTtBQW1DSjtBQUNBO0FBakNBO0FBQ0k7QUFtQ0o7QUFDQTtBQWhDQTtBQUNJO0FBQ0E7QUFDSTtBQWtDUjtBQWhDSTtBQUNBO0FBQ0k7QUFrQ1I7QUFoQ0k7QUFrQ0o7QUFoQ0k7QUFDQTtBQUNJO0FBQ0E7QUFrQ1I7QUFDQTtBQWhDSTtBQUNJO0FBa0NSO0FBQ0E7QUFoQ0k7QUFDSTtBQWtDUjtBQUNBO0FBaENJO0FBQ0E7QUFDQTtBQWtDSjtBQWhDSTtBQUNJO0FBa0NSO0FBQ0E7QUFoQ0k7QUFrQ0o7QUFDQTtBQUNBO0FBaENBO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFrQ1o7QUFoQ1E7QUFrQ1I7QUFDQTtBQWhDSTtBQWtDSjtBQUNBO0FBQ0E7QUFoQ0E7QUFDSTtBQWtDSjtBQUNBO0FBQ0E7QUE5QkE7QUFDSTtBQUNBO0FBQ0k7QUFnQ1I7QUFDQTtBQTlCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQWdDWjtBQUNBO0FBOUJJO0FBZ0NKO0FBQ0E7QUFDQTtBQTdCQTtBQUNJO0FBQ0E7QUFDSTtBQStCUjtBQTdCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQStCWjtBQUNBO0FBQ0E7QUE3Qkk7QUErQko7QUFDQTtBQUNBO0FBQ0E7QUE1QkE7QUFDSTtBQUNBO0FBQ0k7QUE4QlI7QUE1Qkk7QUFDQTtBQUNJO0FBOEJSO0FBNUJJO0FBQ0E7QUFDQTtBQUNJO0FBOEJSO0FBQ0E7QUE1Qkk7QUFDSTtBQThCUjtBQUNBO0FBNUJJO0FBQ0k7QUE4QlI7QUFDQTtBQTVCSTtBQUdJO0FBNEJSO0FBQ0E7QUExQkk7QUE0Qko7QUFDQTtBQUNBO0FBQ0E7QUF6QkE7QUFDSTtBQUNBO0FBQ0k7QUEyQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF6Qkk7QUFDSTtBQTJCUjtBQXpCSTtBQTJCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNBO0FBQ0k7QUEwQlI7QUFDQTtBQXhCSTtBQUNJO0FBQ0k7QUEwQlo7QUF4QlE7QUEwQlI7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0E7QUFDSTtBQTBCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBeEJRO0FBMEJSO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCUTtBQTBCUjtBQUNBO0FBeEJJO0FBQ0E7QUFDQTtBQUNBO0FBMEJKO0FBeEJJO0FBQ0k7QUFDSTtBQUNBO0FBMEJaO0FBQ0E7QUF4QlE7QUFDQTtBQTBCUjtBQUNBO0FBeEJJO0FBQ0E7QUEwQko7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUF4QlE7QUEwQlI7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0k7QUEwQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0k7QUEwQlI7QUFDQTtBQXhCSTtBQUNBO0FBQ0k7QUFDSTtBQTBCWjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0k7QUEwQlI7QUFDQTtBQXhCSTtBQUNBO0FBMEJKO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdEJBO0FBQ0k7QUFDUTtBQXdCWjtBQXRCUTtBQXdCUjtBQXRCSTtBQUNJO0FBQ0k7QUFDQTtBQXdCWjtBQXRCUTtBQXdCUjtBQUNBO0FBdEJJO0FBd0JKO0FBQ0E7QUF0QkE7QUFDSTtBQUNRO0FBd0JaO0FBdEJRO0FBd0JSO0FBdEJJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQXdCWjtBQXRCUTtBQXdCUjtBQUNBO0FBdEJJO0FBd0JKO0FBQ0E7QUFDQTtBQXRCQTtBQUNJO0FBQ0E7QUF3Qko7QUFDQTtBQXRCQTtBQXdCQTtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUEwQko7QUFDQTtBQXhCQTtBQTBCQTtBQUNBO0FBQ0E7QUEzQkk7QUFDQTtBQUNJO0FBNkJSO0FBM0JRO0FBQ0E7QUFDQTtBQUNJO0FBNkJaO0FBQ0E7QUEzQlE7QUFDSTtBQTZCWjtBQUNBO0FBM0JRO0FBNkJSO0FBQ0E7QUEzQkk7QUE2Qko7QUFDQTtBQUNBO0FBM0JBO0FBNkJBO0FBM0JJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQTZCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JtREE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUdBO0FBREE7QUFDSTtBQUNJO0FBQ0k7QUFDSDtBQUNEO0FBR1I7QUFEUTtBQUNIO0FBR0w7QUFESTtBQUNJO0FBQ0g7QUFaMkI7QUFnQmhDO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFEQTtBQUNJO0FBQ0E7QUFDQTtBQUFzQztBQUkxQztBQUhRO0FBQ0k7QUFDSDtBQUtUO0FBSFE7QUFDQTtBQUtSO0FBSFE7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDSjtBQUtUO0FBSFE7QUFDSDtBQUNEO0FBQ0E7QUFDSTtBQUNBO0FBS1I7QUFIUTtBQUNBO0FBQ0g7QUFLTDtBQUhJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUtMO0FBSEk7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0Q7QUFDQztBQUNEO0FBS1Q7QUFIUTtBQUNBO0FBQ0U7QUFDQTtBQUNEO0FBQ0Y7QUFDRjtBQXREZTtBQTREcEI7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDRTtBQUNBO0FBQ0Y7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNOO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFBSTtBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQUk7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFBRTtBQUNFO0FBRUo7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDRTtBQUNFO0FBRUo7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDRTtBQUNFO0FBRUo7QUFDQTtBQURJO0FBR0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDRTtBQUNFO0FBR0o7QUFDQTtBQUZJO0FBSUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDRTtBQUNFO0FBSUo7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDRTtBQUNFO0FBS0o7QUFDQTtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDRTtBQUNFO0FBTUo7QUFDQTtBQUpFO0FBQ0U7QUFNSjtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDRTtBQUNFO0FBTUo7QUFDQTtBQUpFO0FBQ0U7QUFNSjtBQUpJO0FBTUo7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBTlE7QUFDSTtBQVFaO0FBTlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFOUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFRUjtBQU5RO0FBQ0E7QUFDQTtBQUNJO0FBUVo7QUFOZ0I7QUFDSTtBQVFwQjtBQU5nQjtBQVFoQjtBQUxnQjtBQUNBO0FBQ0k7QUFDQTtBQU9wQjtBQUxnQjtBQU9oQjtBQUNBO0FBTFE7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDalFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDaEI7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRE07QUFDQTtBQUdOO0FBQ0E7QUFESTtBQUNFO0FBQ0E7QUFHTjtBQUNBO0FBREk7QUFDRTtBQUNBO0FBQ0U7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUdOO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFITTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0E7QUFLTjtBQUNBO0FBSEk7QUFDRTtBQUtOO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFLUjtBQUNBO0FBSEk7QUFDRTtBQUtOO0FBSE07QUFDRTtBQUNFO0FBS1Y7QUFDQTtBQUhRO0FBQ0U7QUFLVjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0U7QUFLTjtBQUhNO0FBQ0E7QUFDRTtBQUtSO0FBQ0E7QUFITTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0E7QUFDQTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBQ0E7QUFDQTtBQUtOO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaktBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFEQTtBQUNJO0FBR0o7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVlE7QUFjaEI7QUFESTtBQUNBO0FBR0o7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0s7QUFDRjtBQUNIO0FBQ0o7QUFDTDtBQTlCUztBQWdDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUdBO0FBREk7QUFHSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBQ0g7QUFHVDtBQURRO0FBQ0k7QUFDSTtBQUNIO0FBQ0c7QUFDSDtBQUNKO0FBQ0o7QUFDSjtBQUdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNFO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDRTtBQUNFO0FBQ1Y7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ1U7QUFDVjtBQUNBO0FBQ1E7QUFDRTtBQUNBO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNNO0FBQ0E7QUFDTjtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0Y7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBR1I7QUFDQTtBQURNO0FBQ0E7QUFHTjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBSE07QUFDRTtBQUtSO0FBQ0E7QUFITTtBQUNFO0FBS1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUtSO0FBSFE7QUFDSTtBQUtaO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDRTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBQ0E7QUFDRTtBQUtSO0FBQ0E7QUFITTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0E7QUFLTjtBQUNBO0FBSEk7QUFDRTtBQUtOO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFMTTtBQUNFO0FBT1I7QUFDQTtBQUxNO0FBQ0E7QUFPTjtBQUNBO0FBTEk7QUFDRTtBQUNFO0FBT1I7QUFDQTtBQUxNO0FBQ0E7QUFPTjtBQUNBO0FBQ0E7QUFMSTtBQUNFO0FBQ0U7QUFPUjtBQUNBO0FBTE07QUFDQTtBQUNBO0FBT047QUFMTTtBQU9OO0FBQ0E7QUFMVTtBQUNJO0FBQ0k7QUFPbEI7QUFMa0I7QUFPbEI7QUFDQTtBQUxRO0FBQ0E7QUFDQTtBQU9SO0FBTlk7QUFDQTtBQVFaO0FBTlE7QUFDQTtBQUNBO0FBQ0k7QUFRWjtBQU5RO0FBQ0k7QUFRWjtBQU5ZO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFRaEI7QUFOWTtBQUNJO0FBUWhCO0FBTlk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBUXhCO0FBQ0E7QUFOZ0I7QUFDSTtBQVFwQjtBQUxvQjtBQU9wQjtBQUpvQjtBQU1wQjtBQUpnQjtBQUNBO0FBQ0E7QUFDQTtBQU1oQjtBQUpZO0FBQ0E7QUFDQTtBQUNBO0FBTVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRjtBQUtOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNFO0FBQ0U7QUFLUjtBQUNBO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFDQTtBQUhJO0FBQ0U7QUFDRTtBQUtSO0FBQ0E7QUFITTtBQUNBO0FBS047QUFDQTtBQUNBO0FBSEk7QUFDRTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0E7QUFLTjtBQUNBO0FBSEk7QUFDRTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0E7QUFLTjtBQUNBO0FBSEk7QUFDRTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0E7QUFLTjtBQUNBO0FBSEk7QUFDRTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBS047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQU07QUFDQTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQU07QUFFTjtBQUFNO0FBQ0E7QUFDQTtBQUNBO0FBRU47QUFBVTtBQUVWO0FBQVE7QUFFUjtBQUNBO0FBQUk7QUFDRTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFEQTtBQUdBO0FBREE7QUFDSTtBQUdKO0FBREk7QUFDRTtBQUNBO0FBQ0E7QUFHTjtBQURNO0FBTFU7QUFTaEI7QUFESTtBQUNBO0FBQ0U7QUFDQTtBQUdOO0FBRE07QUFDRDtBQUdMO0FBREk7QUFDRTtBQUdOO0FBRE07QUFDQTtBQUdOO0FBRE07QUFDQTtBQUdOO0FBRE07QUFDQTtBQUNEO0FBR0w7QUFESTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0Q7QUFHUDtBQURNO0FBQ0U7QUFDQTtBQUNEO0FBQ0Y7QUFHTDtBQURJO0FBR0o7QUFDSTtBQUNFO0FBQ0U7QUFDRDtBQUNGO0FBckRJO0FBdURUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQURBO0FBQ0U7QUFDRTtBQUdFO0FBQ0Q7QUFDTDtBQUNJO0FBQ0U7QUFDRTtBQUNEO0FBQ1A7QUFDTTtBQUNBO0FBQ0Q7QUFDRjtBQWhCZ0I7QUFrQm5CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFEQTtBQUdBO0FBREE7QUFDQTtBQUdBO0FBREE7QUFDRztBQUNDO0FBR0o7QUFGSTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRDtBQUNEO0FBQ0Q7QUFDRDtBQUNBO0FBQ0U7QUFDRTtBQUNEO0FBQ0Q7QUFDQTtBQUNFO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFrQjtBQUNoQjtBQUNEO0FBQ0Q7QUFDQTtBQUNBO0FBQ0U7QUFDRDtBQUNEO0FBQ0E7QUFDRTtBQUNFO0FBQ0Q7QUFDRjtBQUNEO0FBQ0Q7QUFDRDtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBSDZDO0FBS2hEO0FBQ0M7QUFDRDtBQUNGO0FBQ0Y7QUFLRDtBQUhBO0FBQ0E7QUFDRTtBQUNBO0FBS0Y7QUFKRTtBQUNDO0FBQ0E7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDRDtBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0M7QUFDQTtBQUNDO0FBQ0E7QUFDQTtBQUFrQjtBQUNqQjtBQUNBO0FBQ0Q7QUFDRDtBQUNEO0FBQ0E7QUFDQTtBQUNDO0FBQ0E7QUFDRDtBQUNBO0FBQ0M7QUFDQztBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0Q7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUg0QztBQUs3QztBQUNBO0FBQ0E7QUFDRDtBQUNEO0FBT0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25JQTtBQUNBO0FBREE7QUFDQTtBQUNJO0FBR0o7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQU5RO0FBVWhCO0FBREk7QUFDQTtBQUdKO0FBQ0k7QUFDRTtBQUNFO0FBQ0Q7QUFDUDtBQUNNO0FBQ0E7QUFDRTtBQUNBO0FBQ0Q7QUFDUDtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRDtBQUNEO0FBQ0Q7QUFuQ0k7QUFxQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFFSTtBQUNJO0FBQ0Y7QUFDRTtBQUNBO0FBQ0U7QUFDSTtBQUFkO0FBRWM7QUFBZDtBQUVRO0FBQVI7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNJO0FBQVY7QUFDQTtBQUVVO0FBQVY7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNJO0FBQVY7QUFDQTtBQUVVO0FBQVY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBREE7QUFDRTtBQUNBO0FBQ0U7QUFHSjtBQURJO0FBQ0U7QUFDRDtBQUdMO0FBREk7QUFDRDtBQUdIO0FBREU7QUFDQTtBQUNFO0FBQ0Q7QUFmcUI7QUFtQnhCO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDRTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBQ0U7QUFDQTtBQUNBO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUROO0FBR007QUFDQTtBQUNBO0FBRE47QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNDO0FBQ1Q7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQUNBO0FBQ0E7QUFEUjtBQUdRO0FBQ0U7QUFEVjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBRFI7QUFHUTtBQUNFO0FBRFY7QUFDQTtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQURWO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFDQTtBQUNBO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFEVjtBQUNBO0FBQ0E7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUdRO0FBQ0U7QUFEVjtBQUNBO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFHSTtBQUNFO0FBRE47QUFDQTtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBRFI7QUFHUTtBQUNBO0FBQ0U7QUFEVjtBQUNBO0FBQ0E7QUFHSTtBQURKO0FBS0k7QUFDSTtBQUhSO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hMQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0k7QUFHSjtBQURJO0FBQ0k7QUFDQTtBQUZRO0FBTWhCO0FBREk7QUFDQTtBQUdKO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNEO0FBQ0Q7QUFDRDtBQUNGO0FBQ0w7QUFDSTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0Q7QUFDRjtBQW5DSTtBQXFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0E7QUFEQTtBQUNJO0FBR0o7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZRO0FBbUJoQjtBQURJO0FBQ0E7QUFHSjtBQXpCUztBQTJCVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFEQTtBQUNJO0FBR0o7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYUTtBQWVoQjtBQURJO0FBQ0E7QUFHSjtBQUNJO0FBQ0k7QUFDSDtBQUNMO0FBQ0k7QUFDSTtBQUNBO0FBQ0g7QUFDTDtBQUNJO0FBQ0o7QUFoQ1M7QUFrQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5QkE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFDSTtBQURaO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQURwQjtBQUdvQjtBQUNBO0FBRHBCO0FBR29CO0FBQ0E7QUFEcEI7QUFHZ0I7QUFDQTtBQUNJO0FBRHBCO0FBQ0E7QUFHUTtBQUNJO0FBRFo7QUFDQTtBQUdZO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFEcEI7QUFHZ0I7QUFDQTtBQURoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUZSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQURBO0FBQ0U7QUFHRjtBQURFO0FBR0Y7QUFDQTtBQUNBO0FBQ0E7QUFGRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUY7QUFERTtBQUNFO0FBQ0E7QUFDRTtBQUNEO0FBQ0Q7QUFDRDtBQUdIO0FBREU7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNEO0FBQ0Y7QUFDRjtBQUdIO0FBREU7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNEO0FBQ0Q7QUFDRDtBQUdIO0FBREU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Q7QUFSVTtBQVlmO0FBREU7QUFDRTtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0E7QUFDRDtBQWxGZTtBQXNGcEI7QUFERTtBQUNFO0FBQ0U7QUFDRDtBQUNEO0FBQ0U7QUFDRDtBQUNEO0FBQ0U7QUFDRDtBQUNEO0FBQ0U7QUFBQTtBQUNBO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNFO0FBQ0Q7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0Q7QUFDQztBQUNEO0FBQ0Y7QUFDRDtBQUNFO0FBQ0E7QUFBQTtBQUtOO0FBSE07QUFDRTtBQUNBO0FBQ0Q7QUFDRjtBQXZEYztBQXlEakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtGO0FBRkU7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSWTtBQWFoQjtBQUZFO0FBSUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZFO0FBQ0U7QUFJSjtBQUZJO0FBQ0U7QUFDRDtBQUlMO0FBRkk7QUFDRTtBQUNEO0FBSUw7QUFGSTtBQUlKO0FBRkk7QUFJSjtBQUZJO0FBQ0E7QUFDRTtBQUNBO0FBQ0Q7QUFDRDtBQUNBO0FBQ0U7QUFDRDtBQUNEO0FBQ0E7QUFDRTtBQUNEO0FBQ0Y7QUFJSDtBQUZFO0FBSUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkU7QUFDRTtBQUlKO0FBRkk7QUFDRTtBQUNEO0FBSUw7QUFGSTtBQUlKO0FBRkk7QUFDQTtBQUNBO0FBQ0U7QUFDRDtBQUlMO0FBRkk7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNEO0FBQ0M7QUFDRTtBQUNBO0FBQ0E7QUFDRDtBQUNGO0FBQ0Y7QUFJUDtBQUZNO0FBQ0Q7QUFJTDtBQUZJO0FBQ0U7QUFDRDtBQUlMO0FBRkk7QUFDQTtBQUNFO0FBQ0Q7QUFDQztBQUNEO0FBSUw7QUFGSTtBQUNBO0FBQ0U7QUFDQTtBQUVEO0FBQ0M7QUFFRDtBQUNEO0FBQ0Q7QUFFSDtBQUFFO0FBQ0E7QUFDRTtBQUNEO0FBQ0M7QUFDRTtBQUNEO0FBQ0Y7QUFDQztBQUNEO0FBQ0Y7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFZBO0FBQ0E7QUFEQTtBQUNJO0FBR0o7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBZmdCO0FBaUJoQjtBQURJO0FBQ0E7QUFHSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0g7QUFDTDtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0g7QUFDSjtBQUNMO0FBcENTO0FBc0NUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFBWTtBQUNBO0FBQ0E7QUFFWjtBQUFZO0FBQ0E7QUFDQTtBQUVaO0FBQ0E7QUFBUTtBQUVSO0FBQVE7QUFDSTtBQUNBO0FBRVo7QUFDUTtBQUNBO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFSO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUFSO0FBRVE7QUFBUjtBQUNZO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDWTtBQUNBO0FBQ0E7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUVRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFBaEI7QUFDQTtBQUNBO0FBRVk7QUFDQTtBQUFaO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNRO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQVk7QUFDSTtBQUVoQjtBQUFZO0FBRVo7QUFBWTtBQUNJO0FBRWhCO0FBQVk7QUFDQTtBQUVaO0FBQ0E7QUFEWTtBQUNBO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFEUTtBQUNJO0FBR1o7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0k7QUFDSTtBQUNJO0FBR3BCO0FBQ0E7QUFDQTtBQUNBO0FBRFk7QUFDSTtBQUNJO0FBR3BCO0FBQ0E7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFFUjtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFEUTtBQUdSO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUdOO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFETTtBQUdOO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFITTtBQUtOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFEUTtBQUNBO0FBQ0k7QUFDQTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBQ0k7QUFDQTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUdSO0FBRFE7QUFHUjtBQURRO0FBR1I7QUFEUTtBQUNJO0FBR1o7QUFBWTtBQUVaO0FBQVE7QUFFUjtBQURZO0FBR1o7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBR1I7QUFEUTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0k7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUdOO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUFJO0FBRUo7QUFBUTtBQUNBO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0k7QUFFVjtBQUNBO0FBQVU7QUFFVjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQ0E7QUFBWTtBQUVaO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFBUTtBQUNBO0FBQ0k7QUFFWjtBQUNBO0FBQVk7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ2dCO0FBQ2hCO0FBQ1k7QUFDSTtBQUNoQjtBQUNBO0FBQ1k7QUFDQTtBQUNBO0FBQ0k7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUVRO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBRVE7QUFBUjtBQUNBO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUVRO0FBQ0k7QUFBWjtBQUNBO0FBQ1k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFFTTtBQUNFO0FBQ0E7QUFBUjtBQUVNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFBZDtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUFSO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFBVjtBQUNBO0FBRVE7QUFDQTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFBaEI7QUFDQTtBQUNBO0FBRVE7QUFDSTtBQUNJO0FBQ0E7QUFBaEI7QUFFZ0I7QUFBaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNJO0FBQ0E7QUFBVjtBQUVNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUNJO0FBQVY7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQWhCO0FBQ0E7QUFDQTtBQUVRO0FBQ0k7QUFDQTtBQUNBO0FBQVo7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBWjtBQUVRO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBRUk7QUFDQTtBQUNJO0FBRGhCO0FBQ0E7QUFDQTtBQUdRO0FBQ0k7QUFDQTtBQUNBO0FBRFo7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFEWjtBQUdRO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNJO0FBRFo7QUFDQTtBQUdJO0FBQ0k7QUFDSTtBQURaO0FBR1k7QUFEWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqdEJBO0FBQ0k7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNZO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ1k7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDWTtBQUNaO0FBQ1k7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQU07QUFDQTtBQUVOO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBQ0E7QUFFRTtBQUNWO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ1Y7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNNO0FBQ0E7QUFDRTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNBO0FBRUU7QUFBVjtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQURBO0FBQ0k7QUFHSjtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWUTtBQWNoQjtBQURJO0FBQ0E7QUFDSTtBQUNJO0FBQ0g7QUFDSjtBQUdMO0FBeEJTO0FBMEJUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNZO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDaEI7QUFDWTtBQUNJO0FBQ0k7QUFDQTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNEO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNmO0FBRWU7QUFBZjtBQUNtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ21CO0FBQ0k7QUFDSTtBQUNBO0FBQzNCO0FBQ0E7QUFFdUI7QUFDSTtBQUNBO0FBQTNCO0FBQ0E7QUFDQTtBQUdtQjtBQURuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR087QUFDSTtBQUNBO0FBQ0E7QUFEWDtBQUVlO0FBQWY7QUFDQTtBQUNBO0FBRU87QUFDQztBQUNJO0FBQ0E7QUFBWjtBQUNBO0FBQ0E7QUFDQTtBQUZnQjtBQUNBO0FBQ0E7QUFJaEI7QUFGb0I7QUFDQTtBQUlwQjtBQUhnQjtBQUNJO0FBQ0E7QUFLcEI7QUFGb0I7QUFDQTtBQUlwQjtBQURvQjtBQUNBO0FBR3BCO0FBQW9CO0FBQ0E7QUFFcEI7QUFDb0I7QUFDQTtBQUNwQjtBQUNBO0FBQ2dCO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDcEI7QUFDQTtBQUNnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUFPO0FBQ0U7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFBUjtBQUVRO0FBQVI7QUFDQTtBQUVJO0FBQ0U7QUFBTjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBVjtBQUNBO0FBRVE7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUFWO0FBQ0E7QUFFUTtBQUNJO0FBQVo7QUFDQTtBQUNVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNaO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNZO0FBQ0E7QUFDWjtBQUFnQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBRXBCO0FBQWdCO0FBRWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURZO0FBQ0E7QUFHWjtBQUNBO0FBRFk7QUFHWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0U7QUFDRTtBQUVaO0FBQ0E7QUFBWTtBQUNBO0FBRVo7QUFBUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVI7QUFDQTtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFFUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDelJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBREE7QUFDSTtBQUdKO0FBREk7QUFDSTtBQUNIO0FBR0w7QUFESTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUdMO0FBREk7QUFDSTtBQUNIO0FBR0w7QUFESTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQUdMO0FBREk7QUFDSTtBQUNIO0FBR0w7QUFESTtBQUNJO0FBQ0E7QUFDSTtBQUNIO0FBQ0Q7QUFDSDtBQXJDWTtBQXlDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDSTtBQUFKO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFBUjtBQUVRO0FBQVI7QUFDQTtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFFUTtBQUFSO0FBRVE7QUFBUjtBQUVRO0FBQVI7QUFFUTtBQUFSO0FBQ0E7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFBUjtBQUNBO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUFRO0FBQ0E7QUFFUjtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBQ0E7QUFBUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVI7QUFBUTtBQUNBO0FBRVI7QUFBUTtBQUNBO0FBQ0E7QUFFUjtBQUFRO0FBQ0E7QUFFUjtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBRVI7QUFBUTtBQUNFO0FBQ0E7QUFDQTtBQUVWO0FBQ0E7QUFBVTtBQUVWO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQUo7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQVo7QUFFUTtBQUNJO0FBQVo7QUFFWTtBQUFaO0FBRVk7QUFBWjtBQUVZO0FBQ0E7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFBaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNFO0FBQU47QUFDQTtBQUVJO0FBQ0k7QUFDSTtBQUNBO0FBQVo7QUFDQTtBQUVRO0FBQ0k7QUFBWjtBQUVnQjtBQUFoQjtBQUVZO0FBQVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFUTtBQUNJO0FBQ0k7QUFBaEI7QUFFZ0I7QUFBaEI7QUFFWTtBQUFaO0FBQ0E7QUFFUTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUFSO0FBRVE7QUFBUjtBQUNBO0FBQ0E7QUFFSTtBQUNFO0FBQ0E7QUFBTjtBQUVNO0FBQ0E7QUFBTjtBQUNBO0FBRU07QUFBTjtBQUVNO0FBQ0U7QUFBUjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ007QUFDTjtBQUNVO0FBQ1Y7QUFDTTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ1k7QUFDWjtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURNO0FBR047QUFETTtBQUNBO0FBQ0U7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0U7QUFHTjtBQURJO0FBR0o7QUFEUTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUd4QjtBQUNBO0FBRmdDO0FBQ0E7QUFDSTtBQUlwQztBQUZvQztBQUlwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRjRCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJNUI7QUFGd0I7QUFJeEI7QUFEd0I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUc1QjtBQUNBO0FBRDRCO0FBQ0k7QUFHaEM7QUFDQTtBQUR3QjtBQUd4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNFO0FBQ0U7QUFHUjtBQURRO0FBQ0Y7QUFDQTtBQUdOO0FBRE07QUFDRTtBQUNFO0FBR1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0U7QUFFUjtBQUNBO0FBQU07QUFFTjtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUNJO0FBRVo7QUFBWTtBQUVaO0FBQVE7QUFFUjtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFBUTtBQUVSO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNJO0FBRVo7QUFDQTtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFFUjtBQUFRO0FBRVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFRO0FBQ0E7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUTtBQUNJO0FBQ0E7QUFDQTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVk7QUFFWjtBQUFRO0FBQ0E7QUFFUjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFBUTtBQUNJO0FBQ0k7QUFDQTtBQUVoQjtBQUNnQjtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ2dCO0FBQ2hCO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ1E7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNVO0FBQ0U7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNNO0FBQ0k7QUFDSTtBQUNBO0FBQ2Q7QUFDVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRFE7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUdOO0FBRE07QUFDQTtBQUdOO0FBRE07QUFDQTtBQUNFO0FBR1I7QUFDQTtBQURVO0FBQ0k7QUFHZDtBQUNBO0FBQ0E7QUFDQTtBQURNO0FBQ0U7QUFHUjtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0U7QUFHTjtBQURJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdOO0FBRFE7QUFHUjtBQURRO0FBQ0Y7QUFDQTtBQUdOO0FBQ0E7QUFESTtBQUNFO0FBQ0U7QUFDQTtBQUdSO0FBRE07QUFHTjtBQURRO0FBQ0E7QUFDSTtBQUdaO0FBRFE7QUFDRjtBQUdOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNNO0FBQ047QUFDTTtBQUNBO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQWdCO0FBRWhCO0FBQWdCO0FBRWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVE7QUFDSTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFRO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUVoQjtBQUNBO0FBQU07QUFDRTtBQUVSO0FBQ1E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ0E7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ0E7QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFFUTtBQUNBO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFFSTtBQUNFO0FBQ0E7QUFBTjtBQUVNO0FBQ0U7QUFBUjtBQUNBO0FBRU07QUFDQTtBQUFOO0FBQ0E7QUFFSTtBQUFKO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDRjtBQUNFO0FBQVI7QUFDQTtBQUVNO0FBQ0U7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFFSTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBQ0E7QUFFTTtBQUNFO0FBQ0E7QUFBUjtBQUNBO0FBRVE7QUFDQTtBQUNJO0FBQVo7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVNO0FBQ0U7QUFDQTtBQUFSO0FBQ0E7QUFHTTtBQUROO0FBR1U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNGO0FBQ0U7QUFEVjtBQUNBO0FBR1U7QUFEVjtBQUdRO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFDQTtBQUROO0FBR007QUFETjtBQUdNO0FBQ0E7QUFDQTtBQUROO0FBR007QUFDRTtBQUNFO0FBRFY7QUFDQTtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBSUk7QUFDRTtBQUZOO0FBSU07QUFDQTtBQUNFO0FBRlI7QUFDQTtBQUlNO0FBQ0E7QUFDRTtBQUNBO0FBRlI7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUNJO0FBSFo7QUFDQTtBQUtRO0FBSFI7QUFLWTtBQUhaO0FBQ0E7QUFLUTtBQUhSO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDRTtBQUhSO0FBQ0E7QUFLTTtBQUNBO0FBQ0U7QUFDRTtBQUhWO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFLTTtBQUNFO0FBSFI7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUNJO0FBQ0E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUhSO0FBS1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBSFo7QUFDQTtBQUNBO0FBS0k7QUFDRTtBQUNFO0FBSFI7QUFDQTtBQUtNO0FBQ0E7QUFDRTtBQUNBO0FBSFI7QUFDQTtBQUNBO0FBS0k7QUFDRTtBQUNBO0FBSE47QUFDQTtBQUtVO0FBSFY7QUFLUTtBQUhSO0FBQ0E7QUFLTTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBQ0U7QUFIUjtBQUNBO0FBQ0E7QUFNSTtBQUNFO0FBQ0U7QUFKUjtBQUNBO0FBQ0E7QUFDQTtBQU1JO0FBQ0U7QUFKTjtBQU1NO0FBSk47QUFDQTtBQU1JO0FBQ0U7QUFDRTtBQUpSO0FBQ0E7QUFNTTtBQUpOO0FBQ0E7QUFNSTtBQUNFO0FBQ0U7QUFKUjtBQUNBO0FBTU07QUFKTjtBQUNBO0FBTUk7QUFDRTtBQUpOO0FBQ0E7QUFNSTtBQUpKO0FBTU07QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUpSO0FBTU07QUFDRTtBQUpSO0FBQ0E7QUFNUTtBQUNFO0FBSlY7QUFNUTtBQUNBO0FBQ0E7QUFKUjtBQUNBO0FBQ0E7QUFDQTtBQU1JO0FBQ0U7QUFDRTtBQUNBO0FBSlI7QUFDQTtBQU1NO0FBQ0U7QUFDQTtBQUpSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1RO0FBQ0E7QUFKUjtBQUNBO0FBQ0E7QUFDQTtBQU1JO0FBQ0U7QUFDRTtBQUpSO0FBQ0E7QUFNTTtBQUpOO0FBQ0E7QUFDQTtBQU1JO0FBQ0U7QUFDRTtBQUpSO0FBQ0E7QUFNTTtBQUNFO0FBSlI7QUFDQTtBQU1NO0FBSk47QUFDQTtBQUNBO0FBTUk7QUFDRTtBQUNFO0FBSlI7QUFDQTtBQU1NO0FBSk47QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNJO0FBQ0E7QUFKUjtBQU1RO0FBQ0E7QUFKUjtBQU1RO0FBQ0Y7QUFDQTtBQUpOO0FBTU07QUFDQTtBQUNFO0FBQ0E7QUFKUjtBQUNBO0FBQ0E7QUFNSTtBQUpKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNUTtBQUNJO0FBSlo7QUFDQTtBQU1RO0FBQ0k7QUFKWjtBQU1RO0FBQ0E7QUFDQTtBQUNJO0FBSlo7QUFDQTtBQU1RO0FBQ0k7QUFKWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVE7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUpoQjtBQUNBO0FBQ0E7QUFNUTtBQUNBO0FBSlI7QUFNUTtBQUpSO0FBTVE7QUFKUjtBQU1RO0FBSlI7QUFNUTtBQUNBO0FBQ0k7QUFDSTtBQUpoQjtBQU1ZO0FBQ0E7QUFKWjtBQU1RO0FBQ0k7QUFDSTtBQUNJO0FBSnBCO0FBTWdCO0FBSmhCO0FBQ0E7QUFDQTtBQU1RO0FBSlI7QUFNUTtBQUNJO0FBQ0k7QUFKaEI7QUFNWTtBQUpaO0FBQ0E7QUFNUTtBQUNJO0FBSlo7QUFDQTtBQUNBO0FBT1E7QUFDSTtBQUxaO0FBQ0E7QUFDQTtBQU9JO0FBTEo7QUFDQTtBQUNBO0FBSVE7QUFDQTtBQUNBO0FBRlI7QUFJUTtBQUNJO0FBRlo7QUFDQTtBQUlRO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFGaEI7QUFDQTtBQUlRO0FBQ0k7QUFDSTtBQUZoQjtBQUlZO0FBRlo7QUFDQTtBQUlRO0FBRlI7QUFDQTtBQUlJO0FBRko7QUFDQTtBQU1JO0FBQ0U7QUFKTjtBQU1RO0FBSlI7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUpKO0FBQ0E7QUFJTTtBQUNFO0FBRlI7QUFDQTtBQUlRO0FBQ0k7QUFDQTtBQUNBO0FBRlo7QUFJUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFGWjtBQUlRO0FBQ0E7QUFGUjtBQUNBO0FBSUk7QUFDSTtBQUNJO0FBRlo7QUFDQTtBQUNBO0FBSUk7QUFDRTtBQUNBO0FBQ0U7QUFGUjtBQUNBO0FBSU07QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUZWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBQ0E7QUFFUTtBQUNJO0FBQ0E7QUFDQTtBQUFaO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQVo7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDSTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNNO0FBQ0k7QUFDQTtBQUFoQjtBQUVnQjtBQUNBO0FBQWhCO0FBRWdCO0FBQWhCO0FBQ0E7QUFFTTtBQUNFO0FBQ0U7QUFBVjtBQUVRO0FBQVI7QUFFWTtBQUNBO0FBQVo7QUFFWTtBQUNBO0FBQVo7QUFFTTtBQUNFO0FBQ0U7QUFBVjtBQUVRO0FBQVI7QUFFWTtBQUNBO0FBQVo7QUFFWTtBQUNBO0FBQVo7QUFFTTtBQUNNO0FBQ0E7QUFDRjtBQUFWO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDSTtBQUFaO0FBQ0E7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDQTtBQUFZO0FBQ0E7QUFFWjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0k7QUFFWjtBQUNBO0FBRFk7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQURJO0FBQ0U7QUFDRTtBQUdSO0FBQ0E7QUFETTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFETTtBQUNBO0FBQ0U7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUdOO0FBRFE7QUFHUjtBQURRO0FBQ0E7QUFDRTtBQUNFO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUVaO0FBQ0E7QUFBWTtBQUNBO0FBRVo7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFFTjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFFTjtBQUFNO0FBQ0E7QUFDQTtBQUVOO0FBQU07QUFFTjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDQTtBQUVOO0FBQU07QUFFTjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBRU47QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBRVI7QUFDQTtBQUFNO0FBQ0E7QUFFTjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDRTtBQUVSO0FBQ0E7QUFBTTtBQUVOO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDRTtBQUVSO0FBQ0E7QUFBTTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFRO0FBRVI7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUNJO0FBRVo7QUFBUTtBQUVSO0FBQ0E7QUFBSTtBQUNFO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNJO0FBRVY7QUFBTTtBQUNBO0FBRU47QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUVOO0FBQ0E7QUFDQTtBQUFNO0FBQ0k7QUFFVjtBQUNVO0FBQ1Y7QUFFVTtBQUFWO0FBR1U7QUFEVjtBQUdNO0FBRE47QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNBO0FBRE47QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNJO0FBRFY7QUFHTTtBQUNJO0FBRFY7QUFHTTtBQUNBO0FBRE47QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFJWTtBQUZaO0FBS1k7QUFIWjtBQUtRO0FBQ0E7QUFIUjtBQUNBO0FBQ0E7QUFLSTtBQUhKO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFIUjtBQUNBO0FBS007QUFDRTtBQUNBO0FBQ0E7QUFIUjtBQUNBO0FBS007QUFDQTtBQUNFO0FBQ0E7QUFIUjtBQUNBO0FBS007QUFDRTtBQUhSO0FBQ0E7QUFLTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSE47QUFLTTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBSFI7QUFDQTtBQUtNO0FBQ0E7QUFDRTtBQUhSO0FBQ0E7QUFLTTtBQUNBO0FBQ0U7QUFIUjtBQUNBO0FBS007QUFDQTtBQUhOO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDRTtBQUhSO0FBQ0E7QUFLTTtBQUNFO0FBQ0E7QUFIUjtBQUtRO0FBQ0E7QUFIUjtBQUNBO0FBS007QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBSFY7QUFDQTtBQUNBO0FBS007QUFDRTtBQUhSO0FBQ0E7QUFLTTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFIUjtBQUtNO0FBSE47QUFLTTtBQUNBO0FBQ0U7QUFIUjtBQUNBO0FBS007QUFDQTtBQUhOO0FBQ0E7QUFDQTtBQUtBO0FBQ0k7QUFISjtBQUtBO0FBSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3Y2REE7QUFDQTtBQURBO0FBQ0k7QUFHSjtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhRO0FBZWhCO0FBREk7QUFDQTtBQUdKO0FBQ0k7QUFDSTtBQUNIO0FBQ0w7QUFDSTtBQUNKO0FBM0JTO0FBNkJUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDTTtBQUNBO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFDQTtBQUVJO0FBQ0U7QUFDQTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUNBO0FBRUs7QUFDRztBQUFSO0FBRVE7QUFDSTtBQUNBO0FBQ0E7QUFBWjtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFaO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFFUTtBQUNJO0FBQ0E7QUFBWjtBQUNBO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEtBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFEQTtBQUNJO0FBR0o7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQVRRO0FBYWhCO0FBREk7QUFDQTtBQUdKO0FBQ0k7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Q7QUFDUDtBQUNNO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDRDtBQUNGO0FBQ0w7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0Q7QUFDUDtBQUNRO0FBQ0g7QUFDTDtBQUNJO0FBQ0U7QUFDQTtBQUNEO0FBQ0w7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNEO0FBQ1Q7QUFDUTtBQUNBO0FBQ0k7QUFDQTtBQUNIO0FBQ0o7QUFDTDtBQXJFUztBQXVFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0VBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDSTtBQUdKO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUpRO0FBUWhCO0FBREk7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNIO0FBR0w7QUFESTtBQUNFO0FBQ0E7QUFDRDtBQUdMO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBR1I7QUFEUTtBQUNFO0FBQ0Q7QUFDQztBQUNBO0FBQ0E7QUFDQTtBQUNEO0FBQ0o7QUFHTDtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNIO0FBQ0o7QUFHTDtBQURJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDSDtBQUVHO0FBQ0g7QUFDSjtBQWxFSTtBQXFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUVBO0FBQ0E7QUFEQTtBQUNJO0FBR0o7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVlE7QUFjaEI7QUFESTtBQUNBO0FBR0o7QUFDSTtBQUNFO0FBQ0Q7QUF2Qkk7QUF5QlQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUdZO0FBQ0E7QUFEWjtBQUdZO0FBQ0k7QUFEaEI7QUFDQTtBQUNBO0FBR1k7QUFDSTtBQURoQjtBQUNBO0FBQ0E7QUFJWTtBQUNBO0FBRlo7QUFJWTtBQUNJO0FBQ0E7QUFGaEI7QUFJWTtBQUZaO0FBSVE7QUFGUjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFJWTtBQUNBO0FBRlo7QUFDQTtBQUlZO0FBQ0k7QUFGaEI7QUFJZ0I7QUFGaEI7QUFDQTtBQUNBO0FBQ0E7QUFLWTtBQUNBO0FBQ0E7QUFIWjtBQUtZO0FBQ0k7QUFDQTtBQUNBO0FBSGhCO0FBQ0E7QUFLUTtBQUhSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUVBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNZO0FBQ1o7QUFDWTtBQUNaO0FBQ1E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNoQjtBQUVnQjtBQUFoQjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQURoQjtBQUlnQjtBQUNBO0FBRmhCO0FBS2dCO0FBQ0E7QUFIaEI7QUFLWTtBQUNJO0FBSGhCO0FBS1k7QUFIWjtBQUtRO0FBSFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQVo7QUFFWTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0NBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFDWjtBQUNRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ3BCO0FBQ2dCO0FBQ0E7QUFDQTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0RBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUdBO0FBQ0k7QUFDQTtBQURaO0FBR1E7QUFDSTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0E7QUFEWjtBQUNBO0FBQ0E7QUFHUTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFDQTtBQUdRO0FBQ0k7QUFEWjtBQUdRO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBR1E7QUFDSTtBQURaO0FBQ0E7QUFHUTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDSTtBQUNKO0FBQ0k7QUFDQTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDSjtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRjtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ047QUFDSTtBQUNKO0FBQ0k7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNNO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNNO0FBQ0E7QUFDQTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDTTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRU07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFOO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFBVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUU7QUFBRjtBQUlFO0FBRkY7QUFNRTtBQUpGO0FBUUU7QUFORjtBQVVFO0FBUkY7QUFZRTtBQVZGO0FBY0U7QUFaRjtBQWNJO0FBQ0E7QUFDQTtBQUNFO0FBWk47QUFDQTtBQUNBO0FBQ0E7QUFjRTtBQVpGO0FBY0k7QUFDQTtBQVpKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFjRTtBQUNFO0FBQ0E7QUFDRTtBQVpOO0FBY0k7QUFaSjtBQUNBO0FBY0k7QUFDQTtBQUNBO0FBWko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBQ0U7QUFDQTtBQUNFO0FBWk47QUFjSTtBQVpKO0FBQ0E7QUFjSTtBQUNBO0FBQ0E7QUFaSjtBQWNJO0FBQ0U7QUFaTjtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBQ0U7QUFaSjtBQUNBO0FBQ0E7QUFjRTtBQVpGO0FBY0k7QUFDQTtBQVpKO0FBQ0E7QUFjRTtBQUNFO0FBWko7QUFjSTtBQUNFO0FBQ0E7QUFDQTtBQVpOO0FBQ0E7QUFjSTtBQUNFO0FBQ0U7QUFaUjtBQUNBO0FBY007QUFaTjtBQUNBO0FBQ0E7QUFjRTtBQVpGO0FBQ0E7QUFZSTtBQUNFO0FBVk47QUFDQTtBQVlJO0FBQ0U7QUFWTjtBQUNBO0FBWUk7QUFDRTtBQUNFO0FBVlI7QUFDQTtBQWFJO0FBWEo7QUFDQTtBQWFFO0FBWEY7QUFDQTtBQVdJO0FBQ0E7QUFDQTtBQVRKO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFXRTtBQUNFO0FBQ0U7QUFUTjtBQUNBO0FBV0k7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBVFY7QUFDQTtBQUNBO0FBV007QUFUTjtBQUNBO0FBQ0E7QUFDQTtBQVdFO0FBQ0U7QUFUSjtBQUNBO0FBV0U7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQUNFO0FBQ0U7QUFDQTtBQVROO0FBQ0E7QUFDQTtBQUNBO0FBV0U7QUFDRTtBQVRKO0FBQ0E7QUFDQTtBQVdFO0FBQ0U7QUFDQTtBQVRKO0FBV0k7QUFUSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEY7QUFXRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRGO0FBV0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRGO0FBV0U7QUFURjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUFDRTtBQVRGO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFURjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNFO0FBQ0E7QUFWRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUE7QUFDRTtBQUNBO0FBVkY7QUFDQTtBQUNBO0FBWUE7QUFDRTtBQUNBO0FBVkY7QUFZRTtBQUNBO0FBVkY7QUFDQTtBQUNBO0FBWUE7QUFDRTtBQUNBO0FBVkY7QUFZRTtBQUNFO0FBQ0E7QUFWSjtBQVlFO0FBVkY7QUFDQTtBQUNBO0FBWUE7QUFDRTtBQUNFO0FBQ0E7QUFWSjtBQVlFO0FBVkY7QUFDQTtBQUNBO0FBWUE7QUFDRTtBQUNBO0FBQ0U7QUFWSjtBQUNBO0FBWUU7QUFWRjtBQUNBO0FBWUE7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBVko7QUFZRTtBQVZGO0FBQ0E7QUFZQTtBQVZBO0FBQ0E7QUFVRTtBQUNBO0FBUkY7QUFVRTtBQUNFO0FBUko7QUFDQTtBQVVFO0FBQ0U7QUFDQTtBQVJKO0FBVUU7QUFSRjtBQUNBO0FBVUE7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBUko7QUFVRTtBQVJGO0FBQ0E7QUFVQTtBQUNFO0FBQ0E7QUFDRTtBQVJKO0FBQ0E7QUFVRTtBQVJGO0FBQ0E7QUFVQTtBQUNFO0FBQ0E7QUFDRTtBQVJKO0FBVUU7QUFSRjtBQUNBO0FBVUE7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBUko7QUFDQTtBQVVFO0FBUkY7QUFDQTtBQVVBO0FBQ0k7QUFDQTtBQUNFO0FBUk47QUFDQTtBQVVJO0FBUko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBUkE7QUFDQTtBQVFFO0FBQ0E7QUFDRTtBQUNBO0FBTko7QUFDQTtBQVFFO0FBTkY7QUFVSTtBQUNBO0FBQ0U7QUFSTjtBQUNBO0FBVUk7QUFSSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBUk47QUFDQTtBQVVJO0FBUko7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNFO0FBUko7QUFDQTtBQVVFO0FBUkY7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQVJKO0FBQ0E7QUFVRTtBQVJGO0FBQ0E7QUFVQTtBQUNFO0FBQ0E7QUFDRTtBQVJKO0FBVUU7QUFSRjtBQUNBO0FBVUE7QUFDRTtBQUNBO0FBQ0U7QUFSSjtBQUNBO0FBVUU7QUFSRjtBQUNBO0FBQ0E7QUFVQTtBQUNFO0FBQ0E7QUFDRTtBQVJKO0FBQ0E7QUFVRTtBQVJGO0FBQ0E7QUFDQTtBQVVBO0FBQ0k7QUFDQTtBQUNFO0FBUk47QUFDQTtBQVVJO0FBUko7QUFDQTtBQUNBO0FBVUE7QUFDSTtBQUNFO0FBUk47QUFDQTtBQVVJO0FBUko7QUFDQTtBQUNBO0FBVUE7QUFDSTtBQUNFO0FBQ0E7QUFSTjtBQUNBO0FBVUk7QUFSSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNscUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURNO0FBR047QUFDQTtBQURJO0FBR0o7QUFDQTtBQUhRO0FBS1I7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUxJO0FBT0o7QUFDQTtBQVBNO0FBU047QUFDQTtBQVBJO0FBQ0U7QUFLRTtBQUtSO0FBQ0E7QUFITTtBQUNFO0FBQ0U7QUFLVjtBQUNBO0FBSFE7QUFDQTtBQUtSO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUxNO0FBT047QUFMUTtBQU9SO0FBQ0E7QUFMTTtBQU9OO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFQTTtBQVNOO0FBQ0E7QUFQSTtBQVNKO0FBQ0E7QUFUTTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBV1I7QUFDQTtBQVRNO0FBV047QUFDQTtBQVRJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQVdSO0FBQ0E7QUFDQTtBQVRJO0FBQ0U7QUFDQTtBQUNFO0FBV1I7QUFDQTtBQUNBO0FBQ0E7QUFUSTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBV1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNIQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNLO0FBQ0c7QUFDQTtBQUNBO0FBQ1I7QUFDUztBQUNBO0FBQ0k7QUFDYjtBQUVhO0FBQWI7QUFHYTtBQURiO0FBSWE7QUFGYjtBQUlTO0FBQ0E7QUFDSTtBQUZiO0FBS2E7QUFIYjtBQU1hO0FBSmI7QUFPYTtBQUxiO0FBQ0E7QUFPUztBQUNJO0FBTGI7QUFPUztBQUxUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIOe7mSBBcnJheSDmt7vliqDmlrnms5Vcbi8vIGFyci5maW5kKC4uLilcbi8vIGFyci5maW5kSW5kZXgoLi4uKVxuLy8gYXJyLmluY2x1ZGVzKGUpXG4vLyBhcnIudW5pcXVlKGVxdWFsRnVuY3Rpb24sIGlzTmV3QXJyYXkpXG4vLyBBcnJheS5mcm9tXG4vLyBBcnJheS5lcXVhbFxuLy8gYXJyLmlzRXF1YWwob3RoZXJBcnJheSwgaXNTdHJpY3QpXG4vLyBBcnJheS5zb3J0QnlOdW1iZXJcbi8vIGFyci5maW5kU3ViQXJyYXlJbmRleHMoW10pICAg55So5LqO5p+l5om+5pWw57uE5YaF55qE6YOo5YiG5YWD57Sg55qE57Si5byVXG4vLyBhcnIudHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleChzdGFydEluZGV4KSDlsIbmlbDnu4TlhoXnmoTlhYPntKDlubPnp7tcbi8vIOWmgu+8mlsxLCAyLCAzLCA0LCA1XS50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KDMpID0+IFs0LDUsMSwyLDNdXG4vLyBhcnIua3FfaW5zZXJ0KGluZGV4LCBlKSAgIOaPkuWFpeS4gOS4quWFg+e0oFxuLy8gYXJyLmtxX2V4Y2x1ZGVzKGFycmF5KSAgIC8vIOmZpOS6hmFycmF55pWw57uE5Lit55qE5YWD57SgXG5cblxubW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZCkge1xuICBBcnJheS5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5wcm90b3R5cGUuZmluZCBjYWxsZWQgb24gbnVsbCBvciB1bmRlZmluZWQnKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3ByZWRpY2F0ZSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgdmFyIGxpc3QgPSBPYmplY3QodGhpcyk7XG4gICAgdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoID4+PiAwO1xuICAgIHZhciB0aGlzQXJnID0gYXJndW1lbnRzWzFdO1xuICAgIHZhciB2YWx1ZTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlID0gbGlzdFtpXTtcbiAgICAgIGlmIChwcmVkaWNhdGUuY2FsbCh0aGlzQXJnLCB2YWx1ZSwgaSwgbGlzdCkpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9O1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgpIHtcbiAgQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleCA9IGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgIGlmICh0aGlzID09PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5wcm90b3R5cGUuZmluZEluZGV4IGNhbGxlZCBvbiBudWxsIG9yIHVuZGVmaW5lZCcpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHByZWRpY2F0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cbiAgICB2YXIgbGlzdCA9IE9iamVjdCh0aGlzKTtcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XG4gICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMV07XG4gICAgdmFyIHZhbHVlO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFsdWUgPSBsaXN0W2ldO1xuICAgICAgaWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpLCBsaXN0KSkge1xuICAgICAgICByZXR1cm4gaTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9O1xufVxuXG5cbi8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5pbmNsdWRlc1xuaWYgKCFBcnJheS5wcm90b3R5cGUuaW5jbHVkZXMpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2luY2x1ZGVzJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihzZWFyY2hFbGVtZW50LCBmcm9tSW5kZXgpIHtcblxuICAgICAgLy8gMS4gTGV0IE8gYmUgPyBUb09iamVjdCh0aGlzIHZhbHVlKS5cbiAgICAgIGlmICh0aGlzID09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJ0aGlzXCIgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbyA9IE9iamVjdCh0aGlzKTtcblxuICAgICAgLy8gMi4gTGV0IGxlbiBiZSA/IFRvTGVuZ3RoKD8gR2V0KE8sIFwibGVuZ3RoXCIpKS5cbiAgICAgIHZhciBsZW4gPSBvLmxlbmd0aCA+Pj4gMDtcblxuICAgICAgLy8gMy4gSWYgbGVuIGlzIDAsIHJldHVybiBmYWxzZS5cbiAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyA0LiBMZXQgbiBiZSA/IFRvSW50ZWdlcihmcm9tSW5kZXgpLlxuICAgICAgLy8gICAgKElmIGZyb21JbmRleCBpcyB1bmRlZmluZWQsIHRoaXMgc3RlcCBwcm9kdWNlcyB0aGUgdmFsdWUgMC4pXG4gICAgICB2YXIgbiA9IGZyb21JbmRleCB8IDA7XG5cbiAgICAgIC8vIDUuIElmIG4g4omlIDAsIHRoZW5cbiAgICAgIC8vICBhLiBMZXQgayBiZSBuLlxuICAgICAgLy8gNi4gRWxzZSBuIDwgMCxcbiAgICAgIC8vICBhLiBMZXQgayBiZSBsZW4gKyBuLlxuICAgICAgLy8gIGIuIElmIGsgPCAwLCBsZXQgayBiZSAwLlxuICAgICAgdmFyIGsgPSBNYXRoLm1heChuID49IDAgPyBuIDogbGVuIC0gTWF0aC5hYnMobiksIDApO1xuXG4gICAgICAvLyA3LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW5cbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XG4gICAgICAgIC8vIGEuIExldCBlbGVtZW50SyBiZSB0aGUgcmVzdWx0IG9mID8gR2V0KE8sICEgVG9TdHJpbmcoaykpLlxuICAgICAgICAvLyBiLiBJZiBTYW1lVmFsdWVaZXJvKHNlYXJjaEVsZW1lbnQsIGVsZW1lbnRLKSBpcyB0cnVlLCByZXR1cm4gdHJ1ZS5cbiAgICAgICAgLy8gYy4gSW5jcmVhc2UgayBieSAxLlxuICAgICAgICAvLyBOT1RFOiA9PT0gcHJvdmlkZXMgdGhlIGNvcnJlY3QgXCJTYW1lVmFsdWVaZXJvXCIgY29tcGFyaXNvbiBuZWVkZWQgaGVyZS5cbiAgICAgICAgaWYgKG9ba10gPT09IHNlYXJjaEVsZW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBrKys7XG4gICAgICB9XG5cbiAgICAgIC8vIDguIFJldHVybiBmYWxzZVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSk7XG59XG5cbi8vIHVuaXF1ZVxuaWYgKCFBcnJheS5wcm90b3R5cGUudW5pcXVlKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICd1bmlxdWUnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGVxdWFsRnVuY3Rpb24sIG5ld0FycmF5ID0gdHJ1ZSkge1xuICAgICAgaWYgKG5ld0FycmF5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91bnFpdWVfbmV3KGVxdWFsRnVuY3Rpb24pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5fdW5xaXVlKGVxdWFsRnVuY3Rpb24pO1xuICAgIH0sXG4gIH0pO1xuXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdfdW5xaXVlX25ldycsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oZXF1YWxGdW5jdGlvbikge1xuICAgICAgbGV0IGFycmF5ID0gQXJyYXkuZnJvbSh0aGlzKTtcblxuICAgICAgcmV0dXJuIGFycmF5Ll91bnFpdWUoZXF1YWxGdW5jdGlvbik7XG4gICAgfVxuICB9KTtcblxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnX3VucWl1ZScsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oZXF1YWxGdW5jdGlvbikge1xuICAgICAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoO1xuICAgICAgdmFyIGkgPSAtMTtcblxuICAgICAgd2hpbGUgKGkrKyA8IGxlbikge1xuICAgICAgICB2YXIgaiA9IGkgKyAxO1xuXG4gICAgICAgIGZvciAoOyBqIDwgdGhpcy5sZW5ndGg7ICsraikge1xuICAgICAgICAgIHZhciBpc0VxdWFsID0gZmFsc2U7XG4gICAgICAgICAgaWYgKGVxdWFsRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIGlzRXF1YWwgPSBlcXVhbEZ1bmN0aW9uKHRoaXNbaV0sIHRoaXNbal0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpc0VxdWFsID0gdGhpc1tpXSA9PT0gdGhpc1tqXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaXNFcXVhbCkge1xuICAgICAgICAgICAgdGhpcy5zcGxpY2Uoai0tLCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gIH0pO1xufVxuXG5cbi8vIFByb2R1Y3Rpb24gc3RlcHMgb2YgRUNNQS0yNjIsIEVkaXRpb24gNiwgMjIuMS4yLjFcbi8vIFJlZmVyZW5jZTogaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWFycmF5LmZyb21cbmlmICghQXJyYXkuZnJvbSkge1xuICBBcnJheS5mcm9tID0gKGZ1bmN0aW9uKCkge1xuICAgIHZhciB0b1N0ciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG4gICAgdmFyIGlzQ2FsbGFibGUgPSBmdW5jdGlvbihmbikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyB8fCB0b1N0ci5jYWxsKGZuKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbiAgICB9O1xuICAgIHZhciB0b0ludGVnZXIgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIG51bWJlciA9IE51bWJlcih2YWx1ZSk7XG4gICAgICBpZiAoaXNOYU4obnVtYmVyKSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cbiAgICAgIGlmIChudW1iZXIgPT09IDAgfHwgIWlzRmluaXRlKG51bWJlcikpIHtcbiAgICAgICAgcmV0dXJuIG51bWJlcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiAobnVtYmVyID4gMCA/IDEgOiAtMSkgKiBNYXRoLmZsb29yKE1hdGguYWJzKG51bWJlcikpO1xuICAgIH07XG4gICAgdmFyIG1heFNhZmVJbnRlZ2VyID0gTWF0aC5wb3coMiwgNTMpIC0gMTtcbiAgICB2YXIgdG9MZW5ndGggPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgdmFyIGxlbiA9IHRvSW50ZWdlcih2YWx1ZSk7XG4gICAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgobGVuLCAwKSwgbWF4U2FmZUludGVnZXIpO1xuICAgIH07XG5cbiAgICAvLyBUaGUgbGVuZ3RoIHByb3BlcnR5IG9mIHRoZSBmcm9tIG1ldGhvZCBpcyAxLlxuICAgIHJldHVybiBmdW5jdGlvbiBmcm9tKGFycmF5TGlrZSAvKiwgbWFwRm4sIHRoaXNBcmcgKi8gKSB7XG4gICAgICAvLyAxLiBMZXQgQyBiZSB0aGUgdGhpcyB2YWx1ZS5cbiAgICAgIHZhciBDID0gdGhpcztcblxuICAgICAgLy8gMi4gTGV0IGl0ZW1zIGJlIFRvT2JqZWN0KGFycmF5TGlrZSkuXG4gICAgICB2YXIgaXRlbXMgPSBPYmplY3QoYXJyYXlMaWtlKTtcblxuICAgICAgLy8gMy4gUmV0dXJuSWZBYnJ1cHQoaXRlbXMpLlxuICAgICAgaWYgKGFycmF5TGlrZSA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJBcnJheS5mcm9tIHJlcXVpcmVzIGFuIGFycmF5LWxpa2Ugb2JqZWN0IC0gbm90IG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyA0LiBJZiBtYXBmbiBpcyB1bmRlZmluZWQsIHRoZW4gbGV0IG1hcHBpbmcgYmUgZmFsc2UuXG4gICAgICB2YXIgbWFwRm4gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHZvaWQgdW5kZWZpbmVkO1xuICAgICAgdmFyIFQ7XG4gICAgICBpZiAodHlwZW9mIG1hcEZuICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAvLyA1LiBlbHNlXG4gICAgICAgIC8vIDUuIGEgSWYgSXNDYWxsYWJsZShtYXBmbikgaXMgZmFsc2UsIHRocm93IGEgVHlwZUVycm9yIGV4Y2VwdGlvbi5cbiAgICAgICAgaWYgKCFpc0NhbGxhYmxlKG1hcEZuKSkge1xuICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FycmF5LmZyb206IHdoZW4gcHJvdmlkZWQsIHRoZSBzZWNvbmQgYXJndW1lbnQgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyA1LiBiLiBJZiB0aGlzQXJnIHdhcyBzdXBwbGllZCwgbGV0IFQgYmUgdGhpc0FyZzsgZWxzZSBsZXQgVCBiZSB1bmRlZmluZWQuXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMikge1xuICAgICAgICAgIFQgPSBhcmd1bWVudHNbMl07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gMTAuIExldCBsZW5WYWx1ZSBiZSBHZXQoaXRlbXMsIFwibGVuZ3RoXCIpLlxuICAgICAgLy8gMTEuIExldCBsZW4gYmUgVG9MZW5ndGgobGVuVmFsdWUpLlxuICAgICAgdmFyIGxlbiA9IHRvTGVuZ3RoKGl0ZW1zLmxlbmd0aCk7XG5cbiAgICAgIC8vIDEzLiBJZiBJc0NvbnN0cnVjdG9yKEMpIGlzIHRydWUsIHRoZW5cbiAgICAgIC8vIDEzLiBhLiBMZXQgQSBiZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgdGhlIFtbQ29uc3RydWN0XV0gaW50ZXJuYWwgbWV0aG9kIG9mIEMgd2l0aCBhbiBhcmd1bWVudCBsaXN0IGNvbnRhaW5pbmcgdGhlIHNpbmdsZSBpdGVtIGxlbi5cbiAgICAgIC8vIDE0LiBhLiBFbHNlLCBMZXQgQSBiZSBBcnJheUNyZWF0ZShsZW4pLlxuICAgICAgdmFyIEEgPSBpc0NhbGxhYmxlKEMpID8gT2JqZWN0KG5ldyBDKGxlbikpIDogbmV3IEFycmF5KGxlbik7XG5cbiAgICAgIC8vIDE2LiBMZXQgayBiZSAwLlxuICAgICAgdmFyIGsgPSAwO1xuICAgICAgLy8gMTcuIFJlcGVhdCwgd2hpbGUgayA8IGxlbuKApiAoYWxzbyBzdGVwcyBhIC0gaClcbiAgICAgIHZhciBrVmFsdWU7XG4gICAgICB3aGlsZSAoayA8IGxlbikge1xuICAgICAgICBrVmFsdWUgPSBpdGVtc1trXTtcbiAgICAgICAgaWYgKG1hcEZuKSB7XG4gICAgICAgICAgQVtrXSA9IHR5cGVvZiBUID09PSAndW5kZWZpbmVkJyA/IG1hcEZuKGtWYWx1ZSwgaykgOiBtYXBGbi5jYWxsKFQsIGtWYWx1ZSwgayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgQVtrXSA9IGtWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBrICs9IDE7XG4gICAgICB9XG4gICAgICAvLyAxOC4gTGV0IHB1dFN0YXR1cyBiZSBQdXQoQSwgXCJsZW5ndGhcIiwgbGVuLCB0cnVlKS5cbiAgICAgIEEubGVuZ3RoID0gbGVuO1xuICAgICAgLy8gMjAuIFJldHVybiBBLlxuICAgICAgcmV0dXJuIEE7XG4gICAgfTtcbiAgfSgpKTtcbn1cblxuaWYgKCFBcnJheS5lcXVhbCkge1xuICBBcnJheS5lcXVhbCA9IGZ1bmN0aW9uKGFycjEsIGFycjIsIHN0cmljdCA9IHRydWUpIHtcbiAgICBpZiAoYXJyMSA9PT0gdW5kZWZpbmVkIHx8IGFycjIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBsZW5ndGggPSBhcnIxLmxlbmd0aFxuICAgIGlmIChsZW5ndGggIT09IGFycjIubGVuZ3RoKSByZXR1cm4gZmFsc2VcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoc3RyaWN0KSB7XG4gICAgICAgIGlmIChhcnIxW2ldICE9PSBhcnIyW2ldKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciB2YWx1ZTEgPSBhcnIxW2ldO1xuICAgICAgICB2YXIgdmFsdWUyID0gYXJyMltpXTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlMSkgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZTIpKSB7XG4gICAgICAgICAgcmVzdWx0ID0gQXJyYXkuZXF1YWwodmFsdWUxLCB2YWx1ZTIsIHN0cmljdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzdWx0ID0gKHZhbHVlMSA9PSB2YWx1ZTIpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9O1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pc0VxdWFsKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpc0VxdWFsJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihvdGhlckFycmF5LCBzdHJpY3QgPSB0cnVlKSB7XG4gICAgICByZXR1cm4gQXJyYXkuZXF1YWwodGhpcywgb3RoZXJBcnJheSwgc3RyaWN0KTtcbiAgICB9LFxuICB9KTtcbn1cblxuaWYgKCFBcnJheS5zb3J0QnlOdW1iZXIpIHtcbiAgQXJyYXkuc29ydEJ5TnVtYmVyID0gZnVuY3Rpb24gKG4xLCBuMiwgYXNjID0gdHJ1ZSkge1xuICAgIHJldHVybiAobjEgLSBuMikgKiAoYXNjID8gMSA6IC0xKTtcbiAgfTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmluZFN1YkFycmF5SW5kZXhzKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdmaW5kU3ViQXJyYXlJbmRleHMnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIChzdWJBcnJheSwgZikge1xuICAgICAgbGV0IGluZGV4cyA9IFtdO1xuICAgICAgZm9yICh2YXIgaSBpbiBzdWJBcnJheSkge1xuICAgICAgICBsZXQgc3ViVmFsdWUgPSBzdWJBcnJheVtpXTtcbiAgICAgICAgbGV0IGZpbmRGdW5jID0gZiB8fCBmdW5jdGlvbiAodGhpc1ZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHN1YlZhbHVlID09PSB0aGlzVmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5maW5kSW5kZXgoZmluZEZ1bmMpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpbmRleHMgPSBbXTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gaW5kZXhzLmxlbmd0aCA+IDAgPyBpbmRleHMgOiBudWxsO1xuICAgIH0sXG4gIH0pO1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICd0cmFuc2xhdGlvbldpdGhTdGFydEluZGV4Jywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoc3RhcnRJbmRleCkge1xuICAgICAgaWYgKHN0YXJ0SW5kZXggPT0gMCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgaWYgKHN0YXJ0SW5kZXggPj0gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGxldCBwcmUgPSB0aGlzLnNsaWNlKHN0YXJ0SW5kZXgpO1xuICAgICAgbGV0IGxhc3QgPSB0aGlzLnNsaWNlKDAsIHN0YXJ0SW5kZXgpO1xuICAgICAgbGV0IHJlc3VsdCA9IHByZS5jb25jYXQobGFzdCk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcbiAgfSk7XG59XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmtxX2luc2VydCkge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAna3FfaW5zZXJ0Jywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihpbmRleCwgZSkge1xuICAgICAgaWYgKGUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgaWYgKGluZGV4ID49IHRoaXMubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMucHVzaChlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNwbGljZShpbmRleCwgMCwgZSk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gIH0pO1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5rcV9leGNsdWRlcykge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAna3FfZXhjbHVkZXMnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKG90aGVyQXJyYXkpIHtcbiAgICAgIGlmIChvdGhlckFycmF5ID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgIGlmICghb3RoZXJBcnJheS5pbmNsdWRlcyhlbGVtZW50KSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuICB9KTtcbn0iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcblxubGV0IEF1ZGlvTWFuYWdlciA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGhhbGxfYmdtOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgICAgICBnYW1lX2JnbToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgY29tcGFyZV9iZ206IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIOaJk+aeqlxuICAgICAgICBkYVFpYW5nOiB7XG4gICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIGJ1dHRvbkNsaWNrU3VyZToge1xuICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgICAgICBmYXBhaToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgY2xpY2tfcHVibGljOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcbiAgICAgICAgY2xpY2tfY2FuY2VsOiB7XG4gICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG4gICAgICAgIGNsaWNrX2NyZWF0ZVJvb206IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuICAgICAgICB3aW5kb3c6IHtcbiAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcbiAgICAgICAgY2xpY2tfd2VpeGluX2xvZ2luOntcbiAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcbiAgICAgICAgZmFuZ1BhaTp7XG4gICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG4gICAgfSxcblxuICAgIHN0YXRpY3M6IHtcbiAgICAgIGluc3RhbmNlOiBudWxsLFxuICAgIH0sXG5cbiAgICBvbkxvYWQ6ZnVuY3Rpb24oKSB7XG4gICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgdGhpcy5fcmVnaXN0ZXJBcHBBY3RpdmVDaGFuZ2UoKTtcblxuICAgICAgICB0aGlzLnNvdW5kT24gPSB0cnVlO1xuICAgICAgICBjYy5nYW1lLmFkZFBlcnNpc3RSb290Tm9kZSh0aGlzLm5vZGUpO1xuICAgICAgICBpZiAoY2MuZ2FtZS5pc1BlcnNpc3RSb290Tm9kZSh0aGlzLm5vZGUpKSB7XG4gICAgICAgICAgICBjYy5sb2coJ+a3u+WKoOWFqOWxgOiKgueCueaIkOWKnycpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubVZhbHVlID0gbWFuYWdlci5nZXRNdXNpY1ZhbHVlKCk7XG4gICAgICAgIHRoaXMubUVWYWx1ZSA9IG1hbmFnZXIuZ2V0TXVzaWNFZmZlY3RWYWx1ZSgpO1xuICAgICAgICB0aGlzLmJnQXVkaW9JZCA9IC0xO1xuICAgIH0sXG5cbiAgICBzdG9wSGFsbE11c2ljOiBmdW5jdGlvbigpe1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5zdG9wKHRoaXMuYmdBdWRpb0lkKTtcbiAgICB9LFxuXG4gICAgcGxheU11c2ljOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5iZ0F1ZGlvSWQgPSBjYy5hdWRpb0VuZ2luZS5wbGF5TXVzaWMoIHRoaXMuaGFsbF9iZ20sIHRydWUpO1xuICAgICAgICBpZiAodGhpcy5iZ0F1ZGlvSWQgIT0gLTEpIHtcbiAgICAgICAgICAgIGNjLmxvZygncGxheScpO1xuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKHRoaXMuYmdBdWRpb0lkLHRoaXMubVZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICAvL2NjLmF1ZGlvRW5naW5lLnBsYXlNdXNpYyggdXJsLCB0cnVlIClcbiAgICB9LFxuXG4gICAgLypwbGF5RGVza011c2ljOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5iZ0F1ZGlvSWQgPSBjYy5hdWRpb0VuZ2luZS5wbGF5TXVzaWMoIHRoaXMuZ2FtZV9iZ20sIHRydWUpO1xuICAgICAgICBpZiAodGhpcy5iZ0F1ZGlvSWQgIT0gLTEpIHtcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZSh0aGlzLmJnQXVkaW9JZCx0aGlzLm1WYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LCovXG5cbiAgICBwbGF5Q29tcGFyZUNhcmRzTXVzaWM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuYmdBdWRpb0lkID0gY2MuYXVkaW9FbmdpbmUucGxheU11c2ljKCB0aGlzLmNvbXBhcmVfYmdtLCB0cnVlKTtcbiAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ0F1ZGlvSWQsdGhpcy5tVmFsdWUpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBwbGF5RGFRaWFuZzogZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyBzdGFydCA8PSAxLjY7IHN0YXJ0ID0gc3RhcnQgKyAwLjUpIHtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5kYVFpYW5nKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLCBzdGFydCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIOKAnOaJk+aequKAnVxuICAgIHBsYXlIdW1hbkRhUWlhbmc6IGZ1bmN0aW9uIChzZXggPSAxKSB7XG4gICAgICB2YXIgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9cIiArIChzZXggPT0gMSA/IFwibWFuXCIgOiBcIndvbWFuXCIpO1xuICAgICAgcGF0aCA9IHBhdGggKyBcIi9kYXFpYW5nMS53YXZcIjtcblxuICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcocGF0aCk7XG4gICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIHBsYXlQb2tlckNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgdXJsID0gY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9wdWJsaWMvcG9rZXJfY2xpY2sud2F2Jyk7XG4gICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIC8vIOaSreaUvuWFqOWekuaJk+mfs+aViFxuICAgIHBsYXlIb21lUnVuOiBmdW5jdGlvbiAoc2V4ID0gMSkge1xuICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArIFwic3BlY2lhbDEud2F2XCI7XG4gICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5Y+R54mM6Z+z5pWIXG4gICAgcGxheUZhUGFpOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmZhcGFpKTtcbiAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IDY7IGluZGV4KyspIHtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5mYXBhaSk7XG4gICAgICAgICAgICB9LmJpbmQodGhpcyksIGluZGV4ICogMC4xKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBwbGF5Q2FyZFR5cGU6IGZ1bmN0aW9uIChzZXggPSAxLCB0eXBlID0gLTEpIHtcbiAgICAgIC8vIOWPquaSreaUvuaZrumAmuexu+Wei+eahOivremfs1xuICAgICAgaWYgKCh0eXBlID49IDEwKSB8fCAodHlwZSA8IDApKSB7XG4gICAgICAgIC8vIDEwIOWPiuS7peS4iuaYr+eJueauiueJjFxuICAgICAgICAgIGxldCBwYXRoID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKHNleCkgKyAodHlwZSkgKyBcIi53YXZcIjtcbiAgICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArIFwiY29tbW9uXCIgKyAodHlwZSArIDEpICsgXCIud2F2XCI7XG4gICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+IOW8gOWni+avlOeJjFxuICAgIHBsYXlTdGFydENvbXBhcmU6IGZ1bmN0aW9uIChzZXggPSAxKSB7XG4gICAgICBsZXQgcGF0aCA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aChzZXgpICsgXCJzdGFydF9jb21wYXJlLndhdlwiO1xuICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcocGF0aCk7XG4gICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIHBsYXlXaW46IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL29wZW5mYWNlL3dpbi5tcDMnKTtcbiAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgcGxheUxvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL29wZW5mYWNlL2xvc2UubXAzJyk7XG4gICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIF9zb3VuZHNIdW1hblBhdGg6IGZ1bmN0aW9uIChzZXgpIHtcbiAgICAgIGxldCBwYXRoID0gXCJyZXNvdXJjZXMvc291bmRzL1wiICsgKHNleCA9PSAxID8gXCJtYW5cIiA6IFwid29tYW5cIikgKyBcIi9cIjtcbiAgICAgIHJldHVybiBwYXRoO1xuICAgIH0sXG5cbiAgICBzZXRCZ011c2ljVm9sdW1uOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB0aGlzLm1WYWx1ZSA9IHZhbHVlO1xuICAgICAgICBpZiAodGhpcy5iZ0F1ZGlvSWQgIT0gLTEpIHtcbiAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ0F1ZGlvSWQsdmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHNldEVmZmVjdE11c2ljVm9sdW06IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubUVWYWx1ZSA9IHZhbHVlO1xuICAgIH0sXG5cbiAgICAvKuiBiuWkqSovXG4gICAgcGxheUNoYXRBdWRpbzpmdW5jdGlvbihzZXgsIHN0cikge1xuICAgICAgbGV0IGluZGV4ID0gdGhpcy5jaGF0VGV4dHMoKS5pbmRleE9mKHN0cik7XG4gICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgICBsZXQgbnVtYmVyID0gKChzZXggPT0gMSkgPyAxMDAwIDogMjAwMCkgKyBpbmRleDtcbiAgICAgICAgbGV0IHBhdGggPSBcInJlc291cmNlcy9zb3VuZHMvY2hhdC9cIiArIG51bWJlciArIFwiLndhdlwiO1xuICAgICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICAvKiflvojpq5jlhbTlkozkvaDku6zkuIDotbfmiZPniYzvvIEnLFxuICAgICAgICAn5b+r54K55YS/5ZCn77yM5oiR562J5b6X6Iqx5YS/6YO96LCi5LqGfu+8gScsXG4gICAgICAgICfmgKXku4DkuYjvvIzorqnmiJHmg7Pmg7PmgI7kuYjmiZPvvIEnLFxuICAgICAgICAn6L+Z54mM55yf5aW977yM5YWo5Z6S5omT5pyJ5biM5pyb5ZWK77yBJyxcbiAgICAgICAgJ+aIkeaYr+S4gOS4quelnuaequaJi++8jOaJk+aKouacrOmihuWkp++8gScsXG4gICAgICAgICfov5nmiorniYzmlaLkuI3mlaLlho3msLTkuIDngrnllYrvvIEnLFxuICAgICAgICAn5Y+I6L6T5ZWm77yB5aSn54i357uZ5p2h5rS76Lev5ZCn77yBJyxcbiAgICAgICAgJ+S9oOaYr+WmueWmuSDov5jmmK/lk6Xlk6XllYonLFxuICAgICAgICAn5Lqk5Liq5pyL5Y+L5ZCn44CC44CCJyxcbiAgICAgICAgJ+aIkeacieS6i+WFiOi1sOS6hu+8jOS4i+asoeWGjeeOqeWQp++8gScsXG4gICAgICAgICflho3op4HkuoYg5oiR5Lya5oOz5b+15aSn5a6255qE77yM77yMJyxcbiAgICAgICAgJ+aAjuS5iOWPiOaWree6v+S6hiAg572R57uc5oCO5LmI6L+Z5LmI5beu5ZWK77yM77yMJ1xuICAgICovXG4gICAgY2hhdFRleHRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICAn5LiN6KaB5ZC15LqG77yM5LiT5b+D546p5ri45oiP5ZCn77yBJyxcbiAgICAgICAgJ+Wkp+WutuS4jeimgei1sO+8jOWGs+aImOWIsOWkqeS6rn7vvIEnLFxuICAgICAgICAn5aSn5a625aW977yM5b6I6auY5YW06KeB5Yiw5ZCE5L2N77yBJyxcbiAgICAgICAgJ+WQhOS9jeS4jeWlveaEj+aAne+8jOaIkeemu+W8gOS4gOS8mu+8gScsXG4gICAgICAgICflkozkvaDlkIjkvZznnJ/mmK/lpKrmhInlv6vkuobvvIEnLFxuICAgICAgICAn5b+r54K55YS/5ZWK77yM6YO9562J5b6X5oiR6Iqx6YO96LCi5LqG77yBJyxcbiAgICAgICAgJ+S9oOeahOeJjOaJk+W+l+WkquWlveS6hu+8gScsXG4gICAgICAgICfkvaDmmK/lprnlprkg6L+Y5piv5ZOl5ZOl5ZWKJyxcbiAgICAgICAgJ+S6pOS4quaci+WPi+WQp+OAguOAgicsXG4gICAgICAgICfmiJHmnInkuovlhYjotbDkuobvvIzkuIvmrKHlho3njqnlkKfvvIEnLFxuICAgICAgICAn5YaN6KeB5LqGIOaIkeS8muaDs+W/teWkp+WutueahO+8jO+8jCcsXG4gICAgICAgICfmgI7kuYjlj4jmlq3nur/kuoYgIOe9kee7nOaAjuS5iOi/meS5iOW3ruWViu+8jO+8jCdcbiAgICAgIF07XG4gICAgfSxcblxuICAgIHBhdXNlTXVzaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNvdW5kT24gPSBmYWxzZTtcbiAgICAgICAgY2MuYXVkaW9FbmdpbmUucGF1c2VNdXNpYygpO1xuICAgIH0sXG5cbiAgICByZXN1bWVNdXNpYzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc291bmRPbiA9IHRydWU7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnJlc3VtZU11c2ljKCk7XG4gICAgfSxcblxuICAgIF9wbGF5U0ZYOiBmdW5jdGlvbihjbGlwKSB7XG4gICAgICAgIGlmICh0aGlzLnNvdW5kT24pIHtcbiAgICAgICAgICAgIHZhciBhdWRpb0lkID0gY2MuYXVkaW9FbmdpbmUucGxheUVmZmVjdCggY2xpcCwgZmFsc2UgKTtcbiAgICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZShhdWRpb0lkLHRoaXMubUVWYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gYXVkaW9JZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICAgLy8gTUFSSzog5YmN5ZCO5Y+w5pON5L2cXG4gICAgX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9ISURFLCB0aGlzLl9hcHBFbnRlckJhY2tncm91bmQsIHRoaXMpO1xuICAgICAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfU0hPVywgdGhpcy5fYXBwQmVjb21BY3RpdmUsIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgICog6L+b5YWl5ZCO5Y+wXG4gICAgICAqL1xuICAgIF9hcHBFbnRlckJhY2tncm91bmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICAgICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lIDwgMTAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGFzdEFwcEVudGVyQmFja2dyb3VuZFRpbWUgPSBub3c7XG5cbiAgICAgICAgdGhpcy5wYXVzZU11c2ljKCk7XG4gICAgfSxcblxuICAvKipcbiAgICog6L+b5YWl5YmN5Y+wIFxuICAgKi9cbiAgX2FwcEJlY29tQWN0aXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICBpZiAobm93IC0gdGhpcy5fbGFzdEFwcEJlY29tQWN0aXZlVGltZSA8IDEwMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lID0gbm93O1xuXG4gICAgdGhpcy5yZXN1bWVNdXNpYygpO1xuICB9LFxuXG4gIC8q56Gu5a6a5oyJ6ZKu6Z+z5pWIKi9cbiAgICBwbGF5QnRuQ2xpY2tTRlg6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5idXR0b25DbGlja1N1cmUpO1xuICAgIH0sXG4gIC8q5YWs5YWx5oyJ6ZKu77yM5oyJ6ZSu5oiW6ICF5YWz6Zet5oyJ6ZKu5LmL57G755qE6Z+z5pWIKi9cbiAgICBwYWx5QnRuUHVibGljU0ZYOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX3B1YmxpYyk7XG4gICAgfSxcblxuICAgIC8q5Y+W5raI5oyJ6ZKu6Z+z5pWIKi9cbiAgICBwYWx5QnRuQ2FuY2VsQ2xpY2tTRlg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfY2FuY2VsKTtcbiAgICB9LFxuICAgIHBhbHlCdG5DcmVhdGVSb29tU0ZYOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmNsaWNrX2NyZWF0ZVJvb20pO1xuICAgIH0sXG4gICAgcGFseVdpbmRvd1NGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMud2luZG93KTtcbiAgICB9LFxuICAgIHBhbHlXZWlYaW5Mb2dpblNGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfd2VpeGluX2xvZ2luKTtcbiAgICB9LFxuICAgIHBhbHlGYW5nUGFpU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5mYW5nUGFpKTtcbiAgICB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQXVkaW9NYW5hZ2VyO1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGdyYXlTcHJpdGU6IGNjLlNwcml0ZSxcblxuICAgICAgICBfY2FyZE5hbWU6IG51bGwsXG4gICAgICAgIF9rcUNhcmRNb2RlOiBudWxsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5ncmF5U3ByaXRlLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIC8vIOmAmui/h+eJjOWQjeiuvue9rueJjFxuICAgIHNldENhcmQ6IGZ1bmN0aW9uIChjYXJkTmFtZSkge1xuICAgICAgdGhpcy5fc2V0Q2FyZE5hbWUoY2FyZE5hbWUpO1xuXG4gICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJykuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNhcmROYW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2FyZE5hbWU7XG4gICAgfSxcblxuICAgIGNhcmRNb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fa3FDYXJkTW9kZTtcbiAgICB9LFxuXG4gICAgX3NldENhcmROYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUpIHtcbiAgICAgIHRoaXMuX2NhcmROYW1lID0gY2FyZE5hbWU7XG4gICAgICB0aGlzLl9rcUNhcmRNb2RlID0gbmV3IEtRQ2FyZChjYXJkTmFtZSk7XG4gICAgfSxcblxuICAgIC8vIOiuvue9rumAieaLqeeKtuaAgVxuICAgIHNldFNlbGVjdGVkOiBmdW5jdGlvbiAoc2VsZWN0ZWQgPSBmYWxzZSkge1xuICAgICAgdGhpcy5ncmF5U3ByaXRlLm5vZGUuYWN0aXZlID0gc2VsZWN0ZWQ7XG4gICAgfSxcblxuICAgIGlzU2VsZWN0ZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmdyYXlTcHJpdGUubm9kZS5hY3RpdmU7XG4gICAgfSxcblxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XG4gICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xuICAgICAgaWYgKCFjYXJkTmFtZS5zdGFydHNXaXRoKFwicHVibGljLXBpYy1jYXJkLXBva2VyXCIpKSB7XG4gICAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNhcmROYW1lO1xuICAgIH0sXG5cbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xuICAgICAgY2MuYXNzZXJ0KGNhbGxiYWNrKTtcblxuICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJpbWFnZXMvcG9rZXJMaXN0L3BvY2tMaXN0XCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY2MuZXJyb3IoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSk7XG4gICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcbiAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgcGxheSA9IHJlcXVpcmUoJ3BsYXknKTtcbmNvbnN0IEtRQ2FyZFNjb3JldHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRTY29yZXRzSGVscGVyJyk7XG4vLyDniYznsbvlnosgY29tcG9uZW50XG4vL1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBzdGF0aWNzOiB7XG4gICAgICAgIGluc3RhbmNlczogbnVsbCxcbiAgICB9LFxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgY2FyZHNMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgYnRuRHVpWmk6IGNjLkJ1dHRvbixcbiAgICAgICAgYnRuTGlhbmdEdWk6IGNjLkJ1dHRvbixcbiAgICAgICAgYnRuU2FuVGlhbzogY2MuQnV0dG9uLFxuICAgICAgICBidG5TaHVuWmk6IGNjLkJ1dHRvbixcbiAgICAgICAgYnRuVG9uZ0h1YTogY2MuQnV0dG9uLFxuICAgICAgICBidG5IdUx1OiBjYy5CdXR0b24sXG4gICAgICAgIGJ0blRpZVpoaTogY2MuQnV0dG9uLFxuICAgICAgICBidG5Ub25nSHVhU2h1bjogY2MuQnV0dG9uLFxuICAgICAgICBidG5XdVRvbmc6IGNjLkJ1dHRvbixcbiAgICAgICAgdHlwZUJ1dHRvbnNOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBidG5EZWxldGVUb3VEYW86IGNjLkJ1dHRvbiwgICAvLyDlpLTpgZNcbiAgICAgICAgYnRuRGVsZXRlWmhvbmdEYW86IGNjLkJ1dHRvbiwgLy8g5Lit6YGTXG4gICAgICAgIGJ0bkRlbGV0ZVdlaURhbzogY2MuQnV0dG9uLCAgIC8vIOWwvumBk1xuICAgICAgICBidG5DYW5jZWxBbGw6IGNjLkJ1dHRvbiwgICAgICAvLyDlhajpg6jlj5bmtohcbiAgICAgICAgYnRuRG9uZTogY2MuQnV0dG9uLCAgICAgICAgICAgLy8g56Gu5a6a5Ye654mMXG4gICAgICAgIHRpbWVOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBsYWJlbFRpbWU6IGNjLkxhYmVsLFxuICAgICAgICBsYXlvdXRUb3VEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0WmhvbmdEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0V2VpRGFvOiBjYy5MYXlvdXQsXG5cbiAgICAgICAgY2FyZFByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBjYXJkVHlwZVByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBnb25nWGlOaTpjYy5Ob2RlLFxuICAgICAgICB0ZVNodVBhaTpjYy5Ob2RlLFxuICAgICAgICAvKiMjIyMjKi9cbiAgICAgICAgd3VUb25nX2ltZzpjYy5TcHJpdGVGcmFtZSxcbiAgICAgICAgdG9uZ0h1YVNodW5faW1nOmNjLlNwcml0ZUZyYW1lLFxuICAgICAgICBCdG5DbGlja0dvbmdYaU5pQ29tZmlybTpmYWxzZSwgIC8v55So5LqO5qOA5p+l55So5oi35piv5ZCm54K55Ye75LqG5oGt5Zac5L2g6aG16Z2i55qE56Gu5a6a5oyJ6ZKuXG4gICAgICAgIGNhcmRzTGF5b3V0U29ydENvbG9yOiBmYWxzZSxcbiAgICAgICAgLyojIyMjIyovXG5cbiAgICAgICAgX2NhcmRPZmZzZXRZOiBudWxsLFxuXG4gICAgICAgIF9rcUNhcmRNb2RlczogW10sXG4gICAgICAgIF9hbGxDYXJkTW9kZXM6IFtdLFxuICAgICAgICBfZmluZENhcmRUeXBlT2JqZWN0OiBudWxsLCAgLy8g55So5p2l6K6w5b2V5om+5Yiw55qE54mM5Z6L5a+56LGhXG5cbiAgICAgICAgX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2s6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY2FyZE9mZnNldFkgPSAwO1xuICAgICAgICB0aGlzLl9yZWdpc3RlclRvdWNoRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRGFvc0xheW91dENsaWNrRXZlbnQoKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj54K55Ye756m655m95Zyw5pa55bCG54mM5pS25Zue5Y67Ki9cbiAgICBvbkNsaWNrQ2FyZFR5cGVDb21iaW5lTm9kZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XG4gICAgfSxcblxuICAgIF9oaWRlRGVsZXRlQnV0dG9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmJ0bkRlbGV0ZVRvdURhby5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJ0bkRlbGV0ZVpob25nRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnRuRGVsZXRlV2VpRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIC8vIOmHjee9ru+8jOWbnuWIsOacgOWIneWni+acieeKtuaAgVxuICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2hpZGVEZWxldGVCdXR0b25zKCk7XG4gICAgICAgIHRoaXMuY2xlYXJDYXJkcygpO1xuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XG4gICAgICAgIHRoaXMuX3R5cGVCdXR0b25zKCkuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgICAgICBidXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMgPSBbXTtcbiAgICB9LFxuXG4gICAgY2FyZHNMYXlvdXRTb3J0OiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBjYy5sb2coY2MubWFQYWkpO1xuICAgICAgICB2YXIgbm9kZUF5eSA9IGUudGFyZ2V0LmNoaWxkcmVuO1xuICAgICAgICBpZihub2RlQXl5WzBdLmFjdGl2ZSA9PSB0cnVlKXsvL+aMieWkp+Wwj1xuICAgICAgICAgICAgdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9IHRydWU7XG4gICAgICAgICAgICBub2RlQXl5WzBdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgbm9kZUF5eVsxXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYobm9kZUF5eVsxXS5hY3RpdmUgPT0gdHJ1ZSl7Ly/mjInoirHoibJcbiAgICAgICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIG5vZGVBeXlbMF0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIG5vZGVBeXlbMV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0U29ydENvbG9yID0gbm9kZUF5eVsxXS5hY3RpdmUgPT0gZmFsc2U7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9PSB0cnVlXG4gICAgfSxcblxuICAgIGFkZENhcmRzOiBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XG4gICAgICAgIGNjLmFzc2VydChjYXJkTmFtZXMpO1xuICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XG4gICAgICAgIC8vY2FyZE5hbWVzLnNvcnQoZnVuY3Rpb24oYTEsYTIpe1xuICAgICAgICAvLyAgICByZXR1cm4gYTEuc3BsaXQoJ18nKVswXSAtIGEyLnNwbGl0KCdfJylbMF07XG4gICAgICAgIC8vfSlcbiAgICAgICAgY2FyZE5hbWVzLmZvckVhY2goZnVuY3Rpb24oY2FyZCxpbmRleCl7XG4gICAgICAgICAgICB0aGlzLmFkZENhcmQoY2FyZCxmYWxzZSxpbmRleClcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0U29ydCgpO1xuICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XG4gICAgICAgIHRoaXMuX3JlbG9hZEtRQ2FyZE1vZGVzSW5uZXIoKTtcbiAgICAgICAgdGhpcy5fcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHModGhpcy5fa3FDYXJkTW9kZXMpO1xuICAgIH0sXG5cbiAgICBhZGRDYXJkOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGF1dG9DaGFuZ2VQb3NpdGlvblggPSBmYWxzZSxpbmRleCA9IG51bGwpIHtcbiAgICAgICAgY2MuYXNzZXJ0KGNhcmROYW1lLmxlbmd0aCA+IDApO1xuXG4gICAgICAgIGxldCBjYXJkUHJlZmFiID0gY2MuaW5zdGFudGlhdGUodGhpcy5jYXJkUHJlZmFiKTtcbiAgICAgICAgY2FyZFByZWZhYi5uYW1lID0gY2FyZE5hbWU7XG4gICAgICAgIGlmKGNjLm1hUGFpKXtcbiAgICAgICAgICAgIHZhciBjYXJkTWFQYWkgPSAnM18nICsgY2MubWFQYWk7XG4gICAgICAgICAgICBpZihjYXJkTmFtZSA9PSBjYXJkTWFQYWkpe1xuICAgICAgICAgICAgICAgIGNhcmRQcmVmYWIuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjI2LCAxNDUsIDE0NSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2FyZFByZWZhYi5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5zZXRDYXJkKGNhcmROYW1lLGluZGV4KTtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLmFkZENoaWxkKGNhcmRQcmVmYWIpO1xuICAgICAgICBjYXJkUHJlZmFiLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XG5cbiAgICAgICAgaWYgKGF1dG9DaGFuZ2VQb3NpdGlvblgpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgfVxuICAgICAgICAvL2xldCBuZXdDYXJkID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICAgICAgLy9sZXQgb3JpZ2luQ2FyZCA9IHRoaXMuX2FsbENhcmRNb2Rlcy5maW5kKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmQuaXNFcXVhbChuZXdDYXJkKTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9pZiAob3JpZ2luQ2FyZCA9PSBudWxsICYmICFhdXRvQ2hhbmdlUG9zaXRpb25YKSB7XG4gICAgICAgIC8vICAgIHRoaXMuX2FsbENhcmRNb2Rlcy5wdXNoKG5ld0NhcmQpO1xuICAgICAgICAvL31cbiAgICB9LFxuXG4gICAgYWRkQ2FyZE1vZGVzOiBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XG4gICAgICAgIGNjLmFzc2VydChjYXJkTmFtZXMubGVuZ3RoID4gMCk7XG4gICAgICAgIHRoaXMuX2FsbENhcmRNb2RlcyA9IFtdO1xuICAgICAgICBjYXJkTmFtZXMuZm9yRWFjaChmdW5jdGlvbihjYXJkTmFtZSxpbmRleCl7XG4gICAgICAgICAgICBsZXQgbmV3Q2FyZCA9IG5ldyBLUUNhcmQoY2FyZE5hbWUsbnVsbCxpbmRleCk7XG4gICAgICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMucHVzaChuZXdDYXJkKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgcmVsb2FkQ2FyZHM6IGZ1bmN0aW9uIChjYXJkTmFtZXMpIHtcbiAgICAgICAgLy9jYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMTEnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzRfMTEnLCAnNF8xMicsICczXzEzJywgJzJfNScsICcxXzEzJywgJzRfMycsICcxXzMnXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMV8xJywgJzJfMScsICczXzExJywgJzFfMTInLCAnMl8yJywgJzNfMicsICc0XzExJywgJzRfMTInLCAnM18xMycsICcyXzUnLCAnMV8xMycsICc0XzMnLCAnMV8zJ107XG4gICAgICAgIC8v5LiJ5bqm5ZCM6IqxXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzJfMTMnLCAnMl81JywgJzJfNycsICczXzEnLCAnM18yJywgJzNfNCcsICczXzMnLCAnM18xMycsICcxXzEyJywgJzFfNicsICcxXzEnLCAnMV80JywgJzFfNSddO1xuICAgICAgICAvL+S4ieWQjOiKsemhulxuICAgICAgICAvLyAgY2FyZE5hbWVzPVsnMl8xJywgJzJfMicsICcyXzMnLCAnMl80JywgJzJfNScsICczXzYnLCAnM183JywgJzNfOCcsICczXzknLCAnM18xMCcsICc0XzEnLCAnNF8yJywgJzRfMyddO1xuICAgICAgICAvL+S4gOadoem+mVxuICAgICAgICAvLyBjYXJkTmFtZXM9WycyXzEnLCAnMl8yJywgJzJfMycsICcyXzQnLCAnMl81JywgJzNfNicsICczXzcnLCAnM184JywgJzNfOScsICczXzEwJywgJzFfMTEnLCAnMV8xMicsICcxXzEzJ107XG4gICAgICAgIC8v5LiJ6aG65a2QXG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8xJywgJzNfMicsICc0XzMnLCAnMV83JywgJzRfNScsICc0XzYnLCAnM185JywgJzRfOCcsICczXzEnLCAnMV8xMycsICc0XzEyJywgJzRfMTEnLCAnMl8xMCddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9WyczXzUnLCAnM180JywgJzRfMycsICcxXzInLCAnM18xJywgJzRfOScsICczXzknLCAnNF84JywgJzNfMTAnLCAnMV8xMycsICc0XzEyJywgJzRfMTEnLCAnMl8xMCddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9WyczXzUnLCAnM180JywgJzRfMycsICcxXzInLCAnM18xJywgJzRfNScsICczXzYnLCAnNF84JywgJzNfNicsICcxXzEzJywgJzRfMTInLCAnNF8xMScsICcyXzcnXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9WyczXzQnLCAnM180JywgJzRfNicsICcyXzIwJywgJzFfMjAnLCAnMV8yMCcsICczXzYnLCAnNF84JywgJzNfNicsICcxXzgnLCAnNF8xMicsICc0XzExJywgJzJfMjAnXTtcbiAgICAgICAgLy/kuInkuLDlpKnkuItcbiAgICAgICAgLy9jYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMScsICcxXzInLCAnMl8yJywgJzNfMicsICc0XzEnLCAnNF8yJywgJzNfMycsICcyXzMnLCAnMV8zJywgJzRfMycsICcxXzEzJ107XG4gICAgICAgIC8vNOS4sOWkqeS4i1xuICAgICAgICAvLyBjYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMScsICcxXzQnLCAnMl80JywgJzNfMicsICc0XzInLCAnMV8yJywgJzNfNCcsICcyXzMnLCAnMV8zJywgJzRfMycsICcxXzInXTtcbiAgICAgICAgLy/lha3lsoHljYpcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMV8xJywgJzJfMScsICczXzExJywgJzFfMTInLCAnMl8yJywgJzNfMicsICc0XzExJywgJzRfMTInLCAnM18xMycsICcyXzUnLCAnMV8xMycsICc0XzMnLCAnMV8zJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnMV85JywgJzJfMTEnLCAnM184JywgJzFfMTInLCAnMl8yJywgJzNfMicsICcxXzEzJywgJzJfNScsICczXzUnLCcxXzQnLCAnMl80JywgJzNfNCcsICczXzEwJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzRfOScsICcyXzMnLCAnM180JywgJzNfNicsICcyXzEnLCAnMl80JywgJzJfMicsICcyXzUnLCAnMl8xMycsJzJfOCcsICcyXzEwJywgJzJfMTEnLCAnMl8xMiddO1xuICAgICAgICAvLyAgIGNhcmROYW1lcz1bJzRfMicsICcyXzMnLCAnM180JywgJzNfNScsICcyXzEnLCAnMl80JywgJzJfMicsICcyXzUnLCAnMl8xMycsJzJfOCcsICcyXzEwJywgJzJfMTEnLCAnMl8xMiddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMScsICcyXzEnLCAnMV80JywgJzNfNCcsICcxXzYnLCAnMl82JywgJzFfOCcsICczXzgnLCAnMl84JywnMl8xMicsICcxXzEyJywgJzJfMTMnLCAnM18xMyddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9Wyc0XzknLCAnMl8zJywgJzNfNCcsICczXzYnLCAnMl84JywgJzJfOScsICcyXzEwJywgJzJfMTEnLCAnMl8xMycsJzNfMTMnLCAnM18xMicsICcyXzEyJywgJzFfMTInXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnNF85JywgJzJfOScsICczXzQnLCAnM182JywgJzFfOCcsICcyXzEnLCAnMl81JywgJzJfNCcsICcyXzMnLCczXzEzJywgJzNfMTInLCAnMl8yJywgJzFfMTInXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9WyczXzInLCAnNF8yJywgJzJfNCcsICczXzUnLCAnMV81JywgJzNfNycsICcyXzcnLCAnM18xMCcsICcyXzEnLCcyXzEzJywgJzJfMTAnLCAnMl8xMicsICcyXzExJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8yJywgJzRfMycsICc0XzQnLCAnNF81JywgJzRfNScsICc0XzYnLCAnNF8xMicsICc0XzEzJywgJzJfMTInLCczXzEyJywgJzJfOCcsICczXzgnLCAnMl8xMSddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMycsICcxXzMnLCAnNF81JywgJzRfNScsICczXzUnLCAnMl81JywgJzFfMjAnLCAnNF8xMScsICczXzEyJywnNF8xMicsICc0XzgnLCAnNF8xJywgJzFfMTInXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzMnLCAnMV8zJywgJzRfNScsICc0XzUnLCAnMl8yMCcsICcxXzIwJywgJzFfMjAnLCAnNF8xMScsICczXzEyJywnNF8xMicsICc0XzgnLCAnNF8xJywgJzFfMTInXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzEwJywgJzRfMTEnLCAnNF8xMycsICc0XzUnLCAnMl8yMCcsICcxXzIwJywgJzFfMjAnLCAnNF8xMicsICczXzEyJywnNF8xMicsICc0XzgnLCAnMl8xMicsICcxXzEyJ107XG4gICAgICAgIHRoaXMuY2xlYXJDYXJkcygpO1xuICAgICAgICB0aGlzLl9rcUNhcmRNb2RlcyA9IFtdO1xuICAgICAgICB0aGlzLmFkZENhcmRzKGNhcmROYW1lcyk7XG4gICAgfSxcblxuICAgIGNsZWFyQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMubGF5b3V0VG91RGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMubGF5b3V0V2VpRGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICB9LFxuXG4gICAgcmVtb3ZlQ2FyZDogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICAgIGlmICghY2FyZE5hbWUubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoY2FyZE5hbWUpLnJlbW92ZUZyb21QYXJlbnQoKTtcbiAgICB9LFxuXG4gICAgc2V0RmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBfcmVsb2FkS1FDYXJkTW9kZXNJbm5lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9rcUNhcmRNb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNhcmRQcmVmYWJOb2RlKSB7XG4gICAgICAgICAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmRQcmVmYWJOb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgcmV0dXJuIGNhcmRQcmVmYWIuY2FyZE1vZGUoKTtcbiAgICAgICAgfSkuc29ydChLUUNhcmQuc29ydCk7XG4gICAgICAgIHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IG51bGw7XG4gICAgfSxcblxuICAgIF90eXBlQnV0dG9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgdGhpcy5idG5EdWlaaSxcbiAgICAgICAgICAgIHRoaXMuYnRuTGlhbmdEdWksXG4gICAgICAgICAgICB0aGlzLmJ0blNhblRpYW8sXG4gICAgICAgICAgICB0aGlzLmJ0blNodW5aaSxcbiAgICAgICAgICAgIHRoaXMuYnRuVG9uZ0h1YSxcbiAgICAgICAgICAgIHRoaXMuYnRuSHVMdSxcbiAgICAgICAgICAgIHRoaXMuYnRuVGllWmhpLFxuICAgICAgICAgICAgdGhpcy5idG5Ub25nSHVhU2h1bixcbiAgICAgICAgICAgIC8qIyMjIyMqL1xuICAgICAgICAgICAgLy90aGlzLmJ0bld1VG9uZyxcbiAgICAgICAgICAgIC8qIyMjIyMqL1xuICAgICAgICBdO1xuICAgIH0sXG5cbiAgICBfcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHM6IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgICAgICAgLypjYXJkTW9kZXMubGVuZ3RoID09IDEzKi9cbiAgICAgICAgY2FyZE1vZGVzID0gY2FyZE1vZGVzIHx8IHRoaXMuX2txQ2FyZE1vZGVzO1xuXG4gICAgICAgIC8qIyMjIyPliJ3lp4vljJbniYwqL1xuICAgICAgICB2YXIgQnV0dG9uc0xheW91dENoaWxkcyA9IHRoaXMudHlwZUJ1dHRvbnNOb2RlLmNoaWxkcmVuO1xuICAgICAgICBmb3IodmFyIGk9MDtpPEJ1dHRvbnNMYXlvdXRDaGlsZHMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICBCdXR0b25zTGF5b3V0Q2hpbGRzW2ldLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5idG5EdWlaaS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbkR1aVppKGNhcmRNb2Rlcyk7XG4gICAgICAgIHRoaXMuYnRuTGlhbmdEdWkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZE1vZGVzKTtcbiAgICAgICAgdGhpcy5idG5TYW5UaWFvLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkTW9kZXMpO1xuICAgICAgICB0aGlzLmJ0blNodW5aaS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblNodW5aaShjYXJkTW9kZXMpO1xuICAgICAgICB0aGlzLmJ0blRvbmdIdWEuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRNb2Rlcyk7XG4gICAgICAgIHRoaXMuYnRuSHVMdS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbkh1THUoY2FyZE1vZGVzKTtcbiAgICAgICAgdGhpcy5idG5UaWVaaGkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZE1vZGVzKTtcbiAgICAgICAgdGhpcy5idG5Ub25nSHVhU2h1bi5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5XdVRvbmcuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZE1vZGVzKTtcbiAgICAgICAgLy9LUUNhcmQuaXNUZVNodVBhaShjYXJkTW9kZXMpXG4gICAgICAgIC8vbGV0IHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoY2FyZE1vZGVzKTtcbiAgICAgICAgLy9LUUNhcmQuaXNMaXVEdWlCYW4oY2FyZE1vZGVzKTtcbiAgICAgICAgLy9jYy5sb2codHlwZU5hbWUpOyBjYy5sb2coJ+eJueauiueJjG5hbWUnKTtcbiAgICAgICAgLy9hbGVydCh0aGlzLmJ0blNodW5aaS5pbnRlcmFjdGFibGUpXG4gICAgICAgIC8qIyMjIyPlpoLmnpzmnInlpJrkuIDoibLvvIzlsLHmmK/orr7nva7ml6DlkIzmjInpkq7nmoTlj6/kuqTkupLmgKcqL1xuICAgICAgICAvL2lmKGNjLmR1b1lpU2UgPT0gMCkge1xuICAgICAgICAvLyAgICB0aGlzLnd1VG9uZ05vZGUgPSB0aGlzLnR5cGVCdXR0b25zTm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bld1VG9uZ1wiKTtcbiAgICAgICAgLy8gICAgdGhpcy5idG5XdVRvbmcgPSB0aGlzLnd1VG9uZ05vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIC8vICAgIHRoaXMuYnRuV3VUb25nLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vfVxuICAgICAgICAvKiMjIyMjKi9cblxuICAgICAgICB0aGlzLl9hdXRvQWN0aXZlVHlwZUJ1dHRvbnMoKTtcblxuICAgICAgICAvKiMjIyMj6K6+572u5oyJ6ZKu5Y+v5Lqk5LqS5ZKM5LiN5Y+v5Lqk5LqS5pe255qE6YCP5piO5bqmKi9cbiAgICAgICAgZm9yKHZhciBpPTA7aTxCdXR0b25zTGF5b3V0Q2hpbGRzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYoQnV0dG9uc0xheW91dENoaWxkc1tpXS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUpe1xuICAgICAgICAgICAgICAgIEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0ub3BhY2l0eSA9IDI1NTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0ub3BhY2l0eSA9IDEyNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDlsIbmib7liLDkuobniYznsbvlnovnmoTniYznqoHlh7rlh7rmnaVcbiAgICBfc3RpY2tPdXRGaW5kQ2FyZFR5cGU6IGZ1bmN0aW9uICh0aXRsZSwgZmluZE1ldGhvZHMpIHtcblxuICAgICAgICAvLyDlhYjmoLnmja7niYznsbvlnovmib7lh7rmiYDmnInnmoTntKLlvJXpm4blkIhcbiAgICAgICAgdmFyIGZpbmRlZEluZGV4c0FycmF5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0ID0gdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0IHx8IHt9O1xuICAgICAgICBpZiAodGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LnRpdGxlICE9IHRpdGxlKSB7XG4gICAgICAgICAgICBmaW5kZWRJbmRleHNBcnJheSA9IChmaW5kTWV0aG9kcygpIHx8IFtdKS5yZXZlcnNlKCk7XG5cbiAgICAgICAgICAgIGZvcih2YXIgaSA9MDtpPGZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aC0xO2krKyl7Ly/liKDpmaTlkIznsbvlnovniYxcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBmaW5kZWRJbmRleHNBcnJheVtpXTtcbiAgICAgICAgICAgICAgICAvKmlmKHRpdGxlID09ICdsaWFuZ0R1aScpe1xuICAgICAgICAgICAgICAgICBsZXQgalN0cmluZ3Nwb2ludCA9IGluZGV4Lm1hcChmdW5jdGlvbihpbmRleHMpe1xuICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhzXS5wb2ludDtcbiAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgdmFyIGlzQnJlYWsgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgdmFyIHJlcE51bSA9IGpTdHJpbmdzcG9pbnQucmVkdWNlKGZ1bmN0aW9uKHAsbil7XG4gICAgICAgICAgICAgICAgIGlmKCFwW25dKXtcbiAgICAgICAgICAgICAgICAgcFtuXSA9IDE7XG4gICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICBwW25dICs9IDFcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICByZXR1cm4gcFxuICAgICAgICAgICAgICAgICB9LHt9KTtcbiAgICAgICAgICAgICAgICAgZm9yKHZhciB5IGluIHJlcE51bSl7XG4gICAgICAgICAgICAgICAgIGlmKHJlcE51bVt5XSA+PSAzKXtcbiAgICAgICAgICAgICAgICAgaXNCcmVhayA9IHRydWU7XG4gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICBpZihpc0JyZWFrKXtcbiAgICAgICAgICAgICAgICAgY2MubG9nKHJlcE51bSlcbiAgICAgICAgICAgICAgICAgY2MubG9nKGZpbmRlZEluZGV4c0FycmF5KVxuICAgICAgICAgICAgICAgICBjYy5sb2coaSlcbiAgICAgICAgICAgICAgICAgY2MubG9nKCctLS0tLS0tLTI5MScpXG4gICAgICAgICAgICAgICAgIGZpbmRlZEluZGV4c0FycmF5LnNwbGljZShpLDEpO1xuICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgICAgICB2YXIgaVN0cmluZyA9ICcnO1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9aSsxO2o8ZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gZmluZGVkSW5kZXhzQXJyYXlbal07XG4gICAgICAgICAgICAgICAgICAgIHZhciBqU3RyaW5nID0gJyc7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGlTdHJpbmdzID0gcy5tYXAoZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZWwuY2FyZE5hbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgalN0cmluZ3MgPSBpbmRleC5tYXAoZnVuY3Rpb24oaW5kZXhzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjYXJkTW9kZWwgPSB0aGlzLl9rcUNhcmRNb2Rlc1tpbmRleHNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhcmRNb2RlbC5jYXJkTmFtZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciByID0gMDtyIDwgaW5kZXgubGVuZ3RoO3IrKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBqU3RyaW5nID0galN0cmluZyArIGlTdHJpbmdzW3JdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaVN0cmluZyA9IGlTdHJpbmcgKyBqU3RyaW5nc1tyXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmKGpTdHJpbmcgPT0gaVN0cmluZyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5kZWRJbmRleHNBcnJheS5zcGxpY2UoaSwxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICAgICAgICAgIGluZGV4c0FycmF5OiBmaW5kZWRJbmRleHNBcnJheSxcbiAgICAgICAgICAgICAgICAvL2luZGV4OiB0aXRsZT09XCJkdWlaaVwiP2ZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aC0xOjBcbiAgICAgICAgICAgICAgICBpbmRleDogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZpbmRlZEluZGV4c0FycmF5ID0gdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LmluZGV4c0FycmF5O1xuICAgICAgICBpZiAoIWZpbmRlZEluZGV4c0FycmF5IHx8IGZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8g5bCG5bey5pyJ55qE56qB5Ye655qE54mM55qE5L2N572u6YeN572u5Zue5Yid5aeL5L2N572uXG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcblxuICAgICAgICAvLyDorqHnrpflh7ropoHnqoHlh7rnmoTniYzmlbDnu4RcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LmluZGV4O1xuICAgICAgICBsZXQgaW5kZXhzID0gZmluZGVkSW5kZXhzQXJyYXlbaW5kZXhdO1xuXG4gICAgICAgIGxldCBzZWxlY3RlZENhcmROYW1lcyA9IGluZGV4cy5tYXAoZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAgICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4XTtcbiAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZWwuY2FyZE5hbWUoKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAvL2NjLmxvZyhzZWxlY3RlZENhcmROYW1lcylcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgICAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmROb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgaWYoc2VsZWN0ZWRDYXJkTmFtZXMuaW5jbHVkZXMoY2FyZFByZWZhYi5jYXJkTmFtZSgpKSkge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lSW5kZXggPSBzZWxlY3RlZENhcmROYW1lcy5pbmRleE9mKGNhcmRQcmVmYWIuY2FyZE5hbWUoKSk7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRDYXJkTmFtZXMuc3BsaWNlKG5hbWVJbmRleCwxKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vY2MubG9nKGNhcmROb2RlcylcbiAgICAgICAgLy9jYy5sb2coaW5kZXgpXG4gICAgICAgIC8vY2MubG9nKGZpbmRlZEluZGV4c0FycmF5KVxuICAgICAgICAvL2NjLmxvZygnLS0tLS0tLS0tLTI0OCcpXG4gICAgICAgIC8vIOeqgeWHuuiuoeeul+WHuuadpeeahOeJjOaVsOe7hFxuICAgICAgICB0aGlzLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgLy8g5L+d5a2Y5aW977yM55So5LqO5YaN5qyh54K55Ye75LqG56qB5Ye65LiL5LiA57uE54mMXG4gICAgICAgIGluZGV4ID0gKGluZGV4ICsgMSkgJSBmaW5kZWRJbmRleHNBcnJheS5sZW5ndGg7XG4gICAgICAgIHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdC5pbmRleCA9IGluZGV4O1xuICAgIH0sXG5cbiAgICBjbGlja0R1aVppOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwiZHVpWmlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kRHVpWmkodGhpcy5fa3FDYXJkTW9kZXMpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjbGlja0xpYW5nRHVpOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwibGlhbmdEdWlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kTGlhRHVpKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTYW5UaWFvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwic2FuVGlhb1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRTYW5UaWFvKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTaHVuWmk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJzaHVuWmlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kU2h1blppKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tUb25nSHVhOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwidG9uZ0h1YVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tIdUx1OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwiaHVMdVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRIdUx1KHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tUaWVaaGk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ0aWVaaGlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kVGllWmhpKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgLyojIyMjIyovXG4gICAgY2xpY2tXdVRvbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIueCueWHu+S6huS6lOWQjOaMiemSrlwiKTtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ3dVRvbmdcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kV3VUb25nKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuICAgIC8qIyMjIyMqL1xuXG4gICAgY2xpY2tUb25nSHVhU2h1bjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInRvbmdIdWFTaHVuXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFRvbmdIdWFTaHVuKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tDYW5jZWxBbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVRvdURhbygpO1xuICAgICAgICB0aGlzLmNsaWNrRGVsZXRlWmhvbmdEYW8oKTtcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVdlaURhbygpO1xuICAgIH0sXG5cbiAgICAvKueCueWHu+WujOaIkOaMiemSriovXG4gICAgY2xpY2tEb25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB0b3VDYXJkTW9kZWxzID0gdGhpcy5fdGFvRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIGxldCB6aG9uZ0NhcmRNb2RlcyA9IHRoaXMuX3pob25nRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIGxldCB3ZWlDYXJkTW9kZXMgPSB0aGlzLl93ZWlEYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgdGhpcy5fZGlkU2VsZWN0ZWRDYXJkcyh0b3VDYXJkTW9kZWxzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzKTtcbiAgICB9LFxuXG4gICAgLyrngrnlh7vmga3llpzkvaDpobXpnaLnmoTnoa7lrprmjInpkq4qL1xuICAgIG9uQnRuR29uZ1hpTmlDb21maXJtQ2xpY2s6ZnVuY3Rpb24gKCkge1xuICAgICAgICAvL+iusOW9leeOqeWutueCueWHu+S6huehruWumuaMiemSru+8mlxuICAgICAgICB0aGlzLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtID0gdHJ1ZTtcbiAgICAgICAgLy/lhYjopoHlvpfliLDnjqnlrrbnmoQxM+W8oOeJjCB0ZVNodVBhaUNhcmRzW3snbnVtYmVyJzoxLCdzdWl0Jzoncyd9LHsuLi59LHsuLi59XVxuICAgICAgICB2YXIgdGVTaHVQYWlDYXJkcyA9IGNjLnRlU2h1UGFpQ2FyZHM7XG4gICAgICAgIGNvbnNvbGUubG9nKHRlU2h1UGFpQ2FyZHMpO1xuICAgICAgICB2YXIgdGVTaHVQYWlDYXJkc1NlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsMih0ZVNodVBhaUNhcmRzKTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFt0ZVNodVBhaUNhcmRzU2VydmVySW5mb107XG4gICAgICAgIGNvbnNvbGUubG9nKFwi54K55Ye75LqG5oGt5Zac5L2g6aG16Z2i55qE56Gu5a6a5oyJ6ZKuXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyh0ZVNodVBhaUNhcmRzU2VydmVySW5mbyk7XG4gICAgICAgIGlmICh0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX2RpZFNlbGVjdGVkQ2FyZHM6IGZ1bmN0aW9uICh0b3VDYXJkcywgemhvbmdDYXJkcywgd2VpQ2FyZHMpIHtcbiAgICAgICAgdG91Q2FyZHMgPSB0b3VDYXJkcyB8fCBbXTtcbiAgICAgICAgemhvbmdDYXJkcyA9IHpob25nQ2FyZHMgfHwgW107XG4gICAgICAgIHdlaUNhcmRzID0gd2VpQ2FyZHMgfHwgW107XG4gICAgICAgIGxldCB0b3VTZXJ2ZXJJbmZvID0gdGhpcy5fY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbCh0b3VDYXJkcyk7XG4gICAgICAgIGxldCB6aG9uZ1NlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsKHpob25nQ2FyZHMpO1xuICAgICAgICBsZXQgd2VpU2VydmVySW5mbyA9IHRoaXMuX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwod2VpQ2FyZHMpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gW3RvdVNlcnZlckluZm8sIHpob25nU2VydmVySW5mbywgd2VpU2VydmVySW5mb107XG5cbiAgICAgICAgaWYgKHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjbGlja0RlbGV0ZVRvdURhbzogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkc09mTGF5b3V0KHRoaXMubGF5b3V0VG91RGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBjbGlja0RlbGV0ZVpob25nRGFvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGV0ZURhb0NhcmRzT2ZMYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgY2xpY2tEZWxldGVXZWlEYW86IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlRGFvQ2FyZHNPZkxheW91dCh0aGlzLmxheW91dFdlaURhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgLy8g6K6h5pe25Zmo5LqL5Lu2XG4gICAgdGltZVN0YXJ0OiBmdW5jdGlvbiAoZHVyYXRpb24pIHtcbiAgICAgICAgY2MuYXNzZXJ0KGR1cmF0aW9uID4gMCk7XG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcbiAgICAgICAgdGhpcy50aW1lTm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBTdHJpbmcoZHVyYXRpb24pO1xuICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuX3RpbWVNZXRob2QsIDEsIGR1cmF0aW9uKTtcbiAgICB9LFxuXG4gICAgdGltZVN0b3A6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuX3RpbWVNZXRob2QpO1xuICAgICAgICB0aGlzLnRpbWVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBfdGltZU1ldGhvZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPSB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gLSAxO1xuXG4gICAgICAgIHZhciByZW1haW4gPSBNYXRoLm1heCh0aGlzLl90aW1lUmVtYWluRHVyYXRpb24sIDApO1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSAocmVtYWluIDwgMTAgJiYgcmVtYWluID4gMCkgPyAoJzAnICsgcmVtYWluKSA6IHJlbWFpbjtcblxuICAgICAgICBpZiAodGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uIDw9IDApIHtcbiAgICAgICAgICAgIHRoaXMudGltZVN0b3AoKTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRBdXRvU2VsZWN0Q2FyZHMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDotoXml7blkI7vvIzoh6rliqjpgInniYxcbiAgICBfdGltZU91dEF1dG9TZWxlY3RDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICog6ZqQ6JeP5oGt5Zac5L2gXG4gICAgICAgICAqL1xuICAgICAgICBwbGF5LmdvbmdYaU5pU2hvdyhmYWxzZSk7XG4gICAgICAgIGlmICh0eXBlb2YoY2MudGVTaHVQYWlDYXJkcykgIT0gXCJ1bmRlZmluZWRcIiAmJiBjYy50ZVNodVBhaUNhcmRzICE9IG51bGwgJiYgY2MudGVTaHVQYWlDYXJkcyAhPSAnJykge1xuICAgICAgICAgICAgdGhpcy5vbkJ0bkdvbmdYaU5pQ29tZmlybUNsaWNrKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgW3RvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXNdID0gdGhpcy5fY2FjbGVBdXRvU2VsZWN0ZWRDYXJkcygpO1xuXG4gICAgICAgIGlmICh0b3VDYXJkTW9kZWxzID09IG51bGwgfHwgemhvbmdDYXJkTW9kZXMgPT0gbnVsbCB8fCB3ZWlDYXJkTW9kZXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgdG91Q2FyZE1vZGVscyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgtMyk7XG4gICAgICAgICAgICB6aG9uZ0NhcmRNb2RlcyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSg1LCAxMCk7XG4gICAgICAgICAgICB3ZWlDYXJkTW9kZXMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoMCwgNSk7XG4gICAgICAgIH1cblxuICAgICAgICBjYy5sb2codG91Q2FyZE1vZGVscylcbiAgICAgICAgY2MubG9nKHpob25nQ2FyZE1vZGVzKVxuICAgICAgICBjYy5sb2cod2VpQ2FyZE1vZGVzKVxuICAgICAgICBjYy5sb2codGhpcy5fYWxsQ2FyZE1vZGVzKVxuICAgICAgICBjYy5sb2coXCLoh6rliqjpgInniYwgdG91Q2FyZE1vZGVscyB6aG9uZ0NhcmRNb2RlcyB3ZWlDYXJkTW9kZXPvvJpcIik7XG4gICAgICAgIHRoaXMuX2RpZFNlbGVjdGVkQ2FyZHModG91Q2FyZE1vZGVscywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlcyk7XG4gICAgfSxcblxuICAgIF9jYWNsZUF1dG9TZWxlY3RlZENhcmRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgbGV0IGNhcmRzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbHRlcihmdW5jdGlvbihpKXtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHJlc3VsdENhcmRzID0gW107XG4gICAgICAgIGZvcih2YXIgaSA9IDE7aSA8IDM7IGkrKyl7XG4gICAgICAgICAgICBsZXQgY2FyZHNzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkcywgNSk7XG4gICAgICAgICAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmRzcyk7XG4gICAgICAgICAgICByZXN1bHRDYXJkcy5wdXNoKGNhcmRzcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0Q2FyZHMucHVzaChjYXJkcyk7XG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMl0pO1xuICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMV0pO1xuICAgICAgICBsZXQgd2VpU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdENhcmRzWzBdKTtcbiAgICAgICAgY2MubG9nKHJlc3VsdENhcmRzKVxuICAgICAgICBjYy5sb2codGhpcy5fYWxsQ2FyZE1vZGVzKVxuICAgICAgICBjYy5sb2coXCLniYzliIbmlbDoh6rliqjpgInniYzvvJpcIiwgdG91U2NvcmUsIHpob25nU2NvcmUsIHdlaVNjb3JlKTtcbiAgICAgICAgLy9sZXQgd2VpQ2FyZE1vZGVzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkcywgNSk7XG4gICAgICAgIC8vY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyh3ZWlDYXJkTW9kZXMpO1xuICAgICAgICAvL1xuICAgICAgICAvL2xldCB6aG9uZ0NhcmRNb2RlcyA9IEtRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMoY2FyZHMsIDUpO1xuICAgICAgICAvL1xuICAgICAgICAvL2xldCB0b3VDYXJkTW9kZXMgPSBjYXJkcy5rcV9leGNsdWRlcyh6aG9uZ0NhcmRNb2Rlcyk7XG4gICAgICAgIC8vaWYgKHRvdUNhcmRNb2Rlcy5sZW5ndGggPT0gMyAmJiB6aG9uZ0NhcmRNb2Rlcy5sZW5ndGggPT0gNSAmJiB3ZWlDYXJkTW9kZXMubGVuZ3RoID09IDUpIHtcbiAgICAgICAgLy8gICAgcmV0dXJuIFt0b3VDYXJkTW9kZXMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXNdO1xuICAgICAgICAvL31cbiAgICAgICAgaWYgKHJlc3VsdENhcmRzWzJdLmxlbmd0aCA9PSAzICYmIHJlc3VsdENhcmRzWzFdLmxlbmd0aCA9PSA1ICYmIHJlc3VsdENhcmRzWzBdLmxlbmd0aCA9PSA1KSB7XG4gICAgICAgICAgICByZXR1cm4gW3Jlc3VsdENhcmRzWzJdLCByZXN1bHRDYXJkc1sxXSwgcmVzdWx0Q2FyZHNbMF1dO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH0sXG5cbiAgICBfY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbDogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcbiAgICAgICAgcmVzdWx0LnR5cGUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhjYXJkcyk7XG4gICAgICAgIGlmIChyZXN1bHQudHlwZSA+PSBLUUNhcmQuVFlQRS5TYW5UYW9IdWEgJiYgY2MubW9zaGkgIT0gMSkge1xuICAgICAgICAgICAgLy8g54m55q6K54mMXG4gICAgICAgICAgICByZXN1bHQuaXNDb250YWluRXh0cmEgPSB0aGlzLl9pc0NvbnRhaW5FeHRyYUNhcmRzVHlwZShyZXN1bHQudHlwZSwgY2FyZHMpO1xuICAgICAgICAgICAgLy9yZXN1bHQuaXNDb250YWluRXh0cmEgPSB0cnVlO1xuICAgICAgICAgICAgcmVzdWx0LmNhcmRzID0gY2FyZHM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQuY2FyZHMgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMoY2FyZHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIC8qIyMjIyMqL1xuICAgIF9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsMjogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcbiAgICAgICAgcmVzdWx0LnR5cGUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlID0gS1FDYXJkLnNjb3JlT2ZDYXJkczIoY2FyZHMpO1xuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPj0gS1FDYXJkLlRZUEUuU2FuVGFvSHVhICYmIGNjLm1vc2hpICE9IDEpIHtcbiAgICAgICAgICAgIC8vIOeJueauiueJjFxuICAgICAgICAgICAgcmVzdWx0LmlzQ29udGFpbkV4dHJhID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlc3VsdC5jYXJkcyA9IGNhcmRzO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuICAgIC8qIyMjIyMqL1xuICAgIC8vIOeJueauiueJjOmHjOaYr+WQpui/mOWQq+acieeJueauiueJjFxuICAgIC8vIOWMheWQq+eahOaDheWGteacie+8mlxuICAgIC8vIOS4ieahg+iKsSDlj6/og73lkKvmnInlkIzoirHpobpcbiAgICAvLyDkuInpobrlrZAg5Y+v6IO95ZCr5pyJ5ZCM6Iqx6aG6XG4gICAgLy8g5YWt5a+55Y2KIOWPr+iDveWQq+aciemTgeaUr1xuICAgIF9pc0NvbnRhaW5FeHRyYUNhcmRzVHlwZTogZnVuY3Rpb24gKHR5cGUsIGNhcmRzKSB7XG4gICAgICAgIGlmICh0eXBlID09IEtRQ2FyZC5UWVBFLlNhblRhb0h1YSkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gS1FDYXJkLlRZUEUuU2FuU2h1blppKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcyk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBLUUNhcmQuVFlQRS5MaXVEdWlCYW4pIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuY29udGFpblRpZVpoaShjYXJkcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG5cbiAgICAvLyDop6bmkbjkuovku7ZcbiAgICBfcmVnaXN0ZXJUb3VjaEV2ZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMuX3RvdWNoQ2FyZExheW91dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX01PVkUsIHRoaXMuX3RvdWNoQ2FyZExheW91dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgdGhpcy5fdG91Y2hDYXJkTGF5b3V0RW5kLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLCB0aGlzLl90b3VjaENhcmRMYXlvdXRFbmQuYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIF90b3VjaENhcmRMYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5idWJibGVzID0gdHJ1ZTtcbiAgICAgICAgbGV0IGxvY2F0aW9uID0gZXZlbnQuZ2V0TG9jYXRpb24oKTtcbiAgICAgICAgbGV0IGNhcmRQcmVmYWIgPSB0aGlzLl9jYXJkUHJlZmFiSW5DYXJkTGF5b3V0V2l0aExvY2F0aW9uKGxvY2F0aW9uKTtcbiAgICAgICAgaWYgKGNhcmRQcmVmYWIpIHtcbiAgICAgICAgICAgIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuc2V0U2VsZWN0ZWQodHJ1ZSk7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfdG91Y2hDYXJkTGF5b3V0RW5kOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5fY2hhbmdlU2VsZWN0ZWRDYXJkUHJlZmFic1koKTtcbiAgICAgICAgdGhpcy5fZGlzZWNsZWN0Q2FyZFByZWZhYnMoKTtcbiAgICB9LFxuXG4gICAgX2NhcmRQcmVmYWJJbkNhcmRMYXlvdXRXaXRoTG9jYXRpb246IGZ1bmN0aW9uIChsb2NhdGlvbikge1xuICAgICAgICBsb2NhdGlvbiA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihsb2NhdGlvbik7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAoY2FyZE5vZGUxLCBjYXJkTm9kZTIpIHtcbiAgICAgICAgICAgIGxldCByZWN0MSA9IGNhcmROb2RlMS5nZXRCb3VuZGluZ0JveCgpO1xuICAgICAgICAgICAgbGV0IHJlY3QyID0gY2FyZE5vZGUyLmdldEJvdW5kaW5nQm94KCk7XG4gICAgICAgICAgICByZXR1cm4gcmVjdDIueCAtIHJlY3QxLng7XG4gICAgICAgIH0pO1xuICAgICAgICBmb3IgKGxldCBpbmRleCBpbiBjYXJkTm9kZXMpIHtcbiAgICAgICAgICAgIGxldCBjYXJkTm9kZSA9IGNhcmROb2Rlc1tpbmRleF07XG5cbiAgICAgICAgICAgIGxldCByZWN0ID0gY2FyZE5vZGUuZ2V0Qm91bmRpbmdCb3goKTtcblxuICAgICAgICAgICAgaWYgKGNjLnJlY3RDb250YWluc1BvaW50KHJlY3QsIGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYXJkTm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICBfY2hhbmdlU2VsZWN0ZWRDYXJkUHJlZmFic1k6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuX3NlbGVjdGVkQ2FyZFByZWZhYnMoKTtcbiAgICAgICAgdGhpcy5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG5cbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlQb2tlckNsaWNrKCk7XG4gICAgfSxcblxuICAgIF9jaGFuZ2VDYXJkUHJlZmFic1k6IGZ1bmN0aW9uIChjYXJkTm9kZXMpIHtcbiAgICAgICAgY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgICAgICBsZXQgeSA9IGNhcmROb2RlLmdldFBvc2l0aW9uWSgpO1xuICAgICAgICAgICAgaWYgKHkgPT0gdGhpcy5fY2FyZE9mZnNldFkpIHtcbiAgICAgICAgICAgICAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblkodGhpcy5fY2FyZE9mZnNldFkgKyA1NSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIF9zZWxlY3RlZENhcmRQcmVmYWJzOiBmdW5jdGlvbiAoaW5jbHVkZVN0aWNrT3V0ID0gZmFsc2UpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgcmV0dXJuIGNhcmROb2Rlcy5maWx0ZXIoZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgICAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmROb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgbGV0IGlzU2VsZWN0ZWQgPSBjYXJkUHJlZmFiLmlzU2VsZWN0ZWQoKTtcbiAgICAgICAgICAgIGlmICghaXNTZWxlY3RlZCAmJiBpbmNsdWRlU3RpY2tPdXQpIHtcbiAgICAgICAgICAgICAgICBpc1NlbGVjdGVkID0gY2FyZE5vZGUuZ2V0UG9zaXRpb25ZKCkgPiAxMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGlzU2VsZWN0ZWQ7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfZGlzZWNsZWN0Q2FyZFByZWZhYnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIG5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuc2V0U2VsZWN0ZWQoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLy8g6YeN572uIGNhcmRzIOeahCBYXG4gICAgX3Jlc2V0Q2FyZHNQb3NpdGlvblg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9sZXQgaW50ZXJ2YWwgPSA5ODtcbiAgICAgICAgbGV0IGludGVydmFsID0gNzg7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4gfHwgW107XG4gICAgICAgIGxldCBsZW5ndGggPSBjYXJkTm9kZXMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBtaWRkbGVJbmRleCA9IGxlbmd0aCAvIDI7XG4gICAgICAgIGxldCBjYXJkV2lkdGggPSAxNTQ7XG5cblxuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXRTb3J0KCk7XG4gICAgICAgIGlmKHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPT0gdHJ1ZSl7XG4gICAgICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudDEgPSBuMS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgICAgICAgICBsZXQgY29tcG9uZW50MiA9IG4yLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQyLmNhcmRNb2RlKCkuY29sb3IgLSBjb21wb25lbnQxLmNhcmRNb2RlKCkuY29sb3I7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudDEgPSBuMS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgICAgICAgICBsZXQgY29tcG9uZW50MiA9IG4yLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQxLmNhcmRNb2RlKCkuc29ydChjb21wb25lbnQyLmNhcmRNb2RlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9jYXJkTm9kZXMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIC8vICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgIGxldCBjb21wb25lbnQyID0gbjIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgIHJldHVybiBjb21wb25lbnQxLmNhcmRNb2RlKCkuc29ydChjb21wb25lbnQyLmNhcmRNb2RlKCkpO1xuICAgICAgICAvL30pO1xuXG4gICAgICAgIGNhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGNhcmROb2RlLnpJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgbGV0IHggPSAoaW5kZXggLSBtaWRkbGVJbmRleCkgKiBpbnRlcnZhbCArIGNhcmRXaWR0aCAvIDM7XG4gICAgICAgICAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblgoeCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyDph43nva4gY2FyZHMg55qEIFjkuLowXG4gICAgcmVzZXRDYXJkc1Bvc2l0aW9uWDE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgbGV0IGxlbmd0aCA9IGNhcmROb2Rlcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xuICAgICAgICAgICAgY2FyZE5vZGUuc2V0UG9zaXRpb25ZKDApO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX3Jlc2V0Q2FyZHNQb3NpdGlvblk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgICAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblkodGhpcy5fY2FyZE9mZnNldFkpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICAvLyDlpLTjgIHkuK3jgIHlsL7pgZMgbGF5b3V0IOeahOeCueWHu+S6i+S7tlxuICAgIF9yZWdpc3RlckRhb3NMYXlvdXRDbGlja0V2ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsYXlvdXRUb3VEYW8gPSB0aGlzLmxheW91dFRvdURhbztcbiAgICAgICAgdmFyIGxheW91dFpob25nRGFvID0gdGhpcy5sYXlvdXRaaG9uZ0RhbztcbiAgICAgICAgdmFyIGxheW91dFdlaURhbyA9IHRoaXMubGF5b3V0V2VpRGFvO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIC8v5aS06YGT54K55Ye7XG4gICAgICAgIHRoaXMubGF5b3V0VG91RGFvLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX2NsaWNrVG91RGFvTGF5b3V0KGV2ZW50KTtcbiAgICAgICAgICAgIC8qIyMjIyPngrnlh7vnrKzkuozpgZPliankuIvnmoTniYzoh6rliqjpgInkuIrljrsjIyMjIyBiZWdpbiovXG4gICAgICAgICAgICAvL+WmguaenOWJqeS4i+eahOeJjOWwj+S6jjXlvKBcbiAgICAgICAgICAgIGlmKHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5sZW5ndGggPD0gNSl7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzlsL7pgZPloavmu6HvvIzmiorlroPmlL7lhaXkuK3pgZNcbiAgICAgICAgICAgICAgICBpZihsYXlvdXRaaG9uZ0Rhby5ub2RlLmNoaWxkcmVuLmxlbmd0aCA8IDUgJiYgbGF5b3V0V2VpRGFvLm5vZGUuY2hpbGRyZW4ubGVuZ3RoID09IDUpe1xuICAgICAgICAgICAgICAgICAgICAvLyDnqoHlh7rorqHnrpflh7rmnaXnmoTniYzmlbDnu4RcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZERhb0NhcmRUb0xheW91dChsYXlvdXRaaG9uZ0Rhby5ub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzkuK3pgZPloavmu6HvvIzmiorlroPmlL7lhaXlsL7pgZNcbiAgICAgICAgICAgICAgICBlbHNlIGlmKGxheW91dFdlaURhby5ub2RlLmNoaWxkcmVuLmxlbmd0aCA8IDUgJiYgbGF5b3V0WmhvbmdEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gNSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkRGFvQ2FyZFRvTGF5b3V0KGxheW91dFdlaURhby5ub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiMjIyMjZW5kKi9cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy/kuK3pgZPngrnlh7tcbiAgICAgICAgdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9jbGlja1pob25nRGFvTGF5b3V0KGV2ZW50KTtcbiAgICAgICAgICAgIC8qIyMjIyNiZWdpbiovXG4gICAgICAgICAgICAvL+S4remBk+W/hemhu+Whq+a7oeaJjeadpeaJp+ihjFxuICAgICAgICAgICAgaWYobGF5b3V0WmhvbmdEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gNSl7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzliankuIvnmoTniYzlsI/kuo7nrYnkuo415bygXG4gICAgICAgICAgICAgICAgaWYodGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLmxlbmd0aCA8PSA1KXtcbiAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzlsL7pgZPloavmu6HvvIzmiorlroPmlL7lhaXlpLTpgZNcbiAgICAgICAgICAgICAgICAgICAgaWYobGF5b3V0VG91RGFvLm5vZGUuY2hpbGRyZW4ubGVuZ3RoIDwgMyAmJiBsYXlvdXRXZWlEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gNSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDnqoHlh7rorqHnrpflh7rmnaXnmoTniYzmlbDnu4RcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW47XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZERhb0NhcmRUb0xheW91dChsYXlvdXRUb3VEYW8ubm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzlpLTpgZPloavmu6HvvIzmiorlroPmlL7lhaXlsL7pgZNcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihsYXlvdXRXZWlEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPCA1ICYmIGxheW91dFRvdURhby5ub2RlLmNoaWxkcmVuLmxlbmd0aCA9PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9hZGREYW9DYXJkVG9MYXlvdXQobGF5b3V0V2VpRGFvLm5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiMjIyMjZW5kKi9cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy/lsL7pgZPngrnlh7tcbiAgICAgICAgdGhpcy5sYXlvdXRXZWlEYW8ubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdGhpcy5fY2xpY2tXZWlEYW9MYXlvdXQoZXZlbnQpO1xuICAgICAgICAgICAgLyojIyMjI2JlZ2luKi9cbiAgICAgICAgICAgIC8v5bC+6YGT5b+F6aG75aGr5ruh5omN5p2l5omn6KGMXG4gICAgICAgICAgICBpZihsYXlvdXRXZWlEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gNSl7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzliankuIvnmoTniYzlsI/kuo7nrYnkuo415bygXG4gICAgICAgICAgICAgICAgaWYodGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLmxlbmd0aCA8PSA1KXtcbiAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzkuK3pgZPloavmu6HvvIzmiorlroPmlL7lhaXlpLTpgZNcbiAgICAgICAgICAgICAgICAgICAgaWYobGF5b3V0VG91RGFvLm5vZGUuY2hpbGRyZW4ubGVuZ3RoIDwgMyAmJiBsYXlvdXRaaG9uZ0Rhby5ub2RlLmNoaWxkcmVuLmxlbmd0aCA9PSA1KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOeqgeWHuuiuoeeul+WHuuadpeeahOeJjOaVsOe7hFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NoYW5nZUNhcmRQcmVmYWJzWShjYXJkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkRGFvQ2FyZFRvTGF5b3V0KGxheW91dFRvdURhby5ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL+WmguaenOWktOmBk+Whq+a7oe+8jOaKiuWug+aUvuWFpeS4remBk1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGxheW91dFpob25nRGFvLm5vZGUuY2hpbGRyZW4ubGVuZ3RoIDwgNSAmJiBsYXlvdXRUb3VEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NoYW5nZUNhcmRQcmVmYWJzWShjYXJkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkRGFvQ2FyZFRvTGF5b3V0KGxheW91dFpob25nRGFvLm5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiMjIyMjZW5kKi9cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgX2NsaWNrVG91RGFvTGF5b3V0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgbGV0IGNsaWNrQ2FyZCA9IHRoaXMuX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQodGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgZXZlbnQpO1xuICAgICAgICBpZiAoY2xpY2tDYXJkKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkKGNsaWNrQ2FyZCwgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYWRkRGFvQ2FyZFRvTGF5b3V0KHRoaXMubGF5b3V0VG91RGFvLm5vZGUsIDMpO1xuICAgIH0sXG5cbiAgICBfY2xpY2taaG9uZ0Rhb0xheW91dDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGxldCBjbGlja0NhcmQgPSB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZSwgZXZlbnQpO1xuICAgICAgICBpZiAoY2xpY2tDYXJkKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkKGNsaWNrQ2FyZCwgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9hZGREYW9DYXJkVG9MYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgX2NsaWNrV2VpRGFvTGF5b3V0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgbGV0IGNsaWNrQ2FyZCA9IHRoaXMuX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQodGhpcy5sYXlvdXRXZWlEYW8ubm9kZSwgZXZlbnQpO1xuICAgICAgICBpZiAoY2xpY2tDYXJkKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkKGNsaWNrQ2FyZCwgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYWRkRGFvQ2FyZFRvTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBfZGFvQ2FyZE5vZGVJbkxheW91dFdpdGhFdmVudDogZnVuY3Rpb24gKG5vZGUsIGV2ZW50KSB7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSBub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICB2YXIgbG9jYXRpb24gPSBldmVudC5nZXRMb2NhdGlvbigpO1xuICAgICAgICBsb2NhdGlvbiA9IG5vZGUuY29udmVydFRvTm9kZVNwYWNlQVIobG9jYXRpb24pO1xuICAgICAgICBmb3IgKGxldCBpbmRleCBpbiBjYXJkTm9kZXMpIHtcbiAgICAgICAgICAgIGxldCBjYXJkTm9kZSA9IGNhcmROb2Rlc1tpbmRleF07XG4gICAgICAgICAgICBsZXQgcmVjdCA9IGNhcmROb2RlLmdldEJvdW5kaW5nQm94KCk7XG4gICAgICAgICAgICBpZiAoY2MucmVjdENvbnRhaW5zUG9pbnQocmVjdCwgbG9jYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmROb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9hZGREYW9DYXJkVG9MYXlvdXQ6IGZ1bmN0aW9uIChub2RlLCBtYXhOdW1iZXJDYXJkID0gNSkge1xuICAgICAgICBsZXQgY2FyZE5vZGVzID0gbm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgaWYgKGNhcmROb2Rlcy5sZW5ndGggPj0gNSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHJlbWFpbkNvdW50ID0gbWF4TnVtYmVyQ2FyZCAtIGNhcmROb2Rlcy5sZW5ndGg7XG4gICAgICAgIHZhciBzZWxlY3RlZENhcmRzID0gdGhpcy5fc2VsZWN0ZWRDYXJkUHJlZmFicyh0cnVlKSB8fCBbXTtcbiAgICAgICAgaWYgKHNlbGVjdGVkQ2FyZHMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZWxlY3RlZENhcmRzLmxlbmd0aCA+IHJlbWFpbkNvdW50KSB7XG4gICAgICAgICAgICBzZWxlY3RlZENhcmRzID0gc2VsZWN0ZWRDYXJkcy5zbGljZSgwLCByZW1haW5Db3VudCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc2VsZWN0ZWRDYXJkTmFtZXMgPSBzZWxlY3RlZENhcmRzLm1hcChmdW5jdGlvbiAoY2FyZFByZWZhYikge1xuICAgICAgICAgICAgcmV0dXJuIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuY2FyZE5hbWUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmRUeXBlTm9kZSkge1xuICAgICAgICAgICAgc2VsZWN0ZWRDYXJkTmFtZXMucHVzaChjYXJkVHlwZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLmNhcmROYW1lKCkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgY2FyZE1vZGVzID0gc2VsZWN0ZWRDYXJkTmFtZXMubWFwKGZ1bmN0aW9uIChjYXJkTmFtZSxpbmRleCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBLUUNhcmQoY2FyZE5hbWUsbnVsbCxpbmRleCk7XG4gICAgICAgIH0pLnNvcnQoZnVuY3Rpb24gKGMxLCBjMikge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5zb3J0KGMxLCBjMiwgZmFsc2UpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgdG91Q2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRUb3VEYW8ubm9kZSkgPyBjYXJkTW9kZXMgOiB0aGlzLl90YW9EYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgbGV0IHpob25nQ2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKSA/IGNhcmRNb2RlcyA6IHRoaXMuX3pob25nRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIGxldCB3ZWlDYXJkTW9kZXMgPSAobm9kZSA9PSB0aGlzLmxheW91dFdlaURhby5ub2RlKSA/IGNhcmRNb2RlcyA6IHRoaXMuX3dlaURhb0NhcmRNb2RlcygpO1xuICAgICAgICBpZiAoIXRoaXMuX2lzVmFsaWRDYXJkTW9kZXModG91Q2FyZE1vZGVzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIGNhcmRNb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTW9kZSkge1xuICAgICAgICAgICAgbGV0IGNhcmROYW1lID0gY2FyZE1vZGUuY2FyZE5hbWUoKTtcbiAgICAgICAgICAgIGxldCBjYXJkVHlwZVNwcml0ZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2FyZFR5cGVQcmVmYWIpO1xuICAgICAgICAgICAgaWYoY2MubWFQYWkpe1xuICAgICAgICAgICAgICAgIHZhciBjYXJkTWFQYWkgPSAnM18nICsgY2MubWFQYWk7XG4gICAgICAgICAgICAgICAgaWYoY2FyZE5hbWUgPT0gY2FyZE1hUGFpKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjI2LCAxNDUsIDE0NSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLnNldENhcmQoY2FyZE5hbWUpO1xuICAgICAgICAgICAgbm9kZS5hZGRDaGlsZChjYXJkVHlwZVNwcml0ZSk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgc2VsZWN0ZWRDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICBub2RlLnJlbW92ZUZyb21QYXJlbnQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuXG4gICAgICAgIHRoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b25zKCk7XG5cbiAgICAgICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICB0aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuXG4gICAgfSxcblxuICAgIC8vIOWIoOmZpCDlpLTjgIHkuK3miJblsL7pgZPkuK3nmoTmn5DkuK3niYxcbiAgICBfZGVsZXRlRGFvQ2FyZDogZnVuY3Rpb24gKGNhcmRUeXBlTm9kZSwgcmVsb2FkVHlwZUJ1dHRvbkVuYWJsZXMgPSBmYWxzZSkge1xuICAgICAgICBsZXQgY2FyZE5hbWUgPSBjYXJkVHlwZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLmNhcmROYW1lKCk7XG4gICAgICAgIHRoaXMuYWRkQ2FyZChjYXJkTmFtZSwgdHJ1ZSk7XG5cbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuXG4gICAgICAgIGNhcmRUeXBlTm9kZS5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xuICAgICAgICB0aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9ucygpO1xuXG4gICAgICAgIGlmIChyZWxvYWRUeXBlQnV0dG9uRW5hYmxlcykge1xuICAgICAgICAgICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHMoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDliKDpmaQg5aS06YGT5oiW5Lit6YGT5oiW5bC+6YGT5LiK5omA5pyJ55qEIOeJjFxuICAgIF9kZWxldGVEYW9DYXJkc09mTGF5b3V0OiBmdW5jdGlvbiAoZGFvTGF5b3V0KSB7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSBBcnJheS5mcm9tKGRhb0xheW91dC5jaGlsZHJlbik7XG4gICAgICAgIGNhcmROb2Rlcy5mb3JFYWNoKHRoaXMuX2RlbGV0ZURhb0NhcmQuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICB0aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuICAgIH0sXG5cbiAgICAvLyDliKTmlq3og73lkKbkvb/nlKjpgInmi6nkuK3nmoTniYxcbiAgICAvLyDljbPvvJrlpLTpgZPopoHlsI/kuo7kuK3pgZPjgIHkuK3pgZPopoHlsI/kuo7lsL7pgZNcbiAgICBfaXNWYWxpZENhcmRNb2RlczogZnVuY3Rpb24gKHRvdUNhcmRNb2RlcywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlcykge1xuICAgICAgICB0b3VDYXJkTW9kZXMgPSB0b3VDYXJkTW9kZXMgfHwgW107XG4gICAgICAgIHpob25nQ2FyZE1vZGVzID0gemhvbmdDYXJkTW9kZXMgfHwgW107XG4gICAgICAgIHdlaUNhcmRNb2RlcyA9IHdlaUNhcmRNb2RlcyB8fCBbXTtcbiAgICAgICAgY2MubG9nKHRvdUNhcmRNb2Rlcy5sZW5ndGgsIHpob25nQ2FyZE1vZGVzLmxlbmd0aCwgd2VpQ2FyZE1vZGVzLmxlbmd0aCk7XG4gICAgICAgIGlmICh0b3VDYXJkTW9kZXMubGVuZ3RoIDwgMyB8fCB6aG9uZ0NhcmRNb2Rlcy5sZW5ndGggPCA1IHx8IHdlaUNhcmRNb2Rlcy5sZW5ndGggPCA1KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHModG91Q2FyZE1vZGVzKTtcbiAgICAgICAgbGV0IHpob25nU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHpob25nQ2FyZE1vZGVzKTtcbiAgICAgICAgbGV0IHdlaVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyh3ZWlDYXJkTW9kZXMpO1xuICAgICAgICBjYy5sb2coXCLniYzliIbmlbDvvJpcIiwgdG91U2NvcmUsIHpob25nU2NvcmUsIHdlaVNjb3JlKTtcbiAgICAgICAgcmV0dXJuICh0b3VTY29yZSA8IHpob25nU2NvcmUpICYmICh6aG9uZ1Njb3JlIDw9IHdlaVNjb3JlKTtcbiAgICB9LFxuXG4gICAgLy8g5aS06YGT5LiK5bey5pyJ55qE54mMXG4gICAgX3Rhb0Rhb0NhcmRNb2RlczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZE1vZGVzT2ZDYXJkUHJlZmFicyh0aGlzLmxheW91dFRvdURhby5ub2RlLmNoaWxkcmVuKTtcbiAgICB9LFxuXG4gICAgLy8g5Lit6YGT5LiK5bey5pyJ55qE54mMXG4gICAgX3pob25nRGFvQ2FyZE1vZGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZS5jaGlsZHJlbik7XG4gICAgfSxcblxuICAgIC8vIOWwvumBk+S4iuW3suacieeahOeJjFxuICAgIF93ZWlEYW9DYXJkTW9kZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnModGhpcy5sYXlvdXRXZWlEYW8ubm9kZS5jaGlsZHJlbik7XG4gICAgfSxcblxuICAgIF9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzOiBmdW5jdGlvbiAoY2FyZFR5cGVOb2Rlcykge1xuICAgICAgICBpZiAoIWNhcmRUeXBlTm9kZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjYXJkTW9kZXMgPSBjYXJkVHlwZU5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgbGV0IGNvbXBvbmVudCA9IG5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5jYXJkTW9kZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY2FyZE1vZGVzIHx8IFtdO1xuICAgIH0sXG5cbiAgICAvLyDoh6rliqjorr7nva4g5aS044CB5Lit44CB5bC+6YGT55qE5Yig6Zmk5oyJ6ZKu55qE5Y+v6KeB5oCnXG4gICAgX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b24odGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgdGhpcy5idG5EZWxldGVUb3VEYW8ubm9kZSk7XG4gICAgICAgIHRoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b24odGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLCB0aGlzLmJ0bkRlbGV0ZVpob25nRGFvLm5vZGUpO1xuICAgICAgICB0aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9uKHRoaXMubGF5b3V0V2VpRGFvLm5vZGUsIHRoaXMuYnRuRGVsZXRlV2VpRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBfYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbjogZnVuY3Rpb24gKGxheW91dCwgYnV0dG9uKSB7XG4gICAgICAgIGJ1dHRvbi5hY3RpdmUgPSBsYXlvdXQuY2hpbGRyZW4ubGVuZ3RoID4gMDtcbiAgICB9LFxuXG4gICAgLy8g6Ieq5Yqo6K6+572uIOKAnOWFqOmDqOWPlua2iOKAneOAgeKAnOehruWumuWHuueJjOKAneOAgeKAnOexu+Wei+mAieaLqeKAneaMiemSrueahOWPr+ingeaAp1xuICAgIF9hdXRvQWN0aXZlVHlwZUJ1dHRvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgbGV0IGhhc0NhcmRVblNlbGVjdGVkID0gY2FyZE5vZGVzLmxlbmd0aCA+IDA7XG4gICAgICAgIHRoaXMuYnRuRG9uZS5ub2RlLmFjdGl2ZSA9ICFoYXNDYXJkVW5TZWxlY3RlZDtcbiAgICAgICAgdGhpcy5idG5DYW5jZWxBbGwubm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkRvbmUubm9kZS5hY3RpdmU7XG4gICAgICAgIHRoaXMudHlwZUJ1dHRvbnNOb2RlLmFjdGl2ZSA9IGhhc0NhcmRVblNlbGVjdGVkO1xuICAgIH0sXG5cbn0pO1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgX2NhcmROYW1lOiBudWxsLFxuICAgICAgX2NhcmRNb2RlbDogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0Q2FyZDogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICB0aGlzLl9jYXJkTmFtZSA9IGNhcmROYW1lO1xuICAgICAgdGhpcy5fY2FyZE1vZGVsID0gbmV3IEtRQ2FyZChjYXJkTmFtZSk7XG4gICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJykuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNhcmROYW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2FyZE5hbWU7XG4gICAgfSxcblxuICAgIGNhcmRNb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2FyZE1vZGVsO1xuICAgIH0sXG5cbiAgICBfY2FyZEZ1bGxOYW1lOiBmdW5jdGlvbiAoY2FyZFNob3J0TmFtZSkge1xuICAgICAgdmFyIGNhcmROYW1lID0gY2FyZFNob3J0TmFtZTtcbiAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xuICAgICAgICBjYXJkTmFtZSA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjYXJkTmFtZTtcbiAgICB9LFxuXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcbiAgICAgIGNjLmFzc2VydChjYWxsYmFjayk7XG5cbiAgICAgIGNjLmxvYWRlci5sb2FkUmVzKFwiaW1hZ2VzL3Bva2VyTGlzdC9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGNjLmVycm9yKGVycik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xuICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShjYXJkTmFtZSk7XG4gICAgICAgIGNhbGxiYWNrKGZyYW1lKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcbn0pO1xuIiwiLy8g55So5LqO5Zyo5ri45oiP6L+H56iL5Lit77yM5bGV56S655So5oi355qE6IGK5aSp5raI5oGvXG5cbmxldCBDaGF0TWVzc2FnZSA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICByaWNoVGV4dDogY2MuUmljaFRleHQsXG4gICAgICBzcHJpdGVCYWNrZ3JvdW5kOiBjYy5TcHJpdGUsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFN0cmluZzogZnVuY3Rpb24gKHN0cmluZyA9IFwiXCIsIGF1dG9IaWRlID0gdHJ1ZSkge1xuICAgICAgaWYgKHN0cmluZy5sZW5ndGggPT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICBsZXQgbWF4V2lkdGggPSAzMDA7XG4gICAgICBsZXQgcmVhbFN0ciA9IENoYXRNZXNzYWdlLnBhcnNlU3RyaW5nKHN0cmluZyk7XG5cbiAgICAgIC8vIOeUseS6jiBjYy5SaWNoVGV4dCDlnKjmjIflrpogbWF4V2lkdGgg5ZCO77yM6K+l57uT54K555qEIHdpZHRoIOS8muS4gOebtFxuICAgICAgLy8g5pivIG1heFdpZHRoIOWAvOOAguiAjOWcqOWwhiBtYXhXaWR0aCDmjIflrprkuLow5pe277yM5YW2IGNvbnRlbnRTaXplLndpZHRoIOS8mlxuICAgICAgLy8g5piv5YaF5a6555qE55yf5q2j5omA6ZyA55qE5a695bqmXG4gICAgICAvL1xuICAgICAgLy8g5omA5Lul6L+Z6YeM5YWI5bCGIG1heFdpZHRoIOiuvuS4uiAw77yM6I635Y+W5YW25a6e6ZmF5YaF5a65IHdpZHRoIOWQjuWGjeiwg+aVtFxuICAgICAgdGhpcy5yaWNoVGV4dC5tYXhXaWR0aCA9IDA7XG4gICAgICB0aGlzLnJpY2hUZXh0LnN0cmluZyA9IHJlYWxTdHI7XG5cbiAgICAgIGxldCBjb250ZW50V2lkdGggPSB0aGlzLnJpY2hUZXh0Lm5vZGUuZ2V0Q29udGVudFNpemUoKS53aWR0aDtcbiAgICAgIGlmIChjb250ZW50V2lkdGggPiBtYXhXaWR0aCkge1xuICAgICAgICB0aGlzLnJpY2hUZXh0Lm1heFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICAgIHRoaXMucmljaFRleHQuc3RyaW5nID0gcmVhbFN0cjtcbiAgICAgICAgY29udGVudFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubm9kZS53aWR0aCA9IGNvbnRlbnRXaWR0aCArIDI4O1xuICAgICAgdGhpcy5ub2RlLmhlaWdodCA9IHRoaXMucmljaFRleHQubm9kZS5nZXRDb250ZW50U2l6ZSgpLmhlaWdodCArIDIwO1xuXG4gICAgICB0aGlzLnNwcml0ZUJhY2tncm91bmQubm9kZS53aWR0aCA9IHRoaXMubm9kZS53aWR0aDtcbiAgICAgIHRoaXMuc3ByaXRlQmFja2dyb3VuZC5ub2RlLmhlaWdodCA9IHRoaXMubm9kZS5oZWlnaHQ7XG5cbiAgICAgIGlmIChhdXRvSGlkZSkge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5faGlkZU5vZGUuYmluZCh0aGlzKSwgMyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIF9oaWRlTm9kZTogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbn0pO1xuXG4vLyDlsIYgPGJxMTA+IOaUueS4uu+8miA8aW1nIHNyYz0nYmcxMCcvPlxuQ2hhdE1lc3NhZ2UucGFyc2VTdHJpbmcgPSBmdW5jdGlvbiAoc3RyKSB7XG4gIGxldCByZXN1bHQgPSBzdHIucmVwbGFjZSgvPGJxXFxkezEsMn0+L2csIGZ1bmN0aW9uKG1hdGNoKXtcbiAgICB2YXIgYnEgPSBtYXRjaC5yZXBsYWNlKFwiPFwiLCBcIiA8aW1nIHNyYz0nXCIpLnJlcGxhY2UoXCI+XCIsIFwiJy8+IFwiKTtcbiAgICByZXR1cm4gYnE7XG4gIH0pO1xuXG4gIHJldHVybiByZXN1bHQ7XG59LFxuXG5tb2R1bGUuZXhwb3J0cyA9IENoYXRNZXNzYWdlO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0U3RyaW5nOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICB0aGlzLl9yaWNoVGV4dCgpLnN0cmluZyA9IHN0cjtcbiAgICB9LFxuXG4gICAgX3JpY2hUZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuUmljaFRleHQnKTtcbiAgICB9LFxuXG5cbn0pO1xuIiwiY29uc3QgS1FDYXJkUmVzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUmVzSGVscGVyJyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0b3VMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgemhvbmdMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgd2VpTGF5b3V0OiBjYy5MYXlvdXQsXG4gICAgICAgIGxhYmVsVG91U2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFRvdVNjb3JlUmlnaHQ6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFpob25nU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFpob25nU2NvcmVSaWdodDogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsV2VpU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFdlaVNjb3JlUmlnaHQ6IGNjLkxhYmVsLFxuXG4gICAgICAgIHRvdVNjcm9lVGl0bGU6IGNjLk5vZGUsICAvL+WktOmBk+Wtl1xuICAgICAgICB6aG9uZ1Njcm9lVGl0bGU6IGNjLk5vZGUsIC8v5Lit6YGT5a2XXG4gICAgICAgIHdlaVNjcm9lVGl0bGU6IGNjLk5vZGUsICAvL+WwvumBk+Wtl1xuXG4gICAgICAgIHNjb3JlU3R5bGU6IDAsICAvLyAwIOihqOekuuWIhuaVsOWcqOW3pui+uSAgMSDooajnpLrliIbmlbDlnKjlj7PovrkgMuS4jeaYvuekuuWIhuaVsFxuICAgICAgICBfZGFvTGF5b3V0czogbnVsbCwgLy8g5aS044CB5Lit44CB5bC+6ZuG5ZCIXG4gICAgICAgIF9sYWJlbFNjb3JlczogbnVsbCxcbiAgICAgICAgX3Njb3JlczogbnVsbCxcblxuXG4gICAgICAgIHRlU2h1TGF5b3V0OiBjYy5MYXlvdXQsXG4gICAgICAgIGxhYmVsVGVTaHVQYWlUaXRsZTogY2MuTGFiZWwsXG4gICAgICAgIHBOdW06MCwvL+eOqeWutuS6uuaVsFxuICAgICAgICB0ZVNodVRpbWU6MCwvL+eJueauiueJjOWHuueJjOmhuuW6j1xuICAgICAgICB0ZVNodU51bTowLC8v54m55q6K54mM5Lq65pWwXG4gICAgICAgIC8vIFt7XG4gICAgICAgIC8vICAgICAnY2FyZHMnOlt7J3N1aXQnOnN1aXQsJ251bWJlcic6bnVtYmVyfSx7fV0sLy/nibnmrorniYzkuI3nlKjkvKBcbiAgICAgICAgLy8gICAgICd0eXBlJzowLFxuICAgICAgICAvLyAgICAgJ3ZhbHVlJzo0LFxuICAgICAgICAvLyAgICAgJ2lzQ29udGFpbkV4dHJhJzp0cnVlLC8vaXMgU3BlY2lhbCDnibnmrorniYzkvKBcbiAgICAgICAgLy8gICAgfSxcbiAgICAgICAgLy8gICAge1xuICAgICAgICAvLyAgICAgJ2NhcmRzJzpbeydzdWl0JzpzdWl0LCdudW1iZXInOm51bWJlcn0se31dLFxuICAgICAgICAvLyAgICAgJ3R5cGUnOjAsXG4gICAgICAgIC8vICAgICAndmFsdWUnOjRcbiAgICAgICAgLy8gICB9XVxuICAgICAgICBfdXNlcjogbnVsbCwgICAgICAgLy8g55So5LqO5q+U54mM55qE5pWw5o2uXG4gICAgICAgIF9jYXJkc0luZm86IG51bGwsXG4gICAgICAgIF9jb21wYXJlSW5kZXg6IDAsICAvLyDlsIbopoHmr5TovoPnmoQg57Si5byVICAwfjJcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2Rhb0xheW91dHMgPSBbdGhpcy50b3VMYXlvdXQsIHRoaXMuemhvbmdMYXlvdXQsIHRoaXMud2VpTGF5b3V0XTtcbiAgICAgICAgdGhpcy5fbGFiZWxTY29yZXMgPSBbW3RoaXMubGFiZWxUb3VTY29yZSwgdGhpcy5sYWJlbFRvdVNjb3JlUmlnaHRdLCBbdGhpcy5sYWJlbFpob25nU2NvcmUsIHRoaXMubGFiZWxaaG9uZ1Njb3JlUmlnaHRdLCBbdGhpcy5sYWJlbFdlaVNjb3JlLHRoaXMubGFiZWxXZWlTY29yZVJpZ2h0XV07XG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICBpZiAodGhpcy5fc2NvcmVzKSB7XG4gICAgICAgICAgICB0aGlzLnNldFNjb3Jlcyh0aGlzLl9zY29yZXMpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NvbXBhcmVJbmRleCA9IDA7XG4gICAgICAgIHRoaXMudGVTaHVMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gJyc7XG4gICAgICAgIHRoaXMubm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICBub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX3NldENhcmRzVG9MYXlvdXQ6IGZ1bmN0aW9uIChsYXlvdXQsIGNhcmRzKSB7XG4gICAgICAgIGxldCBub2RlID0gbGF5b3V0Lm5vZGU7XG4gICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoc3ByaXRlTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGxldCBzcHJpdGUgPSBzcHJpdGVOb2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG4gICAgICAgICAgICBsZXQgY2FyZCA9IGNhcmRzW2luZGV4XTtcbiAgICAgICAgICAgIGlmICghY2FyZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEtRQ2FyZFJlc0hlbHBlci5zZXRDYXJkU3ByaXRlRnJhbWUoc3ByaXRlLCBjYXJkLmNhcmROYW1lKCkpO1xuICAgICAgICAgICAgc3ByaXRlTm9kZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcbiAgICAgICAgICAgIGlmKGNjLm1hUGFpKXtcbiAgICAgICAgICAgICAgICB2YXIgY2FyZE1hUGFpID0gJzNfJyArIGNjLm1hUGFpO1xuICAgICAgICAgICAgICAgIGlmKGNhcmQuY2FyZE5hbWUoKSA9PSBjYXJkTWFQYWkpe1xuICAgICAgICAgICAgICAgICAgICBzcHJpdGVOb2RlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDIyNiwgMTQ1LCAxNDUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHNldENvbXBhcmVEYXRhOiBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICB0aGlzLl91c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy5fY2FyZHNJbmZvID0gdXNlci5jYXJkSW5mbztcbiAgICAgICAgbGV0IGNhcmRzSW5mbyA9IHVzZXIuY2FyZEluZm87XG4gICAgICAgIGxldCBjYXJkcyA9IGNhcmRzSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0uY2FyZHMpO1xuICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XG4gICAgICAgIH0sIFtdKTtcblxuXG4gICAgICAgIC8v54m55q6K54mMXG4gICAgICAgIHRoaXMudGVTaHVMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gJyc7XG4gICAgICAgIHRoaXMucE51bSA9IHVzZXIucGxheWVyTnVtOy8v546p5a625Lq65pWwXG4gICAgICAgIHRoaXMudGVTaHVUaW1lID0gdXNlci50ZVNodVRpbWU7Ly/nibnmrorniYzlh7rniYzpobrluo/kurrmlbBcbiAgICAgICAgdGhpcy50ZVNodU51bSA9IHVzZXIuVGVTaHVOdW07Ly/nibnmrorniYzkurrmlbBcbiAgICAgICAgbGV0IHNjb3JlcyA9IFt1c2VyLnNjb3JlMSB8fCAwLCB1c2VyLnNjb3JlMiB8fCAwLCB1c2VyLnNjb3JlMyB8fCAwXTtcbiAgICAgICAgdGhpcy5zZXRDYXJkcyhjYXJkcyk7XG4gICAgICAgIHRoaXMuc2V0U2NvcmVzKHNjb3Jlcyk7XG5cbiAgICB9LFxuXG4gICAgLy8g5LiL5LiA5Liq6KaB5q+U6L6D55qE5YiG5pWwXG4gICAgLy8g5aaC5p6c5rKh5pyJ6KaB5q+U6L6D55qE5LqG77yM5YiZ6L+U5ZueIDBcbiAgICBuZXh0Q29tcGFyZVNjb3JlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLl91c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF07XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGF0YS52YWx1ZTtcbiAgICB9LFxuXG4gICAgc2V0VGVTaHVDYXJkczogZnVuY3Rpb24gKGNhcmRzLGNhcmRzTmFtZXMpIHtcbiAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAgICAgICAgICAgIGlmKGNhcmQucG9pbnQgPT0gMTQpe1xuICAgICAgICAgICAgICAgIGNhcmQucG9pbnQgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICB2YXIgdGltZSA9ICgodGhpcy5wTnVtKSAtICh0aGlzLnRlU2h1TnVtKSkgKiAzICsgKHRoaXMudGVTaHVUaW1lKTsvLzMg5pivM+mBk+eJjOeahOaXtumXtFxuICAgICAgICBsZXQgdHlwZU5hbWUgPSBLUUNhcmQuY2FyZHNUeXBlTmFtZShjYXJkc05hbWVzKTtcbiAgICAgICAgaWYodHlwZU5hbWUgPT0gXCLkuInlkIzoirFcIiApe1xuICAgICAgICAgICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnRlU2h1TGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy50ZVNodUxheW91dCwgY2FyZHMpO1xuICAgICAgICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gdHlwZU5hbWU7XG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0aGlzLl9jYXJkc0luZm9bMF0udHlwZSk7XG4gICAgICAgIH0sdGltZSk7XG5cbiAgICB9LFxuICAgIF9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lczogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICAgIC8vIFt7XCJzdWl0XCI6XCJzXCIsXCJudW1iZXJcIjoxMH1dXG4gICAgICAgIGxldCBzdWl0Q29sb3JNYXAgPVsnJywnZCcsJ2MnLCdoJywncyddO1xuICAgICAgICByZXR1cm4gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICB2YXIgY2FyZE51bWJlciA9IGNhcmQucG9pbnQ7XG4gICAgICAgICAgICBsZXQgY29sb3IgPSBzdWl0Q29sb3JNYXBbY2FyZC5jb2xvcl07XG4gICAgICAgICAgICBsZXQgbnVtYmVyID0gTWF0aC5tYXgoTWF0aC5taW4oY2FyZE51bWJlciwgMTMpLCAxKTtcbiAgICAgICAgICAgIHJldHVybiB7bnVtYmVyOm51bWJlcixzdWl0OmNvbG9yfTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBzZXRDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG5cbiAgICAgICAgLy8g5LiN5Lya5YaN5pyJ54m55q6K54mM5LqGXG4gICAgICAgIHRoaXMudGVTaHVMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhID09IHRydWUpe1xuICAgICAgICAgICAgdmFyIGNhcmRzTmFtZXMgPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgICAgICAgICBpZiAoS1FDYXJkLmlzVGVTaHVQYWkoY2FyZHNOYW1lcykgJiYgY2MubW9zaGkgIT0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVTaHVDYXJkcyhjYXJkcyxjYXJkc05hbWVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIGxldCBjYXJkU3ByaXRlcyA9IHRoaXMuX2FsbENhcmRTcHJpdGVzKCk7XG4gICAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGtxQ2FyZCwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA+PSBjYXJkU3ByaXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBjYXJkU3ByaXRlID0gY2FyZFNwcml0ZXNbaW5kZXhdO1xuXG4gICAgICAgICAgICBLUUNhcmRSZXNIZWxwZXIubG9hZENhcmRTcHJpdGVGcmFtZShrcUNhcmQuY2FyZE5hbWUoKSwgZnVuY3Rpb24gKHNwcml0ZUZyYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FyZFNwcml0ZS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgICAgICAgICAgICAgIGNhcmRTcHJpdGUubm9kZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcbiAgICAgICAgICAgICAgICBpZihjYy5tYVBhaSl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYXJkTWFQYWkgPSAncHVibGljLXBpYy1jYXJkLXBva2VyLTNfJyArIGNjLm1hUGFpO1xuICAgICAgICAgICAgICAgICAgICBpZihzcHJpdGVGcmFtZS5uYW1lID09IGNhcmRNYVBhaSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkU3ByaXRlLm5vZGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjI2LCAxNDUsIDE0NSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBzZXRTY29yZXM6IGZ1bmN0aW9uIChzY29yZXMpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xhYmVsU2NvcmVzID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX3Njb3JlcyA9IHNjb3JlcztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBzY29yZVN0cmluZ3MgPSBzY29yZXMubWFwIChmdW5jdGlvbiAoc2NvcmUpIHtcbiAgICAgICAgICAgIHNjb3JlID0gTnVtYmVyKHNjb3JlKTtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSAoc2NvcmUgPiAwKSA/IChcIisgXCIgKyBzY29yZSkgOiAoXCItIFwiICsgc2NvcmUgKiAtMSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcblxuICAgICAgICBzY29yZVN0cmluZ3MuZm9yRWFjaChmdW5jdGlvbiAoc3RyaW5nLCBpbmRleCkge1xuICAgICAgICAgICAgbGV0IGxhYmVscyA9IHRoaXMuX2xhYmVsU2NvcmVzW2luZGV4XTtcbiAgICAgICAgICAgIGxhYmVscy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICAgICAgICAgIGxhYmVsLnN0cmluZyA9IHN0cmluZztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBzaG93VG91Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYT09dHJ1ZSl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50b3VMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5zY29yZVN0eWxlID09IDEpIHtcbiAgICAgICAgICAgIHRoaXMubGFiZWxUb3VTY29yZVJpZ2h0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnNjb3JlU3R5bGUgPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5sYWJlbFRvdVNjb3JlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRvdVNjcm9lVGl0bGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvdVNjcm9lVGl0bGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdHlwZXMgPSB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlID09IDMgPyAzMzM6dGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZTtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlDYXJkVHlwZSh0aGlzLl91c2VyLnNleCwgdHlwZXMpO1xuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggKz0gMTtcblxuICAgIH0sXG5cbiAgICBzaG93WmhvbmdDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhPT10cnVlKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnpob25nTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuc2NvcmVTdHlsZSA9PSAxKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsWmhvbmdTY29yZVJpZ2h0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNjb3JlU3R5bGUgPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5sYWJlbFpob25nU2NvcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuemhvbmdTY3JvZVRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy56aG9uZ1Njcm9lVGl0bGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdHlwZXMgPSB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlID09IDYgPyA1NTU6dGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZTtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlDYXJkVHlwZSh0aGlzLl91c2VyLnNleCwgdHlwZXMpO1xuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggKz0gMTtcbiAgICB9LFxuXG4gICAgc2hvd1dlaUNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmE9PXRydWUpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuc2NvcmVTdHlsZSA9PSAxKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsV2VpU2NvcmVSaWdodC5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zY29yZVN0eWxlID09IDApIHtcbiAgICAgICAgICAgIHRoaXMubGFiZWxXZWlTY29yZS5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy53ZWlTY3JvZVRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53ZWlTY3JvZVRpdGxlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlKTtcbiAgICAgICAgdGhpcy5fY29tcGFyZUluZGV4ICs9IDE7XG4gICAgfSxcblxuICAgIHNob3dOZXh0Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0cyA9IFt0aGlzLnRvdUxheW91dCwgdGhpcy56aG9uZ0xheW91dCwgdGhpcy53ZWlMYXlvdXRdO1xuICAgICAgICBsZXQgbGF5b3V0ID0gdGhpcy5fZGFvTGF5b3V0cy5maW5kKGZ1bmN0aW9uIChsYXlvdXQpIHtcbiAgICAgICAgICAgIHJldHVybiAhbGF5b3V0Lm5vZGUuYWN0aXZlO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAobGF5b3V0ID09IHRoaXMudG91TGF5b3V0KSB7XG4gICAgICAgICAgICB0aGlzLnNob3dUb3VDYXJkcygpO1xuICAgICAgICB9IGVsc2UgaWYgKGxheW91dCA9PSB0aGlzLnpob25nTGF5b3V0KSB7XG4gICAgICAgICAgICB0aGlzLnNob3daaG9uZ0NhcmRzKCk7XG4gICAgICAgIH0gZWxzZSBpZiAobGF5b3V0ID09IHRoaXMud2VpTGF5b3V0KSB7XG4gICAgICAgICAgICB0aGlzLnNob3dXZWlDYXJkcygpO1xuICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgX2NsZWFyQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY2xlYXJMYXlvdXRDYXJkcyh0aGlzLnRvdUxheW91dCk7XG4gICAgICAgIHRoaXMuX2NsZWFyTGF5b3V0Q2FyZHModGhpcy56aG9uZ0xheW91dCk7XG4gICAgICAgIHRoaXMuX2NsZWFyTGF5b3V0Q2FyZHModGhpcy53ZWlMYXlvdXQpO1xuICAgIH0sXG5cbiAgICBfY2xlYXJMYXlvdXRDYXJkczogZnVuY3Rpb24gKGxheW91dCkge1xuICAgICAgICB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQobGF5b3V0KS5mb3JFYWNoKGZ1bmN0aW9uIChzcHJpdGUpIHtcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfY2FyZFNwcml0ZXNXaXRoTGF5b3V0OiBmdW5jdGlvbiAobGF5b3V0KSB7XG4gICAgICAgIGxldCBub2RlID0gbGF5b3V0Lm5vZGU7XG4gICAgICAgIHJldHVybiBub2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9hbGxDYXJkU3ByaXRlczogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgdG91Q2FyZFNwcml0ZXMgPSB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQodGhpcy50b3VMYXlvdXQpO1xuICAgICAgICBsZXQgemhvbmdDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLnpob25nTGF5b3V0KTtcbiAgICAgICAgbGV0IHdlaUNhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMud2VpTGF5b3V0KTtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHRvdUNhcmRTcHJpdGVzLmNvbmNhdCh6aG9uZ0NhcmRTcHJpdGVzKS5jb25jYXQod2VpQ2FyZFNwcml0ZXMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG5cbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGFiZWxUaW1lOiBjYy5MYWJlbCxcblxuICAgICAgICBfY2FsbGJhY2s6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBcIjBcIjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog5byA5aeL5YCS6K6h5pe2XG4gICAgICogXG4gICAgICogQHBhcmFtICB7TnVtYmVyfSB0aW1lIOaXtumVv1xuICAgICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYWxsYmFjayDlgJLorqHml7bnmoTlm57osINcbiAgICAgKi9cbiAgICBzdGFydENvdW50ZG93bjogZnVuY3Rpb24odGltZSwgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG5cbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IFwiXCIgKyB0aW1lO1xuICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuX2NvdW50RG93biwgMSwgdGltZSk7XG4gICAgfSxcblxuICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fY291bnREb3duKTtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIGlmICh0aGlzLl9jYWxsYmFjaykge1xuICAgICAgICAgICAgbGV0IGlzVGltZW91dCA9IE51bWJlcih0aGlzLmxhYmVsVGltZS5zdHJpbmcpIDw9IDA7XG4gICAgICAgICAgICBsZXQgY2FsbGJhY2sgPSB0aGlzLl9jYWxsYmFjaztcbiAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgICAgIGNhbGxiYWNrKGlzVGltZW91dCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IG51bGw7XG4gICAgfSxcblxuICAgIF9jb3VudERvd246IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdGltZSA9IE51bWJlcih0aGlzLmxhYmVsVGltZS5zdHJpbmcgfHwgXCIwXCIpO1xuICAgICAgICB0aW1lID0gdGltZSAtIDE7XG5cbiAgICAgICAgaWYgKHRpbWUgPD0gMCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBTdHJpbmcodGltZSk7XG4gICAgfSxcblxuXG59KTtcbiIsIid1c2Ugc3RyaWN0J1xuXG5leHBvcnRzLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoXG5leHBvcnRzLnRvQnl0ZUFycmF5ID0gdG9CeXRlQXJyYXlcbmV4cG9ydHMuZnJvbUJ5dGVBcnJheSA9IGZyb21CeXRlQXJyYXlcblxudmFyIGxvb2t1cCA9IFtdXG52YXIgcmV2TG9va3VwID0gW11cbnZhciBBcnIgPSB0eXBlb2YgVWludDhBcnJheSAhPT0gJ3VuZGVmaW5lZCcgPyBVaW50OEFycmF5IDogQXJyYXlcblxudmFyIGNvZGUgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLydcbmZvciAodmFyIGkgPSAwLCBsZW4gPSBjb2RlLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7XG4gIGxvb2t1cFtpXSA9IGNvZGVbaV1cbiAgcmV2TG9va3VwW2NvZGUuY2hhckNvZGVBdChpKV0gPSBpXG59XG5cbnJldkxvb2t1cFsnLScuY2hhckNvZGVBdCgwKV0gPSA2MlxucmV2TG9va3VwWydfJy5jaGFyQ29kZUF0KDApXSA9IDYzXG5cbmZ1bmN0aW9uIHBsYWNlSG9sZGVyc0NvdW50IChiNjQpIHtcbiAgdmFyIGxlbiA9IGI2NC5sZW5ndGhcbiAgaWYgKGxlbiAlIDQgPiAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0JylcbiAgfVxuXG4gIC8vIHRoZSBudW1iZXIgb2YgZXF1YWwgc2lnbnMgKHBsYWNlIGhvbGRlcnMpXG4gIC8vIGlmIHRoZXJlIGFyZSB0d28gcGxhY2Vob2xkZXJzLCB0aGFuIHRoZSB0d28gY2hhcmFjdGVycyBiZWZvcmUgaXRcbiAgLy8gcmVwcmVzZW50IG9uZSBieXRlXG4gIC8vIGlmIHRoZXJlIGlzIG9ubHkgb25lLCB0aGVuIHRoZSB0aHJlZSBjaGFyYWN0ZXJzIGJlZm9yZSBpdCByZXByZXNlbnQgMiBieXRlc1xuICAvLyB0aGlzIGlzIGp1c3QgYSBjaGVhcCBoYWNrIHRvIG5vdCBkbyBpbmRleE9mIHR3aWNlXG4gIHJldHVybiBiNjRbbGVuIC0gMl0gPT09ICc9JyA/IDIgOiBiNjRbbGVuIC0gMV0gPT09ICc9JyA/IDEgOiAwXG59XG5cbmZ1bmN0aW9uIGJ5dGVMZW5ndGggKGI2NCkge1xuICAvLyBiYXNlNjQgaXMgNC8zICsgdXAgdG8gdHdvIGNoYXJhY3RlcnMgb2YgdGhlIG9yaWdpbmFsIGRhdGFcbiAgcmV0dXJuIGI2NC5sZW5ndGggKiAzIC8gNCAtIHBsYWNlSG9sZGVyc0NvdW50KGI2NClcbn1cblxuZnVuY3Rpb24gdG9CeXRlQXJyYXkgKGI2NCkge1xuICB2YXIgaSwgaiwgbCwgdG1wLCBwbGFjZUhvbGRlcnMsIGFyclxuICB2YXIgbGVuID0gYjY0Lmxlbmd0aFxuICBwbGFjZUhvbGRlcnMgPSBwbGFjZUhvbGRlcnNDb3VudChiNjQpXG5cbiAgYXJyID0gbmV3IEFycihsZW4gKiAzIC8gNCAtIHBsYWNlSG9sZGVycylcblxuICAvLyBpZiB0aGVyZSBhcmUgcGxhY2Vob2xkZXJzLCBvbmx5IGdldCB1cCB0byB0aGUgbGFzdCBjb21wbGV0ZSA0IGNoYXJzXG4gIGwgPSBwbGFjZUhvbGRlcnMgPiAwID8gbGVuIC0gNCA6IGxlblxuXG4gIHZhciBMID0gMFxuXG4gIGZvciAoaSA9IDAsIGogPSAwOyBpIDwgbDsgaSArPSA0LCBqICs9IDMpIHtcbiAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxOCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPDwgMTIpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMildIDw8IDYpIHwgcmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAzKV1cbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gMTYpICYgMHhGRlxuICAgIGFycltMKytdID0gKHRtcCA+PiA4KSAmIDB4RkZcbiAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkZcbiAgfVxuXG4gIGlmIChwbGFjZUhvbGRlcnMgPT09IDIpIHtcbiAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA+PiA0KVxuICAgIGFycltMKytdID0gdG1wICYgMHhGRlxuICB9IGVsc2UgaWYgKHBsYWNlSG9sZGVycyA9PT0gMSkge1xuICAgIHRtcCA9IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSldIDw8IDEwKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDEpXSA8PCA0KSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA+PiAyKVxuICAgIGFycltMKytdID0gKHRtcCA+PiA4KSAmIDB4RkZcbiAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBhcnJcbn1cblxuZnVuY3Rpb24gdHJpcGxldFRvQmFzZTY0IChudW0pIHtcbiAgcmV0dXJuIGxvb2t1cFtudW0gPj4gMTggJiAweDNGXSArIGxvb2t1cFtudW0gPj4gMTIgJiAweDNGXSArIGxvb2t1cFtudW0gPj4gNiAmIDB4M0ZdICsgbG9va3VwW251bSAmIDB4M0ZdXG59XG5cbmZ1bmN0aW9uIGVuY29kZUNodW5rICh1aW50OCwgc3RhcnQsIGVuZCkge1xuICB2YXIgdG1wXG4gIHZhciBvdXRwdXQgPSBbXVxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkgKz0gMykge1xuICAgIHRtcCA9ICh1aW50OFtpXSA8PCAxNikgKyAodWludDhbaSArIDFdIDw8IDgpICsgKHVpbnQ4W2kgKyAyXSlcbiAgICBvdXRwdXQucHVzaCh0cmlwbGV0VG9CYXNlNjQodG1wKSlcbiAgfVxuICByZXR1cm4gb3V0cHV0LmpvaW4oJycpXG59XG5cbmZ1bmN0aW9uIGZyb21CeXRlQXJyYXkgKHVpbnQ4KSB7XG4gIHZhciB0bXBcbiAgdmFyIGxlbiA9IHVpbnQ4Lmxlbmd0aFxuICB2YXIgZXh0cmFCeXRlcyA9IGxlbiAlIDMgLy8gaWYgd2UgaGF2ZSAxIGJ5dGUgbGVmdCwgcGFkIDIgYnl0ZXNcbiAgdmFyIG91dHB1dCA9ICcnXG4gIHZhciBwYXJ0cyA9IFtdXG4gIHZhciBtYXhDaHVua0xlbmd0aCA9IDE2MzgzIC8vIG11c3QgYmUgbXVsdGlwbGUgb2YgM1xuXG4gIC8vIGdvIHRocm91Z2ggdGhlIGFycmF5IGV2ZXJ5IHRocmVlIGJ5dGVzLCB3ZSdsbCBkZWFsIHdpdGggdHJhaWxpbmcgc3R1ZmYgbGF0ZXJcbiAgZm9yICh2YXIgaSA9IDAsIGxlbjIgPSBsZW4gLSBleHRyYUJ5dGVzOyBpIDwgbGVuMjsgaSArPSBtYXhDaHVua0xlbmd0aCkge1xuICAgIHBhcnRzLnB1c2goZW5jb2RlQ2h1bmsodWludDgsIGksIChpICsgbWF4Q2h1bmtMZW5ndGgpID4gbGVuMiA/IGxlbjIgOiAoaSArIG1heENodW5rTGVuZ3RoKSkpXG4gIH1cblxuICAvLyBwYWQgdGhlIGVuZCB3aXRoIHplcm9zLCBidXQgbWFrZSBzdXJlIHRvIG5vdCBmb3JnZXQgdGhlIGV4dHJhIGJ5dGVzXG4gIGlmIChleHRyYUJ5dGVzID09PSAxKSB7XG4gICAgdG1wID0gdWludDhbbGVuIC0gMV1cbiAgICBvdXRwdXQgKz0gbG9va3VwW3RtcCA+PiAyXVxuICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA8PCA0KSAmIDB4M0ZdXG4gICAgb3V0cHV0ICs9ICc9PSdcbiAgfSBlbHNlIGlmIChleHRyYUJ5dGVzID09PSAyKSB7XG4gICAgdG1wID0gKHVpbnQ4W2xlbiAtIDJdIDw8IDgpICsgKHVpbnQ4W2xlbiAtIDFdKVxuICAgIG91dHB1dCArPSBsb29rdXBbdG1wID4+IDEwXVxuICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA+PiA0KSAmIDB4M0ZdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFsodG1wIDw8IDIpICYgMHgzRl1cbiAgICBvdXRwdXQgKz0gJz0nXG4gIH1cblxuICBwYXJ0cy5wdXNoKG91dHB1dClcblxuICByZXR1cm4gcGFydHMuam9pbignJylcbn1cbiIsIi8qIVxuICogVGhlIGJ1ZmZlciBtb2R1bGUgZnJvbSBub2RlLmpzLCBmb3IgdGhlIGJyb3dzZXIuXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGZlcm9zc0BmZXJvc3Mub3JnPiA8aHR0cDovL2Zlcm9zcy5vcmc+XG4gKiBAbGljZW5zZSAgTUlUXG4gKi9cbi8qIGVzbGludC1kaXNhYmxlIG5vLXByb3RvICovXG5cbid1c2Ugc3RyaWN0J1xuXG52YXIgYmFzZTY0ID0gcmVxdWlyZSgnYmFzZTY0LWpzJylcbnZhciBpZWVlNzU0ID0gcmVxdWlyZSgnaWVlZTc1NCcpXG52YXIgaXNBcnJheSA9IHJlcXVpcmUoJ2lzYXJyYXknKVxuXG5leHBvcnRzLkJ1ZmZlciA9IEJ1ZmZlclxuZXhwb3J0cy5TbG93QnVmZmVyID0gU2xvd0J1ZmZlclxuZXhwb3J0cy5JTlNQRUNUX01BWF9CWVRFUyA9IDUwXG5cbi8qKlxuICogSWYgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYDpcbiAqICAgPT09IHRydWUgICAgVXNlIFVpbnQ4QXJyYXkgaW1wbGVtZW50YXRpb24gKGZhc3Rlc3QpXG4gKiAgID09PSBmYWxzZSAgIFVzZSBPYmplY3QgaW1wbGVtZW50YXRpb24gKG1vc3QgY29tcGF0aWJsZSwgZXZlbiBJRTYpXG4gKlxuICogQnJvd3NlcnMgdGhhdCBzdXBwb3J0IHR5cGVkIGFycmF5cyBhcmUgSUUgMTArLCBGaXJlZm94IDQrLCBDaHJvbWUgNyssIFNhZmFyaSA1LjErLFxuICogT3BlcmEgMTEuNissIGlPUyA0LjIrLlxuICpcbiAqIER1ZSB0byB2YXJpb3VzIGJyb3dzZXIgYnVncywgc29tZXRpbWVzIHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24gd2lsbCBiZSB1c2VkIGV2ZW5cbiAqIHdoZW4gdGhlIGJyb3dzZXIgc3VwcG9ydHMgdHlwZWQgYXJyYXlzLlxuICpcbiAqIE5vdGU6XG4gKlxuICogICAtIEZpcmVmb3ggNC0yOSBsYWNrcyBzdXBwb3J0IGZvciBhZGRpbmcgbmV3IHByb3BlcnRpZXMgdG8gYFVpbnQ4QXJyYXlgIGluc3RhbmNlcyxcbiAqICAgICBTZWU6IGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY5NTQzOC5cbiAqXG4gKiAgIC0gQ2hyb21lIDktMTAgaXMgbWlzc2luZyB0aGUgYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbi5cbiAqXG4gKiAgIC0gSUUxMCBoYXMgYSBicm9rZW4gYFR5cGVkQXJyYXkucHJvdG90eXBlLnN1YmFycmF5YCBmdW5jdGlvbiB3aGljaCByZXR1cm5zIGFycmF5cyBvZlxuICogICAgIGluY29ycmVjdCBsZW5ndGggaW4gc29tZSBzaXR1YXRpb25zLlxuXG4gKiBXZSBkZXRlY3QgdGhlc2UgYnVnZ3kgYnJvd3NlcnMgYW5kIHNldCBgQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlRgIHRvIGBmYWxzZWAgc28gdGhleVxuICogZ2V0IHRoZSBPYmplY3QgaW1wbGVtZW50YXRpb24sIHdoaWNoIGlzIHNsb3dlciBidXQgYmVoYXZlcyBjb3JyZWN0bHkuXG4gKi9cbkJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUID0gZ2xvYmFsLlRZUEVEX0FSUkFZX1NVUFBPUlQgIT09IHVuZGVmaW5lZFxuICA/IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUXG4gIDogdHlwZWRBcnJheVN1cHBvcnQoKVxuXG4vKlxuICogRXhwb3J0IGtNYXhMZW5ndGggYWZ0ZXIgdHlwZWQgYXJyYXkgc3VwcG9ydCBpcyBkZXRlcm1pbmVkLlxuICovXG5leHBvcnRzLmtNYXhMZW5ndGggPSBrTWF4TGVuZ3RoKClcblxuZnVuY3Rpb24gdHlwZWRBcnJheVN1cHBvcnQgKCkge1xuICB0cnkge1xuICAgIHZhciBhcnIgPSBuZXcgVWludDhBcnJheSgxKVxuICAgIGFyci5fX3Byb3RvX18gPSB7X19wcm90b19fOiBVaW50OEFycmF5LnByb3RvdHlwZSwgZm9vOiBmdW5jdGlvbiAoKSB7IHJldHVybiA0MiB9fVxuICAgIHJldHVybiBhcnIuZm9vKCkgPT09IDQyICYmIC8vIHR5cGVkIGFycmF5IGluc3RhbmNlcyBjYW4gYmUgYXVnbWVudGVkXG4gICAgICAgIHR5cGVvZiBhcnIuc3ViYXJyYXkgPT09ICdmdW5jdGlvbicgJiYgLy8gY2hyb21lIDktMTAgbGFjayBgc3ViYXJyYXlgXG4gICAgICAgIGFyci5zdWJhcnJheSgxLCAxKS5ieXRlTGVuZ3RoID09PSAwIC8vIGllMTAgaGFzIGJyb2tlbiBgc3ViYXJyYXlgXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG5mdW5jdGlvbiBrTWF4TGVuZ3RoICgpIHtcbiAgcmV0dXJuIEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUXG4gICAgPyAweDdmZmZmZmZmXG4gICAgOiAweDNmZmZmZmZmXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUJ1ZmZlciAodGhhdCwgbGVuZ3RoKSB7XG4gIGlmIChrTWF4TGVuZ3RoKCkgPCBsZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW52YWxpZCB0eXBlZCBhcnJheSBsZW5ndGgnKVxuICB9XG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlLCBmb3IgYmVzdCBwZXJmb3JtYW5jZVxuICAgIHRoYXQgPSBuZXcgVWludDhBcnJheShsZW5ndGgpXG4gICAgdGhhdC5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIH0gZWxzZSB7XG4gICAgLy8gRmFsbGJhY2s6IFJldHVybiBhbiBvYmplY3QgaW5zdGFuY2Ugb2YgdGhlIEJ1ZmZlciBjbGFzc1xuICAgIGlmICh0aGF0ID09PSBudWxsKSB7XG4gICAgICB0aGF0ID0gbmV3IEJ1ZmZlcihsZW5ndGgpXG4gICAgfVxuICAgIHRoYXQubGVuZ3RoID0gbGVuZ3RoXG4gIH1cblxuICByZXR1cm4gdGhhdFxufVxuXG4vKipcbiAqIFRoZSBCdWZmZXIgY29uc3RydWN0b3IgcmV0dXJucyBpbnN0YW5jZXMgb2YgYFVpbnQ4QXJyYXlgIHRoYXQgaGF2ZSB0aGVpclxuICogcHJvdG90eXBlIGNoYW5nZWQgdG8gYEJ1ZmZlci5wcm90b3R5cGVgLiBGdXJ0aGVybW9yZSwgYEJ1ZmZlcmAgaXMgYSBzdWJjbGFzcyBvZlxuICogYFVpbnQ4QXJyYXlgLCBzbyB0aGUgcmV0dXJuZWQgaW5zdGFuY2VzIHdpbGwgaGF2ZSBhbGwgdGhlIG5vZGUgYEJ1ZmZlcmAgbWV0aG9kc1xuICogYW5kIHRoZSBgVWludDhBcnJheWAgbWV0aG9kcy4gU3F1YXJlIGJyYWNrZXQgbm90YXRpb24gd29ya3MgYXMgZXhwZWN0ZWQgLS0gaXRcbiAqIHJldHVybnMgYSBzaW5nbGUgb2N0ZXQuXG4gKlxuICogVGhlIGBVaW50OEFycmF5YCBwcm90b3R5cGUgcmVtYWlucyB1bm1vZGlmaWVkLlxuICovXG5cbmZ1bmN0aW9uIEJ1ZmZlciAoYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHtcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJiAhKHRoaXMgaW5zdGFuY2VvZiBCdWZmZXIpKSB7XG4gICAgcmV0dXJuIG5ldyBCdWZmZXIoYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpXG4gIH1cblxuICAvLyBDb21tb24gY2FzZS5cbiAgaWYgKHR5cGVvZiBhcmcgPT09ICdudW1iZXInKSB7XG4gICAgaWYgKHR5cGVvZiBlbmNvZGluZ09yT2Zmc2V0ID09PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAnSWYgZW5jb2RpbmcgaXMgc3BlY2lmaWVkIHRoZW4gdGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcnXG4gICAgICApXG4gICAgfVxuICAgIHJldHVybiBhbGxvY1Vuc2FmZSh0aGlzLCBhcmcpXG4gIH1cbiAgcmV0dXJuIGZyb20odGhpcywgYXJnLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpXG59XG5cbkJ1ZmZlci5wb29sU2l6ZSA9IDgxOTIgLy8gbm90IHVzZWQgYnkgdGhpcyBpbXBsZW1lbnRhdGlvblxuXG4vLyBUT0RPOiBMZWdhY3ksIG5vdCBuZWVkZWQgYW55bW9yZS4gUmVtb3ZlIGluIG5leHQgbWFqb3IgdmVyc2lvbi5cbkJ1ZmZlci5fYXVnbWVudCA9IGZ1bmN0aW9uIChhcnIpIHtcbiAgYXJyLl9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgcmV0dXJuIGFyclxufVxuXG5mdW5jdGlvbiBmcm9tICh0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJ2YWx1ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgbnVtYmVyJylcbiAgfVxuXG4gIGlmICh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICByZXR1cm4gZnJvbUFycmF5QnVmZmVyKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpXG4gIH1cblxuICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBmcm9tU3RyaW5nKHRoYXQsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0KVxuICB9XG5cbiAgcmV0dXJuIGZyb21PYmplY3QodGhhdCwgdmFsdWUpXG59XG5cbi8qKlxuICogRnVuY3Rpb25hbGx5IGVxdWl2YWxlbnQgdG8gQnVmZmVyKGFyZywgZW5jb2RpbmcpIGJ1dCB0aHJvd3MgYSBUeXBlRXJyb3JcbiAqIGlmIHZhbHVlIGlzIGEgbnVtYmVyLlxuICogQnVmZmVyLmZyb20oc3RyWywgZW5jb2RpbmddKVxuICogQnVmZmVyLmZyb20oYXJyYXkpXG4gKiBCdWZmZXIuZnJvbShidWZmZXIpXG4gKiBCdWZmZXIuZnJvbShhcnJheUJ1ZmZlclssIGJ5dGVPZmZzZXRbLCBsZW5ndGhdXSlcbiAqKi9cbkJ1ZmZlci5mcm9tID0gZnVuY3Rpb24gKHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGZyb20obnVsbCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aClcbn1cblxuaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gIEJ1ZmZlci5wcm90b3R5cGUuX19wcm90b19fID0gVWludDhBcnJheS5wcm90b3R5cGVcbiAgQnVmZmVyLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXlcbiAgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC5zcGVjaWVzICYmXG4gICAgICBCdWZmZXJbU3ltYm9sLnNwZWNpZXNdID09PSBCdWZmZXIpIHtcbiAgICAvLyBGaXggc3ViYXJyYXkoKSBpbiBFUzIwMTYuIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9idWZmZXIvcHVsbC85N1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWZmZXIsIFN5bWJvbC5zcGVjaWVzLCB7XG4gICAgICB2YWx1ZTogbnVsbCxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pXG4gIH1cbn1cblxuZnVuY3Rpb24gYXNzZXJ0U2l6ZSAoc2l6ZSkge1xuICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJzaXplXCIgYXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpXG4gIH0gZWxzZSBpZiAoc2l6ZSA8IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXCJzaXplXCIgYXJndW1lbnQgbXVzdCBub3QgYmUgbmVnYXRpdmUnKVxuICB9XG59XG5cbmZ1bmN0aW9uIGFsbG9jICh0aGF0LCBzaXplLCBmaWxsLCBlbmNvZGluZykge1xuICBhc3NlcnRTaXplKHNpemUpXG4gIGlmIChzaXplIDw9IDApIHtcbiAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpXG4gIH1cbiAgaWYgKGZpbGwgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIE9ubHkgcGF5IGF0dGVudGlvbiB0byBlbmNvZGluZyBpZiBpdCdzIGEgc3RyaW5nLiBUaGlzXG4gICAgLy8gcHJldmVudHMgYWNjaWRlbnRhbGx5IHNlbmRpbmcgaW4gYSBudW1iZXIgdGhhdCB3b3VsZFxuICAgIC8vIGJlIGludGVycHJldHRlZCBhcyBhIHN0YXJ0IG9mZnNldC5cbiAgICByZXR1cm4gdHlwZW9mIGVuY29kaW5nID09PSAnc3RyaW5nJ1xuICAgICAgPyBjcmVhdGVCdWZmZXIodGhhdCwgc2l6ZSkuZmlsbChmaWxsLCBlbmNvZGluZylcbiAgICAgIDogY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpLmZpbGwoZmlsbClcbiAgfVxuICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpXG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBmaWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICogYWxsb2Moc2l6ZVssIGZpbGxbLCBlbmNvZGluZ11dKVxuICoqL1xuQnVmZmVyLmFsbG9jID0gZnVuY3Rpb24gKHNpemUsIGZpbGwsIGVuY29kaW5nKSB7XG4gIHJldHVybiBhbGxvYyhudWxsLCBzaXplLCBmaWxsLCBlbmNvZGluZylcbn1cblxuZnVuY3Rpb24gYWxsb2NVbnNhZmUgKHRoYXQsIHNpemUpIHtcbiAgYXNzZXJ0U2l6ZShzaXplKVxuICB0aGF0ID0gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUgPCAwID8gMCA6IGNoZWNrZWQoc2l6ZSkgfCAwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyArK2kpIHtcbiAgICAgIHRoYXRbaV0gPSAwXG4gICAgfVxuICB9XG4gIHJldHVybiB0aGF0XG59XG5cbi8qKlxuICogRXF1aXZhbGVudCB0byBCdWZmZXIobnVtKSwgYnkgZGVmYXVsdCBjcmVhdGVzIGEgbm9uLXplcm8tZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqICovXG5CdWZmZXIuYWxsb2NVbnNhZmUgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICByZXR1cm4gYWxsb2NVbnNhZmUobnVsbCwgc2l6ZSlcbn1cbi8qKlxuICogRXF1aXZhbGVudCB0byBTbG93QnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKi9cbkJ1ZmZlci5hbGxvY1Vuc2FmZVNsb3cgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICByZXR1cm4gYWxsb2NVbnNhZmUobnVsbCwgc2l6ZSlcbn1cblxuZnVuY3Rpb24gZnJvbVN0cmluZyAodGhhdCwgc3RyaW5nLCBlbmNvZGluZykge1xuICBpZiAodHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJyB8fCBlbmNvZGluZyA9PT0gJycpIHtcbiAgICBlbmNvZGluZyA9ICd1dGY4J1xuICB9XG5cbiAgaWYgKCFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImVuY29kaW5nXCIgbXVzdCBiZSBhIHZhbGlkIHN0cmluZyBlbmNvZGluZycpXG4gIH1cblxuICB2YXIgbGVuZ3RoID0gYnl0ZUxlbmd0aChzdHJpbmcsIGVuY29kaW5nKSB8IDBcbiAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBsZW5ndGgpXG5cbiAgdmFyIGFjdHVhbCA9IHRoYXQud3JpdGUoc3RyaW5nLCBlbmNvZGluZylcblxuICBpZiAoYWN0dWFsICE9PSBsZW5ndGgpIHtcbiAgICAvLyBXcml0aW5nIGEgaGV4IHN0cmluZywgZm9yIGV4YW1wbGUsIHRoYXQgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzIHdpbGxcbiAgICAvLyBjYXVzZSBldmVyeXRoaW5nIGFmdGVyIHRoZSBmaXJzdCBpbnZhbGlkIGNoYXJhY3RlciB0byBiZSBpZ25vcmVkLiAoZS5nLlxuICAgIC8vICdhYnh4Y2QnIHdpbGwgYmUgdHJlYXRlZCBhcyAnYWInKVxuICAgIHRoYXQgPSB0aGF0LnNsaWNlKDAsIGFjdHVhbClcbiAgfVxuXG4gIHJldHVybiB0aGF0XG59XG5cbmZ1bmN0aW9uIGZyb21BcnJheUxpa2UgKHRoYXQsIGFycmF5KSB7XG4gIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGggPCAwID8gMCA6IGNoZWNrZWQoYXJyYXkubGVuZ3RoKSB8IDBcbiAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBsZW5ndGgpXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICB0aGF0W2ldID0gYXJyYXlbaV0gJiAyNTVcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlCdWZmZXIgKHRoYXQsIGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpIHtcbiAgYXJyYXkuYnl0ZUxlbmd0aCAvLyB0aGlzIHRocm93cyBpZiBgYXJyYXlgIGlzIG5vdCBhIHZhbGlkIEFycmF5QnVmZmVyXG5cbiAgaWYgKGJ5dGVPZmZzZXQgPCAwIHx8IGFycmF5LmJ5dGVMZW5ndGggPCBieXRlT2Zmc2V0KSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1xcJ29mZnNldFxcJyBpcyBvdXQgb2YgYm91bmRzJylcbiAgfVxuXG4gIGlmIChhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCArIChsZW5ndGggfHwgMCkpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignXFwnbGVuZ3RoXFwnIGlzIG91dCBvZiBib3VuZHMnKVxuICB9XG5cbiAgaWYgKGJ5dGVPZmZzZXQgPT09IHVuZGVmaW5lZCAmJiBsZW5ndGggPT09IHVuZGVmaW5lZCkge1xuICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXkpXG4gIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0KVxuICB9IGVsc2Uge1xuICAgIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXksIGJ5dGVPZmZzZXQsIGxlbmd0aClcbiAgfVxuXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIC8vIFJldHVybiBhbiBhdWdtZW50ZWQgYFVpbnQ4QXJyYXlgIGluc3RhbmNlLCBmb3IgYmVzdCBwZXJmb3JtYW5jZVxuICAgIHRoYXQgPSBhcnJheVxuICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3NcbiAgICB0aGF0ID0gZnJvbUFycmF5TGlrZSh0aGF0LCBhcnJheSlcbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tT2JqZWN0ICh0aGF0LCBvYmopIHtcbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcihvYmopKSB7XG4gICAgdmFyIGxlbiA9IGNoZWNrZWQob2JqLmxlbmd0aCkgfCAwXG4gICAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBsZW4pXG5cbiAgICBpZiAodGhhdC5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB0aGF0XG4gICAgfVxuXG4gICAgb2JqLmNvcHkodGhhdCwgMCwgMCwgbGVuKVxuICAgIHJldHVybiB0aGF0XG4gIH1cblxuICBpZiAob2JqKSB7XG4gICAgaWYgKCh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgIG9iai5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgfHwgJ2xlbmd0aCcgaW4gb2JqKSB7XG4gICAgICBpZiAodHlwZW9mIG9iai5sZW5ndGggIT09ICdudW1iZXInIHx8IGlzbmFuKG9iai5sZW5ndGgpKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVCdWZmZXIodGhhdCwgMClcbiAgICAgIH1cbiAgICAgIHJldHVybiBmcm9tQXJyYXlMaWtlKHRoYXQsIG9iailcbiAgICB9XG5cbiAgICBpZiAob2JqLnR5cGUgPT09ICdCdWZmZXInICYmIGlzQXJyYXkob2JqLmRhdGEpKSB7XG4gICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmouZGF0YSlcbiAgICB9XG4gIH1cblxuICB0aHJvdyBuZXcgVHlwZUVycm9yKCdGaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nLCBCdWZmZXIsIEFycmF5QnVmZmVyLCBBcnJheSwgb3IgYXJyYXktbGlrZSBvYmplY3QuJylcbn1cblxuZnVuY3Rpb24gY2hlY2tlZCAobGVuZ3RoKSB7XG4gIC8vIE5vdGU6IGNhbm5vdCB1c2UgYGxlbmd0aCA8IGtNYXhMZW5ndGgoKWAgaGVyZSBiZWNhdXNlIHRoYXQgZmFpbHMgd2hlblxuICAvLyBsZW5ndGggaXMgTmFOICh3aGljaCBpcyBvdGhlcndpc2UgY29lcmNlZCB0byB6ZXJvLilcbiAgaWYgKGxlbmd0aCA+PSBrTWF4TGVuZ3RoKCkpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQXR0ZW1wdCB0byBhbGxvY2F0ZSBCdWZmZXIgbGFyZ2VyIHRoYW4gbWF4aW11bSAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAnc2l6ZTogMHgnICsga01heExlbmd0aCgpLnRvU3RyaW5nKDE2KSArICcgYnl0ZXMnKVxuICB9XG4gIHJldHVybiBsZW5ndGggfCAwXG59XG5cbmZ1bmN0aW9uIFNsb3dCdWZmZXIgKGxlbmd0aCkge1xuICBpZiAoK2xlbmd0aCAhPSBsZW5ndGgpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBlcWVxZXFcbiAgICBsZW5ndGggPSAwXG4gIH1cbiAgcmV0dXJuIEJ1ZmZlci5hbGxvYygrbGVuZ3RoKVxufVxuXG5CdWZmZXIuaXNCdWZmZXIgPSBmdW5jdGlvbiBpc0J1ZmZlciAoYikge1xuICByZXR1cm4gISEoYiAhPSBudWxsICYmIGIuX2lzQnVmZmVyKVxufVxuXG5CdWZmZXIuY29tcGFyZSA9IGZ1bmN0aW9uIGNvbXBhcmUgKGEsIGIpIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYSkgfHwgIUJ1ZmZlci5pc0J1ZmZlcihiKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50cyBtdXN0IGJlIEJ1ZmZlcnMnKVxuICB9XG5cbiAgaWYgKGEgPT09IGIpIHJldHVybiAwXG5cbiAgdmFyIHggPSBhLmxlbmd0aFxuICB2YXIgeSA9IGIubGVuZ3RoXG5cbiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IE1hdGgubWluKHgsIHkpOyBpIDwgbGVuOyArK2kpIHtcbiAgICBpZiAoYVtpXSAhPT0gYltpXSkge1xuICAgICAgeCA9IGFbaV1cbiAgICAgIHkgPSBiW2ldXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIGlmICh4IDwgeSkgcmV0dXJuIC0xXG4gIGlmICh5IDwgeCkgcmV0dXJuIDFcbiAgcmV0dXJuIDBcbn1cblxuQnVmZmVyLmlzRW5jb2RpbmcgPSBmdW5jdGlvbiBpc0VuY29kaW5nIChlbmNvZGluZykge1xuICBzd2l0Y2ggKFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKSkge1xuICAgIGNhc2UgJ2hleCc6XG4gICAgY2FzZSAndXRmOCc6XG4gICAgY2FzZSAndXRmLTgnOlxuICAgIGNhc2UgJ2FzY2lpJzpcbiAgICBjYXNlICdsYXRpbjEnOlxuICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgY2FzZSAnYmFzZTY0JzpcbiAgICBjYXNlICd1Y3MyJzpcbiAgICBjYXNlICd1Y3MtMic6XG4gICAgY2FzZSAndXRmMTZsZSc6XG4gICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgcmV0dXJuIHRydWVcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuQnVmZmVyLmNvbmNhdCA9IGZ1bmN0aW9uIGNvbmNhdCAobGlzdCwgbGVuZ3RoKSB7XG4gIGlmICghaXNBcnJheShsaXN0KSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wibGlzdFwiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpXG4gIH1cblxuICBpZiAobGlzdC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gQnVmZmVyLmFsbG9jKDApXG4gIH1cblxuICB2YXIgaVxuICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICBsZW5ndGggPSAwXG4gICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHtcbiAgICAgIGxlbmd0aCArPSBsaXN0W2ldLmxlbmd0aFxuICAgIH1cbiAgfVxuXG4gIHZhciBidWZmZXIgPSBCdWZmZXIuYWxsb2NVbnNhZmUobGVuZ3RoKVxuICB2YXIgcG9zID0gMFxuICBmb3IgKGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSkge1xuICAgIHZhciBidWYgPSBsaXN0W2ldXG4gICAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYnVmKSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJsaXN0XCIgYXJndW1lbnQgbXVzdCBiZSBhbiBBcnJheSBvZiBCdWZmZXJzJylcbiAgICB9XG4gICAgYnVmLmNvcHkoYnVmZmVyLCBwb3MpXG4gICAgcG9zICs9IGJ1Zi5sZW5ndGhcbiAgfVxuICByZXR1cm4gYnVmZmVyXG59XG5cbmZ1bmN0aW9uIGJ5dGVMZW5ndGggKHN0cmluZywgZW5jb2RpbmcpIHtcbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcihzdHJpbmcpKSB7XG4gICAgcmV0dXJuIHN0cmluZy5sZW5ndGhcbiAgfVxuICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3ID09PSAnZnVuY3Rpb24nICYmXG4gICAgICAoQXJyYXlCdWZmZXIuaXNWaWV3KHN0cmluZykgfHwgc3RyaW5nIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKSB7XG4gICAgcmV0dXJuIHN0cmluZy5ieXRlTGVuZ3RoXG4gIH1cbiAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSB7XG4gICAgc3RyaW5nID0gJycgKyBzdHJpbmdcbiAgfVxuXG4gIHZhciBsZW4gPSBzdHJpbmcubGVuZ3RoXG4gIGlmIChsZW4gPT09IDApIHJldHVybiAwXG5cbiAgLy8gVXNlIGEgZm9yIGxvb3AgdG8gYXZvaWQgcmVjdXJzaW9uXG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG4gIGZvciAoOzspIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxlblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICBjYXNlIHVuZGVmaW5lZDpcbiAgICAgICAgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gbGVuICogMlxuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGxlbiA+Pj4gMVxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIGJhc2U2NFRvQnl0ZXMoc3RyaW5nKS5sZW5ndGhcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgcmV0dXJuIHV0ZjhUb0J5dGVzKHN0cmluZykubGVuZ3RoIC8vIGFzc3VtZSB1dGY4XG4gICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5CdWZmZXIuYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGhcblxuZnVuY3Rpb24gc2xvd1RvU3RyaW5nIChlbmNvZGluZywgc3RhcnQsIGVuZCkge1xuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuXG4gIC8vIE5vIG5lZWQgdG8gdmVyaWZ5IHRoYXQgXCJ0aGlzLmxlbmd0aCA8PSBNQVhfVUlOVDMyXCIgc2luY2UgaXQncyBhIHJlYWQtb25seVxuICAvLyBwcm9wZXJ0eSBvZiBhIHR5cGVkIGFycmF5LlxuXG4gIC8vIFRoaXMgYmVoYXZlcyBuZWl0aGVyIGxpa2UgU3RyaW5nIG5vciBVaW50OEFycmF5IGluIHRoYXQgd2Ugc2V0IHN0YXJ0L2VuZFxuICAvLyB0byB0aGVpciB1cHBlci9sb3dlciBib3VuZHMgaWYgdGhlIHZhbHVlIHBhc3NlZCBpcyBvdXQgb2YgcmFuZ2UuXG4gIC8vIHVuZGVmaW5lZCBpcyBoYW5kbGVkIHNwZWNpYWxseSBhcyBwZXIgRUNNQS0yNjIgNnRoIEVkaXRpb24sXG4gIC8vIFNlY3Rpb24gMTMuMy4zLjcgUnVudGltZSBTZW1hbnRpY3M6IEtleWVkQmluZGluZ0luaXRpYWxpemF0aW9uLlxuICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCB8fCBzdGFydCA8IDApIHtcbiAgICBzdGFydCA9IDBcbiAgfVxuICAvLyBSZXR1cm4gZWFybHkgaWYgc3RhcnQgPiB0aGlzLmxlbmd0aC4gRG9uZSBoZXJlIHRvIHByZXZlbnQgcG90ZW50aWFsIHVpbnQzMlxuICAvLyBjb2VyY2lvbiBmYWlsIGJlbG93LlxuICBpZiAoc3RhcnQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkIHx8IGVuZCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgfVxuXG4gIGlmIChlbmQgPD0gMCkge1xuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgLy8gRm9yY2UgY29lcnNpb24gdG8gdWludDMyLiBUaGlzIHdpbGwgYWxzbyBjb2VyY2UgZmFsc2V5L05hTiB2YWx1ZXMgdG8gMC5cbiAgZW5kID4+Pj0gMFxuICBzdGFydCA+Pj49IDBcblxuICBpZiAoZW5kIDw9IHN0YXJ0KSB7XG4gICAgcmV0dXJuICcnXG4gIH1cblxuICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4J1xuXG4gIHdoaWxlICh0cnVlKSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnaGV4JzpcbiAgICAgICAgcmV0dXJuIGhleFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgICByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2FzY2lpJzpcbiAgICAgICAgcmV0dXJuIGFzY2lpU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsYXRpbjFTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgICByZXR1cm4gYmFzZTY0U2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIHV0ZjE2bGVTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICAgICAgZW5jb2RpbmcgPSAoZW5jb2RpbmcgKyAnJykudG9Mb3dlckNhc2UoKVxuICAgICAgICBsb3dlcmVkQ2FzZSA9IHRydWVcbiAgICB9XG4gIH1cbn1cblxuLy8gVGhlIHByb3BlcnR5IGlzIHVzZWQgYnkgYEJ1ZmZlci5pc0J1ZmZlcmAgYW5kIGBpcy1idWZmZXJgIChpbiBTYWZhcmkgNS03KSB0byBkZXRlY3Rcbi8vIEJ1ZmZlciBpbnN0YW5jZXMuXG5CdWZmZXIucHJvdG90eXBlLl9pc0J1ZmZlciA9IHRydWVcblxuZnVuY3Rpb24gc3dhcCAoYiwgbiwgbSkge1xuICB2YXIgaSA9IGJbbl1cbiAgYltuXSA9IGJbbV1cbiAgYlttXSA9IGlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwMTYgPSBmdW5jdGlvbiBzd2FwMTYgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDIgIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDE2LWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDIpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyAxKVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDMyID0gZnVuY3Rpb24gc3dhcDMyICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSA0ICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAzMi1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgMylcbiAgICBzd2FwKHRoaXMsIGkgKyAxLCBpICsgMilcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXA2NCA9IGZ1bmN0aW9uIHN3YXA2NCAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgOCAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNjQtYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gOCkge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDcpXG4gICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDYpXG4gICAgc3dhcCh0aGlzLCBpICsgMiwgaSArIDUpXG4gICAgc3dhcCh0aGlzLCBpICsgMywgaSArIDQpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nICgpIHtcbiAgdmFyIGxlbmd0aCA9IHRoaXMubGVuZ3RoIHwgMFxuICBpZiAobGVuZ3RoID09PSAwKSByZXR1cm4gJydcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHJldHVybiB1dGY4U2xpY2UodGhpcywgMCwgbGVuZ3RoKVxuICByZXR1cm4gc2xvd1RvU3RyaW5nLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiBlcXVhbHMgKGIpIHtcbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoYikpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXInKVxuICBpZiAodGhpcyA9PT0gYikgcmV0dXJuIHRydWVcbiAgcmV0dXJuIEJ1ZmZlci5jb21wYXJlKHRoaXMsIGIpID09PSAwXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5zcGVjdCA9IGZ1bmN0aW9uIGluc3BlY3QgKCkge1xuICB2YXIgc3RyID0gJydcbiAgdmFyIG1heCA9IGV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVNcbiAgaWYgKHRoaXMubGVuZ3RoID4gMCkge1xuICAgIHN0ciA9IHRoaXMudG9TdHJpbmcoJ2hleCcsIDAsIG1heCkubWF0Y2goLy57Mn0vZykuam9pbignICcpXG4gICAgaWYgKHRoaXMubGVuZ3RoID4gbWF4KSBzdHIgKz0gJyAuLi4gJ1xuICB9XG4gIHJldHVybiAnPEJ1ZmZlciAnICsgc3RyICsgJz4nXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuY29tcGFyZSA9IGZ1bmN0aW9uIGNvbXBhcmUgKHRhcmdldCwgc3RhcnQsIGVuZCwgdGhpc1N0YXJ0LCB0aGlzRW5kKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKHRhcmdldCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJylcbiAgfVxuXG4gIGlmIChzdGFydCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgc3RhcnQgPSAwXG4gIH1cbiAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZW5kID0gdGFyZ2V0ID8gdGFyZ2V0Lmxlbmd0aCA6IDBcbiAgfVxuICBpZiAodGhpc1N0YXJ0ID09PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzU3RhcnQgPSAwXG4gIH1cbiAgaWYgKHRoaXNFbmQgPT09IHVuZGVmaW5lZCkge1xuICAgIHRoaXNFbmQgPSB0aGlzLmxlbmd0aFxuICB9XG5cbiAgaWYgKHN0YXJ0IDwgMCB8fCBlbmQgPiB0YXJnZXQubGVuZ3RoIHx8IHRoaXNTdGFydCA8IDAgfHwgdGhpc0VuZCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ291dCBvZiByYW5nZSBpbmRleCcpXG4gIH1cblxuICBpZiAodGhpc1N0YXJ0ID49IHRoaXNFbmQgJiYgc3RhcnQgPj0gZW5kKSB7XG4gICAgcmV0dXJuIDBcbiAgfVxuICBpZiAodGhpc1N0YXJ0ID49IHRoaXNFbmQpIHtcbiAgICByZXR1cm4gLTFcbiAgfVxuICBpZiAoc3RhcnQgPj0gZW5kKSB7XG4gICAgcmV0dXJuIDFcbiAgfVxuXG4gIHN0YXJ0ID4+Pj0gMFxuICBlbmQgPj4+PSAwXG4gIHRoaXNTdGFydCA+Pj49IDBcbiAgdGhpc0VuZCA+Pj49IDBcblxuICBpZiAodGhpcyA9PT0gdGFyZ2V0KSByZXR1cm4gMFxuXG4gIHZhciB4ID0gdGhpc0VuZCAtIHRoaXNTdGFydFxuICB2YXIgeSA9IGVuZCAtIHN0YXJ0XG4gIHZhciBsZW4gPSBNYXRoLm1pbih4LCB5KVxuXG4gIHZhciB0aGlzQ29weSA9IHRoaXMuc2xpY2UodGhpc1N0YXJ0LCB0aGlzRW5kKVxuICB2YXIgdGFyZ2V0Q29weSA9IHRhcmdldC5zbGljZShzdGFydCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICBpZiAodGhpc0NvcHlbaV0gIT09IHRhcmdldENvcHlbaV0pIHtcbiAgICAgIHggPSB0aGlzQ29weVtpXVxuICAgICAgeSA9IHRhcmdldENvcHlbaV1cbiAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgaWYgKHggPCB5KSByZXR1cm4gLTFcbiAgaWYgKHkgPCB4KSByZXR1cm4gMVxuICByZXR1cm4gMFxufVxuXG4vLyBGaW5kcyBlaXRoZXIgdGhlIGZpcnN0IGluZGV4IG9mIGB2YWxgIGluIGBidWZmZXJgIGF0IG9mZnNldCA+PSBgYnl0ZU9mZnNldGAsXG4vLyBPUiB0aGUgbGFzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPD0gYGJ5dGVPZmZzZXRgLlxuLy9cbi8vIEFyZ3VtZW50czpcbi8vIC0gYnVmZmVyIC0gYSBCdWZmZXIgdG8gc2VhcmNoXG4vLyAtIHZhbCAtIGEgc3RyaW5nLCBCdWZmZXIsIG9yIG51bWJlclxuLy8gLSBieXRlT2Zmc2V0IC0gYW4gaW5kZXggaW50byBgYnVmZmVyYDsgd2lsbCBiZSBjbGFtcGVkIHRvIGFuIGludDMyXG4vLyAtIGVuY29kaW5nIC0gYW4gb3B0aW9uYWwgZW5jb2RpbmcsIHJlbGV2YW50IGlzIHZhbCBpcyBhIHN0cmluZ1xuLy8gLSBkaXIgLSB0cnVlIGZvciBpbmRleE9mLCBmYWxzZSBmb3IgbGFzdEluZGV4T2ZcbmZ1bmN0aW9uIGJpZGlyZWN0aW9uYWxJbmRleE9mIChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikge1xuICAvLyBFbXB0eSBidWZmZXIgbWVhbnMgbm8gbWF0Y2hcbiAgaWYgKGJ1ZmZlci5sZW5ndGggPT09IDApIHJldHVybiAtMVxuXG4gIC8vIE5vcm1hbGl6ZSBieXRlT2Zmc2V0XG4gIGlmICh0eXBlb2YgYnl0ZU9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICBlbmNvZGluZyA9IGJ5dGVPZmZzZXRcbiAgICBieXRlT2Zmc2V0ID0gMFxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPiAweDdmZmZmZmZmKSB7XG4gICAgYnl0ZU9mZnNldCA9IDB4N2ZmZmZmZmZcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0IDwgLTB4ODAwMDAwMDApIHtcbiAgICBieXRlT2Zmc2V0ID0gLTB4ODAwMDAwMDBcbiAgfVxuICBieXRlT2Zmc2V0ID0gK2J5dGVPZmZzZXQgIC8vIENvZXJjZSB0byBOdW1iZXIuXG4gIGlmIChpc05hTihieXRlT2Zmc2V0KSkge1xuICAgIC8vIGJ5dGVPZmZzZXQ6IGl0IGl0J3MgdW5kZWZpbmVkLCBudWxsLCBOYU4sIFwiZm9vXCIsIGV0Yywgc2VhcmNoIHdob2xlIGJ1ZmZlclxuICAgIGJ5dGVPZmZzZXQgPSBkaXIgPyAwIDogKGJ1ZmZlci5sZW5ndGggLSAxKVxuICB9XG5cbiAgLy8gTm9ybWFsaXplIGJ5dGVPZmZzZXQ6IG5lZ2F0aXZlIG9mZnNldHMgc3RhcnQgZnJvbSB0aGUgZW5kIG9mIHRoZSBidWZmZXJcbiAgaWYgKGJ5dGVPZmZzZXQgPCAwKSBieXRlT2Zmc2V0ID0gYnVmZmVyLmxlbmd0aCArIGJ5dGVPZmZzZXRcbiAgaWYgKGJ5dGVPZmZzZXQgPj0gYnVmZmVyLmxlbmd0aCkge1xuICAgIGlmIChkaXIpIHJldHVybiAtMVxuICAgIGVsc2UgYnl0ZU9mZnNldCA9IGJ1ZmZlci5sZW5ndGggLSAxXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA8IDApIHtcbiAgICBpZiAoZGlyKSBieXRlT2Zmc2V0ID0gMFxuICAgIGVsc2UgcmV0dXJuIC0xXG4gIH1cblxuICAvLyBOb3JtYWxpemUgdmFsXG4gIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgIHZhbCA9IEJ1ZmZlci5mcm9tKHZhbCwgZW5jb2RpbmcpXG4gIH1cblxuICAvLyBGaW5hbGx5LCBzZWFyY2ggZWl0aGVyIGluZGV4T2YgKGlmIGRpciBpcyB0cnVlKSBvciBsYXN0SW5kZXhPZlxuICBpZiAoQnVmZmVyLmlzQnVmZmVyKHZhbCkpIHtcbiAgICAvLyBTcGVjaWFsIGNhc2U6IGxvb2tpbmcgZm9yIGVtcHR5IHN0cmluZy9idWZmZXIgYWx3YXlzIGZhaWxzXG4gICAgaWYgKHZhbC5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiAtMVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXlJbmRleE9mKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKVxuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09ICdudW1iZXInKSB7XG4gICAgdmFsID0gdmFsICYgMHhGRiAvLyBTZWFyY2ggZm9yIGEgYnl0ZSB2YWx1ZSBbMC0yNTVdXG4gICAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUICYmXG4gICAgICAgIHR5cGVvZiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBpZiAoZGlyKSB7XG4gICAgICAgIHJldHVybiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YuY2FsbChidWZmZXIsIHZhbCwgYnl0ZU9mZnNldClcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIFsgdmFsIF0sIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpXG4gIH1cblxuICB0aHJvdyBuZXcgVHlwZUVycm9yKCd2YWwgbXVzdCBiZSBzdHJpbmcsIG51bWJlciBvciBCdWZmZXInKVxufVxuXG5mdW5jdGlvbiBhcnJheUluZGV4T2YgKGFyciwgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKSB7XG4gIHZhciBpbmRleFNpemUgPSAxXG4gIHZhciBhcnJMZW5ndGggPSBhcnIubGVuZ3RoXG4gIHZhciB2YWxMZW5ndGggPSB2YWwubGVuZ3RoXG5cbiAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQpIHtcbiAgICBlbmNvZGluZyA9IFN0cmluZyhlbmNvZGluZykudG9Mb3dlckNhc2UoKVxuICAgIGlmIChlbmNvZGluZyA9PT0gJ3VjczInIHx8IGVuY29kaW5nID09PSAndWNzLTInIHx8XG4gICAgICAgIGVuY29kaW5nID09PSAndXRmMTZsZScgfHwgZW5jb2RpbmcgPT09ICd1dGYtMTZsZScpIHtcbiAgICAgIGlmIChhcnIubGVuZ3RoIDwgMiB8fCB2YWwubGVuZ3RoIDwgMikge1xuICAgICAgICByZXR1cm4gLTFcbiAgICAgIH1cbiAgICAgIGluZGV4U2l6ZSA9IDJcbiAgICAgIGFyckxlbmd0aCAvPSAyXG4gICAgICB2YWxMZW5ndGggLz0gMlxuICAgICAgYnl0ZU9mZnNldCAvPSAyXG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcmVhZCAoYnVmLCBpKSB7XG4gICAgaWYgKGluZGV4U2l6ZSA9PT0gMSkge1xuICAgICAgcmV0dXJuIGJ1ZltpXVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYnVmLnJlYWRVSW50MTZCRShpICogaW5kZXhTaXplKVxuICAgIH1cbiAgfVxuXG4gIHZhciBpXG4gIGlmIChkaXIpIHtcbiAgICB2YXIgZm91bmRJbmRleCA9IC0xXG4gICAgZm9yIChpID0gYnl0ZU9mZnNldDsgaSA8IGFyckxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAocmVhZChhcnIsIGkpID09PSByZWFkKHZhbCwgZm91bmRJbmRleCA9PT0gLTEgPyAwIDogaSAtIGZvdW5kSW5kZXgpKSB7XG4gICAgICAgIGlmIChmb3VuZEluZGV4ID09PSAtMSkgZm91bmRJbmRleCA9IGlcbiAgICAgICAgaWYgKGkgLSBmb3VuZEluZGV4ICsgMSA9PT0gdmFsTGVuZ3RoKSByZXR1cm4gZm91bmRJbmRleCAqIGluZGV4U2l6ZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IC0xKSBpIC09IGkgLSBmb3VuZEluZGV4XG4gICAgICAgIGZvdW5kSW5kZXggPSAtMVxuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoYnl0ZU9mZnNldCArIHZhbExlbmd0aCA+IGFyckxlbmd0aCkgYnl0ZU9mZnNldCA9IGFyckxlbmd0aCAtIHZhbExlbmd0aFxuICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgZm91bmQgPSB0cnVlXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHZhbExlbmd0aDsgaisrKSB7XG4gICAgICAgIGlmIChyZWFkKGFyciwgaSArIGopICE9PSByZWFkKHZhbCwgaikpIHtcbiAgICAgICAgICBmb3VuZCA9IGZhbHNlXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGZvdW5kKSByZXR1cm4gaVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiAtMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluY2x1ZGVzID0gZnVuY3Rpb24gaW5jbHVkZXMgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIHRoaXMuaW5kZXhPZih2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSAhPT0gLTFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gaW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcywgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgdHJ1ZSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5sYXN0SW5kZXhPZiA9IGZ1bmN0aW9uIGxhc3RJbmRleE9mICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiBiaWRpcmVjdGlvbmFsSW5kZXhPZih0aGlzLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBmYWxzZSlcbn1cblxuZnVuY3Rpb24gaGV4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICBvZmZzZXQgPSBOdW1iZXIob2Zmc2V0KSB8fCAwXG4gIHZhciByZW1haW5pbmcgPSBidWYubGVuZ3RoIC0gb2Zmc2V0XG4gIGlmICghbGVuZ3RoKSB7XG4gICAgbGVuZ3RoID0gcmVtYWluaW5nXG4gIH0gZWxzZSB7XG4gICAgbGVuZ3RoID0gTnVtYmVyKGxlbmd0aClcbiAgICBpZiAobGVuZ3RoID4gcmVtYWluaW5nKSB7XG4gICAgICBsZW5ndGggPSByZW1haW5pbmdcbiAgICB9XG4gIH1cblxuICAvLyBtdXN0IGJlIGFuIGV2ZW4gbnVtYmVyIG9mIGRpZ2l0c1xuICB2YXIgc3RyTGVuID0gc3RyaW5nLmxlbmd0aFxuICBpZiAoc3RyTGVuICUgMiAhPT0gMCkgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBoZXggc3RyaW5nJylcblxuICBpZiAobGVuZ3RoID4gc3RyTGVuIC8gMikge1xuICAgIGxlbmd0aCA9IHN0ckxlbiAvIDJcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgdmFyIHBhcnNlZCA9IHBhcnNlSW50KHN0cmluZy5zdWJzdHIoaSAqIDIsIDIpLCAxNilcbiAgICBpZiAoaXNOYU4ocGFyc2VkKSkgcmV0dXJuIGlcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSBwYXJzZWRcbiAgfVxuICByZXR1cm4gaVxufVxuXG5mdW5jdGlvbiB1dGY4V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcih1dGY4VG9CeXRlcyhzdHJpbmcsIGJ1Zi5sZW5ndGggLSBvZmZzZXQpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBhc2NpaVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIoYXNjaWlUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIGxhdGluMVdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGFzY2lpV3JpdGUoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBiYXNlNjRXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGJhc2U2NFRvQnl0ZXMoc3RyaW5nKSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gdWNzMldyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmMTZsZVRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIHdyaXRlIChzdHJpbmcsIG9mZnNldCwgbGVuZ3RoLCBlbmNvZGluZykge1xuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nKVxuICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICBlbmNvZGluZyA9ICd1dGY4J1xuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBlbmNvZGluZylcbiAgfSBlbHNlIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb2Zmc2V0ID09PSAnc3RyaW5nJykge1xuICAgIGVuY29kaW5nID0gb2Zmc2V0XG4gICAgbGVuZ3RoID0gdGhpcy5sZW5ndGhcbiAgICBvZmZzZXQgPSAwXG4gIC8vIEJ1ZmZlciN3cml0ZShzdHJpbmcsIG9mZnNldFssIGxlbmd0aF1bLCBlbmNvZGluZ10pXG4gIH0gZWxzZSBpZiAoaXNGaW5pdGUob2Zmc2V0KSkge1xuICAgIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgICBpZiAoaXNGaW5pdGUobGVuZ3RoKSkge1xuICAgICAgbGVuZ3RoID0gbGVuZ3RoIHwgMFxuICAgICAgaWYgKGVuY29kaW5nID09PSB1bmRlZmluZWQpIGVuY29kaW5nID0gJ3V0ZjgnXG4gICAgfSBlbHNlIHtcbiAgICAgIGVuY29kaW5nID0gbGVuZ3RoXG4gICAgICBsZW5ndGggPSB1bmRlZmluZWRcbiAgICB9XG4gIC8vIGxlZ2FjeSB3cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXQsIGxlbmd0aCkgLSByZW1vdmUgaW4gdjAuMTNcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnQnVmZmVyLndyaXRlKHN0cmluZywgZW5jb2RpbmcsIG9mZnNldFssIGxlbmd0aF0pIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQnXG4gICAgKVxuICB9XG5cbiAgdmFyIHJlbWFpbmluZyA9IHRoaXMubGVuZ3RoIC0gb2Zmc2V0XG4gIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCB8fCBsZW5ndGggPiByZW1haW5pbmcpIGxlbmd0aCA9IHJlbWFpbmluZ1xuXG4gIGlmICgoc3RyaW5nLmxlbmd0aCA+IDAgJiYgKGxlbmd0aCA8IDAgfHwgb2Zmc2V0IDwgMCkpIHx8IG9mZnNldCA+IHRoaXMubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gd3JpdGUgb3V0c2lkZSBidWZmZXIgYm91bmRzJylcbiAgfVxuXG4gIGlmICghZW5jb2RpbmcpIGVuY29kaW5nID0gJ3V0ZjgnXG5cbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcbiAgZm9yICg7Oykge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGF0aW4xV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgLy8gV2FybmluZzogbWF4TGVuZ3RoIG5vdCB0YWtlbiBpbnRvIGFjY291bnQgaW4gYmFzZTY0V3JpdGVcbiAgICAgICAgcmV0dXJuIGJhc2U2NFdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiB1Y3MyV3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gKCcnICsgZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gdG9KU09OICgpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnQnVmZmVyJyxcbiAgICBkYXRhOiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLl9hcnIgfHwgdGhpcywgMClcbiAgfVxufVxuXG5mdW5jdGlvbiBiYXNlNjRTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIGlmIChzdGFydCA9PT0gMCAmJiBlbmQgPT09IGJ1Zi5sZW5ndGgpIHtcbiAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmKVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBiYXNlNjQuZnJvbUJ5dGVBcnJheShidWYuc2xpY2Uoc3RhcnQsIGVuZCkpXG4gIH1cbn1cblxuZnVuY3Rpb24gdXRmOFNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuICB2YXIgcmVzID0gW11cblxuICB2YXIgaSA9IHN0YXJ0XG4gIHdoaWxlIChpIDwgZW5kKSB7XG4gICAgdmFyIGZpcnN0Qnl0ZSA9IGJ1ZltpXVxuICAgIHZhciBjb2RlUG9pbnQgPSBudWxsXG4gICAgdmFyIGJ5dGVzUGVyU2VxdWVuY2UgPSAoZmlyc3RCeXRlID4gMHhFRikgPyA0XG4gICAgICA6IChmaXJzdEJ5dGUgPiAweERGKSA/IDNcbiAgICAgIDogKGZpcnN0Qnl0ZSA+IDB4QkYpID8gMlxuICAgICAgOiAxXG5cbiAgICBpZiAoaSArIGJ5dGVzUGVyU2VxdWVuY2UgPD0gZW5kKSB7XG4gICAgICB2YXIgc2Vjb25kQnl0ZSwgdGhpcmRCeXRlLCBmb3VydGhCeXRlLCB0ZW1wQ29kZVBvaW50XG5cbiAgICAgIHN3aXRjaCAoYnl0ZXNQZXJTZXF1ZW5jZSkge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgaWYgKGZpcnN0Qnl0ZSA8IDB4ODApIHtcbiAgICAgICAgICAgIGNvZGVQb2ludCA9IGZpcnN0Qnl0ZVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV1cbiAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkge1xuICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweDFGKSA8PCAweDYgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpXG4gICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0YpIHtcbiAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV1cbiAgICAgICAgICB0aGlyZEJ5dGUgPSBidWZbaSArIDJdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwKSB7XG4gICAgICAgICAgICB0ZW1wQ29kZVBvaW50ID0gKGZpcnN0Qnl0ZSAmIDB4RikgPDwgMHhDIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweDYgfCAodGhpcmRCeXRlICYgMHgzRilcbiAgICAgICAgICAgIGlmICh0ZW1wQ29kZVBvaW50ID4gMHg3RkYgJiYgKHRlbXBDb2RlUG9pbnQgPCAweEQ4MDAgfHwgdGVtcENvZGVQb2ludCA+IDB4REZGRikpIHtcbiAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgc2Vjb25kQnl0ZSA9IGJ1ZltpICsgMV1cbiAgICAgICAgICB0aGlyZEJ5dGUgPSBidWZbaSArIDJdXG4gICAgICAgICAgZm91cnRoQnl0ZSA9IGJ1ZltpICsgM11cbiAgICAgICAgICBpZiAoKHNlY29uZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCAmJiAodGhpcmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKGZvdXJ0aEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkge1xuICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4MTIgfCAoc2Vjb25kQnl0ZSAmIDB4M0YpIDw8IDB4QyB8ICh0aGlyZEJ5dGUgJiAweDNGKSA8PCAweDYgfCAoZm91cnRoQnl0ZSAmIDB4M0YpXG4gICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4RkZGRiAmJiB0ZW1wQ29kZVBvaW50IDwgMHgxMTAwMDApIHtcbiAgICAgICAgICAgICAgY29kZVBvaW50ID0gdGVtcENvZGVQb2ludFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY29kZVBvaW50ID09PSBudWxsKSB7XG4gICAgICAvLyB3ZSBkaWQgbm90IGdlbmVyYXRlIGEgdmFsaWQgY29kZVBvaW50IHNvIGluc2VydCBhXG4gICAgICAvLyByZXBsYWNlbWVudCBjaGFyIChVK0ZGRkQpIGFuZCBhZHZhbmNlIG9ubHkgMSBieXRlXG4gICAgICBjb2RlUG9pbnQgPSAweEZGRkRcbiAgICAgIGJ5dGVzUGVyU2VxdWVuY2UgPSAxXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPiAweEZGRkYpIHtcbiAgICAgIC8vIGVuY29kZSB0byB1dGYxNiAoc3Vycm9nYXRlIHBhaXIgZGFuY2UpXG4gICAgICBjb2RlUG9pbnQgLT0gMHgxMDAwMFxuICAgICAgcmVzLnB1c2goY29kZVBvaW50ID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKVxuICAgICAgY29kZVBvaW50ID0gMHhEQzAwIHwgY29kZVBvaW50ICYgMHgzRkZcbiAgICB9XG5cbiAgICByZXMucHVzaChjb2RlUG9pbnQpXG4gICAgaSArPSBieXRlc1BlclNlcXVlbmNlXG4gIH1cblxuICByZXR1cm4gZGVjb2RlQ29kZVBvaW50c0FycmF5KHJlcylcbn1cblxuLy8gQmFzZWQgb24gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjI3NDcyNzIvNjgwNzQyLCB0aGUgYnJvd3NlciB3aXRoXG4vLyB0aGUgbG93ZXN0IGxpbWl0IGlzIENocm9tZSwgd2l0aCAweDEwMDAwIGFyZ3MuXG4vLyBXZSBnbyAxIG1hZ25pdHVkZSBsZXNzLCBmb3Igc2FmZXR5XG52YXIgTUFYX0FSR1VNRU5UU19MRU5HVEggPSAweDEwMDBcblxuZnVuY3Rpb24gZGVjb2RlQ29kZVBvaW50c0FycmF5IChjb2RlUG9pbnRzKSB7XG4gIHZhciBsZW4gPSBjb2RlUG9pbnRzLmxlbmd0aFxuICBpZiAobGVuIDw9IE1BWF9BUkdVTUVOVFNfTEVOR1RIKSB7XG4gICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLCBjb2RlUG9pbnRzKSAvLyBhdm9pZCBleHRyYSBzbGljZSgpXG4gIH1cblxuICAvLyBEZWNvZGUgaW4gY2h1bmtzIHRvIGF2b2lkIFwiY2FsbCBzdGFjayBzaXplIGV4Y2VlZGVkXCIuXG4gIHZhciByZXMgPSAnJ1xuICB2YXIgaSA9IDBcbiAgd2hpbGUgKGkgPCBsZW4pIHtcbiAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShcbiAgICAgIFN0cmluZyxcbiAgICAgIGNvZGVQb2ludHMuc2xpY2UoaSwgaSArPSBNQVhfQVJHVU1FTlRTX0xFTkdUSClcbiAgICApXG4gIH1cbiAgcmV0dXJuIHJlc1xufVxuXG5mdW5jdGlvbiBhc2NpaVNsaWNlIChidWYsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHJldCA9ICcnXG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcblxuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIHJldCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZltpXSAmIDB4N0YpXG4gIH1cbiAgcmV0dXJuIHJldFxufVxuXG5mdW5jdGlvbiBsYXRpbjFTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciByZXQgPSAnJ1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0pXG4gIH1cbiAgcmV0dXJuIHJldFxufVxuXG5mdW5jdGlvbiBoZXhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciBsZW4gPSBidWYubGVuZ3RoXG5cbiAgaWYgKCFzdGFydCB8fCBzdGFydCA8IDApIHN0YXJ0ID0gMFxuICBpZiAoIWVuZCB8fCBlbmQgPCAwIHx8IGVuZCA+IGxlbikgZW5kID0gbGVuXG5cbiAgdmFyIG91dCA9ICcnXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgb3V0ICs9IHRvSGV4KGJ1ZltpXSlcbiAgfVxuICByZXR1cm4gb3V0XG59XG5cbmZ1bmN0aW9uIHV0ZjE2bGVTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciBieXRlcyA9IGJ1Zi5zbGljZShzdGFydCwgZW5kKVxuICB2YXIgcmVzID0gJydcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkgKz0gMikge1xuICAgIHJlcyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGVzW2ldICsgYnl0ZXNbaSArIDFdICogMjU2KVxuICB9XG4gIHJldHVybiByZXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zbGljZSA9IGZ1bmN0aW9uIHNsaWNlIChzdGFydCwgZW5kKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBzdGFydCA9IH5+c3RhcnRcbiAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgPyBsZW4gOiB+fmVuZFxuXG4gIGlmIChzdGFydCA8IDApIHtcbiAgICBzdGFydCArPSBsZW5cbiAgICBpZiAoc3RhcnQgPCAwKSBzdGFydCA9IDBcbiAgfSBlbHNlIGlmIChzdGFydCA+IGxlbikge1xuICAgIHN0YXJ0ID0gbGVuXG4gIH1cblxuICBpZiAoZW5kIDwgMCkge1xuICAgIGVuZCArPSBsZW5cbiAgICBpZiAoZW5kIDwgMCkgZW5kID0gMFxuICB9IGVsc2UgaWYgKGVuZCA+IGxlbikge1xuICAgIGVuZCA9IGxlblxuICB9XG5cbiAgaWYgKGVuZCA8IHN0YXJ0KSBlbmQgPSBzdGFydFxuXG4gIHZhciBuZXdCdWZcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgbmV3QnVmID0gdGhpcy5zdWJhcnJheShzdGFydCwgZW5kKVxuICAgIG5ld0J1Zi5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIH0gZWxzZSB7XG4gICAgdmFyIHNsaWNlTGVuID0gZW5kIC0gc3RhcnRcbiAgICBuZXdCdWYgPSBuZXcgQnVmZmVyKHNsaWNlTGVuLCB1bmRlZmluZWQpXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzbGljZUxlbjsgKytpKSB7XG4gICAgICBuZXdCdWZbaV0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3QnVmXG59XG5cbi8qXG4gKiBOZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IGJ1ZmZlciBpc24ndCB0cnlpbmcgdG8gd3JpdGUgb3V0IG9mIGJvdW5kcy5cbiAqL1xuZnVuY3Rpb24gY2hlY2tPZmZzZXQgKG9mZnNldCwgZXh0LCBsZW5ndGgpIHtcbiAgaWYgKChvZmZzZXQgJSAxKSAhPT0gMCB8fCBvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignb2Zmc2V0IGlzIG5vdCB1aW50JylcbiAgaWYgKG9mZnNldCArIGV4dCA+IGxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1RyeWluZyB0byBhY2Nlc3MgYmV5b25kIGJ1ZmZlciBsZW5ndGgnKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50TEUgPSBmdW5jdGlvbiByZWFkVUludExFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgYnl0ZUxlbmd0aCwgdGhpcy5sZW5ndGgpXG5cbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0XVxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgd2hpbGUgKCsraSA8IGJ5dGVMZW5ndGggJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyBpXSAqIG11bFxuICB9XG5cbiAgcmV0dXJuIHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50QkUgPSBmdW5jdGlvbiByZWFkVUludEJFIChvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKVxuICB9XG5cbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXVxuICB2YXIgbXVsID0gMVxuICB3aGlsZSAoYnl0ZUxlbmd0aCA+IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyAtLWJ5dGVMZW5ndGhdICogbXVsXG4gIH1cblxuICByZXR1cm4gdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQ4ID0gZnVuY3Rpb24gcmVhZFVJbnQ4IChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiB0aGlzW29mZnNldF1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDE2TEUgPSBmdW5jdGlvbiByZWFkVUludDE2TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIHRoaXNbb2Zmc2V0XSB8ICh0aGlzW29mZnNldCArIDFdIDw8IDgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkJFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiAodGhpc1tvZmZzZXRdIDw8IDgpIHwgdGhpc1tvZmZzZXQgKyAxXVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MzJMRSA9IGZ1bmN0aW9uIHJlYWRVSW50MzJMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDQsIHRoaXMubGVuZ3RoKVxuXG4gIHJldHVybiAoKHRoaXNbb2Zmc2V0XSkgfFxuICAgICAgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOCkgfFxuICAgICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpKSArXG4gICAgICAodGhpc1tvZmZzZXQgKyAzXSAqIDB4MTAwMDAwMClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyQkUgPSBmdW5jdGlvbiByZWFkVUludDMyQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcblxuICByZXR1cm4gKHRoaXNbb2Zmc2V0XSAqIDB4MTAwMDAwMCkgK1xuICAgICgodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDgpIHxcbiAgICB0aGlzW29mZnNldCArIDNdKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnRMRSA9IGZ1bmN0aW9uIHJlYWRJbnRMRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldF1cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWxcbiAgfVxuICBtdWwgKj0gMHg4MFxuXG4gIGlmICh2YWwgPj0gbXVsKSB2YWwgLT0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpXG5cbiAgcmV0dXJuIHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnRCRSA9IGZ1bmN0aW9uIHJlYWRJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKVxuXG4gIHZhciBpID0gYnl0ZUxlbmd0aFxuICB2YXIgbXVsID0gMVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAtLWldXG4gIHdoaWxlIChpID4gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIC0taV0gKiBtdWxcbiAgfVxuICBtdWwgKj0gMHg4MFxuXG4gIGlmICh2YWwgPj0gbXVsKSB2YWwgLT0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpXG5cbiAgcmV0dXJuIHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQ4ID0gZnVuY3Rpb24gcmVhZEludDggKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAxLCB0aGlzLmxlbmd0aClcbiAgaWYgKCEodGhpc1tvZmZzZXRdICYgMHg4MCkpIHJldHVybiAodGhpc1tvZmZzZXRdKVxuICByZXR1cm4gKCgweGZmIC0gdGhpc1tvZmZzZXRdICsgMSkgKiAtMSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MTZMRSA9IGZ1bmN0aW9uIHJlYWRJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KVxuICByZXR1cm4gKHZhbCAmIDB4ODAwMCkgPyB2YWwgfCAweEZGRkYwMDAwIDogdmFsXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2QkUgPSBmdW5jdGlvbiByZWFkSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXQgKyAxXSB8ICh0aGlzW29mZnNldF0gPDwgOClcbiAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkxFID0gZnVuY3Rpb24gcmVhZEludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcblxuICByZXR1cm4gKHRoaXNbb2Zmc2V0XSkgfFxuICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCAxNikgfFxuICAgICh0aGlzW29mZnNldCArIDNdIDw8IDI0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQzMkJFID0gZnVuY3Rpb24gcmVhZEludDMyQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcblxuICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCAyNCkgfFxuICAgICh0aGlzW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgOCkgfFxuICAgICh0aGlzW29mZnNldCArIDNdKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRGbG9hdExFID0gZnVuY3Rpb24gcmVhZEZsb2F0TEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIHRydWUsIDIzLCA0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRGbG9hdEJFID0gZnVuY3Rpb24gcmVhZEZsb2F0QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCAyMywgNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlTEUgPSBmdW5jdGlvbiByZWFkRG91YmxlTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIHRydWUsIDUyLCA4KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWREb3VibGVCRSA9IGZ1bmN0aW9uIHJlYWREb3VibGVCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDgsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gaWVlZTc1NC5yZWFkKHRoaXMsIG9mZnNldCwgZmFsc2UsIDUyLCA4KVxufVxuXG5mdW5jdGlvbiBjaGVja0ludCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBleHQsIG1heCwgbWluKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiYnVmZmVyXCIgYXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciBpbnN0YW5jZScpXG4gIGlmICh2YWx1ZSA+IG1heCB8fCB2YWx1ZSA8IG1pbikgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1widmFsdWVcIiBhcmd1bWVudCBpcyBvdXQgb2YgYm91bmRzJylcbiAgaWYgKG9mZnNldCArIGV4dCA+IGJ1Zi5sZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludExFID0gZnVuY3Rpb24gd3JpdGVVSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICB2YXIgbWF4Qnl0ZXMgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkgLSAxXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbWF4Qnl0ZXMsIDApXG4gIH1cblxuICB2YXIgbXVsID0gMVxuICB2YXIgaSA9IDBcbiAgdGhpc1tvZmZzZXRdID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludEJFID0gZnVuY3Rpb24gd3JpdGVVSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggfCAwXG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICB2YXIgbWF4Qnl0ZXMgPSBNYXRoLnBvdygyLCA4ICogYnl0ZUxlbmd0aCkgLSAxXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbWF4Qnl0ZXMsIDApXG4gIH1cblxuICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxXG4gIHZhciBtdWwgPSAxXG4gIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICh2YWx1ZSAvIG11bCkgJiAweEZGXG4gIH1cblxuICByZXR1cm4gb2Zmc2V0ICsgYnl0ZUxlbmd0aFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDggPSBmdW5jdGlvbiB3cml0ZVVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4ZmYsIDApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHZhbHVlID0gTWF0aC5mbG9vcih2YWx1ZSlcbiAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgcmV0dXJuIG9mZnNldCArIDFcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MTYgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmICsgdmFsdWUgKyAxXG4gIGZvciAodmFyIGkgPSAwLCBqID0gTWF0aC5taW4oYnVmLmxlbmd0aCAtIG9mZnNldCwgMik7IGkgPCBqOyArK2kpIHtcbiAgICBidWZbb2Zmc2V0ICsgaV0gPSAodmFsdWUgJiAoMHhmZiA8PCAoOCAqIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpKSkpID4+PlxuICAgICAgKGxpdHRsZUVuZGlhbiA/IGkgOiAxIC0gaSkgKiA4XG4gIH1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVVSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweGZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuZnVuY3Rpb24gb2JqZWN0V3JpdGVVSW50MzIgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuKSB7XG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZmZmZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDQpOyBpIDwgajsgKytpKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlID4+PiAobGl0dGxlRW5kaWFuID8gaSA6IDMgLSBpKSAqIDgpICYgMHhmZlxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVVSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweGZmZmZmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludExFID0gZnVuY3Rpb24gd3JpdGVJbnRMRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKVxuXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbGltaXQgLSAxLCAtbGltaXQpXG4gIH1cblxuICB2YXIgaSA9IDBcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHN1YiA9IDBcbiAgdGhpc1tvZmZzZXRdID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgaWYgKHZhbHVlIDwgMCAmJiBzdWIgPT09IDAgJiYgdGhpc1tvZmZzZXQgKyBpIC0gMV0gIT09IDApIHtcbiAgICAgIHN1YiA9IDFcbiAgICB9XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICgodmFsdWUgLyBtdWwpID4+IDApIC0gc3ViICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludEJFID0gZnVuY3Rpb24gd3JpdGVJbnRCRSAodmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIGxpbWl0ID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGggLSAxKVxuXG4gICAgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgYnl0ZUxlbmd0aCwgbGltaXQgLSAxLCAtbGltaXQpXG4gIH1cblxuICB2YXIgaSA9IGJ5dGVMZW5ndGggLSAxXG4gIHZhciBtdWwgPSAxXG4gIHZhciBzdWIgPSAwXG4gIHRoaXNbb2Zmc2V0ICsgaV0gPSB2YWx1ZSAmIDB4RkZcbiAgd2hpbGUgKC0taSA+PSAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgaWYgKHZhbHVlIDwgMCAmJiBzdWIgPT09IDAgJiYgdGhpc1tvZmZzZXQgKyBpICsgMV0gIT09IDApIHtcbiAgICAgIHN1YiA9IDFcbiAgICB9XG4gICAgdGhpc1tvZmZzZXQgKyBpXSA9ICgodmFsdWUgLyBtdWwpID4+IDApIC0gc3ViICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDggPSBmdW5jdGlvbiB3cml0ZUludDggKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMSwgMHg3ZiwgLTB4ODApXG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHZhbHVlID0gTWF0aC5mbG9vcih2YWx1ZSlcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmICsgdmFsdWUgKyAxXG4gIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIHJldHVybiBvZmZzZXQgKyAxXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkxFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiA4KVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZUludDE2QkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHg3ZmZmLCAtMHg4MDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UpXG4gIH1cbiAgcmV0dXJuIG9mZnNldCArIDJcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUludDMyTEUgPSBmdW5jdGlvbiB3cml0ZUludDMyTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHg3ZmZmZmZmZiwgLTB4ODAwMDAwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlID4+PiAyNClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkJFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKVxuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDFcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbmZ1bmN0aW9uIGNoZWNrSUVFRTc1NCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBleHQsIG1heCwgbWluKSB7XG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbiAgaWYgKG9mZnNldCA8IDApIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbmRleCBvdXQgb2YgcmFuZ2UnKVxufVxuXG5mdW5jdGlvbiB3cml0ZUZsb2F0IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrSUVFRTc1NChidWYsIHZhbHVlLCBvZmZzZXQsIDQsIDMuNDAyODIzNDY2Mzg1Mjg4NmUrMzgsIC0zLjQwMjgyMzQ2NjM4NTI4ODZlKzM4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDIzLCA0KVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRMRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVGbG9hdEJFID0gZnVuY3Rpb24gd3JpdGVGbG9hdEJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVGbG9hdCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbmZ1bmN0aW9uIHdyaXRlRG91YmxlIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIGNoZWNrSUVFRTc1NChidWYsIHZhbHVlLCBvZmZzZXQsIDgsIDEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4LCAtMS43OTc2OTMxMzQ4NjIzMTU3RSszMDgpXG4gIH1cbiAgaWVlZTc1NC53cml0ZShidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbiwgNTIsIDgpXG4gIHJldHVybiBvZmZzZXQgKyA4XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVMRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlTEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlLCBub0Fzc2VydClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZURvdWJsZUJFID0gZnVuY3Rpb24gd3JpdGVEb3VibGVCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRG91YmxlKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlLCBub0Fzc2VydClcbn1cblxuLy8gY29weSh0YXJnZXRCdWZmZXIsIHRhcmdldFN0YXJ0PTAsIHNvdXJjZVN0YXJ0PTAsIHNvdXJjZUVuZD1idWZmZXIubGVuZ3RoKVxuQnVmZmVyLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gY29weSAodGFyZ2V0LCB0YXJnZXRTdGFydCwgc3RhcnQsIGVuZCkge1xuICBpZiAoIXN0YXJ0KSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgJiYgZW5kICE9PSAwKSBlbmQgPSB0aGlzLmxlbmd0aFxuICBpZiAodGFyZ2V0U3RhcnQgPj0gdGFyZ2V0Lmxlbmd0aCkgdGFyZ2V0U3RhcnQgPSB0YXJnZXQubGVuZ3RoXG4gIGlmICghdGFyZ2V0U3RhcnQpIHRhcmdldFN0YXJ0ID0gMFxuICBpZiAoZW5kID4gMCAmJiBlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICAvLyBDb3B5IDAgYnl0ZXM7IHdlJ3JlIGRvbmVcbiAgaWYgKGVuZCA9PT0gc3RhcnQpIHJldHVybiAwXG4gIGlmICh0YXJnZXQubGVuZ3RoID09PSAwIHx8IHRoaXMubGVuZ3RoID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIEZhdGFsIGVycm9yIGNvbmRpdGlvbnNcbiAgaWYgKHRhcmdldFN0YXJ0IDwgMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCd0YXJnZXRTdGFydCBvdXQgb2YgYm91bmRzJylcbiAgfVxuICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID49IHRoaXMubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlU3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChlbmQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignc291cmNlRW5kIG91dCBvZiBib3VuZHMnKVxuXG4gIC8vIEFyZSB3ZSBvb2I/XG4gIGlmIChlbmQgPiB0aGlzLmxlbmd0aCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCA8IGVuZCAtIHN0YXJ0KSB7XG4gICAgZW5kID0gdGFyZ2V0Lmxlbmd0aCAtIHRhcmdldFN0YXJ0ICsgc3RhcnRcbiAgfVxuXG4gIHZhciBsZW4gPSBlbmQgLSBzdGFydFxuICB2YXIgaVxuXG4gIGlmICh0aGlzID09PSB0YXJnZXQgJiYgc3RhcnQgPCB0YXJnZXRTdGFydCAmJiB0YXJnZXRTdGFydCA8IGVuZCkge1xuICAgIC8vIGRlc2NlbmRpbmcgY29weSBmcm9tIGVuZFxuICAgIGZvciAoaSA9IGxlbiAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIGlmIChsZW4gPCAxMDAwIHx8ICFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIC8vIGFzY2VuZGluZyBjb3B5IGZyb20gc3RhcnRcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgIHRhcmdldFtpICsgdGFyZ2V0U3RhcnRdID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIFVpbnQ4QXJyYXkucHJvdG90eXBlLnNldC5jYWxsKFxuICAgICAgdGFyZ2V0LFxuICAgICAgdGhpcy5zdWJhcnJheShzdGFydCwgc3RhcnQgKyBsZW4pLFxuICAgICAgdGFyZ2V0U3RhcnRcbiAgICApXG4gIH1cblxuICByZXR1cm4gbGVuXG59XG5cbi8vIFVzYWdlOlxuLy8gICAgYnVmZmVyLmZpbGwobnVtYmVyWywgb2Zmc2V0WywgZW5kXV0pXG4vLyAgICBidWZmZXIuZmlsbChidWZmZXJbLCBvZmZzZXRbLCBlbmRdXSlcbi8vICAgIGJ1ZmZlci5maWxsKHN0cmluZ1ssIG9mZnNldFssIGVuZF1dWywgZW5jb2RpbmddKVxuQnVmZmVyLnByb3RvdHlwZS5maWxsID0gZnVuY3Rpb24gZmlsbCAodmFsLCBzdGFydCwgZW5kLCBlbmNvZGluZykge1xuICAvLyBIYW5kbGUgc3RyaW5nIGNhc2VzOlxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAodHlwZW9mIHN0YXJ0ID09PSAnc3RyaW5nJykge1xuICAgICAgZW5jb2RpbmcgPSBzdGFydFxuICAgICAgc3RhcnQgPSAwXG4gICAgICBlbmQgPSB0aGlzLmxlbmd0aFxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGVuZCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVuY29kaW5nID0gZW5kXG4gICAgICBlbmQgPSB0aGlzLmxlbmd0aFxuICAgIH1cbiAgICBpZiAodmFsLmxlbmd0aCA9PT0gMSkge1xuICAgICAgdmFyIGNvZGUgPSB2YWwuY2hhckNvZGVBdCgwKVxuICAgICAgaWYgKGNvZGUgPCAyNTYpIHtcbiAgICAgICAgdmFsID0gY29kZVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZW5jb2RpbmcgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgZW5jb2RpbmcgIT09ICdzdHJpbmcnKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdlbmNvZGluZyBtdXN0IGJlIGEgc3RyaW5nJylcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycgJiYgIUJ1ZmZlci5pc0VuY29kaW5nKGVuY29kaW5nKSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgIH1cbiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xuICAgIHZhbCA9IHZhbCAmIDI1NVxuICB9XG5cbiAgLy8gSW52YWxpZCByYW5nZXMgYXJlIG5vdCBzZXQgdG8gYSBkZWZhdWx0LCBzbyBjYW4gcmFuZ2UgY2hlY2sgZWFybHkuXG4gIGlmIChzdGFydCA8IDAgfHwgdGhpcy5sZW5ndGggPCBzdGFydCB8fCB0aGlzLmxlbmd0aCA8IGVuZCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdPdXQgb2YgcmFuZ2UgaW5kZXgnKVxuICB9XG5cbiAgaWYgKGVuZCA8PSBzdGFydCkge1xuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBzdGFydCA9IHN0YXJ0ID4+PiAwXG4gIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5sZW5ndGggOiBlbmQgPj4+IDBcblxuICBpZiAoIXZhbCkgdmFsID0gMFxuXG4gIHZhciBpXG4gIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xuICAgIGZvciAoaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICAgIHRoaXNbaV0gPSB2YWxcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdmFyIGJ5dGVzID0gQnVmZmVyLmlzQnVmZmVyKHZhbClcbiAgICAgID8gdmFsXG4gICAgICA6IHV0ZjhUb0J5dGVzKG5ldyBCdWZmZXIodmFsLCBlbmNvZGluZykudG9TdHJpbmcoKSlcbiAgICB2YXIgbGVuID0gYnl0ZXMubGVuZ3RoXG4gICAgZm9yIChpID0gMDsgaSA8IGVuZCAtIHN0YXJ0OyArK2kpIHtcbiAgICAgIHRoaXNbaSArIHN0YXJ0XSA9IGJ5dGVzW2kgJSBsZW5dXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXNcbn1cblxuLy8gSEVMUEVSIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PVxuXG52YXIgSU5WQUxJRF9CQVNFNjRfUkUgPSAvW14rXFwvMC05QS1aYS16LV9dL2dcblxuZnVuY3Rpb24gYmFzZTY0Y2xlYW4gKHN0cikge1xuICAvLyBOb2RlIHN0cmlwcyBvdXQgaW52YWxpZCBjaGFyYWN0ZXJzIGxpa2UgXFxuIGFuZCBcXHQgZnJvbSB0aGUgc3RyaW5nLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgc3RyID0gc3RyaW5ndHJpbShzdHIpLnJlcGxhY2UoSU5WQUxJRF9CQVNFNjRfUkUsICcnKVxuICAvLyBOb2RlIGNvbnZlcnRzIHN0cmluZ3Mgd2l0aCBsZW5ndGggPCAyIHRvICcnXG4gIGlmIChzdHIubGVuZ3RoIDwgMikgcmV0dXJuICcnXG4gIC8vIE5vZGUgYWxsb3dzIGZvciBub24tcGFkZGVkIGJhc2U2NCBzdHJpbmdzIChtaXNzaW5nIHRyYWlsaW5nID09PSksIGJhc2U2NC1qcyBkb2VzIG5vdFxuICB3aGlsZSAoc3RyLmxlbmd0aCAlIDQgIT09IDApIHtcbiAgICBzdHIgPSBzdHIgKyAnPSdcbiAgfVxuICByZXR1cm4gc3RyXG59XG5cbmZ1bmN0aW9uIHN0cmluZ3RyaW0gKHN0cikge1xuICBpZiAoc3RyLnRyaW0pIHJldHVybiBzdHIudHJpbSgpXG4gIHJldHVybiBzdHIucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpXG59XG5cbmZ1bmN0aW9uIHRvSGV4IChuKSB7XG4gIGlmIChuIDwgMTYpIHJldHVybiAnMCcgKyBuLnRvU3RyaW5nKDE2KVxuICByZXR1cm4gbi50b1N0cmluZygxNilcbn1cblxuZnVuY3Rpb24gdXRmOFRvQnl0ZXMgKHN0cmluZywgdW5pdHMpIHtcbiAgdW5pdHMgPSB1bml0cyB8fCBJbmZpbml0eVxuICB2YXIgY29kZVBvaW50XG4gIHZhciBsZW5ndGggPSBzdHJpbmcubGVuZ3RoXG4gIHZhciBsZWFkU3Vycm9nYXRlID0gbnVsbFxuICB2YXIgYnl0ZXMgPSBbXVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICBjb2RlUG9pbnQgPSBzdHJpbmcuY2hhckNvZGVBdChpKVxuXG4gICAgLy8gaXMgc3Vycm9nYXRlIGNvbXBvbmVudFxuICAgIGlmIChjb2RlUG9pbnQgPiAweEQ3RkYgJiYgY29kZVBvaW50IDwgMHhFMDAwKSB7XG4gICAgICAvLyBsYXN0IGNoYXIgd2FzIGEgbGVhZFxuICAgICAgaWYgKCFsZWFkU3Vycm9nYXRlKSB7XG4gICAgICAgIC8vIG5vIGxlYWQgeWV0XG4gICAgICAgIGlmIChjb2RlUG9pbnQgPiAweERCRkYpIHtcbiAgICAgICAgICAvLyB1bmV4cGVjdGVkIHRyYWlsXG4gICAgICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfSBlbHNlIGlmIChpICsgMSA9PT0gbGVuZ3RoKSB7XG4gICAgICAgICAgLy8gdW5wYWlyZWQgbGVhZFxuICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cblxuICAgICAgICAvLyB2YWxpZCBsZWFkXG4gICAgICAgIGxlYWRTdXJyb2dhdGUgPSBjb2RlUG9pbnRcblxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICAvLyAyIGxlYWRzIGluIGEgcm93XG4gICAgICBpZiAoY29kZVBvaW50IDwgMHhEQzAwKSB7XG4gICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIC8vIHZhbGlkIHN1cnJvZ2F0ZSBwYWlyXG4gICAgICBjb2RlUG9pbnQgPSAobGVhZFN1cnJvZ2F0ZSAtIDB4RDgwMCA8PCAxMCB8IGNvZGVQb2ludCAtIDB4REMwMCkgKyAweDEwMDAwXG4gICAgfSBlbHNlIGlmIChsZWFkU3Vycm9nYXRlKSB7XG4gICAgICAvLyB2YWxpZCBibXAgY2hhciwgYnV0IGxhc3QgY2hhciB3YXMgYSBsZWFkXG4gICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICB9XG5cbiAgICBsZWFkU3Vycm9nYXRlID0gbnVsbFxuXG4gICAgLy8gZW5jb2RlIHV0ZjhcbiAgICBpZiAoY29kZVBvaW50IDwgMHg4MCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAxKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKGNvZGVQb2ludClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4ODAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgfCAweEMwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMDAwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAzKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHhDIHwgMHhFMCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4NiAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgJiAweDNGIHwgMHg4MFxuICAgICAgKVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50IDwgMHgxMTAwMDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gNCkgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4MTIgfCAweEYwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHhDICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvZGUgcG9pbnQnKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBieXRlc1xufVxuXG5mdW5jdGlvbiBhc2NpaVRvQnl0ZXMgKHN0cikge1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHtcbiAgICAvLyBOb2RlJ3MgY29kZSBzZWVtcyB0byBiZSBkb2luZyB0aGlzIGFuZCBub3QgJiAweDdGLi5cbiAgICBieXRlQXJyYXkucHVzaChzdHIuY2hhckNvZGVBdChpKSAmIDB4RkYpXG4gIH1cbiAgcmV0dXJuIGJ5dGVBcnJheVxufVxuXG5mdW5jdGlvbiB1dGYxNmxlVG9CeXRlcyAoc3RyLCB1bml0cykge1xuICB2YXIgYywgaGksIGxvXG4gIHZhciBieXRlQXJyYXkgPSBbXVxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkge1xuICAgIGlmICgodW5pdHMgLT0gMikgPCAwKSBicmVha1xuXG4gICAgYyA9IHN0ci5jaGFyQ29kZUF0KGkpXG4gICAgaGkgPSBjID4+IDhcbiAgICBsbyA9IGMgJSAyNTZcbiAgICBieXRlQXJyYXkucHVzaChsbylcbiAgICBieXRlQXJyYXkucHVzaChoaSlcbiAgfVxuXG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gYmFzZTY0VG9CeXRlcyAoc3RyKSB7XG4gIHJldHVybiBiYXNlNjQudG9CeXRlQXJyYXkoYmFzZTY0Y2xlYW4oc3RyKSlcbn1cblxuZnVuY3Rpb24gYmxpdEJ1ZmZlciAoc3JjLCBkc3QsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoKGkgKyBvZmZzZXQgPj0gZHN0Lmxlbmd0aCkgfHwgKGkgPj0gc3JjLmxlbmd0aCkpIGJyZWFrXG4gICAgZHN0W2kgKyBvZmZzZXRdID0gc3JjW2ldXG4gIH1cbiAgcmV0dXJuIGlcbn1cblxuZnVuY3Rpb24gaXNuYW4gKHZhbCkge1xuICByZXR1cm4gdmFsICE9PSB2YWwgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1zZWxmLWNvbXBhcmVcbn1cbiIsImV4cG9ydHMucmVhZCA9IGZ1bmN0aW9uIChidWZmZXIsIG9mZnNldCwgaXNMRSwgbUxlbiwgbkJ5dGVzKSB7XG4gIHZhciBlLCBtXG4gIHZhciBlTGVuID0gbkJ5dGVzICogOCAtIG1MZW4gLSAxXG4gIHZhciBlTWF4ID0gKDEgPDwgZUxlbikgLSAxXG4gIHZhciBlQmlhcyA9IGVNYXggPj4gMVxuICB2YXIgbkJpdHMgPSAtN1xuICB2YXIgaSA9IGlzTEUgPyAobkJ5dGVzIC0gMSkgOiAwXG4gIHZhciBkID0gaXNMRSA/IC0xIDogMVxuICB2YXIgcyA9IGJ1ZmZlcltvZmZzZXQgKyBpXVxuXG4gIGkgKz0gZFxuXG4gIGUgPSBzICYgKCgxIDw8ICgtbkJpdHMpKSAtIDEpXG4gIHMgPj49ICgtbkJpdHMpXG4gIG5CaXRzICs9IGVMZW5cbiAgZm9yICg7IG5CaXRzID4gMDsgZSA9IGUgKiAyNTYgKyBidWZmZXJbb2Zmc2V0ICsgaV0sIGkgKz0gZCwgbkJpdHMgLT0gOCkge31cblxuICBtID0gZSAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKVxuICBlID4+PSAoLW5CaXRzKVxuICBuQml0cyArPSBtTGVuXG4gIGZvciAoOyBuQml0cyA+IDA7IG0gPSBtICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9XG5cbiAgaWYgKGUgPT09IDApIHtcbiAgICBlID0gMSAtIGVCaWFzXG4gIH0gZWxzZSBpZiAoZSA9PT0gZU1heCkge1xuICAgIHJldHVybiBtID8gTmFOIDogKChzID8gLTEgOiAxKSAqIEluZmluaXR5KVxuICB9IGVsc2Uge1xuICAgIG0gPSBtICsgTWF0aC5wb3coMiwgbUxlbilcbiAgICBlID0gZSAtIGVCaWFzXG4gIH1cbiAgcmV0dXJuIChzID8gLTEgOiAxKSAqIG0gKiBNYXRoLnBvdygyLCBlIC0gbUxlbilcbn1cblxuZXhwb3J0cy53cml0ZSA9IGZ1bmN0aW9uIChidWZmZXIsIHZhbHVlLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICB2YXIgZSwgbSwgY1xuICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMVxuICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMVxuICB2YXIgZUJpYXMgPSBlTWF4ID4+IDFcbiAgdmFyIHJ0ID0gKG1MZW4gPT09IDIzID8gTWF0aC5wb3coMiwgLTI0KSAtIE1hdGgucG93KDIsIC03NykgOiAwKVxuICB2YXIgaSA9IGlzTEUgPyAwIDogKG5CeXRlcyAtIDEpXG4gIHZhciBkID0gaXNMRSA/IDEgOiAtMVxuICB2YXIgcyA9IHZhbHVlIDwgMCB8fCAodmFsdWUgPT09IDAgJiYgMSAvIHZhbHVlIDwgMCkgPyAxIDogMFxuXG4gIHZhbHVlID0gTWF0aC5hYnModmFsdWUpXG5cbiAgaWYgKGlzTmFOKHZhbHVlKSB8fCB2YWx1ZSA9PT0gSW5maW5pdHkpIHtcbiAgICBtID0gaXNOYU4odmFsdWUpID8gMSA6IDBcbiAgICBlID0gZU1heFxuICB9IGVsc2Uge1xuICAgIGUgPSBNYXRoLmZsb29yKE1hdGgubG9nKHZhbHVlKSAvIE1hdGguTE4yKVxuICAgIGlmICh2YWx1ZSAqIChjID0gTWF0aC5wb3coMiwgLWUpKSA8IDEpIHtcbiAgICAgIGUtLVxuICAgICAgYyAqPSAyXG4gICAgfVxuICAgIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgdmFsdWUgKz0gcnQgLyBjXG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlICs9IHJ0ICogTWF0aC5wb3coMiwgMSAtIGVCaWFzKVxuICAgIH1cbiAgICBpZiAodmFsdWUgKiBjID49IDIpIHtcbiAgICAgIGUrK1xuICAgICAgYyAvPSAyXG4gICAgfVxuXG4gICAgaWYgKGUgKyBlQmlhcyA+PSBlTWF4KSB7XG4gICAgICBtID0gMFxuICAgICAgZSA9IGVNYXhcbiAgICB9IGVsc2UgaWYgKGUgKyBlQmlhcyA+PSAxKSB7XG4gICAgICBtID0gKHZhbHVlICogYyAtIDEpICogTWF0aC5wb3coMiwgbUxlbilcbiAgICAgIGUgPSBlICsgZUJpYXNcbiAgICB9IGVsc2Uge1xuICAgICAgbSA9IHZhbHVlICogTWF0aC5wb3coMiwgZUJpYXMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pXG4gICAgICBlID0gMFxuICAgIH1cbiAgfVxuXG4gIGZvciAoOyBtTGVuID49IDg7IGJ1ZmZlcltvZmZzZXQgKyBpXSA9IG0gJiAweGZmLCBpICs9IGQsIG0gLz0gMjU2LCBtTGVuIC09IDgpIHt9XG5cbiAgZSA9IChlIDw8IG1MZW4pIHwgbVxuICBlTGVuICs9IG1MZW5cbiAgZm9yICg7IGVMZW4gPiAwOyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBlICYgMHhmZiwgaSArPSBkLCBlIC89IDI1NiwgZUxlbiAtPSA4KSB7fVxuXG4gIGJ1ZmZlcltvZmZzZXQgKyBpIC0gZF0gfD0gcyAqIDEyOFxufVxuIiwidmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cbm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYXJyKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuXG5sZXQgUmVzdWx0U3RhdHVzID0ge1xuICBXSU46IDIsXG4gIERSQVc6IDEsXG4gIExPU0U6IDAsXG59O1xuXG5cbmxldCBHYW1lUmVzdWx0ID0gY2MuQ2xhc3Moe1xuICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgcHJvcGVydGllczoge1xuICAgIHdpbk5vZGU6IGNjLk5vZGUsXG4gICAgbG9zZU5vZGU6IGNjLk5vZGUsXG4gICAgZHJhd05vZGU6IGNjLk5vZGUsXG4gICAgY29udGVudE5vZGU6IGNjLk5vZGUsXG5cbiAgICByZXN1bHRJdGVtczogW2NjLk5vZGVdLFxuXG4gICAgX2Rlc2tJbmZvOiBudWxsLFxuICAgIF91c2VySWQ6IG51bGwsXG4gICAgX2Nsb3NlQ2FsbGJhY2s6IG51bGwsXG4gIH0sXG5cbiAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuX2hpZGVSZXN1bHRJdGVtcygpO1xuICB9LFxuXG4gIHNob3dSZXN1bHRzOiBmdW5jdGlvbiAoZGVza0luZm8sIGN1cnJlbnRVc2VySWQpIHtcbiAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xuICAgIHRoaXMuX3VzZXJJZCA9IGN1cnJlbnRVc2VySWQ7XG5cbiAgICBsZXQgcmVzdWx0U3RhdHVzID0gdGhpcy5fcmVzdWx0U3RhdHVzKCk7XG4gICAgdGhpcy5jb250ZW50Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgIHRoaXMud2luTm9kZS5hY3RpdmUgPSAgKHJlc3VsdFN0YXR1cyA9PSBSZXN1bHRTdGF0dXMuV0lOKTtcbiAgICB0aGlzLmRyYXdOb2RlLmFjdGl2ZSA9IChyZXN1bHRTdGF0dXMgPT0gUmVzdWx0U3RhdHVzLkRSQVcpO1xuICAgIHRoaXMubG9zZU5vZGUuYWN0aXZlID0gKHJlc3VsdFN0YXR1cyA9PSBSZXN1bHRTdGF0dXMuTE9TRSk7XG5cbiAgICBpZiAodGhpcy53aW5Ob2RlLmFjdGl2ZSkge1xuICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlXaW4oKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMubG9zZU5vZGUuYWN0aXZlKSB7XG4gICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUxvc2UoKTtcbiAgICB9XG5cbiAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XG4gICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5zZXREaXNtaXNzQ2FsbGJhY2soZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fY2xvc2VDYWxsYmFja1xuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICBsZXQgcGxheWVySW5mb3MgPSBkZXNrSW5mby5wbGF5ZXJzLnNvcnQoZnVuY3Rpb24gKHAxLCBwMikge1xuICAgICAgcmV0dXJuIHAyLmNTY29yZSAtIHAxLmNTY29yZTtcbiAgICB9KTtcbiAgICBsZXQgaXRlbUNvbXBzID0gdGhpcy5yZXN1bHRJdGVtcy5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIHJldHVybiBub2RlLmdldENvbXBvbmVudCgnUmVzdWx0SXRlbScpO1xuICAgIH0pO1xuICAgIGl0ZW1Db21wcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtQ29tcCwgaW5kZXgpIHtcbiAgICAgIGl0ZW1Db21wLm5vZGUuYWN0aXZlID0gaW5kZXggPCBwbGF5ZXJJbmZvcy5sZW5ndGg7XG4gICAgICBpZiAoIWl0ZW1Db21wLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IHVzZXIgPSBwbGF5ZXJJbmZvc1tpbmRleF07XG4gICAgICBpdGVtQ29tcC51cGRhdGVXaXRoUGxheWVySW5mbyh1c2VyLCBkZXNrSW5mby5pc1JhbmRvbURlc2spO1xuICAgICAgbGV0IGNhcmRzID0gdGhpcy5fY2FyZHNGcm9tVXNlcih1c2VyKTtcbiAgICAgIGl0ZW1Db21wLnNldENhcmRzKGNhcmRzKTtcbiAgICB9LmJpbmQodGhpcykpO1xuICB9LFxuXG4gIHNldENsb3NlQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIHRoaXMuX2Nsb3NlQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgfSxcblxuICBfY2FyZHNGcm9tVXNlcjogZnVuY3Rpb24gKHVzZXIpIHtcbiAgICBsZXQgY2FyZHMgPSB1c2VyLmNhcmRJbmZvLm1hcChmdW5jdGlvbiAoY2FyZEluZm9JdGVtKSB7XG4gICAgICByZXR1cm4gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRJbmZvSXRlbS5jYXJkcyk7XG4gICAgfSkucmVkdWNlKGZ1bmN0aW9uIChhcnJheSwgc3ViQ2FyZHMpIHtcbiAgICAgIHJldHVybiBhcnJheS5jb25jYXQoc3ViQ2FyZHMpO1xuICAgIH0sIFtdKTtcblxuICAgIHJldHVybiBjYXJkcztcbiAgfSxcblxuICBfaGlkZVJlc3VsdEl0ZW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5yZXN1bHRJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICBub2RlLmFjaXR2ZSA9IGZhbHNlO1xuICAgIH0pO1xuICB9LFxuXG4gIF9yZXN1bHRTdGF0dXM6IGZ1bmN0aW9uKCkge1xuICAgIGxldCBwbGF5ZXJJbmZvcyA9IHRoaXMuX2Rlc2tJbmZvLnBsYXllcnM7XG4gICAgbGV0IHVzZXIgPSBwbGF5ZXJJbmZvcy5maW5kKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICByZXR1cm4gdXNlci5pZCA9PSB0aGlzLl91c2VySWQ7XG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIGxldCBzY29yZSA9IHVzZXIuY1Njb3JlO1xuICAgIGlmICh0aGlzLl9kZXNrSW5mby5pc1JhbmRvbURlc2spIHtcbiAgICAgIC8vIOWmguaenOaYr+maj+acuuWcuueahOivne+8jOW6lOivpeeUqOmSu+efs+adpeWIpOaWrei+k+i1olxuICAgICAgc2NvcmUgPSB1c2VyLmRpYW1vbmQ7XG4gICAgfVxuXG4gICAgaWYgKHNjb3JlID4gMCkge1xuICAgICAgcmV0dXJuIFJlc3VsdFN0YXR1cy5XSU47XG4gICAgfSBlbHNlIGlmIChzY29yZSA8IDApIHtcbiAgICAgIHJldHVybiBSZXN1bHRTdGF0dXMuTE9TRTtcbiAgICB9XG5cbiAgICByZXR1cm4gUmVzdWx0U3RhdHVzLkRSQVc7XG4gIH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBHYW1lUmVzdWx0O1xuIiwiLyojIyMjIyovXHJcbi8v77+977+977+977+977+977+977+977+90rvvv73vv73vv73vv73vv73vv73vv73vv73vv73ate+/ve+/ve+/vc2s77+977+977+977+977+977+977+9xrXvv73vv73vv73vv73vv71cclxuIHZhciBHZXRDYXJkUG9pbnRzU2FtZUNvdW50ID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICB0aGlzLmNhcmROdW1iZXJzID0ge307XHJcbiAgICBmb3IodmFyIGkgaW4gY2FyZHMpe1xyXG4gICAgICAgIHZhciBzO1xyXG4gICAgICAgIGlmKHR5cGVvZihjYXJkc1tpXS5udW1iZXIpID09ICd1bmRlZmluZWQnKXtcclxuICAgICAgICAgICAgcyA9IGNhcmRzW2ldLnBvaW50O1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBzID0gY2FyZHNbaV0ubnVtYmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLmNhcmROdW1iZXJzW3NdKXtcclxuICAgICAgICAgICAgdGhpcy5jYXJkTnVtYmVyc1tzXSArKztcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5jYXJkTnVtYmVyc1tzXSA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vY2MubG9nKHRoaXMuY2FyZE51bWJlcnNbY2FyZHNbaV0ubnVtYmVyXSlcclxuICAgICAgICAvL2NjLmxvZyhjYXJkcylcclxuICAgICAgICAvL2NjLmxvZyhjYXJkc1tpXS5udW1iZXIpXHJcbiAgICAgICAgLy9jYy5sb2coJy0tLTcnKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuY2FyZE51bWJlcnM7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdldENhcmRQb2ludHNTYW1lQ291bnQ7XHJcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGFiZWxOdW1iZXJzOiBbY2MuTGFiZWxdLFxuICAgICAgICBjYWxsYmFja0pvaW5Sb29tOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY2xpY2tDbGVhcigpO1xuICAgIH0sXG5cbiAgICBjbGlja051bWJlcjogZnVuY3Rpb24gKGV2ZW50LCBudW1iZXIpIHtcbiAgICAgIHZhciBsYWJlbCA9IHRoaXMuX2xhc3RFbXB0eUxhYmVsKCk7XG4gICAgICBpZiAobGFiZWwpIHtcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gbnVtYmVyO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbGV0IGlzQ29tcGxldGUgPSAodGhpcy5fbGFzdEVtcHR5TGFiZWwoKSA9PSBudWxsKTtcbiAgICAgIGxldCBpbnZpdGVOdW1iZXIgPSB0aGlzLl9yb29tTnVtYmVyKCk7XG4gICAgICBpZiAoaW52aXRlTnVtYmVyLmxlbmd0aCA9PSA2KSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tKb2luUm9vbSA9IGludml0ZU51bWJlcjtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc2VuZENvZGUgOmZ1bmN0aW9uKCl7ICAvL+WPkemAgemCgOivt+eggVxuICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgIGxldCBpbnZpdGVOdW1iZXIgPSB0aGlzLmNhbGxiYWNrSm9pblJvb207XG4gICAgICBjb25zb2xlLmxvZyhpbnZpdGVOdW1iZXIgLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXCIpO1xuICAgICAgaWYoIGludml0ZU51bWJlci5sZW5ndGg9PTYpeyAgXG4gICAgICAgIFNvY2tldC5zZW5kSW52aXRlQ29kZShpbnZpdGVOdW1iZXIsIHVzZXJJZCk7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tKb2luUm9vbSA9ICcnOyAgIC8v5riF56m66YKA6K+356CBXG4gICAgICB9XG4gICAgfSxcblxuICAgIGNsaWNrQ2xlYXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY2FsbGJhY2tKb2luUm9vbSA9ICcnO1xuICAgICAgdGhpcy5sYWJlbE51bWJlcnMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gXCJcIjtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBjbGlja0RlbGV0ZU9uZTogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGxhYmVsID0gdGhpcy5fbGFzdE51bWJlckxhYmVsKCk7XG4gICAgICBpZiAobGFiZWwpIHtcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gXCJcIjtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgX2xhc3RFbXB0eUxhYmVsOiBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBpbmRleCBpbiB0aGlzLmxhYmVsTnVtYmVycykge1xuICAgICAgICB2YXIgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgPT0gbnVsbFxuICAgICAgICB8fCBsYWJlbC5zdHJpbmcubGVuZ3RoIDw9IDApIHtcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICBfbGFzdE51bWJlckxhYmVsOiBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBpbmRleCA9IHRoaXMubGFiZWxOdW1iZXJzLmxlbmd0aCAtIDE7IGluZGV4ID49IDA7IC0taW5kZXgpIHtcbiAgICAgICAgbGV0IGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xuICAgICAgICBpZiAobGFiZWwuc3RyaW5nICYmIGxhYmVsLnN0cmluZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICBfcm9vbU51bWJlcjogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubGFiZWxOdW1iZXJzLnJlZHVjZShmdW5jdGlvbiAocm9vbU51bWJlciwgbGFiZWwpIHtcbiAgICAgICAgcmV0dXJuIHJvb21OdW1iZXIgKyAobGFiZWwuc3RyaW5nIHx8IFwiXCIpO1xuICAgICAgfSwgXCJcIik7XG4gICAgfSxcbn0pO1xuIiwiLy8g54mM6Iqx6Imy5biu5Yqp57G7XG4vLyDnlKjkuo7orqHnrpfkuIDkuKrniYzmlbDnu4TnmoToirHoibLnm7jlkIznmoTniYznmoTlvKDmlbBcbnZhciBLUUNhcmRDb2xvcnNIZWxwZXIgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgdGhpcy5jb2xvck51bWJlciA9IHt9O1xuXG4gIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcbiAgICBsZXQgY29sb3IgPSBjYXJkLmNvbG9yO1xuICAgIHZhciBudW1iZXIgPSB0aGlzLmNvbG9yTnVtYmVyW2NvbG9yXSB8fCAwO1xuICAgIHRoaXMuY29sb3JOdW1iZXJbY29sb3JdID0gbnVtYmVyICsgMTtcbiAgfS5iaW5kKHRoaXMpKTtcbn07XG5cbi8vIOebuOWQjOiKseiJsueahOeJjOeahOacgOWkp+aVsOmHj1xuS1FDYXJkQ29sb3JzSGVscGVyLnByb3RvdHlwZS5tYXhOdW1iZXIgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciByZXN1bHQgPSAwO1xuICBmb3IgKGxldCBwcm9wIGluIHRoaXMuY29sb3JOdW1iZXIpIHtcbiAgICBsZXQgbnVtYmVyID0gdGhpcy5jb2xvck51bWJlcltwcm9wXTtcbiAgICByZXN1bHQgPSBNYXRoLm1heChudW1iZXIsIHJlc3VsdCk7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBLUUNhcmRDb2xvcnNIZWxwZXI7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEFycmF5RXh0ZW5zaW9uID0gcmVxdWlyZSgnQXJyYXlFeHRlbnNpb24nKTtcbmNvbnN0IEtRQ2FyZFBvaW50c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFBvaW50c0hlbHBlcicpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyDlr7vmib4gY2FyZE1vZGVzIOS4reeahCDlr7nlrZBcbi8vIOi/meS8mui/lOWbniDlr7nlrZAg55qE57Si5byV5pWw57uEXG4vLyDlpoLvvJpbWzEsIDNdLCBbNCwgNV1dXG5LUUNhcmQuZmluZER1aVppID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICBsZXQgc0R1aVppSW5kZXhzID0gS1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRNb2RlcykgfHwgW107XG4gIGxldCByZXN1bHQgPSBLUUNhcmQuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDIpIHx8IFtdO1xuICBpZihyZXN1bHQubGVuZ3RoIDwgMiApe1xuICAgIGlmKHNEdWlaaUluZGV4cy5sZW5ndGggPiAwKXtcbiAgICAgIHNEdWlaaUluZGV4cy5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICB2YXIgczEgPSBbaW5kZXhzWzBdLGluZGV4c1sxXV07XG4gICAgICAgIC8vdmFyIHMyID0gW2luZGV4c1sxXSxpbmRleHNbMl1dO1xuICAgICAgICAvL3Jlc3VsdC5wdXNoKHMyKTtcbiAgICAgICAgcmVzdWx0LnB1c2goczEpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHZhciB0cmVzdWx0ID0gS1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDIpO1xuICAgIGZvcih2YXIgaSA9IDA7aSA8IHRyZXN1bHQubGVuZ3RoO2krKyl7XG4gICAgICByZXN1bHQucHVzaCh0cmVzdWx0W2ldKTtcbiAgICB9XG4gIH1cblxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XG5cbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XG59O1xuXG5LUUNhcmQuX2ZpbmRQb2ludExlbmd0aCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsIGxlbmd0aCkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIGxldCBvYmogPSBjYXJkTW9kZXMucmVkdWNlKGZ1bmN0aW9uKG9iaiwgY2FyZCwgaW5kZXgpIHtcbiAgICBsZXQgcG9pbnRJbmRleHMgPSBvYmpbY2FyZC5wb2ludF0gfHwgW107XG4gICAgb2JqW2NhcmQucG9pbnRdID0gcG9pbnRJbmRleHM7XG4gICAgcG9pbnRJbmRleHMucHVzaChpbmRleCk7XG4gICAgcmV0dXJuIG9iajtcbiAgfSwge30pO1xuXG4gIGxldCByZXN1bHQgPSBbXTtcbiAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICBsZXQgcG9pbnRJbmRleHMgPSBvYmpbcHJvcF07XG4gICAgaWYgKHBvaW50SW5kZXhzLmxlbmd0aCA9PSBsZW5ndGgpIHtcbiAgICAgIHBvaW50SW5kZXhzLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgIH0pO1xuICAgICAgcmVzdWx0LnB1c2gocG9pbnRJbmRleHMpO1xuICAgIH1cbiAgfVxuXG4gIHJlc3VsdC5zb3J0KGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7XG4gICAgbGV0IG4xID0gYXJyMVswXTtcbiAgICBsZXQgbjIgPSBhcnIyWzBdO1xuICAgIHJldHVybiBuMiAtIG4xO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XG59O1xuXG4vLyDmib4g5Lik5a+5IOeahOe0ouW8leaVsOe7hFxuLy8g5aaC77yaW1sxLCAyLCAzLCA0XSwgWzUsIDYsIDcsIDhdXVxuS1FDYXJkLmZpbmRMaWFEdWkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGxldCBkdWlaaUluZGV4cyA9IEtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgbGV0IGR1aVppSW5kZXggPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMikgfHwgW107XG5cbiAgaWYoZHVpWmlJbmRleHMubGVuZ3RoIDwgMSAmJiBkdWlaaUluZGV4Lmxlbmd0aCA+IDApe1xuICAgIGR1aVppSW5kZXguZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgZHVpWmlJbmRleHMudW5zaGlmdChpbmRleHMpO1xuICAgIH0pO1xuICB9XG4gIGlmIChkdWlaaUluZGV4cy5sZW5ndGggPCAyKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgbGV0IHJlc3VsdCA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGR1aVppSW5kZXhzLmxlbmd0aDsgKytpKSB7XG4gICAgZm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgZHVpWmlJbmRleHMubGVuZ3RoOyArK2opIHtcbiAgICAgIGlmKHJlc3VsdC5sZW5ndGggPCAxMCl7XG4gICAgICAgIGxldCBwcmUgPSBkdWlaaUluZGV4c1tpXTtcbiAgICAgICAgbGV0IG5leHQgPSBkdWlaaUluZGV4c1tqXTtcbiAgICAgICAgdmFyIHMgPSBwcmUuY29uY2F0KG5leHQpO1xuICAgICAgICB2YXIgbmV3UyA9IFtdO1xuICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBzLmxlbmd0aCA7cSsrKXtcbiAgICAgICAgICBpZihuZXdTLmluZGV4T2Yoc1txXSkgPT0gLTEpe1xuICAgICAgICAgICAgbmV3Uy5wdXNoKHNbcV0pO1xuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKG5ld1MubGVuZ3RoID09IDQpe1xuICAgICAgICAgIG5ld1Muc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXN1bHQudW5zaGlmdChuZXdTKTtcbiAgICAgICAgfVxuICAgICAgfWVsc2V7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG5cbiAgICB9XG4gIH1cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpO1xuICBpZihyZXN1bHQubGVuZ3RoID4gNil7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsNik7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8vIOaJvuS4ieadoVxuLy8g5aaC77yaW1sxLCAyLCAzXV07XG5LUUNhcmQuZmluZFNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGlmKGNhcmRNb2Rlcy5sZW5ndGggPCAzKXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgbGV0IHJlc3VsdCA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMykgfHwgW107XG4gIC8vZm9yKHZhciBxID0wO3E8cmVzdWx0Lmxlbmd0aDtxKyspe1xuICAvLyAgdmFyIGluZGV4cyA9IHJlc3VsdFtxXVswXTtcbiAgLy8gIGlmKGNhcmRNb2Rlc1tpbmRleHNdLnBvaW50ID49IDIwKXtcbiAgLy8gICAgcmVzdWx0LnNwbGljZShxLDEpO1xuICAvLyAgfVxuICAvL31cbiAgaWYocmVzdWx0Lmxlbmd0aCA8IDIgKXtcbiAgICBsZXQgdGllWmhpSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpO1xuICAgIGlmKHRpZVpoaUluZGV4c0FycmF5Lmxlbmd0aCA+IDApe1xuICAgICAgdGllWmhpSW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbM11dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMF0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICByZXN1bHQucHVzaChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMyk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdmFyIHRyZXN1bHQgPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMyk7XG4gICAgZm9yKHZhciBpID0gMDtpIDwgdHJlc3VsdC5sZW5ndGg7aSsrKXtcbiAgICAgIHJlc3VsdC5wdXNoKHRyZXN1bHRbaV0pO1xuICAgIH1cbiAgfVxuICAvKmlmKHJlc3VsdC5sZW5ndGggPCAxKXtcbiAgICAvLyDpk4HmlK/mmK/ljIXlkKvkuInmnaHnmoRcbiAgICBsZXQgdGllWmhpSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpO1xuICAgIGlmICh0aWVaaGlJbmRleHNBcnJheSkge1xuICAgICAgdGllWmhpSW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbM11dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMF0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICByZXN1bHQucHVzaChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0qL1xuXG4gIC8vaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgLy8gIHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLDEwKTtcbiAgLy99XG5cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpO1xuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbi8vIOaJvuWQjOiKsemhulxuS1FDYXJkLmZpbmRUb25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsIGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgbGV0IHJlc3VsdCA9IFtdO1xuICB2YXIgc2FuU2h1blppID0gS1FDYXJkLnNhblNodW5aaTEoY2FyZE1vZGVzLGxlbmd0aCk7XG4gIGlmKHNhblNodW5aaVswXSA9PSBudWxsKXtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgZm9yKHZhciBpPTA7aTxzYW5TaHVuWmlbMF0ubGVuZ3RoO2krKykge1xuICAgIHZhciBzID0gc2FuU2h1blppWzBdW2ldO1xuICAgIGlmIChLUUNhcmQuaXNUb25nSHVhU2h1bihzLCBsZW5ndGgpKSB7XG4gICAgICByZXN1bHQucHVzaChzYW5TaHVuWmlbMV1baV0pO1xuXG4gICAgfVxuICB9XG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0XG4gIH1lbHNle1xuICAgIHJldHVybiBLUUNhcmQuZmluZFRvbmdIdWFTaHVuMShjYXJkTW9kZXMpO1xuICB9XG59O1xuS1FDYXJkLmZpbmRUb25nSHVhU2h1bjEgPSBmdW5jdGlvbiAoY2FyZHMsIGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gIHZhciBwb2ludFMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIHBvaW50SCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXG4gIHZhciBwb2ludEQgPSBbXTsgLy/mlrnlnZdcbiAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xuICAgICAgaWYocG9pbnRTLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRTLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG5cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xuICAgICAgaWYocG9pbnRILmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRILnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzInKXtcbiAgICAgIGlmKHBvaW50Qy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XG4gICAgICBpZihwb2ludEQuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IDUpe1xuICAgICAgY29sb3JbaV0uc29ydChmdW5jdGlvbihhMSxhMil7XG4gICAgICAgIHJldHVybiBhMS5wb2ludCAtIGEyLnBvaW50O1xuICAgICAgfSlcbiAgICAgIGNvbG9yU3VtLnB1c2goY29sb3JbaV0pO1xuICAgIH1cbiAgfVxuICB2YXIgcmVzdWx0ID0gW107XG4gIGZvcih2YXIgaT0wO2k8Y29sb3JTdW0ubGVuZ3RoO2krKykge1xuICAgIHZhciBzID0gY29sb3JTdW1baV1cbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIDUpIDw9IHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICB2YXIgc3ViQ2FyZHMgPSBzLnNsaWNlKHN0YXJ0LCBzdGFydCArIDUpO1xuICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHN1YkNhcmRzKSkge1xuICAgICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2EpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkcy5sZW5ndGg7IHErKyl7XG4gICAgICAgICAgICB2YXIgciA9IGNhcmRzW3FdO1xuICAgICAgICAgICAgaWYociA9PT0gY2Epe1xuICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5UG9pbnQpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9ZWxzZXtcbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRzKTtcbiAgICBpZiAoY2FyZHMgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGFkZnMpe1xuICAgICAgICBpZihhZGZzLnBvaW50ID09IDE0KXtcbiAgICAgICAgICBhZGZzLnBvaW50ID0gMTtcbiAgICAgICAgICBhZGZzLnNjb3JlcyA9IDE7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bjIwKGNhcmRzKTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4xKGNvbnZlcnRlZENhcmRzKTtcbiAgfVxuICAvL3JldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IG51bGw7XG59O1xuS1FDYXJkLmZpbmRUb25nSHVhU2h1bjIwID0gZnVuY3Rpb24gKGNhcmQsIGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmQubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmQpIHx8IFtdO1xuICB2YXIgY2FyZHMgPSBjYXJkLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRzKTtcbiAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXG4gIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcbiAgdmFyIGNvbG9yRCA9IFtdOyAvL+aWueWdl1xuICB2YXIgcG9pbnRTID0gW107IC8v6buR5qGDXG4gIHZhciBwb2ludEggPSBbXTsgLy/nuqLlv4NcbiAgdmFyIHBvaW50QyA9IFtdOyAvL+aiheiKsVxuICB2YXIgcG9pbnREID0gW107IC8v5pa55Z2XXG4gIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XG4gICAgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzQnKXtcbiAgICAgIGlmKHBvaW50Uy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50Uy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuXG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzMnKXtcbiAgICAgIGlmKHBvaW50SC5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50SC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcyJyl7XG4gICAgICBpZihwb2ludEMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yQy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMScpe1xuICAgICAgaWYocG9pbnRELmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRELnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckQucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIGNvbG9yID0gW2NvbG9yUyxjb2xvckgsY29sb3JDLGNvbG9yRF07XG4gIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxuICBmb3IodmFyIGk9MDtpPGNvbG9yLmxlbmd0aDtpKyspe1xuICAgIGlmKGNvbG9yW2ldLmxlbmd0aCA+PSBwYXJzZUludCg1IC0gY2FyZDIwLmxlbmd0aCkpe1xuICAgICAgY29sb3JbaV0uc29ydChmdW5jdGlvbihhMSxhMil7XG4gICAgICAgIHJldHVybiBhMS5wb2ludCAtIGEyLnBvaW50O1xuICAgICAgfSlcbiAgICAgIGNvbG9yU3VtLnB1c2goY29sb3JbaV0pO1xuICAgIH1cbiAgfVxuICBjYy5sb2coY29sb3JTdW0pXG5cbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcbiAgICB2YXIgcyA9IGNvbG9yU3VtW2ldXG4gICAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICAgIHZhciBudW0gPSA1IC0gajtcbiAgICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgICB2YXIgc3ViQ2FyZHMgPSBzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XG4gICAgICAgIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcbiAgICAgICAgaWYoYm9vbCl7XG4gICAgICAgICAgbGV0IGluZGV4cyA9IFtdO1xuICAgICAgICAgIHZhciBuZXdDYXJkMjAgPSBjYXJkMjAuc2xpY2UoMCxqKTtcbiAgICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xuICAgICAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2EpIHtcbiAgICAgICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IGNhcmQubGVuZ3RoOyBxKyspe1xuICAgICAgICAgICAgICB2YXIgciA9IGNhcmRbcV07XG4gICAgICAgICAgICAgIGlmKHIgPT09IGNhKXtcbiAgICAgICAgICAgICAgICBpbmRleHMucHVzaChxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5TnVtYmVyKTtcblxuICAgICAgICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XG5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBjYy5sb2cocmVzdWx0KVxuICBjYy5sb2coJy0tLS0tLS0tMzU3JylcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1lbHNle1xuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZCk7XG4gICAgaWYgKGNhcmQgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIHJldHVybiBLUUNhcmQuZmluZFRvbmdIdWFTaHVuMjAoY29udmVydGVkQ2FyZHMpO1xuICB9XG4gIC8vcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogbnVsbDtcbn07XG5cbi8vIOaJvumTgeaUr1xuLy8g5aaC77yaW1sxLDIsMyw0XV1cbktRQ2FyZC5maW5kVGllWmhpID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICB2YXIgcmVzdWx0ID0gIEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgNCk7XG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG4gIHJlc3VsdCA9IFtdO1xuICAvLyDkupTlkIzmmK/ljIXlkKvpk4HmlK/nmoRcbiAgbGV0IHd1VG9uZ0luZGV4c0FycmF5ID0gS1FDYXJkLmZpbmRXdVRvbmcoY2FyZE1vZGVzKTtcbiAgaWYgKHd1VG9uZ0luZGV4c0FycmF5KSB7XG4gICAgd3VUb25nSW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgIGxldCB0aWVaaGlJbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICBsZXQgdGllWmhpSW5kZXhzMSA9IFtpbmRleHNbMF0sIGluZGV4c1sxXSwgaW5kZXhzWzJdLCBpbmRleHNbNF1dO1xuICAgICAgbGV0IHRpZVpoaUluZGV4czIgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1szXSwgaW5kZXhzWzRdXTtcbiAgICAgIGxldCB0aWVaaGlJbmRleHMzID0gW2luZGV4c1swXSwgaW5kZXhzWzJdLCBpbmRleHNbM10sIGluZGV4c1s0XV07XG4gICAgICBsZXQgdGllWmhpSW5kZXhzNCA9IFtpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdLCBpbmRleHNbNF1dO1xuICAgICAgcmVzdWx0LnB1c2godGllWmhpSW5kZXhzMCk7XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMxKTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czIpO1xuICAgICAgcmVzdWx0LnB1c2godGllWmhpSW5kZXhzMyk7XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHM0KTtcbiAgICB9KTtcbiAgfVxuICBpZihyZXN1bHQubGVuZ3RoID4gMTApe1xuICAgIHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLDEwKTtcbiAgfVxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2Rlcyw0KTtcbn07XG4vL+aJvuS6lOWQjFxuS1FDYXJkLmZpbmRXdVRvbmcgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGlmKGNhcmRNb2Rlcy5sZW5ndGggPCA1KXtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIHJlc3VsdCA9IHRoaXMuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDUpIHx8IFtdO1xuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsNSk7XG59O1xuLy8g5om+6aG65a2QXG4vLyDlpoLvvJpbWzEsIDIsIDMsIDQsIDVdXVxuS1FDYXJkLmZpbmRTaHVuWmkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzLGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgaWYodHlwZW9mKGNhcmRNb2Rlc1swXVsncG9pbnQnXSk9PVwidW5kZWZpbmVkXCIpe1xuICAgIGNhcmRNb2RlcyA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkTW9kZXMpO1xuICB9XG4gIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxuICBsZXQgdW5pcXVlQ2FyZHMgPSBjYXJkTW9kZXMudW5pcXVlKGZ1bmN0aW9uKGNhcmQxLCBjYXJkMikge1xuICAgIHJldHVybiBjYXJkMS5wb2ludCA9PSBjYXJkMi5wb2ludDtcbiAgfSk7XG4gIHVuaXF1ZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KTtcblxuICAvLyDlpoLmnpzmnIkgQe+8jOWImeWcqOacgOWQjua3u+WKoCAxNFxuICBsZXQgY2FyZEEgPSBjYXJkTW9kZXMuZmluZChmdW5jdGlvbiAoY2FyZCkge1xuICAgIHJldHVybiBjYXJkLnBvaW50ID09IDE7XG4gIH0pO1xuICBpZiAoY2FyZEEpIHtcbiAgICBsZXQgY2FyZEFQbHVzID0gbmV3IEtRQ2FyZChjYXJkQSk7XG4gICAgY2FyZEFQbHVzLnBvaW50ID0gMTQ7XG4gICAgdW5pcXVlQ2FyZHMucHVzaChjYXJkQVBsdXMpO1xuICB9XG5cbiAgbGV0IHJlc3VsdCA9IFtdO1xuXG4gIC8vIOeUseS6jueCueaVsOaYr+WUr+S4gOS4lOWNh+W6j++8jOWPqumcgOimgeS+neasoemBjeWOhuWIpOaWreaYr+WQpuaYr+mhuuWtkOWNs+WPr1xuICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIGxlbmd0aCkgPD0gdW5pcXVlQ2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgbGV0IHN1YkNhcmRzID0gdW5pcXVlQ2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoKTtcbiAgICBpZiAoS1FDYXJkLmlzU2h1blppKHN1YkNhcmRzLCBsZW5ndGgpKSB7XG4gICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gY2FyZE1vZGVzLmZpbmRJbmRleChmdW5jdGlvbiAob3JpZ2luQ2FyZCkge1xuXG4gICAgICAgICAgaWYgKGNhcmQucG9pbnQgPT0gMTQpIHtcbiAgICAgICAgICAgIHJldHVybiBvcmlnaW5DYXJkLnBvaW50ID09IDE7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGNhcmQgPT09IG9yaWdpbkNhcmQ7XG4gICAgICAgIH0pO1xuICAgICAgICBpbmRleHMucHVzaChpbmRleCk7XG4gICAgICB9KTtcblxuICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5TnVtYmVyKTtcbiAgICAgIHJlc3VsdC5wdXNoKGluZGV4cyk7XG4gICAgfVxuICB9XG5cbiAgLy8g5aSE55CG54K55pWw6YeN5aSN55qE5oOF5Ya1XG4gIC8vIOavlOWmgiBBIEEgSyBRIEogMTAg6L+Z56eNIFxuICBsZXQgcmVwZWF0SW5kZXhzQXJyYXkgPSBLUUNhcmQuX2ZpbmRSZXBlYXRQb2ludEluZGV4c0FycmF5KHJlc3VsdCwgY2FyZE1vZGVzKTtcbiAgcmVwZWF0SW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICByZXN1bHQucHVzaChpbmRleHMpO1xuICB9KTtcblxuICByZXN1bHQuc29ydChmdW5jdGlvbiAoYXJyMSwgYXJyMikge1xuICAgIHJldHVybiBhcnIxWzBdIC0gYXJyMlswXTtcbiAgfSk7XG5cbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRTaHVuWmkyMChjYXJkTW9kZXMpO1xufTtcbktRQ2FyZC5maW5kU2h1blppMjAgPSBmdW5jdGlvbiAoY2FyZE1vZGVzICxsZW5ndGggPSA1KSB7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2Rlcyk7XG4gIHZhciBjYXJkcyA9IGNhcmRNb2Rlcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAvLyDlhYjmoLnmja7ngrnmlbDljrvph41cbiAgdmFyIG5ld0FyciA9IFtdO1xuICB2YXIgbmV3QXJycyA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKG5ld0FycnMuaW5kZXhPZihjYXJkc1tpXVsncG9pbnQnXSkgPT0gLTEpIHtcbiAgICAgIG5ld0Fyci5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIG5ld0FycnMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgfVxuICB9XG5cbiAgbmV3QXJyLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgIHJldHVybiBuMS5wb2ludCAtIG4yLnBvaW50O1xuICB9KTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuICAgIHZhciBudW0gPSBsZW5ndGggLSBqO1xuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBuZXdBcnIubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICB2YXIgc3ViQ2FyZHMgPSBuZXdBcnIuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiAgICAgIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydwb2ludCddKSAtIHBhcnNlSW50KHN1YkNhcmRzWzBdWydwb2ludCddKSA8IGxlbmd0aDtcbiAgICAgIGlmKGJvb2wpe1xuICAgICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICAgIHZhciBuZXdDYXJkMjAgPSBjYXJkMjAuc2xpY2UoMCxqKTtcbiAgICAgICAgc3ViQ2FyZHMgPSBzdWJDYXJkcy5jb25jYXQobmV3Q2FyZDIwKTtcbiAgICAgICAgc3ViQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgICAgICAgZm9yKHZhciBxID0gMDtxIDwgY2FyZE1vZGVzLmxlbmd0aDsgcSsrKXtcbiAgICAgICAgICAgIHZhciByID0gY2FyZE1vZGVzW3FdO1xuICAgICAgICAgICAgaWYociA9PT0gY2FyZCl7XG4gICAgICAgICAgICAgIGluZGV4cy5wdXNoKHEpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5TnVtYmVyKTtcbiAgICAgICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZihyZXN1bHQubGVuZ3RoID4gMCl7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfWVsc2V7XG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkTW9kZXMpO1xuICAgIGlmIChjYXJkTW9kZXMgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBLUUNhcmQuZmluZFNodW5aaTIwKGNvbnZlcnRlZENhcmRzKTtcbiAgfVxufTtcbktRQ2FyZC5fZmluZFJlcGVhdFBvaW50SW5kZXhzQXJyYXkgPSBmdW5jdGlvbihpbmRleHNBcnJheSwgb3JpZ2luQ2FyZHMpIHtcbiAgbGV0IHJlcGVhdEluZGV4c0FycmF5ID0gW107XG4gIGluZGV4c0FycmF5LmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgbGV0IGNhcmRzID0gaW5kZXhzLm1hcChmdW5jdGlvbihpbmRleCkge1xuICAgICAgcmV0dXJuIG9yaWdpbkNhcmRzW2luZGV4XTtcbiAgICB9KTtcblxuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCwgaW5kZXgpIHtcbiAgICAgIGxldCBvcmlnaW5JbmRleCA9IG9yaWdpbkNhcmRzLmZpbmRJbmRleChmdW5jdGlvbihvcmlnaW5DYXJkKSB7XG4gICAgICAgIGlmKHR5cGVvZihjYXJkKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcmlnaW5DYXJkICE9PSBjYXJkICYmIG9yaWdpbkNhcmQucG9pbnQgPT0gY2FyZC5wb2ludCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAob3JpZ2luSW5kZXggPCAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IHJlcGVhdEluZGV4cyA9IGluZGV4cy5zbGljZSgpO1xuICAgICAgcmVwZWF0SW5kZXhzW2luZGV4XSA9IG9yaWdpbkluZGV4O1xuICAgICAgcmVwZWF0SW5kZXhzQXJyYXkucHVzaChyZXBlYXRJbmRleHMpO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gcmVwZWF0SW5kZXhzQXJyYXk7XG59O1xuXG4vLyDmib7lkIzoirFcbi8vIOWmgu+8mltbMSwgMiwgMywgNCwgNV1dXG5LUUNhcmQuZmluZFRvbmdIdWEgPSBmdW5jdGlvbiAoY2FyZE1vZGVzLCBsZW5ndGggPSA1KSB7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgbGV0IGNhcmRzID0gQXJyYXkuZnJvbShjYXJkTW9kZXMpO1xuICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlDb2xvcik7XG5cbiAgbGV0IHJlc3VsdCA9IFtdO1xuICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIGxlbmd0aCkgPD0gY2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgbGV0IHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbGVuZ3RoKTtcbiAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YShzdWJDYXJkcywgbGVuZ3RoKSkge1xuICAgICAgbGV0IGluZGV4cyA9IFtdO1xuICAgICAgc3ViQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgICAgIGxldCBpbmRleCA9IGNhcmRNb2Rlcy5maW5kSW5kZXgoZnVuY3Rpb24gKG9yaWdpbkNhcmQpIHtcbiAgICAgICAgICByZXR1cm4gY2FyZCA9PT0gb3JpZ2luQ2FyZDtcbiAgICAgICAgfSk7XG4gICAgICAgICAgaW5kZXhzLnB1c2goaW5kZXgpO1xuICAgICAgfSk7XG4gICAgICAvL2luZGV4cyA9IGluZGV4cy5sZW5ndGggPiA1ID8gaW5kZXhzLnNwbGljZSgxLDEpIDogaW5kZXhzO1xuICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5TnVtYmVyKTtcbiAgICAgIHJlc3VsdC5wdXNoKGluZGV4cyk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IEtRQ2FyZC5maW5kVG9uZ0h1YTIwKGNhcmRNb2Rlcyk7XG59O1xuS1FDYXJkLmZpbmRUb25nSHVhMjAgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgNSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkTW9kZXMpO1xuICB2YXIgY2FyZHMgPSBjYXJkTW9kZXMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgLy8g5YWI5qC55o2u54K55pWw5Y676YeNXG4gIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcblxuICB2YXIgcmVzdWx0ID0gW107XG4gIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgdmFyIG51bSA9IDUgLSBqO1xuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgIHZhciBzdWJDYXJkcyA9IGNhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XG4gICAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YShzdWJDYXJkcywgbnVtKSkge1xuICAgICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICAgIHZhciBuZXdDYXJkMjAgPSBjYXJkMjAuc2xpY2UoMCxqKTtcbiAgICAgICAgc3ViQ2FyZHMgPSBzdWJDYXJkcy5jb25jYXQobmV3Q2FyZDIwKTtcbiAgICAgICAgc3ViQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgICAgICAgZm9yKHZhciBxID0gMDtxIDwgY2FyZE1vZGVzLmxlbmd0aDsgcSsrKXtcbiAgICAgICAgICAgIHZhciByID0gY2FyZE1vZGVzW3FdO1xuICAgICAgICAgICAgaWYociA9PT0gY2FyZCl7XG4gICAgICAgICAgICAgIGluZGV4cy5wdXNoKHEpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaW5kZXhzLnNvcnQoQXJyYXkuc29ydEJ5TnVtYmVyKTtcbiAgICAgICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbktRQ2FyZC5maW5kSHVMdSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgbGV0IGxlbmd0aCA9IDU7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cblxuICB2YXIgcF8zPUtRQ2FyZC5maW5kU2FuVGlhbyhjYXJkTW9kZXMpO1xuICB2YXIgcF80PUtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2Rlcyk7XG4gIHZhciBwMj1LUUNhcmQuZmluZER1aVppKGNhcmRNb2RlcykgfHwgW107XG4gIC8vdmFyIHBfMyA9ICB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCAzKSB8fCBbXTtcbiAgLy92YXIgcF80ID0gdGhpcy5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgNCkgfHwgW107XG4gIC8vdmFyIHAyID0gdGhpcy5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMikgfHwgW107XG4gIGlmKHAyLmxlbmd0aCA8PSAwKXtcbiAgICBpZiAocF8zKSB7XG4gICAgICBwXzMuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzBdLCBpbmRleHNbMl1dO1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHMwKTtcbiAgICAgICAgLy9wMi51bnNoaWZ0KHNhblRpYW9JbmRleHMxKTtcbiAgICAgICAgcDIucHVzaChzYW5UaWFvSW5kZXhzMyk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAocF80KSB7XG4gICAgICBwXzQuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czEgPSBbaW5kZXhzWzBdLCBpbmRleHNbMl1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMiA9IFtpbmRleHNbMF0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMzID0gW2luZGV4c1sxXSwgaW5kZXhzWzJdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czQgPSBbaW5kZXhzWzFdLCBpbmRleHNbM11dO1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czYgPSBbaW5kZXhzWzJdLCBpbmRleHNbM11dO1xuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHMwKTtcbiAgICAgICAgLy9wMi51bnNoaWZ0KHNhblRpYW9JbmRleHMxKTtcbiAgICAgICAgLy9wMi51bnNoaWZ0KHNhblRpYW9JbmRleHMyKTtcbiAgICAgICAgLy9wMi51bnNoaWZ0KHNhblRpYW9JbmRleHMzKTtcbiAgICAgICAgLy9wMi51bnNoaWZ0KHNhblRpYW9JbmRleHM0KTtcbiAgICAgICAgcDIucHVzaChzYW5UaWFvSW5kZXhzNik7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuXG5cbiAgaWYgKChwMiA9PSBudWxsKSB8fCAocF8zID09IG51bGwpKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciB0cmVzdWx0PVtdXG4gIHAyLmZvckVhY2goZnVuY3Rpb24gKGlfMykge1xuICAgIHZhciBzPWlfMztcbiAgICBwXzMuZm9yRWFjaChmdW5jdGlvbiAoaV8yKSB7XG4gICAgICBzID0gaV8zLmNvbmNhdChpXzIpO1xuICAgICAgZm9yKHZhciBpID0wO2k8cy5sZW5ndGgtMTtpKyspe1xuICAgICAgICB2YXIgaW5kZXggPSBzW2ldO1xuICAgICAgICBmb3IodmFyIGogPWkrMTtqPHMubGVuZ3RoO2orKyl7XG4gICAgICAgICAgaWYoaW5kZXggPT0gc1tqXSkge1xuICAgICAgICAgICAgcyA9IG51bGw7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYocyA9PSBudWxsKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmKHMgIT09IG51bGwpe1xuICAgICAgICB0cmVzdWx0LnB1c2gocyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICBpZih0cmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgICB0cmVzdWx0ID0gdHJlc3VsdC5zbGljZSgwLDEwKTtcbiAgfVxuICByZXR1cm4gdHJlc3VsdC5sZW5ndGggPiAwID8gdHJlc3VsdCA6IEtRQ2FyZC5maW5kSHVMdTIwKGNhcmRNb2Rlcyk7XG59O1xuS1FDYXJkLmZpbmRIdUx1MjAgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGxldCBsZW5ndGggPSA1O1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB2YXIgcF8zPUtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2RlcywzKTtcbiAgdmFyIHBfND1LUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsNCk7XG4gIHZhciBwXzI9S1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDIpO1xuICBpZihwXzI9PW51bGwpe1xuICAgIHBfMj1bXTtcbiAgfVxuICBpZiAocF8zKSB7XG4gICAgcF8zLmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xuICAgICAgbGV0IHNhblRpYW9JbmRleHMzID0gW2luZGV4c1sxXSwgaW5kZXhzWzJdXTtcbiAgICAgIHBfMi51bnNoaWZ0KHNhblRpYW9JbmRleHMwKTtcbiAgICAgIHBfMi51bnNoaWZ0KHNhblRpYW9JbmRleHMzKTtcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChwXzQpIHtcbiAgICBwXzQuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXV07XG4gICAgICBsZXQgc2FuVGlhb0luZGV4czYgPSBbaW5kZXhzWzJdLCBpbmRleHNbM11dO1xuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czApO1xuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czYpO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKChwXzIgPT0gbnVsbCkgfHwgKHBfMyA9PSBudWxsKSkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB2YXIgdHJlc3VsdD1bXVxuICBwXzIuZm9yRWFjaChmdW5jdGlvbiAoaV8zKSB7XG4gICAgdmFyIHM9aV8zO1xuICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uIChpXzIpIHtcbiAgICAgIHMgPSBpXzMuY29uY2F0KGlfMik7XG4gICAgICBmb3IodmFyIGkgPTA7aTxzLmxlbmd0aC0xO2krKyl7XG4gICAgICAgIHZhciBpbmRleCA9IHNbaV07XG4gICAgICAgIGZvcih2YXIgaiA9aSsxO2o8cy5sZW5ndGg7aisrKXtcbiAgICAgICAgICBpZihpbmRleCA9PSBzW2pdKSB7XG4gICAgICAgICAgICBzID0gbnVsbDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihzID09IG51bGwpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYocyAhPT0gbnVsbCl7XG4gICAgICAgIHRyZXN1bHQudW5zaGlmdChzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIGlmKHRyZXN1bHQubGVuZ3RoID4gMTApe1xuICAgIHRyZXN1bHQgPSB0cmVzdWx0LnNsaWNlKDAsMTApO1xuICB9XG4gIHJldHVybiB0cmVzdWx0Lmxlbmd0aCA+IDAgPyB0cmVzdWx0IDogW107XG59O1xuXG5LUUNhcmQuZmluZEd1aVBhaSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsbnVtQmVyID0gMSkge1xuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkTW9kZXMpLm1hcChmdW5jdGlvbihjYXJkKXsvL+W+l+WIsOmsvOeJjOeahOe0ouW8lVxuICAgIGZvcih2YXIgcSA9IDA7cSA8IGNhcmRNb2Rlcy5sZW5ndGg7IHErKyl7XG4gICAgICB2YXIgciA9IGNhcmRNb2Rlc1txXTtcbiAgICAgIGlmKHIgPT09IGNhcmQpe1xuICAgICAgICByZXR1cm4gcTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHZhciBjYXJkcyA9IGNhcmRNb2Rlcy5rcV9leGNsdWRlcyhLUUNhcmQuY29udGFpbjIwKGNhcmRNb2RlcykpOy8v5Yig6Zmk5omA5pyJ54mM55qE6ay854mMXG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICB2YXIgbnVtID0gbnVtQmVyLWo7Ly/pmaTprLzniYzlpJYg5oiR5bqU6K+l5om+5aSa5bCR5byg54mM5Yy56YWNXG4gICAgdmFyIGluZGV4cyA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgbnVtKSB8fCBbXTtcbiAgICBmb3IodmFyIHQgPSAwO3QgPCBpbmRleHMubGVuZ3RoOyB0KyspIHtcbiAgICAgIGlmKG51bUJlciA9PSAyKXsvL+aYr+WvueWtkOeahOaXtuWAmeaKiumsvOeJjOWSjOWNleW8oOWMuemFjemDveW+queOr+S4gOmBjVxuICAgICAgICBmb3IodmFyIG8gPSAwO28gPCBjYXJkMjAubGVuZ3RoOysrbyl7XG4gICAgICAgICAgdmFyIHMgPSBpbmRleHNbdF0uY29uY2F0KGNhcmQyMFtvXSk7XG4gICAgICAgICAgaWYocy5sZW5ndGggPT0gbnVtQmVyKXtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gaW5kZXhzW3RdLmNvbmNhdChjYXJkMjAuc2xpY2UoMCxqKSk7Ly/kvp3mrKHnm7jliqDprLzniYznrKzkuIDmrKHliqDkuIDlvKAg6YCS5aKeXG4gICAgICAgIGlmKHMubGVuZ3RoID09IG51bUJlcil7XG4gICAgICAgICAgcmVzdWx0LnB1c2gocyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDEwKXtcbiAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCwxMCk7XG4gIH1cbiAgcmVzdWx0ID0gS1FDYXJkLnJlcGVhdChyZXN1bHQpOy8v5Y676YeNXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuS1FDYXJkLnJlcGVhdCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgZm9yKHZhciBpID0wO2k8cmVzdWx0Lmxlbmd0aDtpKyspe1xuICAgIHZhciBpbmRleCA9IHJlc3VsdFtpXTtcblxuICAgIHZhciBuZXdBeXkgPSBbXTtcbiAgICBmb3IodmFyIG8gPSAwO28gPCBpbmRleC5sZW5ndGg7bysrKXsvL+aciemHjeWkjeW5suaOieS9oFxuICAgICAgaWYobmV3QXl5LmluZGV4T2YoaW5kZXhbb10pID09IC0xKXtcbiAgICAgICAgbmV3QXl5LnB1c2goaW5kZXhbb10pO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHJlc3VsdC5zcGxpY2UoaSwxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yKHZhciBqID1pKzE7ajxyZXN1bHQubGVuZ3RoLTE7aisrKXtcbiAgICAgICAgdmFyIHMgPSByZXN1bHRbal07XG4gICAgICAgIHZhciBqU3RyaW5nID0gJyc7XG4gICAgICAgIHZhciBpU3RyaW5nID0gJyc7XG4gICAgICBmb3IodmFyIHIgPSAwO3IgPCBzLmxlbmd0aDtyKyspe1xuICAgICAgICAgIGpTdHJpbmcgPSBqU3RyaW5nICsgc1tyXTtcbiAgICAgICAgICBpU3RyaW5nID0gaVN0cmluZyArIGluZGV4W3JdO1xuICAgICAgICB9XG4gICAgICBpZihqU3RyaW5nID09IGlTdHJpbmcpey8v5pyJ6YeN5aSN5bmy5o6J5L2gXG4gICAgICAgIHJlc3VsdC5zcGxpY2UoaSwxKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cblxuS1FDYXJkLnRlc3RGaW5kID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICB2YXIgV3VUb25nID0gS1FDYXJkLmZpbmRXdVRvbmcoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFRvbmdIdWFTaHVuID0gS1FDYXJkLmZpbmRUb25nSHVhU2h1bihjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgVGllWmhpID0gS1FDYXJkLmZpbmRUaWVaaGkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIEh1THUgPSBLUUNhcmQuZmluZEh1THUoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFRvbmdIdWEgPSBLUUNhcmQuZmluZFRvbmdIdWEoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFNodW5aaSA9IEtRQ2FyZC5maW5kU2h1blppKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBTYW5UaWFvID0gS1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBMaWFEdWkgPSBLUUNhcmQuZmluZExpYUR1aShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgRHVpWmkgPSBLUUNhcmQuZmluZER1aVppKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciByZXN1bHQgPSBbXG4gICAgV3VUb25nLFxuICAgIFRvbmdIdWFTaHVuLFxuICAgIFRpZVpoaSxcbiAgICBIdUx1LFxuICAgIFRvbmdIdWEsXG4gICAgU2h1blppLFxuICAgIFNhblRpYW8sXG4gICAgTGlhRHVpLFxuICAgIER1aVppLFxuICBdXG4gIHJldHVybiByZXN1bHQ7XG59O1xuIiwiLy8g54mM54K55pWw5biu5Yqp57G7XG4vLyDnlKjmnaXorqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcbnZhciBLUUNhcmRQb2ludHNIZWxwZXIgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB0aGlzLnBvaW50TnVtYmVycyA9IHt9O1xuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgbGV0IHBvaW50ID0gY2FyZC5wb2ludDtcbiAgICAgICAgdmFyIG51bWJlciA9IHRoaXMucG9pbnROdW1iZXJzW3BvaW50XSB8fCAwO1xuICAgICAgICB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gPSBudW1iZXIgKyAxO1xuICAgIH0uYmluZCh0aGlzKSk7XG59O1xuXG4vLyDnm7jlkIzngrnmlbDniYznmoTmnIDlpKfmlbDph49cbktRQ2FyZFBvaW50c0hlbHBlci5wcm90b3R5cGUubWF4TnVtYmVyID0gZnVuY3Rpb24gKCkge1xuICB2YXIgcmVzdWx0ID0gMDtcbiAgZm9yIChsZXQgcHJvcCBpbiB0aGlzLnBvaW50TnVtYmVycykge1xuICAgIGxldCBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twcm9wXTtcbiAgICAgIC8vaWYobnVtYmVyIDwgMjApe1xuICAgICAgICAgIHJlc3VsdCA9IE1hdGgubWF4KG51bWJlciwgcmVzdWx0KTtcbiAgICAgIC8vfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZFBvaW50c0hlbHBlcjtcblxuLyp2YXIgY2FyZHMgPSBbXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjJ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoyfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjR9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo2fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjh9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo4fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEyfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTJ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxNH1cbl07XG52YXIgdGVzdCA9IG5ldyBLUUNhcmRQb2ludHNTYW1lKGNhcmRzKTtcbmNvbnNvbGUubG9nKHRlc3QpOyovXG4iLCJsZXQgSGVscGVyID0ge1xuICBsb2FkQ2FyZFNwcml0ZUZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgdGhpcy5fbG9hZENhcmRGcmFtZShjYXJkTmFtZSwgY2FsbGJhY2spO1xuICB9LFxuXG4gIHNldENhcmRTcHJpdGVGcmFtZTogZnVuY3Rpb24gKHNwcml0ZSwgY2FyZE5hbWUpIHtcbiAgICB0aGlzLmxvYWRDYXJkU3ByaXRlRnJhbWUoY2FyZE5hbWUsIGZ1bmN0aW9uIChzcHJpdGVGcmFtZSkge1xuICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG4gICAgfSk7XG4gIH0sXG5cbiAgX2NhcmRGdWxsTmFtZTogZnVuY3Rpb24gKGNhcmRTaG9ydE5hbWUpIHtcbiAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xuICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xuICAgICAgY2FyZE5hbWUgPSBcInB1YmxpYy1waWMtY2FyZC1wb2tlci1cIiArIGNhcmROYW1lO1xuICAgIH1cblxuICAgIHJldHVybiBjYXJkTmFtZTtcbiAgfSxcblxuICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xuICAgIGNjLmFzc2VydChjYWxsYmFjayk7XG5cbiAgICBjYy5sb2FkZXIubG9hZFJlcyhcImltYWdlcy9wb2tlckxpc3QvcG9ja0xpc3RcIiwgY2MuU3ByaXRlQXRsYXMsIGZ1bmN0aW9uIChlcnIsIGF0bGFzKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGNhbGxiYWNrKG51bGwsIGVycilcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSk7XG4gICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShjYXJkTmFtZSk7XG4gICAgICBjYWxsYmFjayhmcmFtZSk7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSGVscGVyO1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jb25zdCBLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uJyk7XG5jb25zdCBLUUNhcmRDb2xvcnNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRDb2xvcnNIZWxwZXInKTtcbmNvbnN0IEtRQ2FyZFNjb3JldHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRTY29yZXRzSGVscGVyJyk7XG5cbktRQ2FyZC5zY29yZU9mQ2FyZHMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgaWYoY2FyZHMgPT0gbnVsbCB8fCBjYXJkcy5sZW5ndGggPT0gbnVsbCkge1xuICAgIGNhcmRzID0gW107XG4gIH1cblxuICB2YXIgaXNUb3UgPSBjYXJkcy5sZW5ndGggPT0gMztcbiAgbGV0IHR5cGVTY29yZSA9IEtRQ2FyZC5fdHlwZVNjb3JlT2ZDYXJkcyhjYXJkcyk7XG4gIHZhciBjYWxlQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0EoY2FyZHMuc2xpY2UoKSk7XG4gIGNhbGVDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xuICAgIGlmKGNhcmQuc2NvcmVzID09IDEpe1xuICAgICAgY2FyZC5zY29yZXMgPSAxNDtcbiAgICB9XG4gIH0pXG4gIC8vY2FsZUNhcmRzID0gS1FDYXJkLlNvcnQoY2FsZUNhcmRzKTtcbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FsZUNhcmRzKTtcbiAgdmFyIHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFNjb3JldHNIZWxwZXIoY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCkpO1xuICB2YXIgbWF4TnVtID0gcG9pbnRIZWxwZXIubWF4TnVtYmVyKCkvKi1jYXJkMjAubGVuZ3RoID09IDAgPyAxOiBwb2ludEhlbHBlci5tYXhOdW1iZXIoKS1jYXJkMjAubGVuZ3RoKi87XG5cbiAgdmFyIG1heFNjb3JlID0gMDsvL+iOt+WPlumZpOmsvOeJjOWkluacgOWkp+eahOeahOeCueaVsFxuICBmb3IodmFyIGkgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgaWYgKHBhcnNlSW50KGkpID4gbWF4U2NvcmUgJiYgcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2ldID09IG1heE51bSkge1xuICAgICAgbWF4U2NvcmUgPSBwYXJzZUludChpKTtcbiAgICB9XG4gIH1cbiAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgaWYoY2FyZC5zY29yZXMgPj0gMjApe1xuICAgICAgY2FyZC5zY29yZXMgPSBtYXhTY29yZTtcbiAgICB9XG4gIH0pXG4gIGNhcmQyMC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xuICAgIGNhcmQuc2NvcmVzID0gbWF4U2NvcmU7XG4gIH0pXG4gIC8vY2MubG9nKG1heE51bSlcbiAgLy9jYy5sb2cobWF4U2NvcmUpXG4gIC8vY2MubG9nKGNhbGVDYXJkcy5rcV9leGNsdWRlcyhjYXJkMjApKVxuICAvL2NjLmxvZygnLS0tLTM1JylcbiAgY2FsZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnQpO1xuICBpZih0eXBlU2NvcmUgPT0gOTAwMDAwMDAwMDAwMDAwMCl7XG4gICAgLy/kupTlkIxcbiAgICBjYWxlQ2FyZHMuc29ydChmdW5jdGlvbihhMSxhMil7XG4gICAgICByZXR1cm4gYTIuc2NvcmVzIC0gYTEuc2NvcmVzO1xuICAgIH0pO1xuICAgIHZhciB0b3RhbFZhbHVlID0gXCJcIjtcbiAgICAvL3ZhciB0b3RhbENvbG9yID0gXCJcIjtcbiAgICBmb3IodmFyIGkgaW4gY2FsZUNhcmRzKSB7XG4gICAgICB2YXIgcyA9IGNhbGVDYXJkc1tpXS5zY29yZXM7XG4gICAgICAvL3ZhciBjID0gY2FsZUNhcmRzW2ldLmNvbG9yO1xuICAgICAgdG90YWxWYWx1ZSA9IChwYXJzZUludChzKSA+PSAxMCA/IHMgOiBcIjBcIitzKSt0b3RhbFZhbHVlO1xuICAgICAgLy90b3RhbENvbG9yID0gYyt0b3RhbENvbG9yO1xuICAgIH1cbiAgICAvL3RvdGFsVmFsdWUgPSB0b3RhbFZhbHVlK3RvdGFsQ29sb3I7XG4gICAgLy9jYy5sb2codG90YWxWYWx1ZSlcbiAgICAvL2NjLmxvZyhwYXJzZUludCh0b3RhbFZhbHVlKSlcbiAgICAvL2NjLmxvZyh0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxWYWx1ZSkpXG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA4MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/lkIzoirHpobrmr5TmnIDlpKfnmoTpgqPlvKDvvIzlpoLmnpzkuKTlvKDnm7jlkIzpgqPlsLHmmK/nm7jlkIxcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCl7Ly/mnInprLzniYznmoTml7blgJnopoHmlLnlj5jprLzniYznmoTliIbmlbBcbiAgICAgIGNhbGVDYXJkcyA9IEtRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzKGNhbGVDYXJkcyk7XG4gICAgfVxuICAgIHZhciB0b3RhbFZhbHVlID0gXCJcIjtcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICBmb3IodmFyIGkgaW4gY2FsZUNhcmRzKSB7XG4gICAgICB2YXIgcyA9IGNhbGVDYXJkc1tpXS5zY29yZXM7XG4gICAgICB0b3RhbFZhbHVlID0gKHBhcnNlSW50KHMpID49IDEwID8gcyA6IFwiMFwiK3MpK3RvdGFsVmFsdWU7XG4gICAgICB2YXIgYyA9IGNhbGVDYXJkc1tpXS5jb2xvcjsvL+eJjOiJslxuICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgfVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxWYWx1ZSArIHZhbHVlQ29sb3IpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDcwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+mTgeaUryzmib7lh7rpgqPlm5vlvKDmmK/ku4DkuYjniYxcblxuICAgIHZhciBzdHIgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykge1xuICAgICAgaWYobWF4U2NvcmUgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7Ly/kuInmnaFcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjICsgb25lVmFsdWVDb2xvcjsvL+eJjOiJslxuXG4gICAgICB9XG4gICAgfVxuICAgIHZhciBxd2UgPSAnJztcbiAgICBxd2UgPSBvbmVWYWx1ZUNvbG9yLnN1YnN0cigwLG9uZVZhbHVlQ29sb3IubGVuZ3RoIC0xKTtcbiAgICBvbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvci5zdWJzdHIob25lVmFsdWVDb2xvci5sZW5ndGggLTEpO1xuICAgIHN0ciA9IHN0citvbmVWYWx1ZSArIG9uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yICsgcXdlO1xuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA2MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/okavoiqZcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIHZhciBvbmVWYWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIGlmKG1heFNjb3JlID09IGNhbGVDYXJkc1t3XS5zY29yZXMpey8v5LiJ5p2hXG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICBvbmVWYWx1ZUNvbG9yID0gYyArIG9uZVZhbHVlQ29sb3I7Ly/niYzoibJcblxuICAgICAgfVxuICAgIH1cblxuICAgIGlmKGlzVG91KXtcbiAgICAgIG9uZVZhbHVlID0gb25lVmFsdWUrJzAwMDAnO1xuICAgICAgb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG5cbiAgICBzdHIgPSBzdHIrb25lVmFsdWUgKyB2YWx1ZUNvbG9yICsgb25lVmFsdWVDb2xvcjtcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XG5cbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA1MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/lkIzoirEs5pyJ5Y+v6IO96ZyA6KaB5q+UNeW8oOeJjFxuICAgIHZhciB0b3RhbFNjb3JlID0gXCJcIjtcbiAgICB2YXIgdG90YWxDb2xvciA9IFwiXCI7XG4gICAgLy92YXIgY29sb3JzID0gMDsvL+iOt+WPlueJjOeahOexu+Wei+minOiJslxuICAgIC8vZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgIC8vICBpZihwYXJzZUludChjYWxlQ2FyZHNbaV0ucG9pbnQpIDwgMjApe1xuICAgIC8vICAgIGNvbG9ycyA9IHBhcnNlSW50KGNhbGVDYXJkc1tpXS5jb2xvcik7XG4gICAgLy8gICAgYnJlYWs7XG4gICAgLy8gIH1cbiAgICAvL31cblxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBwYWlQb2ludCA9IHBhcnNlSW50KGNhbGVDYXJkc1tpXS5wb2ludCk7XG4gICAgICB2YXIgY29sb3JzID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLnBvaW50KSA8IDIwID8gY2FsZUNhcmRzW2ldLmNvbG9yOiA1O1xuICAgICAgdG90YWxDb2xvciA9IGNvbG9ycyArIHRvdGFsQ29sb3I7XG4gICAgICB0b3RhbFNjb3JlID0gKHBhaVBvaW50Pj0xMCA/IHBhaVBvaW50IDogXCIwXCIrcGFpUG9pbnQpK3RvdGFsU2NvcmU7XG4gICAgfVxuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodG90YWxTY29yZSt0b3RhbENvbG9yKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSA0MDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/pobrlrZBcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCl7Ly/mnInprLzniYznmoTml7blgJnopoHmlLnlj5jprLzniYznmoTliIbmlbBcbiAgICAgIGNhbGVDYXJkcyA9IEtRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzKGNhbGVDYXJkcyk7XG4gICAgfVxuICAgIHZhciB0b3RhbFZhbHVlID0gXCJcIjtcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICBmb3IodmFyIGkgaW4gY2FsZUNhcmRzKSB7XG4gICAgICB2YXIgcyA9IGNhbGVDYXJkc1tpXS5zY29yZXM7XG4gICAgICB0b3RhbFZhbHVlID0gKHBhcnNlSW50KHMpID49IDEwID8gcyA6IFwiMFwiK3MpK3RvdGFsVmFsdWU7XG5cbiAgICAgIHZhciBjID0gY2FsZUNhcmRzW2ldLmNvbG9yOy8v54mM6ImyXG4gICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlICsgdmFsdWVDb2xvcik7XG4gIH1cbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gMzAwMDAwMDAwMDAwMDAwMCkge1xuICAgIC8v5LiJ5p2h77yM5om+5Ye65piv5ZOq5byg54mM5pyJM+W8oFxuICAgIC8vY2FsZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnQpO1xuICAgIHZhciBzdHIgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IyMCA9IFwiXCI7Ly/niYzoibJcbiAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7XG4gICAgICBpZihtYXhTY29yZSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXsvL+S4ieadoVxuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XG4gICAgICAgIHN0ciA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIHN0cjtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcbiAgICAgIH1lbHNle1xuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XG4gICAgICAgIG9uZVZhbHVlID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgb25lVmFsdWU7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgaWYocGFyc2VJbnQocykgPCAyMCl7XG4gICAgICAgICAgb25lVmFsdWVDb2xvciA9IGMgKyBvbmVWYWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIG9uZVZhbHVlQ29sb3IyMCA9IGMgKyBvbmVWYWx1ZUNvbG9yMjA7Ly/niYzoibJcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZihpc1RvdSl7XG4gICAgICBvbmVWYWx1ZSA9IG9uZVZhbHVlKycwMDAwJztcbiAgICAgIHZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yKycwMCc7XG4gICAgfVxuICAgIHN0ciA9IHN0citvbmVWYWx1ZSArIG9uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yICsgb25lVmFsdWVDb2xvcjIwO1xuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcblxuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDIwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL2NhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KTtcbiAgICAvL+S4pOWvuSzmnInlj6/og73pnIDopoHmr5Q15byg54mMXG4gICAgdmFyIHN0ciA9IFwiXCI7XG4gICAgdmFyIG9uZVZhbHVlID0gJyc7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciBpIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgaWYocG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2ldID09IDIpIHsvL+S4pOWvuVxuICAgICAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7XG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgICAgIHN0ciA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIHN0cjtcbiAgICAgICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGZvcih2YXIgcSBpbiBjYWxlQ2FyZHMpIHsvL+WNleW8oOWKoOiKseiJslxuICAgICAgICAgIGlmKGkgPT0gY2FsZUNhcmRzW3FdLnNjb3Jlcyl7XG4gICAgICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1txXS5zY29yZXM7XG4gICAgICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1txXS5jb2xvcjsvL+eJjOiJslxuICAgICAgICAgICAgb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3IgKyBjOy8v54mM6ImyXG5cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgfVxuICAgIGNjLmxvZyhzdHIpXG4gICAgY2MubG9nKG9uZVZhbHVlKVxuICAgIHN0ciA9IHN0citvbmVWYWx1ZSArb25lVmFsdWVDb2xvciArIHZhbHVlQ29sb3I7XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDEwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+WvueWtkFxuICAgIC8vY2FsZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnQpO1xuICAgIHZhciBzdHIgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjtcblxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXtcbiAgICAgIGNhbGVDYXJkcy5zb3J0KGZ1bmN0aW9uKGNhcmQxLGNhcmQyKSB7XG4gICAgICAgIHJldHVybiBjYXJkMi5wb2ludC1jYXJkMS5wb2ludDtcbiAgICAgIH0pO1xuICAgICAgY2FsZUNhcmRzID0gY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkLGluZGV4KSB7XG4gICAgICAgIHZhciBzID0gY2FyZC5zY29yZXM7XG4gICAgICAgIHZhciBjID0gY2FyZC5jb2xvcjtcbiAgICAgICAgc3RyID0gc3RyKyhwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKTtcbiAgICAgICAgaWYoaW5kZXggPT0gMCl7XG4gICAgICAgICAgdmFyIHMyMCA9IGNhcmQyMFswXS5zY29yZXM7XG4gICAgICAgICAgc3RyID0gc3RyKyhwYXJzZUludChzMjApPj0xMCA/IHMyMCA6XCIwXCIrczIwKTtcbiAgICAgICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcitjO1xuICAgICAgICAgIHZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yK2NhcmQyMFswXS5jb2xvcjtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgb25lVmFsdWVDb2xvciA9IG9uZVZhbHVlQ29sb3IrYztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBjYy5sb2coc3RyKVxuICAgICAgY2MubG9nKCctLS0tLS0tLTI3NCcpXG4gICAgICBpZihpc1RvdSl7XG4gICAgICAgIHN0ciA9IHN0cisnMDAwMCc7XG4gICAgICAgIHZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yKycwMCc7XG4gICAgICB9XG4gICAgICBzdHIgPSBzdHIgKyBvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvcjtcbiAgICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgICB9XG5cbiAgICBmb3IodmFyIGkgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICBpZihwb2ludEhlbHBlci5wb2ludE51bWJlcnNbaV0gPT0gbWF4TnVtKSB7Ly/lr7nlrZBcbiAgICAgICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykgey8v5a+55a2Q5Yqg6Iqx6ImyXG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgICAgIHZhbHVlQ29sb3IgPSBjYWxlQ2FyZHNbd10uY29sb3IgKyB2YWx1ZUNvbG9yO1xuICAgICAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGZvcih2YXIgcSBpbiBjYWxlQ2FyZHMpIHsvL+WNleW8oOWKoOiKseiJslxuICAgICAgICAgIGlmKGkgPT0gY2FsZUNhcmRzW3FdLnNjb3Jlcyl7XG4gICAgICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1txXS5zY29yZXM7XG4gICAgICAgICAgICBvbmVWYWx1ZUNvbG9yID0gY2FsZUNhcmRzW3FdLmNvbG9yICsgb25lVmFsdWVDb2xvcjtcbiAgICAgICAgICAgIG9uZVZhbHVlID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgb25lVmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH1cblxuICAgIH1cbiAgICAvL2NjLmxvZyhvbmVWYWx1ZUNvbG9yKVxuICAgIC8vY2MubG9nKHZhbHVlQ29sb3IpXG4gICAgaWYoaXNUb3Upe1xuICAgICAgb25lVmFsdWUgPSBvbmVWYWx1ZSsnMDAwMCc7XG4gICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xuICAgIH1cbiAgICBzdHIgPSBzdHIrb25lVmFsdWUrb25lVmFsdWVDb2xvcit2YWx1ZUNvbG9yO1xuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSAwKSB7XG4gICAgLy/kuYzpvplcbiAgICB2YXIgdmFsdWVQb2ludCA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiO1xuICAgIGZvcih2YXIgcSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcbiAgICAgIHZhciBjID0gY2FsZUNhcmRzW3FdLmNvbG9yOy8v5Y2V5byg5Yqg6Iqx6ImyXG4gICAgICB2YWx1ZVBvaW50ID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgdmFsdWVQb2ludDtcbiAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjtcbiAgICB9XG4gICAgaWYoaXNUb3Upe1xuICAgICAgdmFsdWVQb2ludCA9IHZhbHVlUG9pbnQrJzAwMDAnO1xuICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG4gICAgdmFsdWVQb2ludCA9IHZhbHVlUG9pbnQgKyB2YWx1ZUNvbG9yO1xuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQodmFsdWVQb2ludCk7XG4gIH1cblxuXG4gIHZhciBjYXJkc1RvdGFsUG9pbnQ9MDtcbiAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGNhcmRzVG90YWxQb2ludCArPSBjYXJkLnBvaW50O1xuICB9KTtcblxuICBsZXQgcmVzdWx0ID0gdHlwZVNjb3JlICsgY2FyZHNUb3RhbFBvaW50O1xuICByZXR1cm4gcmVzdWx0O1xufTtcbktRQ2FyZC5fY2hhbmdlQ2FyZFNjb3JzID0gZnVuY3Rpb24oY2FyZE1vZGVsKSB7XG4gIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICBjYXJkLnNjb3JlcyA9IGNhcmQucG9pbnQ7XG4gICAgaWYgKGNhcmQuc2NvcmVzID09IDE0KSB7XG4gICAgICBjYXJkLnNjb3JlcyA9IDE7XG4gICAgfVxuICB9KTtcbiAgdmFyIGlzMTQgPSBmYWxzZTsvL+aYryBrIHEgaiAxMCBBO1xuICB2YXIgaXMxID0gZmFsc2U7Ly/kuI3mmK8xIDIgMyA0IDVcbiAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGlmIChjYXJkLnNjb3JlcyA8IDkpIHtcbiAgICAgIGlzMTQgPSB0cnVlOyAvL+S4jeaYryBrIHEgaiAxMCBBO1xuICAgICAgaWYgKGNhcmQuc2NvcmVzIDwgNiAmJiBjYXJkLnNjb3JlcyA+IDEgKSB7XG4gICAgICAgIGlzMSA9IHRydWU7Ly/mmK8xIDIgMyA0IDVcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG5cbiAgaWYgKGlzMTQpIHsgLy/kuI3mmK8gayBxIGogMTAgQTtcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgICBpZiAoY2FyZC5zY29yZXMgPT0gMTQpIHtcbiAgICAgICAgY2FyZC5zY29yZXMgPSAxO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGlmIChpczE0ICYmICFpczEpIHsgLy/kuI3mmK8gayBxIGogMTAgQTtcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcbiAgICAgIHJldHVybiBhMS5zY29yZXMgLSBhMi5zY29yZXM7XG4gICAgfSk7XG5cbiAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v5LiA5Ymv54mM55qE5YiG5pWwXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgIHZhciBzID0gcGFyc2VJbnQoY2FyZE1vZGVsWzBdLnNjb3JlcykgKyBpOyAvL+acgOWwj+eahOeJjOeahOWIhuaVsFxuICAgICAgc2NvcmVzQXl5LnB1c2gocyk7XG4gICAgfVxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2NvcmVzQXl5Lmxlbmd0aDsgaisrKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRNb2RlbC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2FyZFNjb3JlcyA9IGNhcmRNb2RlbFtpXS5zY29yZXM7XG4gICAgICAgIGlmIChjYXJkU2NvcmVzID09IHNjb3Jlc0F5eVtqXSAmJiBjYXJkU2NvcmVzIDwgMTUpIHtcbiAgICAgICAgICBzY29yZXNBeXkuc3BsaWNlKGosIDEpOyAvL+WIoOmZpOS4jeaYr+msvOeJjOeahOWIhlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHsgLy/mlLnlj5jniYznmoTliIbmlbBcbiAgICAgIGlmIChjYXJkLnBvaW50ID49IDIwKSB7XG4gICAgICAgIGNhcmQuc2NvcmVzID0gc2NvcmVzQXl5LnNwbGljZSgwLDEpWzBdO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG4gIH0gZWxzZSB7IC8v5pivIGsgcSBqIDEwIEE7XG4gICAgY2FyZE1vZGVsLnNvcnQoZnVuY3Rpb24oYTEsIGEyKSB7XG4gICAgICByZXR1cm4gYTIuc2NvcmVzIC0gYTEuc2NvcmVzO1xuICAgIH0pO1xuICAgIHZhciBudW0gPSAxNDtcbiAgICBpZihpczEpey8v5pivMSAyIDMgNCA1XG4gICAgICBudW0gPSA1O1xuICAgIH1cbiAgICB2YXIgc2NvcmVzQXl5ID0gW107IC8v5LiA5Ymv54mM55qE5YiG5pWwXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgIHNjb3Jlc0F5eS5wdXNoKG51bSk7XG4gICAgICBudW0gLT0gMTtcbiAgICB9XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjYXJkU2NvcmVzID0gY2FyZE1vZGVsW2ldLnNjb3JlcztcbiAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkge1xuICAgICAgICAgIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY2MubG9nKHNjb3Jlc0F5eSlcbiAgICBjYy5sb2coY2FyZE1vZGVsKVxuICAgIGNjLmxvZygnLS0tLS0tLS0tLTQxMicpXG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkgeyAvL+aJvuWHuumAieS4reeahOeJjFxuICAgICAgaWYgKGNhcmQucG9pbnQgPj0gMjApIHtcbiAgICAgICAgY2FyZC5zY29yZXMgPSBzY29yZXNBeXkuc3BsaWNlKDAsIDEpWzBdO1xuICAgICAgfVxuICAgIH0uYmluZCh0aGlzKSk7XG4gICAgY2MubG9nKGNhcmRNb2RlbClcbiAgfVxuXG4gIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICBpZiAoY2FyZC5zY29yZXMgPT0gMSkge1xuICAgICAgY2FyZC5zY29yZXMgPSAxNDtcbiAgICB9XG4gIH0pO1xuICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcbiAgICByZXR1cm4gYTEuc2NvcmVzIC0gYTIuc2NvcmVzO1xuICB9KTtcbiAgcmV0dXJuIGNhcmRNb2RlbDtcbn07XG4vKiMjIyMjKi9cbktRQ2FyZC5zY29yZU9mQ2FyZHMyID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIGlmKGNhcmRzID09IG51bGwgfHwgY2FyZHMubGVuZ3RoID09IG51bGwpIHtcbiAgICBjYXJkcyA9IFtdO1xuICB9XG4gIGlmKHR5cGVvZihjYXJkc1swXS5wb2ludCkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgIGNhcmRzID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRzKTtcbiAgfVxuICB2YXIgY2FsZUNhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BKGNhcmRzLnNsaWNlKCkpO1xuICBjYWxlQ2FyZHMuc29ydChLUUNhcmQuc29ydClcbiAgLy92YXIgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhbGVDYXJkcyk7XG4gIHZhciB2YWx1ZVN0ciA9IFwiXCI7XG4gIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICBsZXQgcyA9IGNhbGVDYXJkc1tpXS5wb2ludDtcbiAgICB2YWx1ZVN0ciA9IChwYXJzZUludChzKT49MTA/czpcIjBcIitzKSt2YWx1ZVN0cjtcbiAgICBpZihpID09IDQpe1xuICAgICAgdmFsdWVTdHIgPSAnLicrdmFsdWVTdHI7XG4gICAgfVxuICB9XG4gIC8vY2MubG9nKE51bWJlcih2YWx1ZVN0cikpXG4gIC8vY2MubG9nKHZhbHVlU3RyKVxuICAvL2NjLmxvZygnLS0tLS0tLS0t54m55q6K54mM566X5YiGJylcbiAgcmV0dXJuIHZhbHVlU3RyO1xufTtcblxuS1FDYXJkLl90eXBlU2NvcmVPZkNhcmRzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIHZhciB0eXBlU2NvcmUgPSAwO1xuICBpZihLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpe1xuICAgIHR5cGVTY29yZSA9IDkwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA4MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDcwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5IdUx1KGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDYwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDUwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5TaHVuWmkoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gNDAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblNhblRpYW8oY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gMzAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkxpYUR1aShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSAyMDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluRHVpWmkoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gMTAwMDAwMDAwMDAwMDAwMDtcbiAgfVxuXG4gIHJldHVybiB0eXBlU2NvcmU7XG59O1xuXG4vLyDmoLnmja7niYzlnovov5vooYzmjpLluo9cbktRQ2FyZC5fdHlwZUNhcmRzU29ydCA9IGZ1bmN0aW9uIChjYXJkcykge1xuICBpZiAoKGNhcmRzID09IG51bGwpIHx8IChjYXJkcy5sZW5ndGggPT0gMCkpIHtcbiAgICByZXR1cm4gY2FyZHM7XG4gIH1cbiAgaWYoS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZHMpKXtcbiAgICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0V3V0b25nKGNhcmRzKTtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzKSkge1xuICAgIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRTaHVuWmkoY2FyZHMpO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKSkge1xuICAgIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRUaWVaaGkoY2FyZHMpO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluSHVMdShjYXJkcykpIHtcbiAgICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0SHVMdShjYXJkcyk7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRzKSkge1xuICAgIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRUb25nSHVhKGNhcmRzKTtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblNodW5aaShjYXJkcykpIHtcbiAgICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2h1blppKGNhcmRzKTtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblNhblRpYW8oY2FyZHMpKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFNhblRpYW8oY2FyZHMpO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluTGlhRHVpKGNhcmRzKSkge1xuICAgIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRMaWFuZ0R1aShjYXJkcyk7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkcykpIHtcbiAgICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0RHVpWmkoY2FyZHMpO1xuICB9XG5cbiAgcmV0dXJuIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KS5yZXZlcnNlKCk7XG59O1xuXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRTaHVuWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgcmV0dXJuIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KS5yZXZlcnNlKCk7XG59O1xuXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRUaWVaaGkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xufTtcblxuLyojIyMjIyovXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRXdXRvbmcgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xufTtcbi8qIyMjIyMqL1xuXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRIdUx1ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydFRvbmdIdWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgcmV0dXJuIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KS5yZXZlcnNlKCk7XG59O1xuXG5LUUNhcmQuX3R5cGVDYXJkc1NvcnRTYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydExpYW5nRHVpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydER1aVppID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRCeU51bWJlck9mUG9pbnRzKGNhcmRzKTtcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMgPSBmdW5jdGlvbihjYXJkcykge1xuICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkU2NvcmV0c0hlbHBlcihjYXJkcyk7XG4gIGxldCBuZXdDYXJkcyA9IGNhcmRzLnNsaWNlKCkuc29ydChmdW5jdGlvbihjYXJkMSwgY2FyZDIpIHtcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMS5wb2ludF07XG4gICAgbGV0IG51bWJlck9mQ2FyZDIgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbY2FyZDIucG9pbnRdO1xuXG4gICAgaWYgKG51bWJlck9mQ2FyZDIgIT0gbnVtYmVyT2ZDYXJkMSkge1xuICAgICAgcmV0dXJuIG51bWJlck9mQ2FyZDIgLSBudW1iZXJPZkNhcmQxO1xuICAgIH1cblxuICAgIHJldHVybiBjYXJkMi5wb2ludCAtIGNhcmQxLnBvaW50O1xuICB9KTtcblxuICByZXR1cm4gbmV3Q2FyZHM7XG59O1xuXG5LUUNhcmQudGVzdFNjb3JlID0gZnVuY3Rpb24oKSB7XG5cbn07IiwiLy8g54mM54K55pWw5biu5Yqp57G7XHJcbi8vIOeUqOadpeiuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxyXG52YXIgS1FDYXJkU2NvcmV0c0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgdGhpcy5wb2ludE51bWJlcnMgPSB7fTtcclxuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcclxuICAgICAgICBsZXQgcG9pbnQgPSBjYXJkLnNjb3JlcztcclxuICAgICAgICB2YXIgbnVtYmVyID0gdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdIHx8IDA7XHJcbiAgICAgICAgdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdID0gbnVtYmVyICsgMTtcclxuICAgIH0uYmluZCh0aGlzKSk7XHJcbn07XHJcblxyXG4vLyDnm7jlkIzngrnmlbDniYznmoTmnIDlpKfmlbDph49cclxuS1FDYXJkU2NvcmV0c0hlbHBlci5wcm90b3R5cGUubWF4TnVtYmVyID0gZnVuY3Rpb24gKCkge1xyXG4gIHZhciByZXN1bHQgPSAwO1xyXG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5wb2ludE51bWJlcnMpIHtcclxuICAgIGxldCBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twcm9wXTtcclxuICAgICAgLy9pZihudW1iZXIgPCAyMCl7XHJcbiAgICAgICAgICByZXN1bHQgPSBNYXRoLm1heChudW1iZXIsIHJlc3VsdCk7XHJcbiAgICAgIC8vfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufTtcclxuXHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBLUUNhcmRTY29yZXRzSGVscGVyO1xyXG5cclxuLyp2YXIgY2FyZHMgPSBbXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Nn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEwfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTJ9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjE0fVxyXG5dO1xyXG52YXIgdGVzdCA9IG5ldyBLUUNhcmRQb2ludHNTYW1lKGNhcmRzKTtcclxuY29uc29sZS5sb2codGVzdCk7Ki9cclxuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jb25zdCBLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uJyk7XG5cbi8vIOeJjOiHquWKqOmAieaLqeeahOaJqeWxlVxuXG4vKipcbiAqIOiHquWKqOmAieaLqeeJjO+8jOeUseWkp+WIsOWwj1xuICpcbiAqIEBwYXJhbSAge1tLUUNhcmRdfSBvcmlnaW5DYXJkcyAg6KKr6YCJ5oup55qE5Y6f5aeL54mM5pWw57uEXG4gKlxuICogQHJldHVybiB7W0tRQ2FyZF19XG4gKi9cbktRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMgPSBmdW5jdGlvbihvcmlnaW5DYXJkcywgbWF4TGVuZ3RoKSB7XG4gICAgaWYgKG9yaWdpbkNhcmRzLmxlbmd0aCA8PSBtYXhMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG9yaWdpbkNhcmRzO1xuICAgIH1cbiAgICBvcmlnaW5DYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xuICAgICAgICBpZihjYXJkLnNjb3JlcyA9PSAxKXtcbiAgICAgICAgICAgIGNhcmQuc2NvcmVzID0gMTQ7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBsZXQgY2FyZHMgPSBvcmlnaW5DYXJkcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgcmV0dXJuIGEuc2NvcmVzIC0gYi5zY29yZXM7XG4gICAgfSk7XG4gICAgLy9jYy5sb2coY2FyZHMpXG4gICAgLy9jYy5sb2cob3JpZ2luQ2FyZHMpXG4gICAgLy9jYy5sb2coJy0tLS0tLS0tMjUnKVxuICAgIC8vY2FyZHMuc29ydChmdW5jdGlvbihhLGIpe1xuICAgIC8vICAgIHJldHVybiBhLnNjb3JlcyAtIGIuc2NvcmVzO1xuICAgIC8vfSk7XG4gICAgLy9vcmlnaW5DYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQShvcmlnaW5DYXJkcyk7XG5cbiAgICBsZXQgZmluZEZ1bmNzID0gW1xuICAgICAgICBLUUNhcmQuZmluZFd1VG9uZyxcbiAgICAgICAgS1FDYXJkLmZpbmRUb25nSHVhU2h1bixcbiAgICAgICAgS1FDYXJkLmZpbmRUaWVaaGksXG4gICAgICAgIEtRQ2FyZC5maW5kSHVMdSxcbiAgICAgICAgS1FDYXJkLmZpbmRUb25nSHVhLFxuICAgICAgICBLUUNhcmQuZmluZFNodW5aaSxcbiAgICAgICAgS1FDYXJkLmZpbmRTYW5UaWFvLFxuICAgICAgICBLUUNhcmQuZmluZExpYUR1aSxcbiAgICAgICAgS1FDYXJkLmZpbmREdWlaaVxuICAgIF07XG5cbiAgICBsZXQgaW5kZXhBcnJheXMgPSBudWxsO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmluZEZ1bmNzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGxldCBmdW5jID0gZmluZEZ1bmNzW2ldO1xuICAgICAgICBpbmRleEFycmF5cyA9IChmdW5jLmJpbmQoS1FDYXJkKSkoY2FyZHMpO1xuICAgICAgICBpZiAoaW5kZXhBcnJheXMgJiYgaW5kZXhBcnJheXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgaW5kZXhzID0gW107XG4gICAgaWYgKGluZGV4QXJyYXlzICYmIGluZGV4QXJyYXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8g5om+5Ye65ZCM57G75Z6L55qE54mM6YeM55qE5YiG5pWw5pyA5aSn55qE54mMXG4gICAgICAgIHZhciBtYXhTY29yZSA9IDA7XG4gICAgICAgIGluZGV4QXJyYXlzLmZvckVhY2godGVtcEluZGV4cyA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ZW1wQ2FyZHMgPSB0ZW1wSW5kZXhzLm1hcChpbmRleCA9PiBjYXJkc1tpbmRleF0pO1xuICAgICAgICAgICAgY29uc3Qgc2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHRlbXBDYXJkcyk7XG4gICAgICAgICAgICBpZiAoc2NvcmUgPiBtYXhTY29yZSkge1xuICAgICAgICAgICAgICAgIG1heFNjb3JlID0gc2NvcmU7XG4gICAgICAgICAgICAgICAgaW5kZXhzID0gdGVtcEluZGV4cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbGV0IHRhcmdldENhcmRzID0gaW5kZXhzLm1hcChmdW5jdGlvbihpbmRleCkge1xuICAgICAgICByZXR1cm4gY2FyZHNbaW5kZXhdO1xuICAgIH0pO1xuXG4gICAgaWYgKHRhcmdldENhcmRzLmxlbmd0aCA8IG1heExlbmd0aCkge1xuICAgICAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKHRhcmdldENhcmRzKTtcbiAgICAgICAgd2hpbGUodGFyZ2V0Q2FyZHMubGVuZ3RoIDwgbWF4TGVuZ3RoKSB7XG4gICAgICAgICAgICB0YXJnZXRDYXJkcy5wdXNoKGNhcmRzLnBvcCgpKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGFyZ2V0Q2FyZHMubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XG4gICAgICAgIHRhcmdldENhcmRzID0gdGFyZ2V0Q2FyZHMuc2xpY2UobywgbWF4TGVuZ3RoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGFyZ2V0Q2FyZHM7XG59O1xuXG5LUUNhcmQudGVzdEF1dG9TZWxlY3QgPSBmdW5jdGlvbihjYXJkcykge1xuXG59OyIsImNvbnN0IEtRQ2FyZENvbG9yc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZENvbG9yc0hlbHBlcicpO1xuY29uc3QgS1FDYXJkUG9pbnRzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUG9pbnRzSGVscGVyJyk7XG5jb25zdCBOdW1iZXJFeHRlbnNpb24gPSByZXF1aXJlKCdOdW1iZXJFeHRlbnNpb24nKTtcbmNvbnN0IEdldENhcmRQb2ludHNTYW1lQ291bnQgPSByZXF1aXJlKCdHZXRDYXJkUG9pbnRzU2FtZUNvdW50Jyk7XG5cbmNjID0gY2MgfHwge307XG5jYy5hc3NlcnQgPSBjYy5hc3NlcnQgfHwgY29uc29sZS5hc3NlcnQgfHwgZnVuY3Rpb24gKCkge307XG5jYy5sb2cgPSBjYy5sb2cgfHwgY29uc29sZS5sb2cgfHwgZnVuY3Rpb24gKCkge307XG5jYy5lcnJvciA9IGNjLmVycm9yIHx8IGNvbnNvbGUuZXJyb3IgfHwgZnVuY3Rpb24gKCkge307XG5cbi8vIOeJjCBNb2RlbCDnsbvvvIzlsIHoo4XkuoboirHoibLlkozngrnmlbBcbi8vIOS9v+eUqO+8mlxuLy8gbmV3IEtRQ2FyZCgyMik7XG52YXIgS1FDYXJkID0gZnVuY3Rpb24gKHBvaW50LCBjb2xvciAsaW5kZXgpIHtcbiAgICB0aGlzLmNvbG9yID0gbnVsbDtcbiAgICB0aGlzLnBvaW50ID0gbnVsbDtcbiAgICB0aGlzLnNpbmRleCA9IGluZGV4O1xuICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludCA9IGZ1bmN0aW9uIChjb2xvciwgcG9pbnQpIHtcbiAgICAgICAgaWYgKGNvbG9yID09ICdzJykgeyBjb2xvciA9IDQ7fVxuICAgICAgICBpZiAoY29sb3IgPT0gJ2gnKSB7IGNvbG9yID0gMzt9XG4gICAgICAgIGlmIChjb2xvciA9PSAnYycpIHsgY29sb3IgPSAyO31cbiAgICAgICAgaWYgKGNvbG9yID09ICdkJykgeyBjb2xvciA9IDE7fVxuXG4gICAgICAgIHRoaXMucG9pbnQgPSBOdW1iZXIocG9pbnQpO1xuICAgICAgICB0aGlzLnNjb3JlcyA9IE51bWJlcihwb2ludCk7XG4gICAgICAgIHRoaXMuY29sb3IgPSBOdW1iZXIoY29sb3IpO1xuICAgICAgICB0aGlzLmNvbG9yU2NvcmVzID0gTnVtYmVyKGNvbG9yKTtcblxuICAgICAgICBjYy5hc3NlcnQodGhpcy5wb2ludCA+IDApO1xuICAgICAgICBjYy5hc3NlcnQodGhpcy5jb2xvciA+IDApO1xuICAgIH07XG5cbiAgICB0aGlzLl9pbml0V2l0aE51bWJlciA9IGZ1bmN0aW9uIChudW1iZXIpIHtcbiAgICAgICAgdGhpcy5wb2ludCA9IE1hdGguZmxvb3IobnVtYmVyIC8gMTApO1xuICAgICAgICB0aGlzLmNvbG9yID0gbnVtYmVyICUgMTA7XG4gICAgICAgIGNjLmFzc2VydCh0aGlzLnBvaW50ID4gMCk7XG4gICAgICAgIGNjLmFzc2VydCh0aGlzLmNvbG9yID4gMCk7XG4gICAgfTtcblxuICAgIHRoaXMuX2luaXRXaXRoT2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICBpZiAob2JqZWN0LnBvaW50KSB7XG4gICAgICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQob2JqZWN0LmNvbG9yLCBvYmplY3QucG9pbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKG9iamVjdC5zdWl0KSB7XG4gICAgICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQob2JqZWN0LnN1aXQsIG9iamVjdC5udW1iZXIpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhcmROYW1lKCk7XG4gICAgfTtcblxuICAgIHRoaXMuY2FyZE5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yICsgXCJfXCIgKyB0aGlzLnBvaW50O1xuICAgIH07XG5cbiAgICB0aGlzLnNvcnQgPSBmdW5jdGlvbiAob3RoZXJDYXJkLCBhc2MgPSBmYWxzZSwgQWlzTWF4ID0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLnNvcnQodGhpcywgb3RoZXJDYXJkLCBhc2MsIEFpc01heCk7XG4gICAgfTtcblxuICAgIHRoaXMuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlckNhcmQpIHtcbiAgICAgICAgaWYgKCFvdGhlckNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHRoaXMucG9pbnQgPT0gb3RoZXJDYXJkLnBvaW50KSAmJiAodGhpcy5jb2xvciA9PSBvdGhlckNhcmQuY29sb3IpXG4gICAgICAgICAgICAmJiAodGhpcy5zaW5kZXggPT0gb3RoZXJDYXJkLnNpbmRleCk7XG4gICAgfTtcblxuICAgIGlmIChwb2ludCAmJiBjb2xvcikge1xuICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQoY29sb3IsIHBvaW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBudW1iZXIgPSBOdW1iZXIocG9pbnQpO1xuICAgIGlmICghTnVtYmVyLmlzTmFOKG51bWJlcikpIHtcbiAgICAgICAgdGhpcy5faW5pdFdpdGhOdW1iZXIobnVtYmVyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YocG9pbnQpID09ICdzdHJpbmcnKSB7XG4gICAgICAgIC8vIOino+aekCB4eHh4ZF9kIOW9ouW8j1xuICAgICAgICBsZXQgZm91bmQgPSBwb2ludC5tYXRjaCgvKFxcLikqXFxkX1xcZCsvKTtcbiAgICAgICAgaWYgKChmb3VuZCBpbnN0YW5jZW9mIEFycmF5KSAmJiBmb3VuZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gZm91bmRbMF07XG4gICAgICAgICAgICBsZXQgbnVtYmVycyA9IHJlc3VsdC5zcGxpdCgnXycpO1xuXG4gICAgICAgICAgICBsZXQgY29sb3IgPSBOdW1iZXIobnVtYmVyc1swXSk7XG4gICAgICAgICAgICBsZXQgcG9pbnQgPSBOdW1iZXIobnVtYmVyc1sxXSk7XG4gICAgICAgICAgICB0aGlzLl9pbml0V2l0aENvbG9yQW5kUG9pbnQoY29sb3IsIHBvaW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mKHBvaW50KSA9PSAnb2JqZWN0Jykge1xuICAgICAgICB0aGlzLl9pbml0V2l0aE9iamVjdChwb2ludCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjYy5lcnJvcihcIuWIneWni+WMlumUmeivr++8mlwiICsgcG9pbnQgKyBcIiBcIiArIGNvbG9yKTtcbn07XG5cbi8vIOi9rOaNouaIkOacjeWKoeWZqOeahOeJjCBtb2RlbFxuS1FDYXJkLnByb3RvdHlwZS50b1NlcnZlckNhcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgJ3N1aXQnOiB0aGlzLmNvbG9yLFxuICAgICAgICAnbnVtYmVyJzogdGhpcy5wb2ludCxcbiAgICB9O1xufTtcblxuS1FDYXJkLkNPTE9SX1NQQURFICAgPSA0O1xuS1FDYXJkLkNPTE9SX0hFQVJUICAgPSAzO1xuS1FDYXJkLkNPTE9SX0NMVUIgICAgPSAyO1xuS1FDYXJkLkNPTE9SX0RJQU1PTkQgPSAxO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZDtcblxuS1FDYXJkLmNhcmRzRnJvbUFycmF5ID0gZnVuY3Rpb24gKGNhcmROYW1lcykge1xuICAgIHJldHVybiBjYXJkTmFtZXMubWFwKGZ1bmN0aW9uIChjYXJkTmFtZSxpbmRleCkge1xuICAgICAgICByZXR1cm4gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICB9KTtcbn07XG5cbi8vIOWwhuWkmuW8oOeJjOi9rOaNouaIkOacjeWKoeWZqOeahOW9ouW8j1xuS1FDYXJkLmNvbnZlcnRUb1NlcnZlckNhcmRzID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgcmV0dXJuIGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC50b1NlcnZlckNhcmQoKTtcbiAgICB9KTtcbn07XG5cbktRQ2FyZC5UWVBFID0ge1xuICAgIFd1TG9uZzogMCxcbiAgICBEdWlaaTogMSxcbiAgICBMaWFuZ0R1aTogMixcbiAgICBTYW5UaWFvOiAzLFxuICAgIFNodW5aaTogNCxcbiAgICBUb25nSHVhOiA1LFxuICAgIEh1THU6IDYsXG4gICAgVGllWmhpOiA3LFxuICAgIFRvbmdIdWFTaHVuOiA4LFxuICAgIC8qIyMjIyMqL1xuICAgIFd1VG9uZzo5LFxuICAgIC8qIyMjIyMqL1xuICAgIFNhblRhb0h1YTogMTAsICAvLyDnibnmrorniYxcbiAgICBTYW5TaHVuWmk6IDExLFxuICAgIExpdUR1aUJhbjogMTIsXG5cbiAgICBXdUR1aVNhblRpYW86MTMsXG4gICAgU2lUYW9TYW5UaWFvOiAxNCxcblxuICAgIENvdVlpU2U6IDE1LFxuICAgIFNhbkZlblRpYW5YaWE6IDE2LFxuICAgIFNhblRvbmdIdWFTaHVuOiAxNyxcbiAgICBZaVRpYW9Mb25nOiAxOCxcbiAgICBRaW5nTG9uZzogMTksXG59O1xuXG4vLyDniYznsbvlnovlkI1cbktRQ2FyZC5jYXJkc1R5cGVOYW1lID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IG5hbWVzID0gWyfkuYzpvpknLCAn5a+55a2QJywgJ+S4pOWvuScsICfkuInmnaEnLCAn6aG65a2QJywgJ+WQjOiKsScsICfokavoiqYnLCAn6ZOB5pSvJywgJ+WQjOiKsemhuicsICfkupTlkIwnLFxuICAgICAgICAn5LiJ5ZCM6IqxJywgJ+S4iemhuuWtkCcsJ+WFreWvueWNiicsICfkupTlr7nkuInmnaEnLCAn5Zub5aWX5LiJ5p2hJyxcbiAgICAgICAgJ+WHkeS4gOiJsicsJ+S4ieWIhuWkqeS4iycsICfkuInlkIzoirHpobonLCAn5LiA5p2h6b6ZJywgJ+a4hem+mSddO1xuICAgIGxldCB0eXBlID0gS1FDYXJkLmNhcmRzVHlwZShjYXJkcyk7XG4gICAgcmV0dXJuIG5hbWVzW3R5cGVdO1xufTtcblxuLy8g5om+5Ye654mM55qE57G75Z6LXG5LUUNhcmQuY2FyZHNUeXBlID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKEtRQ2FyZC5pc1FpbmdMb25nKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuUWluZ0xvbmc7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5ZaVRpYW9Mb25nO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNTYW5Ub25nSHVhU2h1bihjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhblRvbmdIdWFTaHVuO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNTYW5GZW5UaWFuWGlhKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuRmVuVGlhblhpYTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmlzTGl1RHVpQmFuKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuTGl1RHVpQmFuO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNTYW5Ub25nSHVhKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuVGFvSHVhO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5TaHVuWmk7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1NhblNodW5aaTEoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5TaHVuWmk7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc0NvdVlpU2UoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5Db3VZaVNlO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNXdUR1aVNhblRpYW8oY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdUR1aVNhblRpYW87XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1NpVGFvU2FuVGlhbyhjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNpVGFvU2FuVGlhbztcbiAgICB9XG5cbiAgICAvKiMjIyMjKi9cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZHMsIDUpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdVRvbmc7XG4gICAgfVxuXG4gICAgLy9pZiAoS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcbiAgICAvL31cbiAgICAvL1xuICAgIC8vaWYgKEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRzKSkge1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdVRvbmc7XG4gICAgLy99XG4gICAgLyojIyMjIyovXG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcywgNSkpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlRvbmdIdWFTaHVuO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpblRpZVpoaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlRpZVpoaTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5IdUx1KGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuSHVMdTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVG9uZ0h1YTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5TaHVuWmkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TaHVuWmk7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhblRpYW87XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluTGlhRHVpKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuTGlhbmdEdWk7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluRHVpWmkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5EdWlaaTtcbiAgICB9XG5cbiAgICByZXR1cm4gS1FDYXJkLlRZUEUuV3VMb25nO1xufTtcblxuLy8g5Yik5pat5piv5ZCm5piv5ZCM6IqxXG5LUUNhcmQuaXNUb25nSHVhID0gZnVuY3Rpb24oY2FyZHMsIG1pbkxlbmd0aCA9IDMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgY29sb3JzID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLmNvbG9yO1xuICAgIH0pO1xuXG4gICAgbGV0IGNvbG9yID0gY29sb3JzWzBdO1xuICAgIGZvciAobGV0IGluZGV4IGluIGNvbG9ycykge1xuICAgICAgICBsZXQgZSA9IGNvbG9yc1tpbmRleF07XG4gICAgICAgIGlmIChlICE9IGNvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG4vLyDmmK/lkKbljIXlkKvlkIzoirFcbktRQ2FyZC5jb250YWluVG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkcywgbWluTGVuZ3RoID0gNSkge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRUb25nSHVhKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy9jYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICAgIC8vY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuICAgIC8vXG4gICAgLy9mb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG1pbkxlbmd0aCkgPD0gY2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgLy8gICAgbGV0IHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbWluTGVuZ3RoKTtcbiAgICAvLyAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YShzdWJDYXJkcywgbWluTGVuZ3RoKSkge1xuICAgIC8vICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyAgICB9XG4gICAgLy99XG5cbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWEyMChjYXJkcyk7XG59O1xuS1FDYXJkLmNvbnRhaW5Ub25nSHVhMjAgPSBmdW5jdGlvbiAoY2FyZCkge1xuICAgIGlmIChjYXJkLmxlbmd0aCA8IDUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkKTtcbiAgICB2YXIgY2FyZHMgPSBjYXJkLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuXG4gICAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICAgICAgdmFyIG51bSA9IDUgLSBqO1xuICAgICAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gY2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICAgICAgICB2YXIgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWEoc3ViQ2FyZHMsIG51bSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuLy8g5Yik5pat5piv5ZCm5piv6aG65a2QXG5LUUNhcmQuaXNTaHVuWmkgPSBmdW5jdGlvbihjYXJkcywgbWluTGVuZ3RoID0gMykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuX2lzU2h1blppQUtRKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBsZXQgcG9pbnRzID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLnBvaW50O1xuICAgIH0pLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICB9KTtcblxuICAgIHZhciBwb2ludCA9IHBvaW50c1swXTtcbiAgICBmb3IgKHZhciBpbmRleCBpbiBwb2ludHMpIHtcbiAgICAgICAgdmFyIGUgPSBwb2ludHNbaW5kZXhdO1xuICAgICAgICBpZiAoZSAhPSBwb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcG9pbnQgPSBwb2ludCArIDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG4vLyDliKTmlq3mmK/lkKbmmK8gQSBLIFEgSiAxMCDov5nkuKrpobrlrZBcbktRQ2FyZC5faXNTaHVuWmlBS1EgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gY2FyZHMubGVuZ3RoO1xuICAgIGlmIChsZW5ndGgubGVuZ3RoIDwgMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHBvaW50MXMgPSBbMV07XG4gICAgbGV0IHBvaW50MTRzID0gWzE0XTtcbiAgICBsZXQgcG9pbnRLID0gMTM7XG5cbiAgICBOdW1iZXIobGVuZ3RoIC0gMSkua3FfdGltZXMoZnVuY3Rpb24odGltZXMpIHtcbiAgICAgICAgcG9pbnQxcy5wdXNoKHBvaW50SyAtIHRpbWVzKTtcbiAgICAgICAgcG9pbnQxNHMucHVzaChwb2ludEsgLSB0aW1lcyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gS1FDYXJkLl9pc0NhcmRzQ29udGFpblBvaW50cyhjYXJkcywgcG9pbnQxcykgfHwgS1FDYXJkLl9pc0NhcmRzQ29udGFpblBvaW50cyhjYXJkcywgcG9pbnQxNHMpO1xufTtcblxuLy8gY2FyZHMg5Lit5piv5ZCm5YyF5ZCrIHBvaW50cyDov5nkupvngrnmlbBcblxuS1FDYXJkLl9pc0NhcmRzQ29udGFpblBvaW50cyA9IGZ1bmN0aW9uKGNhcmRzLCBwb2ludHMpIHtcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcG9pbnRzLmxlbmd0aDsgKytpbmRleCkge1xuICAgICAgICBsZXQgcG9pbnQgPSBwb2ludHNbaW5kZXhdO1xuICAgICAgICBsZXQgcG9pbnRDYXJkSW5kZXggPSBjYXJkcy5maW5kSW5kZXgoZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gcG9pbnQ7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChwb2ludENhcmRJbmRleCA8IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufTtcbktRQ2FyZC5jb250YWluMjAgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZih0eXBlb2YoY2FyZHNbMF0ucG9pbnQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZHMpO1xuICAgIH1cbiAgICB2YXIgbmV3Q2FyZCA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihjYXJkKXsvL+mHjeaWsOi1i+WAvGNhcmRzXG4gICAgICAgIGlmKGNhcmQucG9pbnQgPj0gMjApe1xuICAgICAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gbmV3Q2FyZCB8fCBbXTtcbn07XG4vLyDmmK/lkKbljIXlkKvpobrlrZBcbktRQ2FyZC5jb250YWluU2h1blppID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZFNodW5aaShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vbGV0IHVuaXF1ZUNhcmRzID0gY2FyZHMudW5pcXVlKGZ1bmN0aW9uKGNhcmQxLCBjYXJkMikge1xuICAgIC8vICAgIHJldHVybiBjYXJkMS5wb2ludCA9PSBjYXJkMi5wb2ludDtcbiAgICAvL30pO1xuICAgIC8vdW5pcXVlQ2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpO1xuICAgIC8vXG4gICAgLy9sZXQgbWluUG9pbnRDYXJkID0gdW5pcXVlQ2FyZHNbMF07XG4gICAgLy9pZiAobWluUG9pbnRDYXJkLnBvaW50ID09IDEpIHtcbiAgICAvLyAgICBsZXQgQVBsdXNDYXJkID0gbmV3IEtRQ2FyZChtaW5Qb2ludENhcmQpO1xuICAgIC8vICAgIEFQbHVzQ2FyZC5wb2ludCA9IDE0O1xuICAgIC8vICAgIHVuaXF1ZUNhcmRzLnB1c2goQVBsdXNDYXJkKTtcbiAgICAvL31cbiAgICAvL1xuICAgIC8vZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBtaW5MZW5ndGgpIDw9IHVuaXF1ZUNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgIC8vICAgIGxldCBzdWJDYXJkcyA9IHVuaXF1ZUNhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG1pbkxlbmd0aCk7XG4gICAgLy8gICAgaWYgKEtRQ2FyZC5pc1NodW5aaShzdWJDYXJkcywgbWluTGVuZ3RoKSkge1xuICAgIC8vICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyAgICB9XG4gICAgLy99XG4gICAgLy9cbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpblNodW5aaTIwKGNhcmRzKTtcbn07XG4vKktRQ2FyZC5jb250YWluU2h1blppMjAgPSBmdW5jdGlvbiAoY2FyZCkge1xuICAgIGlmIChjYXJkLmxlbmd0aCA8IDUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkKTtcbiAgICB2YXIgY2FyZHMgPSBjYXJkLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgLy8g5YWI5qC55o2u54K55pWw5Y676YeNXG4gICAgdmFyIG5ld0FyciA9IFtdO1xuICAgIHZhciBuZXdBcnJzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAobmV3QXJycy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSkge1xuICAgICAgICAgICAgbmV3QXJyLnB1c2goY2FyZHNbaV0pO1xuICAgICAgICAgICAgbmV3QXJycy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvL25ld0Fyci5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpe1xuICAgIC8vICAgIGlmKGNhcmQuc2NvcmVzID09IDE0KXtcbiAgICAvLyAgICAgICAgY2FyZC5zY29yZXMgPSAxO1xuICAgIC8vICAgIH1cbiAgICAvL30pXG4gICAgbmV3QXJyLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICByZXR1cm4gbjEucG9pbnQgLSBuMi5wb2ludDtcbiAgICB9KTtcbiAgICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuICAgICAgICB2YXIgbnVtID0gNSAtIGo7XG4gICAgICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBuZXdBcnIubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICAgICAgICB2YXIgc3ViQ2FyZHMgPSBuZXdBcnIuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiAgICAgICAgICAgIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcbiAgICAgICAgICAgIGlmKGJvb2wpe1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIOeUseS6jueCueaVsOaYr+WUr+S4gOS4lOWNh+W6j++8jOWPqumcgOimgeS+neasoemBjeWOhuWIpOaWreaYr+WQpuaYr+mhuuWtkOWNs+WPr1xuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZCk7XG4gICAgaWYgKGNhcmQgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5jb250YWluU2h1blppMjAoY29udmVydGVkQ2FyZHMpO1xufTsqL1xuLy8g5piv5ZCm5piv5ZCM6Iqx6aG6XG5LUUNhcmQuaXNUb25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHJldHVybiBLUUNhcmQuaXNUb25nSHVhKGNhcmRzKSAmJiBLUUNhcmQuaXNTaHVuWmkoY2FyZHMpO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5pyJ5ZCM6Iqx6aG6XG5LUUNhcmQuY29udGFpblRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZFRvbmdIdWFTaHVuKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy92YXIgc2FuU2h1blppID0gS1FDYXJkLnNhblNodW5aaTEoY2FyZHMsbWluTGVuZ3RoKVswXTtcbiAgICAvL2lmKHNhblNodW5aaSA9PSBudWxsKXtcbiAgICAvLyAgICByZXR1cm4gZmFsc2U7XG4gICAgLy99XG4gICAgLy92YXIgcmVzdWx0ID0gZmFsc2U7XG4gICAgLy9mb3IodmFyIGk9MDtpPHNhblNodW5aaS5sZW5ndGg7aSsrKSB7XG4gICAgLy8gICAgdmFyIHMgPSBzYW5TaHVuWmlbaV07XG4gICAgLy8gICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHMsIG1pbkxlbmd0aCkpIHtcbiAgICAvLyAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgfVxuICAgIC8vfVxuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4xKGNhcmRzKTtcblxufTtcbi8qS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjEgPSBmdW5jdGlvbiAoY2FyZHMsIG1pbkxlbmd0aCA9IDUpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IHRlbXBDYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG1pbkxlbmd0aCkgPD0gdGVtcENhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgICBsZXQgc3ViQ2FyZHMgPSB0ZW1wQ2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbWluTGVuZ3RoKTtcbiAgICAgICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZHMpO1xuICAgIGlmIChjYXJkcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4yMChjYXJkcyk7XG4gICAgfVxuICAgIHJldHVybiBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMShjb252ZXJ0ZWRDYXJkcyk7XG4gICAgLy9yZXR1cm4gZmFsc2U7XG59O1xuS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjIwID0gZnVuY3Rpb24gKGNhcmQsIG1pbkxlbmd0aCA9IDUpIHtcbiAgICBpZiAoY2FyZC5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkKSB8fCBbXTtcbiAgICB2YXIgY2FyZHMgPSBjYXJkLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG5cbiAgICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICAgIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgICB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXG4gICAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICAgIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcbiAgICB2YXIgcG9pbnRTID0gW107IC8v6buR5qGDXG4gICAgdmFyIHBvaW50SCA9IFtdOyAvL+e6ouW/g1xuICAgIHZhciBwb2ludEMgPSBbXTsgLy/mooXoirFcbiAgICB2YXIgcG9pbnREID0gW107IC8v5pa55Z2XXG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzQnKXtcbiAgICAgICAgICAgIGlmKHBvaW50Uy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgICAgICAgICAgcG9pbnRTLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICAgICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xuICAgICAgICAgICAgaWYocG9pbnRILmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgICAgICAgICBwb2ludEgucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgICAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMicpe1xuICAgICAgICAgICAgaWYocG9pbnRDLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgICAgICAgICBwb2ludEMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgICAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMScpe1xuICAgICAgICAgICAgaWYocG9pbnRELmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgICAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGNvbG9yID0gW2NvbG9yUyxjb2xvckgsY29sb3JDLGNvbG9yRF07XG4gICAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gICAgZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IHBhcnNlSW50KDUgLSBjYXJkMjAubGVuZ3RoKSl7XG4gICAgICAgICAgICAvL2NvbG9yW2ldLmZvckVhY2goZnVuY3Rpb24oY2Epe1xuICAgICAgICAgICAgLy8gICAgaWYoY2Euc2NvcmVzID09IDE0KXtcbiAgICAgICAgICAgIC8vICAgICAgICBjYS5zY29yZXMgPSAxO1xuICAgICAgICAgICAgLy8gICAgfVxuICAgICAgICAgICAgLy99KVxuICAgICAgICAgICAgY29sb3JbaV0uc29ydChmdW5jdGlvbihhMSxhMil7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGExIC0gYTI7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcbiAgICAgICAgdmFyIHMgPSBjb2xvclN1bVtpXVxuICAgICAgICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuICAgICAgICAgICAgdmFyIG51bSA9IDUgLSBqO1xuICAgICAgICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1YkNhcmRzID0gcy5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgICAgICAgICAgIHZhciBib29sID0gcGFyc2VJbnQoc3ViQ2FyZHNbbnVtLTFdWydzY29yZXMnXSkgLSBwYXJzZUludChzdWJDYXJkc1swXVsnc2NvcmVzJ10pIDwgNTtcbiAgICAgICAgICAgICAgICBpZihib29sKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG5cblxuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZCk7XG4gICAgaWYgKGNhcmQgPT09IGNvbnZlcnRlZENhcmRzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4yMChjb252ZXJ0ZWRDYXJkcyk7XG59OyovXG5cblxuLy8g5piv5ZCm5piv5riF6b6ZXG5LUUNhcmQuaXNRaW5nTG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gICAgdmFyIGNvbG9yRCA9IFtdOyAvL+aWueWdl1xuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ3MnKXtcbiAgICAgICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcpe1xuICAgICAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdjJyl7XG4gICAgICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2QnKXtcbiAgICAgICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgbHMgPSBjb2xvclMubGVuZ3RoOyAgLy/pu5HmoYPkuKrmlbBcbiAgICB2YXIgbGggPSBjb2xvckgubGVuZ3RoOyAgLy/nuqLmoYPkuKrmlbBcbiAgICB2YXIgbGMgPSBjb2xvckMubGVuZ3RoOyAgLy/mooXoirHkuKrmlbBcbiAgICB2YXIgbGQgPSBjb2xvckQubGVuZ3RoOyAgLy/mlrnlnZfkuKrmlbBcbiAgICB2YXIgY29sb3IgPSBbbHMsbGgsbGMsbGRdO1xuICAgIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxuICAgIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNvbG9yW2ldICE9IDApe1xuICAgICAgICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYoY29sb3JTdW0ubGVuZ3RoID09IDEpe1xuICAgICAgICBpZihjb2xvclN1bVswXSA9PSAxMyl7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy9yZXR1cm4gS1FDYXJkLmlzVG9uZ0h1YVNodW4oY2FyZHMpO1xuICAgIHJldHVybiBmYWxzZTtcbn07XG5cbi8vIOaYr+WQpuaYr+S4gOadoem+mVxuS1FDYXJkLmlzTG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIEtRQ2FyZC5pc1NodW5aaShjYXJkcyk7XG59O1xuXG4vKiMjIyMjKi9cbi8q5piv5ZCm5LiA5p2h6b6ZKi9cbktRQ2FyZC5pc1lpVGlhb0xvbmcgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAvL2NhcmRzOntudW1iZXI6MX4xMyAsJ3N1aXQnOidoJy4uLn1cbiAgICB2YXIgbGVuZ3RoID0gMTM7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5udW1iZXIpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMoY2FyZHMpO1xuICAgIH1cbiAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgcmV0dXJuIG4xIC0gbjI7XG4gICAgfSk7XG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGgtMTtpKyspIHtcbiAgICAgICAgaWYobnVtYmVyW2ldICE9IG51bWJlcltpKzFdIC0gMSl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuLyojIyMjIyovXG4vKuaYr+WQpuS4ieWQjOiKsSovXG5LUUNhcmQuaXNTYW5Ub25nSHVhID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mKGNhcmRzWzBdLnN1aXQpID09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzKGNhcmRzKTtcbiAgICB9XG4gICAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gICAgdmFyIGNvbG9yRCA9IFtdOyAvL+aWueWdl1xuICAgIGZvcih2YXIgaT0wO2k8Y2FyZHMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ3MnKXtcbiAgICAgICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcpe1xuICAgICAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdjJyl7XG4gICAgICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2QnKXtcbiAgICAgICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgbHMgPSBjb2xvclMubGVuZ3RoOyAgLy/pu5HmoYPkuKrmlbBcbiAgICB2YXIgbGggPSBjb2xvckgubGVuZ3RoOyAgLy/nuqLmoYPkuKrmlbBcbiAgICB2YXIgbGMgPSBjb2xvckMubGVuZ3RoOyAgLy/mooXoirHkuKrmlbBcbiAgICB2YXIgbGQgPSBjb2xvckQubGVuZ3RoOyAgLy/mlrnlnZfkuKrmlbBcbiAgICB2YXIgY29sb3IgPSBbbHMsbGgsbGMsbGRdO1xuICAgIHZhciBjb2xvclN1bSA9IFtdOyAgICAvL+aAu+WFseacieWHoOenjeiKseiJsiBbNSwzLDAuLi4uXVxuICAgIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKGNvbG9yW2ldICE9IDApe1xuICAgICAgICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL+WmguaenOeJjOS4reWMheWQq+Wbm+enjeiKseiJsuWwseS4jeWPr+iDveaYr+S4ieWQjOiKsVxuICAgIGlmKGNvbG9yU3VtLmxlbmd0aCA9PSA0KXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8v5LiJ56eN6Iqx6ImyXG4gICAgaWYoY29sb3JTdW0ubGVuZ3RoID09IDMpe1xuICAgICAgICBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgIGlmIChjb2xvclN1bVtpXSAhPSA1ICYmIGNvbG9yU3VtW2ldICE9IDMpe1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy/kuKTnp43oirHoibJcbiAgICBlbHNlIGlmKGNvbG9yU3VtLmxlbmd0aCA9PSAyKXtcbiAgICAgICAgZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICBpZiAoKGNvbG9yU3VtW2ldICE9IDEwICYmIGNvbG9yU3VtW2ldICE9IDMpICYmIChjb2xvclN1bVtpXSAhPSA4ICYmIGNvbG9yU3VtW2ldICE9IDUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8v5LiA56eN6Iqx6ImyXG4gICAgZWxzZSBpZihjb2xvclN1bS5sZW5ndGggPT0gMSl7XG4gICAgICAgIGlmKGNvbG9yU3VtWzBdID09IDEzKXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxufTtcbi8q5piv5ZCm5YeR5LiA6ImyKi9cbktRQ2FyZC5pc0NvdVlpU2UgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMTM7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5zdWl0KSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgfVxuICAgIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgICB2YXIgY29sb3JIID0gW107IC8v57qi5b+DXG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY2FyZHNbaV0uc3VpdCA9PSAncycgfHwgY2FyZHNbaV0uc3VpdCA9PSAnYycpe1xuICAgICAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pOy8v5YWo6buRXG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2gnIHx8IGNhcmRzW2ldLnN1aXQgPT0gJ2QnKXtcbiAgICAgICAgICAgIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTsvL+WFqOe6olxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy/lpoLmnpzniYzkuK3ljIXlkKvlm5vnp43oirHoibLlsLHkuI3lj6/og73mmK/kuInlkIzoirFcbiAgICBpZihjb2xvclMubGVuZ3RoID09IDEzIHx8IGNvbG9ySC5sZW5ndGggPT0gMTMpe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy9lbHNlIGlmKGNvbG9ySC5sZW5ndGggPT0gMTMpe1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG4vKiMjIyMjKi9cbi8vIOaYr+WQpuaYr+WFreWvueWNilxuS1FDYXJkLmlzTGl1RHVpQmFuID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEyO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBkdWlaaUxlbmd0aCA9IDI7XG4gICAgLy/orqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcbiAgICBsZXQgY2FyZE51bWJlcnMgPSBuZXcgR2V0Q2FyZFBvaW50c1NhbWVDb3VudChjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mRHVpWmkgPSAwO1xuICAgIGxldCBudW1iZXJPZllpID0gMDtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNhcmROdW1iZXJzKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IGNhcmROdW1iZXJzW3Byb3BdO1xuICAgICAgICBpZiAodmFsdWUgPT0gZHVpWmlMZW5ndGgpIHtcbiAgICAgICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSA+PSA0KSB7XG4gICAgICAgICAgICBudW1iZXJPZkR1aVppID0gbnVtYmVyT2ZEdWlaaSArIDI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT0gMSkge1xuICAgICAgICAgICAgbnVtYmVyT2ZZaSArPSAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudW1iZXJPZkR1aVppID09IDY7XG59O1xuXG5LUUNhcmQuaXNXdUR1aVNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGR1aVppTGVuZ3RoID0gMjtcbiAgICBsZXQgc2FuVGlhb0xlbmd0aCA9IDM7XG4gICAgLy/orqHnrpfkuIDkuKrniYzmlbDnu4TlhoXnmoTnm7jlkIzngrnmlbDnmoTniYznmoTlvKDmlbBcbiAgICBsZXQgY2FyZE51bWJlcnMgPSBuZXcgR2V0Q2FyZFBvaW50c1NhbWVDb3VudChjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mRHVpWmkgPSAwO1xuICAgIGxldCBudW1iZXJPZlNhblRpYW8gPSAwO1xuICAgIGZvciAobGV0IHByb3AgaW4gY2FyZE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gY2FyZE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSBkdWlaaUxlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09IHNhblRpYW9MZW5ndGgpIHtcbiAgICAgICAgICAgIG51bWJlck9mU2FuVGlhbyA9IG51bWJlck9mU2FuVGlhbyArIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPj0gNCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAyO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudW1iZXJPZkR1aVppID09IDUgJiYgbnVtYmVyT2ZTYW5UaWFvID09IDE7XG59O1xuLyojIyMjIyovXG5LUUNhcmQuaXNTYW5TaHVuWmkxID0gZnVuY3Rpb24oY2FyZHMpe1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSAxMyl7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvL+WPluWHuueJjOeahOeCueaVsFxuICAgIGlmKHR5cGVvZihjYXJkc1swXS5zdWl0KSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgfVxuICAgIC8vdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIC8vaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAvLyAgICByZXR1cm4gZmFsc2U7XG4gICAgLy99XG4gICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XG4gICAgfSk7XG4gICAgLy/mjpLluo9cbiAgICBudW1iZXIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuICAgIGlmKEtRQ2FyZC5mZW5aaHUobnVtYmVyLDUsNSkgPT0gZmFsc2Upe1xuICAgICAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZC5udW1iZXI7XG4gICAgICAgIH0pO1xuICAgICAgICAvL+aOkuW6j1xuICAgICAgICBudW1iZXIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmKEtRQ2FyZC5mZW5aaHUobnVtYmVyLDUsMykgPT0gZmFsc2Upe1xuICAgICAgICAgICAgdmFyIG51bWJlciA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy/mjpLluo9cbiAgICAgICAgICAgIG51bWJlci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYoS1FDYXJkLmZlblpodShudW1iZXIsMyw1KSA9PSBmYWxzZSl7XG4gICAgICAgICAgICAgICAgdmFyIEFJc0V4aXN0ID0gZmFsc2U7ICAvL+aYr+WQpuWtmOWcqEFcbiAgICAgICAgICAgICAgICBmb3IodmFyIGkgaW4gY2FyZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoY2FyZHNbaV0ubnVtYmVyID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEFJc0V4aXN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKCFBSXNFeGlzdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpIGluIGNhcmRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGNhcmRzW2ldLm51bWJlciA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkc1tpXS5udW1iZXIgPSAxNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkxKGNhcmRzKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfWVsc2V7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn07XG5cbi8v5Yik5patNeW8oOaIluiAhTPlvKDmmK/lkKbpobrlrZBcbktRQ2FyZC5pc1NodW5aaTEgPSBmdW5jdGlvbihhcnIpe1xuICAgIGZvcih2YXIgaT0wO2k8YXJyLmxlbmd0aC0xO2krKyl7XG4gICAgICAgIGlmKGFycltpKzFdIC0gYXJyW2ldICE9IDEpe1xuICAgICAgICAgICAgLy/kuI3mmK/pobrlrZBcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbktRQ2FyZC5mZW5aaHUgPSBmdW5jdGlvbiAobnVtYmVyLG51bTEsbnVtMikge1xuICAgIHZhciBhcnIxID0gW107XG4gICAgdmFyIGFycjIgPSBbXTtcbiAgICBmb3IodmFyIGk9MDtpPG51bWJlci5sZW5ndGgtMTtpKyspe1xuICAgICAgICBpZihpID09IDApe1xuICAgICAgICAgICAgYXJyMS5wdXNoKG51bWJlclswXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYobnVtYmVyW2krMV0gLSBudW1iZXJbaV0gPT0gMCl7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBhcnIxLnB1c2gobnVtYmVyW2krMV0pO1xuICAgICAgICBpZihhcnIxLmxlbmd0aCA9PSBudW0xKXtcbiAgICAgICAgICAgIC8v5Y+W56ys5LiA57uE5piv6aG65a2QXG4gICAgICAgICAgICBpZihLUUNhcmQuaXNTaHVuWmkxKGFycjEpKXtcbiAgICAgICAgICAgICAgICAvL+i/mTXkuKrmmK/pobrlrZAs5LuO5pWw57uE5Lit56e76ZmkXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxhcnIxLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGo9MDtqPG51bWJlci5sZW5ndGgtMTtqKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IGFycjFbaV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Lik5Liq5pWw5LiA5qC355qE5Y+q5Yig6Zmk5LiA5LiqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IG51bWJlcltqKzFdKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlci5zcGxpY2UoaiwxKTsgICAgLy/ku45udW1iZXLkuK3np7vpmaRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL+aOpeS4i+adpeWPluesrOS6jOe7hFxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8bnVtYmVyLmxlbmd0aC0xO2krKyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKGkgPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcnIyLnB1c2gobnVtYmVyWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbaSsxXSAtIG51bWJlcltpXSA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGFycjIucHVzaChudW1iZXJbaSsxXSk7XG4gICAgICAgICAgICAgICAgICAgIGlmKGFycjIubGVuZ3RoID09IG51bTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5Y+W56ys5LqM57uE5piv6aG65a2QXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoS1FDYXJkLmlzU2h1blppMShhcnIyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8YXJyMi5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBqPTA7ajxudW1iZXIubGVuZ3RoLTE7aisrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG51bWJlcltqXSA9PSBhcnIyW2ldKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+S4pOS4quaVsOS4gOagt+eahOWPquWIoOmZpOS4gOS4qlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG51bWJlcltqXSA9PSBudW1iZXJbaisxXSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXIuc3BsaWNlKGosMSk7ICAgIC8v5LuObnVtYmVy5Lit56e76ZmkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mjqXkuIvmnaXlsLHmmK/liankuIvnmoTkuoZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihLUUNhcmQuaXNTaHVuWmkxKG51bWJlcikpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS4iee7hOS5n+aYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/nrKzkuInnu4TkuI3mmK/pobrlrZBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS6jOe7hOS4jeaYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy/nrKzkuIDnu4TkuI3mmK/pobrlrZBcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn07XG4vLyBpc1NhblNodW5aaTLmmK/miJHlhpnnmoRcbktRQ2FyZC5pc1NhblNodW5aaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYodHlwZW9mKGNhcmRzWzBdLnBvaW50KSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgIGNhcmRzID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRzKTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRzKTtcbiAgICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgdmFyIHdlaSA9IFtdO1xuICAgIHZhciB6aG9uZyA9IFtdO1xuICAgIHZhciB0b3UgPSBbXTtcbiAgICB2YXIgc2FuU2h1blppID0gS1FDYXJkLnNhblNodW5aaTEoY2FyZHMpWzBdOy8v6I635Y+W5omA5pyJ57uE5ZCI55qE5aS06YGTXG4gICAgaWYoIXNhblNodW5aaSl7IC8v5L2g6L+e5aS06YGT6YO95rKh5pyJIOaAjuS5iOabtOaIkea3t1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIG5ld0NhcmQgPSBjYXJkcy5maWx0ZXIoZnVuY3Rpb24oaSl7Ly/ph43mlrDotYvlgLxjYXJkc1xuICAgICAgICByZXR1cm4gaTtcbiAgICB9KTtcbiAgICBjb25zdCBuZXdDYXJkczEgPSBbXTtcbiAgICB2YXIgbmV3UG9pbnQgPSBbXTsvL+WIpOaWrXBvaW505piv5ZCm55u45ZCMXG4gICAgdmFyIGR1aVppID0gW107Ly/lj5blh7rmnInlr7nlrZDlvZPkuK3nmoTkuIDlvKDniYxcbiAgICBmb3IodmFyIHMgaW4gY2FyZHMpe1xuICAgICAgICBpZihuZXdQb2ludC5pbmRleE9mKGNhcmRzW3NdLnBvaW50KTwwKXtcbiAgICAgICAgICAgIG5ld0NhcmRzMS5wdXNoKGNhcmRzW3NdKTtcbiAgICAgICAgICAgIG5ld1BvaW50LnB1c2goY2FyZHNbc10ucG9pbnQpO1xuICAgICAgICB9ZWxzZXsvL+WPluWHuuacieWvueWtkOW9k+S4reeahOS4gOW8oOeJjFxuICAgICAgICAgICAgZHVpWmkucHVzaChjYXJkc1tzXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNhblNodW5aaS5sZW5ndGg7ICsraikgey8v5b6q546v5omA5pyJ5aS06YGTXG4gICAgICAgIHZhciBudW1iZXIzID0gc2FuU2h1blppW2pdO1xuICAgICAgICBpZih0eXBlb2YobnVtYmVyMykgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IChpKSA8IGNhcmRzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbmV3Q2FyZHMgPSBuZXdDYXJkczEuZmlsdGVyKGZ1bmN0aW9uKGkpey8v6YeN5paw6LWL5YC8Y2FyZHNcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBuZXdDYXJkcyA9IG5ld0NhcmRzLmtxX2V4Y2x1ZGVzKG51bWJlcjMpOy8v5Yig6Zmk54mM6YeM55qE5aS06YGTXG4gICAgICAgICAgICBpZiAod2VpLmxlbmd0aCAhPSA1KSB7XG4gICAgICAgICAgICAgICAgbGV0IHN1YkNhcmRzID0gbmV3Q2FyZHMuc2xpY2UoaSwgaSArIDUpO1xuICAgICAgICAgICAgICAgIGlmIChLUUNhcmQuaXNTaHVuWmkoc3ViQ2FyZHMpKSB7Ly/lvpfliLDlsL7pgZMg5Yig6Zmk54mM6YeM55qE5bC+6YGTXG4gICAgICAgICAgICAgICAgICAgIHdlaSA9IHN1YkNhcmRzO1xuICAgICAgICAgICAgICAgICAgICBuZXdDYXJkcyA9IG5ld0NhcmRzLmtxX2V4Y2x1ZGVzKHN1YkNhcmRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3ZWkubGVuZ3RoID09IDUpey8v5oqK5Ymp5L2Z55qE54mM5ZKM5a+55a2Q55qE5Y2V5byg5ZCI5bm2XG4gICAgICAgICAgICAgICAgbGV0IHRhc2tzID0gZHVpWmkuZmlsdGVyKGZ1bmN0aW9uKGkpey8v6YeN5paw6LWL5YC85a+55a2QXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRhc2tzID0gdGFza3Mua3FfZXhjbHVkZXMobnVtYmVyMyk7Ly/liKTmlq3lpLTpgZPlkozlr7nlrZDnmoTljZXlvKDmmK/lkKbmnInnm7jlkIwg5pyJ55qE6K+d5bCx5Yig6ZmkXG4gICAgICAgICAgICAgICAgbmV3Q2FyZHMgPSBuZXdDYXJkcy5jb25jYXQodGFza3MpOy8v5oqK5Ymp5L2Z55qE54mM5ZKM5a+55a2Q55qE5Y2V5byg5ZCI5bm2XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoemhvbmcubGVuZ3RoICE9IDUgJiYgbmV3Q2FyZHMubGVuZ3RoID09IDUpIHtcbiAgICAgICAgICAgICAgICBpZiAoS1FDYXJkLmlzU2h1blppKG5ld0NhcmRzKSkgey8v5piv5LiJ6aG65a2QXG4gICAgICAgICAgICAgICAgICAgIHpob25nID0gbmV3Q2FyZHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYod2VpLmxlbmd0aCA9PSA1ICYmIHpob25nLmxlbmd0aCA9PSA1ICl7Ly/mmK/kuInpobrlrZDnu4jmraLlvqrnjq9cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7Ly/mnaXlkKcg57un57ut5ZCnXG4gICAgICAgICAgICAgICAgemhvbmcgPSBbXTt3ZWkgPSBbXTt0b3UgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZih3ZWkubGVuZ3RoID09IDUgJiYgemhvbmcubGVuZ3RoID09IDUgKXsvL+aYr+S4iemhuuWtkOe7iOatouW+queOr1xuICAgICAgICAgICAgdG91ID0gbnVtYmVyMztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7Ly/mnaXlkKcg57un57ut5ZCnXG4gICAgICAgICAgICB6aG9uZyA9IFtdO3dlaSA9IFtdO3RvdSA9IFtdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FyZHMgPSBuZXdDYXJkO1xuICAgIGlmIChLUUNhcmQuX2lzU2FuU2h1blppKHRvdSx6aG9uZyx3ZWkpKSB7Ly/mmK/kuInpobrlrZBcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZHMpO1xuICAgIGlmIChjYXJkcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gS1FDYXJkLmlzU2FuU2h1blppKGNvbnZlcnRlZENhcmRzKTtcbn07XG5cbktRQ2FyZC5zYW5TaHVuWmkxID0gZnVuY3Rpb24gKGNhcmRzLGxlbmd0aCA9IDMpIHtcbiAgICB2YXIgc2h1bnppID0gS1FDYXJkLmZpbmRTaHVuWmkoY2FyZHMsbGVuZ3RoKTtcbiAgICB2YXIgY2FyZHNUID0gW107XG4gICAgdmFyIGNhcmRzSW5kZXggPSBbXTtcbiAgICBpZihzaHVuemkgPT0gbnVsbCl7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHNodW56aS5sZW5ndGg7aSsrKXtcbiAgICAgICAgdmFyIGEgPSBzaHVuemlbaV07XG4gICAgICAgIHZhciBjYXJkc1NodW56aSA9IFtdO1xuICAgICAgICAvLyB2YXIgY2FyZHNJbmRleCA9IFtdO1xuICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgYS5sZW5ndGg7aisrKXtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGFbal07XG4gICAgICAgICAgICBpZih0eXBlb2YoY2FyZHNbaW5kZXhdKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXJkc1NodW56aS5wdXNoKGNhcmRzW2luZGV4XSk7XG5cbiAgICAgICAgfVxuICAgICAgICBjYXJkc0luZGV4LnB1c2goYSk7XG4gICAgICAgIGNhcmRzVC5wdXNoKGNhcmRzU2h1bnppKTtcbiAgICB9XG4gICAgcmV0dXJuIFtjYXJkc1QsY2FyZHNJbmRleF07XG59O1xuXG5LUUNhcmQuX2lzU2FuU2h1blppID0gZnVuY3Rpb24gKHRvdUNhcmRzLCB6aG9uZ0NhcmRzLCB3ZWlDYXJkcykge1xuICAgIHJldHVybiBLUUNhcmQuaXNTaHVuWmkodG91Q2FyZHMpICYmIEtRQ2FyZC5pc1NodW5aaSh6aG9uZ0NhcmRzKVxuICAgICAgICAmJiBLUUNhcmQuaXNTaHVuWmkod2VpQ2FyZHMpO1xufTtcbi8vIOaYr+WQpuaYr+S4ieWQjOiKsemhulxuS1FDYXJkLmlzU2FuVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMTM7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGxldCBjb2xvckNhcmRzT2JqZWN0ID0gS1FDYXJkLl9jb2xvckNsYXNzQ2FyZHMoY2FyZHMpO1xuXG4gICAgdmFyIHN1YkNhcmRzID0gW107XG4gICAgZm9yIChsZXQgcHJvcCBpbiBjb2xvckNhcmRzT2JqZWN0KSB7XG4gICAgICAgIGxldCBjYXJkcyA9IGNvbG9yQ2FyZHNPYmplY3RbcHJvcF07XG4gICAgICAgIHN1YkNhcmRzLnB1c2goY2FyZHMpO1xuICAgIH1cblxuICAgIGlmIChzdWJDYXJkcy5sZW5ndGggIT0gMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgc3ViQ2FyZHMgPSBzdWJDYXJkcy5zb3J0KGZ1bmN0aW9uIChzMSwgczIpIHtcbiAgICAgICAgcmV0dXJuIHMxLmxlbmd0aCA+IHMyLmxlbmd0aDtcbiAgICB9KTtcblxuICAgIGxldCB0b3VDYXJkcyA9IHN1YkNhcmRzWzBdO1xuICAgIGxldCB6aG9uZ0NhcmRzID0gc3ViQ2FyZHNbMV07XG4gICAgbGV0IHdlaUNhcmRzID0gc3ViQ2FyZHNbMl07XG5cbiAgICBpZiAoKHRvdUNhcmRzLmxlbmd0aCAhPSAzKSB8fCAoemhvbmdDYXJkcy5sZW5ndGggIT0gNSkgfHwgKHdlaUNhcmRzLmxlbmd0aCAhPSA1KSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIEtRQ2FyZC5faXNTYW5Ub25nSHVhU2h1bih0b3VDYXJkcywgemhvbmdDYXJkcywgd2VpQ2FyZHMpO1xufTtcblxuLy8g5bCG54mM5qC55o2uIGNvbG9yIOi/m+ihjOWIhuexu1xuS1FDYXJkLl9jb2xvckNsYXNzQ2FyZHMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgY29sb3JDYXJkc09iamVjdCA9IHt9O1xuICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgbGV0IGNvbG9yID0gY2FyZC5jb2xvcjtcbiAgICAgICAgdmFyIHN1YkNhcmRzID0gY29sb3JDYXJkc09iamVjdFtjb2xvcl07XG4gICAgICAgIGlmICghc3ViQ2FyZHMpIHtcbiAgICAgICAgICAgIHN1YkNhcmRzID0gW107XG4gICAgICAgICAgICBjb2xvckNhcmRzT2JqZWN0W2NvbG9yXSA9IHN1YkNhcmRzO1xuICAgICAgICB9XG4gICAgICAgIHN1YkNhcmRzLnB1c2goY2FyZCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gY29sb3JDYXJkc09iamVjdDtcbn07XG5cbi8vIOaYr+WQpuaYr+S4ieWQjOiKsemhulxuS1FDYXJkLl9pc1NhblRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKHRvdUNhcmRzLCB6aG9uZ0NhcmRzLCB3ZWlDYXJkcykge1xuICAgIHJldHVybiBLUUNhcmQuaXNUb25nSHVhU2h1bih0b3VDYXJkcykgJiYgS1FDYXJkLmlzVG9uZ0h1YVNodW4oemhvbmdDYXJkcylcbiAgICAgICAgJiYgS1FDYXJkLmlzVG9uZ0h1YVNodW4od2VpQ2FyZHMpO1xufTtcblxuXG4vLyDmmK/lkKbmmK8g4oCc5LiJ5YiG5aSp5LiL4oCdXG5LUUNhcmQuaXNTYW5GZW5UaWFuWGlhID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEzO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCB0aWVaaGlMZW5ndGggPSA0O1xuICAgIGxldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIGxldCBudW1iZXJPZlRpZVpoaSA9IDA7XG4gICAgZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3Byb3BdO1xuICAgICAgICBpZiAodmFsdWUgPT0gdGllWmhpTGVuZ3RoKSB7XG4gICAgICAgICAgICBudW1iZXJPZlRpZVpoaSA9IG51bWJlck9mVGllWmhpICsgMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVtYmVyT2ZUaWVaaGkgPT09IDM7XG59O1xuXG5cbi8vIOaYr+WQpuaYryDigJzlm5vlpZfkuInmnaHigJ1cbktRQ2FyZC5pc1NpVGFvU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IHNhblRpYW9MZW5ndGggPSAzO1xuICAgIGxldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIGxldCBudW1iZXJPZlNhblRpYW8gPSAwO1xuICAgIGZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXTtcbiAgICAgICAgaWYgKHZhbHVlID09IHNhblRpYW9MZW5ndGgpIHtcbiAgICAgICAgICAgIG51bWJlck9mU2FuVGlhbyA9IG51bWJlck9mU2FuVGlhbyArIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVtYmVyT2ZTYW5UaWFvID09IDQ7XG59O1xuXG5cbi8vIOaYr+WQpuaYryDigJzkuInmoYPoirHigJ1cbi8vIOWktOOAgeS4reOAgeWwvumBk+S4uuebuOWQjOiKseiJsueahOeJjFxuS1FDYXJkLmlzU2FuVGFvSHVhID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEzO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBsZXQgY29sb3JIZWxwZXIgPSBuZXcgS1FDYXJkQ29sb3JzSGVscGVyKGNhcmRzKTtcbiAgICB2YXIgY29sb3JOdW1iZXJzID0gW107XG4gICAgZm9yIChsZXQgcHJvcCBpbiBjb2xvckhlbHBlci5jb2xvck51bWJlcikge1xuICAgICAgICBjb2xvck51bWJlcnMucHVzaChjb2xvckhlbHBlci5jb2xvck51bWJlcltwcm9wXSk7XG4gICAgfVxuXG4gICAgY29sb3JOdW1iZXJzLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICB9KTtcblxuICAgIGlmIChjb2xvck51bWJlcnMubGVuZ3RoICE9IDMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChjb2xvck51bWJlcnNbMF0gPT0gM1xuICAgICAgICAmJiAoY29sb3JOdW1iZXJzWzFdID09IDUpXG4gICAgICAgICYmIChjb2xvck51bWJlcnNbMl0gPT0gNSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuXG4vLyDliKTmlq3mmK/lkKbljIXlkKvpk4HmlK9cbi8vIOWbm+W8oOWQjOagt+eCueaVsOeahOeJjFxuS1FDYXJkLmNvbnRhaW5UaWVaaGkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gNDtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy9sZXQgaGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9pZihoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoKXtcbiAgICAvLyAgICByZXR1cm4gaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aDtcbiAgICAvL31lbHNle1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuY29udGFpbkd1aVBhaShjYXJkcyw0KTtcbiAgICAvL31cbiAgICBpZiAoS1FDYXJkLmZpbmRUaWVaaGkoY2FyZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cblxuLy8g5Yik5pat5piv5ZCm5piv6ZOB5pSvXG5LUUNhcmQuaXNUaWVaaGkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gNDtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLnJlZHVjZShmdW5jdGlvbiAocG9pbnQsIGNhcmQpIHtcbiAgICAgICAgaWYgKHBvaW50ID09IGNhcmQucG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSwgY2FyZHNbMF0ucG9pbnQpO1xuXG4gICAgcmV0dXJuIHJlc3VsdCAhPSAtMTtcbn07XG5cbi8qIyMjIyPmmK/lkKbljIXlkKvkupTlkIwqL1xuLy/kupTlvKDlkIzmoLfngrnmlbDnmoTniYxcbktRQ2FyZC5jb250YWluV3VUb25nID0gZnVuY3Rpb24oY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gNTtcbiAgICBpZihjYXJkcy5sZW5ndGggPCBsZW5ndGgpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8v5LqU5byg54mM55u45ZCM55qEXG4gICAgLy9sZXQgaGVscGVyID0gbmV3IEtRQ2FyZFBvY29udGFpbjIwaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9pZihoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoKXtcbiAgICAvLyAgICByZXR1cm4gaGVscGVyLm1heE51bWJlcigpID49IGxlbmd0aDtcbiAgICAvL31lbHNle1xuICAgIC8vICAgIHJldHVybiBLUUNhcmQuY29udGFpbkd1aVBhaShjYXJkcyw1KTtcbiAgICAvL31cbiAgICBpZiAoS1FDYXJkLmZpbmRXdVRvbmcoY2FyZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cbi8q5Yik5pat5piv5ZCm5LqU5ZCMKi9cbktRQ2FyZC5pc1d1VG9uZyA9IGZ1bmN0aW9uKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDU7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLnJlZHVjZShmdW5jdGlvbiAocG9pbnQsIGNhcmQpIHtcbiAgICAgICAgaWYgKHBvaW50ID09IGNhcmQucG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSwgY2FyZHNbMF0ucG9pbnQpO1xuXG4gICAgcmV0dXJuIHJlc3VsdCAhPSAtMTtcbn07XG4vKiMjIyMjKi9cblxuLy8g5piv5ZCm5pivIOKAnOiRq+iKpuKAnVxuLy8g5LiJ5byg55u45ZCMICsg5LiA5a+5XG5LUUNhcmQuY29udGFpbkh1THUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gNTtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEtRQ2FyZC5maW5kSHVMdShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy9sZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL3ZhciBwb2ludE51bWJlcnMgPSBbXTtcbiAgICAvL3ZhciBpbmRleCA9IDA7XG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIHBvaW50TnVtYmVyc1tpbmRleF0gPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF07XG4gICAgLy8gICAgaW5kZXggPSBpbmRleCArIDE7XG4gICAgLy99XG4gICAgLy92YXIgaD1bXTtcbiAgICAvL3ZhciBoMT1bXTtcbiAgICAvL2Zvcih2YXIgaSBpbiBwb2ludE51bWJlcnMpe1xuICAgIC8vICAgIHZhciBzPXBvaW50TnVtYmVyc1tpXTtcbiAgICAvLyAgICBpZihzID09IDMpe1xuICAgIC8vICAgICAgICBoLnB1c2gocylcbiAgICAvLyAgICB9XG4gICAgLy8gICAgZWxzZSBpZihzPT00KXtcbiAgICAvLyAgICAgICAgaDEucHVzaChzKVxuICAgIC8vICAgIH1cbiAgICAvL1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9pZiAoKHBvaW50TnVtYmVycy5pbmRleE9mKDMpICE9IC0xKSAmJiAocG9pbnROdW1iZXJzLmluZGV4T2YoMikgIT0gLTEpXG4gICAgLy8gfHwgaC5sZW5ndGggPiAxIHx8IGgxLmxlbmd0aCA+IDEgfHwocG9pbnROdW1iZXJzLmluZGV4T2YoNCkgIT0gLTEpXG4gICAgLy8gJiYgKHBvaW50TnVtYmVycy5pbmRleE9mKDIpICE9IC0xKSkge1xuICAgIC8vICAgIHJldHVybiB0cnVlO1xuICAgIC8vfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuLy8g5Yik5pat5piv5ZCm5pivIOiRq+iKplxuS1FDYXJkLmlzSHVMdSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gNSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHBvaW50cyA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICByZXR1cm4gY2FyZC5wb2ludDtcbiAgICB9KS5zb3J0KGZ1bmN0aW9uIChwMSwgcDIpIHtcbiAgICAgICAgcmV0dXJuIHAxIC0gcDI7XG4gICAgfSk7XG5cbiAgICB2YXIgcDEgPSBwb2ludHNbMF07XG4gICAgdmFyIHAyID0gcDE7XG4gICAgdmFyIG51bWJlclAxID0gMDtcbiAgICB2YXIgbnVtYmVyUDIgPSAwO1xuXG4gICAgcG9pbnRzLmZvckVhY2goZnVuY3Rpb24gKHBvaW50KSB7XG4gICAgICAgIGlmIChwb2ludCAhPSBwMSAmJiBwb2ludCAhPSBwMikge1xuICAgICAgICAgICAgcDIgPSBwb2ludDtcbiAgICAgICAgICAgIG51bWJlclAyID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIG51bWJlclAxID0gbnVtYmVyUDEgKyAoKHBvaW50ID09IHAxKSA/IDEgOiAwKTtcbiAgICAgICAgbnVtYmVyUDIgPSBudW1iZXJQMiArICgocG9pbnQgPT0gcDIpID8gMSA6IDApO1xuICAgIH0pO1xuXG4gICAgbGV0IG1heE51bWJlciA9IE1hdGgubWF4KG51bWJlclAxKTtcbiAgICBsZXQgbWluTnVtYmVyID0gTWF0aC5taW4obnVtYmVyUDIpO1xuXG4gICAgcmV0dXJuIChtaW5OdW1iZXIgPT0gMikgJiYgKG1heE51bWJlciA9PSAzKTtcbn07XG5cbi8vIOaYr+WQpuWMheWQq+aciSDigJzkuInmnaHigJ1cbktRQ2FyZC5jb250YWluU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCAzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEtRQ2FyZC5maW5kU2FuVGlhbyhjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPj0gMykge1xuICAgIC8vICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyAgICB9XG4gICAgLy99XG4gICAgLy9cbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpbkd1aVBhaShjYXJkcywzKTtcbn07XG5cbi8vIOaYr+WQpuaYryDigJzkuInmnaHigJ1cbktRQ2FyZC5pc1NhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IDMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCByZXN1bHQgPSBjYXJkcy5yZWR1Y2UoZnVuY3Rpb24gKHBvaW50LCBjYXJkKSB7XG4gICAgICAgIGlmIChjYXJkLnBvaW50ID09IHBvaW50KSB7XG4gICAgICAgICAgICByZXR1cm4gcG9pbnQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSwgY2FyZHNbMF0ucG9pbnQpO1xuXG4gICAgcmV0dXJuIHJlc3VsdCAhPSAtMTtcbn07XG5cbi8vIOaYr+WQpuWMheWQq+aciSDvvJrkuKTlr7lcbktRQ2FyZC5jb250YWluTGlhRHVpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IDQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRMaWFEdWkoY2FyZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8vdmFyIG51bWJlck9mRHVpWmkgPSAwO1xuICAgIC8vbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPT0gMikge1xuICAgIC8vICAgICAgICBudW1iZXJPZkR1aVppID0gbnVtYmVyT2ZEdWlaaSArIDE7XG4gICAgLy8gICAgICAgIGlmIChudW1iZXJPZkR1aVppID09IDIpIHtcbiAgICAvLyAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgICAgICB9XG4gICAgLy8gICAgfVxuICAgIC8vfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuLy8g5piv5ZCm5pivIOS4pOWvuVxuS1FDYXJkLmlzTGlhRHVpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSA0KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICBmb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgICBpZiAocG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3Byb3BdICE9IDIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8vIOaYr+S4jeaYr+WvueWtkFxuS1FDYXJkLmlzRHVpWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IDIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBjYXJkMSA9IGNhcmRzWzBdO1xuICAgIGxldCBjYXJkMiA9IGNhcmRzWzFdO1xuXG4gICAgcmV0dXJuIGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50O1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5a+55a2QXG5LUUNhcmQuY29udGFpbkR1aVppID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmREdWlaaShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICAgIC8vbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgLy9mb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgIC8vICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gPT0gMikge1xuICAgIC8vICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyAgICB9XG4gICAgLy99XG4gICAgLy9cbiAgICAvL3JldHVybiBLUUNhcmQuY29udGFpbkd1aVBhaShjYXJkcywyKTtcbn07XG5cbktRQ2FyZC5jb250YWluR3VpUGFpID0gZnVuY3Rpb24gKGNhcmRzICwgbGVuZ3RoKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gICAgbGV0IGhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIHZhciBtYXhOdW1iZXIgPSAoaGVscGVyLm1heE51bWJlcigpICsgY2FyZDIwLmxlbmd0aCk7XG4gICAgcmV0dXJuIG1heE51bWJlciA+PSBsZW5ndGg7XG59O1xuLyojIyMjIyovXG4vLyDmmK/lkKbmmK/nibnmrorniYxcbktRQ2FyZC5pc1RlU2h1UGFpID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IDEzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gS1FDYXJkLmlzUWluZ0xvbmcoY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpXG4gICAgICAgIC8qfHwgS1FDYXJkLmlzU2FuVG9uZ0h1YVNodW4oY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1NpVGFvU2FuVGlhbyhjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzTGl1RHVpQmFuKGNhcmRzKVxuICAgICAgICB8fCBLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1NhblNodW5aaTEoY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1NhblRvbmdIdWEoY2FyZHMpXG5cbiAgICB8fCBLUUNhcmQuaXNXdUR1aVNhblRpYW8oY2FyZHMpXG4gICAgfHwgS1FDYXJkLmlzQ291WWlTZShjYXJkcykqLztcbn07XG5cbi8vIOWwhueJjOS4reeahCAxIOWPmOWMluS4uiBB77yIMTQpXG5LUUNhcmQuX2NvbnZlcnRPbmVUb0EgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMuZmluZChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gMTtcbiAgICAgICAgfSkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBjYXJkcztcbiAgICB9XG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxKSB7XG4gICAgICAgICAgICBsZXQgbmV3Q2FyZCA9IG5ldyBLUUNhcmQoMTQsIGNhcmQuY29sb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG5ld0NhcmQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuS1FDYXJkLl9jb252ZXJ0T25lVG9BMSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5maW5kKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZC5wb2ludCA9PSAxO1xuICAgICAgICB9KSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmRzO1xuICAgIH1cbiAgICB2YXIgbnVtID0gMDtcbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIGlmIChjYXJkLnBvaW50ID09IDEgJiYgbnVtID09IDApIHtcbiAgICAgICAgICAgIG51bSsrO1xuICAgICAgICAgICAgbGV0IG5ld0NhcmQgPSBuZXcgS1FDYXJkKDE0LCBjYXJkLmNvbG9yKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdDYXJkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjYXJkO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8vIEtRQ2FyZCDnmoTmjpLluo/mlrnms5VcbktRQ2FyZC5zb3J0QnlQb2ludCA9IGZ1bmN0aW9uIChjYXJkMSwgY2FyZDIpIHtcbiAgICBsZXQgcmVzdWx0ID0gTnVtYmVyKGNhcmQxLnBvaW50KSAtIE51bWJlcihjYXJkMi5wb2ludClcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuS1FDYXJkLnNvcnRCeUNvbG9yID0gZnVuY3Rpb24gKGNhcmQxLCBjYXJkMiwgcG9pbnRBc2MgPSB0cnVlKSB7XG4gICAgaWYgKGNhcmQyLmNvbG9yID09IGNhcmQxLmNvbG9yKSB7XG4gICAgICAgIHJldHVybiAoY2FyZDEucG9pbnQgLSBjYXJkMi5wb2ludCkgKiAocG9pbnRBc2MgPyAxIDogLTEpO1xuICAgIH1cbiAgICByZXR1cm4gY2FyZDIuY29sb3IgLSBjYXJkMS5jb2xvcjtcbn1cblxuS1FDYXJkLnNvcnQgPSBmdW5jdGlvbiAoY2FyZDEsIGNhcmQyLCBhc2MgPSB0cnVlLCBBaXNNYXggPSB0cnVlKSB7XG4gICAgbGV0IHJlc3VsdCA9IDE7XG4gICAgaWYgKGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50KSB7XG4gICAgICAgIHJlc3VsdCA9IGNhcmQxLmNvbG9yIC0gY2FyZDIuY29sb3I7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHBvaW50MSA9IGNhcmQxLnBvaW50O1xuICAgICAgICB2YXIgcG9pbnQyID0gY2FyZDIucG9pbnQ7XG4gICAgICAgIGlmIChBaXNNYXggJiYgcG9pbnQxID09IDEpIHtcbiAgICAgICAgICAgIHBvaW50MSA9IDE0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKEFpc01heCAmJiBwb2ludDIgPT0gMSkge1xuICAgICAgICAgICAgcG9pbnQyID0gMTQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXN1bHQgPSBwb2ludDEgLSBwb2ludDI7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdCAqIChhc2MgPyAxIDogLTEpO1xufTtcblxuLy/ovazkuLrlrqLmiLfnq6/nmoTniYxcbktRQ2FyZC5fY29udmVydENhcmRzVG9DYXJkTmFtZXMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAvLyBbe1wic3VpdFwiOlwic1wiLFwibnVtYmVyXCI6MTB9XVxuICAgIGxldCBzdWl0Q29sb3JNYXAgPVsnJywnZCcsJ2MnLCdoJywncyddO1xuICAgIHJldHVybiBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgdmFyIGNhcmROdW1iZXIgPSBjYXJkLnBvaW50O1xuICAgICAgICBsZXQgY29sb3IgPSBzdWl0Q29sb3JNYXBbY2FyZC5jb2xvcl07XG4gICAgICAgIGxldCBudW1iZXIgPSBNYXRoLm1heChNYXRoLm1pbihjYXJkTnVtYmVyLCAxMyksIDEpO1xuICAgICAgICByZXR1cm4ge251bWJlcjpudW1iZXIsc3VpdDpjb2xvcn07XG4gICAgfSk7XG59OyIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcblxubGV0IEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIgPSB7XG4gICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5fZGlkU3RhcnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kaWRTdGFydCA9IHRydWU7XG5cbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUZvcmNlRXhpdCwgdGhpcy5fZm9yY2VFeGl0QXBwLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgX2ZvcmNlRXhpdEFwcDogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgS1FOYXRpdmVJbnZva2UuZm9yY2VFeGl0QXBwKCk7XG4gICAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlcjsiLCJsZXQgS1FHbG9iYWxFdmVudCA9IHtcbiAgICBfaGFuZGxlczoge30sXG4gICAgLy/lj5HpgIHkuovku7ZcbiAgICBlbWl0OiBmdW5jdGlvbiAoZXZlbnROYW1lLCBkYXRhID0ge30pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBkYXRhID0geydkYXRhJzogZGF0YX07XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmV0dXJucyA9IFtdIC8v6L+U5Zue5YC8XG4gICAgICAgIGRhdGEuZXZlbnROYW1lID0gZXZlbnROYW1lLy/kv53lrZjkuIDkuIvkuovku7blkI3lrZdcblxuICAgICAgICBmb3IgKCB2YXIgZmluZEV2ZW5OYW1lIGluIHRoaXMuX2hhbmRsZXMpe1xuICAgICAgICAgICAgaWYgKGZpbmRFdmVuTmFtZSA9PSBldmVudE5hbWUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2hhbmRsZXNbZmluZEV2ZW5OYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0dXJuVmFsdWUgPSB0aGlzLl9oYW5kbGVzW2ZpbmRFdmVuTmFtZV1baV0oZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJucy5wdXNoKHJldHVyblZhbHVlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXR1cm5zXG4gICAgfSxcbiAgICAvL+a3u+WKoOaZrumAmuS6i+S7tlxuICAgIG9uOiBmdW5jdGlvbiAoZXZlbnROYW1lLCBjYWxsYmFjaywgdGFyZ2V0KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCfmlLbliLDkuovku7YnLCBldmVudE5hbWUpO1xuICAgICAgICB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0gPSB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0gfHwgW11cblxuICAgICAgICB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjay5iaW5kKHRhcmdldCkpXG4gICAgICAgIGNhbGxiYWNrLl9jYWxsZXIgPSB0YXJnZXQ7XG4gICAgfSxcblxuICAgIC8v6YCa6L+H5LqL5Lu25ZCN56e76Zmk5LiA5Liq55uR5ZCs5ZmoXG4gICAgb2ZmOiBmdW5jdGlvbiAoZXZlbnROYW1lKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5faGFuZGxlc1tldmVudE5hbWVdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV1baV0gPSBudWxsXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g56e75Yqo5LiA5LiqIHRhcmdldCDkuIrmiYDmnInnmoTnm5HlkKxcbiAgICBvZmZUYXJnZXQ6IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcy5faGFuZGxlcykge1xuICAgICAgICB2YXIgZXZlbnRIYW5kbGVycyA9IHRoaXMuX2hhbmRsZXNbbmFtZV07XG4gICAgICAgIHZhciBpbmRleHMgPSBldmVudEhhbmRsZXJzLmZpbHRlcihmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2suX2NhbGxlciA9IHRhcmdldDtcbiAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChjYWxsYmFjaywgaW5kZXgpIHtcbiAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBpbmRleE9mZnNldCA9IDA7XG4gICAgICAgIGluZGV4cy5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgIGV2ZW50SGFuZGxlcnMuc3BsaWNlKGluZGV4ICsgaW5kZXhPZmZzZXQsIDEpO1xuICAgICAgICAgIGluZGV4T2Zmc2V0ID0gaW5kZXhPZmZzZXQgKyAxO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBLUUdsb2JhbEV2ZW50O1xuIiwibGV0IEtRTmF0aXZlSW52b2tlID0ge1xuICBJT1NDbGFzc05hbWU6IFwiQXBwQ29udHJvbGxlclwiLFxuICBBTkRSSU9EQ2xhc3NOYW1lOiBcImNvbS9sbGluZy9zc3ovQXBwQWN0aXZpdHlcIixcblxuICBpc05hdGl2ZUlPUzogZnVuY3Rpb24gKCkge1xuICAgIGxldCBwbGF0Zm9ybSA9IGNjLnN5cy5wbGF0Zm9ybTtcbiAgICBpZiAoKHBsYXRmb3JtID09IGNjLnN5cy5JUEhPTkUpIHx8IChwbGF0Zm9ybSA9PSBjYy5zeXMuSVBBRCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgaXNOYXRpdmVBbmRyb2lkOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHBsYXRmb3JtID0gY2Muc3lzLnBsYXRmb3JtO1xuICAgIGlmIChwbGF0Zm9ybSA9PSBjYy5zeXMuQU5EUk9JRCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICBpc05hdGl2ZTogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjYy5zeXMuaXNOYXRpdmUgPT0gdHJ1ZTtcbiAgfVxufTtcblxuLy8gTUFSSzog5Y+v6LCD55So55qE5pys5Zyw5pa55rOVXG4vKipcbiAqIOW+ruS/oeeZu+W9lVxuICovXG5LUU5hdGl2ZUludm9rZS53eExvZ2luID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4TG9naW5cIik7IC8vSU9TXG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4TG9naW5cIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cblxuLyoqXG4gKiDliIbkuqvlpKfljoXkv6Hmga/liLDlvq7kv6Hlpb3lj4tcbiAqIFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZUhhbGxUb1dlQ2hhdEZyaWVuZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbEZyaWVuZFwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxGcmllbmRcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cblxuLyoqXG4gKiDliIbkuqvlpKfljoXkv6Hmga/liLDmnIvlj4vlnIhcbiAqIFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZUhhbGxUb1dlQ2hhdFRpbWVsaW5lID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsVGltZWxpbmVcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsVGltZWxpbmVcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbi8qKlxuICog5by65Yi26YCA5Ye6IEFQUFxuICogXG4gKi9cbktRTmF0aXZlSW52b2tlLmZvcmNlRXhpdEFwcCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJleGl0QXBwXCIsICk7XG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJleGl0QXBwXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG5cbi8qKlxuICog5LiL6L295paw54mI5pysXG4gKiBcbiAqIEBwYXJhbSB7U3RyaW5nfSBpb3NVcmwgICAgICBpT1Mg54mI5pys5Zyw5Z2AXG4gKiBAcGFyYW0ge1N0cmluZ30gYW5kcm9pZFVybCAg5a6J5Y2T54mI5pys5Zyw5Z2AXG4gKi9cbktRTmF0aXZlSW52b2tlLmRvd25sb2FkTmV3VmVyc2lvbiA9IGZ1bmN0aW9uIChpb3NVcmwsIGFuZHJvaWRVcmwpIHtcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJkb3dubG9hZE5ld1ZlcnNpb246XCIsIGlvc1VybCk7XG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJkb3dubG9hZE5ld1ZlcnNpb25cIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgYW5kcm9pZFVybCk7XG4gIH1cbn07XG5cblxuLyoqXG4gKiDliIbkuqvmiL/pl7Tnu5nlvq7kv6Hlpb3lj4tcbiAqIFxuICogQHBhcmFtIHtTdHJpbmd9IHJvb21JZCAgICAgICAgIOaIv+mXtCBpZCDkv6Hmga9cbiAqIEBwYXJhbSB7U3RyaW5nfSBkZXNjcmlwdGlvbiAgICDmlofmnKzmj4/ov7BcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc2hhcmVSb29tVG9XZUNoYXRGcmllbmQgPSBmdW5jdGlvbiAocm9vbUlkLCBkZXNjcmlwdGlvbikge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmQ6ZGVzY3JpcHRpb246XCIsIGlkLCBkZXNjcmlwdGlvbik7XG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVGcmllbmRcIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgaWQsIGRlc2NyaXB0aW9uKTtcbiAgfVxufTtcblxuLyoqXG4gKiDliIbkuqvmiL/pl7TliLDlvq7kv6HmnIvlj4vlnIhcbiAqIFxuICogQHBhcmFtIHtTdHJpbmd9IHJvb21JZCAgICAgICAgIOaIv+mXtCBpZCDkv6Hmga9cbiAqIEBwYXJhbSB7U3RyaW5nfSBkZXNjcmlwdGlvbiAgICDmlofmnKzmj4/ov7BcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc2hhcmVSb29tVG9XZUNoYXRUaW1lbGluZSA9IGZ1bmN0aW9uIChyb29tSWQsIGRlc2NyaXB0aW9uKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZTpkZXNjcmlwdGlvbjpcIiwgaWQsIGRlc2NyaXB0aW9uKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZVwiLCBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiLCBpZCwgZGVzY3JpcHRpb24pO1xuICB9XG59O1xuXG4vKipcbiAqIOWIhuS6q+Wxj+W5leaIquWbvuWIsOW+ruS/oeWlveWPi1xuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZVNjcmVlblRvV2VDaGF0RnJpZW5kID0gZnVuY3Rpb24gKCkge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVGcmllbmRcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVGcmllbmRcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbi8qKlxuICog5YiG5Lqr5bGP5bmV5oiq5Zu+5Yiw5b6u5L+h5pyL5Y+L5ZyIXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlU2NyZWVuVG9XZUNoYXRUaW1lbGluZSA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNjcmVlblNoYXJlXCIsICk7XG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNjcmVlblNoYXJlXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG4vKipcbiAqIOW8gOWni+W9lemfs1xuICovXG5LUU5hdGl2ZUludm9rZS5zdGFydFJlY29yZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJyZWNvcmRcIik7XG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwicmVjb3JkXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG4vKipcbiAqIOe7k+adn+W9lemfs1xuICovXG5LUU5hdGl2ZUludm9rZS5lbmRSZWNvcmQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwiZW5kUmVjb3JkXCIpO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImVuZFJlY29yZFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuS1FOYXRpdmVJbnZva2Uuc2NyZWVuc2hvdFNoYXJlID0gZnVuY3Rpb24oc3RyaW5ncyA9ICdzaGFyZUlNRycpIHtcbiAgICAgICAgaWYodGhpcy5faXNDYXB0dXJpbmcpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2lzQ2FwdHVyaW5nID0gdHJ1ZTtcbiAgICAgICAgdmFyIHNpemUgPSBjYy5kaXJlY3Rvci5nZXRXaW5TaXplKCk7XG4gICAgICAgIHZhciBmaWxlTmFtZSA9IFwicmVzdWx0X3NoYXJlLmpwZ1wiO1xuICAgICAgICB2YXIgZnVsbFBhdGggPSBqc2IuZmlsZVV0aWxzLmdldFdyaXRhYmxlUGF0aCgpICsgZmlsZU5hbWU7XG4gICAgICAgIGlmKGpzYi5maWxlVXRpbHMuaXNGaWxlRXhpc3QoZnVsbFBhdGgpKXtcbiAgICAgICAgICAgIGpzYi5maWxlVXRpbHMucmVtb3ZlRmlsZShmdWxsUGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRleHR1cmUgPSBuZXcgY2MuUmVuZGVyVGV4dHVyZShNYXRoLmZsb29yKHNpemUud2lkdGgpLCBNYXRoLmZsb29yKHNpemUuaGVpZ2h0KSxjYy5JTUFHRV9GT1JNQVRfUE5HLGdsLkRFUFRIMjRfU1RFTkNJTDhfT0VTKTtcbiAgICAgICAgdGV4dHVyZS5zZXRQb3NpdGlvbihjYy5wKHNpemUud2lkdGgvMiwgc2l6ZS5oZWlnaHQvMikpO1xuICAgICAgICB0ZXh0dXJlLmJlZ2luKCk7XG4gICAgICAgIGNjLmRpcmVjdG9yLmdldFJ1bm5pbmdTY2VuZSgpLnZpc2l0KCk7XG4gICAgICAgIHRleHR1cmUuZW5kKCk7XG4gICAgICAgIHRleHR1cmUuc2F2ZVRvRmlsZShmaWxlTmFtZSwgY2MuSU1BR0VfRk9STUFUX1BORyk7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgdHJ5VGltZXMgPSAwO1xuICAgICAgICB2YXIgZm4gPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgaWYoanNiLmZpbGVVdGlscy5pc0ZpbGVFeGlzdChmdWxsUGF0aCkpe1xuXG4gICAgICAgICAgICAgICAgaWYoY2Muc3lzLm9zID09IGNjLnN5cy5PU19BTkRST0lEKXtcbiAgICAgICAgICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChzZWxmLkFORFJJT0RDbGFzc05hbWUsIHN0cmluZ3MsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsZnVsbFBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLl9pc0NhcHR1cmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICB0cnlUaW1lcysrO1xuICAgICAgICAgICAgICAgIGlmKHRyeVRpbWVzID4gMTApe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRpbWUgb3V0Li4uXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZm4sNTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNldFRpbWVvdXQoZm4sNTApO1xufVxuXG5cbi8qKlxuICog5pKt5pS+572R57uc6K+t6Z+zXG4gKiBcbiAqIEBwYXJhbSB7U3RyaW5nfSBhdWRpb1VybCDor63pn7PlnLDlnYBcbiAqL1xuS1FOYXRpdmVJbnZva2UucGxheUF1ZGlvV2l0aFVybCA9IGZ1bmN0aW9uIChhdWRpb1VybCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInBsYXlVcmw6XCIsIGF1ZGlvVXJsKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwicGxheVVybFwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCBhdWRpb1VybCk7XG4gIH1cbn07XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IEtRTmF0aXZlSW52b2tlOyIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgQ2hhdE1lc3NhZ2UgPSByZXF1aXJlKCdDaGF0TWVzc2FnZScpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5cbi8vIOeUqOadpeWPkemAgea2iOaBr+eahCBjb21wb25lbnRcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGJxTm9kZTpjYy5Ob2RlLFxuICAgICAgICBicU5vZGUxOmNjLk5vZGUsXG4gICAgICAgIGJ0bkxhbmd1YWdlTm9kZTpjYy5Ob2RlLFxuICAgICAgICBidG5MYW5ndWFnZU5vZGUxOmNjLk5vZGUsXG4gICAgICAgIGJ0bkNoYXJ0Tm9kZTpjYy5Ob2RlLFxuICAgICAgICBidG5DaGFydE5vZGUxOmNjLk5vZGUsXG4gICAgICAgIHRleHRTY3JvbGxWaWV3OmNjLk5vZGUsXG4gICAgICAgIGltYWdlQ29udGVudE5vZGU6Y2MuTm9kZSxcblxuICAgICAgICBlZGl0Qm94OiBjYy5FZGl0Qm94LFxuXG4gICAgICAgIHRleHRSZWNvcmRTY3JvbGxWaWV3OiBjYy5TY3JvbGxWaWV3LFxuICAgICAgICB0ZXh0UmVjb3JkTGF5b3V0OiBjYy5MYXlvdXQsXG5cbiAgICAgICAgdGV4dFByZWZhYjpjYy5QcmVmYWIsXG4gICAgICAgIGNoYXRUZXh0UmVjb3JkUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAgIC8vIGltYWdlUHJlZmFiOmNjLlByZWZhYixcblxuICAgICAgICBpbnB1dE5vZGU6Y2MuTm9kZSxcblxuICAgICAgICBfdXNlcklkOiBudWxsLFxuXG4gICAgICAgIF9wbGF5ZXJJbmZvczogbnVsbCwgICAgICAgIC8vIOiusOW9leeUqOaIt+S/oeaBr1xuICAgICAgICBfY2hhdFRleHRNZXNzYWdlUmVjb3JkczogbnVsbCwgLy8g6IGK5aSp5paH5pys5raI5oGv6K6w5b2VXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gW107XG4gICAgICAgIHRoaXMudGV4dENvbnRlbnQgPSB0aGlzLnRleHRTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuICAgICAgICAvLyB0aGlzLmltYWdlQ29udGVudCA9IHRoaXMuaW1hZ2VTY3JvbGxWaWV3LmdldENvbXBvbmVudChjYy5TY3JvbGxWaWV3KS5jb250ZW50O1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICB2YXIgdGV4dERhdGEgPSBBdWRpb01hbmFnZXIuaW5zdGFuY2UuY2hhdFRleHRzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dERhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy50ZXh0UHJlZmFiKTtcbiAgICAgICAgICAgIGl0ZW0uZ2V0Q29tcG9uZW50KCdjZWxsVGV4dCcpLnNldFRleHQodGV4dERhdGFbaV0pO1xuICAgICAgICAgICAgaXRlbS5nZXRDb21wb25lbnQoJ2NlbGxUZXh0Jykub25TZWxlY3RBY3Rpb24gPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5vblRleHRDbGlja0FjdGlvbih0ZXh0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnRleHRDb250ZW50LmggPSAxMDAwO1xuICAgICAgICAgICAgdGhpcy50ZXh0Q29udGVudC5hZGRDaGlsZChpdGVtKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBvblRleHRDbGlja0FjdGlvbjpmdW5jdGlvbih0ZXh0ID0gXCJcIikge1xuICAgICAgdGhpcy5lZGl0Qm94LnN0cmluZyA9IFwiXCI7XG4gICAgICB0aGlzLnNlbmRUZXh0KHRleHQpO1xuICAgIH0sXG5cbiAgICBjbGlja0Vtb2ppOiBmdW5jdGlvbiAoZXZlbnQsIGVtb2ppTmFtZSkge1xuICAgICAgbGV0IHN0cmluZyA9IHRoaXMuZWRpdEJveC5zdHJpbmc7XG4gICAgICB0aGlzLmVkaXRCb3guc3RyaW5nID0gc3RyaW5nICsgXCI8XCIgKyBlbW9qaU5hbWUgKyBcIj5cIjtcbiAgICB9LFxuXG4gICAgY2xpY2tTZW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgc3RyaW5nID0gdGhpcy5lZGl0Qm94LnN0cmluZyB8fCBcIlwiO1xuICAgICAgaWYgKHN0cmluZy5sZW5ndGggPT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZWRpdEJveC5zdHJpbmcgPSBcIlwiO1xuICAgICAgdGhpcy5zZW5kVGV4dChzdHJpbmcpO1xuICAgIH0sXG5cbiAgICBzZW5kVGV4dDogZnVuY3Rpb24gKHRleHQgPSBcIlwiKSB7XG4gICAgICBpZiAodGV4dC5sZW5ndGggPT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIFNvY2tldC5zZW5kVGV4dCh0aGlzLl91c2VySWQsIHRleHQpO1xuICAgICAgdGhpcy5kaXNtaXNzKCk7XG4gICAgfSxcblxuICAgIGRpc21pc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgYnFBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYnFOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZTEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5icU5vZGUuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRleHRTY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmltYWdlQ29udGVudE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICB0ZXh0QWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJxTm9kZTEuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnFOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZTEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0U2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmltYWdlQ29udGVudE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGV4dFJlY29yZFNjcm9sbFZpZXcubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgY2hhcnRBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYnFOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZTEuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUxLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJxTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnRleHRTY3JvbGxWaWV3LmFjdGl2ZSA9IHRoaXMuaW1hZ2VDb250ZW50Tm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIGFkZFBsYXllckluZm9zOiBmdW5jdGlvbiAocGxheWVySW5mb3MpIHtcbiAgICAgIHRoaXMuX3BsYXllckluZm9zID0gdGhpcy5fcGxheWVySW5mb3MgfHwgW107XG5cbiAgICAgIHBsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24gKHVzZXJJbmZvKSB7XG4gICAgICAgIGxldCBoYXZlVXNlckluZm8gPSB0aGlzLl9wbGF5ZXJJbmZvcy5maW5kKGZ1bmN0aW9uIChvd25Vc2VySW5mbykge1xuICAgICAgICAgIHJldHVybiBvd25Vc2VySW5mby5pZCA9PSB1c2VySW5mby5pZDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGhhdmVVc2VySW5mbyA9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5fcGxheWVySW5mb3MucHVzaCh1c2VySW5mbyk7XG4gICAgICAgIH1cbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGFkZENoYXRUZXh0TWVzc2FnZTogZnVuY3Rpb24gKHVzZXJJZCwgdGV4dCkge1xuICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSB0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXTtcblxuICAgICAgdmFyIG5pY2tuYW1lID0gXCJbSUQ6XCIgKyB1c2VySWQgKyBcIuivtF3vvJpcIjtcbiAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMuX3BsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKHVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiB1c2VySW5mby5pZCA9PSB1c2VySWQ7XG4gICAgICB9KTtcblxuICAgICAgaWYgKHVzZXJJbmZvKSB7XG4gICAgICAgIG5pY2tuYW1lID0gXCJbXCIgKyB1c2VySW5mby5uaWNrbmFtZSArIFwi6K+0Xe+8mlwiO1xuICAgICAgfVxuXG4gICAgICB2YXIgc3RyID0gbmlja25hbWUgKyB0ZXh0O1xuICAgICAgc3RyID0gQ2hhdE1lc3NhZ2UucGFyc2VTdHJpbmcoc3RyKTtcbiAgICAgIHRoaXMuX2FkZENoYXRUZXh0VG9SZWNvcmQoc3RyKTtcbiAgICB9LFxuXG4gICAgX2FkZENoYXRUZXh0VG9SZWNvcmQ6IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2hhdFRleHRSZWNvcmRQcmVmYWIpO1xuICAgICAgbGV0IGNoYXRUZXh0UmVjb3JkID0gaXRlbS5nZXRDb21wb25lbnQoJ0NoYXRUZXh0UmVjb3JkJyk7XG4gICAgICBjaGF0VGV4dFJlY29yZC5zZXRTdHJpbmcodGV4dCk7XG5cbiAgICAgIHRoaXMudGV4dFJlY29yZExheW91dC5ub2RlLmFkZENoaWxkKGl0ZW0pO1xuICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5zY3JvbGxUb0JvdHRvbSgpO1xuICAgIH0sXG59KTtcbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBleGl0QWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBjYy5kaXJlY3Rvci5lbmQoKTtcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwiZXhpdEFwcFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsvL0FuZHJvaWRcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJleGl0QXBwXCIsIFwiKClWXCIpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsIi8vIG51bWJlci5rcV90aW1lcyhmKSAgIOiwg+eUqOWkmuasoVxuXG5cbmlmICghTnVtYmVyLnByb3RvdHlwZS5rcV90aW1lcykge1xuICAgIFxuICAgIC8qKlxuICAgICAqIOiwg+eUqOS4gOS4quaWueazlSB0aGlzIOasoVxuICAgICAqIFxuICAgICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBmIOimgeiwg+eUqOeahOaWueazlVxuICAgICAqIEBwYXJhbSAge09iamVjdH0gICB0aGlzQXJnICAg5Y+v6YCJ77ybIGYg55qEIHRoaXPlgLxcbiAgICAgKi9cbiAgICBOdW1iZXIucHJvdG90eXBlLmtxX3RpbWVzID0gZnVuY3Rpb24oZiwgdGhpc0FyZykge1xuICAgICAgICBpZiAoIWYpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpczsgKytpKSB7XG4gICAgICAgICAgICBpZiAodGhpc0FyZykge1xuICAgICAgICAgICAgICAgIGYuYXBwbHkodGhpc0FyZywgaSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGYoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5cbi8vIOeUqOS6juWbnuaUvueahOe7hOS7tlxuY29uc3QgUGxheWJhY2sgPSBjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgX3BsYXliYWNrRGF0YXM6IG51bGwsICAgLy8g55So5LqO5Zue5pS+55qE5pWw5o2uXG4gICAgICBfaXNQbGF5YmFja2luZzogZmFsc2UsXG4gICAgfSxcblxuICAgIHN0YXRpY3M6IHtcbiAgICAgIGluc3RhbmNlOiBudWxsLFxuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIFBsYXliYWNrLmluc3RhbmNlID0gdGhpcztcbiAgICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XG4gICAgfSxcblxuICAgIC8vIOiuvue9ruWbnuaUvuaVsOaNrlxuICAgIHNldFBsYXliYWNrRGF0YXM6IGZ1bmN0aW9uIChkYXRhcykge1xuICAgICAgdGhpcy5fcGxheWJhY2tEYXRhcyA9IGRhdGFzO1xuICAgIH0sXG5cbiAgICAvLyDmuIXnqbrlm57mlL7mlbDmja7jgILlkIzml7bkvJrmuIXnqbrlm57mlL5cbiAgICByZW1vdmVQbGF5YmFja0RhdGFzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnNldFBsYXliYWNrRGF0YXMobnVsbCk7XG4gICAgICB0aGlzLnN0b3BQbGF5YmFjaygpO1xuICAgIH0sXG5cbiAgICAvLyDmmK/lkKbljIXlkKvlm57mlL7mlbDmja5cbiAgICBpc0NvbnRhaW5QbGF5YmFja0RhdGFzOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcGxheWJhY2tEYXRhcyAhPSBudWxsO1xuICAgIH0sXG5cbiAgICAvLyDlvIDlp4vlm57mlL5cbiAgICBzdGFydFBsYXliYWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyDmqKHmi58gc29ja2V0IOaOpeaUtuWIsOS6huS6i+S7tuWNs+WPr1xuICAgICAgY2MubG9nKFwiUGxheWJhY2sg5byA5aeL5Zue5pS+XCIpO1xuXG4gICAgICB0aGlzLl9pc1BsYXliYWNraW5nID0gdHJ1ZTtcblxuICAgICAgaWYgKCF0aGlzLl9wbGF5YmFja0RhdGFzKSB7XG4gICAgICAgIGNjLmVycm9yKFwi5oOz5Zue5pS+77yM5Y205rKh5pyJ5Zue5pS+5pWw5o2uXCIpO1xuICAgICAgICB0aGlzLnN0b3BQbGF5YmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2V4ZWN1dGVQbGF5YmFjaygpO1xuICAgIH0sXG5cbiAgICAvLyDlgZzmraLlm57mlL5cbiAgICBzdG9wUGxheWJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2lzUGxheWJhY2tpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgIH0sXG5cbiAgICAvLyDmmK/lkKbmraPlnKjlm57mlL5cbiAgICBpc1BsYXliYWNraW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5faXNQbGF5YmFja2luZztcbiAgICB9LFxuXG4gICAgLy8g5omn6KGM55yf5q2j55qE5Zue5pS+5pON5L2cXG4gICAgX2V4ZWN1dGVQbGF5YmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHN0YXJ0VGltZSA9IDEuMDtcbiAgICAgIGxldCBpbnRlcnZhbCA9IDMuMDtcbiAgICAgIGNjLmxvZyh0aGlzLl9wbGF5YmFja0RhdGFzKTtcblxuICAgICAgLy8g5Zyo5p+Q5Lqb54m55q6K5oOF5Ya15LiLXG4gICAgICAvLyDlm57mlL7mlbDmja7ph4zkvJrljIXlkKvkuKTlpZcgZ2FtZU92ZXIgYWN0aW9uXG4gICAgICAvLyDmiYDku6XpnIDopoHov4fmu6TmjonlhbbkuK3kuIDkuKpcbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMgPSB0aGlzLl9wbGF5YmFja0RhdGFzLmZpbHRlcihmdW5jdGlvbihzdHJpbmcsIGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PSB0aGlzLl9wbGF5YmFja0RhdGFzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAoc3RyaW5nLmluZGV4T2YoJ1wiYWN0aW9uXCI6XCJnYW1lT3ZlcicpID09IC0xKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgIHRoaXMuX3BsYXliYWNrRGF0YXMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIGRlbGF5ID0gc3RhcnRUaW1lICsgaW5kZXggKiBpbnRlcnZhbDtcbiAgICAgICAgaWYgKGluZGV4ID09IHRoaXMuX3BsYXliYWNrRGF0YXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIC8vIOWmguaenOaYr+acgOWQjuS4gOS4qu+8jOWImeW6lOivpeWPqumXtOmalOS4gOenklxuICAgICAgICAgIGRlbGF5ID0gc3RhcnRUaW1lICsgKGluZGV4IC0gMSkgKiBpbnRlcnZhbCArIDE7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY2MubG9nKFwi5Zue5pS+5byA5aeL5qih5oufIFNvY2tldCDmjqXmlLbliLDmnI3liqHlmajmtojmga8sIFwiLCBpbmRleCk7XG4gICAgICAgICAgU29ja2V0Lmluc3RhbmNlLl9kaXNwYXRjaFJlc3BvbnNlKGRhdGEpO1xuICAgICAgICB9LCBkZWxheSk7XG5cbiAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBQbGF5YmFjaztcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEFycmF5RXh0ZW5zaW9uID0gcmVxdWlyZSgnQXJyYXlFeHRlbnNpb24nKTtcbmNvbnN0IFVzZXJNb2RlbEhlbHBlciA9IHJlcXVpcmUoJ1VzZXJNb2RlbEhlbHBlcicpO1xuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgZm9sZENhcmROb2RlOiBjYy5Ob2RlLCAgICAgIC8vIOeJjOebluedgOaXtueahOagt+WtkFxuICAgICAgICBmb2xkQ2FyZE5vZGUxOiBjYy5Ob2RlLCAgICAgIC8vIOeJjOebluedgOaXtueahOagt+WtkFxuICAgICAgY2FyZHNCYWNrTGF5b3V0OiBjYy5MYXlvdXQsIC8vIDEz5byg54mM6IOM5b2x77yM5Y+v55So5p2l5bGV56S65Y+R54mM5Yqo55S7IOWQqyBjYXJkc0JhY2sgQ29tcG9uZW50XG4gICAgICBjb21wYXJlQ2FyZHNOb2RlOiBjYy5Ob2RlLCAgLy8gY29tcGFyZUNhcmRzICAg5ZCrIENvbXBhcmVDYXJkcyBDb21wb25lbnRcbiAgICAgIHVzZXJJbmZvTm9kZTogY2MuTm9kZSwgICAgICAgICAgLy8g5YyF5ZCr55So5oi35L+h5oGvIOWQqyB1c2VySW5mbyBDb21wb25lbnRcbiAgICAgIGNoYXRNZXNzYWdlTm9kZTogY2MuTm9kZSwgICAgICAgLy8g6IGK5aSp5raI5oGvIOWMheWQqyBDaGF0TWVzc2FnZSBDb21wb25lbnRcbiAgICAgIHVzZXJBdmF0YXJOb2RlOiBjYy5Ob2RlLFxuICAgICAgdXNlclNhbXBsZUluZm9Ob2RlOiBjYy5Ob2RlLFxuICAgICAgdXNlcklkOiAwLFxuICAgICAgLyojIyMjIyovXG4gICAgICB0ZVNodVBhaUxhYmVsOmNjLk5vZGUsXG4gICAgICAgIGNhcmRUeXBlUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAvLyDnlKjmiLfkv6Hmga9cbiAgICAgIC8vIDHjgIEg5aaC5p6cIOWMheWQq++8mmNhcmRJbmZvOltd77yM6KGo5piO55So5oi35bey57uP5Ye654mMXG4gICAgICAvL1xuICAgICAgX3VzZXJJbmZvOiBudWxsLFxuICAgICAgX2Rlc2tJbmZvOiBudWxsLFxuICAgICAgICAvKiovXG4gICAgICAgIHBsYXllZENvbXBhcmVDYXJkc0luZGV4czoge1xuICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBkZWZhdWx0OiB1bmRlZmluZWQsXG4gICAgICAgIH1cbiAgICAgICAgLyoqL1xuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMudXNlckF2YXRhck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMuX3Nob3dVc2VySW5mbywgdGhpcyk7XG4gICAgICB0aGlzLnJlc2V0KCk7XG4gICAgfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy51c2VyQXZhdGFyTm9kZS5vZmYoY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMuX3Nob3dVc2VySW5mbywgdGhpcyk7XG4gICAgfSxcblxuICAgIF9zaG93VXNlckluZm86IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMudXNlclNhbXBsZUluZm9Ob2RlLmdldENvbXBvbmVudCgnVXNlclNhbXBsZUluZm8nKS51cGRhdGVXaXRoVXNlcih0aGlzLl91c2VySW5mbyk7XG4gICAgfSxcblxuICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZTEuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLnRlU2h1UGFpTGFiZWwuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnJlc2V0KCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyovXG4gICAgcmVzZXQyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZTEuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLnRlU2h1UGFpTGFiZWwuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIC8vdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgLy90aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5yZXNldCgpO1xuICAgIH0sXG4gICAgLyojIyMjIyovXG5cbiAgICB1cGRhdGVVc2VySW5mb1dpdGhVc2VyczogZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICBsZXQgdXNlciA9IHVzZXJzLmZpbmQoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudXNlcklkID09IGUuaWQ7XG4gICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICB0aGlzLnVwZGF0ZVVzZXJJbmZvKHVzZXIpO1xuICAgIH0sXG5cbiAgICB1cGRhdGVVc2VySW5mbzogZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgIHRoaXMuX3VzZXJJbmZvID0gdXNlcjtcbiAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSAodXNlciAhPSBudWxsKTtcbiAgICAgIHRoaXMudXNlckluZm9Ob2RlLmFjdGl2ZSA9IHRoaXMubm9kZS5hY3RpdmU7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICB1c2VySW5mby51cGRhdGVBdmF0YXIodXNlci5hdmF0YXJVcmwpO1xuICAgICAgdXNlckluZm8udXBkYXRlTmlja25hbWUodXNlci5uaWNrbmFtZSk7XG4gICAgICB1c2VySW5mby5zZXRPZmZsaW5lVmlzaWJsZSghdXNlci5vbmxpbmVTdGF0dXMpO1xuXG4gICAgICAvL2lmICh0aGlzLl9kZXNrSW5mbyAmJiB0aGlzLl9kZXNrSW5mby5jSW5kZXggPiAwKSB7XG4gICAgICAvLyAgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHVzZXIpKSB7XG4gICAgICAvLyAgICB0aGlzLnBsYXlDYXJkKHVzZXIuaWQpO1xuICAgICAgLy8gICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2V0Q29tcGFyZURhdGEodXNlcik7XG4gICAgICAvLyAgfVxuICAgICAgLy99XG4gICAgICAgIC8qKi9cbiAgICAgICAgY29uc3QgY0luZGV4ID0gdGhpcy5fZGVza0luZm8uY0luZGV4O1xuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8gJiYgY0luZGV4ID4gMCAmJiAodGhpcy5wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMuaW5kZXhPZihjSW5kZXgpID09IC0xKSkge1xuICAgICAgICAgICAgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHVzZXIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5Q2FyZCh1c2VyLmlkLHVzZXIuY2FyZEluZm8pO1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNldENvbXBhcmVEYXRhKHVzZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qKi9cbiAgICB9LFxuXG4gICAgLy8g5pu05paw5oi/5Li75L+h5oGvXG4gICAgdXBkYXRlQmFua2VyOiBmdW5jdGlvbigpIHtcbiAgICAgIGxldCB1c2VySW5mb0NvbXAgPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICBpZiAoIXRoaXMuX3VzZXJJbmZvKSB7XG4gICAgICAgIHVzZXJJbmZvQ29tcC5zZXRJc0JhbmtlcihmYWxzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IGlzQmFua2VyID0gdGhpcy5fdXNlckluZm8gPyB0aGlzLl91c2VySW5mby5pc0JhbmtlciA6IGZhbHNlO1xuICAgICAgdXNlckluZm9Db21wLnNldElzQmFua2VyKGlzQmFua2VyKTsgICAgICBcbiAgICB9LFxuXG4gICAgc2hvd0ZhbmdaaHVTdGF0dXM6IGZ1bmN0aW9uIChjcmVhdGVJZCwgdmlzaWJsZSA9IHRydWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3VzZXJJbmZvLmlkID09IGNyZWF0ZUlkKSB7XG4gICAgICAgICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0RmFuZ1podU5vZGVWaXNpYmxlKHZpc2libGUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIOabtOaWsOWIhuaVsCBcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc2NvcmUg55So5oi35YiG5pWw44CB5Y+v6YCJXG4gICAgICovXG4gICAgdXBkYXRlU2NvcmU6IGZ1bmN0aW9uKHNjb3JlKSB7XG4gICAgICBpZiAoIXNjb3JlICYmIHRoaXMuX3VzZXJJbmZvKSB7XG4gICAgICAgIHNjb3JlID0gdGhpcy5fdXNlckluZm8udG90YWxTY29yZTtcbiAgICAgIH1cblxuICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgdXNlckluZm8udXBkYXRlU2NvcmUoc2NvcmUpO1xuICAgIH0sXG5cbiAgICBzaG93UmVhZHlTdGF0dXM6IGZ1bmN0aW9uICh1c2VySWQsIHZpc2libGUgPSB0cnVlKSB7XG4gICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5fdXNlckluZm8uaWQgPT0gdXNlcklkKSB7XG4gICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRSZWFkeU5vZGVWaXNpYmxlKHZpc2libGUpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvKnNldERlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcbiAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcbiAgICAgfSwqL1xuICAgIHVwZGF0ZURlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcblxuICAgICAgICBpZiAoZGVza0luZm8gJiYgIWRlc2tJbmZvLmlzQ0JlZ2luKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8qKi9cblxuICAgIGhpZGVSZWFkeVN0YXR1czogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldFJlYWR5Tm9kZVZpc2libGUoZmFsc2UpO1xuICAgIH0sXG5cbiAgICBwbGF5RmFQYWlBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNjLmxvZyhcInBsYXlGYVBhaUFuaW1hdGlvblwiKTtcbiAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh0aGlzLl91c2VySW5mbykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgY2FyZHNCYWNrID0gdGhpcy5jYXJkc0JhY2tMYXlvdXQuZ2V0Q29tcG9uZW50KCdjYXJkc0JhY2snKTtcbiAgICAgIGNhcmRzQmFjay5zaG93UGxheUNhcmRCYWNrcygpO1xuICAgIH0sXG5cbiAgICBzaG91bGRTaG93RmFQYWlBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh0aGlzLl91c2VySW5mbyk7XG4gICAgfSxcblxuICAgIHNldFVzZXJPbmxpbmVTdGF0dXM6IGZ1bmN0aW9uICh1c2VySWQsIHN0YXR1cyA9IDEpIHtcbiAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICB1c2VySW5mby5zZXRPZmZsaW5lVmlzaWJsZShzdGF0dXMgIT0gMSk7XG4gICAgfSxcblxuICAgIHNob3dDaGF0VGV4dDogZnVuY3Rpb24gKHVzZXJJZCwgbWVzc2FnZSkge1xuICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBjaGF0TWVzc2FnZSA9IHRoaXMuY2hhdE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnQ2hhdE1lc3NhZ2UnKTtcbiAgICAgIGNoYXRNZXNzYWdlLnNldFN0cmluZyhtZXNzYWdlKTtcbiAgICB9LFxuXG4gICAgLy8g55So5oi35bey57uP5Ye654mM77yM5aSE5LqO5LiJ5aCG55uW552A54mM55qE54q25oCBXG4gICAgcGxheUNhcmQ6IGZ1bmN0aW9uICh1c2VySWQsY2FyZEluZm8pIHtcbiAgICAgIGlmICh0aGlzLnVzZXJJZCAhPSB1c2VySWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy50ZVNodVBhaUxhYmVsLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgLyojIyMjI+WmguaenOaYr+eJueauiueJjOWwseaYvuekuueJueauiueJjOWei+i/meWbm+S4quWtl+WcqOebluedgOeJjOeahOS4iumdoiovXG4gICAgICB2YXIgcGxheSA9IGNjLmZpbmQoXCJDYW52YXNcIikuZ2V0Q29tcG9uZW50KFwicGxheVwiKTsgIC8vcGxheee7hOS7tlxuICAgICAgLy/lpoLmnpzngrnlh7vkuobmga3llpzkvaDpobXpnaLnmoTnoa7lrprmjInpkq5cbiAgICAgIC8vaWYodGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudChcIkNhcmRUeXBlQ29tYmluZVwiKS5CdG5DbGlja0dvbmdYaU5pQ29tZmlybSl7XG4gICAgICAgICAgaWYoY2MubW9zaGkgIT0gMSl7XG4gICAgICAgICAgICAgIGlmKHBsYXkuZ2V0SXNUZVNodVBhaSh0aGlzLnVzZXJJZCkpe1xuICAgICAgICAgICAgICAgICAgdGhpcy50ZVNodVBhaUxhYmVsLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgdGhpcy50ZVNodVBhaUxhYmVsLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBjYy5sb2codGhpcylcbiAgICAgICAgY2MubG9nKCctLS0tLS0yMjknKVxuICAgICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7Ly9cIuWbnuaUvlwiO1xuICAgICAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUxLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUxLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGlmKHRoaXMuZm9sZENhcmROb2RlLm5hbWUgIT0gXCJmb2xkQ2FyZE5vZGVTZWxmXCIpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCAzO2krKyl7XG4gICAgICAgICAgICB2YXIgbm9kZSA9IHRoaXMuZm9sZENhcmROb2RlLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICBub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgICAgICB2YXIgY2FyZE1vZGVzID0gW107XG4gICAgICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgY2FyZEluZm9baV0uY2FyZHMubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICAgICAgdmFyIHMgPSBjYXJkSW5mb1tpXS5jYXJkc1tqXTtcbiAgICAgICAgICAgICAgICBjYXJkTW9kZXMucHVzaChzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcmRNb2RlcyA9IGNhcmRNb2Rlcy5tYXAoZnVuY3Rpb24oc2VyQ2FyZCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlckNhcmQuc3VpdCsnXycrc2VyQ2FyZC5udW1iZXI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhcmRNb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTmFtZSkge1xuICAgICAgICAgICAgICAgIGxldCBjYXJkVHlwZVNwcml0ZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2FyZFR5cGVQcmVmYWIpO1xuICAgICAgICAgICAgICAgIGlmKGNjLm1hUGFpKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmRNYVBhaSA9ICczXycgKyBjYy5tYVBhaTtcbiAgICAgICAgICAgICAgICAgICAgaWYoY2FyZE5hbWUgPT0gY2FyZE1hUGFpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRUeXBlU3ByaXRlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDIyNiwgMTQ1LCAxNDUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKGkgPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRUeXBlU3ByaXRlLnkgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmKGkgPT0gMSl7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRUeXBlU3ByaXRlLnkgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmKGkgPT0gMil7XG4gICAgICAgICAgICAgICAgICAgIGNhcmRUeXBlU3ByaXRlLnkgPSA5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXJkVHlwZVNwcml0ZS53aWR0aCA9IDY2O1xuICAgICAgICAgICAgICAgIGNhcmRUeXBlU3ByaXRlLmhlaWdodCA9IDkyO1xuICAgICAgICAgICAgICAgIGNhcmRUeXBlU3ByaXRlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVTcHJpdGUnKS5zZXRDYXJkKGNhcmROYW1lKTtcbiAgICAgICAgICAgICAgICBub2RlLmFkZENoaWxkKGNhcmRUeXBlU3ByaXRlKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjYy5sb2cobm9kZSlcbiAgICAgICAgICAgIGNjLmxvZyh0aGlzLmZvbGRDYXJkTm9kZSlcbiAgICAgICAgICAgIGNjLmxvZyh0aGlzLmZvbGRDYXJkTm9kZTEpXG4gICAgICAgICAgICBjYy5sb2coJy0tLS0tLS0yMzknKVxuICAgICAgICB9XG4gICAgICAgIC8vfVxuXG4gICAgfSxcblxuICAgIC8vIOWHhuWkh+WlveW8gOWni+avlOeJjFxuICAgIHJlYWR5VG9Db21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlMS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMudGVTaHVQYWlMYWJlbC5hY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5omT5p6q5Yqo55S7XG4gICAgLy8gQHBhcmFtIHVzZXJJZCAgIOimgeS4u+WKqOaJk+aequeahOeUqOaIt2lkXG4gICAgLy8gQHBhcmFtIHRvVXNlckluZGV4ICDmjKjmnqrnmoTnlKjmiLfnmoQgaW5kZXhcbiAgICBwbGF5U2hvb3RBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQsIHRvVXNlckluZGV4KSB7XG4gICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgdXNlckluZm8ucGxheVNob290QW5pbWF0aW9uKHRvVXNlckluZGV4KTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5Lit5p6q5Yqo55S7XG4gICAgcGxheUJ1bGxldEhvbGVBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICB1c2VySW5mby5wbGF5QnVsbGV0SG9sZUFuaW1hdGlvbigpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7lhajlnpLmiZPliqjnlLtcbiAgICBwbGF5SG9tZVJ1bkFpbWF0aW9uOiBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpO1xuICAgICAgdXNlckluZm8ucGxheUhvbWVSdW5BaW1hdGlvbigpO1xuICAgIH0sXG5cbiAgICBwbGF5U3BlYWtBbmltYXRpb246IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICB1c2VySW5mby5wbGF5U3BlYWtBbmltYXRpb24oKTtcbiAgICB9LFxuXG4gICAgbmV4dENvbXBhcmVTY29yZTogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuXG4gICAgICBsZXQgc2NvcmUgPSB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5uZXh0Q29tcGFyZVNjb3JlKCk7XG4gICAgICByZXR1cm4gc2NvcmU7XG4gICAgfSxcblxuICAgIHNob3dOZXh0Q29tcGFyZUNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5uZXh0Q29tcGFyZVNjb3JlKCkgPD0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnNob3dOZXh0Q2FyZHMoKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBLUUNhcmRSZXNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRSZXNIZWxwZXInKTtcbmNvbnN0IFNwcml0ZUhlbHBlciA9IHJlcXVpcmUoJ1Nwcml0ZUhlbHBlcicpO1xuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxSZXN1bHROdW1iZXI6IGNjLkxhYmVsLFxuICAgICAgICBsYXlvdXRUb3VEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0WmhvbmdEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0V2VpRGFvOiBjYy5MYXlvdXQsXG4gICAgICAgIGxheW91dFRlU2h1OiBjYy5MYXlvdXQsXG5cbiAgICAgICAgbGFiZWxUZVNodVBhaVRpdGxlOiBjYy5MYWJlbCxcblxuICAgICAgICBzY29yZVVuaXROb2RlOiBjYy5Ob2RlLCAgICAgIC8vIOenr+WIhlxuICAgICAgICBkaWFtb25kVW5pdE5vZGU6IGNjLk5vZGUsICAgIC8vIOmSu+efs1xuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICB9LFxuXG4gICAgLy97XCJpZFwiOjEwMDA0OSxcIm5pY2tuYW1lXCI6XCJpbXlhXCIsXCJvcGVuSWRcIjpcInh4XCIsXCJhdmF0YXJVcmxcIjpcInh4XCIsXCJzZXhcIjoxLFxuICAgIC8vIFwiY2FyZE51bWJlclwiOjMsXCJvbmxpbmVTdGF0dXNcIjoxLFwiaW52aXRlQ29kZVwiOlwiXCIsXCJpcEFkZHJlc3NcIjpcIjo6ZmZmZjoyMjIuMjQ0LjY1LjIwMVwiLFxuICAgIC8vIFwibGFzdExvZ2luVGltZVwiOlwiMjAxNy0wNC0xMyAyMjowOTowMVwiLFwiY3JlYXRlQXRcIjpcIjIwMTctMDQtMTEgMjI6Mzk6MzBcIixcbiAgICAvLyBcInVwZGF0ZUF0XCI6XCIyMDE3LTA0LTEzIDIyOjA5OjAxXCIsXG4gICAgLy8gXCJjYXJkc1wiOltdLFwicm9vbUlkXCI6XCI1OTg4ODNcIixcInJlYWR5U3RhdHVzXCI6dHJ1ZSxcInRvdGFsU2NvcmVcIjowLFxuICAgIC8vIFwiY1Njb3JlXCI6MCxcImlzQmFua2VyXCI6ZmFsc2V9XG4gICAgdXBkYXRlV2l0aFBsYXllckluZm86IGZ1bmN0aW9uIChwbGF5ZXJJbmZvLCBpc1JhbmRvbVJvb20gPSBmYWxzZSkge1xuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCBwbGF5ZXJJbmZvLmF2YXRhclVybCk7XG4gICAgICB0aGlzLmxhYmVsTmlja25hbWUuc3RyaW5nID0gcGxheWVySW5mby5uaWNrbmFtZTtcbiAgICAgICAgLy9jYy5sb2codGhpcy5sYWJlbFJlc3VsdE51bWJlci5zdHJpbmcpXG4gICAgICAgIC8vY2MubG9nKHBsYXllckluZm8pXG4gICAgICAgIC8vY2MubG9nKHBsYXllckluZm8uY1Njb3JlKVxuICAgICAgICAvL2NjLmxvZygnLS0tMzYnKVxuICAgICAgdGhpcy5sYWJlbFJlc3VsdE51bWJlci5zdHJpbmcgPSBwbGF5ZXJJbmZvLmNTY29yZTtcblxuICAgICAgdGhpcy5zY29yZVVuaXROb2RlLmFjdGl2ZSA9ICFpc1JhbmRvbVJvb207XG4gICAgICB0aGlzLmRpYW1vbmRVbml0Tm9kZS5hY3RpdmUgPSBpc1JhbmRvbVJvb207XG4gICAgICB2YXIgTnVtYmVyID0gcGxheWVySW5mby5jU2NvcmU7XG4gICAgICBpZiAoaXNSYW5kb21Sb29tKSB7XG4gICAgICAgIC8vIOWmguaenOaYr+maj+acuuWcuueahOivne+8jOWImeaYvuekuumSu+efs+aVsOmHj1xuICAgICAgICAgIE51bWJlciA9IHBsYXllckluZm8uY1Njb3JlICogNTtcbiAgICAgIH1cbiAgICAgICAgdGhpcy5sYWJlbFJlc3VsdE51bWJlci5zdHJpbmcgPSBOdW1iZXI7XG4gICAgfSxcblxuICAgIHNldENhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIGNjLmFzc2VydChjYXJkcy5sZW5ndGggPT0gMTMpO1xuXG4gICAgICAvLyDkuI3kvJrlho3mnInnibnmrorniYzkuoZcbiAgICAgICAvKmlmIChLUUNhcmQuaXNUZVNodVBhaShjYXJkcykpIHtcbiAgICAgICAgIHRoaXMuc2V0VGVTaHVDYXJkcyhjYXJkcyk7XG4gICAgICAgICByZXR1cm47XG4gICAgICAgICB9XG4gICAgICAqL1xuXG4gICAgICAvL2xldCB0b3VDYXJkcyA9IGNhcmRzLnNsaWNlKDAsIDMpO1xuICAgICAgLy9sZXQgemhvbmdDYXJkcyA9IGNhcmRzLnNsaWNlKDMsIDMgKyA1KTtcbiAgICAgIC8vbGV0IHdlaUNhcmRzID0gY2FyZHMuc2xpY2UoOCk7XG4gICAgICAvL3RoaXMuc2V0VG91Q2FyZHModG91Q2FyZHMpO1xuICAgICAgLy90aGlzLnNldFpob25nQ2FyZHMoemhvbmdDYXJkcyk7XG4gICAgICAvL3RoaXMuc2V0V2VpQ2FyZHMod2VpQ2FyZHMpO1xuICAgIH0sXG5cbiAgICAvKnNldFRvdUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRUb3VEYW8sIGNhcmRzKTtcbiAgICB9LFxuXG4gICAgc2V0WmhvbmdDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICB0aGlzLl9zZXRDYXJkc1RvTGF5b3V0KHRoaXMubGF5b3V0WmhvbmdEYW8sIGNhcmRzKTtcbiAgICB9LFxuXG5cbiAgICBzZXRXZWlDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICB0aGlzLl9zZXRDYXJkc1RvTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLCBjYXJkcyk7XG4gICAgfSwqL1xuXG4gICAgLy/nu5PnrpcgIOWwhueJueauiueJjOaUvuWFpUxheW91dFxuICAgIC8qc2V0VGVTaHVDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICB0aGlzLmxheW91dFRlU2h1Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIHRoaXMubGF5b3V0VG91RGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmxheW91dFpob25nRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmxheW91dFdlaURhby5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5fc2V0Q2FyZHNUb0xheW91dCh0aGlzLmxheW91dFRlU2h1LCBjYXJkcyk7XG5cbiAgICAgIGxldCB0eXBlTmFtZSA9IEtRQ2FyZC5jYXJkc1R5cGVOYW1lKGNhcmRzKTtcbiAgICAgIHRoaXMubGFiZWxUZVNodVBhaVRpdGxlLnN0cmluZyA9IHR5cGVOYW1lO1xuICAgIH0sKi9cblxuICAgLy/nu5PnrpflsIbniYzmlL7liLBMYXlvdXTph4zpnaJcbiAgICAvKl9zZXRDYXJkc1RvTGF5b3V0OiBmdW5jdGlvbiAobGF5b3V0LCBjYXJkcykge1xuICAgICAgbGV0IG5vZGUgPSBsYXlvdXQubm9kZTtcbiAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoc3ByaXRlTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgbGV0IHNwcml0ZSA9IHNwcml0ZU5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcbiAgICAgICAgbGV0IGNhcmQgPSBjYXJkc1tpbmRleF07XG4gICAgICAgIGlmICghY2FyZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIEtRQ2FyZFJlc0hlbHBlci5zZXRDYXJkU3ByaXRlRnJhbWUoc3ByaXRlLCBjYXJkLmNhcmROYW1lKCkpO1xuICAgICAgfSk7XG4gICAgfSwqL1xufSk7XG4iLCJjb25zdCBNYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgbXVzaWNTbGlkZXI6Y2MuTm9kZSxcbiAgICAgIGVmZmVjdFNsaWRlcjpjYy5Ob2RlLFxuICAgICAgYnRuU3dpdGNoQWNjb3VudDogY2MuQnV0dG9uLFxuXG4gICAgICBfYXVkaW9NYW5hZ2VyOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2F1ZGlvTWFuYWdlciA9IGNjLmZpbmQoJ0F1ZGlvTWFuYWdlcicpIHx8IHt9O1xuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyID0gdGhpcy5fYXVkaW9NYW5hZ2VyLmdldENvbXBvbmVudCgnQXVkaW9NYW5hZ2VyJyk7XG5cbiAgICAgIHRoaXMuX2luaXRTbGlkZXJzKCk7XG4gICAgfSxcblxuICAgIF9pbml0U2xpZGVyczogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5faW5pdFNsaWRlckV2ZW50cygpO1xuXG4gICAgICBsZXQgbXVzaWNWYWwgPSBNYW5hZ2VyLmdldE11c2ljVmFsdWUoKTtcbiAgICAgIGxldCBlZmZlY3RWYWwgPSBNYW5hZ2VyLmdldE11c2ljRWZmZWN0VmFsdWUoKTtcblxuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4obXVzaWNWYWwpO1xuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyLnNldEVmZmVjdE11c2ljVm9sdW0oZWZmZWN0VmFsKTtcblxuICAgICAgdGhpcy5tdXNpY1NsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLnNldFZhbHVlKG11c2ljVmFsKTtcbiAgICAgIHRoaXMuZWZmZWN0U2xpZGVyLmdldENvbXBvbmVudCgnc2xpZGVyJykuc2V0VmFsdWUoZWZmZWN0VmFsKTtcbiAgICB9LFxuXG4gICAgX2luaXRTbGlkZXJFdmVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgIHRoaXMubXVzaWNTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5vblZhbHVlQ2hhbmdlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgTWFuYWdlci5zZXRNdXNpY1ZhbHVlKHZhbHVlKTtcbiAgICAgICAgc2VsZi5fYXVkaW9NYW5hZ2VyLnNldEJnTXVzaWNWb2x1bW4odmFsdWUpO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5lZmZlY3RTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5vblZhbHVlQ2hhbmdlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgTWFuYWdlci5zZXRNdXNpY0VmZmVjdFZhbHVlKHZhbHVlKTtcbiAgICAgICAgc2VsZi5fYXVkaW9NYW5hZ2VyLnNldEVmZmVjdE11c2ljVm9sdW0odmFsdWUpO1xuICAgICAgfTtcbiAgICB9LFxuXG4gICAgY2xpY2tTd2l0Y2g6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBoaWRlU3dpdGNoOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLmJ0blN3aXRjaEFjY291bnQpIHtcbiAgICAgICAgdGhpcy5idG5Td2l0Y2hBY2NvdW50Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcbn0pO1xuIiwibGV0IFNwcml0ZUhlbHBlciA9IHtcbiAgc2V0SW1hZ2VVcmw6IGZ1bmN0aW9uIChzcHJpdGUsIHVybCkge1xuICAgIGlmICh1cmwuZW5kc1dpdGgoXCJwbmdcIikgfHwgdXJsLmVuZHNXaXRoKFwianBnXCIpIHx8IHVybC5lbmRzV2l0aChcImdpZlwiKSkge1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIHVybCA9IHVybCArIFwiLnBuZ1wiO1xuICAgIH1cblxuICAgIGNjLmxvYWRlci5sb2FkKHVybCwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZShkYXRhKTtcbiAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xuICAgIH0pO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTcHJpdGVIZWxwZXI7XG4iLCIvLyDnu5kgU3RyaW5nIOa3u+WKoOWKn+iDvVxuXG4vLyBzdHIuc3RhcnRzV2l0aChcIlwiKTtcbi8vIHN0ci5lbmRzV2l0aChcIlwiKTtcblxuaWYgKCFTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGgpIHtcbiAgKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JzsgLy8gbmVlZGVkIHRvIHN1cHBvcnQgYGFwcGx5YC9gY2FsbGAgd2l0aCBgdW5kZWZpbmVkYC9gbnVsbGBcbiAgICB2YXIgZGVmaW5lUHJvcGVydHkgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAvLyBJRSA4IG9ubHkgc3VwcG9ydHMgYE9iamVjdC5kZWZpbmVQcm9wZXJ0eWAgb24gRE9NIGVsZW1lbnRzXG4gICAgICB0cnkge1xuICAgICAgICB2YXIgb2JqZWN0ID0ge307XG4gICAgICAgIHZhciAkZGVmaW5lUHJvcGVydHkgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG4gICAgICAgIHZhciByZXN1bHQgPSAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCBvYmplY3QsIG9iamVjdCkgJiYgJGRlZmluZVByb3BlcnR5O1xuICAgICAgfSBjYXRjaChlcnJvcikge31cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSgpKTtcbiAgICB2YXIgdG9TdHJpbmcgPSB7fS50b1N0cmluZztcbiAgICB2YXIgc3RhcnRzV2l0aCA9IGZ1bmN0aW9uKHNlYXJjaCkge1xuICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBUeXBlRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHZhciBzdHJpbmcgPSBTdHJpbmcodGhpcyk7XG4gICAgICBpZiAoc2VhcmNoICYmIHRvU3RyaW5nLmNhbGwoc2VhcmNoKSA9PSAnW29iamVjdCBSZWdFeHBdJykge1xuICAgICAgICB0aHJvdyBUeXBlRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHZhciBzdHJpbmdMZW5ndGggPSBzdHJpbmcubGVuZ3RoO1xuICAgICAgdmFyIHNlYXJjaFN0cmluZyA9IFN0cmluZyhzZWFyY2gpO1xuICAgICAgdmFyIHNlYXJjaExlbmd0aCA9IHNlYXJjaFN0cmluZy5sZW5ndGg7XG4gICAgICB2YXIgcG9zaXRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcbiAgICAgIC8vIGBUb0ludGVnZXJgXG4gICAgICB2YXIgcG9zID0gcG9zaXRpb24gPyBOdW1iZXIocG9zaXRpb24pIDogMDtcbiAgICAgIGlmIChwb3MgIT0gcG9zKSB7IC8vIGJldHRlciBgaXNOYU5gXG4gICAgICAgIHBvcyA9IDA7XG4gICAgICB9XG4gICAgICB2YXIgc3RhcnQgPSBNYXRoLm1pbihNYXRoLm1heChwb3MsIDApLCBzdHJpbmdMZW5ndGgpO1xuICAgICAgLy8gQXZvaWQgdGhlIGBpbmRleE9mYCBjYWxsIGlmIG5vIG1hdGNoIGlzIHBvc3NpYmxlXG4gICAgICBpZiAoc2VhcmNoTGVuZ3RoICsgc3RhcnQgPiBzdHJpbmdMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gLTE7XG4gICAgICB3aGlsZSAoKytpbmRleCA8IHNlYXJjaExlbmd0aCkge1xuICAgICAgICBpZiAoc3RyaW5nLmNoYXJDb2RlQXQoc3RhcnQgKyBpbmRleCkgIT0gc2VhcmNoU3RyaW5nLmNoYXJDb2RlQXQoaW5kZXgpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIGlmIChkZWZpbmVQcm9wZXJ0eSkge1xuICAgICAgZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ3N0YXJ0c1dpdGgnLCB7XG4gICAgICAgICd2YWx1ZSc6IHN0YXJ0c1dpdGgsXG4gICAgICAgICdjb25maWd1cmFibGUnOiB0cnVlLFxuICAgICAgICAnd3JpdGFibGUnOiB0cnVlXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoID0gc3RhcnRzV2l0aDtcbiAgICB9XG4gIH0oKSk7XG59XG5cbi8vIHN0ci5lbmRzV2l0aChcIlwiKTtcbmlmICghU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aCkge1xuXHQoZnVuY3Rpb24oKSB7XG5cdFx0J3VzZSBzdHJpY3QnOyAvLyBuZWVkZWQgdG8gc3VwcG9ydCBgYXBwbHlgL2BjYWxsYCB3aXRoIGB1bmRlZmluZWRgL2BudWxsYFxuXHRcdHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbigpIHtcblx0XHRcdC8vIElFIDggb25seSBzdXBwb3J0cyBgT2JqZWN0LmRlZmluZVByb3BlcnR5YCBvbiBET00gZWxlbWVudHNcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHZhciBvYmplY3QgPSB7fTtcblx0XHRcdFx0dmFyICRkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblx0XHRcdFx0dmFyIHJlc3VsdCA9ICRkZWZpbmVQcm9wZXJ0eShvYmplY3QsIG9iamVjdCwgb2JqZWN0KSAmJiAkZGVmaW5lUHJvcGVydHk7XG5cdFx0XHR9IGNhdGNoKGVycm9yKSB7fVxuXHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHR9KCkpO1xuXHRcdHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXHRcdHZhciBlbmRzV2l0aCA9IGZ1bmN0aW9uKHNlYXJjaCkge1xuXHRcdFx0aWYgKHRoaXMgPT0gbnVsbCkge1xuXHRcdFx0XHR0aHJvdyBUeXBlRXJyb3IoKTtcblx0XHRcdH1cblx0XHRcdHZhciBzdHJpbmcgPSBTdHJpbmcodGhpcyk7XG5cdFx0XHRpZiAoc2VhcmNoICYmIHRvU3RyaW5nLmNhbGwoc2VhcmNoKSA9PSAnW29iamVjdCBSZWdFeHBdJykge1xuXHRcdFx0XHR0aHJvdyBUeXBlRXJyb3IoKTtcblx0XHRcdH1cblx0XHRcdHZhciBzdHJpbmdMZW5ndGggPSBzdHJpbmcubGVuZ3RoO1xuXHRcdFx0dmFyIHNlYXJjaFN0cmluZyA9IFN0cmluZyhzZWFyY2gpO1xuXHRcdFx0dmFyIHNlYXJjaExlbmd0aCA9IHNlYXJjaFN0cmluZy5sZW5ndGg7XG5cdFx0XHR2YXIgcG9zID0gc3RyaW5nTGVuZ3RoO1xuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50c1sxXTtcblx0XHRcdFx0aWYgKHBvc2l0aW9uICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHQvLyBgVG9JbnRlZ2VyYFxuXHRcdFx0XHRcdHBvcyA9IHBvc2l0aW9uID8gTnVtYmVyKHBvc2l0aW9uKSA6IDA7XG5cdFx0XHRcdFx0aWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmBcblx0XHRcdFx0XHRcdHBvcyA9IDA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR2YXIgZW5kID0gTWF0aC5taW4oTWF0aC5tYXgocG9zLCAwKSwgc3RyaW5nTGVuZ3RoKTtcblx0XHRcdHZhciBzdGFydCA9IGVuZCAtIHNlYXJjaExlbmd0aDtcblx0XHRcdGlmIChzdGFydCA8IDApIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGluZGV4ID0gLTE7XG5cdFx0XHR3aGlsZSAoKytpbmRleCA8IHNlYXJjaExlbmd0aCkge1xuXHRcdFx0XHRpZiAoc3RyaW5nLmNoYXJDb2RlQXQoc3RhcnQgKyBpbmRleCkgIT0gc2VhcmNoU3RyaW5nLmNoYXJDb2RlQXQoaW5kZXgpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9O1xuXHRcdGlmIChkZWZpbmVQcm9wZXJ0eSkge1xuXHRcdFx0ZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ2VuZHNXaXRoJywge1xuXHRcdFx0XHQndmFsdWUnOiBlbmRzV2l0aCxcblx0XHRcdFx0J2NvbmZpZ3VyYWJsZSc6IHRydWUsXG5cdFx0XHRcdCd3cml0YWJsZSc6IHRydWVcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoID0gZW5kc1dpdGg7XG5cdFx0fVxuXHR9KCkpO1xufVxuIiwiY29uc3QgU3ByaXRlSGVscGVyID0gcmVxdWlyZSgnU3ByaXRlSGVscGVyJyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBhdmF0YXJTcHJpdGU6IGNjLlNwcml0ZSxcbiAgICAgICAgbGFiZWxVc2VySWQ6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFNjb3JlOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxOaWNrbmFtZTogY2MuTGFiZWwsXG5cbiAgICAgICAgX2Rlc2tJbmZvOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBzZXRVc2VySW5mbzogZnVuY3Rpb24gKHVzZXIsIGRlc2tJbmZvKSB7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgdG90YWxTY29yZSA9IHVzZXIudG90YWxTY29yZTtcbiAgICAgIGlmIChkZXNrSW5mbyAmJiAoKGRlc2tJbmZvLnNldHRpbmcxID09IDApIHx8IChkZXNrSW5mby5zZXR0aW5nMSA9PSAxKSkpIHtcbiAgICAgICAgbGV0IGJhc2VTY29yZSA9IChkZXNrSW5mby5zZXR0aW5nMSA9PSAwKSA/IDEwMCA6IDIwMDtcbiAgICAgICAgdG90YWxTY29yZSA9IHRvdGFsU2NvcmUgLSBiYXNlU2NvcmU7XG4gICAgICB9XG5cbiAgICAgIFNwcml0ZUhlbHBlci5zZXRJbWFnZVVybCh0aGlzLmF2YXRhclNwcml0ZSwgdXNlci5hdmF0YXJVcmwpO1xuICAgICAgdGhpcy5sYWJlbFVzZXJJZC5zdHJpbmcgPSBcIlwiICsgdXNlci5pZDtcbiAgICAgIHRoaXMubGFiZWxTY29yZS5zdHJpbmcgPSAodG90YWxTY29yZSA+IDApID8gKFwiKyBcIiArIHRvdGFsU2NvcmUpIDogKFwiLSBcIiArIHRvdGFsU2NvcmUgKiAtMSk7XG4gICAgICBpZiAodG90YWxTY29yZSA9PSAwKSB7XG4gICAgICAgIHRoaXMubGFiZWxTY29yZS5zdHJpbmcgPSBcIjBcIjtcbiAgICAgIH1cbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSB1c2VyLm5pY2tuYW1lO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGl0ZW1MYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgaXRlbVByZWZhYjogY2MuUHJlZmFiLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICB9LFxuXG4gICAgc2V0UGxheWVySW5mb3M6IGZ1bmN0aW9uIChwbGF5ZXJJbmZvcywgZGVza0luZm8pIHtcbiAgICAgICAgdGhpcy5pdGVtTGF5b3V0Lm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgIHBsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgbGV0IGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLml0ZW1QcmVmYWIpO1xuICAgICAgICBpdGVtLmdldENvbXBvbmVudCgnVG90YWxHYW1lUmVzdWx0SXRlbScpLnNldFVzZXJJbmZvKHVzZXIsIGRlc2tJbmZvKTtcbiAgICAgICAgICBpZihkZXNrSW5mby5jcmVhdGVJZCA9PSB1c2VyLmlkKXtcbiAgICAgICAgICAgICAgaXRlbS5jaGlsZHJlbls2XS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuWzZdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVtTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjbGlja1NoYXJlV2VpQ2hhdDogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVGcmllbmRcIiwpO1xuICAgICAgfVxuICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgS1FOYXRpdmVJbnZva2Uuc2NyZWVuc2hvdFNoYXJlKCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGNsaWNrU2hhcmVQZW5nWW91UXVhbjogZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVcIiwpO1xuICAgICAgfVxuICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgXCIoKVZcIik7XG4gICAgICB9XG4gICAgfSxcbn0pO1xuIiwiY29uc3QgVXNlck1vZGVsSGVscGVyID0ge1xuICAvLyDnlKjmiLfmmK/lkKblt7Llh7rniYxcbiAgaXNQbGF5ZWRDYXJkczogZnVuY3Rpb24gKHVzZXIpIHtcbiAgICBjYy5hc3NlcnQodXNlcik7XG5cbiAgICBpZiAodXNlciAmJiB1c2VyLmNhcmRJbmZvICYmIHVzZXIuY2FyZEluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIC8vIOeUqOaIt+aYr+WQpuW3suWHhuWkh1xuICBpc1VzZXJSZWFkeTogZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gdXNlci5yZWFkeVN0YXR1cyA9PSB0cnVlO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVc2VyTW9kZWxIZWxwZXI7XG4iLCJjb25zdCBTcHJpdGVIZWxwZXIgPSByZXF1aXJlKCdTcHJpdGVIZWxwZXInKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGFiZWxVc2VySWQ6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFVzZXJJUDogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsTmlja25hbWU6IGNjLkxhYmVsLFxuICAgICAgICBhdmF0YXJTcHJpdGU6IGNjLlNwcml0ZSxcbiAgICAgICAgbWFuU3ByaXRlOiBjYy5TcHJpdGUsXG4gICAgICAgIHdvbWVuU3ByaXRlOiBjYy5TcHJpdGUsXG5cbiAgICAgICAgX2RpZFNob3dVc2VySW5mbzogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgdXBkYXRlV2l0aFVzZXI6IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5fZGlkU2hvd1VzZXJJbmZvID09IHVzZXIpIHtcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XG4gICAgICAgIHRoaXMuX2Rpc2FwcGVhclVzZXJJbmZvKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fZGlkU2hvd1VzZXJJbmZvID0gdXNlcjtcbiAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kaXNhcHBlYXJVc2VySW5mbygpO1xuICAgICAgfS5iaW5kKHRoaXMpLCA1KTtcblxuICAgICAgdGhpcy5sYWJlbFVzZXJJZC5zdHJpbmcgPVwiVUlEOlxcblwiK3VzZXIuaWQ7XG4gICAgICB0aGlzLmxhYmVsVXNlcklQLnN0cmluZyA9XCLnlKjmiLdJUDpcXG5cIit1c2VyLmlwQWRkcmVzcy5yZXBsYWNlKFwiOjpmZmZmOlwiLCBcIlwiKTtcbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSB1c2VyLm5pY2tuYW1lO1xuICAgICAgdGhpcy5hdmF0YXJTcHJpdGUuc3ByaXRlRnJhbWUgPSBudWxsO1xuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCB1c2VyLmF2YXRhclVybCk7XG5cbiAgICAgIGxldCBzZXggPSB1c2VyLnNleDsgIC8vIHNleDogMSDnlLcgIDIg5aWzXG4gICAgICB0aGlzLm1hblNwcml0ZS5ub2RlLmFjdGl2ZSA9IChzZXggPT0gMSk7XG4gICAgICB0aGlzLndvbWVuU3ByaXRlLm5vZGUuYWN0aXZlID0gKHNleCAhPSAxKTtcbiAgICB9LFxuXG4gICAgX2Rpc2FwcGVhclVzZXJJbmZvOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLl9kaWRTaG93VXNlckluZm8gPSBudWxsO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xyXG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xyXG5jb25zdCBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyID0gcmVxdWlyZSgnS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlcicpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgYWdyZWVtZW50OiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLkxhYmVsXHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlSGFsbEluZm8sIHRoaXMuX3NvY2tldFJlY2VpdmVIYWxsSW5mbywgdGhpcyk7XHJcbiAgICAgICAgY2MubG9nKCctLS0tNjEnKVxyXG4gICAgICAgICBjYy5sb2codGhpcy5hZ3JlZW1lbnQpXHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2VpdmVIYWxsSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcyA9IGNjLmZpbmQoJ0NhbnZhcy9hZ3JlZW1lbnQnKTtcclxuICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgLy90aGlzLl9pbmZvMSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgY2MubG9nKHRoaXMuYWdyZWVtZW50KVxyXG4gICAgICAgIGNjLmxvZyhzKVxyXG4gICAgICAgIGNjLmxvZygnLS0tLTYxJylcclxuICAgICAgICB0aGlzLmFncmVlbWVudC5zdHJpbmcgPSBkYXRhLmluZm8xIHx8IFwiXCI7XHJcbiAgICB9LFxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsInZhciBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIHBvcE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgbGFiZWw6Y2MuTGFiZWwsXG5cbiAgICAgICAgX2FsZXJ0Q2FsbGJhY2s6IG51bGwsXG4gICAgICAgIF93aWxsRGlzbWlzc0NhbGxiYWNrOiBudWxsLFxuICAgICAgICBfZGlzbWlzc0NhbGxiYWNrOiBudWxsLFxuICAgICAgICBfY29uZmlybUNhbGxiYWNrOiBudWxsLCAgIC8vIOeCueWHu+ehruWumuWQjueahOWbnuiwg1xuICAgICAgICBfdGlzaGk6bnVsbCxcbiAgICAgICAgX2NhcmRfbnVtOm51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgXG4gICAgfSxcblxuICAgIGFsZXJ0OmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIGFuaW0ucGxheSgncG9wJyk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2FsZXJ0Q2FsbGJhY2spIHtcbiAgICAgICAgICB0aGlzLl9hbGVydENhbGxiYWNrKHRoaXMubm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8qIyMjIyPlvLnlh7rnu5PmnpwqL1xuICAgIGFsZXJ0UmVzdWx0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICBjYy5maW5kKFwiQ2FudmFzL3Nob3dfcmVzdWx0XCIpLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB2YXIgYW5pbSA9IHRoaXMucG9wTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgYW5pbS5wbGF5KCdwb3AnKTtcblxuICAgICAgICBpZiAodGhpcy5fYWxlcnRDYWxsYmFjaykge1xuICAgICAgICAgIHRoaXMuX2FsZXJ0Q2FsbGJhY2sodGhpcy5ub2RlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiMjIyMj54K55Ye756Gu5a6aKi9cbiAgICBwbGF5QnRuQ2xpY2tTRlg6ZnVuY3Rpb24oKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5QnRuQ2xpY2tTRlgoKTtcbiAgICB9LFxuXG4gICAgLyojIyMjI+eCueWHu+WPlua2iCovXG4gICAgcGFseUJ0bkNhbmNlbENsaWNrU0ZYOmZ1bmN0aW9uKCl7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5QnRuQ2FuY2VsQ2xpY2tTRlgoKTtcbiAgICB9LFxuXG4gICAgLyojIyMjI+eCueWHu+WFs+mXreaIluiAheaMiemUruS5i+exu+eahOaMiemSru+8jOaSreaUvumfs+aViCovXG4gICAgcGFseUJ0blB1YmxpY1NGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseUJ0blB1YmxpY1NGWCgpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj54K55Ye75Yib5bu65oi/6Ze077yM5pKt5pS+6Z+z5pWIKi9cbiAgICBwYWx5QnRuQ3JlYXRlUm9vbVNGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseUJ0bkNyZWF0ZVJvb21TRlgoKTtcbiAgICB9LFxuICAgIC8qIyMjIyPngrnlh7vliJvlu7rmiL/pl7TvvIzmkq3mlL7pn7PmlYgqL1xuICAgIHBhbHlXaW5kb3dTRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlXaW5kb3dTRlgoKTtcbiAgICB9LFxuXG4gICAgcGFseVdlaVhpbkxvZ2luU0ZYOmZ1bmN0aW9uKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseVdlaVhpbkxvZ2luU0ZYKCk7XG4gICAgfSxcbiAgICBwYWx5RmFuZ1BhaVNGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseUZhbmdQYWlTRlgoKTtcbiAgICB9LFxuXG4gICAgZGlzbWlzc0FjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgIGxldCB3aWxsRGlzbWlzc0NhbGxiYWNrID0gdGhpcy5fd2lsbERpc21pc3NDYWxsYmFjaztcbiAgICAgIGlmICh3aWxsRGlzbWlzc0NhbGxiYWNrKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB3aWxsRGlzbWlzc0NhbGxiYWNrKCk7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICB0aGlzLmRpc21pc3NDb21wbGV0ZSgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAgIHZhciBhbmltID0gdGhpcy5wb3BOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICB2YXIgZGlzbWlzc0FuaW0gPSBhbmltLmdldEFuaW1hdGlvblN0YXRlKCdwb3BfZGlzbWlzcycpO1xuICAgICAgICBkaXNtaXNzQW5pbS5vbignZmluaXNoZWQnLHRoaXMuZGlzbWlzc0NvbXBsZXRlLHRoaXMpO1xuICAgICAgICBhbmltLnBsYXkoJ3BvcF9kaXNtaXNzJyk7XG4gICAgfSxcblxuICAgIC8qIyMjIyPpmpDol4/nu5PmnpzpobXpnaIqL1xuICAgIGRpc21pc3NBY3Rpb25SZXN1bHQ6ZnVuY3Rpb24oKSB7XG4gICAgICBsZXQgd2lsbERpc21pc3NDYWxsYmFjayA9IHRoaXMuX3dpbGxEaXNtaXNzQ2FsbGJhY2s7XG4gICAgICBpZiAod2lsbERpc21pc3NDYWxsYmFjaykge1xuICAgICAgICBsZXQgcmVzdWx0ID0gd2lsbERpc21pc3NDYWxsYmFjaygpO1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgdGhpcy5kaXNtaXNzQ29tcGxldGUoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgICB2YXIgYW5pbSA9IHRoaXMucG9wTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgdmFyIGRpc21pc3NBbmltID0gYW5pbS5nZXRBbmltYXRpb25TdGF0ZSgncG9wX2Rpc21pc3MnKTtcbiAgICAgICAgZGlzbWlzc0FuaW0ub24oJ2ZpbmlzaGVkJyx0aGlzLmRpc21pc3NDb21wbGV0ZSx0aGlzKTtcbiAgICAgICAgYW5pbS5wbGF5KCdwb3BfZGlzbWlzcycpO1xuICAgICAgICBjYy5maW5kKFwiQ2FudmFzL3Nob3dfcmVzdWx0XCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgfSxcblxuICAgIGRpc21pc3NDb21wbGV0ZTpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIGlmICh0aGlzLm9uRGlzbWlzc0NvbXBsZXRlKSB7XG4gICAgICAgICAgdGhpcy5vbkRpc21pc3NDb21wbGV0ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2Rpc21pc3NDYWxsYmFjaykge1xuICAgICAgICAgIHRoaXMuX2Rpc21pc3NDYWxsYmFjayh0aGlzLm5vZGUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBkaXNtaXNzUGxheTpmdW5jdGlvbigpIHtcbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcImhhbGxcIik7ICBcbiAgICB9LFxuXG4gICAgb25EaXNtaXNzQ29tcGxldGU6ZnVuY3Rpb24oKSB7XG4gICAgICBjYy5sb2coXCJvbkRpc21pc3NDb21wbGV0ZVwiKTtcbiAgICB9LFxuXG4gICAgZG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIHRoaXMub25Eb25lQWN0aW9uKCk7XG5cbiAgICAgICAgbGV0IGNvbmZpcm1DYWxsYmFjayA9IHRoaXMuX2NvbmZpcm1DYWxsYmFjaztcbiAgICAgICAgaWYgKGNvbmZpcm1DYWxsYmFjaykge1xuICAgICAgICAgIGNvbmZpcm1DYWxsYmFjayh0aGlzLm5vZGUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uRG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcblxuICAgIH0sXG5cbiAgICBzZXRNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLmxhYmVsLnN0cmluZyA9IG1zZztcbiAgICB9LFxuXG4gICAgZ2V0TWVzc2FnZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubGFiZWwuc3RyaW5nO1xuICAgIH0sXG5cbiAgICBzZXRBbGVydENhbGxiY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5fYWxlcnRDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH0sXG5cbiAgICBzZXRXaWxsRGlzbWlzc0NhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX3dpbGxEaXNtaXNzQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9LFxuXG4gICAgc2V0RGlzbWlzc0NhbGxiYWNrOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX2Rpc21pc3NDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH0sXG5cbiAgICBzZXRDb25maXJtQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5fY29uZmlybUNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfSxcblxuICAgIC8qc2V0TWVzc2FnZTogZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgIHRoaXMubGFiZWwuZ2V0Q29tcG9uZW50KCdjYy5MYWJlbCcpLnN0cmluZyA9IG1lc3NhZ2U7XG4gICAgfSwqL1xuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiLy8g54mM6IOM5b2x5YiX6KGoIGNvbXBvbmVudFxuLy8g5Y+v5Lul5pi+56S644CB6ZqQ6JeP54mM6IOM5b2x5YiX6KGoXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBjYXJkc0JhY2tMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgY2FyZHNCYWNrTGlzdDogW2NjLlNwcml0ZV0sXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIC8vIOS7peWKqOeUu+eahOaWueW8j+aYvuekuueJjOiDjOW9sVxuICAgIHNob3dQbGF5Q2FyZEJhY2tzOiBmdW5jdGlvbiAoKSB7XG4gICAgICBjYy5sb2coXCLmmL7npLrniYzog4zlvbFcIik7XG4gICAgICB0aGlzLmhpZGVDYXJkQmFja3MoKTtcbiAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgbGV0IGludGVydmFsID0gMC4wNTtcbiAgICAgIHZhciBzdGFydFRpbWUgPSAwO1xuICAgICAgdGhpcy5jYXJkc0JhY2tMaXN0LmZvckVhY2goZnVuY3Rpb24oY2FyZEJhY2spe1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYXJkQmFjay5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0sIHN0YXJ0VGltZSk7XG4gICAgICAgIHN0YXJ0VGltZSA9IHN0YXJ0VGltZSArIGludGVydmFsO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgLy8g6ZqQ6JeP5pi+56S654mM6IOM5b2xXG4gICAgaGlkZUNhcmRCYWNrczogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuY2FyZHNCYWNrTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmRCYWNrKXtcbiAgICAgICAgY2FyZEJhY2subm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIC8q54mM6Iqx6ImyKi9cbiAgICAgICAgc3BhZGVzSW1hZ2VzOltjYy5TcHJpdGVGcmFtZV0sXG4gICAgICAgIGhlYXJ0c0ltYWdlczpbY2MuU3ByaXRlRnJhbWVdLFxuICAgICAgICBjbHViSW1hZ2VzOltjYy5TcHJpdGVGcmFtZV0sXG4gICAgICAgIGRpYW1vbmRJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgbGFiZWxNc2c6Y2MuTGFiZWwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFRleHQ6ZnVuY3Rpb24odGV4dCkge1xuICAgICAgICB0aGlzLmxhYmVsTXNnLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGV4dDtcbiAgICB9LFxuXG4gICAgY2xpY2tBY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdGV4dCA9IHRoaXMubGFiZWxNc2cuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmc7XG4gICAgICAgIHRoaXMub25TZWxlY3RBY3Rpb24odGV4dCk7XG4gICAgfSxcblxuICAgIG9uU2VsZWN0QWN0aW9uOmZ1bmN0aW9uKG1zZykge1xuXG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgc2VsZWN0ZWRJbmRleCA6IDAsXHJcbiAgICAgICAgc2VsZWN0ZWROb2RlIDogY2MuTm9kZSAgXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKGUsZGF0YSkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0aGlzLnNlbGVjdGVkO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWQ/MDpudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCJ2YXIgc29ja2V0ID0gcmVxdWlyZShcInNvY2tldFwiKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBvcHRpb246e1xyXG4gICAgICAgICAgICBkZWZhdWx0OltdLFxyXG4gICAgICAgICAgICB0eXBlOmNjLk5vZGVcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICBcclxuICAgIGNsaWNrQnRuY2hvdWppYW5nOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5vcHRpb24ubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIHRoaXMub3B0aW9uW2ldLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpbmRleCA9IDA7XHJcbiAgICAgICAgdGhpcy5fdGlzaGkgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjaG91amlhbmdfYmdcIikuZ2V0Q2hpbGRCeU5hbWUoXCJ0aXNoaVwiKTtcclxuICAgICAgICB0aGlzLl9jYXJkX251bSA9IGNjLmZpbmQoXCJDYW52YXMvdXNlci9zaG9wX2JnL2NhcmRfbnVtXCIpO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5fY2FyZF9udW0uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGlmKGluZGV4ID09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uW2luZGV4XS5vcGFjaXR5ID0gMTI4O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uW3RoaXMub3B0aW9uLmxlbmd0aC0xXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfWVsc2UgaWYoaW5kZXggPT0gMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXggLSAxXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXgtMV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGluZGV4ICsrO1xyXG4gICAgICAgICAgICAgICAgaWYoaW5kZXggPT0gdGhpcy5vcHRpb24ubGVuZ3RoKXtcclxuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgaWYoY29tcC5zdHJpbmcgPCAyMCkge1xyXG4gICAgICAgICAgICB0aGlzLl90aXNoaS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAvL2Nob3VqaWFuZ1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuY2FsbGJhY2ssMC4wNSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLmNhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5vcHRpb24ubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBpID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgfSwzLDAsMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgLy8qKipcclxuICAgIGNsaWNrQnRuQ29tZmlybTpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLl90aXNoaS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL3RoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICAvLyoqKipcclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiKGZ1bmN0aW9uIChtYWluKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogUGFyc2Ugb3IgZm9ybWF0IGRhdGVzXG4gICAqIEBjbGFzcyBmZWNoYVxuICAgKi9cbiAgdmFyIGZlY2hhID0ge307XG4gIHZhciB0b2tlbiA9IC9kezEsNH18TXsxLDR9fFlZKD86WVkpP3xTezEsM318RG98Wlp8KFtIaE1zRG1dKVxcMT98W2FBXXxcIlteXCJdKlwifCdbXiddKicvZztcbiAgdmFyIHR3b0RpZ2l0cyA9IC9cXGRcXGQ/LztcbiAgdmFyIHRocmVlRGlnaXRzID0gL1xcZHszfS87XG4gIHZhciBmb3VyRGlnaXRzID0gL1xcZHs0fS87XG4gIHZhciB3b3JkID0gL1swLTldKlsnYS16XFx1MDBBMC1cXHUwNUZGXFx1MDcwMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRkVGXSt8W1xcdTA2MDAtXFx1MDZGRlxcL10rKFxccyo/W1xcdTA2MDAtXFx1MDZGRl0rKXsxLDJ9L2k7XG4gIHZhciBsaXRlcmFsID0gL1xcWyhbXl0qPylcXF0vZ207XG4gIHZhciBub29wID0gZnVuY3Rpb24gKCkge1xuICB9O1xuXG4gIGZ1bmN0aW9uIHNob3J0ZW4oYXJyLCBzTGVuKSB7XG4gICAgdmFyIG5ld0FyciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIG5ld0Fyci5wdXNoKGFycltpXS5zdWJzdHIoMCwgc0xlbikpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3QXJyO1xuICB9XG5cbiAgZnVuY3Rpb24gbW9udGhVcGRhdGUoYXJyTmFtZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgdiwgaTE4bikge1xuICAgICAgdmFyIGluZGV4ID0gaTE4blthcnJOYW1lXS5pbmRleE9mKHYuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB2LnN1YnN0cigxKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIGlmICh+aW5kZXgpIHtcbiAgICAgICAgZC5tb250aCA9IGluZGV4O1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBwYWQodmFsLCBsZW4pIHtcbiAgICB2YWwgPSBTdHJpbmcodmFsKTtcbiAgICBsZW4gPSBsZW4gfHwgMjtcbiAgICB3aGlsZSAodmFsLmxlbmd0aCA8IGxlbikge1xuICAgICAgdmFsID0gJzAnICsgdmFsO1xuICAgIH1cbiAgICByZXR1cm4gdmFsO1xuICB9XG5cbiAgdmFyIGRheU5hbWVzID0gWydTdW5kYXknLCAnTW9uZGF5JywgJ1R1ZXNkYXknLCAnV2VkbmVzZGF5JywgJ1RodXJzZGF5JywgJ0ZyaWRheScsICdTYXR1cmRheSddO1xuICB2YXIgbW9udGhOYW1lcyA9IFsnSmFudWFyeScsICdGZWJydWFyeScsICdNYXJjaCcsICdBcHJpbCcsICdNYXknLCAnSnVuZScsICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlciddO1xuICB2YXIgbW9udGhOYW1lc1Nob3J0ID0gc2hvcnRlbihtb250aE5hbWVzLCAzKTtcbiAgdmFyIGRheU5hbWVzU2hvcnQgPSBzaG9ydGVuKGRheU5hbWVzLCAzKTtcbiAgZmVjaGEuaTE4biA9IHtcbiAgICBkYXlOYW1lc1Nob3J0OiBkYXlOYW1lc1Nob3J0LFxuICAgIGRheU5hbWVzOiBkYXlOYW1lcyxcbiAgICBtb250aE5hbWVzU2hvcnQ6IG1vbnRoTmFtZXNTaG9ydCxcbiAgICBtb250aE5hbWVzOiBtb250aE5hbWVzLFxuICAgIGFtUG06IFsnYW0nLCAncG0nXSxcbiAgICBEb0ZuOiBmdW5jdGlvbiBEb0ZuKEQpIHtcbiAgICAgIHJldHVybiBEICsgWyd0aCcsICdzdCcsICduZCcsICdyZCddW0QgJSAxMCA+IDMgPyAwIDogKEQgLSBEICUgMTAgIT09IDEwKSAqIEQgJSAxMF07XG4gICAgfVxuICB9O1xuXG4gIHZhciBmb3JtYXRGbGFncyA9IHtcbiAgICBEOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXREYXRlKCk7XG4gICAgfSxcbiAgICBERDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldERhdGUoKSk7XG4gICAgfSxcbiAgICBEbzogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGkxOG4uRG9GbihkYXRlT2JqLmdldERhdGUoKSk7XG4gICAgfSxcbiAgICBkOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXREYXkoKTtcbiAgICB9LFxuICAgIGRkOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0RGF5KCkpO1xuICAgIH0sXG4gICAgZGRkOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5kYXlOYW1lc1Nob3J0W2RhdGVPYmouZ2V0RGF5KCldO1xuICAgIH0sXG4gICAgZGRkZDogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGkxOG4uZGF5TmFtZXNbZGF0ZU9iai5nZXREYXkoKV07XG4gICAgfSxcbiAgICBNOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRNb250aCgpICsgMTtcbiAgICB9LFxuICAgIE1NOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0TW9udGgoKSArIDEpO1xuICAgIH0sXG4gICAgTU1NOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5tb250aE5hbWVzU2hvcnRbZGF0ZU9iai5nZXRNb250aCgpXTtcbiAgICB9LFxuICAgIE1NTU06IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBpMThuLm1vbnRoTmFtZXNbZGF0ZU9iai5nZXRNb250aCgpXTtcbiAgICB9LFxuICAgIFlZOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gU3RyaW5nKGRhdGVPYmouZ2V0RnVsbFllYXIoKSkuc3Vic3RyKDIpO1xuICAgIH0sXG4gICAgWVlZWTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0RnVsbFllYXIoKTtcbiAgICB9LFxuICAgIGg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldEhvdXJzKCkgJSAxMiB8fCAxMjtcbiAgICB9LFxuICAgIGhoOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0SG91cnMoKSAlIDEyIHx8IDEyKTtcbiAgICB9LFxuICAgIEg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldEhvdXJzKCk7XG4gICAgfSxcbiAgICBISDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldEhvdXJzKCkpO1xuICAgIH0sXG4gICAgbTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0TWludXRlcygpO1xuICAgIH0sXG4gICAgbW06IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRNaW51dGVzKCkpO1xuICAgIH0sXG4gICAgczogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0U2Vjb25kcygpO1xuICAgIH0sXG4gICAgc3M6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRTZWNvbmRzKCkpO1xuICAgIH0sXG4gICAgUzogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIE1hdGgucm91bmQoZGF0ZU9iai5nZXRNaWxsaXNlY29uZHMoKSAvIDEwMCk7XG4gICAgfSxcbiAgICBTUzogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChNYXRoLnJvdW5kKGRhdGVPYmouZ2V0TWlsbGlzZWNvbmRzKCkgLyAxMCksIDIpO1xuICAgIH0sXG4gICAgU1NTOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0TWlsbGlzZWNvbmRzKCksIDMpO1xuICAgIH0sXG4gICAgYTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKSA8IDEyID8gaTE4bi5hbVBtWzBdIDogaTE4bi5hbVBtWzFdO1xuICAgIH0sXG4gICAgQTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKSA8IDEyID8gaTE4bi5hbVBtWzBdLnRvVXBwZXJDYXNlKCkgOiBpMThuLmFtUG1bMV0udG9VcHBlckNhc2UoKTtcbiAgICB9LFxuICAgIFpaOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICB2YXIgbyA9IGRhdGVPYmouZ2V0VGltZXpvbmVPZmZzZXQoKTtcbiAgICAgIHJldHVybiAobyA+IDAgPyAnLScgOiAnKycpICsgcGFkKE1hdGguZmxvb3IoTWF0aC5hYnMobykgLyA2MCkgKiAxMDAgKyBNYXRoLmFicyhvKSAlIDYwLCA0KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHBhcnNlRmxhZ3MgPSB7XG4gICAgRDogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQuZGF5ID0gdjtcbiAgICB9XSxcbiAgICBEbzogW25ldyBSZWdFeHAodHdvRGlnaXRzLnNvdXJjZSArIHdvcmQuc291cmNlKSwgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQuZGF5ID0gcGFyc2VJbnQodiwgMTApO1xuICAgIH1dLFxuICAgIE06IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1vbnRoID0gdiAtIDE7XG4gICAgfV0sXG4gICAgWVk6IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICB2YXIgZGEgPSBuZXcgRGF0ZSgpLCBjZW50ID0gKygnJyArIGRhLmdldEZ1bGxZZWFyKCkpLnN1YnN0cigwLCAyKTtcbiAgICAgIGQueWVhciA9ICcnICsgKHYgPiA2OCA/IGNlbnQgLSAxIDogY2VudCkgKyB2O1xuICAgIH1dLFxuICAgIGg6IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLmhvdXIgPSB2O1xuICAgIH1dLFxuICAgIG06IFt0d29EaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1pbnV0ZSA9IHY7XG4gICAgfV0sXG4gICAgczogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQuc2Vjb25kID0gdjtcbiAgICB9XSxcbiAgICBZWVlZOiBbZm91ckRpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQueWVhciA9IHY7XG4gICAgfV0sXG4gICAgUzogWy9cXGQvLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5taWxsaXNlY29uZCA9IHYgKiAxMDA7XG4gICAgfV0sXG4gICAgU1M6IFsvXFxkezJ9LywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubWlsbGlzZWNvbmQgPSB2ICogMTA7XG4gICAgfV0sXG4gICAgU1NTOiBbdGhyZWVEaWdpdHMsIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1pbGxpc2Vjb25kID0gdjtcbiAgICB9XSxcbiAgICBkOiBbdHdvRGlnaXRzLCBub29wXSxcbiAgICBkZGQ6IFt3b3JkLCBub29wXSxcbiAgICBNTU06IFt3b3JkLCBtb250aFVwZGF0ZSgnbW9udGhOYW1lc1Nob3J0JyldLFxuICAgIE1NTU06IFt3b3JkLCBtb250aFVwZGF0ZSgnbW9udGhOYW1lcycpXSxcbiAgICBhOiBbd29yZCwgZnVuY3Rpb24gKGQsIHYsIGkxOG4pIHtcbiAgICAgIHZhciB2YWwgPSB2LnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAodmFsID09PSBpMThuLmFtUG1bMF0pIHtcbiAgICAgICAgZC5pc1BtID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKHZhbCA9PT0gaTE4bi5hbVBtWzFdKSB7XG4gICAgICAgIGQuaXNQbSA9IHRydWU7XG4gICAgICB9XG4gICAgfV0sXG4gICAgWlo6IFsvKFtcXCtcXC1dXFxkXFxkOj9cXGRcXGR8WikvLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgaWYgKHYgPT09ICdaJykgdiA9ICcrMDA6MDAnO1xuICAgICAgdmFyIHBhcnRzID0gKHYgKyAnJykubWF0Y2goLyhbXFwrXFwtXXxcXGRcXGQpL2dpKSwgbWludXRlcztcblxuICAgICAgaWYgKHBhcnRzKSB7XG4gICAgICAgIG1pbnV0ZXMgPSArKHBhcnRzWzFdICogNjApICsgcGFyc2VJbnQocGFydHNbMl0sIDEwKTtcbiAgICAgICAgZC50aW1lem9uZU9mZnNldCA9IHBhcnRzWzBdID09PSAnKycgPyBtaW51dGVzIDogLW1pbnV0ZXM7XG4gICAgICB9XG4gICAgfV1cbiAgfTtcbiAgcGFyc2VGbGFncy5kZCA9IHBhcnNlRmxhZ3MuZDtcbiAgcGFyc2VGbGFncy5kZGRkID0gcGFyc2VGbGFncy5kZGQ7XG4gIHBhcnNlRmxhZ3MuREQgPSBwYXJzZUZsYWdzLkQ7XG4gIHBhcnNlRmxhZ3MubW0gPSBwYXJzZUZsYWdzLm07XG4gIHBhcnNlRmxhZ3MuaGggPSBwYXJzZUZsYWdzLkggPSBwYXJzZUZsYWdzLkhIID0gcGFyc2VGbGFncy5oO1xuICBwYXJzZUZsYWdzLk1NID0gcGFyc2VGbGFncy5NO1xuICBwYXJzZUZsYWdzLnNzID0gcGFyc2VGbGFncy5zO1xuICBwYXJzZUZsYWdzLkEgPSBwYXJzZUZsYWdzLmE7XG5cblxuICAvLyBTb21lIGNvbW1vbiBmb3JtYXQgc3RyaW5nc1xuICBmZWNoYS5tYXNrcyA9IHtcbiAgICBkZWZhdWx0OiAnZGRkIE1NTSBERCBZWVlZIEhIOm1tOnNzJyxcbiAgICBzaG9ydERhdGU6ICdNL0QvWVknLFxuICAgIG1lZGl1bURhdGU6ICdNTU0gRCwgWVlZWScsXG4gICAgbG9uZ0RhdGU6ICdNTU1NIEQsIFlZWVknLFxuICAgIGZ1bGxEYXRlOiAnZGRkZCwgTU1NTSBELCBZWVlZJyxcbiAgICBzaG9ydFRpbWU6ICdISDptbScsXG4gICAgbWVkaXVtVGltZTogJ0hIOm1tOnNzJyxcbiAgICBsb25nVGltZTogJ0hIOm1tOnNzLlNTUydcbiAgfTtcblxuICAvKioqXG4gICAqIEZvcm1hdCBhIGRhdGVcbiAgICogQG1ldGhvZCBmb3JtYXRcbiAgICogQHBhcmFtIHtEYXRlfG51bWJlcn0gZGF0ZU9ialxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWFzayBGb3JtYXQgb2YgdGhlIGRhdGUsIGkuZS4gJ21tLWRkLXl5JyBvciAnc2hvcnREYXRlJ1xuICAgKi9cbiAgZmVjaGEuZm9ybWF0ID0gZnVuY3Rpb24gKGRhdGVPYmosIG1hc2ssIGkxOG5TZXR0aW5ncykge1xuICAgIHZhciBpMThuID0gaTE4blNldHRpbmdzIHx8IGZlY2hhLmkxOG47XG5cbiAgICBpZiAodHlwZW9mIGRhdGVPYmogPT09ICdudW1iZXInKSB7XG4gICAgICBkYXRlT2JqID0gbmV3IERhdGUoZGF0ZU9iaik7XG4gICAgfVxuXG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkYXRlT2JqKSAhPT0gJ1tvYmplY3QgRGF0ZV0nIHx8IGlzTmFOKGRhdGVPYmouZ2V0VGltZSgpKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIERhdGUgaW4gZmVjaGEuZm9ybWF0Jyk7XG4gICAgfVxuXG4gICAgbWFzayA9IGZlY2hhLm1hc2tzW21hc2tdIHx8IG1hc2sgfHwgZmVjaGEubWFza3NbJ2RlZmF1bHQnXTtcblxuICAgIHZhciBsaXRlcmFscyA9IFtdO1xuXG4gICAgLy8gTWFrZSBsaXRlcmFscyBpbmFjdGl2ZSBieSByZXBsYWNpbmcgdGhlbSB3aXRoID8/XG4gICAgbWFzayA9IG1hc2sucmVwbGFjZShsaXRlcmFsLCBmdW5jdGlvbigkMCwgJDEpIHtcbiAgICAgIGxpdGVyYWxzLnB1c2goJDEpO1xuICAgICAgcmV0dXJuICc/Pyc7XG4gICAgfSk7XG4gICAgLy8gQXBwbHkgZm9ybWF0dGluZyBydWxlc1xuICAgIG1hc2sgPSBtYXNrLnJlcGxhY2UodG9rZW4sIGZ1bmN0aW9uICgkMCkge1xuICAgICAgcmV0dXJuICQwIGluIGZvcm1hdEZsYWdzID8gZm9ybWF0RmxhZ3NbJDBdKGRhdGVPYmosIGkxOG4pIDogJDAuc2xpY2UoMSwgJDAubGVuZ3RoIC0gMSk7XG4gICAgfSk7XG4gICAgLy8gSW5saW5lIGxpdGVyYWwgdmFsdWVzIGJhY2sgaW50byB0aGUgZm9ybWF0dGVkIHZhbHVlXG4gICAgcmV0dXJuIG1hc2sucmVwbGFjZSgvXFw/XFw/L2csIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGxpdGVyYWxzLnNoaWZ0KCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlIGEgZGF0ZSBzdHJpbmcgaW50byBhbiBvYmplY3QsIGNoYW5nZXMgLSBpbnRvIC9cbiAgICogQG1ldGhvZCBwYXJzZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gZGF0ZVN0ciBEYXRlIHN0cmluZ1xuICAgKiBAcGFyYW0ge3N0cmluZ30gZm9ybWF0IERhdGUgcGFyc2UgZm9ybWF0XG4gICAqIEByZXR1cm5zIHtEYXRlfGJvb2xlYW59XG4gICAqL1xuICBmZWNoYS5wYXJzZSA9IGZ1bmN0aW9uIChkYXRlU3RyLCBmb3JtYXQsIGkxOG5TZXR0aW5ncykge1xuICAgIHZhciBpMThuID0gaTE4blNldHRpbmdzIHx8IGZlY2hhLmkxOG47XG5cbiAgICBpZiAodHlwZW9mIGZvcm1hdCAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBmb3JtYXQgaW4gZmVjaGEucGFyc2UnKTtcbiAgICB9XG5cbiAgICBmb3JtYXQgPSBmZWNoYS5tYXNrc1tmb3JtYXRdIHx8IGZvcm1hdDtcblxuICAgIC8vIEF2b2lkIHJlZ3VsYXIgZXhwcmVzc2lvbiBkZW5pYWwgb2Ygc2VydmljZSwgZmFpbCBlYXJseSBmb3IgcmVhbGx5IGxvbmcgc3RyaW5nc1xuICAgIC8vIGh0dHBzOi8vd3d3Lm93YXNwLm9yZy9pbmRleC5waHAvUmVndWxhcl9leHByZXNzaW9uX0RlbmlhbF9vZl9TZXJ2aWNlXy1fUmVEb1NcbiAgICBpZiAoZGF0ZVN0ci5sZW5ndGggPiAxMDAwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGlzVmFsaWQgPSB0cnVlO1xuICAgIHZhciBkYXRlSW5mbyA9IHt9O1xuICAgIGZvcm1hdC5yZXBsYWNlKHRva2VuLCBmdW5jdGlvbiAoJDApIHtcbiAgICAgIGlmIChwYXJzZUZsYWdzWyQwXSkge1xuICAgICAgICB2YXIgaW5mbyA9IHBhcnNlRmxhZ3NbJDBdO1xuICAgICAgICB2YXIgaW5kZXggPSBkYXRlU3RyLnNlYXJjaChpbmZvWzBdKTtcbiAgICAgICAgaWYgKCF+aW5kZXgpIHtcbiAgICAgICAgICBpc1ZhbGlkID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGF0ZVN0ci5yZXBsYWNlKGluZm9bMF0sIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGluZm9bMV0oZGF0ZUluZm8sIHJlc3VsdCwgaTE4bik7XG4gICAgICAgICAgICBkYXRlU3RyID0gZGF0ZVN0ci5zdWJzdHIoaW5kZXggKyByZXN1bHQubGVuZ3RoKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHBhcnNlRmxhZ3NbJDBdID8gJycgOiAkMC5zbGljZSgxLCAkMC5sZW5ndGggLSAxKTtcbiAgICB9KTtcblxuICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgaWYgKGRhdGVJbmZvLmlzUG0gPT09IHRydWUgJiYgZGF0ZUluZm8uaG91ciAhPSBudWxsICYmICtkYXRlSW5mby5ob3VyICE9PSAxMikge1xuICAgICAgZGF0ZUluZm8uaG91ciA9ICtkYXRlSW5mby5ob3VyICsgMTI7XG4gICAgfSBlbHNlIGlmIChkYXRlSW5mby5pc1BtID09PSBmYWxzZSAmJiArZGF0ZUluZm8uaG91ciA9PT0gMTIpIHtcbiAgICAgIGRhdGVJbmZvLmhvdXIgPSAwO1xuICAgIH1cblxuICAgIHZhciBkYXRlO1xuICAgIGlmIChkYXRlSW5mby50aW1lem9uZU9mZnNldCAhPSBudWxsKSB7XG4gICAgICBkYXRlSW5mby5taW51dGUgPSArKGRhdGVJbmZvLm1pbnV0ZSB8fCAwKSAtICtkYXRlSW5mby50aW1lem9uZU9mZnNldDtcbiAgICAgIGRhdGUgPSBuZXcgRGF0ZShEYXRlLlVUQyhkYXRlSW5mby55ZWFyIHx8IHRvZGF5LmdldEZ1bGxZZWFyKCksIGRhdGVJbmZvLm1vbnRoIHx8IDAsIGRhdGVJbmZvLmRheSB8fCAxLFxuICAgICAgICBkYXRlSW5mby5ob3VyIHx8IDAsIGRhdGVJbmZvLm1pbnV0ZSB8fCAwLCBkYXRlSW5mby5zZWNvbmQgfHwgMCwgZGF0ZUluZm8ubWlsbGlzZWNvbmQgfHwgMCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRlID0gbmV3IERhdGUoZGF0ZUluZm8ueWVhciB8fCB0b2RheS5nZXRGdWxsWWVhcigpLCBkYXRlSW5mby5tb250aCB8fCAwLCBkYXRlSW5mby5kYXkgfHwgMSxcbiAgICAgICAgZGF0ZUluZm8uaG91ciB8fCAwLCBkYXRlSW5mby5taW51dGUgfHwgMCwgZGF0ZUluZm8uc2Vjb25kIHx8IDAsIGRhdGVJbmZvLm1pbGxpc2Vjb25kIHx8IDApO1xuICAgIH1cbiAgICByZXR1cm4gZGF0ZTtcbiAgfTtcblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZlY2hhO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZmVjaGE7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgbWFpbi5mZWNoYSA9IGZlY2hhO1xuICB9XG59KSh0aGlzKTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIG1lc3NhZ2VOb2RlOmNjLk5vZGUsXG4gICAgICAgIHBsYXlOb2RlOmNjLk5vZGUsXG5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2hvd01lc3NhZ2VBbGVydDpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tZXNzYWdlTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubWVzc2FnZU5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIGNvbXAucGxheSgncG9wJyk7XG4gICAgfSxcblxuICAgIGRpc21pc3NNZXNzYWdlQWxlcnQ6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNlbGYubWVzc2FnZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH0sMC4zKTtcbiAgICB9LFxuXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xuXG5sZXQgaGFsbCA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG5cbiAgICAgICAgcHJvZHVjdE5vZGVzOltjYy5Ob2RlXSxcbiAgICAgICAgc2hvcEFsZXJ0Tm9kZTpjYy5Ob2RlLFxuICAgICAgICBjcmVhdGVOb2RlOmNjLk5vZGUsXG4gICAgICAgIGpvaW5Ob2RlOmNjLk5vZGUsXG4gICAgICAgIGludml0Tm9kZTpjYy5Ob2RlLFxuICAgICAgICBoYXNDb2RlOmNjLk5vZGUsXG4gICAgICAgIGdlbmd4aW46Y2MuTm9kZSxcbiAgICAgICAgYWxlcnRQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICB0c1NpbmdsZVNlbGVjdDpbY2MuTm9kZV0sLy/liJvlu7rmiL/pl7Tkv6Hmga/vvIzljZXpgIlcbiAgICAgICAgdHNDaGVja1NlY2xlY3Q6W2NjLk5vZGVdLC8v5Yib5bu65oi/6Ze05L+h5oGv77yM5aSN6YCJXG4gICAgICAgIHNlbGVjdE1vU2hpOmNjLk5vZGUsICAgICAvL+WIm+W7uuaIv+mXtOS/oeaBr++8jOaooeW8j++8iOW6hOWutuaooeW8j+WSjOaXoOeJueauiueJjO+8iVxuICAgICAgICBzZWxlY3RHdWlQYWk6Y2MuTm9kZSwgICAgIC8v5Yib5bu65oi/6Ze05L+h5oGv77yM5qih5byP77yI5bqE5a625qih5byP5ZKM5peg54m55q6K54mM77yJXG4gICAgICAgIGxhYmVsTm90aWNlOiBjYy5MYWJlbCwgLy/CoOWFrOWRilxuICAgICAgICBsYWJlbEJhbm5lcjogY2MuTGFiZWwsIC8vIGJhbm5lciBsYWJlbFxuICAgICAgICBzaGFyZUFsZXJ0Tm9kZTogY2MuTm9kZSxcbiAgICAgICAgc2hhcmVBbGVydE5vZGUxOiBjYy5Ob2RlLFxuICAgICAgICBzaGFyZUFsZXJ0Tm9kZUJnOiBjYy5Ob2RlLFxuICAgICAgICBzaGFyZUFsZXJ0QnV0dG9uOiBjYy5CdXR0b24sXG4gICAgICAgIHJlY29yZE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgd2FpdGluZ1ByZWZhYjpjYy5QcmVmYWIsXG4gICAgICAgIC8v55So5oi35L+h5oGvXG4gICAgICAgIGF2YXRhck5vZGU6Y2MuTm9kZSxcbiAgICAgICAgbmlja05hbWVMYWJlbDpjYy5MYWJlbCxcbiAgICAgICAgY2FyZE51bWJlckxhYmVsOmNjLkxhYmVsLFxuICAgICAgICB1c2VySWRMYWJlbDpjYy5MYWJlbCxcbiAgICAgICAgY29kZUxhYmVsOmNjLkxhYmVsLFxuICAgICAgICAvLyB1c2VySW5mb01zZ05vZGU6Y2MuTm9kZSxcbiAgICAgICAgLy/pgIDlh7pcbiAgICAgICAgZXhpdE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgbG9nb3V0Tm9kZTogY2MuTm9kZSxcbiAgICAgICAgLy/miJjnu6lcbiAgICAgICAgcmVjb3JkTXNnTm9kZTpjYy5Ob2RlLFxuICAgICAgICBmZWVkYmFja0VkaXRCb3g6Y2MuRWRpdEJveCwvL+WPjemmiFxuICAgICAgICBmZWVkYmFja05vZGU6Y2MuTm9kZSxcblxuICAgICAgICBfdXNlcklkOjAsXG4gICAgICAgIF9vcGVuSWQ6bnVsbCxcbiAgICAgICAgX2hlbHA6bnVsbCxcbiAgICAgICAgX2Nsb3NlOm51bGwsXG4gICAgICAgIGlvc1VybDpudWxsLFxuICAgICAgICBhVXJsOm51bGwsXG5cbiAgICB9LFxuXG4gICAgc3RhdGljczoge1xuICAgICAgICBsYXN0SGFsbEluZm86IG51bGwsICAgLy8g5LiK5LiA5qyh5pS25Yiw55qE5aSn5Y6F5L+h5oGvXG4gICAgICAgIGNhY2hlSW1hZ2VJbmZvOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2MuZnJvbSA9IHt9O1xuICAgICAgICBjYy5mcm9tLmlzVXNlTWEgPSB0cnVlO1xuICAgICAgICBjYy5mcm9tLm1hID0gMDtcbiAgICAgICAgY2MuaXNSb29tVmlld1Nob3cgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fYnRuID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiYnRuXCIpO1xuICAgICAgICB0aGlzLl9idXR0b25zID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiYnV0dG9uc1wiKTtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlNdXNpYygpO1xuICAgICAgICBQbGF5YmFjay5pbnN0YW5jZS5yZW1vdmVQbGF5YmFja0RhdGFzKCk7XG5cbiAgICAgICAgaGFsbC5jYWNoZUltYWdlSW5mbyA9IGhhbGwuY2FjaGVJbWFnZUluZm8gfHwge307XG5cbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xuICAgICAgICB0aGlzLl9zdGFydEJhbm5lckFuaW1hdGlvbigpO1xuICAgICAgICB0aGlzLl9pbml0Sm9pblJvb20oKTtcbiAgICAgICAgdGhpcy5faW5pdEludml0KCk7XG5cbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgICB0aGlzLl9vcGVuSWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8ub3BlbklkO1xuICAgICAgICB0aGlzLl9pbnZpdGVDb2RlID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmludml0ZUNvZGU7ICAvL+mCgOivt+eggVxuICAgICAgICAvL2NjLmxvZyh0aGlzLl9pbnZpdGVDb2RlLFwi6YKA6K+356CBLS0tLS0tLS0tLS0tLS0tLS0tLS0tXCIpO1xuICAgICAgICBpZih0aGlzLl9pbnZpdGVDb2RlKXsgIC8v6YKA6K+356CB5aSE55CGXG4gICAgICAgICAgICB0aGlzLmNvZGVMYWJlbC5zdHJpbmcgPSBcIkNPREXvvJpcIisgdGhpcy5faW52aXRlQ29kZTtcbiAgICAgICAgICAgIHRoaXMuaGFzQ29kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5pbnZpdE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgdGhpcy5oYXNDb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5pbnZpdE5vZGUuYWN0aXZlID0gdHJ1ZTsgICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuY29kZUxhYmVsLnN0cmluZyA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wcm9kdWN0Tm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjb21wID0gdGhpcy5wcm9kdWN0Tm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdwcm9kdWN0Jyk7XG4gICAgICAgICAgICBjb21wLm9uQ2xpY2tBY3Rpb24gPSBmdW5jdGlvbihwcm9kdWN0SWQpIHtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zb2NrZXQgPSBjYy5maW5kKCdHYW1lU29ja2V0JykuZ2V0Q29tcG9uZW50KCdzb2NrZXQnKTtcbiAgICAgICAgdGhpcy5zb2NrZXQucmVjZXZpY2VNZXNzYWdlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5zb2NrZXQuY29ubmVjdGlvblN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuQ2hlY2tNZXNzYWdlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25EaXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLnNob3dOZXR3b3JrTWVzc2FnZSgn572R57uc6ZO+5o6l5pat5byA77yM6YeN5paw6L+e5o6l5LitLi4uJyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc29ja2V0LmNoZWNrTmV0d29ya05vdyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5zaG93Q2hlY2tNZXNzYWdlKCfmo4Dmn6XnvZHnu5zkuK0uLi4nKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrRW5kID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGRlbkNoZWNrTWVzc2FnZSgpO1xuICAgICAgICAgICAgc2VsZi5oaWRkZW5OZXR3b3JrTWVzc2FnZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vICAvKuiuvue9rueUqOaIt+S/oeaBryovXG4gICAgICAgIHRoaXMudXBkYXRlVXNlckluZm8oKTtcbiAgICAgICAgLyrliLfmlrDnlKjmiLfkv6Hmga8qL1xuICAgICAgICBTb2NrZXQuc2VuZEdldFVzZXJJbmZvKHRoaXMuX3VzZXJJZCx0aGlzLl9vcGVuSWQpO1xuICAgICAgICAvKuWumuaXtuWIt+aWsOeUqOaIt+S/oeaBryovXG4gICAgICAgIHRoaXMuc2NoZWR1bGUoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIFNvY2tldC5zZW5kR2V0VXNlckluZm8odGhpcy5fdXNlcklkLHRoaXMuX29wZW5JZCk7XG4gICAgICAgIH0uYmluZCh0aGlzKSwxMCk7Ly8xMHPkuIDmrKFcblxuICAgICAgICBTb2NrZXQuc2VuZEdldEhhbGxJbmZvKHRoaXMuc29ja2V0LnVzZXJJbmZvLmlkKTtcbiAgICAgICAgLy9oYWxsLmxhc3RIYWxsSW5mbyA9IGNjLl9sb2dpbkluZm87XG4gICAgICAgIGlmIChoYWxsLmxhc3RIYWxsSW5mbykge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVCYW5uZXIoaGFsbC5sYXN0SGFsbEluZm8uaW5mbyk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU5vdGljZShoYWxsLmxhc3RIYWxsSW5mby5icm9hZGNhc3QpO1xuICAgICAgICAgICAgLy90aGlzLmxhYmVsQmFubmVyLnN0cmluZyA9IGhhbGwubGFzdEhhbGxJbmZvLmluZm87XG4gICAgICAgICAgICAvL3RoaXMubGFiZWxOb3RpY2Uuc3RyaW5nID0gaGFsbC5sYXN0SGFsbEluZm8uYnJvYWRjYXN0O1xuICAgICAgICB9XG4gICAgICAgIGNjLm9uU2hhcmVXWFJlc3AgPSB0aGlzLl9zaGFyZVJlc3VsdC5iaW5kKHRoaXMpO1xuXG4gICAgfSxcblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbigpIHt9O1xuICAgICAgICB0aGlzLnNvY2tldC5jb25uZWN0aW9uU3VjY2VzcyA9IGZ1bmN0aW9uKCkge307XG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25EaXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrTm93ID0gZnVuY3Rpb24oKXt9O1xuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtFbmQgPSBmdW5jdGlvbigpIHt9O1xuICAgICAgICBcbiAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xuICAgIH0sXG5cbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDogZnVuY3Rpb24gKCkge1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Kb2luRGVzaywgdGhpcy5famlpblJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5famlpblJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVDcmVhdGVEZXNrLCB0aGlzLl9jcmVhdGVSb29tU29ja2V0Q2FsbGJhY2ssIHRoaXMpO1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlSGFsbEluZm8sIHRoaXMuX3NvY2tldFJlY2VpdmVIYWxsSW5mbywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVHZXRVc2VySW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZVVzZXJJbmZvLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgdGhpcy5fc29ja2V0RGlzY29ubmVjdCwgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVJbnZpdGVDb2RlLCB0aGlzLl9zb2NrZXRSZWNlaXZlSW52aXRlQ29kZSwgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RTdWNjZXNzZWQsIHRoaXMuX3NvY2tldENvbm5lY3RlZCwgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVTaGFyZVBuZywgdGhpcy5fc29ja2V0U2hhcmVQbmcsIHRoaXMpO1xuICAgIH0sXG4gICAgICAgLy/mjqXlj5fpgoDor7fnoIHmlbDmja5cbiAgICBfc29ja2V0UmVjZWl2ZUludml0ZUNvZGU6ZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICBsZXQgaW52aXRlQ29kZSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIC8vY2MubG9nKGludml0ZUNvZGUsXCItLS0tLS0tLS0tLS0g6YKA6K+356CBIC0tLS0tLS0tLS0tLVwiKTtcbiAgICAgICAgaWYoaW52aXRlQ29kZSl7ICAvL+mCgOivt+eggeWkhOeQhlxuICAgICAgICAgICAgdGhpcy5faW52aXRlQ29kZSA9IGludml0ZUNvZGU7XG4gICAgICAgICAgICB0aGlzLmNvZGVMYWJlbC5zdHJpbmcgPSBcIkNPREXvvJpcIisgaW52aXRlQ29kZTtcbiAgICAgICAgICAgIHRoaXMuaGFzQ29kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5pbnZpdE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UoXCLovpPlhaXnmoTpgoDor7fnoIHkuI3lrZjlnKhcIik7XG4gICAgICAgICAgICB0aGlzLmhhc0NvZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmludml0Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5jb2RlTGFiZWwuc3RyaW5nID0gJyc7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX3N0YXJ0QmFubmVyQW5pbWF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhbmltID0gdGhpcy5sYWJlbEJhbm5lci5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgYW5pbS5wbGF5KCdiYW5uZXInKTtcbiAgICB9LFxuXG5cbiAgICBfaW5pdEpvaW5Sb29tOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgbGV0IGpvaW5Sb29tID0gdGhpcy5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2pvaW5Sb29tJyk7XG5cbiAgICAgICAgam9pblJvb20uY2FsbGJhY2tKb2luUm9vbSA9IGZ1bmN0aW9uIChudW1iZXIpIHtcbiAgICAgICAgICAgIHNlbGYuam9pbk5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgICAgIHNlbGYuc2hvd1dhaXRpbmdNZXNzYWdlKCfliqDlhaXkuK0uLi4nKTtcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcbiAgICAgICAgICAgIH0sIDIuMCk7XG5cbiAgICAgICAgICAgIC8q5Yqg5YWl5oi/6Ze06K+35rGCKi9cbiAgICAgICAgICAgIGxldCB1c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XG4gICAgICAgICAgICBTb2NrZXQuc2VuZEpvaW5EZXNrKG51bWJlciwgdXNlcklkKTtcbiAgICAgICAgfTtcbiAgICB9LFxuXG5cbiAgICBfaW5pdEludml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAvL2xldCBJbnZpdCA9IHRoaXMuaW52aXROb2RlLmdldENvbXBvbmVudCgnSW52aXQnKTtcblxuICAgICAgICAvLyBJbnZpdC5jYWxsYmFja0pvaW5Sb29tID0gZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICAvLyAgICAgc2VsZi5pbnZpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgLy8gICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyAgICAgICAgIHNlbGYuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcbiAgICAgICAgLy8gICAgIH0sIDIuMCk7XG4gICAgICAgIC8vICAgICBjYy5sb2cobnVtYmVyKVxuICAgICAgICAvLyAgICAgY2MubG9nKCctLS0tLS0xOTEnKVxuICAgICAgICAvLyAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgICAgLy8gfTtcbiAgICB9LFxuXG4gICAgX2ppaW5Sb29tU29ja2V0Q2FsbGJhY2s6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZihjYy5pc1Jvb21WaWV3U2hvdyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuXG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGlmKGNjLmZyb20gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNjLmZyb20gPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBqb2luUm9vbSA9IHRoaXMuam9pbk5vZGUuZ2V0Q29tcG9uZW50KCdqb2luUm9vbScpO1xuXG4gICAgICAgICAgICB0aGlzLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5zZXRBbGVydENhbGxiY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGpvaW5Sb29tLmNsaWNrQ2xlYXIoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2MuZnJvbS5tYSA9IHJlc3BvbnNlLmRhdGEubWFQYWk7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3BsYXknKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCByZWFzb25JbmZvID0gdGhpcy5fam9pblJlYXNvbk1hcChyZXNwb25zZS5kYXRhLnJlYXNvbik7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShyZWFzb25JbmZvKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfc29ja2V0UmVjZWl2ZUhhbGxJbmZvOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYoY2MuaXNSb29tVmlld1Nob3cpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICBoYWxsLmxhc3RIYWxsSW5mbyA9IGRhdGE7XG5cbiAgICAgICAgbGV0IGlzSU9TID0gZGF0YS5pc0lPUztcbiAgICAgICAgbGV0IGlzQW5kcm9pZCA9IGRhdGEuaXNBO1xuICAgICAgICBsZXQgdklPUyA9IGRhdGEudklPUztcbiAgICAgICAgbGV0IHZBID0gZGF0YS52QTtcbiAgICAgICAgdGhpcy5pb3NVcmwgPSBkYXRhLmlvc1VybDtcbiAgICAgICAgdGhpcy5hVXJsID0gZGF0YS5hVXJsO1xuXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBpZihpc0lPUz09MSl7XG4gICAgICAgICAgICAgICAgaWYodklPUyAhPSAnMS4wLjEnICl7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZ3hpbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsvL0FuZHJvaWRcbiAgICAgICAgICAgIGlmKGlzQW5kcm9pZD09MSl7XG4gICAgICAgICAgICAgICAgaWYodkEgIT0gJzEuMC4xJyApe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdlbmd4aW4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBub3RpY2UgPSBkYXRhLmJyb2FkY2FzdDtcbiAgICAgICAgbGV0IGJhbm5lciA9IGRhdGEuaW5mbztcbiAgICAgICAgdGhpcy51cGRhdGVOb3RpY2Uobm90aWNlKTtcbiAgICAgICAgdGhpcy51cGRhdGVCYW5uZXIoYmFubmVyKTtcbiAgICB9LFxuICAgIGRvd25sb2FkTmV3VmVyc2lvbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBjYy5zeXMub3BlblVSTCh0aGlzLmlvc1VybCk7XG4gICAgICAgICAgICAvLyBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJkb3dubG9hZE5ld1ZlcnNpb246XCIsIHRoaXMuaW9zVXJsKTtcbiAgICAgICAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAgICAgICAgICBjYy5zeXMub3BlblVSTCh0aGlzLmFVcmwpO1xuICAgICAgICAgICAgLy8ganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvblwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCB0aGlzLmFVcmwpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBfY3JlYXRlUm9vbVNvY2tldENhbGxiYWNrOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgaWYoY2MuaXNSb29tVmlld1Nob3cpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcblxuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3BsYXknKTtcbiAgICAgICAgfVxuICAgICAgICAvKuWmguaenOmSu+efs+S4jei2s++8jOWImeaPkOekuiovXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UoXCLmgqjnmoTpkrvnn7PkuI3otrNcIik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX2pvaW5SZWFzb25NYXA6IGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGxldCByZWFzb25JbmZvID0ge1xuICAgICAgICBub3RFeGlzdDogXCLmiL/pl7TkuI3lrZjlnKghXCIsXG4gICAgICAgIGNhcmROdW1iZXI6IFwi5oKo5oi/5Y2h5LiN6LazIVwiLFxuICAgICAgfTtcblxuICAgICAgbGV0IGluZm8gPSByZWFzb25JbmZvW3JlYXNvbl0gfHwgXCLmiL/pl7Tlt7Lmu6EhXCI7XG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9LFxuXG4gICAgLypzaG9wKi9cbiAgICBzaG9wQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMuc2hvcEFsZXJ0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuICAgIC8q5o+Q56S6Ki9cbiAgICBhbGVydE1lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIHZhciBub2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy5hbGVydFByZWZhYik7XG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZChub2RlKTtcbiAgICAgICAgdmFyIGNvbXAgPSBub2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlTm90aWNlOiBmdW5jdGlvbiAobm90aWNlKSB7XG4gICAgICAgIGlmKHRoaXMubGFiZWxOb3RpY2UgPT0gbnVsbCl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIHRoaXMubGFiZWxOb3RpY2Uuc3RyaW5nID0gbm90aWNlIHx8IFwiXCI7XG4gICAgfSxcblxuICAgIHVwZGF0ZUJhbm5lcjogZnVuY3Rpb24gKGJhbm5lciA9IFwiXCIpIHtcbiAgICAgICAgaWYodGhpcy5sYWJlbEJhbm5lciA9PSBudWxsKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgdGhpcy5sYWJlbEJhbm5lci5zdHJpbmcgPSBiYW5uZXI7XG4gICAgfSxcblxuICAgIC8qXG4gICAgY3JlYXRlRG9uZUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGluZm8gPSB7fTtcbiAgICAgICAgdmFyIGtleSA9IFsnc2V0dGluZzEnLCdzZXR0aW5nMicsJ3NldHRpbmczJywnc2V0dGluZzQnXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRzU2luZ2xlU2VsZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdHNJbmRleCA9ICB0aGlzLnRzU2luZ2xlU2VsZWN0W2ldLmdldENvbXBvbmVudCgnc2luZ2xlU2VsZWN0Jykuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgICAgIGluZm9ba2V5W2ldXSA9IHRzSW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgaW5mb1sndXNlcklkJ10gPSB0aGlzLnNvY2tldC51c2VySW5mby5pZDtcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2NyZWF0ZURlc2snLGluZm8pO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+WIm+W7uuS4rS4uLicpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcbiAgICAgICAgfSwgMi4wKTtcbiAgICB9LFxuICAgICovXG4gICAgLyojIyMjI1xuICAgICogc2V0dGluZzEg5bGA5pWwICAoMCB8IDEgfCAyKVxuICAgICogc2V0dGluZzIg5Lq65pWwICAoMCB8IDEgfCAyIHwzKVxuICAgICogc2V0dGluZzMg546p5rOVICAoMCB8IDEpXG4gICAgKiBzZXR0aW5nNCBBQeWItuaUtuWPluaIv+i0uSAgKG51bGwgfCAwKVxuICAgICogc2V0dGluZzUg6ams54mMICAg77yIbnVsbCB8IDAgfCAxIHwgMu+8iVxuICAgICogc2V0dGluZzYg5omT5p6q6K6h5YiGICgwIHwgMSlcbiAgICAqIHNldHRpbmc3IOWkmuS4gOiJsiAgKG51bGwgfCAwKVxuICAgICogKi9cbiAgICBjcmVhdGVEb25lQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaW5mbyA9IHt9O1xuICAgICAgICAvL+WNlemAiVxuICAgICAgICB2YXIga2V5ID0gWydzZXR0aW5nMScsJ3NldHRpbmcyJywnc2V0dGluZzYnXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRzU2luZ2xlU2VsZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdHNJbmRleCA9ICB0aGlzLnRzU2luZ2xlU2VsZWN0W2ldLmdldENvbXBvbmVudCgnc2luZ2xlU2VsZWN0Jykuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgICAgIGluZm9ba2V5W2ldXSA9IHRzSW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgLy/lj6/pgInlj6/kuI3pgIlcbiAgICAgICAgdmFyIGtleTEgPSBbJ3NldHRpbmc0Jywnc2V0dGluZzcnXTtcbiAgICAgICAgZm9yKHZhciBpID0gMDtpIDwgdGhpcy50c0NoZWNrU2VjbGVjdC5sZW5ndGgtMTsgaSsrKXtcbiAgICAgICAgICAgIHZhciB0c0NoZWNrSW5kZXggPSB0aGlzLnRzQ2hlY2tTZWNsZWN0W2ldLmdldENvbXBvbmVudCgnY2hlY2tTZWxlY3QnKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgaW5mb1trZXkxW2ldXSA9IHRzQ2hlY2tJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBpZihjYy5mcm9tLmlzVXNlTWEgJiYgY2MuZnJvbS5tYSA9PSBudWxsKXtcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmKGNjLmZyb20uaXNVc2VNYSkge1xuICAgICAgICAgICAgaW5mb1snc2V0dGluZzUnXSA9IGNjLmZyb20ubWE7XG4gICAgICAgIH1cbiAgICAgICAgLy9zZXR0aW5nMyBzZWxlY3RNb1NoaUluZGV45Li6IO+8mm51bGwgfHwgMCB8fCAxXG4gICAgICAgIHZhciBzZWxlY3RNb1NoaUluZGV4ID0gdGhpcy5zZWxlY3RNb1NoaS5nZXRDb21wb25lbnQoJ3NlbGVjdE1vU2hpJykuc2VsZWN0SW5kZXg7XG4gICAgICAgIGluZm9bJ3NldHRpbmczJ10gPSBzZWxlY3RNb1NoaUluZGV4O1xuXG4gICAgICAgIHZhciBzZWxlY3RNb1NoaUluZGV4ID0gdGhpcy5zZWxlY3RHdWlQYWkuZ2V0Q29tcG9uZW50KCdzZWxlY3RNb1NoaScpLnNlbGVjdEluZGV4O1xuICAgICAgICAvL2luZm9bJ3NldHRpbmc4J10gPSBzZWxlY3RNb1NoaUluZGV4O1xuICAgICAgICBpbmZvWydzZXR0aW5nOCddID0gbnVsbDtcbiAgICAgICAgLy/nlKjmiLdJZFxuICAgICAgICBpbmZvWyd1c2VySWQnXSA9IHRoaXMuc29ja2V0LnVzZXJJbmZvLmlkO1xuXG4gICAgICAgIGlmKGluZm9bJ3NldHRpbmc2J10gPT0gMCl7XG4gICAgICAgICAgICBpbmZvWydzZXR0aW5nNiddID0gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgaW5mb1snc2V0dGluZzYnXSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYoaW5mb1snc2V0dGluZzInXSA9PSAzKXsvL+S6lOS6uuWcuuW/hemhu+WkmuS4gOiJslxuICAgICAgICAgICAgaW5mb1snc2V0dGluZzcnXSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaW5mb1snc2V0dGluZzcnXSA9IG51bGw7XG4gICAgICAgIGNvbnNvbGUubG9nKFwi5omT5Y2w5Ye65Yib5bu65oi/6Ze05L+h5oGvXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhpbmZvKTtcbiAgICAgICAgLy9yZXR1cm47XG4gICAgICAgIHRoaXMuc29ja2V0LnNlbmRNZXNzYWdlKCdjcmVhdGVEZXNrJyxpbmZvKTtcblxuICAgICAgICB0aGlzLmNyZWF0ZU5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcblxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2hvd1dhaXRpbmdNZXNzYWdlKCfliJvlu7rkuK0uLi4nKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLmhpZGRlbldhaXRpbmdNZXNzYWdlKCk7XG4gICAgICAgIH0sIDIuMCk7XG4gICAgfSxcblxuICAgIC8vIOmaj+acuuWculxuICAgIC8qY2xpY2tSYW5kUm9vbTogZnVuY3Rpb24gKCkge1xuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdyYW5kUm9vbScpO1xuICAgIH0sKi9cblxuICAgIGNsaWNrU2hhcmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuc2hhcmVBbGVydE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGNsaWNrU2hhcmUxOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2hhcmVBbGVydE5vZGUxLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBjbGlja1JlY29yZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMucmVjb3JkTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICAgICAgU29ja2V0LnNlbmRHZXRSZWNyb2QoU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkKTtcblxuICAgIH0sXG5cbiAgICBjbGlja1BsYXlSdWxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdydWxlJyk7XG4gICAgICAgIHRoaXMuaGVscCA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImhlbHBcIik7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5oZWxwLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICAvKnNoYXJlKi9cbiAgICBzaGFyZVRvRnJpZW5kOmZ1bmN0aW9uKCkge1xuICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVIYWxsRnJpZW5kXCIsKTtcbiAgICAgIH1cbiAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbEZyaWVuZFwiLCBcIigpVlwiKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hhcmVUb1RpbWVsaW5lOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNoYXJlQWxlcnROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVIYWxsVGltZWxpbmVcIiwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsVGltZWxpbmVcIiwgXCIoKVZcIik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8v54K55Ye75YiG5LqrXG4gICAgc2hhcmVUb1RpbWVsaW5lUG5nOmZ1bmN0aW9uKCkge1xuXG4gICAgICAgIHRoaXMuc2hhcmVBbGVydE5vZGVCZy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eFNjcmVlblNoYXJlXCIsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsvL0FuZHJvaWRcbiAgICAgICAgICAgIEtRTmF0aXZlSW52b2tlLnNjcmVlbnNob3RTaGFyZShcInNoYXJlSU1HVGltZWxpbmVcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHRoaXMuc2hhcmVBbGVydE5vZGVCZy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLDAuMDEpOy8vMTBz5LiA5qyhXG5cbiAgICB9LFxuICAgIC8v54K55Ye75YiG5Lqr6L+U5Zue5YC8IDHvvJrmiJDlip8gIDDvvJrlt7Lnu4/pooblj5ZcbiAgICBfc29ja2V0U2hhcmVQbmc6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuc2hhcmVBbGVydE5vZGVCZy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgc3Rpbmc7XG4gICAgICAgIGlmKGRhdGEuZGF0YSA9PSAxKXtcbiAgICAgICAgICAgIFNvY2tldC5zZW5kR2V0VXNlckluZm8odGhpcy5fdXNlcklkLHRoaXMuX29wZW5JZCk7XG4gICAgICAgICAgICBzdGluZyA9ICfliIbkuqvmiJDlip/vvIEnO1xuICAgICAgICAgICAgLy90aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuc2hvd0NoZWNrTWVzc2FnZShzdGluZyk7XG4gICAgICAgICAgICAvL30uYmluZCh0aGlzKSwwLjUpOy8vMTBz5LiA5qyhXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHNlbGYuaGlkZGVuQ2hlY2tNZXNzYWdlKCk7XG4gICAgICAgICAgICB9LmJpbmQodGhpcyksMik7Ly8xMHPkuIDmrKFcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBzdGluZyA9ICfku4rlpKnlt7Lnu4/liIbkuqvkuobvvIEnO1xuICAgICAgICAgICAgc2VsZi5zaG93Q2hlY2tNZXNzYWdlKHN0aW5nKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi5oaWRkZW5DaGVja01lc3NhZ2UoKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwxLjUpOy8vMTBz5LiA5qyhXG4gICAgICAgIH1cblxuICAgIH0sXG5cbiAgICBfc2hhcmVSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy5zaGFyZUFsZXJ0Tm9kZTEuYWN0aXZlID09IGZhbHNlKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBTb2NrZXQuc2VuZFNoYXJlUG5nKHRoaXMuX3VzZXJJZCk7XG4gICAgfSxcblxuICAgIGNsaWNrRXhpdDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMuZXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcbiAgICAvKuWIh+aNoui0puWPtyovXG4gICAgY2xpY2tDYW5jZWxMYXRpb246ZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxvZ291dE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGxvZ291dEFjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oJycpO1xuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2xvZ2luJyk7XG5cbiAgICAgICAgaGFsbC5jYWNoZUltYWdlSW5mbyA9IG51bGw7XG4gICAgfSxcblxuICAgIGV4aXRBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKCcnKTtcbiAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKSB7XG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbG9naW4nKTtcbiAgICAgICAgaGFsbC5jYWNoZUltYWdlSW5mbyA9IG51bGw7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJleGl0QXBwXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkIGNvbS5sbGluZy5xaWFuamlhbmdsemdcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJleGl0QXBwXCIsIFwiKClWXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNjLmRpcmVjdG9yLmVuZCgpO1xuXG4gICAgfSxcblxuICAgIC8v5o6l5pS25aSE55CG55So5oi35pWw5o2uXG4gICAgX3NvY2tldFJlY2VpdmVVc2VySW5mbzpmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBpZihjYy5pc1Jvb21WaWV3U2hvdyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIGlmICghdGhpcy5zb2NrZXQudXNlckluZm8pIHtcbiAgICAgICAgY2MuZXJyb3IoXCJ0aGlzLnNvY2tldC51c2VySW5mbyDkuLrnqbohISFcIik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMubmlja05hbWVMYWJlbC5zdHJpbmcgPSByZXNwb25zZS5kYXRhLm5pY2tuYW1lO1xuICAgICAgdGhpcy51c2VySWRMYWJlbC5zdHJpbmcgPSAnSUQ6ICcgKyByZXNwb25zZS5kYXRhLmlkO1xuICAgICAgdGhpcy5jYXJkTnVtYmVyTGFiZWwuc3RyaW5nID0gcmVzcG9uc2UuZGF0YS5jYXJkTnVtYmVyO1xuICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuYXZhdGFyTm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgIGNjLmxvYWRlci5sb2FkKHJlc3BvbnNlLmRhdGEuYXZhdGFyVXJsK1wiLmpwZ1wiLCBmdW5jdGlvbiAoZXJyLCB0ZXgpIHtcbiAgICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4KTtcbiAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lPWZyYW1lO1xuICAgICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfc29ja2V0RGlzY29ubmVjdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2hvd05ldHdvcmtNZXNzYWdlKFwi572R57uc6ZO+5o6l5pat5byA77yM6YeN5paw6L+e5o6l5LitLi4uXCIpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0Q29ubmVjdGVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5oaWRkZW5OZXR3b3JrTWVzc2FnZSgpO1xuICAgIH0sXG5cbiAgICAvL+abtOaWsOeUqOaIt+S/oeaBr1xuICAgIHVwZGF0ZVVzZXJJbmZvOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaW5mbyA9IHRoaXMuc29ja2V0LnVzZXJJbmZvO1xuICAgICAgICBpZiAoIWluZm8pIHtcbiAgICAgICAgICBjYy5lcnJvcihcInRoaXMuc29ja2V0LnVzZXJJbmZvIOS4uuepuiEhIVwiKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm5pY2tOYW1lTGFiZWwuc3RyaW5nID0gaW5mby5uaWNrbmFtZTtcbiAgICAgICAgdGhpcy51c2VySWRMYWJlbC5zdHJpbmcgPSAnSUQ6ICcgKyBpbmZvLmlkO1xuICAgICAgICB0aGlzLmNhcmROdW1iZXJMYWJlbC5zdHJpbmcgPSBpbmZvLmNhcmROdW1iZXI7XG5cbiAgICAgICAgbGV0IGF2YXRhclVybCA9IGluZm8uYXZhdGFyVXJsICsgXCIuanBnXCI7XG4gICAgICAgIHZhciBzcHJpdGUgPSB0aGlzLmF2YXRhck5vZGUuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XG4gICAgICAgIHZhciB0ZXh0dXJlID0gaGFsbC5jYWNoZUltYWdlSW5mb1thdmF0YXJVcmxdO1xuICAgICAgICBpZiAodGV4dHVyZSkge1xuICAgICAgICAgICAgbGV0IGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleHR1cmUpO1xuICAgICAgICAgICAgaWYgKGZyYW1lKSB7XG4gICAgICAgICAgICAgICAgY2MubG9nKFwi5LuO57yT5a2Y5Lit5Yqg6L295aS05YOPXCIpO1xuICAgICAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IGZyYW1lO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNjLmxvYWRlci5sb2FkKGluZm8uYXZhdGFyVXJsK1wiLmpwZ1wiLCBmdW5jdGlvbiAoZXJyLCB0ZXgpIHtcbiAgICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleCk7XG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lPWZyYW1lO1xuXG4gICAgICAgICAgICAgICAgaGFsbC5jYWNoZUltYWdlSW5mb1thdmF0YXJVcmxdID0gdGV4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyrmj5DkuqTmhI/op4EqL1xuICAgIGZlZWRiYWNrQWNpb246ZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHVzZXJJZCA9IHRoaXMuc29ja2V0LnVzZXJJbmZvLmlkO1xuICAgICAgdmFyIHRleHQgPSB0aGlzLmZlZWRiYWNrRWRpdEJveC5zdHJpbmc7XG4gICAgICBpZiAodGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMuZmVlZGJhY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIFNvY2tldC5zZW5kRmVlZGJhY2sodXNlcklkLHRleHQpO1xuICAgICAgICB0aGlzLmZlZWRiYWNrRWRpdEJveC5zdHJpbmcgPSAnJztcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hvd1dhaXRpbmdNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCAmJiBjYy5zeXMuaXNOYXRpdmUgJiYgY2Muc3lzLmlzT2JqZWN0VmFsaWQodGhpcy53YWl0aW5nTm9kZSkpIHtcbiAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlLmRlc3RvcnkoKTtcbiAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIHRoaXMud2FpdGluZ05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xuICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMud2FpdGluZ05vZGUpO1xuICAgICAgdmFyIGNvbXAgPSB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xuICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBoaWRkZW5XYWl0aW5nTWVzc2FnZTpmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLndhaXRpbmdOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vbmV0d29ya1xuICAgIHNob3dOZXR3b3JrTWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgJiYgdGhpcy5uZXR3b3JrTm9kZS5hY3RpdmUpIHtcbiAgICAgICAgICAgIGxldCBhbGVydCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICAgICAgaWYgKGFsZXJ0LmdldE1lc3NhZ2UoKSA9PSBtc2cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLm5ldHdvcmtOb2RlKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLm5ldHdvcmtOb2RlID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgaGlkZGVuTmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvL2NoZWNrTm9kZVxuICAgIHNob3dDaGVja01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIGlmICghKHRoaXMuY2hlY2tOb2RlICYmIHRoaXMuY2hlY2tOb2RlLmFjdGl2ZSkpIHtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBhbGVydCA9IHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgICAgIGlmIChhbGVydC5nZXRNZXNzYWdlKCkgPT0gbXNnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZS5ydW5BY3Rpb24ocmVtb3ZlU2VsZkFjdGlvbik7XG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jaGVja05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5jaGVja05vZGUpO1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLmNoZWNrTm9kZSA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGhpZGRlbkNoZWNrTWVzc2FnZTpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uQnRuQ2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZih0aGlzLl9idXR0b25zLmFjdGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9ucy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICB0aGlzLl9idXR0b25zLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGhhbGw7XG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLypzcHJpdGVzOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLlNwcml0ZUF0bGFzXHJcbiAgICAgICAgfSwqL1xyXG4gICAgICAgIHBsYXlfbWV0aG9kX2JlZm9yZTpjYy5Ob2RlLCAgLy/njqnms5Xku4vnu41cclxuICAgICAgICBwbGF5X21ldGhvZF9jb250ZW50X2xhYmVsOmNjLk5vZGUsICAvL+eOqeazleS7i+e7jeWGheWuuVxyXG4gICAgICAgIGludHJvZHVjZV9wYWlfYmVmb3JlOmNjLk5vZGUsLy/niYzlnovku4vnu41cclxuICAgICAgICBkZXRhaWxzOmNjLk5vZGUsICAgLy/niYzlnovku4vnu43lhoXlrrlcclxuICAgICAgICBjYW96dW9fYmVmb3JlOmNjLk5vZGUsICAgICAvL+aTjeS9nOS7i+e7jVxyXG4gICAgICAgIGNhb3p1b19jb250ZW50OmNjLk5vZGUsICAvL+aTjeS9nOS7i+e7jeWGheWuuVxyXG4gICAgICAgIF9idG46bnVsbCxcclxuICAgICAgICBfY29udGVudDpudWxsLFxyXG4gICAgICAgIF9idXR0b25Db206bnVsbCxcclxuICAgICAgICBfcGxheV9tZXRob2RfYnV0dG9uOm51bGwsXHJcbiAgICAgICAgX2ludHJvZHVjZV9wYWlfYnV0dG9uOm51bGwsXHJcbiAgICAgICAgX2Nhb3p1b19idXR0b246bnVsbFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXlfbWV0aG9kX2J1dHRvbiA9IHRoaXMucGxheV9tZXRob2RfYmVmb3JlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xyXG4gICAgICAgIHRoaXMuX2ludHJvZHVjZV9wYWlfYnV0dG9uID0gdGhpcy5pbnRyb2R1Y2VfcGFpX2JlZm9yZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICB0aGlzLl9jYW96dW9fYnV0dG9uID0gdGhpcy5jYW96dW9fYmVmb3JlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xyXG4gICAgICAgIHRoaXMuX2J0biA9IFt0aGlzLnBsYXlfbWV0aG9kX2JlZm9yZSx0aGlzLmludHJvZHVjZV9wYWlfYmVmb3JlLHRoaXMuY2FvenVvX2JlZm9yZV07XHJcbiAgICAgICAgdGhpcy5fY29udGVudCA9IFt0aGlzLnBsYXlfbWV0aG9kX2NvbnRlbnRfbGFiZWwsdGhpcy5kZXRhaWxzLHRoaXMuY2FvenVvX2NvbnRlbnRdO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkNvbSA9IFt0aGlzLl9wbGF5X21ldGhvZF9idXR0b24sdGhpcy5faW50cm9kdWNlX3BhaV9idXR0b24sdGhpcy5fY2FvenVvX2J1dHRvbl07XHJcbiAgICAgICAgLy/liJrlvIDlp4vniYzlnovku4vnu43nmoTmjInpkq7kuI3lj6/nlKhcclxuICAgICAgICB0aGlzLl9idXR0b25Db21bMV0uaW50ZXJhY3RhYmxlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgLy8g54K55Ye7546p5rOV5LuL57uNXHJcbiAgICBvbkJ0blBsYXlNZXRob2RDbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTwzO2krKyl7XHJcbiAgICAgICAgICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkNvbVtpXS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL+aJgOacieeahOWGheWuuemDvemakOiXj+aOiVxyXG4gICAgICAgICAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+W9k+WJjeeCueWHu+eahOiuvue9ruS4uuS4jeWPr+eUqFxyXG4gICAgICAgIHRoaXMuX2J1dHRvbkNvbVswXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvL+W9k+WJjeeCueWHu+eahOWvueW6lOeahOWGheWuueWPr+ingVxyXG4gICAgICAgIHRoaXMuX2NvbnRlbnRbMF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICAvL+eCueWHu+eJjOWei+S7i+e7jVxyXG4gICAgb25CdG5JbnRyb2R1Y2VQYWlDbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTwzO2krKyl7XHJcbiAgICAgICAgICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkNvbVtpXS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL+aJgOacieeahOWGheWuuemDvemakOiXj+aOiVxyXG4gICAgICAgICAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+W9k+WJjeeCueWHu+eahOiuvue9ruS4uuS4jeWPr+eUqFxyXG4gICAgICAgIHRoaXMuX2J1dHRvbkNvbVsxXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvL+W9k+WJjeeCueWHu+eahOWvueW6lOeahOWGheWuueWPr+ingVxyXG4gICAgICAgIHRoaXMuX2NvbnRlbnRbMV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICAvL+eCueWHu+aTjeS9nOS7i+e7jVxyXG4gICAgb25CdG5DYW96dW9DbGljazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTwzO2krKyl7XHJcbiAgICAgICAgICAgIC8v5omA5pyJ5oyJ6ZKu6K6+572u5Li65Y+v55SoXHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkNvbVtpXS5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL+aJgOacieeahOWGheWuuemDvemakOiXj+aOiVxyXG4gICAgICAgICAgICB0aGlzLl9jb250ZW50W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL+W9k+WJjeeCueWHu+eahOiuvue9ruS4uuS4jeWPr+eUqFxyXG4gICAgICAgIHRoaXMuX2J1dHRvbkNvbVsyXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgICAgICAvL+W9k+WJjeeCueWHu+eahOWvueW6lOeahOWGheWuueWPr+ingVxyXG4gICAgICAgIHRoaXMuX2NvbnRlbnRbMl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCIvKipcclxuICog6YKA6K+356CBXHJcbiAqIEBhdXRob3JzIOm7hOaIkCh5b3VAZXhhbXBsZS5vcmcpXHJcbiAqIEBkYXRlICAgIDIwMTctMDYtMTYgMDk6NDQ6MTBcclxuICogQHZlcnNpb24gJElkJFxyXG4gKi9cclxuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbGFiZWxOdW1iZXJzOiBbY2MuTGFiZWxdLFxyXG4gICAgICAgIGNhbGxiYWNrSW52aXRlQ29kZTogJycsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNsaWNrQ2xlYXIoKTsgLy/muIXpmaTmlbDlrZdcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tDbGVhcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxhYmVsTnVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xyXG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja051bWJlcjogZnVuY3Rpb24gKGV2ZW50LCBudW1iZXIpIHtcclxuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcclxuICAgICAgaWYgKGxhYmVsKSB7XHJcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gbnVtYmVyO1xyXG4gICAgICAgXHRjYy5sb2cobGFiZWwuc3RyaW5nICxcIi0tLS0tLS0tLS0tLS0tLS1cIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGxldCBpc0NvbXBsZXRlID0gKHRoaXMuX2xhc3RFbXB0eUxhYmVsKCkgPT0gbnVsbCk7XHJcbiAgICAgIGNjLmxvZyhcImlzQ29tcGxldGUtLS0tLS0tLS0tLS0tXCIsIHRoaXMuY2FsbGJhY2tJbnZpdGVDb2RlKTtcclxuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuX2ludml0ZU51bWJlcigpO1xyXG5cclxuICAgICAgaWYgKCBpbnZpdGVOdW1iZXIubGVuZ3RoID09IDYgKXtcclxuICAgICAgICBjYy5sb2coaW52aXRlTnVtYmVyLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0zOFwiKTsgLy/pgoDor7fnoIFcclxuICAgICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIC8vU29ja2V0LnNlbmRJbnZpdGVDb2RlKGludml0ZU51bWJlciwgdXNlcklkKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrSW52aXRlQ29kZSA9IGludml0ZU51bWJlcjtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNlbmRDb2RlIDpmdW5jdGlvbigpeyAgLy/lj5HpgIHpgoDor7fnoIFcclxuICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuY2FsbGJhY2tJbnZpdGVDb2RlO1xyXG4gICAgICAvL2NjLmxvZyhpbnZpdGVOdW1iZXIsXCItLS0tLS0tLS0tLS0tLS0tLS0tLTM4XCIpXHJcbiAgICAgIGlmKCBpbnZpdGVOdW1iZXIgJiYgaW52aXRlTnVtYmVyLmxlbmd0aD09Nil7ICBcclxuICAgICAgICBTb2NrZXQuc2VuZEludml0ZUNvZGUoaW52aXRlTnVtYmVyLCB1c2VySWQpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tJbnZpdGVDb2RlID0gJyc7ICAgLy/muIXnqbrpgoDor7fnoIFcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBsYWJlbCA9IHRoaXMuX2xhc3ROdW1iZXJMYWJlbCgpO1xyXG4gICAgICBpZiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9sYXN0RW1wdHlMYWJlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBmb3IgKHZhciBpbmRleCBpbiB0aGlzLmxhYmVsTnVtYmVycykge1xyXG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcclxuICAgICAgICBpZiAobGFiZWwuc3RyaW5nID09IG51bGxcclxuICAgICAgICB8fCBsYWJlbC5zdHJpbmcubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgIHJldHVybiBsYWJlbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgaW5kZXggPSB0aGlzLmxhYmVsTnVtYmVycy5sZW5ndGggLSAxOyBpbmRleCA+PSAwOyAtLWluZGV4KSB7XHJcbiAgICAgICAgbGV0IGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIHJldHVybiBsYWJlbDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaW52aXRlTnVtYmVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmxhYmVsTnVtYmVycy5yZWR1Y2UoZnVuY3Rpb24gKGludml0ZU51bWJlciwgbGFiZWwpIHtcclxuICAgICAgICAvL2NjLmxvZyhpbnZpdGVOdW1iZXIsXCItLS0tLS0tLS0tLS0tLS0tLVwiKTtcclxuICAgICAgICByZXR1cm4gaW52aXRlTnVtYmVyICsgKGxhYmVsLnN0cmluZyB8fCBcIlwiKTtcclxuICAgICAgfSwgXCJcIik7XHJcbiAgICB9LFxyXG59KSIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGxhYmVsTnVtYmVyczogW2NjLkxhYmVsXSxcbiAgICAgICAgY2FsbGJhY2tKb2luUm9vbTogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNsaWNrQ2xlYXIoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tOdW1iZXI6IGZ1bmN0aW9uIChldmVudCwgbnVtYmVyKSB7XG4gICAgICB2YXIgbGFiZWwgPSB0aGlzLl9sYXN0RW1wdHlMYWJlbCgpO1xuICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IG51bWJlcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IGlzQ29tcGxldGUgPSAodGhpcy5fbGFzdEVtcHR5TGFiZWwoKSA9PSBudWxsKTtcbiAgICAgIGlmIChpc0NvbXBsZXRlICYmIHRoaXMuY2FsbGJhY2tKb2luUm9vbSkge1xuICAgICAgICBsZXQgcm9vbU51bWJlciA9IHRoaXMuX3Jvb21OdW1iZXIoKTtcbiAgICAgICAgLy8gY2MubG9nKFwi6KaB5Yqg5YWl55qE5oi/6Ze05Y+35piv77yaXCIsIHJvb21OdW1iZXIpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrSm9pblJvb20ocm9vbU51bWJlcik7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGNsaWNrQ2xlYXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubGFiZWxOdW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgY2xpY2tEZWxldGVPbmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBsYWJlbCA9IHRoaXMuX2xhc3ROdW1iZXJMYWJlbCgpO1xuICAgICAgaWYgKGxhYmVsKSB7XG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XG4gICAgICB9XG4gICAgfSxcblxuICAgIF9sYXN0RW1wdHlMYWJlbDogZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgaW5kZXggaW4gdGhpcy5sYWJlbE51bWJlcnMpIHtcbiAgICAgICAgdmFyIGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xuICAgICAgICBpZiAobGFiZWwuc3RyaW5nID09IG51bGxcbiAgICAgICAgfHwgbGFiZWwuc3RyaW5nLmxlbmd0aCA8PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX2xhc3ROdW1iZXJMYWJlbDogZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgaW5kZXggPSB0aGlzLmxhYmVsTnVtYmVycy5sZW5ndGggLSAxOyBpbmRleCA+PSAwOyAtLWluZGV4KSB7XG4gICAgICAgIGxldCBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyAmJiBsYWJlbC5zdHJpbmcubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgX3Jvb21OdW1iZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmxhYmVsTnVtYmVycy5yZWR1Y2UoZnVuY3Rpb24gKHJvb21OdW1iZXIsIGxhYmVsKSB7XG4gICAgICAgIHJldHVybiByb29tTnVtYmVyICsgKGxhYmVsLnN0cmluZyB8fCBcIlwiKTtcbiAgICAgIH0sIFwiXCIpO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xuICAgICAgICB9LCAwLjUpO1xuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUNhcmRGaW5kVHlwZUV4dGVuc2lvbiA9IHJlcXVpcmUoJ0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uJyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5jb25zdCBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyID0gcmVxdWlyZSgnS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlcicpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBzZWxlY3ROb2RlOmNjLk5vZGUsXG4gICAgICAgIGFsZXJ0UHJlZmFiOmNjLlByZWZhYixcbiAgICAgICAgY2FudmFzTm9kZTpjYy5Ob2RlLFxuICAgICAgICAvL2FncmVlbWVudDoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAvLyAgICB0eXBlOiBjYy5MYWJlbFxuICAgICAgICAvL30sXG4gICAgICAgIHZMYWJlbDpjYy5MYWJlbCxcbiAgICAgICAgc2Nyb2xsX1ZpZXc6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB0eXBlOmNjLlNjcm9sbFZpZXdcbiAgICAgICAgfSxcbiAgICAgICAgYWdyZWVtZW50TGFiZWw6Y2MuTGFiZWwsXG4gICAgICAgIGFncmVlbWVudE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgd2FpdGluZ1ByZWZhYjpjYy5QcmVmYWIsXG4gICAgfSxcblxuICAgIGdvVXBkYXRlQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIkFwcENvbnRyb2xsZXJcIixcImRvd25sb2FkTmV3VmVyc2lvbjpcIix0aGlzLmlvc1VybCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiY29tL2xsaW5nL3Nzei9BcHBBY3Rpdml0eVwiLCBcImRvd25sb2FkTmV3VmVyc2lvblwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCB0aGlzLmFuZHJvaWRVcmwpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNoZWNrVmVyc2lvbjpmdW5jdGlvbih2RGF0YSkge1xuICAgICAgICAvL3ZhciB2ZXJzaW9uID0gdkRhdGEudmVyc2lvbjtcbiAgICAgICAgY2MuaW5mbzEgPSB2RGF0YS52ZXJzaW9uO1xuICAgICAgICB0aGlzLmlvc1VybCA9IHZEYXRhLmlvc1VybDtcbiAgICAgICAgdGhpcy5hbmRyb2lkVXJsID0gdkRhdGEuYW5kcm9pZFVybDtcbiAgICAgICAgLy9pZiAobWFuYWdlci52ZXJzaW9uICE9IHZlcnNpb24pIHsvL+abtOaWsOeJiOacrFxuICAgICAgICAvLyAgICB0aGlzLnZlcnNpb25FbmFibGUgPSBmYWxzZTtcbiAgICAgICAgLy8gICAgdGhpcy5nb1VwZGF0ZUFjdGlvbigpO1xuICAgICAgICAvLyAgICAvL3RoaXMudmVyc2lvbkxhYmVsLnN0cmluZyA9ICfor7fliLDmnI3liqHlmajmm7TmlrDliLDmnIDmlrDniYjmnKwnO1xuICAgICAgICAvL31cbiAgICAgICAgLy9lbHNlIHtcbiAgICAgICAgICAgIC8vdGhpcy52ZXJzaW9uTGFiZWwuc3RyaW5nID0gJ+W9k+WJjeeJiOacrCAnICsgbWFuYWdlci52ZXJzaW9uO1xuICAgICAgICAgICAgdGhpcy52ZXJzaW9uRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKGluZm8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2luRW5hYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb2dpbkFjdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sMC41KTtcbiAgICAgICAgLy99XG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNjcm9sbF9WaWV3LnNjcm9sbFRvVG9wKCk7XG4gICAgICAgIEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIuc3RhcnQoKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgIHRoaXMubG9naW5FbmFibGUgPSBmYWxzZTtcbiAgICAgICB0aGlzLnNvY2tldCA9IGNjLmZpbmQoJ0dhbWVTb2NrZXQnKS5nZXRDb21wb25lbnQoJ3NvY2tldCcpO1xuICAgICAgIHRoaXMuc29ja2V0LnJlY2V2aWNlTWVzc2FnZSA9IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgICAgICAgIGlmIChkYXRhLmFjdGlvbiA9PSAnY2hlY2tWZXJzaW9uJykge1xuICAgICAgICAgICAgICAgc2VsZi5jaGVja1ZlcnNpb24oZGF0YS5kYXRhKTtcbiAgICAgICAgICAgfVxuICAgICAgICAgICBlbHNlIGlmIChkYXRhLmFjdGlvbiA9PSAnbG9naW4nKSB7XG4gICAgICAgICAgICAgICBpZiAoZGF0YS5yZXN1bHQpIHsvL+aIkOWKn1xuICAgICAgICAgICAgICAgICAgIHNlbGYuc29ja2V0LnVzZXJJbmZvID0gZGF0YS5kYXRhOy8v6L+Q6KGM5pe25oCB5L+h5oGvXG4gICAgICAgICAgICAgICAgICAgLy9jYy5sb2coSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgIC8vY2MubG9nKGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgLy9jYy5sb2coZGF0YS5kYXRhLnJvb21JZCk7XG4gICAgICAgICAgICAgICAgICAgLy9jYy5sb2coZGF0YS5kYXRhLnJvb21JZC5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgIC8vY2MubG9nKCctLS0tNzYnKTtcbiAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLnJvb21JZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgICAgICAgICAgICAgICAgICAgICB9LDEpO1xuICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLnByZWxvYWRTY2VuZSgncGxheScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgIH0sMSk7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgc2VsZi5hbGVydE1lc3NhZ2UoJ+eZu+W9leWksei0pSEnKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfVxuICAgICAgIH07XG5cbiAgICAgICAvL+S7juacrOWcsOiwg1xuICAgICAgIHRoaXMuc29ja2V0LmdldFd4SW5mbyA9IGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyhpbmZvKTsvL+S/neWtmOacrOWcsFxuICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoaW5mbyk7Ly9zdHIgLT4ganNvbihvYmopXG4gICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7Ly/lu7bov5/miafooYwgMXNcbiAgICAgICAgICAgICAgIHNlbGYuc2VuZExvZ2luUmVxdWVzdChkYXRhKTsvL+eZu+W9leivt+axglxuICAgICAgICAgICB9LDEpO1xuICAgICAgIH07XG4gICAgICAgLy9kZWJ1Z1xuICAgICAgIHZhciB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIm9KNzUydF8wLUQ3aWVNY1FQUjFtN2toRWxndVEwMDExXCIsXCJuaWNrbmFtZVwiOlwiaW15YVwiLFwic2V4XCI6MSxcImxhbmd1YWdlXCI6XCJ6aF9DTlwiLFwiY2l0eVwiOlwiQ2hhbmdzaGFcIixcInByb3ZpbmNlXCI6XCJIdW5hblwiLFwiY291bnRyeVwiOlwiQ05cIixcImhlYWRpbWd1cmxcIjpcImh0dHA6XFwvXFwvd3gucWxvZ28uY25cXC9tbW9wZW5cXC9CVnl6NFI4cTZwdUppYkV2MWhyc2FUbUlLUWhrYVRTOUZ5dmNldnZDNWhseEZuZk91c3BEamljRzBHdHp5SlhPaE5UN2cxV1pEZUNEUWhuUmRFT2d6M1FNblAwRjlpYm9RR3lcXC8wXCIsXCJwcml2aWxlZ2VcIjpbXX0nO1xuICAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSAmJiB3aW5kb3cubG9jYXRpb24pIHtcbiAgICAgICAgICAgIGxldCBzZWFyY2ggPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xuICAgICAgICAgICAgaWYgKHNlYXJjaCkge1xuICAgICAgICAgICAgICAgIGxldCBxdWVyeSA9IHNlYXJjaC5zdWJzdHJpbmcoMSk7XG4gICAgICAgICAgICAgICAgbGV0IGF0dHJzID0gcXVlcnkuc3BsaXQoJyYnKTtcbiAgICAgICAgICAgICAgICBsZXQgb2JqID0gSlNPTi5wYXJzZSh0ZXN0RGF0YSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcbiAgICAgICAgICAgICAgICB2YXIgbG9jID0gdXJsLnN1YnN0cmluZyh1cmwubGFzdEluZGV4T2YoJz0nKSsxLCB1cmwubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBpZihsb2MgPT0gMSl7XG4gICAgICAgICAgICAgICAgICAgIG9iai5vcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWc1T2pNNE9qRXpKdz09JztcbiAgICAgICAgICAgICAgICAgICAgb2JqLm5pY2tuYW1lID0gbG9jO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmKGxvYyA9PSAyKXtcbiAgICAgICAgICAgICAgICAgICAgb2JqLm9wZW5pZCA9ICdKekl3TVRjdk5pOHhOaURrdUlybGpZZzVPak00T2pNekp3PT0nO1xuICAgICAgICAgICAgICAgICAgICBvYmoubmlja25hbWUgPSBsb2M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYobG9jID09IDMpe1xuICAgICAgICAgICAgICAgICAgICBvYmoub3BlbmlkID0gJ0p6SXdNVGN0TmkweE5pQXdPVG8wTlRvMU9TYz0nO1xuICAgICAgICAgICAgICAgICAgICBvYmoubmlja25hbWUgPSBsb2M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYobG9jID09IDQpe1xuICAgICAgICAgICAgICAgICAgICBvYmoub3BlbmlkID0gJ0p6SXdNVGN2Tmk4eE5pRGt1SXJsallnNU9qUTJPakF3Snc9PSc7XG4gICAgICAgICAgICAgICAgICAgIG9iai5uaWNrbmFtZSA9IGxvYztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZihsb2MgPT0gNSl7XG4gICAgICAgICAgICAgICAgICAgIG9iai5vcGVuaWQgPSAnSnpJd01UY3ZOaTh4TmlEa3VJcmxqWWd4TURvd016b3dPQ2M9JztcbiAgICAgICAgICAgICAgICAgICAgb2JqLm5pY2tuYW1lID0gbG9jO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGF0dHJzLmZvckVhY2goZnVuY3Rpb24gKGF0dHIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGtleVZhbHVlQXJyID0gYXR0ci5zcGxpdCgnPScpO1xuICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0ga2V5VmFsdWVBcnJbMF07XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IGtleVZhbHVlQXJyWzFdO1xuICAgICAgICAgICAgICAgICAgICBvYmpba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSBKU09OLnN0cmluZ2lmeShvYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSkge1xuICAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbyh0ZXN0RGF0YSk7XG4gICAgICAgfVxuICAgICAgICAvL2lmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgIC8vICAgIHRoaXMudkxhYmVsLnN0cmluZyA9IGNjLl9sb2dpbkluZm8udklPUyB8fCBcIlwiO1xuICAgICAgICAvL30gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcbiAgICAgICAgLy8gICAgdGhpcy52TGFiZWwuc3RyaW5nID0gY2MuX2xvZ2luSW5mby52QSB8fCBcIlwiO1xuICAgICAgICAvL31cbiAgICAgICAgLy9jYy5sb2coY2MuX2xvZ2luSW5mbylcbiAgICAgICAgLy9jYy5sb2coJy0tLTEzOScpXG4gICAgfSxcblxuXG5cbiAgICBhZ3JlZW1lbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYWdyZWVtZW50Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAvL3RoaXMuYWdyZWVtZW50TGFiZWwuc3RyaW5nID0gY2MuaW5mbzE7XG4gICAgICAgIHRoaXMuYWdyZWVtZW50TGFiZWwubm9kZS55ID0gMDtcbiAgICB9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICB9LFxuXG4gICAgc2VuZExvZ2luUmVxdWVzdDpmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHRoaXMuc2hvd1dhaXRpbmdNZXNzYWdlKCfnmbvlvZXkuK0uLi4nKTtcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2xvZ2luJyxkYXRhKTtcbiAgICB9LFxuXG4gICAgbG9naW5BY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5zZWxlY3ROb2RlLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgIGlmICghY29tcC5zZWxlY3RlZCkge1xuICAgICAgICAgIHRoaXMuc2hvd01zZyA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnRQcmVmYWIpO1xuICAgICAgICAgIHRoaXMuY2FudmFzTm9kZS5hZGRDaGlsZCh0aGlzLnNob3dNc2cpO1xuICAgICAgICAgIGxldCBjb21wID0gdGhpcy5zaG93TXNnLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgICBjb21wLnNldE1lc3NhZ2UoJ+ivt+WQjOaEj+eUqOaIt+WNj+iuricpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xuICAgICAgICAgIHRoaXMuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJ3eExvZ2luXCIpOy8vSU9TXG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcbiAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hMb2dpblwiLCBcIigpVlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBsb2dpbllrQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMuc2VsZWN0Tm9kZS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICBpZiAoIWNvbXAuc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd01zZyA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnRQcmVmYWIpO1xuICAgICAgICAgICAgdGhpcy5jYW52YXNOb2RlLmFkZENoaWxkKHRoaXMuc2hvd01zZyk7XG4gICAgICAgICAgICBsZXQgY29tcCA9IHRoaXMuc2hvd01zZy5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgICAgICBjb21wLnNldE1lc3NhZ2UoJ+ivt+WQjOaEj+eUqOaIt+WNj+iuricpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ZXN0RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHZhciB0aW1lID0gXCInXCIrdGVzdERhdGUudG9Mb2NhbGVTdHJpbmcoKStcIidcIjtcbiAgICAgICAgdmFyIG9wZW5pZCA9IG5ldyBCdWZmZXIodGltZSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICAgICAgICB2YXIgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCInK29wZW5pZCsnXCIsXCJuaWNrbmFtZVwiOlwi5ri45a6iXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcL0JWeXo0UjhxNnB1SmliRXYxaHJzYVRtSUtRaGthVFM5Rnl2Y2V2dkM1aGx4Rm5mT3VzcERqaWNHMEd0enlKWE9oTlQ3ZzFXWkRlQ0RRaG5SZEVPZ3ozUU1uUDBGOWlib1FHeVxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgIC8vaWYgKCFjYy5zeXMuaXNOYXRpdmUgJiYgd2luZG93LmxvY2F0aW9uKSB7XG4gICAgICAgICAgICBsZXQgc2VhcmNoID0gJyAgJztcbiAgICAgICAgICAgIGlmIChzZWFyY2gpIHtcbiAgICAgICAgICAgICAgICBsZXQgcXVlcnkgPSBzZWFyY2guc3Vic3RyaW5nKDEpO1xuICAgICAgICAgICAgICAgIGxldCBhdHRycyA9IHF1ZXJ5LnNwbGl0KCcmJyk7XG4gICAgICAgICAgICAgICAgbGV0IG9iaiA9IEpTT04ucGFyc2UodGVzdERhdGEpO1xuICAgICAgICAgICAgICAgIGF0dHJzLmZvckVhY2goZnVuY3Rpb24gKGF0dHIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGtleVZhbHVlQXJyID0gYXR0ci5zcGxpdCgnPScpO1xuICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0ga2V5VmFsdWVBcnJbMF07XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IGtleVZhbHVlQXJyWzFdO1xuICAgICAgICAgICAgICAgICAgICBvYmpba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRlc3REYXRhID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgLy99XG5cbiAgICAgICAgLy92YXIgaW5mbyA9IG1hbmFnZXIuZ2V0VXNlckluZm8oKTtcbiAgICAgICAgLy9pZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UodGVzdERhdGEpO1xuICAgICAgICAgICAgdGhpcy5zZW5kTG9naW5SZXF1ZXN0KGRhdGEpO1xuICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgIC8vfWVsc2V7XG4gICAgICAgICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKHRlc3REYXRhKTtcbiAgICAgICAgLy99XG5cbiAgICB9LFxuXG4gICAgc2hvd1dhaXRpbmdNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICBpZiAodGhpcy53YWl0aW5nTm9kZSAhPSBudWxsICYmIGNjLnN5cy5pc05hdGl2ZSAmJiBjYy5pc1ZhbGlkKHRoaXMud2FpdGluZ05vZGUpKSB7XG4gICAgICAgICAgaWYgKG1zZyA9PSB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5nZXRNZXNzYWdlKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUucmVtb3ZlRnJvbVBhcmVudCgpO1xuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICAgIHRoaXMuY2FudmFzTm9kZS5hZGRDaGlsZCh0aGlzLndhaXRpbmdOb2RlKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLndhaXRpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgaGlkZGVuV2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLndhaXRpbmdOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBwcm90b2NvbEFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgY2MubG9nKCdwcm90b2NvbCBhY3Rpb24nKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIG1hUGFpU3ByaXRlOltjYy5TcHJpdGVGcmFtZV0sXHJcbiAgICAgICAgc3ByaXRlTm9kZTpjYy5TcHJpdGUsXHJcbiAgICAgICAgbGFiZWxOb2RlOmNjLk5vZGVcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBcclxuICAgIH0sXHJcblxyXG4gICAgXHJcbn0pO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICB2ZXJzaW9uOid2MS4wLjAnLFxuXG4gICAgc2V0VXNlckluZm86ZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlcmluZm8nLCBzdHIpO1xuICAgIH0sXG5cbiAgICBnZXRVc2VySW5mbzpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyaW5mbycpO1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcblxuICAgIHNldE11c2ljVmFsdWU6ZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdtdXNpY1ZvbHVtbicsdmFsdWUpO1xuICAgIH0sXG5cbiAgICBnZXRNdXNpY1ZhbHVlOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ211c2ljVm9sdW1uJyk7XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgc2V0TXVzaWNFZmZlY3RWYWx1ZTpmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ211c2ljRWZmZWN0Vm9sdW1uJyx2YWx1ZSk7XG4gICAgfSxcblxuICAgIGdldE11c2ljRWZmZWN0VmFsdWU6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbXVzaWNFZmZlY3RWb2x1bW4nKTtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG59O1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcbmNvbnN0IEFycmF5RXh0ZW5zaW9uID0gcmVxdWlyZSgnQXJyYXlFeHRlbnNpb24nKTtcclxuY29uc3QgTWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcclxuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XHJcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcclxuY29uc3QgVXNlck1vZGVsSGVscGVyID0gcmVxdWlyZSgnVXNlck1vZGVsSGVscGVyJyk7XHJcbmNvbnN0IFBsYXliYWNrID0gcmVxdWlyZSgnUGxheWJhY2snKTtcclxuY29uc3QgZmVjaGEgPSByZXF1aXJlKCdmZWNoYScpO1xyXG4vKiMjIyMjKi9cclxuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XHJcbi8qKi9cclxuY29uc3QgUGxheWVyID0gcmVxdWlyZSgnUGxheWVyJyk7XHJcbi8qKi9cclxuLy9jb25zdCBpc1RlU2h1UGFpID0gcmVxdWlyZSgnaXNUZVNodVBhaScpO1xyXG4vL+eJueauiueJjOexu+Wei1xyXG52YXIgVEVTSFVQQUlUWVBFID0ge1xyXG4gICAgaXNUZVNodVBhaTpmYWxzZSxcclxuICAgIGlzTGl1RHVpQmFuOmZhbHNlLFxyXG4gICAgaXNTYW5TaHVuWmk6ZmFsc2UsXHJcbiAgICBpc1NhblRhb0h1YTpmYWxzZSxcclxuXHJcbiAgICBpc1FpbmdMb25nOmZhbHNlLFxyXG4gICAgaXNZaVRpYW9Mb25nOmZhbHNlLFxyXG4gICAgaXNTYW5Ub25nSHVhU2h1bjpmYWxzZSxcclxuICAgIGlzU2FuRmVuVGlhblhpYTpmYWxzZSxcclxuICAgIGlzQ291WWlTZTpmYWxzZSxcclxuICAgIGlzU2lUYW9TYW5UaWFvOmZhbHNlLFxyXG4gICAgaXNXdUR1aVNhblRpYW86ZmFsc2VcclxufTtcclxuXHJcbmxldCBHQU1FU1RBVFVTID0ge1xyXG4gIFdBSVRfUEVPUExFOiAwLCAgICAvLyDnrYnkurpcclxuICBXQUlUX1JFQURZOiAxLCAgICAgLy8g562J5b6F5LuW5Lq65YeG5aSHXHJcbiAgUExBWUlORzogMiwgICAgICAgIC8vIOato+WcqOeOqea4uOaIj1xyXG59O1xyXG5cclxuXHJcbi8vIOW4g+WxgFxyXG4vLyAgICAgICAgICAyXHJcbi8vICAgMyAgICAgICAgICAgIDFcclxuLy8gICAgIHNlbGYgMFxyXG5sZXQgUGxheSA9IGNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgcGxheWVyTm9kZXM6IFtjYy5Ob2RlXSxcclxuICAgICAgICBjaGF0Tm9kZTogY2MuTm9kZSxcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmVOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIC8qIyMjIyMqL1xyXG4gICAgICAgIHR5cGVCdXR0b25zTm9kZTogY2MuTm9kZSxcclxuICAgICAgICAvKiMjIyMjKi9cclxuXHJcbiAgICAgICAgbGFiZWxSb29tTnVtYmVyOiBjYy5MYWJlbCxcclxuICAgICAgICBsYWJlbE92ZXJ2aWV3OiBjYy5MYWJlbCxcclxuICAgICAgICBsYWJlbFJlbWFpblRpbWU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGJ0blNoYXJlOiBjYy5CdXR0b24sXHJcbiAgICAgICAgYnRuUmVhZHk6IGNjLkJ1dHRvbiwgICAgICAvLyDlh4blpIflvIDlp4vmjInpkq5cclxuICAgICAgICBmYXBhaU5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgYnRuQ2hhdFZvaWNlOiBjYy5CdXR0b24sXHJcbiAgICAgICAgYnRuQ2hhdFRleHQ6IGNjLkJ1dHRvbixcclxuICAgICAgICBzdGFydENvbXBhcmVDYXJkc05vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgdm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHNldHRpbmdOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIHBsYXliYWNrTm9kZTogY2MuTm9kZSxcclxuXHJcbiAgICAgICAgb25lR2FtZVJlc3VsdDogY2MuTm9kZSwgICAvLyDkuIDlsYDnu5PmnpxcclxuICAgICAgICB0b3RhbEdhbWVSZXN1bHQ6IGNjLk5vZGUsXHJcblxyXG4gICAgICAgIGFsZXJ0UmVxdWVzdEV4aXROb2RlOiBjYy5Ob2RlLCAgLy8g55Sz6K+36YCA5Ye6IE5vZGVcclxuICAgICAgICBhbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZTogY2MuTm9kZSwgIC8vIOeUs+ivt+mAgOWHuuWAkuiuoeaXtiBOb2RlXHJcbiAgICAgICAgYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b246IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uOiBjYy5CdXR0b24sXHJcbiAgICAgICAgYnRuQnV0dG9uTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBidG5CdXR0b25zOiBjYy5Ob2RlLFxyXG5cclxuICAgICAgICBhbGVydEFuc293ZXJFeGl0Tm9kZTogY2MuTm9kZSwgLy8g5Zue562U55Sz6K+36YCA5Ye6ICBOb2RlXHJcbiAgICAgICAgYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGU6IGNjLk5vZGUsICAvLyDlm57nrZTku6XkuIror7fpgIDlh7rnmoTlgJLorqHml7ZcclxuXHJcbiAgICAgICAgYWxlcnQ6IGNjLk5vZGUsXHJcblxyXG4gICAgICAgIGFsZXJ0Rm9yY2VFeGl0Tm9kZTogY2MuTm9kZSwgIC8vIOW8uuWItumAgOWHuiBOb2RlXHJcblxyXG4gICAgICAgIHdhaXRpbmdQcmVmYWI6IGNjLlByZWZhYixcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgcGxheWVyQ29tcHM6IFtQbGF5ZXJdLFxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICAvKiMjIyMjKi9cclxuICAgICAgICB0ZXNodXBhaV9taW46W2NjLk5vZGVdLFxyXG4gICAgICAgIHRlc2h1cGFpX21heDpbY2MuTm9kZV0sXHJcbiAgICAgICAgZ29uZ1hpTmk6Y2MuTm9kZSxcclxuICAgICAgICB0ZVNodVBhaTpjYy5Ob2RlLFxyXG4gICAgICAgIF9saXVEdWlCYW46ZmFsc2UsXHJcbiAgICAgICAgX3NhblNodW5aaTpmYWxzZSxcclxuICAgICAgICBfc2FuVG9uZ0h1YTpmYWxzZSxcclxuICAgICAgICBfeWlUaWFvTG9uZzpmYWxzZSxcclxuXHJcbiAgICAgICAgX1FpbmdMb25nOmZhbHNlLFxyXG4gICAgICAgIF9TYW5Ub25nSHVhU2h1bjpmYWxzZSxcclxuICAgICAgICBfU2FuRmVuVGlhblhpYTpmYWxzZSxcclxuICAgICAgICBfQ291WWlTZTpmYWxzZSxcclxuICAgICAgICBfU2lUYW9TYW5UaWFvOmZhbHNlLFxyXG4gICAgICAgIF9XdUR1aVNhblRpYW86ZmFsc2UsXHJcblxyXG4gICAgICAgIHd1VG9uZ19pbWc6Y2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgdG9uZ0h1YVNodW5faW1nOmNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgIC8qIyMjIyMqL1xyXG5cclxuICAgICAgICBfcGxheWVyQ29tcG9uZW50czogbnVsbCxcclxuICAgICAgICBfbXNnQ29udHJvbDogbnVsbCxcclxuXHJcbiAgICAgICAgX3NvY2tldDogbnVsbCxcclxuICAgICAgICBfdXNlcklkOiAwLFxyXG4gICAgICAgIF9wbGF5ZXJJbmZvczogbnVsbCxcclxuICAgICAgICBfZGVza0luZm86IG51bGwsICAgLy8gY3JlYXRlVGltZSDliJvlu7rml7bpl7QgIGlzRGlzc29sdmluZyDooajnpLrmmK/lkKbmraPlnKjop6PmlaMgZGlzc29sdmVMZWZ0VGltZSDnprvop6PmlaPliankvZnlpJrplb/ml7bpl7QgZGlzc29sdmVBbnN3ZXJJbmZvIFvlpITnkIbov4fnmoTkurrnmoTkv6Hmga9dXHJcbiAgICAgICAgX2dhbWVTdGF0dXM6IEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUsXHJcbiAgICAgICAgX2VudGVyVGltZTogbnVsbCxcclxuICAgICAgICBfcGxheWVyczpudWxsLFxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBfaXNDb21wYXJpbmdDYXJkc05vdzogZmFsc2UsIC8vIOaYr+WQpuato+WcqOavlOeJjFxyXG4gICAgICAgIF9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHM6IFtdLCAvLyDlt7Lnu4/mkq3mlL7ov4fmr5TniYznmoTlsYDmlbBcclxuICAgICAgICAvKiovXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5CdG5DbGlja0dvbmdYaU5pQ29tZmlybSA9IHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5nZXRDb21wb25lbnQoXCJDYXJkVHlwZUNvbWJpbmVcIikuQnRuQ2xpY2tHb25nWGlOaUNvbWZpcm07XHJcbiAgICAgICAgdGhpcy5fZW50ZXJUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5wbGF5ZXJDb21wcy5mb3JFYWNoKHBsYXllckNvbXAgPT4ge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnBsYXllZENvbXBhcmVDYXJkc0luZGV4cyA9IHRoaXMuX3BsYXllZENvbXBhcmVDYXJkc0luZGV4cztcclxuICAgICAgICB9KTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgLypBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheURlc2tNdXNpYygpOyovXHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnN0b3BIYWxsTXVzaWMoKTtcclxuICAgICAgICB0aGlzLl9pbml0UGxheWVyQ29tcG9uZW50cygpO1xyXG4gICAgICAgIHRoaXMuX2luaXRTZWxlY3RDYXJkTm9kZSgpO1xyXG4gICAgICAgIHRoaXMuX2luaXRPbmVHYW1lUmVzdWx0KCk7XHJcbiAgICAgICAgdGhpcy5fcmVtYWluVGltZVN0YXJ0VXBkYXRlKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcclxuICAgICAgICB0aGlzLl9tc2dDb250cm9sID0gdGhpcy5jaGF0Tm9kZS5nZXRDb21wb25lbnQoJ01zZ0NvbnRyb2wnKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXR0aW5nTm9kZS5nZXRDb21wb25lbnQoXCJTZXR0aW5nXCIpLmhpZGVTd2l0Y2goKTtcclxuICAgICAgICB0aGlzLmxhYmVsUm9vbU51bWJlci5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyVm9pY2VOb2RlRXZlbnRzKCk7XHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xyXG5cclxuICAgICAgICAvKiMjIyMjKi9cclxuICAgICAgICB0aGlzLl9pbml0TWFQYWkoKTtcclxuICAgICAgICBQbGF5Lmluc3RhbmNlcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KGZhbHNlKTtcclxuICAgICAgICAvKiMjIyMjKi9cclxuICAgICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNDb250YWluUGxheWJhY2tEYXRhcygpKSB7XHJcbiAgICAgICAgICBQbGF5YmFjay5pbnN0YW5jZS5zdGFydFBsYXliYWNrKCk7XHJcbiAgICAgICAgICB0aGlzLnBsYXliYWNrTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgdGhpcy5idG5DaGF0Vm9pY2Uubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgIC8vdGhpcy5jYXJkc0Zyb21BcnJheS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLl9sb2FkRGVza0luZm8oKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB0aGlzLl9zb2NrZXQgPSBTb2NrZXQuaW5zdGFuY2U7XHJcblxyXG4gICAgICAgIC8vIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyAgIC8vIHRoaXMuX3Nob3dPbmVHYW1lUmVzdWx0KCk7XHJcbiAgICAgICAgLy8gICAvLyB0aGlzLl9zdGFydENvbXBhcmVDYXJkcygpO1xyXG4gICAgICAgIC8vIH0uYmluZCh0aGlzKSwgMik7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIC8q5pi+56S66ams54mMKi9cclxuICAgIF9pbml0TWFQYWk6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vXCJtYXBhaVwi6ISa5pys5LiK5oyC552A6ams54mM57K+54G1XHJcbiAgICAgICAgdmFyIG1hUGFpQ29tID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChcIm1hUGFpXCIpO1xyXG4gICAgICAgIHZhciBzcHJpdGVOb2RlID0gbWFQYWlDb20uc3ByaXRlTm9kZTsgLy/pqazniYznsr7ngbXoioLngrlcclxuICAgICAgICB2YXIgbGFiZWxOb2RlID0gbWFQYWlDb20ubGFiZWxOb2RlOyAgIC8v6ams54mM5paH5a2X6IqC54K5XHJcbiAgICAgICAgaWYodGhpcy5tYVBhaSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGxhYmVsTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLm1hUGFpID09IDEpe1xyXG4gICAgICAgICAgICBzcHJpdGVOb2RlLnNwcml0ZUZyYW1lID0gbWFQYWlDb20ubWFQYWlTcHJpdGVbMF07XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5tYVBhaSA9PSA1KXtcclxuICAgICAgICAgICAgc3ByaXRlTm9kZS5zcHJpdGVGcmFtZSA9IG1hUGFpQ29tLm1hUGFpU3ByaXRlWzFdO1xyXG4gICAgICAgIH1lbHNlIGlmKHRoaXMubWFQYWkgPT0gMTApe1xyXG4gICAgICAgICAgICBzcHJpdGVOb2RlLnNwcml0ZUZyYW1lID0gbWFQYWlDb20ubWFQYWlTcHJpdGVbMl07XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHNwcml0ZU5vZGUuc3ByaXRlRnJhbWUgPSBudWxsO1xyXG4gICAgICAgICAgICBsYWJlbE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFBsYXllckNvbXBvbmVudHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzID0gdGhpcy5wbGF5ZXJOb2Rlcy5tYXAoZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdQbGF5ZXInKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX2luaXRTZWxlY3RDYXJkTm9kZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgIGxldCBjYXJkVHlwZUNvbWJpbmVDb21wID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudCgnQ2FyZFR5cGVDb21iaW5lJyk7XHJcbiAgICAgIGNhcmRUeXBlQ29tYmluZUNvbXAuc2V0RmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjayhmdW5jdGlvbiAoc2VydmVyQ2FyZHNJbmZvKSB7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lQ29tcC5yZXNldCgpO1xyXG4gICAgICAgIFNvY2tldC5zZW5kUGxheUNhcmQoc2VsZi5fdXNlcklkLCBzZXJ2ZXJDYXJkc0luZm8pO1xyXG4gICAgICAgIHNlbGYuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgX2luaXRPbmVHYW1lUmVzdWx0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5vbmVHYW1lUmVzdWx0LnNldENsb3NlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChzZWxmLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuICAgIC8qKi9cclxuICAgIC8vX2luaXRPbmVHYW1lUmVzdWx0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAvLyAgdGhpcy5vbmVHYW1lUmVzdWx0LnNldENsb3NlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAvLyAgICBpZiAoc2VsZi5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgIC8vICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAvLyAgICB9XHJcbiAgICAvLyAgfTtcclxuICAgIC8vfSxcclxuXHJcbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vZmZUYXJnZXQodGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrRXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyAmJiB0aGlzLl9kZXNrSW5mby5pc0Rlc2tPdmVyKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdykge1xyXG4gICAgICAgICAgICAgICAgLy8g5aaC5p6c5oi/6Ze05bey57uT5p2f77yM5bm25LiU5LiN5piv5q2j5Zyo5pKt5pS+5omT54mM5Yqo55S7LCDliJnnm7TmjqXnprvlvIDmiL/pl7RcclxuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIC8vaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgLy8gICAgdGhpcy5hbGVydEZvcmNlRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcbiAgICAgICAgLy8gICAgcmV0dXJuO1xyXG4gICAgICAgIC8vfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgU29ja2V0LnNlbmREaXNzb2x2ZURlc2sodGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIFNvY2tldC5zZW5kTGVhdmVEZXNrKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDb25maXJtQnV0dG9uLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgYWxlcnQudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgIGFsZXJ0LnNldE1lc3NhZ2UoXCLmgqjlnKjnlLPor7fljY/llYbpgIDlh7rvvIzlpoLmnpzmiYDmnInnjqnlrrblkIzmhI/vvIzmgqjlsIbpgIDlh7rmuLjmiI/jgIJcIik7XHJcbiAgICAgICAgYWxlcnQuYWxlcnQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/ngrnlh7vliIbkuqvmjInpkq5cclxuICAgIGNsaWNrU2hhcmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IHJvb21JZCA9IFN0cmluZyh0aGlzLl9kZXNrSW5mby5yb29tSWQpO1xyXG4gICAgICB2YXIgZGVzY3JpcHRpb24gPSBcIumHkem6n+WNgeS4iemBkyDnjqnms5U6XCJcclxuICAgICAgICAgIC8vKyB0aGlzLl9kZXNrSW5mb0dhbWVXYXkoKTtcclxuICAgICAgZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbiArIFwiIFwiICsgdGhpcy5fZGVza0luZm9OdW1iZXJPZlBlb3BsZSgpO1xyXG4gICAgICBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uICsgXCIsXCIgKyB0aGlzLl9kZXNrSW5mb1BheUluZm8oKTtcclxuICAgICAgICAvL2Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIixcIiArIHRoaXMuX2Rlc2tJbmZvSmlhWWlTZUluZm8oKTtcclxuICAgICAgICAvL2Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIixcIiArIHRoaXMuX2Rlc2tJbmZvR3VpUGFpSW5mbygpO1xyXG4gICAgICBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uICsgXCIgXCIgKyB0aGlzLl9kZXNrSW5mb051bWJlck9mR2FtZSgpO1xyXG5cclxuICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2hhcmVGcmllbmQ6ZGVzY3JpcHRpb246XCIscm9vbUlkLCBkZXNjcmlwdGlvbik7XHJcbiAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLCBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiLCByb29tSWQsIGRlc2NyaXB0aW9uKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvL+eCueWHu+WHhuWkh+aMiemSrlxyXG4gICAgY2xpY2tSZWFkeTogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgLyojIyMjI+eCueWHu+WHhuWkh+eahOaXtuWAme+8jOS4iuS4gOWxgOavlOeJjOeahOaVsOaNrua2iOWksSovXHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgLy9wbGF5ZXJDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7ICAvLyMjIyMjXHJcbiAgICAgIH0pO1xyXG4gICAgICBjYy5maW5kKFwiQ2FudmFzL3Nob3dfcmVzdWx0XCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICBTb2NrZXQuc2VuZFJlYWR5KHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZVJvb21OdW1iZXI6IGZ1bmN0aW9uIChyb29tTnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IGdhbWVOdW1iZXJTdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSAhPSAwICYmIHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxICE9IDEpIHtcclxuICAgICAgICAgICAgZ2FtZU51bWJlclN0cmluZyA9IFwi5bGA5pWwIDogXCIgKyBcIlwiICsgdGhpcy5fZGVza0luZm8uY0luZGV4ICsgXCIvXCIgKyB0aGlzLl9kZXNrSW5mby5tTWF4O1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgPT0gMCkge1xyXG4gICAgICAgICAgICBnYW1lTnVtYmVyU3RyaW5nID0gXCLlsYDmlbAgOiAxMOWxgFwiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgPT0gMSkge1xyXG4gICAgICAgICAgICBnYW1lTnVtYmVyU3RyaW5nID0gXCLlsYDmlbAgOiAyMOWxgFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgdGhpcy5sYWJlbFJvb21OdW1iZXIuc3RyaW5nID0gXCLmiL/lj7cgOiBcIiArIFwiXCIgKyByb29tTnVtYmVyICsgXCJcXG5cIiArIGdhbWVOdW1iZXJTdHJpbmc7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZUdhbWVTdGF0dXM6IGZ1bmN0aW9uIChzdGF0dXMgPSBHQU1FU1RBVFVTLldBSVRfUEVPUExFKSB7XHJcbiAgICAgIHRoaXMuX2dhbWVTdGF0dXMgPSBzdGF0dXM7XHJcblxyXG4gICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gKHN0YXR1cyA9PSBHQU1FU1RBVFVTLldBSVRfUEVPUExFKTtcclxuICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IChzdGF0dXMgPT0gR0FNRVNUQVRVUy5XQUlUX1JFQURZKTtcclxuICAgICAgICB0aGlzLmlzUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICAvL2lmIChzdGF0dXMgPT0gR0FNRVNUQVRVUy5QTEFZSU5HKSB7XHJcbiAgICAgIC8vICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyQ29tcCl7XHJcbiAgICAgIC8vICAgIC8vcGxheWVyQ29tcC5oaWRlUmVhZHlTdGF0dXMoKTtcclxuICAgICAgLy8gIH0pO1xyXG4gICAgICAvL31cclxuICAgIH0sXHJcblxyXG4gICAgZ2FtZVN0YXR1czogZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fZ2FtZVN0YXR1cztcclxuICAgIH0sXHJcbiAgICBpc1JlYWR5U3RhdHVzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLl9wbGF5ZXJJbmZvcylcclxuICAgICAgICBpZih0aGlzLl9wbGF5ZXJJbmZvcyAmJiB0aGlzLl9wbGF5ZXJJbmZvcy5sZW5ndGg+MCkge1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllckluZm8pe1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJbmZvU2VsZj1jYy5maW5kKCdDYW52YXMvcGxheVNlbGYvdXNlckluZm9TZWxmJyk7XHJcbiAgICAgICAgICAgICAgICBpZihwbGF5ZXJJbmZvLmlkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCFwbGF5ZXJJbmZvLnJlYWR5U3RhdHVzICYmICF0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ICYmICFQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzQ29udGFpblBsYXliYWNrRGF0YXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySW5mb1NlbGYuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldFJlYWR5Tm9kZVZpc2libGUoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY0luZGV4ID09IDApIHsvL+S4gOWxgOi/mOayoeW8gOWni1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pZih0aGlzLl9kZXNrSW5mby5jcmVhdGVJZCAhPSB0aGlzLl91c2VySWQpey8vLy/mmK/lkKbmmK/miL/kuLtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGVza0luZm8ucGxheWVycy5sZW5ndGggPCB0aGlzLl9kZXNrSW5mby5tYXhOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL31lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9uZUdhbWVSZXN1bHQgPSB0aGlzLm9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdHYW1lUmVzdWx0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmVHYW1lUmVzdWx0LnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uZUdhbWVSZXN1bHQuc2hvd1Jlc3VsdHModGhpcy5fZGVza0luZm8sIHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLmnKrmm77lh4blpIdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaG93X3Jlc3VsdFwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJbmZvU2VsZi5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3VzZXJJbmZvU2VsZi5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyQ29tcCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyQ29tcC5oaWRlUmVhZHlTdGF0dXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5bey5YeG5aSHXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy8vIOa4uOaIj+WKqOeUu1xyXG4gICAgX3N0YXJ0R2FtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAodGhpcy5nYW1lU3RhdHVzKCkgPT0gR0FNRVNUQVRVUy5QTEFZSU5HKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgICAgdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyA9IHRydWU7XHJcbiAgICAgIHRoaXMudXBkYXRlR2FtZVN0YXR1cyhHQU1FU1RBVFVTLlBMQVlJTkcpO1xyXG4gICAgICB0aGlzLl9wbGF5RmFQYWlBbmltYXRpb24oKTtcclxuXHJcbiAgICAgIGlmICghVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh0aGlzLl91c2VySWQpKSkge1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHRoaXMuX3Nob3dDYXJkVHlwZUNvbWJpbmUoKTtcclxuICAgICAgICB9LmJpbmQodGhpcyksIDEuMCk7XHJcblxyXG4gICAgICAgIC8vbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIC8vICAvL3RoaXMuZmFwYWlOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xyXG4gICAgICAgIC8vICBzZWxmLmZhcGFpTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICB2YXIgYW5pbSA9IHRoaXMuZmFwYWlOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xyXG4gICAgICAgIC8vICBhbmltLnBsYXkoJ2ZhcGFpJyk7XHJcbiAgICAgICAgLy90aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gIHNlbGYuZmFwYWlOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfSwgMi4wKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3BsYXlGYVBhaUFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcil7XHJcbiAgICAgICAgcGxheWVyLnBsYXlGYVBhaUFuaW1hdGlvbigpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5RmFQYWkoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjIyovXHJcbiAgICAvL+aYr+WQpueJueauiueJjFxyXG4gICAgaXNUZVNodVBhaTogZnVuY3Rpb24oY2FyZHMpe1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNUZVNodVBhaShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzVGVTaHVQYWkgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNUZVNodVBhaSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5LiA5p2h6b6ZXHJcbiAgICBpc1lpVGlhb0xvbmc6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1lpVGlhb0xvbmcoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1lpVGlhb0xvbmcgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNZaVRpYW9Mb25nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKblha3lr7nljYpcclxuICAgIGlzTGl1RHVpQmFuOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc0xpdUR1aUJhbiA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc0xpdUR1aUJhbiA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuS4iemhuuWtkFxyXG4gICAgaXNTYW5TaHVuWmk6IGZ1bmN0aW9uKGNhcmRzKXtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2FuU2h1blppKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5TaHVuWmkgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5TaHVuWmkgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbkuInlkIzoirFcclxuICAgIGlzU2FuVG9uZ0h1YTogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2FuVG9uZ0h1YShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuVGFvSHVhID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuVGFvSHVhID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5LiJ5ZCM6Iqx6aG6XHJcbiAgICBpc1NhblRvbmdIdWFTaHVuOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTYW5Ub25nSHVhU2h1bihjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuVG9uZ0h1YVNodW4gPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5Ub25nSHVhU2h1biA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYr+a4hem+mVxyXG4gICAgaXNRaW5nTG9uZzogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzUWluZ0xvbmcoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1FpbmdMb25nID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzUWluZ0xvbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK8g4oCc5LiJ5YiG5aSp5LiL4oCdXHJcbiAgICBpc1NhbkZlblRpYW5YaWE6IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhbkZlblRpYW5YaWEgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5GZW5UaWFuWGlhID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5pivIOKAnOWbm+Wll+S4ieadoeKAnVxyXG4gICAgaXNTaVRhb1NhblRpYW86IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NpVGFvU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2lUYW9TYW5UaWFvID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2lUYW9TYW5UaWFvID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5piv5LqU5a+55LiJ5p2hXHJcbiAgICBpc1d1RHVpU2FuVGlhbzogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzV3VEdWlTYW5UaWFvKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNXdUR1aVNhblRpYW8gPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNXdUR1aVNhblRpYW8gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK/lh5HkuIDoibJcclxuICAgIGlzQ291WWlTZTogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzQ291WWlTZShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzQ291WWlTZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc0NvdVlpU2UgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyojIyMjIyovXHJcblxyXG4gICAgLyrmmL7npLrphY3niYzpobXpnaIqL1xyXG4gICAgX3Nob3dDYXJkVHlwZUNvbWJpbmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBjYXJkVHlwZUNvbWJpbmUgPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZUNvbWJpbmUnKTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUucmVsb2FkQ2FyZHMoW10pO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnRpbWVTdGFydCgxMjApOy8vc2RcclxuXHJcbiAgICAgICAgbGV0IGNhcmRzID0gdGhpcy5fZmluZENhcmRzQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgICAgICAvL2NhcmRzID0gW3tzdWl0OiBcImNcIiwgbnVtYmVyOjIwfSx7c3VpdDogXCJkXCIsIG51bWJlcjoxMn0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEyfSwvL+mdkum+mVxyXG4gICAgICAgIC8vICAgIHtzdWl0OiBcImNcIiwgbnVtYmVyOjEyfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTB9LFxyXG4gICAgICAgIC8vICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjEwfSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6OH0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjZ9LFxyXG4gICAgICAgIC8vICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjZ9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo1fSxcclxuICAgICAgICAvLyAgICB7c3VpdDogXCJzXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6Mn0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjJ9LF07XHJcbiAgICAgICAgLyppZih0aGlzLl91c2VySWQgPT0gMSl7XHJcbiAgICAgICAgICAgIGNhcmRzID0gW3tzdWl0OiBcInNcIiwgbnVtYmVyOjN9LHtzdWl0OiBcInNcIiwgbnVtYmVyOjZ9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo3fSwvL+mdkum+mVxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6OX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEzfSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImhcIiwgbnVtYmVyOjEwfSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6MTJ9LCB7c3VpdDogXCJoXCIsIG51bWJlcjoxM30sXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6NX0sXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjozfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6N30sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjh9LF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fdXNlcklkID09IDIpe1xyXG4gICAgICAgICAgICBjYXJkcyA9IFt7c3VpdDogXCJzXCIsIG51bWJlcjoxfSx7c3VpdDogXCJzXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6Mn0sLy/pnZLpvplcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImhcIiwgbnVtYmVyOjR9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo0fSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjZ9LCB7c3VpdDogXCJoXCIsIG51bWJlcjo2fSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6OX0sXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJjXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTB9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiY1wiLCBudW1iZXI6MTB9LCB7c3VpdDogXCJjXCIsIG51bWJlcjoxMn0sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjEyfSxdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX3VzZXJJZCA9PSAzKXtcclxuICAgICAgICAgICAgY2FyZHMgPSBbe3N1aXQ6IFwiY1wiLCBudW1iZXI6MX0se3N1aXQ6IFwiaFwiLCBudW1iZXI6M30sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEyfSwvL+mdkum+mVxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6Mn0sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjN9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6NH0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjV9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo2fSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImhcIiwgbnVtYmVyOjh9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo4fSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjExfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTF9LCB7c3VpdDogXCJoXCIsIG51bWJlcjoxMX0sXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl91c2VySWQgPT0gNCl7XHJcbiAgICAgICAgICAgIGNhcmRzID0gW3tzdWl0OiBcImNcIiwgbnVtYmVyOjExfSx7c3VpdDogXCJkXCIsIG51bWJlcjoxM30sIHtzdWl0OiBcImRcIiwgbnVtYmVyOjExfSwvL+mdkum+mVxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6MX0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjF9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiY1wiLCBudW1iZXI6Mn0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjR9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo5fSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImNcIiwgbnVtYmVyOjd9LCB7c3VpdDogXCJoXCIsIG51bWJlcjo3fSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjV9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo1fSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6NX0sXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl91c2VySWQgPT0gNSl7XHJcbiAgICAgICAgICAgIGNhcmRzID0gW3tzdWl0OiBcImRcIiwgbnVtYmVyOjR9LHtzdWl0OiBcImRcIiwgbnVtYmVyOjEzfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTN9LC8v6Z2S6b6ZXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo2fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6N30sXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6OX0sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjEwfSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjF9LCB7c3VpdDogXCJzXCIsIG51bWJlcjozfSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEwfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6OH0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjEyfSxdO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICBsZXQgY2FyZE5hbWVzID0gdGhpcy5fY29udmVydENhcmRzVG9DYXJkTmFtZXMoY2FyZHMpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZWxvYWRDYXJkcyhjYXJkTmFtZXMpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5hZGRDYXJkTW9kZXMoY2FyZE5hbWVzKTtcclxuXHJcbiAgICAgICAgLyojIyMjI+WPkeeJjOWujOaJp+ihjCovXHJcblxyXG4gICAgICAgIC8vY2FyZHM6W3snbnVtYmVyJzoxfjEzLCdzdWl0JzoncycgfCAnaCcgfCAnYycgfCAnZCd9XVxyXG4gICAgICAgIC8vY2MuZnJvbS5tb3NoaSA9PSAw6YCJ5oup5LqG5bqE5a625qih5byPXHJcbiAgICAgICAgaWYoY2MubW9zaGkgIT0gMSl7XHJcbiAgICAgICAgICAgIHRoaXMuaXNUZVNodVBhaShjYXJkcyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNZaVRpYW9Mb25nKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5pc1FpbmdMb25nKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzTGl1RHVpQmFuKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzU2FuU2h1blppKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzU2FuVG9uZ0h1YShjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzU2FuRmVuVGlhblhpYShjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1NpVGFvU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc1d1RHVpU2FuVGlhbyhjYXJkcyk7XHJcbiAgICAgICAgICAgIC8vdGhpcy5pc0NvdVlpU2UoY2FyZHMpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fc2hvd0dvbmdYaU5pQW5kQnRuVGVTaHVQYWkoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9ICcnO1xyXG4gICAgICAgIGlmKFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpKXtcclxuICAgICAgICAgICAgLy/lpoLmnpzmmK/nibnmrorniYzlsIbniYzlrZjotbfmnaVcclxuICAgICAgICAgICAgY2MudGVTaHVQYWlDYXJkcyA9IGNhcmRzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIC8qIyMjIyMqL1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRJc1RlU2h1UGFpOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgdmFyIGNhcmRzID0gdGhpcy5fZmluZENhcmRzQnlVc2VySWQodXNlcklkKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5pc1RlU2h1UGFpKGNhcmRzKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjI+ajgOa1i+eJueauiueJjOexu+Wei++8jOaYvuekuuebuOWvueW6lOeahOaBreWWnOS9oOmhtemdouWSjOeJueauiueJjOeyvueBtSovXHJcbiAgICBfc2hvd0dvbmdYaU5pQW5kQnRuVGVTaHVQYWk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKuWmguaenOacieeJueauiueJjCovXHJcbiAgICAgICAgaWYoVEVTSFVQQUlUWVBFLmlzVGVTaHVQYWkpe1xyXG4gICAgICAgICAgICBpZihURVNIVVBBSVRZUEUuaXNZaVRpYW9Mb25nKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3lpVGlhb0xvbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYoVEVTSFVQQUlUWVBFLmlzUWluZ0xvbmcpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2FuVG9uZ0h1YSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc0xpdUR1aUJhbil7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fbGl1RHVpQmFuID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5TaHVuWmkpe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX3NhblNodW5aaSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2FuVGFvSHVhKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9zYW5Ub25nSHVhID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5Ub25nSHVhU2h1bil7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fU2FuVG9uZ0h1YVNodW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NhbkZlblRpYW5YaWEpe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX1NhbkZlblRpYW5YaWEgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc0NvdVlpU2Upe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX0NvdVlpU2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NpVGFvU2FuVGlhbyl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fU2lUYW9TYW5UaWFvID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNXdUR1aVNhblRpYW8pe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX1d1RHVpU2FuVGlhbyA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9pbml0VGVTaHVQYWlTcHJpdGUoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjI+aOp+WItueJueauiueJjOeyvueBteeahOaYvuekuiovXHJcbiAgICBfaW5pdFRlU2h1UGFpU3ByaXRlOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKuaKiuaJgOacieeahOeJueauiueJjOeyvueBtemDvemakOiXj+aOiSovXHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLnRlc2h1cGFpX21pbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9taW5baV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4W2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKuWmguaenOaYr+S4gOadoem+me+8jOWwseaYvuekuuS4gOadoem+meeahOeyvueBtSovXHJcbiAgICAgICAgaWYodGhpcy5feWlUaWFvTG9uZyl7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzNdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzNdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5YWt5a+55Y2K5bCx5pi+56S65YWt5a+55Y2K55qE57K+54G1Ki9cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX2xpdUR1aUJhbil7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzBdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzBdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5LiJ6aG65a2Q5bCx5pi+56S65LiJ6aG65a2Q55qE57K+54G1Ki9cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX3NhblNodW5aaSl7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzFdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX3NhblRvbmdIdWEpe1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21pblsyXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21heFsyXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9RaW5nTG9uZyl7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzRdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzRdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX1NhblRvbmdIdWFTaHVuKXtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9taW5bNV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9tYXhbNV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fU2FuRmVuVGlhblhpYSl7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzZdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzZdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX0NvdVlpU2Upe1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21pbls3XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21heFs3XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9TaVRhb1NhblRpYW8pe1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21pbls4XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21heFs4XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9XdUR1aVNhblRpYW8pe1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21pbls5XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21heFs5XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLyojIyMjIyovXHJcbiAgICAvL+aYvuekumdvbmdYaU5pIOmhtemdouWSjHRlU2h1UGFpXHJcbiAgICBfZ29uZ1hpTmlTaG93OmZ1bmN0aW9uIChzdGF0dWVzKSB7XHJcbiAgICAgICAgdmFyIGFsdGVyQ29tID0gdGhpcy5nb25nWGlOaS5nZXRDb21wb25lbnQoXCJhbGVydFwiKTtcclxuICAgICAgICBpZihzdGF0dWVzKXtcclxuICAgICAgICAgICAgYWx0ZXJDb20uYWxlcnQoKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgYWx0ZXJDb20uZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50ZVNodVBhaS5hY3RpdmUgPSBzdGF0dWVzO1xyXG4gICAgfSxcclxuICAgIC8qIyMjIyMqL1xyXG5cclxuICAgIC8vICDnu5Pmnpznm7jlhbNcclxuICAgIC8vIOaYvuekuuS4gOWxgOe7k+aenFxyXG4gICAgX3Nob3dPbmVHYW1lUmVzdWx0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSBmYWxzZTtcclxuICAgICAgICAvKiovXHJcbiAgICAgIHRoaXMudXBkYXRlR2FtZVN0YXR1cyhHQU1FU1RBVFVTLldBSVRfUEVPUExFKTtcclxuICAgICAgbGV0IG9uZUdhbWVSZXN1bHQgPSB0aGlzLm9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdHYW1lUmVzdWx0Jyk7XHJcbiAgICAgIG9uZUdhbWVSZXN1bHQudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICBvbmVHYW1lUmVzdWx0LnNob3dSZXN1bHRzKHRoaXMuX2Rlc2tJbmZvLCB0aGlzLl91c2VySWQpO1xyXG4gICAgICB0aGlzLl91cGRhdGVVc2VyU2NvcmVzKCk7XHJcbiAgICAgIHRoaXMuX3VwZGF0ZUJhbmtlcigpO1xyXG5cclxuICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgIC8vcGxheWVyQ29tcC5yZXNldCgpO1xyXG4gICAgICAgICAgLy9wbGF5ZXJDb21wLnJlc2V0MigpOyAgLy8jIyMjI1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXNlbGYuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgICAgIC8vaWYgKHNlbGYuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7Ly/kuIDlsYDov5jmsqHlvIDlp4tcclxuICAgICAgICAgICAgLy8gICAgc2VsZi5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgaWYgKHNlbGYuX2lzVG90YWxHYW1lT3ZlcigpKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX3Nob3dUb3RhbEdhbWVSZXN1bHQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sIDAuNSk7XHJcblxyXG4gICAgICBpZiAodGhpcy5faXNSYW5kb21Sb29tKCkgfHwgUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgb25lR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xyXG4gICAgICAgICAgfSwgMik7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmL7npLrmgLvnu5PmnpxcclxuICAgIF9zaG93VG90YWxHYW1lUmVzdWx0OiBmdW5jdGlvbiAoc2hvd0RlbGF5ID0gMikge1xyXG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgbGV0IHRvdGFsR2FtZVJlc3VsdENvbXAgPSB0aGlzLnRvdGFsR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ1RvdGFsR2FtZVJlc3VsdCcpO1xyXG4gICAgICB0b3RhbEdhbWVSZXN1bHRDb21wLnNldFBsYXllckluZm9zKHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMsIHRoaXMuX2Rlc2tJbmZvKTtcclxuXHJcbiAgICAgIGxldCBhbGVydCA9IHRoaXMudG90YWxHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMub25lR2FtZVJlc3VsdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvL2FsZXJ0LmFsZXJ0KCk7XHJcbiAgICAgICAgICAvKiovXHJcbiAgICAgICAgICBpZiAoIXRoaXMudG90YWxHYW1lUmVzdWx0LmFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgIGFsZXJ0LmFsZXJ0KCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvKiovXHJcbiAgICAgIH0uYmluZCh0aGlzKSwgc2hvd0RlbGF5KTtcclxuXHJcbiAgICAgIGFsZXJ0LnNldERpc21pc3NDYWxsYmFjayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiBTb2NrZXQg55u45YWzXHJcbiAgICBfbG9hZERlc2tJbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIFNvY2tldC5zZW5kR2V0RGVzY2tJbmZvKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG4gICAgX3JlZ2lzdGVyU29ja2V0RXZlbnQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURlc2tJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8sIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlT25saW5lU3RhdHVzLCB0aGlzLl9zb2NrZXRSZWNpdmVPbmxpbmVTdGF0dXMsIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlQ2hhdFRleHQsIHRoaXMuX3NvY2tldFJlY2l2ZUNoYXRUZXh0TWVzc2FnZSwgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVSZXF1ZXN0RGlzc29sdmUsIHRoaXMuX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdE1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUmVxdWVzdERpc3NvbHZlUmVzdWx0LCB0aGlzLl9zb2NrZXRSZWNlaXZlUmVxdWVzdEV4aXRSZXN1bHRNZXNzYWdlLCB0aGlzKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUF1ZGlvTWVzc2FnZSwgdGhpcy5fc29ja2V0UmVjZWl2ZUF1ZGlvTWVzc2FnZSwgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVQbGF5Q2FyZCwgdGhpcy5fc29ja2V0UmVjZWl2ZVBsYXlDYXJkLCB0aGlzKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUdhbWVPdmVyLCB0aGlzLl9zb2NrZXRSZWNlaXZlR2FtZU92ZXIsIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlRmFQYWksIHRoaXMuX3NvY2tldFJlY2l2ZUZhUGFpLCB0aGlzKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlYWR5LCB0aGlzLl9zb2NrZXRSZWNpdmVSZWFkeSwgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEaXNzb2x2ZURlc2ssIHRoaXMuX3NvY2tldFJlY2VpdmVEaXNzb2x2ZURlc2ssIHRoaXMpO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlTGVhdmVEZXNrLCB0aGlzLl9zb2NrZXRMZWF2ZURlc2ssIHRoaXMpO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXREaXNjb25uZWN0LCB0aGlzLl9yZWNlaXZlU29ja2V0Q29ubmVjdEVycm9yLCB0aGlzKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fcmVjZWl2ZVNvY2tldENvbm5lY3RTdWNjZXNzZWQsIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUGF1c2UsIHRoaXMuX3NvY2tldFJlY2VpdmVQYXVzZSwgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlRGVza0luZm86IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgIGNjLmVycm9yKFwi6ZSZ6K+v77yaXCIsIHJlc3BvbnNlKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAvKiMjIyMj5re75Yqg5LqU5ZCM5oyJ6ZKuKi9cclxuICAgICAgICBjYy5tb3NoaSA9IHJlc3BvbnNlLmRhdGEuc2V0dGluZzM7XHJcbiAgICAgICAgaWYoZGF0YS5zZXR0aW5nOCAhPSBudWxsKXtcclxuICAgICAgICAgICAgY2MubW9zaGkgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy5tYVBhaSA9IHJlc3BvbnNlLmRhdGEubWFQYWk7XHJcbiAgICAgIGNjLmR1b1lpU2UgPSByZXNwb25zZS5kYXRhLnNldHRpbmc3OyAgIC8vc2V0dGluZzfkuLogIDAgfHwgbnVsbCAgMOWwseaYr+mAieaLqeS6huWkmuS4gOiJslxyXG4gICAgICAvKmlmKGNjLmR1b1lpU2UgPT0gMCl7XHJcbiAgICAgICAgICB0aGlzLmJ0bld1VG9uZyA9IG5ldyBjYy5Ob2RlKCk7IC8v5Yib5bu65LiA5Liq6IqC54K55a+56LGhXHJcbiAgICAgICAgICB0aGlzLmJ0bld1VG9uZy5hZGRDb21wb25lbnQoY2MuU3ByaXRlKTsgLy/mt7vliqDnsr7ngbXnu4Tku7ZcclxuICAgICAgICAgIHRoaXMuYnRuV3VUb25nLmFkZENvbXBvbmVudChjYy5CdXR0b24pOyAvL+a3u+WKoEJ1dHRvbue7hOS7tlxyXG4gICAgICAgICAgdmFyIGJ0blNwcml0ZSA9IHRoaXMuYnRuV3VUb25nLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgICAgYnRuU3ByaXRlLnNwcml0ZUZyYW1lID0gdGhpcy53dVRvbmdfaW1nO1xyXG4gICAgICAgICAgdGhpcy5idG5XdVRvbmcubmFtZSA9IFwiYnRuV3VUb25nXCI7XHJcbiAgICAgICAgICBpZighdGhpcy50eXBlQnV0dG9uc05vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5XdVRvbmdcIikpe1xyXG4gICAgICAgICAgICAgIHRoaXMudHlwZUJ1dHRvbnNOb2RlLmFkZENoaWxkKHRoaXMuYnRuV3VUb25nKTtcclxuICAgICAgICAgICAgICB0aGlzLmJ0bld1VG9uZy5pbnRlcmFjdGFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdmFyIHRvbmdIdWFTaHVuU3ByaXRlQ29tID0gdGhpcy50eXBlQnV0dG9uc05vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5Ub25nSHVhU2h1blwiKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgIHRvbmdIdWFTaHVuU3ByaXRlQ29tLnNwcml0ZUZyYW1lID0gdGhpcy50b25nSHVhU2h1bl9pbWc7ICAvL+aUueWPmOWQjOiKsemhuueahOeyvueBtVxyXG5cclxuICAgICAgICAgIC8v57uZ5LqU5ZCM5oyJ6ZKu5re75Yqg5LqL5Lu277yaXHJcbiAgICAgICAgICB2YXIgY2xpY2tFdmVudFd1VG9uZyA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XHJcbiAgICAgICAgICBjbGlja0V2ZW50V3VUb25nLnRhcmdldCA9IHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZTtcclxuICAgICAgICAgIGNsaWNrRXZlbnRXdVRvbmcuY29tcG9uZW50ID0gXCJDYXJkVHlwZUNvbWJpbmVcIjsgLy/ohJrmnKzlkI1cclxuICAgICAgICAgIGNsaWNrRXZlbnRXdVRvbmcuaGFuZGxlciA9IFwiY2xpY2tXdVRvbmdcIjsgIC8v5omn6KGM55qE5Ye95pWwXHJcblxyXG4gICAgICAgICAgdmFyIEJ1dHRvbnNDbGlja0V2ZW50cyA9IHRoaXMuYnRuV3VUb25nLmdldENvbXBvbmVudChjYy5CdXR0b24pLmNsaWNrRXZlbnRzO1xyXG4gICAgICAgICAgQnV0dG9uc0NsaWNrRXZlbnRzLnB1c2goY2xpY2tFdmVudFd1VG9uZyk7XHJcbiAgICAgIH0qL1xyXG4gICAgICAvKiMjIyMjKi9cclxuICAgICAgdGhpcy5tYVBhaSA9IGRhdGEubWFQYWk7XHJcbiAgICAgIC8qIyMjIyMqL1xyXG4gICAgICB0aGlzLl9pbml0TWFQYWkoKTtcclxuICAgICAgLyojIyMjIyovXHJcbiAgICAgIHRoaXMuX2Rlc2tJbmZvID0gZGF0YTtcclxuICAgICAgdGhpcy5fdXBkYXRHYW1lT3ZlcnZpZXcodGhpcy5fZGVza0luZm8pO1xyXG4gICAgICB0aGlzLnVwZGF0ZVJvb21OdW1iZXIoZGF0YS5yb29tSWQpO1xyXG5cclxuICAgICAgbGV0IHBsYXllckluZGV4cyA9IGRhdGEucGxheWVyc0luZGV4OyAvLyBbMTAwMDQ5XVxyXG4gICAgICB0aGlzLl9pbmplY3RVc2VySWRUb1BsYXllckNvbXBvbmVudHMocGxheWVySW5kZXhzKTtcclxuXHJcbiAgICAgIGxldCBwbGF5ZXJzID0gZGF0YS5wbGF5ZXJzO1xyXG4gICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgIHRoaXMuX3VwZGF0ZVVzZXJJbmZvcyhwbGF5ZXJzKTtcclxuICAgICAgdGhpcy5fdXBkYXRlVXNlclNjb3JlcygpO1xyXG4gICAgICB0aGlzLl91cGRhdGVCYW5rZXIoKTtcclxuICAgICAgdGhpcy5fbXNnQ29udHJvbC5hZGRQbGF5ZXJJbmZvcyh0aGlzLl9wbGF5ZXJJbmZvcyk7XHJcblxyXG4gICAgICBsZXQgY3VycmVudFVzZXJJbmZvID0gcGxheWVycy5maW5kKGZ1bmN0aW9uIChwbGF5ZXJJbmZvKSB7XHJcbiAgICAgICAgcmV0dXJuIHBsYXllckluZm8uaWQgPT0gdGhpcy5fdXNlcklkO1xyXG4gICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIGlmKGRhdGEuY3JlYXRlSWQgPT0gcGxheWVyLnVzZXJJZCl7Ly/mmL7npLrmiL/kuLtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93RmFuZ1podVN0YXR1cyhkYXRhLmNyZWF0ZUlkLHRydWUpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93RmFuZ1podVN0YXR1cyhwbGF5ZXIudXNlcklkLGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAvL2lmICh0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCkge1xyXG4gICAgICAvLyAgcmV0dXJuO1xyXG4gICAgICAvL31cclxuICAgICAgICAvKiovXHJcblxyXG4gICAgICAgIGlmICghdGhpcy5fZGVza0luZm8uaXNDQmVnaW4pIHtcclxuICAgICAgICAgICAgdGhpcy5fZ2FtZVN0YXR1cyA9IEdBTUVTVEFUVVMuV0FJVF9SRUFEWTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vLy/msqHmnInlj5HniYzvvIzkuI3mmK/pmo/mnLrlnLos5LiN5piv5Zue5pS+77yM5pi+56S65YeG5aSH5oyJ6ZKuXHJcbiAgICAgICAgLy9pZiAoIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luXHJcbiAgICAgICAgLy8gICAgJiYgIXRoaXMuX2lzUmFuZG9tUm9vbSgpXHJcbiAgICAgICAgLy8gICAgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKVxyXG4gICAgICAgIC8vICAgICYmICF0aGlzLl9nZXRTZWxmUmVhZHlTdGF0dXMoKVxyXG4gICAgICAgIC8vKSB7XHJcbiAgICAgICAgLy8gICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgaWYodGhpcy5fZGVza0luZm8uY0luZGV4ICE9IDApIHtcclxuICAgICAgICAvLyAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLnggPSAwO1xyXG4gICAgICAgIC8vICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUueSA9IDA7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vICAgIGVsc2Uge1xyXG4gICAgICAgIC8vICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUueCA9IC0xNTA7XHJcbiAgICAgICAgLy8gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS55ID0gLTI0O1xyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAvL31cclxuICAgICAgICBmb3IodmFyIGk9MDtpPHBsYXllcnMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIHZhciBzPXBsYXllcnNbaV07XHJcbiAgICAgICAgICAgIHZhciBpcz1zLnJlYWR5U3RhdHVzOy8vdHJ1ZS9mYWxzZVxyXG4gICAgICAgICAgICB2YXIgdXNlcklkID0gcy5pZDtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93UmVhZHlTdGF0dXModXNlcklkLGlzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICBpZiAoY3VycmVudFVzZXJJbmZvICYmIGN1cnJlbnRVc2VySW5mby5jYXJkcy5sZW5ndGggPiAwICYmIHRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luKSB7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRHYW1lKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHMoY3VycmVudFVzZXJJbmZvKSAmJiAhdGhpcy5fZGVza0luZm8uaXNDQmVnaW4pIHtcclxuICAgICAgICB0aGlzLl9zb2NrZXRSZWNlaXZlR2FtZU92ZXIocmVzcG9uc2UpO1xyXG4gICAgICB9XHJcbiAgICAgICAgdGhpcy5pc1JlYWR5U3RhdHVzKCk7XHJcbiAgICAgIC8vaWYgKCF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbiAmJiAhdGhpcy5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgLy8gIHRoaXMuYnRuUmVhZHV5Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgLy99XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIC8vaWYgKCF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbiAmJiAhdGhpcy5faXNSYW5kb21Sb29tKCkgJiYgIXRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAvLyAgICAvL3RoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIC8vICAgIGNjLmxvZyh0aGlzLl9kZXNrSW5mbylcclxuICAgICAgICAvLyAgICBjYy5sb2coJ+mCo+WwseaYr+S9oOS6hi0tLS0tLScpXHJcbiAgICAgICAgLy8gICAgaWYgKHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cpIHtcclxuICAgICAgICAvLyAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAvL30gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIC8qKi9cclxuICAgICAgdGhpcy5faGFuZGxlVXBkYXRlRGVza0luZm9BYm91dEV4aXRSb29tKHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2l2ZUZhUGFpOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8ocmVzcG9uc2UpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjaXZlT25saW5lU3RhdHVzOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgLy97XCJhY3Rpb25cIjpcInNlbmRPbmxpbmVTdGF0dXNcIixcInJlc3VsdFwiOnRydWUsXCJkYXRhXCI6e1widXNlcklkXCI6MTAwMDQ5LFwic3RhdHVzXCI6MX19XHJcbiAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgY2MuZXJyb3IoXCLplJnor6/vvJpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICBsZXQgdXNlcklkID0gZGF0YS51c2VySWQ7XHJcbiAgICAgIGxldCBzdGF0dXMgPSBkYXRhLnN0YXR1cztcclxuXHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgcGxheWVyLnNldFVzZXJPbmxpbmVTdGF0dXModXNlcklkLCBzdGF0dXMpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2l2ZUNoYXRUZXh0TWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgbGV0IG1lc3NhZ2UgPSByZXNwb25zZS5kYXRhLm1zZztcclxuXHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgcGxheWVyLnNob3dDaGF0VGV4dCh1c2VySWQsIG1lc3NhZ2UpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMuX21zZ0NvbnRyb2wuYWRkQ2hhdFRleHRNZXNzYWdlKHVzZXJJZCwgbWVzc2FnZSk7XHJcblxyXG4gICAgICBsZXQgc2V4ID0gdGhpcy5fcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgIHJldHVybiB1c2VyLmlkID09IHVzZXJJZDtcclxuICAgICAgfSkuc2V4O1xyXG4gICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNoYXRBdWRpbyhzZXgsIG1lc3NhZ2UpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZVJlcXVlc3RFeGl0TWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgIGlmIChyZXNwb25zZS5kYXRhLnVzZXJJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBhbGVydENvbXAgPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgYWxlcnRDb21wLmFsZXJ0KCk7XHJcbiAgICAgIGFsZXJ0Q29tcC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcblxyXG4gICAgICBsZXQgY291bnRkb3duID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpO1xyXG4gICAgICBjb3VudGRvd24uc3RhcnRDb3VudGRvd24oMTIwLCBmdW5jdGlvbihpc1RpbWVvdXQpIHtcclxuICAgICAgICBpZiAoaXNUaW1lb3V0KSB7XHJcbiAgICAgICAgICB0aGlzLmNsaWNrQWdyZWVPdGhlclBsYXllckV4aXQoKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlUmVxdWVzdEV4aXRSZXN1bHRNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgdGhpcy5faGlkZVJlcWVzdEV4aXROb2RlKCk7XHJcbiAgICAgIGlmICh0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgICB9XHJcblxyXG5cclxuICAgICAgaWYgKHJlc3BvbnNlLmRhdGEucmVzdWx0KSB7XHJcbiAgICAgICAgLy8g6Kej5pWj5oiQ5YqfXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICAgIGxldCBuaWNrbmFtZSA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodXNlcklkKS5uaWNrbmFtZTtcclxuICAgICAgICB0aGlzLnNob3dBbGVydE1lc3NhZ2UoJ+ino+aVo+Wksei0pe+8jOWboOS4uicgKyBuaWNrbmFtZSArICfkuI3lkIzmhI/pgIDlh7onKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjZWl2ZUF1ZGlvTWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgdGhpcy5wbGF5U3BlYWtBbmltYXRpb24odXNlcklkKTtcclxuXHJcbiAgICAgIGlmICh1c2VySWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgdXJsID0gcmVzcG9uc2UuZGF0YS51cmw7XHJcbiAgICAgIHRoaXMucGxheUF1ZGlvVXJsKHVybCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlUGxheUNhcmQ6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAvLyDmnInnlKjmiLflt7Lnu4/lh4blpIflpb3kuobniYxcclxuICAgICAgICBjYy5sb2cocmVzcG9uc2UpXHJcbiAgICAgICAgY2MubG9nKCctLS0tLS0tLTk3MicpXHJcbiAgICAgICAgdmFyIHVzZXJJZCA9IHJlc3BvbnNlLmRhdGFbMF0udXNlcklkO1xyXG4gICAgICAgIHZhciBjYXJkSW5mbyA9IHJlc3BvbnNlLmRhdGFbMV0uY2FyZDtcclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICBwbGF5ZXIucGxheUNhcmQodXNlcklkLGNhcmRJbmZvKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAodXNlcklkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIF9nZXRTZWxmUmVhZHlTdGF0dXM6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgcmV0dXJuIHNlbGYucmVhZHlTdGF0dXM7XHJcbiAgICB9LFxyXG4gICAgX3NvY2tldFJlY2l2ZVJlYWR5OiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgIHBsYXllci5zaG93UmVhZHlTdGF0dXModXNlcklkKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8v5pS25Yiw5ri45oiP57uT5p2fXHJcbiAgICBfc29ja2V0UmVjZWl2ZUdhbWVPdmVyOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgdGhpcy5faGlkZVJlcWVzdEV4aXROb2RlKCk7XHJcblxyXG4gICAgICAvLyDkuIDlsYDmuLjmiI/nu5PmnZ9cclxuICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICBjYy5lcnJvcihcIumUmeivr++8mlwiLCByZXNwb25zZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIGNvbnN0IGRlc2tJbmZvID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICBpZiAocmVzcG9uc2UuYWN0aW9uID09ICdnYW1lT3ZlcicgJiYgZGVza0luZm8uaXNEZXNrT3Zlcikge1xyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZERpZFJlY2VpdmVHYW1lT3ZlckFjdGlvbih0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgIHRoaXMuX2Rlc2tJbmZvID0gcmVzcG9uc2UuZGF0YTtcclxuXHJcbiAgICAgIC8vIOWmguaenOaYr+W8uuWItuino+aVo+aIv+mXtO+8jOWImeebtOaOpeaYvuekuuaAu+aIkOe7qVxyXG4gICAgICBpZiAodGhpcy5faXNEaXNzdmxlZFJvb20oKSAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgdGhpcy5fc2hvd1RvdGFsR2FtZVJlc3VsdCgwLjEpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuXHJcbiAgICAgIGlmIChEYXRlLm5vdygpIC0gdGhpcy5fZW50ZXJUaW1lIDwgMTAwMCAqIDQpIHtcclxuICAgICAgICAvLyDliJrov5vmnaXnmoTor53vvIzkuI3lsZXnpLrmr5TniYzliqjnlLtcclxuICAgICAgICAgIGxldCBvbmVHYW1lUmVzdWx0ID0gdGhpcy5vbmVHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnR2FtZVJlc3VsdCcpO1xyXG4gICAgICAgICAgb25lR2FtZVJlc3VsdC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgICBvbmVHYW1lUmVzdWx0LnNob3dSZXN1bHRzKHRoaXMuX2Rlc2tJbmZvLCB0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzLnB1c2godGhpcy5fZGVza0luZm8uY0luZGV4KTtcclxuICAgICAgICAgIC8qKi9cclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgdGhpcy5fZGVza0luZm8gPSBkYXRhO1xyXG4gICAgICB0aGlzLl91cGRhdEdhbWVPdmVydmlldyh0aGlzLl9kZXNrSW5mbyk7XHJcblxyXG4gICAgICBsZXQgcGxheWVySW5kZXhzID0gZGF0YS5wbGF5ZXJzSW5kZXg7IC8vIFsxMDAwNDldXHJcblxyXG4gICAgICBsZXQgcGxheWVycyA9IGRhdGEucGxheWVycztcclxuICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBwbGF5ZXJzO1xyXG4gICAgICB0aGlzLl91cGRhdGVVc2VySW5mb3MocGxheWVycyk7XHJcblxyXG4gICAgICBpZiAoVXNlck1vZGVsSGVscGVyLmlzVXNlclJlYWR5KHRoaXMuX2ZpbmRDdXJyZW50VXNlckluZm8oKSkpIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLl9zdGFydENvbXBhcmVDYXJkcyhyZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlRGlzc29sdmVEZXNrOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICBsZXQgbWVzc2FnZSA9IFwi5oi/5Li75bey6Kej5pWj5oi/6Ze0XCI7XHJcbiAgICAgIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgIG1lc3NhZ2UgPSBcIuacieeOqeWutuW3suW8uuWItumAgOWHuuaIv+mXtO+8jOa4uOaIj+e7k+adn+OAguacrOWxgOa4uOaIj+S4jeS8muaJo+mZpOaCqOeahOmSu+efs+OAglwiO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLnNob3dBbGVydE1lc3NhZ2UobWVzc2FnZSwgZmFsc2UpO1xyXG4gICAgICB0aGlzLmFsZXJ0LmdldENvbXBvbmVudCgnYWxlcnQnKS5zZXRXaWxsRGlzbWlzc0NhbGxiYWNrKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICBfc29ja2V0TGVhdmVEZXNrOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uaXNEZXNrT3Zlcikge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzmiL/pl7Tlt7Lnu5PmnZ/vvIzkuZ/kuI3nlKjlho3oh6rliqjpgIDlm57liLDlpKfljoXkuoZcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgLy8gc29ja2V0IOaUtuWIsOacieS6uuaJi+acuui/m+WFpeWQjuWPsOa2iOaBr1xyXG4gICAgX3NvY2tldFJlY2VpdmVQYXVzZTogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCB1c2VySWQgPSByZXNwb25zZS5kYXRhLnVzZXJJZDtcclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikge1xyXG4gICAgICAgIGlmIChwbGF5ZXIudXNlcklkID09IHVzZXJJZCkge1xyXG4gICAgICAgICAgcGxheWVyLnNldFVzZXJPbmxpbmVTdGF0dXModXNlcklkLCAwKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVjZWl2ZVNvY2tldENvbm5lY3RFcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgdGhpcy5zaG93TmV0d29ya01lc3NhZ2UoKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3JlY2VpdmVTb2NrZXRDb25uZWN0U3VjY2Vzc2VkOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICB0aGlzLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XHJcblxyXG4gICAgICBpZiAoIVBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgIHRoaXMuX2xvYWREZXNrSW5mbygpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgLy8gTUFSSzog5pu05paw5oi/6Ze05L+h5oGvXHJcbiAgICB1cGRhdGVEZXNrSW5mbzogZnVuY3Rpb24gKGRlc2tJbmZvKSB7XHJcbiAgICAgICAgdGhpcy5fZGVza0luZm8gPSBkZXNrSW5mbztcclxuICAgICAgICB0aGlzLl91cGRhdEdhbWVPdmVydmlldyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVSb29tTnVtYmVyKGRlc2tJbmZvLnJvb21JZCk7XHJcblxyXG4gICAgICAgIGxldCBwbGF5ZXJJbmRleHMgPSBkZXNrSW5mby5wbGF5ZXJzSW5kZXg7IC8vIFsxMDAwNDldXHJcbiAgICAgICAgdGhpcy5faW5qZWN0VXNlcklkVG9QbGF5ZXJDb21wb25lbnRzKHBsYXllckluZGV4cyk7XHJcblxyXG4gICAgICAgIGxldCBwbGF5ZXJzID0gZGVza0luZm8ucGxheWVycztcclxuICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICAgIHRoaXMuX21zZ0NvbnRyb2wuYWRkUGxheWVySW5mb3ModGhpcy5fcGxheWVySW5mb3MpO1xyXG4gICAgICAgIGlmIChkZXNrSW5mby5jSW5kZXggPT0gMCAmJiB0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA8IHRoaXMuX2Rlc2tJbmZvLm1heE51bWJlcikge1xyXG4gICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgX2luamVjdFVzZXJJZFRvUGxheWVyQ29tcG9uZW50czogZnVuY3Rpb24gKHBsYXllckluZGV4cykge1xyXG4gICAgICBsZXQgY3VycmVudFVzZXJJZEluZGV4ID0gcGxheWVySW5kZXhzLmZpbmRJbmRleChmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJJZCA9PSB0aGlzLl91c2VySWQ7XHJcbiAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICBsZXQgZml4ZWRQbGF5ZXJJbmRleHMgPSBwbGF5ZXJJbmRleHMudHJhbnNsYXRpb25XaXRoU3RhcnRJbmRleChjdXJyZW50VXNlcklkSW5kZXgpO1xyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXBvbmVudCwgaW5kZXgpIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gZml4ZWRQbGF5ZXJJbmRleHMubGVuZ3RoID4gaW5kZXggPyBmaXhlZFBsYXllckluZGV4c1tpbmRleF0gOiBudWxsO1xyXG4gICAgICAgIHBsYXllckNvbXBvbmVudC51c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfdXBkYXRlVXNlckluZm9zOiBmdW5jdGlvbiAodXNlckluZm9zKSB7XHJcbiAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wb25lbnQsIGluZGV4KSB7XHJcbiAgICAgICAgLy9wbGF5ZXJDb21wb25lbnQuc2V0RGVza0luZm8oc2VsZi5fZGVza0luZm8pO1xyXG4gICAgICAgICAgLyoqL1xyXG4gICAgICAgICAgcGxheWVyQ29tcG9uZW50LnVwZGF0ZURlc2tJbmZvKHNlbGYuX2Rlc2tJbmZvKTtcclxuICAgICAgICAgIC8qKi9cclxuICAgICAgICBwbGF5ZXJDb21wb25lbnQudXBkYXRlVXNlckluZm9XaXRoVXNlcnModXNlckluZm9zKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB0aGlzLl9oYW5kbGVUaGVTYW1lT2ZJUEFkcmVzcyh1c2VySW5mb3MpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfdXBkYXRlVXNlclNjb3JlczogZnVuY3Rpb24odXNlckluZm9zKSB7XHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXIpIHtcclxuICAgICAgICBwbGF5ZXIudXBkYXRlU2NvcmUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICBfdXBkYXRlQmFua2VyOiBmdW5jdGlvbigpIHtcclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikge1xyXG4gICAgICAgIHBsYXllci51cGRhdGVCYW5rZXIoKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOengeacieaWueazlVxyXG4gICAgX2ZpbmRDYXJkc0J5VXNlcklkOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgIGxldCBwbGF5ZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHVzZXJJZCk7XHJcblxyXG4gICAgICByZXR1cm4gKHBsYXllciAhPSBudWxsKSA/IHBsYXllci5jYXJkcyA6IG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9maW5kUGxheWVySW5mb0J5VXNlcklkOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgIGxldCBwbGF5ZXIgPSAodGhpcy5fcGxheWVySW5mb3MgfHwgW10pLmZpbmQoZnVuY3Rpb24gKHBsYXllckluZm8pIHtcclxuICAgICAgICByZXR1cm4gdXNlcklkID09IHBsYXllckluZm8uaWQ7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHBsYXllcjtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZpbmRQbGF5ZXJJbmRleEJ5VXNlcklkOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgIGxldCBpbmRleCA9IHRoaXMuX3BsYXllckNvbXBvbmVudHMuZmluZEluZGV4KGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgcmV0dXJuIHBsYXllckNvbXAudXNlcklkID09IHVzZXJJZDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9LFxyXG5cclxuICAgIF9maW5kQ3VycmVudFVzZXJJbmZvOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lczogZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICAgIC8vIFt7XCJzdWl0XCI6XCJzXCIsXCJudW1iZXJcIjoxMH1dXHJcbiAgICAgIGxldCBzdWl0Q29sb3JNYXAgPSB7XHJcbiAgICAgICAgczogNCxcclxuICAgICAgICBoOiAzLFxyXG4gICAgICAgIGM6IDIsXHJcbiAgICAgICAgZDogMSxcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgIHZhciBjYXJkTnVtYmVyID0gY2FyZC5udW1iZXI7XHJcblxyXG4gICAgICAgIC8vIOacjeWKoeWZqOS4reeahCAxNCDmmK8gQVxyXG4gICAgICAgIGlmIChjYXJkLm51bWJlciA9PSAxNCkge1xyXG4gICAgICAgICAgY2FyZE51bWJlciA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBjb2xvciA9IHN1aXRDb2xvck1hcFtjYXJkLnN1aXRdO1xyXG4gICAgICAgIGxldCBudW1iZXIgPSBNYXRoLm1heChNYXRoLm1pbihjYXJkTnVtYmVyLCAyMSksIDEpO1xyXG4gICAgICAgIHJldHVybiBjb2xvciArIFwiX1wiICsgbnVtYmVyO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5pu05paw5ri45oiP5oC76KeI5L+h5oGvXHJcbiAgICBfdXBkYXRHYW1lT3ZlcnZpZXc6IGZ1bmN0aW9uIChkZXNrSW5mbykge1xyXG4gICAgICBpZiAoUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgdGhpcy5sYWJlbE92ZXJ2aWV3LnN0cmluZyA9IFwi5Zue5pS+XCI7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGhpcy5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICB0aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vbGV0IGdhbWVOdW1iZXJTdHJpbmcgPSBcIlwiO1xyXG4gICAgICAvL2lmIChkZXNrSW5mby5zZXR0aW5nMSAhPSAwICYmIGRlc2tJbmZvLnNldHRpbmcxICE9IDEpIHtcclxuICAgICAgLy8gIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IFwiICsgXCJcIiArIGRlc2tJbmZvLmNJbmRleCArIFwiL1wiICsgZGVza0luZm8ubU1heDtcclxuICAgICAgLy99IGVsc2UgaWYgKGRlc2tJbmZvLnNldHRpbmcxID09IDApIHtcclxuICAgICAgLy8gIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IDEw5bGAXCI7XHJcbiAgICAgIC8vfSBlbHNlIGlmIChkZXNrSW5mby5zZXR0aW5nMSA9PSAxKSB7XHJcbiAgICAgIC8vICBnYW1lTnVtYmVyU3RyaW5nID0gXCLlsYDmlbAgOiAyMOWxgFwiO1xyXG4gICAgICAvL31cclxuXHJcbiAgICAgIC8vbGV0IGdhbWVXYXlOYW1lID0gdGhpcy5fZGVza0luZm9HYW1lV2F5KCk7XHJcbiAgICAgICAgdGhpcy5sYWJlbE92ZXJ2aWV3LnN0cmluZyA9IC8qKyBnYW1lV2F5TmFtZSBcIiBcIiArIGdhbWVOdW1iZXJTdHJpbmcgK1wiXFxuXCIrKi9cclxuICAgICAgICBcIuaooeW8jyA6IFwiICsgXCJcIiArIGRlc2tJbmZvLm1heE51bWJlciArIFwi5Lq6XCIgLyorIFwiXFxuIFwiICsgdGhpcy5fZGVza0luZm9KaWFZaVNlSW5mbygpXHJcbiAgICAgICAgKyBcIu+8jFwiICArIHRoaXMuX2Rlc2tJbmZvR3VpUGFpSW5mbygpKi87XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYr+WQpuaYr+maj+acuuaIv1xyXG4gICAgX2lzUmFuZG9tUm9vbTogZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAodGhpcy5fZGVza0luZm8gPT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy5fZGVza0luZm8uaXNSYW5kb21EZXNrO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmK/lkKbmiYDmnInlsYDmlbDpg73nlKjlrozkuoZcclxuICAgIF9pc1RvdGFsR2FtZU92ZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5pc0Rlc2tPdmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB0aGlzLl9kZXNrSW5mby5tTWF4IDw9IHRoaXMuX2Rlc2tJbmZvLmNJbmRleDtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5piv5ZCm5bey6Kej5pWj5oi/6Ze0XHJcbiAgICBfaXNEaXNzdmxlZFJvb206IGZ1bmN0aW9uICgpIHtcclxuICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc2tJbmZvLmRpc3NvbHZlU3RhdHVzO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vLy8g5q+U54mM6YC76L6RXHJcbiAgICAvLyDlvIDlp4vmr5TniYxcclxuICAgIF9zdGFydENvbXBhcmVDYXJkczogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIuaJk+WNsGRhdGHkv6Hmga9cIik7XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2dvbmdYaU5pU2hvdyhmYWxzZSk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIHRoaXMuX3BsYXllcnMgPSBkYXRhLmRhdGEucGxheWVycztcclxuICAgICAgbGV0IHVzZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5U3RhcnRDb21wYXJlKHVzZXIuc2V4KTtcclxuXHJcbiAgICAgIHRoaXMuc3RhcnRDb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xyXG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fc2hvd0NvbXBhcmVDYXJkRGV0YWlscyhkYXRhKTtcclxuICAgICAgfS5iaW5kKHRoaXMpLCAyLjApO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2hvd0NvbXBhcmVDYXJkRGV0YWlsczogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAvL3ZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy90aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAvLyAgICBwbGF5ZXJDb21wLnJlYWR5VG9Db21wYXJlQ2FyZHMoKTtcclxuICAgICAgICAvL30pO1xyXG4gICAgICAgIC8vbGV0IGNvbXBhcmVQbGF5ZXJzID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgIC8vICAgIGlmKHBsYXllci51c2VySWQgPT0gbnVsbCkge1xyXG4gICAgICAgIC8vICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vICAgIGZvcih2YXIgaSBpbiBfdGhpcy5fcGxheWVycykge1xyXG4gICAgICAgIC8vICAgICAgICBpZihfdGhpcy5fcGxheWVyc1tpXS5pZCA9PSBwbGF5ZXIudXNlcklkKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICBpZihfdGhpcy5fcGxheWVyc1tpXS5jYXJkSW5mby5sZW5ndGggPD0gMSkge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgIC8v5bCG5piv54m55q6K54mM55qE546p5a625a2Y6LW35p2lXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgaWYoX3RoaXMuX3BsYXllcnNbaV0uY2FyZEluZm8ubGVuZ3RoID09IDEpe1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICBfdGhpcy50ZVNodVBsYXlJZCA9IF90aGlzLl9wbGF5ZXJzW2ldLmlkO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgICAgICBlbHNlIGlmKF90aGlzLl9wbGF5ZXJzW2ldLmNhcmRJbmZvLmxlbmd0aCA9PSAzKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgLy8gICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgICAgIH1cclxuICAgICAgICAvLyAgICB9XHJcbiAgICAgICAgLy99KTtcclxuICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICAgICAgcGxheWVyQ29tcC5yZWFkeVRvQ29tcGFyZUNhcmRzKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBjb21wYXJlUGxheWVycyA9IHRoaXMuX3BsYXllckNvbXBvbmVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBsYXllci5ub2RlLmFjdGl2ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy5fc2hvd0NvbXBhcmVDYXJkU3RlcCgwLCBjb21wYXJlUGxheWVycyk7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLl9zaG93Q29tcGFyZUNhcmRTdGVwKDAsIGNvbXBhcmVQbGF5ZXJzKTtcclxuICAgICAgICB9LCBkdXJhdGlvbik7XHJcblxyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2VsZi5fc2hvd0NvbXBhcmVDYXJkU3RlcCgwLCBjb21wYXJlUGxheWVycyk7XHJcbiAgICAgICAgfSwgZHVyYXRpb24gKiAyKTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5aaC5p6c5pyJ54m55q6K54mM55qE6K+d5bCx5pS55Y+Y5pe26Ze0IGR1cmF0aW9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHBsYXllcnM9ZGF0YS5kYXRhLnBsYXllcnM7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aSA8IHBsYXllcnMubGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgIHZhciBzPXBsYXllcnNbaV07XHJcbiAgICAgICAgICAgIGlmKHMuY2FyZEluZm8ubGVuZ3RoID09IDEpe1xyXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gKz0gMS41O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICogMyArIDAuNTtcclxuICAgICAgICBsZXQgc2hvb3REdXJhdGlvbiA9IDEuNTtcclxuXHJcbiAgICAgICAgbGV0IHNob290RGF0YXMgPSB0aGlzLl9zaG9vdERhdGFzKCkgfHwgW107XHJcblxyXG4gICAgICAgIGxldCBzaG90RGF0YSA9IHRoaXMuX3Nob3REYXRhKCkgfHwgW107XHJcblxyXG4gICAgICAgIGxldCBob21lUnVuVXNlcklkID0gdGhpcy5faG9tZVJ1blVzZXJJZCgpO1xyXG5cclxuICAgICAgICB2YXIgc2hvdERhdGFUaW1lcyA9IDA7XHJcbiAgICAgICAgc2hvdERhdGEuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSwgaW5kZXgpIHtcclxuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5wbGF5U2hvb3QoZGF0YS5mcm9tVXNlcklkLCBkYXRhLnRvVXNlcklkKTtcclxuICAgICAgICAgICAgfSwgZHVyYXRpb24gKyBpbmRleCAqIHNob290RHVyYXRpb24pO1xyXG4gICAgICAgICAgICBzaG90RGF0YVRpbWVzKz0xO1xyXG4gICAgICAgICAgICBkdXJhdGlvbis9MTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZihob21lUnVuVXNlcklkLmxlbmd0aCA+PSAxKXtcclxuICAgICAgICAgICAgc2hvb3REYXRhcy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucGxheVNob290KGRhdGEuZnJvbVVzZXJJZCwgZGF0YS50b1VzZXJJZCk7XHJcbiAgICAgICAgICAgICAgICB9LCBkdXJhdGlvbiArIChpbmRleCArIHNob3REYXRhVGltZXMpICogc2hvb3REdXJhdGlvbik7XHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbis9MTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICsgc2hvb3REYXRhcy5sZW5ndGggKiBzaG9vdER1cmF0aW9uICsgc2hvdERhdGEubGVuZ3RoICogc2hvb3REdXJhdGlvbjtcclxuXHJcbiAgICAgICAgaWYgKGhvbWVSdW5Vc2VySWQgPiAwKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYucGxheUhvbWVSdW4oaG9tZVJ1blVzZXJJZCk7XHJcbiAgICAgICAgICAgIH0sIGR1cmF0aW9uKTtcclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiArIDEuMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChob21lUnVuVXNlcklkKSB7XHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyAxO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIC8v5pi+56S657uT5p6cXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLl9zaG93Q29tcGFyZUNhcmRGaW5pc2hlZCgpO1xyXG4gICAgICAgIH0sIGR1cmF0aW9uKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob3dDb21wYXJlQ2FyZFN0ZXA6IGZ1bmN0aW9uIChzdGFydFRpbWUgPSAwLCBjb21wYXJlUGxheWVycyA9IFtdKSB7XHJcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gc3RhcnRUaW1lO1xyXG4gICAgICAgIGxldCBpbnRlcnZhbCA9IDE7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICBjb21wYXJlUGxheWVycyA9IGNvbXBhcmVQbGF5ZXJzLnNvcnQoZnVuY3Rpb24gKHBsYXllcjEsIHBsYXllcjIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBsYXllcjEubmV4dENvbXBhcmVTY29yZSgpIC0gcGxheWVyMi5uZXh0Q29tcGFyZVNjb3JlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8g5bmy5o6J54m55q6K54mM55qE5pe26Ze0XHJcbiAgICAgICAgdmFyIGNvPWNvbXBhcmVQbGF5ZXJzO1xyXG4gICAgICAgIGZvcih2YXIgaT0wO2kgPCBjby5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdmFyIHM9Y29baV0uX3VzZXJJbmZvO1xyXG4gICAgICAgICAgICBpZihzLmlzQ29udGFpbkV4dHJhKXtcclxuICAgICAgICAgICAgICAgIGNvLnNwbGljZShpLDEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY28uZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHBsYXllci5zaG93TmV4dENvbXBhcmVDYXJkcygpO1xyXG4gICAgICAgICAgICB9LCBkdXJhdGlvbik7XHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyBpbnRlcnZhbDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGR1cmF0aW9uO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaXNHYW1lT3ZlcjogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8g5q+U54mM5a6M5oiQ5ZCO5Lya6LCD55So55qE5pa55rOVXHJcbiAgICBfc2hvd0NvbXBhcmVDYXJkRmluaXNoZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fc2hvd09uZUdhbWVSZXN1bHQoKTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzLnB1c2godGhpcy5fZGVza0luZm8uY0luZGV4KTtcclxuICAgICAgICAvKiovXHJcbiAgICB9LFxyXG5cclxuICAgIC8vbmV0d29ya1xyXG4gICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZyA9IFwi572R57uc6ZO+5o6l5pat5byA77yM6YeN5paw6L+e5o6l5LitLi4uXCIpIHtcclxuICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgJiYgdGhpcy5uZXR3b3JrTm9kZS5hY3RpdmUpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5ydW5BY3Rpb24ocmVtb3ZlU2VsZkFjdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5uZXR3b3JrTm9kZSk7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLm5ldHdvcmtOb2RlID0gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgaGlkZGVuTmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzaG93QWxlcnRNZXNzYWdlOiBmdW5jdGlvbihtc2csIGF1dG9EaXNtaXNzKSB7XHJcbiAgICAgIGxldCBhbGVydENvbXAgPSB0aGlzLmFsZXJ0LmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgaWYgKCF0aGlzLmFsZXJ0LmFjdGl2ZSkge1xyXG4gICAgICAgIGFsZXJ0Q29tcC5hbGVydCgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhbGVydENvbXAuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICBhbGVydENvbXAudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICBpZiAoYXV0b0Rpc21pc3MpIHtcclxuICAgICAgICBhbGVydENvbXAuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIGFsZXJ0Q29tcC5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfSwgNSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy9jaGVja05vZGVcclxuICAgIHNob3dDaGVja01lc3NhZ2U6ZnVuY3Rpb24obXNnID0gJ+ajgOafpee9kee7nOS4rS4uLicpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hlY2tOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5jaGVja05vZGUpO1xyXG4gICAgICAgIHZhciBjb21wID0gdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYuY2hlY2tOb2RlID0gbnVsbDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xyXG4gICAgICAgIGNvbXAuYWxlcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgaGlkZGVuQ2hlY2tNZXNzYWdlOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrTm9kZSAhPSBudWxsICYmIHRoaXMuY2hlY2tOb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8vLy8gIOiBiuWkqeivremfs+mAu+i+kVxyXG4gICAgX3JlZ2lzdGVyVm9pY2VOb2RlRXZlbnRzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgbGV0IGNoYXRWb2ljZU5vZGUgPSB0aGlzLmJ0bkNoYXRWb2ljZS5ub2RlO1xyXG4gICAgICB0aGlzLmVuZFJlY29yZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gc2VsZi5lbmRSZWNvcmRUaW1lID49IDEwMDApIHtcclxuICAgICAgICAgICAgICAgIHNlbGYubmF0aXZlUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnZvaWNlUmVjb3JkQW5pbWF0aW9uTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEuMik7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoc2VsZi5faXNSZWNvcmRpbmcpIHtcclxuICAgICAgICAgIHNlbGYuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgICAgICAgICBzZWxmLnZvaWNlUmVjb3JkQW5pbWF0aW9uTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEpO1xyXG4gICAgICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICB9KTtcclxuICAgICAgY2hhdFZvaWNlTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICBpZiAoc2VsZi5faXNSZWNvcmRpbmcpIHtcclxuICAgICAgICAgIHNlbGYuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuX2lzUmVjb3JkaW5nID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBzZWxmLm5hdGl2ZUVuZFJlY29yZEFjdGlvbigpO1xyXG4gICAgICAgICAgICBzZWxmLnZvaWNlUmVjb3JkQW5pbWF0aW9uTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5zY2FsZVRvKDAuMTIsIDEpO1xyXG4gICAgICAgICAgICBzZWxmLmJ0bkNoYXRWb2ljZS5ub2RlLnJ1bkFjdGlvbihhY3Rpb24pO1xyXG4gICAgICB9KTtcclxuICAgICAgU29ja2V0Lmluc3RhbmNlLnVwbG9hZEZpbmlzaCA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgICAgICBsZXQgdXNlcklkID0gc2VsZi5fdXNlcklkO1xyXG4gICAgICAgICAgICBTb2NrZXQuc2VuZEF1ZGlvTWVzc2FnZSh1c2VySWQsIHVybCk7XHJcbiAgICAgICAgICBzZWxmLnBsYXlTcGVha0FuaW1hdGlvbihzZWxmLl91c2VySWQpO1xyXG4gICAgICB9O1xyXG4gICAgfSxcclxuXHJcbiAgICBuYXRpdmVSZWNvcmRBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJyZWNvcmRcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZCBjb20ubGxpbmcucWlhbmppYW5nbHpnXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJyZWNvcmRcIiwgXCIoKVZcIik7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYXVzZU11c2ljKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBuYXRpdmVFbmRSZWNvcmRBY3Rpb246ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJlbmRSZWNvcmRcIik7XHJcbiAgICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZW5kUmVjb3JkXCIsIFwiKClWXCIpO1xyXG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucmVzdW1lTXVzaWMoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlBdWRpb1VybDpmdW5jdGlvbih1cmwpIHtcclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInBsYXlVcmw6XCIsdXJsKTtcclxuICAgICAgICB9IGVsc2UgaWYoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWRcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInBsYXlVcmxcIiwgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIiwgdXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6ICDpgIDlh7rmuLjmiI/pgLvovpFcclxuICAgIF9oYW5kbGVVcGRhdGVEZXNrSW5mb0Fib3V0RXhpdFJvb206IGZ1bmN0aW9uKGRlc2tJbmZvKSB7XHJcbiAgICAgIGlmICghZGVza0luZm8uaXNEaXNzb2x2aW5nKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgZGlzc29sdmVMZWZ0VGltZSA9IGRlc2tJbmZvLmRpc3NvbHZlTGVmdFRpbWUgfHwgMTIwO1xyXG4gICAgICBsZXQgZGlzc29sdmVVc2VySWQgPSBkZXNrSW5mby5kaXNzb2x2ZVVzZXJJZDtcclxuICAgICAgaWYgKGRpc3NvbHZlVXNlcklkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDb25maXJtQnV0dG9uLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgYWxlcnQuc2V0TWVzc2FnZShcIuaCqOato+WcqOeUs+ivt+WNj+WVhumAgOWHuu+8jOetieW+heWFtuS7lueOqeWutuWQjOaEj1wiKTtcclxuICAgICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RhcnRDb3VudGRvd24oZGlzc29sdmVMZWZ0VGltZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgZGlzc29sdmVBbnN3ZXJJbmZvcyA9IGRlc2tJbmZvLmRpc3NvbHZlQW5zd2VySW5mbztcclxuICAgICAgbGV0IGN1cnJlbnRVc2VySWRJbmRleCA9IGRlc2tJbmZvLnBsYXllcnNJbmRleC5maW5kSW5kZXgoZnVuY3Rpb24odXNlcklkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJJZCA9PSB1c2VySWQ7XHJcbiAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICBsZXQgYW5zd2VyUmVzdWx0ID0gZGlzc29sdmVBbnN3ZXJJbmZvc1tjdXJyZW50VXNlcklkSW5kZXhdO1xyXG4gICAgICBpZiAoYW5zd2VyUmVzdWx0ID09IC0xKSB7XHJcbiAgICAgICAgLy8gLTEg6KGo56S65pyq5aSE55CGICAwIOihqOekuuaLkue7nSAgMeihqOekuuWQjOaEj1xyXG4gICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgbGV0IGNvdW50ZG93biA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKTtcclxuICAgICAgICBjb3VudGRvd24uc3RhcnRDb3VudGRvd24oZGlzc29sdmVMZWZ0VGltZSwgZnVuY3Rpb24oaXNUaW1lb3V0KSB7XHJcbiAgICAgICAgICBpZiAoaXNUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpY2tBZ3JlZU90aGVyUGxheWVyRXhpdCgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOehruWumuimgeW8uuWItumAgOWHuua4uOaIj1xyXG4gICAgY2xpY2tCdXR0b246IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhbmltID0gdGhpcy5idG5CdXR0b25Ob2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xyXG4gICAgICAgIGlmKHRoaXMuYnRuQnV0dG9ucy5yb3RhdGlvbiA9PSAyNzApe1xyXG4gICAgICAgICAgICBhbmltLnBsYXkoJ3RvcFJpZ2h0QnV0dG9uc0xheW91dCcpO1xyXG4gICAgICAgICAgICB0aGlzLmJ0bkJ1dHRvbnMucm90YXRpb24gPSA5MDtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgLy9hbmltLnN0b3AoJ3RvcFJpZ2h0QnV0dG9uc0xheW91dCcpO1xyXG4gICAgICAgICAgICB0aGlzLmJ0bkJ1dHRvbk5vZGUueCA9IDg5MTtcclxuICAgICAgICAgICAgdGhpcy5idG5CdXR0b25zLnJvdGF0aW9uID0gMjcwO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8g56Gu5a6a6KaB5by65Yi26YCA5Ye65ri45oiPXHJcbiAgICBjbGlja0NvbmZpcm1Gb3JjZUV4aXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICBTb2NrZXQuc2VuZEZvcmNlRXhpdFJvb20odGhpcy5fdXNlcklkKTtcclxuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOehruiupOivt+axgumAgOWHuua4uOaIj1xyXG4gICAgY2xpY2tDb25maXJtUmVxdWVzdEV4aXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q2FuY2VsQnV0dG9uLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgIGxldCBhbGVydCA9IHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICBhbGVydC5zZXRNZXNzYWdlKFwi5oKo5q2j5Zyo55Sz6K+35Y2P5ZWG6YCA5Ye677yM562J5b6F5YW25LuW546p5a625ZCM5oSPXCIpO1xyXG4gICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RhcnRDb3VudGRvd24oMTIwKTtcclxuXHJcbiAgICAgIFNvY2tldC5zZW5kTGVhdmVEZXNrKHRoaXMuX3VzZXJJZCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOWQjOaEj+S7luS6uumAgOWHulxyXG4gICAgY2xpY2tBZ3JlZU90aGVyUGxheWVyRXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuXHJcbiAgICAgIFNvY2tldC5zZW5kQW5zd2VyRGlzc29sdmUodGhpcy5fdXNlcklkLCAxKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5LiN5ZCM5oSP5LuW5Lq66YCA5Ye6XHJcbiAgICBjbGlja0Rpc2FncmVlT3RoZXJQbGF5ZXJFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgICBTb2NrZXQuc2VuZEFuc3dlckRpc3NvbHZlKHRoaXMuX3VzZXJJZCwgMCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOmakOiXj+ivt+axgumAgOWHuiBOb2RlXHJcbiAgICBfaGlkZVJlcWVzdEV4aXROb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlmICghdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdG9wKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vLy8g5omT5p6qXHJcbiAgICBwbGF5U2hvb3Q6IGZ1bmN0aW9uIChmcm9tVXNlcklkLCB0b1VzZXJJZCkge1xyXG4gICAgICBsZXQgdXNlciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQoZnJvbVVzZXJJZCk7XHJcbiAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlIdW1hbkRhUWlhbmcodXNlci5zZXgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgdG9Vc2VySW5kZXggPSB0aGlzLl9maW5kUGxheWVySW5kZXhCeVVzZXJJZCh0b1VzZXJJZCk7XHJcblxyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgIHBsYXllci5wbGF5U2hvb3RBbmltYXRpb24oZnJvbVVzZXJJZCwgdG9Vc2VySW5kZXgpO1xyXG4gICAgICAgIHBsYXllci5wbGF5QnVsbGV0SG9sZUFuaW1hdGlvbih0b1VzZXJJZCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmkq3mlL7lhajlnpLmiZPliqjmlYhcclxuICAgIHBsYXlIb21lUnVuOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgIGxldCB1c2VyID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh1c2VySWQpO1xyXG4gICAgICBpZiAodXNlcikge1xyXG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5SG9tZVJ1bih1c2VyLnNleCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgcGxheWVyLnBsYXlIb21lUnVuQWltYXRpb24odXNlcklkKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIHBsYXlTcGVha0FuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgIHBsYXllci5wbGF5U3BlYWtBbmltYXRpb24odXNlcklkKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zaG9vdERhdGFzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IGhvbWVSdW5Vc2VySWQgPSB0aGlzLl9ob21lUnVuVXNlcklkKCk7IC8vIOWFqOWekuaJk1xyXG4gICAgICAgIGxldCBzaG9vdERhdGFzID0gdGhpcy5fZGVza0luZm8uc2hvdERhdGEuZmlsdGVyKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmZyb21Vc2VySWQgPT0gaG9tZVJ1blVzZXJJZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2hvb3REYXRhcztcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob3REYXRhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IGhvbWVSdW5Vc2VySWQgPSB0aGlzLl9ob21lUnVuVXNlcklkKCk7IC8vIOaJk+aeqlxyXG4gICAgICAgIGxldCBzaG90RGF0YSA9IHRoaXMuX2Rlc2tJbmZvLnNob3REYXRhLmZpbHRlcihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YS5mcm9tVXNlcklkICE9IGhvbWVSdW5Vc2VySWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHNob3REYXRhO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaG9tZVJ1blVzZXJJZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fZGVza0luZm8uYWxsU2hvdERhdGE7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IOaIv+mXtOS/oeaBr+mDqOWIhlxyXG5cclxuICAgIC8vIOiOt+WPluaIv+mXtOeahOeOqeazlVxyXG4gICAgX2Rlc2tJbmZvR2FtZVdheTogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzM7XHJcbiAgICAgIGlmKHNldHRpbmcgPT0gbnVsbCl7XHJcbiAgICAgICAgICBzZXR0aW5nID0gMjtcclxuICAgICAgfVxyXG4gICAgICBsZXQgbmFtZXMgPSBbXCLluoTlrrbmqKHlvI9cIiwgXCLml6DnibnmrorniYxcIixcIuaZrumAmuaooeW8j1wiXTtcclxuICAgICAgcmV0dXJuIG5hbWVzW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9OdW1iZXJPZkdhbWU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxO1xyXG4gICAgICBsZXQgaW5mb3MgPSBbJzEw5bGAJywgJzIw5bGAJywgJzQw5bGAJywgJzXlsYAnXTtcclxuICAgICAgLyppZiAoc2V0dGluZyA8PSAxKSB7XHJcbiAgICAgICAgcmV0dXJuICfmnaHmlbDvvJonICsgaW5mb3Nbc2V0dGluZ107XHJcbiAgICAgIH0qL1xyXG4gICAgICBpZihzZXR0aW5nID09IDIpe1xyXG4gICAgICAgICAgc2V0dGluZyA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZihzZXR0aW5nID09IDMpe1xyXG4gICAgICAgICAgc2V0dGluZyA9IDE7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZihzZXR0aW5nID09IDQpe1xyXG4gICAgICAgICAgc2V0dGluZyA9IDI7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZihzZXR0aW5nID09IDUpe1xyXG4gICAgICAgICAgc2V0dGluZyA9IDM7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuICflsYDmlbDvvJonICsgaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb051bWJlck9mUGVvcGxlOiBmdW5jdGlvbigpIHtcclxuICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nMjtcclxuICAgICAgbGV0IGluZm9zID0gWycy5Lq6JywgJzPkuronLCAnNOS6uicsICc15Lq6J107XHJcbiAgICAgIHJldHVybiBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvUGF5SW5mbzogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzQ7XHJcbiAgICAgIGlmKHNldHRpbmcgPT0gbnVsbCl7XHJcbiAgICAgICAgICBzZXR0aW5nID0gMDtcclxuICAgICAgfVxyXG4gICAgICBpZihzZXR0aW5nID09IDApe1xyXG4gICAgICAgICAgc2V0dGluZyA9IDE7XHJcbiAgICAgIH1cclxuICAgICAgbGV0IGluZm9zID0gWyfmiL/kuLvpnLjkuLvluoQnLCAn5oi/6LS5QUEnXTtcclxuICAgICAgcmV0dXJuIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9KaWFZaVNlSW5mbzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nNyA9PSAwID8gMSA6IDA7XHJcbiAgICAgICAgbGV0IGluZm9zID0gWyfml6DlpJrkuIDoibInLCAn5aSa5LiA6ImyJ107XHJcbiAgICAgICAgcmV0dXJuIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9HdWlQYWlJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZztcclxuICAgICAgICBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nOCA9PSBudWxsKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzggPT0gMCl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc4ID09IDEpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGluZm9zID0gWyfml6DnjovniYwnLCAn5Lik5byg546L54mMJywgJ+Wbm+W8oOeOi+eJjCddO1xyXG4gICAgICAgIHJldHVybiBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzog5Ymp5L2Z5pe26Ze0XHJcbiAgICBfcmVtYWluVGltZVN0YXJ0VXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgLy90aGlzLnNjaGVkdWxlKHRoaXMuX3JlbWFpblRpbWVVcGRhdGUsIDEuMCwgY2MubWFjcm8uUkVQRUFUX0ZPUkVWRVIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVtYWluVGltZVVwZGF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSB8fCBQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGhpcy5fZGVza0luZm8gPT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBpc1Rhb1NodSA9ICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSA9PSAwKSB8fCAodGhpcy5fZGVza0luZm8uc2V0dGluZzEgPT0gMSk7XHJcbiAgICAgIGlmIChpc1Rhb1NodSkge1xyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIXRoaXMuX2Rlc2tJbmZvLmNyZWF0ZVRpbWUpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgbGV0IGNyZWF0ZVRpbWUgPSBmZWNoYS5wYXJzZSh0aGlzLl9kZXNrSW5mby5jcmVhdGVUaW1lLCAnWVlZWS1NTS1ERCBISDptbTpzcycpLmdldFRpbWUoKTtcclxuICAgICAgbGV0IG9uZUhvdXIgPSA2MCAqIDYwO1xyXG4gICAgICBsZXQgcmVtYWluID0gKERhdGUubm93KCkgLSBjcmVhdGVUaW1lKSAvIDEwMDA7XHJcbiAgICAgIHJlbWFpbiA9IE1hdGgubWF4KG9uZUhvdXIgLSByZW1haW4sIDApO1xyXG5cclxuICAgICAgbGV0IG1pbnMgPSBNYXRoLmZsb29yKHJlbWFpbiAvIDYwKTtcclxuICAgICAgbGV0IHNlY3MgPSBNYXRoLmZsb29yKHJlbWFpbiAlIDYwKTtcclxuICAgICAgaWYgKG1pbnMgPT0gMCAmJiBzZWNzID09IDApIHtcclxuICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIG1pbnNTdHJpbmcgPSBcIlwiICsgbWlucztcclxuICAgICAgaWYgKG1pbnNTdHJpbmcubGVuZ3RoIDwgMikge1xyXG4gICAgICAgIG1pbnNTdHJpbmcgPSBcIjBcIiArIG1pbnNTdHJpbmc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBzZWNzU3RyaW5nID0gXCJcIiArIHNlY3M7XHJcbiAgICAgIGlmIChzZWNzU3RyaW5nLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICBzZWNzU3RyaW5nID0gXCIwXCIgKyBzZWNzU3RyaW5nO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgc3RyaW5nID0gXCLliankvZnml7bpl7TvvJowMDpcIiArIG1pbnNTdHJpbmcgKyBcIjpcIiArIHNlY3NTdHJpbmc7XHJcbiAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IHN0cmluZztcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzog5aSE55CG5ZCMIElQIOeahOeUqOaIt1xyXG4gICAgX2hhbmRsZVRoZVNhbWVPZklQQWRyZXNzOiBmdW5jdGlvbih1c2VySW5mb3MpIHtcclxuICAgICAgaWYgKCF1c2VySW5mb3MgfHwgdXNlckluZm9zLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgaXBVc2VySW5mb3MgPSB1c2VySW5mb3MucmVkdWNlKGZ1bmN0aW9uKGlwcywgdXNlckluZm8pIHtcclxuICAgICAgICBsZXQgdXNlcnMgPSBpcHNbdXNlckluZm8uaXBBZGRyZXNzXSB8fCBbXTtcclxuICAgICAgICB1c2Vycy5wdXNoKHVzZXJJbmZvKTtcclxuXHJcbiAgICAgICAgaXBzW3VzZXJJbmZvLmlwQWRkcmVzc10gPSB1c2VycztcclxuICAgICAgICByZXR1cm4gaXBzO1xyXG4gICAgICB9LCB7fSk7XHJcblxyXG4gICAgICBsZXQgc2FtZUlwVXNlcnMgPSBudWxsO1xyXG4gICAgICBmb3IgKGxldCBpcCBpbiBpcFVzZXJJbmZvcykge1xyXG4gICAgICAgIGxldCB1c2VycyA9IGlwVXNlckluZm9zW2lwXTtcclxuICAgICAgICBpZiAodXNlcnMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgc2FtZUlwVXNlcnMgPSB1c2VycztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHNhbWVJcFVzZXJzID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuX2FsZXJ0U2FtZUlwVXNlckluZm9zKHNhbWVJcFVzZXJzKTtcclxuICAgIH0sXHJcblxyXG4gICAgX2FsZXJ0U2FtZUlwVXNlckluZm9zOiBmdW5jdGlvbih1c2Vycykge1xyXG4gICAgICBsZXQgbWVzc2FnZSA9IFwiXCI7XHJcbiAgICAgIGxldCB1c2VySWRzID0gXCJcIjtcclxuICAgICAgdXNlcnMuZm9yRWFjaChmdW5jdGlvbih1c2VyLCBpbmRleCkge1xyXG4gICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlICsgKGluZGV4ID4gMCA/ICcg5ZKMICcgOiAnJykgKyB1c2VyLm5pY2tuYW1lO1xyXG4gICAgICAgIHVzZXJJZHMgPSB1c2VySWRzICsgdXNlci5pZDtcclxuICAgICAgfSk7XHJcbiAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlICsgJyDlnKjlkIzkuIAgSVAg5LiL77yBJztcclxuXHJcbiAgICAgIHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZSA9IHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZSB8fCB7fTtcclxuICAgICAgaWYgKHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZVt1c2VySWRzXSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKG1lc3NhZ2UsIHRydWUpO1xyXG4gICAgICB0aGlzLl9kaWRBbGVydFNhbWVJcE1lc3NhZ2VbdXNlcklkc10gPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbn0pO1xyXG5QbGF5LmdvbmdYaU5pU2hvdyA9IGZ1bmN0aW9uICh0eXBlKSB7XHJcbiAgICB0aGlzLmluc3RhbmNlcy5fZ29uZ1hpTmlTaG93KHR5cGUpO1xyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXk7XHJcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgICAgIHByb2R1Y3RJZDonJyxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuICAgIFxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm9uQ2xpY2tBY3Rpb24odGhpcy5wcm9kdWN0SWQpOyAgICAgICAgXG4gICAgfSxcbiAgICBcbiAgICBvbkNsaWNrQWN0aW9uOmZ1bmN0aW9uKHByb2R1Y3RJZCkge1xuICAgICAgICBcbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBtYXRjaGluZ0xhYmVsOmNjLkxhYmVsLFxuICAgICAgICB0aW1lTm9kZTpjYy5Ob2RlLFxuICAgICAgICBtYXRjaGluZ05vZGU6Y2MuTm9kZSxcbiAgICAgICAgd2FpdGluZ1ByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBhbGVydFByZWZhYjogY2MuUHJlZmFiLFxuXG4gICAgICAgIHRpc2hpOmNjLk5vZGUsXG5cbiAgICAgICAgX3VzZXJJZDogbnVsbCxcbiAgICAgICAgX3Jlc3BvbnNlOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3VzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgIGNjLmlzUm9vbVZpZXdTaG93ID0gdHJ1ZTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVEZXNrSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZURlc2tJbmZvICx0aGlzKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldERpc2Nvbm5lY3QsIHRoaXMuX3NvY2tldERpc2Nvbm5lY3QsIHRoaXMpO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fc29ja2V0Q29ubmVjdGVkLCB0aGlzKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVJbnRlclJhbmRvbSwgdGhpcy5fc29ja2V0UmVjZWl2ZUludGVyUmFuZG9tLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgX3NvY2tldFJlY2VpdmVEZXNrSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0UmVjZWl2ZUludGVyUmFuZG9tOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAvL+acjeWKoeWZqOWPkemAgSAgeydhY3Rpb24nOidpbnRlclJhbmRvbScsJ3Jlc3VsdCc6ZmFsc2UsJ2RhdGEnOnsncmVhc29uJzpyZWFzb259fVxuICAgICAgICB0aGlzLl9yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbik7XG4gICAgICAgIC8vIOWkhOeQhumaj+acuuWcuuWMuemFjeS4jeaIkOWKn+eahOaDheWGtVxuICAgICAgICBpZiAocmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgcmVhc29uID0gcmVzcG9uc2UuZGF0YS5yZWFzb24gfHwgXCLliqDlhaXpmo/mnLrlnLrlpLHotKVcIjtcbiAgICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKHJlYXNvbik7XG5cbiAgICAgICAgaWYgKHJlYXNvbiA9PSAn5L2g5bey57uP5Zyo5Yy56YWN6Zif5YiXJykge1xuICAgICAgICAgICAgdGhpcy5fc2hvd01hdGNoaW5nKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlTWF0Y2hpbmcoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfc29ja2V0RGlzY29ubmVjdDogZnVuY3Rpb24oKSB7XG4gICAgICAvLyDov57mjqXlt7Lmlq3lvIBcbiAgICAgIHRoaXMubWF0Y2hpbmdOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5zaG93TmV0d29ya01lc3NhZ2UoJ+e9kee7nOmTvuaOpeaWreW8gO+8jOmHjeaWsOi/nuaOpeS4rS4uLicpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0Q29ubmVjdGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcbiAgICB9LFxuXG5cbiAgICBvbkRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcbiAgICAgIEtRR2xvYmFsRXZlbnQub2ZmVGFyZ2V0KHRoaXMpO1xuICAgIH0sXG5cbiAgICBjbGlja0V4aXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgfSxcblxuICAgIGNsaWNrU3RhcnQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIFNvY2tldC5zZW5kRW50ZXJSYW5kb20odGhpcy5fdXNlcklkKTtcbiAgICAgIHRoaXMuX3Nob3dNYXRjaGluZygpO1xuXG4gICAgICAvKiMjIyMjYmVnaW4qL1xuICAgICAgLy9yZWFzb27mmK/mnI3liqHlmajlj5HpgIHlm57mnaXnmoRcbiAgICAgIC8qaWYodGhpcy5fcmVzcG9uc2UuZGF0YS5yZWFzb24gPT0gXCLkvaDnmoTpkrvnn7PkuI3otrNcIil7XG4gICAgICAgICAgdGhpcy50aXNoaS5hY3RpdmUgPSB0cnVlO1xuICAgICAgfSovXG4gICAgICAvKiMjIyMjZW5kKi9cblxuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbiwgNSk7XG4gICAgfSxcbiAgICAvKiMjIyMj54K55Ye756m655m95Zyw5pa577yM56CW55+z5LiN6Laz5o+Q56S65raI5aSxKi9cbiAgICAvKm9uQnRuS29uZzpmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMudGlzaGkuYWN0aXZlKXtcbiAgICAgICAgICAgIHRoaXMudGlzaGkuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgLy/ku4DkuYjkuZ/kuI3lgZpcbiAgICAgICAgfVxuICAgIH0sKi9cbiAgICAvKuWPlua2iOWMuemFjSovXG4gICAgY2xpY2tDYW5jZWw6ZnVuY3Rpb24gKCkge1xuICAgICAgU29ja2V0LnNlbmRDYW5jZWxSYW5kb20odGhpcy5fdXNlcklkKTtcblxuICAgICAgdGhpcy5faGlkZU1hdGNoaW5nKCk7XG4gICAgfSxcblxuICAgIF90aW1lb3V0UmFuZG9tQWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5faGlkZU1hdGNoaW5nKCk7XG4gICAgICAgIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZSgn6L+b5YWl5Yy56YWN5aSx6LSlJyk7XG4gICAgfSxcblxuICAgIF9zaG93TWF0Y2hpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubWF0Y2hpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgICAgICB0aGlzLm1hdGNoaW5nTGFiZWwuc3RyaW5nID0gJ+ato+WcqOWMuemFjeS4re+8jOivt+eojeWQji4uLic7XG4gICAgICAgIGxldCBudW0gPSAwO1xuICAgICAgICB0aGlzLnNjaGVkdWxlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbnVtID0gbnVtICsgMC41O1xuICAgICAgICAgICAgdGhpcy50aW1lTm9kZS5yb3RhdGlvbiA9IG51bTtcbiAgICAgICAgIH0sIDAuMDEpO1xuICAgIH0sXG5cbiAgICBfaGlkZU1hdGNoaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm1hdGNoaW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIGNvbXAuZGlzbWlzc0FjdGlvbigpO1xuICAgIH0sXG5cbiAgICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fdGltZW91dFJhbmRvbUFjdGlvbik7XG5cbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHJlbW92ZVNlbGZBY3Rpb24gPSBjYy5yZW1vdmVTZWxmKCk7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xuICAgICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy5uZXR3b3JrTm9kZSk7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgY29tcC5vbkRpc21pc3NDb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5uZXR3b3JrTm9kZSA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIGNvbXAuc2V0TWVzc2FnZShtc2cpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGhpZGRlbk5ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2hvd0FsZXJ0TWVzc2FnZTogZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIGlmICghbXNnKSB7XG4gICAgICAgICAgICBjYy5lcnJvcihcIuS4jeiDveaYvuekuuS4uuepuueahOS/oeaBr1wiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5hbGVydE1lc3NhZ2VOb2RlKSB7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZU5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0UHJlZmFiKTtcbiAgICAgICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLmFsZXJ0TWVzc2FnZU5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IFBsYXliYWNrID0gcmVxdWlyZSgnUGxheWJhY2snKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgdGltZUxhYmVsOmNjLkxhYmVsLFxuICAgICAgICBuaWNrbmFtZUxhYmVsczpbY2MuTGFiZWxdLFxuICAgICAgICBzY29yZUxhYmVsczpbY2MuTGFiZWxdLFxuICAgICAgICBudW1Ob2RlOmNjLkxhYmVsLFxuICAgICAgICBfcGFyZW50SWQ6IG51bGwsXG4gICAgICAgIHBsYXliYWNrTm9kZTpjYy5Ob2RlLC8v5Zue5pS+5oyJ6ZKuXG4gICAgICAgIHdhdGNoTm9kZTpjYy5Ob2RlLC8v5p+l55yL5oyJ6ZKuXG5cbiAgICAgICAgX3JlY29yZEl0ZW1JbmZvOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBzZXRJbmZvOiBmdW5jdGlvbiAocmVjb3JkSW5mbykge1xuICAgICAgdGhpcy5fcGFyZW50SWQgPSByZWNvcmRJbmZvLmlkO1xuICAgICAgdGhpcy5wbGF5YmFja05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLndhdGNoTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgaWYgKHJlY29yZEluZm8ucGxheWVyc0luZm8ubGVuZ3RoID09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgcGxheWVyc0luZm8gPSBKU09OLnBhcnNlKHJlY29yZEluZm8ucGxheWVyc0luZm8pO1xuICAgICAgdGhpcy50aW1lTGFiZWwuc3RyaW5nID0gXCLlr7nmiJjml7bpl7TvvJpcIiArIHBsYXllcnNJbmZvLnRpbWU7XG4gICAgICBmb3IgKHZhciBpID0gMDtpIDwgcGxheWVyc0luZm8ucGxheWVycy5sZW5ndGg7aSsrKSB7XG4gICAgICAgIHRoaXMubmlja25hbWVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc0luZm8ucGxheWVyc1tpXS5uaWNrbmFtZTtcbiAgICAgICAgdGhpcy5zY29yZUxhYmVsc1tpXS5zdHJpbmcgPSBwbGF5ZXJzSW5mby5wbGF5ZXJzW2ldLnRvdGFsU2NvcmU7XG4gICAgICB9XG4gICAgfSxcblxuICAgIGNsaWNrQWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9yZWNvcmRJdGVtSW5mbykge1xuICAgICAgICBjYy5sb2coXCLngrnlh7vkuoborrDlvZXor6bmg4UgaXRlbe+8jOW8gOWQr+WbnuaUvlwiKTtcbiAgICAgICAgdGhpcy5fc3RhcnRQbGF5YmFjayh0aGlzLl9yZWNvcmRJdGVtSW5mby5faW5mbzhBcnJheSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgICBTb2NrZXQuc2VuZEdldEl0ZW1SZWNvcmQoU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkLHRoaXMuX3BhcmVudElkKTtcbiAgICB9LFxuXG4gICAgX3N0YXJ0UGxheWJhY2s6IGZ1bmN0aW9uIChwbGF5QmFja0luZm8pIHtcbiAgICAgIFBsYXliYWNrLmluc3RhbmNlLnNldFBsYXliYWNrRGF0YXMocGxheUJhY2tJbmZvKTtcbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgIH0sXG5cbiAgICBkZXRhaWxBY3Rpb246IGZ1bmN0aW9uKHJlY29yZEl0ZW1JbmZvLCBpbmRleCkge1xuICAgICAgICB0aGlzLl9yZWNvcmRJdGVtSW5mbyA9IHJlY29yZEl0ZW1JbmZvO1xuICAgICAgICB0aGlzLnBsYXliYWNrTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLndhdGNoTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5udW1Ob2RlLnN0cmluZyA9IFwi56ysXCIgKyAoaW5kZXggKyAxKSArIFwi5bGAXCI7XG4gICAgICAgIHRoaXMudGltZUxhYmVsLnN0cmluZyA9IFwi5a+55oiY5pe26Ze077yaXCIgKyByZWNvcmRJdGVtSW5mby5jcmVhdEF0O1xuICAgICAgICBsZXQgb2JqQXJyYXkgPSBKU09OLnBhcnNlKHJlY29yZEl0ZW1JbmZvLmluZm84KTtcbiAgICAgICAgdGhpcy5fcmVjb3JkSXRlbUluZm8uX2luZm84QXJyYXkgPSBvYmpBcnJheTtcbiAgICAgICAgbGV0IHBsYXllcnNBcnJheSA9IG9iakFycmF5Lm1hcChmdW5jdGlvbihzdHIpe1xuICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHN0cik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBwbGF5ZXJzID0gcGxheWVyc0FycmF5W3BsYXllcnNBcnJheS5sZW5ndGgtMV0uZGF0YS5wbGF5ZXJzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDtpIDwgcGxheWVycy5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICB0aGlzLm5pY2tuYW1lTGFiZWxzW2ldLnN0cmluZyA9IHBsYXllcnNbaV0ubmlja25hbWU7XG4gICAgICAgICAgICB0aGlzLnNjb3JlTGFiZWxzW2ldLnN0cmluZyA9IHBsYXllcnNbaV0uY1Njb3JlO1xuICAgICAgICB9XG4gICAgfSxcblxuXG59KTtcbiIsImNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNjcm9sbFZpZXc6Y2MuTm9kZSxcbiAgICAgICAgc3ViU2Nyb2xsVmlldzpjYy5Ob2RlLFxuICAgICAgICByZWNvcmRJdGVtOmNjLlByZWZhYixcbiAgICAgICAgc3ViUmVjb3JkSXRlbTpjYy5QcmVmYWIsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzU3ViUGFnZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQgPSB0aGlzLnNjcm9sbFZpZXcuZ2V0Q29tcG9uZW50KGNjLlNjcm9sbFZpZXcpLmNvbnRlbnQ7XG4gICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlld0NvbnRlbnQgPSB0aGlzLnN1YlNjcm9sbFZpZXcuZ2V0Q29tcG9uZW50KGNjLlNjcm9sbFZpZXcpLmNvbnRlbnQ7XG5cbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJTb2NrZXRFdmVudCgpO1xuICAgIH0sXG5cbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDogZnVuY3Rpb24gKCkge1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuR2V0UmVjb3JkLCB0aGlzLl9SZWNlaXZlUmVjb3JkSW5mbywgdGhpcyk7XG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5HZXRJdGVtUmVjb3JkLCB0aGlzLl9SZWNlaXZlUmVjb3JkSXRlbSwgdGhpcyk7XG4gICAgfSxcblxuICAgIF9SZWNlaXZlUmVjb3JkSW5mbzpmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICB0aGlzLmlzU3ViUGFnZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcblxuICAgICAgICByZXNwb25zZS5kYXRhLmZpbHRlcihmdW5jdGlvbiAocmVjb3JkKSB7XG4gICAgICAgICAgcmV0dXJuIHJlY29yZC5wbGF5ZXJzSW5mby5sZW5ndGggPiAwO1xuICAgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChyZWNvcmRJbmZvKSB7XG4gICAgICAgICAgdmFyIGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnJlY29yZEl0ZW0pO1xuICAgICAgICAgIHRoaXMuc2Nyb2xsVmlld0NvbnRlbnQuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgdmFyIGNvbXAgPSBpdGVtLmdldENvbXBvbmVudCgncmVjb3JkSW5mbycpO1xuICAgICAgICAgIGNvbXAuc2V0SW5mbyhyZWNvcmRJbmZvKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgX1JlY2VpdmVSZWNvcmRJdGVtOmZ1bmN0aW9uKFJlY29yZEl0ZW1JbmZvKSB7XG4gICAgICAgIHRoaXMuaXNTdWJQYWdlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuc2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgUmVjb3JkSXRlbUluZm8uZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnJlY29yZEl0ZW0pO1xuICAgICAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudC5hZGRDaGlsZChpdGVtKTtcbiAgICAgICAgICAgIHZhciBjb21wID0gaXRlbS5nZXRDb21wb25lbnQoJ3JlY29yZEluZm8nKTtcbiAgICAgICAgICAgIHZhciBpbmZvID0gUmVjb3JkSXRlbUluZm8uZGF0YVtpXTtcbiAgICAgICAgICAgIGNvbXAuZGV0YWlsQWN0aW9uKGluZm8sIGkpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNsb3NlQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5pc1N1YlBhZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuaXNTdWJQYWdlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFZpZXcuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XG4gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBzZWxlY3RaaHVhbmdCZzpjYy5Ob2RlLFxuICAgICAgICBzZWxlY3RaaHVhbmdSaWdodDpjYy5Ob2RlLFxuICAgICAgICBzZWxlY3RUZVNodVBhaUJnOmNjLk5vZGUsXG4gICAgICAgIHNlbGVjdFRlU2h1UGFpUmlnaHQ6Y2MuTm9kZSxcbiAgICAgICAgX3podWFuZ1NlbGVjdGVkOm51bGwsICAgLy/luoTlrrbmqKHlvI/mmK/lkKbpgInmi6kgIG51bGzkuLrkuI3pgInmi6nvvIww5Li66YCJ5oupXG4gICAgICAgIF90ZVNodVBhaVNlbGVjdGVkOm51bGwsIC8v5peg54m55q6K54mM5qih5byP5piv5ZCm6YCJ5oupICBudWxs5Li65LiN6YCJ5oup77yMMeS4uumAieaLqVxuICAgICAgICBzZWxlY3RJbmRleDpudWxsLCAgICAgICAvL+aYr+WQpumAieaLqeW6hOWutuaooeW8j+aIluiAheaXoOeJueauiueJjCAgbnVsbOS4uuS4pOiAhemDveS4jemAiSAgMOS4uumAieaLqeS6huW6hOWutuaooeW8jyAgMeS4uumAieaLqeS6huaXoOeJueauiueJjOaooeW8j1xuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICAgICAgLyojIyMjI+eCueWHu+W6hOWutuaooeW8jyovXG4gICAgY2xpY2taaHVhbkppYUt1YW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuX3podWFuZ1NlbGVjdGVkID09IDApe1xuICAgICAgICAgICAgLy/msqHpgInkuIrluoTlrrbmqKHlvI9cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Wmh1YW5nUmlnaHQuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl96aHVhbmdTZWxlY3RlZCA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmKHRoaXMuX3RlU2h1UGFpU2VsZWN0ZWQgPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RJbmRleCA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8v6YCJ5LqG5peg54m55q6K54mM5bCx5LiN6IO96YCJ5bqE5a625qih5byPXG4gICAgICAgICAgICBpZih0aGlzLl90ZVNodVBhaVNlbGVjdGVkID09IDApe1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0SW5kZXggPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYodGhpcy5femh1YW5nU2VsZWN0ZWQgPT0gbnVsbCl7XG4gICAgICAgICAgICAvL+mAieS4iueKtuaAgVxuICAgICAgICAgICAgdGhpcy5zZWxlY3RaaHVhbmdSaWdodC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5femh1YW5nU2VsZWN0ZWQgPSAwO1xuICAgICAgICAgICAgLy/luoTlrrbmqKHlvI/pgInkuIrnmoTml7blgJnml6DnibnmrorniYzlv4XpobvkuLrkuI3pgIlcbiAgICAgICAgICAgIGlmKHRoaXMuX3RlU2h1UGFpU2VsZWN0ZWQgPT0gMCl7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RUZVNodVBhaVJpZ2h0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RlU2h1UGFpU2VsZWN0ZWQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZWxlY3RJbmRleCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2codGhpcy5zZWxlY3RJbmRleCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vml6DnibnmrorniYznmoTpgInmi6nmoYYqL1xuICAgIGNsaWNrVGVTaHVQYWlLdWFuZzogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZih0aGlzLl90ZVNodVBhaVNlbGVjdGVkID09IDApe1xuICAgICAgICAgICAgLy/msqHpgInkuIpcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0VGVTaHVQYWlSaWdodC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3RlU2h1UGFpU2VsZWN0ZWQgPSBudWxsO1xuXG4gICAgICAgICAgICAvL+WmguaenOW6hOWutuaooeW8j+S5n+ayoemAieS4ilxuICAgICAgICAgICAgaWYodGhpcy5femh1YW5nU2VsZWN0ZWQgPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RJbmRleCA9IG51bGw7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEluZGV4ID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIC8v54K55Ye755qE5pe25YCZ5oqK5Yu+5Y+35omT5byA77yM5bCx5piv6YCJ5LiK54q25oCBXG4gICAgICAgIGVsc2UgaWYodGhpcy5fdGVTaHVQYWlTZWxlY3RlZCA9PSBudWxsKXtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0VGVTaHVQYWlSaWdodC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fdGVTaHVQYWlTZWxlY3RlZCA9IDA7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdEluZGV4ID0gMTtcblxuICAgICAgICAgICAgaWYodGhpcy5femh1YW5nU2VsZWN0ZWQgPT0gMCl7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RaaHVhbmdSaWdodC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLl96aHVhbmdTZWxlY3RlZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RJbmRleCA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2codGhpcy5zZWxlY3RJbmRleCk7XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBmb286IHtcclxuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcclxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XHJcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXHJcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxyXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcclxuICAgICAgICAvLyB9LFxyXG4gICAgICAgIC8vIC4uLlxyXG4gICAgICAgIHBhaTpjYy5Ob2RlLFxyXG4gICAgICAgIG1hcGFpOntcclxuICAgICAgICAgICAgZGVmYXVsdDpbXSxcclxuICAgICAgICAgICAgdHlwZTpjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0TWEgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwic2VsZWN0X21hXCIpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0TWEub25Mb2FkKCk7XHJcbiAgICAgICAgdGhpcy5jb20gPSB0aGlzLnBhaS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIGNsaWNrQnRuQ29tZmlybTpmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmNvbS5zcHJpdGVGcmFtZSA9IHRoaXMubWFwYWlbY2MuZnJvbS5tYV07XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLmNvbS5zcHJpdGVGcmFtZSk7XHJcbiAgICB9LFxyXG4gICAgXHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHJpZ2h0SWNvbjpbY2MuTm9kZV0sXG4gICAgICAgIG1hcGFpUmlnaHQ6Y2MuTm9kZVxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYoY2MuZnJvbSA9PSBudWxsKXtcbiAgICAgICAgICAgIGNjLmZyb20gPSB7fTtcbiAgICAgICAgfVxuICAgICAgICAvL+WmguaenOS4jeW4pumprO+8jOWImemprOeJjOS4uuepulxuICAgICAgICBpZih0aGlzLm1hcGFpUmlnaHQuYWN0aXZlID09IGZhbHNlKXtcbiAgICAgICAgICAgIGNjLmZyb20uaXNVc2VNYSA9IGZhbHNlO1xuICAgICAgICAgICAgY2MuZnJvbS5tYSA9IG51bGw7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gdHJ1ZTtcbiAgICAgICAgICAgIC8v5ZCm5YiZ6ams54mM6buY6K6k5Li656ysMOS4qu+8jOWNs+m7keahgzVcbiAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5yaWdodEljb24ubGVuZ3RoO2krKykge1xuICAgICAgICAgICAgaWYoaT09MCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRJY29uW2ldLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLnJpZ2h0SWNvbltpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmlnaHRJY29uW2ldLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0sXG4gICAgb25NYVBhaUNsaWNrOmZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIHRhcmdldE5hbWUgPSBlLnRhcmdldC5uYW1lO1xuICAgICAgICBjYy5sb2codGFyZ2V0TmFtZSlcbiAgICAgICAgaWYodGFyZ2V0TmFtZSAhPSB0aGlzLnNlbGVjdC5wYXJlbnQubmFtZSkge1xuICAgICAgICAgICAgaWYodGFyZ2V0TmFtZSA9PSBcInNlbGVjdF9rdWFuZzFcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5yaWdodEljb25bMl07XG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRhcmdldE5hbWUgPT0gXCJzZWxlY3Rfa3VhbmcyXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uWzFdO1xuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZih0YXJnZXROYW1lID09IFwic2VsZWN0X2t1YW5nM1wiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLnJpZ2h0SWNvblswXTtcbiAgICAgICAgICAgICAgICBjYy5mcm9tLm1hID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5yaWdodEljb24ubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodEljb25baV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbGVjdC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKGNjLmZyb20ubWEpO1xuICAgIH1cblxuXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGJnTm9kZTpjYy5Ob2RlLCAgIC8v6YCJ5oup5qGGXG4gICAgICAgIHNlbGVjdGVkTm9kZTpjYy5Ob2RlLCAgLy/lr7nlj7dcbiAgICAgICAgcGFpOmNjLk5vZGUsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICB9LFxuICAgIFxuICAgIGNsaWNrQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gIXRoaXMuc2VsZWN0ZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XG4gICAgfSxcbiAgICBcbiAgICBzZXRTZWxlY3RlZDpmdW5jdGlvbihzZWxlY3RlZCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gc2VsZWN0ZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XG4gICAgfSxcblxuXG4gICAgLyojIyMjIyovXG4gICAgY2xpY2tTZWxlY3RLdWFuZzpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICF0aGlzLnNlbGVjdGVkO1xuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPSB0aGlzLnNlbGVjdGVkO1xuICAgICAgICBjYy5mcm9tLmlzVXNlTWEgPSB0aGlzLnNlbGVjdGVkO1xuICAgICAgICB2YXIgbWFwYWlDb20gPSB0aGlzLnBhaS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcbiAgICAgICAgaWYodGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID09PSBmYWxzZSl7XG4gICAgICAgICAgICBtYXBhaUNvbS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBtYXBhaUNvbS5pbnRlcmFjdGFibGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSxcblxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbm9kZXM6W2NjLk5vZGVdLFxuICAgICAgICBzZWxlY3RlZEluZGV4OiAwLFxuICAgIH0sXG4vKuWOn+adpeeahCovXG4vKiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBpc1NlbGVjdGVkID0gKHRoaXMuc2VsZWN0ZWRJbmRleCA9PSBpKTtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChpc1NlbGVjdGVkKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0Q29tcCA9IHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgICAgIHRDb21wLmluZGV4ID0gaTtcbiAgICAgICAgICAgIHRDb21wLmNsaWNrQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wID0gc2VsZi5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICBjb21wLnNldFNlbGVjdGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkSW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiovXG4gICAgLyojIyMjKi9cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBpc1NlbGVjdGVkID0gKHRoaXMuc2VsZWN0ZWRJbmRleCA9PSBpKTtcbiAgICAgICAgICAgIHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKS5zZXRTZWxlY3RlZChpc1NlbGVjdGVkKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0Q29tcCA9IHRoaXMubm9kZXNbaV0uZ2V0Q29tcG9uZW50KCdzZWxlY3QnKTtcbiAgICAgICAgICAgIHRDb21wLmluZGV4ID0gaTtcbiAgICAgICAgICAgIHRDb21wLmNsaWNrQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLm5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wID0gc2VsZi5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgICAgICAgICBjb21wLnNldFNlbGVjdGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZCh0cnVlKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkSW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICAgICAgICAgIHNlbGYub25TZWxlY3RDaGFuZ2UodGhpcy5pbmRleCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uU2VsZWN0Q2hhbmdlOiBmdW5jdGlvbiAoc2VsZWN0SW5kZXgpIHtcbiAgICAgICAgY2MubG9nKHNlbGVjdEluZGV4KTtcbiAgICB9LFxuICAgIFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBpbmRpY2F0b3JOb2RlOmNjLk5vZGUsXG4gICAgICAgIGJhY2tncm91bmROb2RlOmNjLk5vZGUsXG4gICAgICAgIHNlbGVjdGVkTm9kZTpjYy5Ob2RlLFxuXG4gICAgICAgIHZhbHVlOjAsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuaW5kaWNhdG9yTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCxmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCxmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIHB0ID0gc2VsZi5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZShjYy52MihldmVudC5nZXRMb2NhdGlvblgoKSxldmVudC5nZXRMb2NhdGlvblkoKSkpO1xuICAgICAgICAgICAgc2VsZi51cGRhdGVTbGlkZXIocHQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL3RoaXMubWF4V2lkdGggPSB0aGlzLm5vZGUud2lkdGggLSA0MDtcbiAgICAgICAgdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aC0yODtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlU2xpZGVyOmZ1bmN0aW9uKHB0KSB7XG4gICAgICAgIHZhciB4ID0gcHQueDtcbiAgICAgICAgaWYgKHggPCAwKSB7XG4gICAgICAgICAgICB4ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh4ID4gdGhpcy5tYXhXaWR0aCkge1xuICAgICAgICAgICAgeCA9IHRoaXMubWF4V2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh4L3RoaXMubWF4V2lkdGgpO1xuICAgICAgICB0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy52YWx1ZSk7XG4gICAgfSxcblxuICAgIC8qMCAtIDEqL1xuICAgIHNldFZhbHVlOmZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52YWx1ZSA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSAxO1xuICAgICAgICB9XG4gICAgICAgIC8vdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aCAtIDM4O1xuICAgICAgICB0aGlzLm1heFdpZHRoID0gdGhpcy5ub2RlLndpZHRoLTI4O1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUueCA9IHRoaXMudmFsdWUgKiB0aGlzLm1heFdpZHRoKzEwO1xuICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZS53aWR0aCA9IHRoaXMudmFsdWUgKiB0aGlzLm1heFdpZHRoICsgdGhpcy5pbmRpY2F0b3JOb2RlLndpZHRoLzI7XG4gICAgfSxcblxuICAgIG9uVmFsdWVDaGFuZ2U6ZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgY2MubG9nKHZhbHVlKTtcbiAgICB9LFxufSk7XG4iLCJ2YXIgbWFuYWdlciA9IHJlcXVpcmUoJ21hbmFnZXInKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5cbmxldCBTb2NrZXRDb25zdGFudCA9IHtcbiAgTWF4UmVjb25uZWN0Q2hlY2tJbnRlcnZhbDogNSwgLy8g6YeN6L+e5qOA5rWL5pe26Ze054mHXG59O1xuXG4vKipcbiAqIOi/meaYr+WvuSBXZWJTb2NrZXQg55qE5LiA5Liq5bCB6KOFXG4gKiBcbiAqIOmHjOmdouWMheWQq+iHquWKqOmHjei/nueahOWKn+iDvVxuICovXG5sZXQgU29ja2V0ID0gY2MuQ2xhc3Moe1xuICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgcHJvcGVydGllczoge1xuICAgIF9sYXN0UmVjZWl2ZU1zZ1RpbWU6IDAsIC8vIOacgOWQjuS4gOasoeaUtuWIsOa2iOaBr+aXtumXtCjmr6vnp5IpXG4gICAgX3RpbWVvdXQ6IDgsIC8vIOi2heaXtuaXtumVvyDvvIjnp5LvvIlcbiAgfSxcblxuICBzdGF0aWNzOiB7XG4gICAgaW5zdGFuY2U6IG51bGwsXG4gICAgdXJsOiAnd3M6Ly8zOS4xMDguMTEyLjExOjUwMDEnLFxuICAgICAvL3VybDpcIndzOi8vMTkyLjE2OC4wLjEyMDo1MDAxXCIsXG4gICAgLy91cmw6XCJ3czovLzE4My4zLjIwNS4xNDk6NTAwMlwiLFxuICB9LFxuXG4gIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICBTb2NrZXQuaW5zdGFuY2UgPSB0aGlzO1xuXG4gICAgdGhpcy5uYW1lID0gXCJzb2NrZXRcIjtcblxuICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XG4gICAgaWYgKGNjLmdhbWUuaXNQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKSkge1xuICAgICAgY2MubG9nKCfmt7vliqDlhajlsYDoioLngrkgU29ja2V0IOaIkOWKnycpO1xuICAgIH1cblxuICAgIHRoaXMuX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlKCk7XG5cbiAgICB0aGlzLmlzQ3JlYXRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmNyZWF0ZUluZGV4ID0gMDtcbiAgICB0aGlzLmNyZWF0ZVNvY2tldCgpO1xuXG4gICAgdGhpcy5zY2hlZHVsZShmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNoZWNrQ29ubmVjdGlvbigpO1xuICAgIH0sIDUpO1xuXG4gICAgdGhpcy5yZWN2VGltZSA9IERhdGUubm93KCk7IC8v5o6l5pS25Yiw5pyA5paw5LiA5p2h5pyN5Yqh5Zmo55qE5L+h5oGv55qE5pe26Ze0XG4gICAgLy9jYy5sb2cobWFuYWdlci52ZXJzaW9uKTtcblxuICAgIHRoaXMuX2NoZWNrU29ja2V0KCk7XG4gIH0sXG5cbiAgY2hlY2tDb25uZWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgLy/lrqLmiLfnq6/lrprml7bnu5nmnI3liqHnq6/lj5HpgIHngrnmlbDmja7vvIzpmLLmraLov57mjqXnlLHkuo7plb/ml7bpl7TmsqHmnInpgJrorq/ogIzooqvmn5DkupvoioLngrnnmoTpmLLngavlopnlhbPpl63lr7zoh7Tov57mjqXmlq3lvIDnmoTmg4XlhrXjgIJcbiAgICB0aGlzLnNlbmRNZXNzYWdlKCdjaGVja0FjdGlvbicsICcnKTtcbiAgfSxcblxuICBjcmVhdGVTb2NrZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5jcmVhdGVJbmRleCsrOyAvL+WIm+W7uuasoeaVsOWKoDFcbiAgICBpZiAodGhpcy5jcmVhdGVJbmRleCA+IDUpIHtcbiAgICAgIHRoaXMubmV0d29ya0Vycm9yKCk7XG4gICAgICBLUU5hdGl2ZUludm9rZS5mb3JjZUV4aXRBcHAoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pc0NyZWF0aW5nID0gdHJ1ZTtcblxuICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdGluZyk7XG4gICAgdGhpcy53cyA9IG5ldyBXZWJTb2NrZXQoU29ja2V0LnVybCk7XG4gICAgaWYgKHRoaXMud3MgPT09IG51bGwpIHtcbiAgICAgIHRoaXMubmV0d29ya0Vycm9yKCk7XG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RFcnJvciwgeydkYXRhJzogJ1NvY2tldCDliJvlu7rlpLHotKUnfSk7XG4gICAgICBLUU5hdGl2ZUludm9rZS5mb3JjZUV4aXRBcHAoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5zb2NrZXRFcnJvciA9IGZhbHNlO1xuXG4gICAgLy8gc29ja2V0IOi/nuaOpeaIkOWKn1xuICAgIHRoaXMud3Mub25vcGVuID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDov57mjqXmiJDlip/vvJpcIiwgZXZlbnQpO1xuICAgICAgXG4gICAgICBzZWxmLl9sYXN0UmVjZWl2ZU1zZ1RpbWUgPSBjYy5zeXMubm93KCk7XG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RTdWNjZXNzZWQsIGV2ZW50KTtcblxuICAgICAgc2VsZi5pc0NyZWF0aW5nID0gZmFsc2U7XG4gICAgICBzZWxmLnNvY2tldEVycm9yID0gZmFsc2U7XG4gICAgICBzZWxmLmNyZWF0ZUluZGV4ID0gMDtcbiAgICAgIHNlbGYuY29ubmVjdGlvblN1Y2Nlc3MoKTtcbiAgICAgIHNlbGYuc2VuZFJlY29ubmVjdEluZm8oKTtcbiAgICB9O1xuXG4gICAgLy8gc29ja2V0IOaOpeaUtuWIsOa2iOaBr1xuICAgIHRoaXMud3Mub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBzZWxmLl9sYXN0UmVjZWl2ZU1zZ1RpbWUgPSBjYy5zeXMubm93KCk7XG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldFJlY2VpdmVNZXNzYWdlLCBldmVudC5kYXRhKTtcblxuICAgICAgc2VsZi5pc0NyZWF0aW5nID0gZmFsc2U7XG4gICAgICBzZWxmLnNvY2tldEVycm9yID0gZmFsc2U7XG4gICAgICBzZWxmLnJlY2V2aWNlTWVzc2FnZShldmVudC5kYXRhKTtcbiAgICAgIHNlbGYuX2Rpc3BhdGNoUmVzcG9uc2UoZXZlbnQuZGF0YSk7XG4gICAgICBzZWxmLnJlY3ZUaW1lID0gRGF0ZS5ub3coKTsgLy/mjqXmlLbmnIDmlrDkuIDmnaHkv6Hmga/nmoTml7bpl7RcblxuICAgICAgLyoqL1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBzb2NrZXQg5Y+R55Sf6ZSZ6K+vXG4gICAgICogXG4gICAgICogc29ja2V0IOacrOi6q+aciSBgb25lcnJvcmAg5Zue6LCD77yM5L2G5LqL5a6e6K+B5piO77yM5YW25LiN6Z2g6LCx77yMXG4gICAgICog5pyJ5b6I5aSn55qE5py6546H5pyJ6K+v5oql55qE6KGM5Li677yM5bi45bi45Zyo5rKh5pyJ6ZSZ6K+v5pe277yM5Lya57uZ6ZSZ6K+v5Zue6LCD44CCXG4gICAgICog5LiU5LiN6IO95a6a5Yi26LaF5pe25pe26ZW/XG4gICAgICogXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgXG4gICAgICovXG4gICAgdGhpcy53cy5fa3Ffb25lcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICBjYy5lcnJvcihgV2ViU29ja2V0IOi/nuaOpemUmeivr++8miR7bWVzc2FnZX1gKTtcblxuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0RXJyb3IsIHtkYXRhOiBtZXNzYWdlfSk7XG4gICAgICBzZWxmLndzLmNsb3NlKCk7XG4gICAgICBpZiAoIXNlbGYud3MpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyDomb3nhLbosIPnlKjkuoYgd2Vic29ja2V0IOeahCBjbG9zZSDmlrnms5XvvIzkvYbmmK9cbiAgICAgIC8vIOWug+W5tuS8mueri+WNs+iwg+eUqCBvbmNsb3NlIOWbnuiwg++8jOiAjOaYr+WcqOacquadpeeahOafkFxuICAgICAgLy8g5LiA5pe26Ze05YaN5Zue6LCDIG9uY2xvc2XvvJvkvYbov5nph4zmmI7mmL7lj6/ku6Xnm7TmjqXlm57osIPkuobjgIJcbiAgICAgIGxldCB3cyA9IHNlbGYud3M7XG5cbiAgICAgIHNlbGYud3Mub25jbG9zZSgpO1xuICAgICAgd3Mub25jbG9zZSA9IGZ1bmN0aW9uKCl7fTtcbiAgICB9O1xuXG4gICAgLy8gc29ja2Ug5bey5YWz6ZetXG4gICAgdGhpcy53cy5vbmNsb3NlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAvL2NjLmxvZygnV2ViU29ja2V0IOW3suWFs+mXrSBjbG9zZSB0aW1lPScgKyBEYXRlLm5vdygpICsgXCIgZXZlbnQ6IFwiICsgZXZlbnQpO1xuXG5cbiAgICAgIHNlbGYuaXNDcmVhdGluZyA9IGZhbHNlO1xuICAgICAgc2VsZi5zb2NrZXRFcnJvciA9IHRydWU7XG4gICAgICBzZWxmLndzID0gbnVsbDtcbiAgICAgIHNlbGYuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgZXZlbnQpO1xuICAgICAgLy9jYy5sb2coJ3NvY2tldCBjbG9zZScrSlNPTi5zdHJpbmdpZnkoZXZlbnQpKTtcbiAgICB9O1xuICB9LFxuXG4gIHJlY29ubmVjdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIXNlbGYuaXNDcmVhdGluZyAmJiBzZWxmLnNvY2tldEVycm9yKSB7XG4gICAgICAgIHNlbGYuY3JlYXRlU29ja2V0KCk7XG4gICAgICB9XG4gICAgfSwgMik7XG4gIH0sXG5cbiAgc2VuZFJlY29ubmVjdEluZm86IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMudXNlckluZm8gIT0gbnVsbCkge1xuICAgICAgICB2YXIgdXNlcklkID0gc2VsZi51c2VySW5mby51c2VyX2lkIHx8IHNlbGYudXNlckluZm8uaWQ7XG4gICAgICAgIHNlbGYuc2VuZE1lc3NhZ2UoJ3JlY29ubmVjdCcsIHtcbiAgICAgICAgICAndXNlcklkJzogdXNlcklkXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sIDEpO1xuICB9LFxuXG4gIHJlY2V2aWNlTWVzc2FnZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgfSxcblxuICBjb25uZWN0aW9uRGlzY29ubmVjdDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgY29ubmVjdGlvblN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIG5ldHdvcmtFcnJvcjogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgY2hlY2tOZXR3b3JrU3RhcnQ6IGZ1bmN0aW9uICgpIHtcblxuICB9LFxuXG4gIGNoZWNrTmV0d29ya0VuZDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgX2Rpc3BhdGNoUmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZVN0cmluZykge1xuICAgIC8vY2MubG9nKFwiV2ViU29ja2V0IOaOpeaUtuWIsOacjeWKoeWZqOa2iOaBr++8mlwiLCByZXNwb25zZVN0cmluZyk7XG4gICAgbGV0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZVN0cmluZyk7XG4gICAgbGV0IGFjdGlvbiA9IHJlc3BvbnNlW1wiYWN0aW9uXCJdO1xuICAgIGlmIChhY3Rpb24pIHtcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChhY3Rpb24sIHJlc3BvbnNlKTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gTUFSSzog5YmN5ZCO5Y+w5pON5L2cXG4gIF9yZWdpc3RlckFwcEFjdGl2ZUNoYW5nZTogZnVuY3Rpb24gKCkge1xuICAgIC8vY2MubG9nKFwiV2ViU29ja2V0IOazqOWGjOW6lOeUqOi/m+WFpeWJjeOAgeWQjuWPsOS6i+S7tlwiKTtcbiAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfSElERSwgdGhpcy5fYXBwRW50ZXJCYWNrZ3JvdW5kLCB0aGlzKTtcbiAgICBjYy5nYW1lLm9uKGNjLmdhbWUuRVZFTlRfU0hPVywgdGhpcy5fYXBwQmVjb21BY3RpdmUsIHRoaXMpO1xuICB9LFxuXG4gIC8qKlxuICAgKiDov5vlhaXlkI7lj7BcbiAgICovXG4gIF9hcHBFbnRlckJhY2tncm91bmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA8IDEwMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA9IG5vdztcbiAgICBcbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDmo4DmtYvliLDlupTnlKjov5vlhaXlkI7lj7DvvJpcIiwgbmV3IERhdGUoKSk7XG4gICAgbGV0IGlkID0gdGhpcy51c2VySW5mbyA/IHRoaXMudXNlckluZm8uaWQgOiB1bmRlZmluZWQ7XG4gICAgU29ja2V0LnNlbmRBcHBQYXVzZShpZCk7XG4gICAgdGhpcy5fY2FuY2VsQ2hlY2tTb2NrZXQoKTtcbiAgfSxcblxuICAvKipcbiAgICog6L+b5YWl5YmN5Y+wIFxuICAgKi9cbiAgX2FwcEJlY29tQWN0aXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG5vdyA9IGNjLnN5cy5ub3coKTtcbiAgICBpZiAobm93IC0gdGhpcy5fbGFzdEFwcEJlY29tQWN0aXZlVGltZSA8IDEwMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lID0gbm93O1xuXG4gICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg5qOA5rWL5Yiw5bqU55So6L+b5YWl5YmN5Y+w77yaXCIsIG5ldyBEYXRlKCkpO1xuICAgIGxldCBpZCA9IHRoaXMudXNlckluZm8gPyB0aGlzLnVzZXJJbmZvLmlkIDogdW5kZWZpbmVkO1xuICAgIFNvY2tldC5zZW5kQXBwQWN0aXZlKGlkKTtcbiAgICB0aGlzLl9jaGVja1NvY2tldCgpO1xuXG4gICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLl9jaGVja1NvY2tldEV4ZWN1dGUoKTtcbiAgICB9LmJpbmQodGhpcyksIDEuNSk7XG4gIH0sXG5cbiAgLy/ov5vlhaXlkI7lj7Dmk43kvZxcbiAgZW50ZXJiYWNrZ3JvdWRBY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLl9hcHBFbnRlckJhY2tncm91bmQoKTtcbiAgfSxcblxuICAvL+i/m+WFpeWJjeWPsOaTjeS9nFxuICByZXN1bWVBY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICAvL+ajgOafpee9kee7nFxuICAgIHRoaXMuX2NoZWNrTmV0d29yaygpO1xuICAgIHRoaXMuX2FwcEJlY29tQWN0aXZlKCk7XG4gIH0sXG5cbiAgc2VuZE1lc3NhZ2U6IGZ1bmN0aW9uIChhY3Rpb24sIGRhdGEpIHtcbiAgICBkYXRhID0gdGhpcy5fc3Ryb25nVmVyaWZ5RGF0YShkYXRhKTtcblxuICAgIGlmICh0aGlzLnNvY2tldEVycm9yKSB7XG4gICAgICBjYy5lcnJvcihcInNvY2tldCDov57mjqXplJnor6/vvJpcIiArIHRoaXMuc29ja2V0RXJyb3IpO1xuICAgICAgdGhpcy5yZWNvbm5lY3QoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy9jYy5sb2coJ1dlYlNvY2tldCDlj5HpgIHmtojmga/vvJonICsgYWN0aW9uLCBkYXRhKTtcbiAgICBpZiAoY2Muc3lzLmlzT2JqZWN0VmFsaWQodGhpcy53cykpIHtcbiAgICAgIGlmICh0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7XG4gICAgICAgIHRoaXMud3Muc2VuZCh0aGlzLl9jb252ZXJ0UGFyYW1ldGVyVG9TdHJpbmcoYWN0aW9uLCBkYXRhKSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcbiAgICB9XG4gIH0sXG5cbiAgX3N0cm9uZ1ZlcmlmeURhdGE6IGZ1bmN0aW9uKGRhdGEgPSB7fSkge1xuICAgIGlmICgodHlwZW9mIGRhdGEpID09ICdzdHJpbmcnKSB7XG4gICAgICBkYXRhID0ge1wic3RyaW5nXCI6IGRhdGF9O1xuICAgIH1cblxuICAgIGlmIChkYXRhID09IG51bGwpIHtcbiAgICAgIGRhdGEgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGFbXCJ1c2VySWRcIl0pIHtcbiAgICAgIGlmICh0aGlzLnVzZXJJbmZvICYmICh0eXBlb2YgdGhpcy51c2VySW5mbykgPT0gJ29iamVjdCcgJiYgdGhpcy51c2VySW5mby5pZCkge1xuICAgICAgICBkYXRhW1widXNlcklkXCJdID0gdGhpcy51c2VySW5mby5pZDtcbiAgICAgIH1cblxuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfSxcblxuICBfY29udmVydFBhcmFtZXRlclRvU3RyaW5nOiBmdW5jdGlvbiAoYWN0aW9uLCBkYXRhID0ge30pIHtcbiAgICB2YXIgb2JqID0ge307XG4gICAgb2JqLmFjdGlvbiA9IGFjdGlvbjtcbiAgICBvYmouZGF0YSA9IGRhdGE7XG4gICAgXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaik7XG4gIH0sXG5cbiAgLy8g5qOA5p+l572R57ucXG4gIF9jaGVja05ldHdvcms6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5jaGVja05ldHdvcmtOb3cpIHtcbiAgICAgIHRoaXMuY2hlY2tOZXR3b3JrTm93KCk7XG4gICAgfVxuXG4gICAgdGhpcy5zaG91bGRDaGVjayA9IHRydWU7XG4gICAgaWYgKCF0aGlzLnNvY2tldEVycm9yKSB7XG4gICAgICB0aGlzLnJlY3ZUaW1lID0gMDtcbiAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoJ2NoZWNrQWN0aW9uJywgJycpO1xuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNoZWNrTmV0d29ya0VuZCgpO1xuICAgICAgICB0aGlzLnNob3VsZENoZWNrID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnJlY3ZUaW1lID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5jb25uZWN0aW9uRGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICB9LCAyLjUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25EaXNjb25uZWN0KCk7XG4gICAgfVxuICB9LFxuXG4gIC8vIE1BUks6IHNvY2tldCDmjonnur/lsL3ml6nnoa7orqRcbiAgX2NoZWNrU29ja2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zY2hlZHVsZSh0aGlzLl9jaGVja1NvY2tldEV4ZWN1dGUsIFNvY2tldENvbnN0YW50Lk1heFJlY29ubmVjdENoZWNrSW50ZXJ2YWwsIGNjLm1hY3JvLlJFUEVBVF9GT1JFVkVSKTtcbiAgfSxcblxuICBfY2FuY2VsQ2hlY2tTb2NrZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fY2hlY2tTb2NrZXRFeGVjdXRlKTtcbiAgfSxcblxuICBfY2hlY2tTb2NrZXRFeGVjdXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuX2lzU29ja2V0VGltZW91dCgpICYmIHRoaXMud3MpIHtcbiAgICAgIHRoaXMud3MuX2txX29uZXJyb3IoJ+i/nuaOpei2heaXticpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfSxcblxuICAvLyBzb2NrZXQg5piv5ZCm5bey6LaF5pe2XG4gIF9pc1NvY2tldFRpbWVvdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGFzdFJlY2VpdmVNZXNzYWdlSW50ZXJ2YWwoKSA+PSB0aGlzLl90aW1lb3V0O1xuICB9LFxuXG4gIC8vIOS4iuS4gOasoeaUtuWIsOa2iOaBr+WIsOeOsOWcqOeahOaXtumXtOmXtOmalFxuICBfbGFzdFJlY2VpdmVNZXNzYWdlSW50ZXJ2YWw6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xuICAgIGxldCBpbnRlcnZhbCA9IChub3cgLSB0aGlzLl9sYXN0UmVjZWl2ZU1zZ1RpbWUpIC8gMTAwMDtcbiAgICAvL2NjLmxvZyhgV2ViU29ja2V0IOeOsOWcqOi3neS4iuS4gOadoeaUtuWIsOa2iOaBr+eahOaXtumXtOmXtOmalOaYr++8miR7aW50ZXJ2YWx9IOenkmApO1xuICAgIHJldHVybiBpbnRlcnZhbDtcbiAgfSxcblxufSk7XG5cbi8vIE1BUks6IFNvY2tldCDkuovku7blrprkuYlcblNvY2tldC5FdmVudCA9IHtcbiAgU29ja2V0Q29ubmVjdGluZzogXCJTb2NrZXRDb25uZWN0aW5nXCIsICAgICAgICAgICAgIC8vIFNvY2tldCDmraPlnKjov57mjqVcbiAgU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZDogXCJTb2NrZXRDb25uZWN0U3VjY2Vzc2VkXCIsIC8vIOi/nuaOpeaIkOWKn1xuICBTb2NrZXREaXNjb25uZWN0OiBcIlNvY2tldERpc2Nvbm5lY3RcIiwgICAgICAgICAvLyBTb2NrZXQg5pat5byA6L+e5o6lXG4gIFNvY2tldENvbm5lY3RFcnJvcjogXCJTb2NrZXRDb25uZWN0RXJyb3JcIiwgICAgIC8vIFNvY2tldCDov57mjqXplJnor69cbiAgU29ja2V0UmVjZWl2ZU1lc3NhZ2U6IFwiU29ja2V0UmVjZWl2ZU1lc3NhZ2VcIiwgLy8gU29ja2V0IOaOpeaUtuWIsOa2iOaBr1xuXG4gIEludml0ZUNvZGU6IFwiaW52aXRlQ29kZVwiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgICDpgoDor7fnoIFcbiAgSm9pbkRlc2s6IFwiam9pbkRlc2tcIiwgICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxuICBDcmVhdGVEZXNrOiBcImNyZWF0ZURlc2tcIiwgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIExlYXZlRGVzazogXCJsZWF2ZURlc2tcIiwgICAgICAgICAgICAgICAvLyDnprvlvIDmoYzlrZBcbiAgRGlzc29sdmVEZXNrOiBcImRpc3NvbHZlRGVza1wiLCAgICAgICAgIC8vIOino+aVo+ahjOWtkFxuICBBbnN3ZXJEaXNzb2x2ZTogXCJhbnN3ZXJEaXNzb2x2ZVwiLCAgICAgLy8g5Zue562U6K+35rGC6YCA5Ye65ZG95LukXG4gIEdldERlc2tJbmZvOiBcImdldERlc2tJbmZvXCIsICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcbiAgU2VuZEltYWdlOiBcInNlbmRJbWFnZVwiLCAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxuICBTZW5kVGV4dDogXCJzZW5kVGV4dFwiLCAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIFNlbmRBdWRpb01lc3NhZ2U6IFwic2VuZEF1ZGlvTWVzc2FnZVwiLCAvLyDlrqLmiLfnq6/lj5HpgIEgIOWPkemAgeivremfs+a2iOaBr1xuICBHZXRSZWNvcmQ6IFwiZ2V0UmVjb3JkXCIsICAgICAgICAgICAgICAgLy8g6I635Y+W5oiY57up5L+h5oGvXG4gIEdldEl0ZW1SZWNvcmQ6IFwiZ2V0SXRlbVJlY29yZFwiLCAgICAgICAvLyDojrflj5bmiJjnu6nkv6Hmga9cbiAgUGxheUNhcmQ6IFwicGxheUNhcmRcIiwgICAgICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAge+8jOeUqOaIt+aJk+WHuueJjFxuICBUaW1lb3V0RGlzc29sdmU6IFwidGltZW91dERpc3NvbHZlXCIsICAgLy8g6K+35rGC6YCA5Ye66LaF5pe25pe277yM6ZyA6KaB5Y+R5Ye655qE5raI5oGvXG4gIEZlZWRiYWNrOiBcImZlZWRiYWNrXCIsICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBICDlj43ppojkv6Hmga9cbiAgU2hhcmVQbmc6IFwic2hhcmVQbmdcIiwgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIOWIhuS6q+mihuWPluegluefs1xuICBFbnRlclJhbmRvbTogXCJpbnRlclJhbmRvbVwiLCAgIC8vIOWuouaIt+err+WPkemAgSAg6L+b5YWl6ZqP5py65Zy6XG4gIENhbmNlbFJhbmRvbTogXCJjYW5jZWxSYW5kb21cIiwgLy8g5a6i5oi356uv5Y+R6YCBICDlj5bmtojov5vlhaXpmo/mnLrlnLpcbiAgRm9yY2VFeGl0UmFuZG9tOiBcImRpc3NvbHZlXCIsICAvLyDlrqLmiLfnq6/lj5HpgIEg5by65Yi26YCA5Ye66ZqP5py65Zy6XG4gIFJlYWR5OiBcInJlYWR5XCIsICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBIOWHhuWkh1xuICBHZXRIYWxsSW5mbzogXCJnZXRIYWxsSW5mb1wiLCAgIC8vIOWuouaIt+err+WPkemAgSDojrflj5blpKfljoXkv6Hmga9cbiAgR2V0VXNlckluZm86IFwiZ2V0VXNlckluZm9cIiwgICAvLyDlrqLmiLfnq6/lj5HpgIEg6I635Y+W55So5oi35L+h5oGvXG4gIENoZWNrQWN0aW9uOiBcImNoZWNrQWN0aW9uXCIsICAgLy8g5a6i5oi356uv5Y+R6YCB77yM55So5p2l5qOA5rWL5LiO5pyN5Yqh5Zmo55qE6L+e6YCa5oCnXG4gIFBhdXNlOiBcInBhdXNlXCIsICAgICAgICAgICAgICAgLy8g5a6i5oi356uv6L+b5YWl5ZCO5Y+w5pe26KaB5Y+R6YCB55qE5raI5oGvXG4gIEFjdGl2ZTogXCJhY3RpdmVcIiwgICAgICAgICAgICAgLy8g5a6i5oi356uv5Zue5Yiw5YmN5Y+w5pe26KaB5Y+R6YCB55qE5raI5oGvXG5cbiAgUmVjZWl2ZVJlcXVlc3REaXNzb2x2ZTogXCJyZXF1ZXN0RGlzc29sdmVcIiwgLy8g6K+35rGC6Kej5pWj5qGM5a2QIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlUmVxdWVzdERpc3NvbHZlUmVzdWx0OiBcInJlcXVlc3REaXNzb2x2ZVJlc3VsdFwiLCAvLyDor7fmsYLop6PmlaPmoYzlrZDnu5PmnpxcbiAgUmVjZWl2ZUNoYXRUZXh0OiBcInNlbmRUZXh0XCIsIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlRGVza0luZm86IFwiZGVza0luZm9cIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVHYW1lT3ZlcjogXCJnYW1lT3ZlclwiLCAvLyDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZUZhUGFpOiBcImZhcGFpXCIsIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlU2hhcmVQbmc6IFwic2hhcmVQbmdzXCIsIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlT25saW5lU3RhdHVzOiBcInNlbmRPbmxpbmVTdGF0dXNcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVBdWRpb01lc3NhZ2U6IFwic2VuZEF1ZGlvTWVzc2FnZVwiLCAvLyDmnI3liqHlmajlj5HpgIHvvIzmjqXmlLbliLDnlKjmiLflj5HpgIHkuobor63pn7Pmtojmga9cbiAgUmVjZWl2ZVBsYXlDYXJkOiBcInBsYXlDYXJkXCIsIC8vIOacjeWKoeWZqOWPkemAge+8jOacieeUqOaIt+W3sue7j+WHhuWkh+WlveeJjFxuICBSZWNlaXZlQ3JlYXRlRGVzazogXCJjcmVhdGVEZXNrXCIsIC8vIOacjeWKoeWZqOWPkemAge+8jOWIm+W7uuaIv+mXtOeahOWbnuiwg1xuICBSZWNlaXZlUmVhZHk6IFwicmVhZHlcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pyJ55So5oi354K55Ye75LqG5YeG5aSHXG4gIFJlY2VpdmVIYWxsSW5mbzogXCJnZXRIYWxsSW5mb1wiLCAvLyDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZUdldFVzZXJJbmZvOiBcImdldFVzZXJJbmZvXCIsIC8vIOacjeWKoeWZqOWPkemAgSDojrflj5bnlKjmiLfkv6Hmga9cbiAgUmVjZWl2ZUNoZWNrQWN0aW9uOiBcImNoZWNrQWN0aW9uXCIsIC8vIOacjeWKoeWZqOWPkemAgSAg55So5p2l56Gu6K6kIFNvY2tldCDov5jlnKjov57nnYBcbiAgUmVjZWl2ZUZvcmNlRXhpdDogXCJmb3JjZUV4aXRcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBICDnlKjmnaXkvb/lrqLmiLfnq6/lvLrpgIBcbiAgUmVjZWl2ZURpc3NvbHZlRGVzazogXCJkaXNzb2x2ZURlc2tcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBICAg5b2T5oi/5Li76YCA5Ye65pe277yM6Kej5pWj5qGM5a2QXG4gIFJlY2VpdmVJbnRlclJhbmRvbTogXCJpbnRlclJhbmRvbVwiLCAgIC8vIOacjeWKoeWZqOWPkemAgSAgIOi/m+WFpemaj+acuuWcuueahOWPjemmiFxuICBSZWNlaXZlUGF1c2U6IFwicGF1c2VcIiwgICAgICAgICAgICAgICAvLyDmnI3liqHlmajlj5HpgIEgICDlvZPmnInnlKjmiLforr7lpIfov5vlhaXlkI7lj7Dml7bvvIzkvJrmlLbliLDov5nmnaHmtojmga9cbiAgUmVjZWl2ZUludml0ZUNvZGU6ICdpbnZpdGVDb2RlJywgICAgIC8vIOacjeWKoeWZqOWPkemAge+8jOaUtuWIsOmCgOivt+eggeeahOa2iOaBr1xuICAvKiovXG4gIFJlY2VpdmVMZWF2ZURlc2s6ICdsZWF2ZURlc2snLCAvLyDmnI3liqHlmajlj5HpgIHvvIzmlLbliLDpnIDopoHnprvlvIDmoYzlrZDnmoTmtojmga9cbiAgLyoqL1xufTtcblxuLy8gTUFSSzogU29ja2V0IOaPkOS+m+eahOWPr+WPkee7meacjeWKoeWZqOa2iOaBr+eahOaWueazlVxuXG5Tb2NrZXQuc2VuZENoZWNrQWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5DaGVja0FjdGlvbiwgbnVsbCk7XG59O1xuLyoqL1xuU29ja2V0LnNlbmREaWRSZWNlaXZlR2FtZU92ZXJBY3Rpb24gPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNvbnN0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKFNvY2tldC5FdmVudC5EaWRSZWNlaXZlR2FtZU92ZXJBY3Rpb24sIHBhcmFtKTtcbn07XG4vKiovXG5cblxuLyoqXG4gKiDlvZMgQVBQIOi/m+WFpeWQjuWPsOaXtuimgeWPkemAgeeahOa2iOaBr1xuICovXG5Tb2NrZXQuc2VuZEFwcFBhdXNlID0gZnVuY3Rpb24odXNlcklkKSB7XG4gIGxldCBwYXJhbSA9IHVzZXJJZCA/IHtcInVzZXJJZFwiOiB1c2VySWR9IDogbnVsbDtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlBhdXNlLCBwYXJhbSk7XG59O1xuXG4vKipcbiAqIOW9kyBBUFAg6L+b5YWl5YmN5Y+w5pe25Y+R6YCB55qE5raI5oGvXG4gKi9cblNvY2tldC5zZW5kQXBwQWN0aXZlID0gZnVuY3Rpb24odXNlcklkKSB7XG4gIGxldCBwYXJhbSA9IHVzZXJJZCA/IHtcInVzZXJJZFwiOiB1c2VySWR9IDogbnVsbDtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkFjdGl2ZSwgcGFyYW0pO1xufTtcblxuLy8g5byA5oi/XG5Tb2NrZXQuc2VuZENyZWF0ZURlc2sgPSBmdW5jdGlvbiAoY3JlYXRlRGVzY0luZm8sIHVzZXJJZCkge1xuICBjYy5hc3NlcnQoY3JlYXRlRGVzY0luZm8pO1xuICBjYy5hc3NlcnQodXNlcklkKTtcblxuICBjcmVhdGVEZXNjSW5mb1tcInVzZXJJZFwiXSA9IHVzZXJJZDtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkNyZWF0ZURlc2ssIGNyZWF0ZURlc2NJbmZvKTtcbn07XG5cbi8vIOWKoOWFpeaIv+mXtFxuU29ja2V0LnNlbmRKb2luRGVzayA9IGZ1bmN0aW9uIChyb29tSWQsIHVzZXJJZCkge1xuICBjYy5hc3NlcnQocm9vbUlkKTtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG5cbiAgbGV0IHBhcmFtID0ge1xuICAgIFwicm9vbUlkXCI6IHJvb21JZCxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5Kb2luRGVzaywgcGFyYW0pO1xufTtcblxuLy8g5Y+R6YCB6YKA6K+356CBXG5Tb2NrZXQuc2VuZEludml0ZUNvZGUgPSBmdW5jdGlvbihpbnZpdGVDb2RlLHVzZXJJZCl7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcImludml0ZUNvZGVcIjogaW52aXRlQ29kZSxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5JbnZpdGVDb2RlLCBwYXJhbSk7XG59O1xuXG4vLyDojrflj5bmiL/pl7Tkv6Hmga9cblNvY2tldC5zZW5kR2V0RGVzY2tJbmZvID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuR2V0RGVza0luZm8sIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kVGV4dCA9IGZ1bmN0aW9uICh1c2VySWQsIHRleHQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGNjLmFzc2VydCh0ZXh0KTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwibXNnXCI6IHRleHQsXG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuU2VuZFRleHQsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kQXVkaW9NZXNzYWdlID0gZnVuY3Rpb24gKHVzZXJJZCwgdXJsID0gXCJcIikge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgY2MuYXNzZXJ0KHVybC5sZW5ndGggPiAwKTtcblxuICBpZiAodXJsLmxlbmd0aCA9PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXJsXCI6IHVybCxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kQXVkaW9NZXNzYWdlLCBwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZEltYWdlID0gZnVuY3Rpb24gKHVzZXJJZCwgaW1hZ2UpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGNjLmFzc2VydChpbWFnZSk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcIm1zZ1wiOiBpbWFnZSxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kSW1hZ2UsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kR2V0UmVjcm9kID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuR2V0UmVjb3JkLCBwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZERpc3NvbHZlRGVzayA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5EaXNzb2x2ZURlc2ssIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kR2V0SXRlbVJlY29yZCA9IGZ1bmN0aW9uICh1c2VySWQsIHBhcmVudElkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBjYy5hc3NlcnQocGFyZW50SWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIFwicGFyZW50SWRcIjogcGFyZW50SWQsXG4gIH07XG5cbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldEl0ZW1SZWNvcmQsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kTGVhdmVEZXNrID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgIGNjLmFzc2VydCh1c2VySWQpO1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkxlYXZlRGVzaywgcGFyYW0pO1xufSxcblxuLyoqXG4gKiDlm57nrZTpgIDmiL/or7fmsYJcbiAqIFxuICogQHBhcmFtICB7TnVtYmVyfSB1c2VySWQg5b2T5YmN55So5oi3IGlkXG4gKiBAcGFyYW0gIHtOVW1iZXJ9IGFuc3dlcj0xIOWbnuetlOOAgjEg6KGo56S65ZCM5oSP77ybIDAg6KGo56S65ouS57ud77ybIC0xIOihqOekuuacqumAieaLqVxuICovXG5Tb2NrZXQuc2VuZEFuc3dlckRpc3NvbHZlID0gZnVuY3Rpb24gKHVzZXJJZCwgYW5zd2VyID0gMCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICBcImFuc3dlclwiOiBhbnN3ZXJcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQW5zd2VyRGlzc29sdmUsIHBhcmFtKTtcbn0sXG5cbiAgU29ja2V0LnNlbmRGb3JjZUV4aXRSb29tID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgIGNjLmFzc2VydCh1c2VySWQpO1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkRpc3NvbHZlRGVzaywgcGFyYW0pO1xuICB9LFxuXG4gIC8vIOWNgeS4ieW8oOS4rVxuICAvLyBjYXJkSW5mbyDnsbvkvLzkuo7vvJpcbiAgLy8gW3tcbiAgLy8gICAgICAgICAnY2FyZHMnOlt7J3N1aXQnOnN1aXQsJ251bWJlcic6bnVtYmVyfSx7fV0sLy/nibnmrorniYzkuI3nlKjkvKBcbiAgLy8gICAgICAgICAndHlwZSc6MCxcbiAgLy8gICAgICAgICAndmFsdWUnOjQsXG4gIC8vICAgICAgICAgJ2lzQ29udGFpbkV4dHJhJzp0cnVlLC8vIOeJueauiueJjOaYr+WQpuWMheWQq+eJueauiueJjFxuICAvLyAgICAgfSxcbiAgLy8gICAgIHtcbiAgLy8gICAgICAgICAnY2FyZHMnOlt7J3N1aXQnOnN1aXQsJ251bWJlcic6bnVtYmVyfSx7fV0sXG4gIC8vICAgICAgICAgJ3R5cGUnOjAsXG4gIC8vICAgICAgICAgJ3ZhbHVlJzo0XG4gIC8vICAgICB9XVxuU29ja2V0LnNlbmRQbGF5Q2FyZCA9IGZ1bmN0aW9uICh1c2VySWQsIGNhcmRJbmZvKSB7XG4gICAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gICAgbGV0IHBhcmFtID0ge1xuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgICAgXCJjYXJkXCI6IGNhcmRJbmZvXG4gICAgfTtcblxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5QbGF5Q2FyZCwgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRUaW1lb3V0RGlzc29sdmUgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5UaW1lb3V0RGlzc29sdmUsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kRmVlZGJhY2sgPSBmdW5jdGlvbiAodXNlcklkLCB0ZXh0KSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBjYy5hc3NlcnQodGV4dCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgXCJ0ZXh0XCI6IHRleHRcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuRmVlZGJhY2ssIHBhcmFtKTtcbn1cblxuU29ja2V0LnNlbmRTaGFyZVBuZyA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TaGFyZVBuZywgcGFyYW0pO1xufTtcbi8vIOW8gOWni+WMuemFjemaj+acuuWculxuU29ja2V0LnNlbmRFbnRlclJhbmRvbSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG5cbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkVudGVyUmFuZG9tLCBwYXJhbSk7XG59O1xuXG4vLyDlj5bmtojljLnphY3pmo/mnLrlnLpcblNvY2tldC5zZW5kQ2FuY2VsUmFuZG9tID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ2FuY2VsUmFuZG9tLCBwYXJhbSk7XG59O1xuXG4vLyDlh4blpIdcblNvY2tldC5zZW5kUmVhZHkgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gICAgbGV0IHBhcmFtID0ge1xuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIH07XG5cbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuUmVhZHksIHBhcmFtKTtcbiAgfSxcblxuLy8g6I635Y+W5aSn5Y6F5L+h5oGvXG5Tb2NrZXQuc2VuZEdldEhhbGxJbmZvID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldEhhbGxJbmZvLCBwYXJhbSk7XG59LFxuXG4vLyDojrflj5bnlKjmiLfkv6Hmga9cblNvY2tldC5zZW5kR2V0VXNlckluZm8gPSBmdW5jdGlvbiAodXNlcklkLCBvcGVuSWQpIHtcbiAgICBsZXQgcGFyYW0gPSB7XG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgICBcIm9wZW5JZFwiOiBvcGVuSWQsXG4gICAgfTtcblxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRVc2VySW5mbywgcGFyYW0pO1xufSxcblxubW9kdWxlLmV4cG9ydHMgPSBTb2NrZXQ7IiwiY29uc29sZS5sb2coMjwyKSIsImNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBzcHJpdGVBdmF0YXI6IGNjLlNwcml0ZSxcbiAgICAgICAgbGFiZWxOaWNrbmFtZTogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBzcHJpdGVPZmZsaW5lOiBjYy5TcHJpdGUsXG4gICAgICAgIHZvaWNlTm9kZTogY2MuTm9kZSxcbiAgICAgICAgaG9tZVJ1bk5vZGU6IGNjLk5vZGUsXG4gICAgICAgIHJlYWR5Tm9kZTogY2MuTm9kZSxcbiAgICAgICAgc2hvb3ROb2RlczogW2NjLk5vZGVdLFxuICAgICAgICBiYW5rZXJOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBmYW5nWmh1Tm9kZTogY2MuTm9kZSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnVwZGF0ZVNjb3JlKCk7XG4gICAgfSxcblxuICAgIHNldFJlYWR5Tm9kZVZpc2libGU6IGZ1bmN0aW9uICh2aXNpYmxlID0gZmFsc2UpIHtcbiAgICAgIHRoaXMucmVhZHlOb2RlLmFjdGl2ZSA9ICh2aXNpYmxlICE9IGZhbHNlKTtcbiAgICB9LFxuXG4gICAgc2V0RmFuZ1podU5vZGVWaXNpYmxlOiBmdW5jdGlvbiAodmlzaWJsZSA9IGZhbHNlKSB7XG4gICAgICAgIHRoaXMuZmFuZ1podU5vZGUuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xuICAgIH0sXG5cbiAgICB1cGRhdGVTY29yZTogZnVuY3Rpb24gKHNjb3JlID0gMCkge1xuICAgICAgICB0aGlzLmxhYmVsU2NvcmUuc3RyaW5nID0gXCJcIiArIHNjb3JlO1xuICAgIH0sXG5cbiAgICB1cGRhdGVOaWNrbmFtZTogZnVuY3Rpb24obmlja25hbWUgPSBcIlwiKSB7XG4gICAgICB0aGlzLmxhYmVsTmlja25hbWUuc3RyaW5nID0gbmlja25hbWU7XG4gICAgfSxcblxuICAgIHVwZGF0ZUF2YXRhcjogZnVuY3Rpb24gKGF2YXRhcikge1xuICAgICAgaWYgKGF2YXRhci5lbmRzV2l0aChcInBuZ1wiKVxuICAgICAgfHwgYXZhdGFyLmVuZHNXaXRoKFwianBnXCIpXG4gICAgICB8fCBhdmF0YXIuZW5kc1dpdGgoXCJnaWZcIikpIHtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXZhdGFyID0gYXZhdGFyICsgXCIucG5nXCI7XG4gICAgICB9XG5cbiAgICAgIGNjLmxvYWRlci5sb2FkKGF2YXRhciwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKGRhdGEpO1xuICAgICAgICB0aGlzLnNwcml0ZUF2YXRhci5zcHJpdGVGcmFtZSA9IGZyYW1lO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgc2V0T2ZmbGluZVZpc2libGU6IGZ1bmN0aW9uICh2aXNpYmxlID0gZmFsc2UpIHtcbiAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcbiAgICAgICAgLy8g5aaC5p6c5piv5aSE55CG5Zue5pS+54q25oCB77yM5bCx5LiN55So5YaN5aSE55CG56a757q/5raI5oGv5LqGXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zcHJpdGVPZmZsaW5lLm5vZGUuYWN0aXZlID0gdmlzaWJsZTtcbiAgICB9LFxuXG4gICAgc2V0SXNCYW5rZXI6IGZ1bmN0aW9uKGlzQmFua2VyID0gZmFsc2UpIHtcbiAgICAgIHRoaXMuYmFua2VyTm9kZS5hY3RpdmUgPSBpc0JhbmtlcjtcbiAgICB9LFxuXG4gICAgcGxheVNob290QW5pbWF0aW9uOiBmdW5jdGlvbiAodG9JbmRleCA9IDApIHtcbiAgICAgIGxldCBzaG9vdE5vZGUgPSB0aGlzLnNob290Tm9kZXNbdG9JbmRleF07XG4gICAgICBzaG9vdE5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgIGxldCBhbmltID0gc2hvb3ROb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgYW5pbS5wbGF5KCdzaG9vdCcpLm9uKCdmaW5pc2hlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2hvb3ROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfSwgdGhpcyk7XG5cbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5RGFRaWFuZygpO1xuICAgIH0sXG5cbiAgICBwbGF5QnVsbGV0SG9sZUFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGJ1bGxldEhvbGVOb2RlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKCdidWxsZXRIb2xlJyk7XG4gICAgICBidWxsZXRIb2xlTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgbGV0IGFuaW0gPSBidWxsZXRIb2xlTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgIGFuaW0ucGxheSgnYnVsbGV0SG9sZScpLm9uKCdmaW5pc2hlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYnVsbGV0SG9sZU5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB9LCB0aGlzKTtcbiAgICB9LFxuXG4gICAgcGxheVNwZWFrQW5pbWF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnZvaWNlTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnZvaWNlTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0uYmluZCh0aGlzKSwgNCk7XG4gICAgfSxcblxuICAgIC8vIOaSreaUvuWFqOWekuaJk+WKqOeUu1xuICAgIHBsYXlIb21lUnVuQWltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBhbGVydCA9IHRoaXMuaG9tZVJ1bk5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgYWxlcnQuYWxlcnQoKTtcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5ob21lUnVuTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0uYmluZCh0aGlzKSwgMik7XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgemh1YW5OdW1MYWJlbDpjYy5MYWJlbCxcbiAgICAgICAganVzaHU6Y2MuTm9kZSxcbiAgICAgICAgQUE6Y2MuTm9kZSxcbiAgICAgICAgX3NlbGVjdGVkUGVvcGxlSW5kZXg6bnVsbCxcbiAgICAgICAgX3NlbGVjdGVkSnVzaHVJbmRleDpudWxsLFxuICAgICAgICBfc2VsZWN0ZWRBQUluZGV4Om51bGxcbiAgICB9LFxuXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2N0cmwoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tQZW9wbGVBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX2N0cmwoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tBQUFjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jdHJsKCk7XG4gICAgfSxcblxuICAgIGNsaWNrSnVzaHVBY3Rpb246ZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jdHJsKCk7XG4gICAgfSxcblxuICAgICBfY3RybDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgIHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9IHRoaXMuanVzaHUuZ2V0Q29tcG9uZW50KFwic2luZ2xlU2VsZWN0XCIpLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgIHRoaXMuX3NlbGVjdGVkQUFJbmRleCA9IHRoaXMuQUEuZ2V0Q29tcG9uZW50KFwiY2hlY2tTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgLy/kurrmlbDpgIky5Lq65pe25LiU5rKh6YCJ5LiKQUHliLbmlLbotLlcbiAgICAgICAgIHZhciByZW5TaHUgPSAyO1xuICAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAwKXtcbiAgICAgICAgICAgICByZW5TaHUgPSAyO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDEpe1xuICAgICAgICAgICAgIHJlblNodSA9IDM7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMil7XG4gICAgICAgICAgICAgcmVuU2h1ID0gNDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAzKXtcbiAgICAgICAgICAgICByZW5TaHUgPSA1O1xuICAgICAgICAgfVxuICAgICAgICAgdmFyIHpodWFuZ1NoaSA9IDIwO1xuICAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDIwO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gNDA7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgICAgICB6aHVhbmdTaGkgPSA4MDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDMpe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDEwO1xuICAgICAgICAgfVxuICAgICAgICAgLy9BQVxuICAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ICE9IG51bGwpe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IE1hdGguY2VpbCh6aHVhbmdTaGkgLyByZW5TaHUpO1xuICAgICAgICAgfVxuICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IHpodWFuZ1NoaTtcbiAgICAgICAgLy9pZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICBpZih0aGlzLl9zZWxlY3RlZEFBSW5kZXggPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAgICAgICAgIC8vaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAgICAgICAgIC8vICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjEwXCI7XG4gICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgICAgLy8vL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgICAgICAgICAgLy9pZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgICAgICAgICAgLy8gICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMzBcIjtcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAvLy8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgICAgICAgICAvLyAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI4MFwiO1xuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgLy99XG4gICAgICAgIC8vICAgIGVsc2V7XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiOFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjE1XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjNcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL1xuICAgICAgICAvL31cbiAgICAgICAgLy/kurrmlbDpgIkz5Lq6XG4gICAgICAgIC8vZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAvL+ayoemAieS4ikFB5Yi25pS26LS5XG4gICAgICAgIC8vICAgIGlmKHRoaXMuX3NlbGVjdGVkQUFJbmRleCA9PSBudWxsKXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyMVwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjQyXCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiNjBcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvLyAgICAvL+mAieS6hkFB5pS26LS5XG4gICAgICAgIC8vICAgIGVsc2V7XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiN1wiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjE0XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjBcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL1xuICAgICAgICAvL31cbiAgICAgICAgLy8vL+S6uuaVsOmAiTTkurrkuJTmsqHpgInkuIpBQeWItuaUtui0uVxuICAgICAgICAvL2Vsc2V7XG4gICAgICAgIC8vICAgIGlmKHRoaXMuX3NlbGVjdGVkQUFJbmRleCA9PSBudWxsKXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyOFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjU2XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiODRcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvLyAgICAvL0FB5Yi25pS26LS56YCJ5LiK5LqGXG4gICAgICAgIC8vICAgIGVsc2V7XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiN1wiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkyMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDEpe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjE0XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTMw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMil7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMjFcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgfVxuICAgICAgICAvL31cbiAgICB9LFxufSk7XG4iXX0=