require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"ArrayExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4fd85NSsFJLd4qHrH0UjHzl', 'ArrayExtension');
// scripts\Extensions\ArrayExtension.js

// 给 Array 添加方法
// arr.find(...)
// arr.findIndex(...)
// arr.includes(e)
// arr.unique(equalFunction, isNewArray)
// Array.from
// Array.equal
// arr.isEqual(otherArray, isStrict)
// Array.sortByNumber
// arr.findSubArrayIndexs([])   用于查找数组内的部分元素的索引
// arr.translationWithStartIndex(startIndex) 将数组内的元素平移
// 如：[1, 2, 3, 4, 5].translationWithStartIndex(3) => [4,5,1,2,3]
// arr.kq_insert(index, e)   插入一个元素
// arr.kq_excludes(array)   // 除了array数组中的元素

module.exports = {};

if (!Array.prototype.find) {
  Array.prototype.find = function (predicate) {
    'use strict';
    if (this == null) {
      throw new TypeError('Array.prototype.find called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return value;
      }
    }
    return undefined;
  };
}

if (!Array.prototype.findIndex) {
  Array.prototype.findIndex = function (predicate) {
    if (this === null) {
      throw new TypeError('Array.prototype.findIndex called on null or undefined');
    }
    if (typeof predicate !== 'function') {
      throw new TypeError('predicate must be a function');
    }
    var list = Object(this);
    var length = list.length >>> 0;
    var thisArg = arguments[1];
    var value;

    for (var i = 0; i < length; i++) {
      value = list[i];
      if (predicate.call(thisArg, value, i, list)) {
        return i;
      }
    }
    return -1;
  };
}

// https://tc39.github.io/ecma262/#sec-array.prototype.includes
if (!Array.prototype.includes) {
  Object.defineProperty(Array.prototype, 'includes', {
    enumerable: false,
    value: function value(searchElement, fromIndex) {

      // 1. Let O be ? ToObject(this value).
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let len be ? ToLength(? Get(O, "length")).
      var len = o.length >>> 0;

      // 3. If len is 0, return false.
      if (len === 0) {
        return false;
      }

      // 4. Let n be ? ToInteger(fromIndex).
      //    (If fromIndex is undefined, this step produces the value 0.)
      var n = fromIndex | 0;

      // 5. If n ≥ 0, then
      //  a. Let k be n.
      // 6. Else n < 0,
      //  a. Let k be len + n.
      //  b. If k < 0, let k be 0.
      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

      // 7. Repeat, while k < len
      while (k < len) {
        // a. Let elementK be the result of ? Get(O, ! ToString(k)).
        // b. If SameValueZero(searchElement, elementK) is true, return true.
        // c. Increase k by 1.
        // NOTE: === provides the correct "SameValueZero" comparison needed here.
        if (o[k] === searchElement) {
          return true;
        }
        k++;
      }

      // 8. Return false
      return false;
    }
  });
}

// unique
if (!Array.prototype.unique) {
  Object.defineProperty(Array.prototype, 'unique', {
    enumerable: false,
    value: function value(equalFunction) {
      var newArray = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      if (newArray) {
        return this._unqiue_new(equalFunction);
      }

      return this._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue_new', {
    enumerable: false,
    value: function value(equalFunction) {
      var array = Array.from(this);

      return array._unqiue(equalFunction);
    }
  });

  Object.defineProperty(Array.prototype, '_unqiue', {
    enumerable: false,
    value: function value(equalFunction) {
      var len = this.length;
      var i = -1;

      while (i++ < len) {
        var j = i + 1;

        for (; j < this.length; ++j) {
          var isEqual = false;
          if (equalFunction) {
            isEqual = equalFunction(this[i], this[j]);
          } else {
            isEqual = this[i] === this[j];
          }

          if (isEqual) {
            this.splice(j--, 1);
          }
        }
      }
      return this;
    }
  });
}

// Production steps of ECMA-262, Edition 6, 22.1.2.1
// Reference: https://people.mozilla.org/~jorendorff/es6-draft.html#sec-array.from
if (!Array.from) {
  Array.from = (function () {
    var toStr = Object.prototype.toString;
    var isCallable = function isCallable(fn) {
      return typeof fn === 'function' || toStr.call(fn) === '[object Function]';
    };
    var toInteger = function toInteger(value) {
      var number = Number(value);
      if (isNaN(number)) {
        return 0;
      }
      if (number === 0 || !isFinite(number)) {
        return number;
      }
      return (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));
    };
    var maxSafeInteger = Math.pow(2, 53) - 1;
    var toLength = function toLength(value) {
      var len = toInteger(value);
      return Math.min(Math.max(len, 0), maxSafeInteger);
    };

    // The length property of the from method is 1.
    return function from(arrayLike /*, mapFn, thisArg */) {
      // 1. Let C be the this value.
      var C = this;

      // 2. Let items be ToObject(arrayLike).
      var items = Object(arrayLike);

      // 3. ReturnIfAbrupt(items).
      if (arrayLike == null) {
        throw new TypeError("Array.from requires an array-like object - not null or undefined");
      }

      // 4. If mapfn is undefined, then let mapping be false.
      var mapFn = arguments.length > 1 ? arguments[1] : void undefined;
      var T;
      if (typeof mapFn !== 'undefined') {
        // 5. else
        // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.
        if (!isCallable(mapFn)) {
          throw new TypeError('Array.from: when provided, the second argument must be a function');
        }

        // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.
        if (arguments.length > 2) {
          T = arguments[2];
        }
      }

      // 10. Let lenValue be Get(items, "length").
      // 11. Let len be ToLength(lenValue).
      var len = toLength(items.length);

      // 13. If IsConstructor(C) is true, then
      // 13. a. Let A be the result of calling the [[Construct]] internal method of C with an argument list containing the single item len.
      // 14. a. Else, Let A be ArrayCreate(len).
      var A = isCallable(C) ? Object(new C(len)) : new Array(len);

      // 16. Let k be 0.
      var k = 0;
      // 17. Repeat, while k < len… (also steps a - h)
      var kValue;
      while (k < len) {
        kValue = items[k];
        if (mapFn) {
          A[k] = typeof T === 'undefined' ? mapFn(kValue, k) : mapFn.call(T, kValue, k);
        } else {
          A[k] = kValue;
        }
        k += 1;
      }
      // 18. Let putStatus be Put(A, "length", len, true).
      A.length = len;
      // 20. Return A.
      return A;
    };
  })();
}

if (!Array.equal) {
  Array.equal = function (arr1, arr2) {
    var strict = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (arr1 === undefined || arr2 === undefined) {
      return false;
    }

    var length = arr1.length;
    if (length !== arr2.length) return false;
    for (var i = 0; i < length; i++) {
      if (strict) {
        if (arr1[i] !== arr2[i]) {
          return false;
        }
      } else {
        var value1 = arr1[i];
        var value2 = arr2[i];
        var result = true;
        if (Array.isArray(value1) && Array.isArray(value2)) {
          result = Array.equal(value1, value2, strict);
        } else {
          result = value1 == value2;
        }
      }
    }

    return true;
  };
}

if (!Array.prototype.isEqual) {
  Object.defineProperty(Array.prototype, 'isEqual', {
    enumerable: false,
    value: function value(otherArray) {
      var strict = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

      return Array.equal(this, otherArray, strict);
    }
  });
}

if (!Array.sortByNumber) {
  Array.sortByNumber = function (n1, n2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    return (n1 - n2) * (asc ? 1 : -1);
  };
}

if (!Array.prototype.findSubArrayIndexs) {
  Object.defineProperty(Array.prototype, 'findSubArrayIndexs', {
    enumerable: false,
    value: function value(subArray, f) {
      var _this = this;

      var indexs = [];

      var _loop = function () {
        var subValue = subArray[i];
        var findFunc = f || function (thisValue) {
          return subValue === thisValue;
        };
        var index = _this.findIndex(findFunc);
        if (index >= 0) {
          indexs.push(index);
        } else {
          indexs = [];
          return 'break';
        }
      };

      for (var i in subArray) {
        var _ret = _loop();

        if (_ret === 'break') break;
      }

      return indexs.length > 0 ? indexs : null;
    }
  });
}

if (!Array.prototype.translationWithStartIndex) {
  Object.defineProperty(Array.prototype, 'translationWithStartIndex', {
    enumerable: false,
    value: function value(startIndex) {
      if (startIndex == 0) {
        return this;
      }

      if (startIndex >= this.length) {
        return this;
      }

      var pre = this.slice(startIndex);
      var last = this.slice(0, startIndex);
      var result = pre.concat(last);

      return result;
    }
  });
}

if (!Array.prototype.kq_insert) {
  Object.defineProperty(Array.prototype, 'kq_insert', {
    enumerable: false,
    value: function value(index, e) {
      if (e == null) {
        return this;
      }

      if (index >= this.length) {
        this.push(e);
        return;
      }

      this.splice(index, 0, e);

      return this;
    }
  });
}

if (!Array.prototype.kq_excludes) {
  Object.defineProperty(Array.prototype, 'kq_excludes', {
    enumerable: false,
    value: function value(otherArray) {
      if (otherArray == null) {
        return this;
      }

      var result = [];
      this.forEach(function (element) {
        if (!otherArray.includes(element)) {
          result.push(element);
        }
      });

      return result;
    }
  });
}

cc._RFpop();
},{}],"AudioManager":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd5deKFuSZAC4Ky0zI4+z6O', 'AudioManager');
// scripts\Audio\AudioManager.js

var manager = require('manager');

var AudioManager = cc.Class({
    'extends': cc.Component,

    properties: {
        hall_bgm: {
            'default': null,
            url: cc.AudioClip
        },

        game_bgm: {
            'default': null,
            url: cc.AudioClip
        },

        compare_bgm: {
            'default': null,
            url: cc.AudioClip
        },

        // 打枪
        daQiang: {
            'default': null,
            url: cc.AudioClip
        },

        buttonClickSure: {
            'default': null,
            url: cc.AudioClip
        },

        fapai: {
            'default': null,
            url: cc.AudioClip
        },

        click_public: {
            'default': null,
            url: cc.AudioClip
        },
        click_cancel: {
            'default': null,
            url: cc.AudioClip
        },
        click_createRoom: {
            'default': null,
            url: cc.AudioClip
        },
        window: {
            'default': null,
            url: cc.AudioClip
        },
        click_weixin_login: {
            'default': null,
            url: cc.AudioClip
        },
        fangPai: {
            'default': null,
            url: cc.AudioClip
        }
    },

    statics: {
        instance: null
    },

    onLoad: function onLoad() {
        AudioManager.instance = this;
        this._registerAppActiveChange();

        this.soundOn = true;
        cc.game.addPersistRootNode(this.node);
        if (cc.game.isPersistRootNode(this.node)) {
            cc.log('添加全局节点成功');
        }
        this.mValue = manager.getMusicValue();
        this.mEValue = manager.getMusicEffectValue();
        this.bgAudioId = -1;
    },

    stopHallMusic: function stopHallMusic() {
        cc.audioEngine.stop(this.bgAudioId);
    },

    playMusic: function playMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.hall_bgm, true);
        if (this.bgAudioId != -1) {
            cc.log('play');
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
        //cc.audioEngine.playMusic( url, true )
    },

    /*playDeskMusic: function() {
        this.bgAudioId = cc.audioEngine.playMusic( this.game_bgm, true);
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId,this.mValue);
        }
    },*/

    playCompareCardsMusic: function playCompareCardsMusic() {
        this.bgAudioId = cc.audioEngine.playMusic(this.compare_bgm, true);
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, this.mValue);
        }
    },

    playDaQiang: function playDaQiang() {
        for (var start = 0; start <= 1.6; start = start + 0.5) {
            this.scheduleOnce((function () {
                this._playSFX(this.daQiang);
            }).bind(this), start);
        }
    },

    // “打枪”
    playHumanDaQiang: function playHumanDaQiang() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = "resources/sounds/" + (sex == 1 ? "man" : "woman");
        path = path + "/daqiang1.wav";

        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playPokerClick: function playPokerClick() {
        var url = cc.url.raw('resources/sounds/public/poker_click.wav');
        this._playSFX(url);
    },

    // 播放全垒打音效
    playHomeRun: function playHomeRun() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "special1.wav";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放发牌音效
    playFaPai: function playFaPai() {
        this._playSFX(this.fapai);
        for (var index = 0; index < 6; index++) {
            this.scheduleOnce((function () {
                this._playSFX(this.fapai);
            }).bind(this), index * 0.1);
        }
    },

    playCardType: function playCardType() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];
        var type = arguments.length <= 1 || arguments[1] === undefined ? -1 : arguments[1];

        // 只播放普通类型的语音
        if (type >= 10 || type < 0) {
            // 10 及以上是特殊牌
            var _path = this._soundsHumanPath(sex) + type + ".wav";
            var _url = cc.url.raw(_path);
            this._playSFX(_url);
            return;
        }

        var path = this._soundsHumanPath(sex) + "common" + (type + 1) + ".wav";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    // 播放 开始比牌
    playStartCompare: function playStartCompare() {
        var sex = arguments.length <= 0 || arguments[0] === undefined ? 1 : arguments[0];

        var path = this._soundsHumanPath(sex) + "start_compare.wav";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    playWin: function playWin() {
        var url = cc.url.raw('resources/sounds/openface/win.mp3');
        this._playSFX(url);
    },

    playLose: function playLose() {
        var url = cc.url.raw('resources/sounds/openface/lose.mp3');
        this._playSFX(url);
    },

    _soundsHumanPath: function _soundsHumanPath(sex) {
        var path = "resources/sounds/" + (sex == 1 ? "man" : "woman") + "/";
        return path;
    },

    setBgMusicVolumn: function setBgMusicVolumn(value) {
        this.mValue = value;
        if (this.bgAudioId != -1) {
            cc.audioEngine.setVolume(this.bgAudioId, value);
        }
    },

    setEffectMusicVolum: function setEffectMusicVolum(value) {
        this.mEValue = value;
    },

    /*聊天*/
    playChatAudio: function playChatAudio(sex, str) {
        var index = this.chatTexts().indexOf(str);
        if (index === -1) {
            return;
        }

        var number = (sex == 1 ? 1000 : 2000) + index;
        var path = "resources/sounds/chat/" + number + ".wav";
        var url = cc.url.raw(path);
        this._playSFX(url);
    },

    /*'很高兴和你们一起打牌！',
        '快点儿吧，我等得花儿都谢了~！',
        '急什么，让我想想怎么打！',
        '这牌真好，全垒打有希望啊！',
        '我是一个神枪手，打抢本领大！',
        '这把牌敢不敢再水一点啊！',
        '又输啦！大爷给条活路吧！',
        '你是妹妹 还是哥哥啊',
        '交个朋友吧。。',
        '我有事先走了，下次再玩吧！',
        '再见了 我会想念大家的，，',
        '怎么又断线了  网络怎么这么差啊，，'
    */
    chatTexts: function chatTexts() {
        return ['不要吵了，专心玩游戏吧！', '大家不要走，决战到天亮~！', '大家好，很高兴见到各位！', '各位不好意思，我离开一会！', '和你合作真是太愉快了！', '快点儿啊，都等得我花都谢了！', '你的牌打得太好了！', '你是妹妹 还是哥哥啊', '交个朋友吧。。', '我有事先走了，下次再玩吧！', '再见了 我会想念大家的，，', '怎么又断线了  网络怎么这么差啊，，'];
    },

    pauseMusic: function pauseMusic() {
        this.soundOn = false;
        cc.audioEngine.pauseMusic();
    },

    resumeMusic: function resumeMusic() {
        this.soundOn = true;
        cc.audioEngine.resumeMusic();
    },

    _playSFX: function _playSFX(clip) {
        if (this.soundOn) {
            var audioId = cc.audioEngine.playEffect(clip, false);
            cc.audioEngine.setVolume(audioId, this.mEValue);
            return audioId;
        }

        return null;
    },

    // MARK: 前后台操作
    _registerAppActiveChange: function _registerAppActiveChange() {
        cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
        cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
    },

    /**
      * 进入后台
      */
    _appEnterBackground: function _appEnterBackground() {
        var now = cc.sys.now();
        if (now - this._lastAppEnterBackgroundTime < 100) {
            return;
        }
        this._lastAppEnterBackgroundTime = now;

        this.pauseMusic();
    },

    /**
     * 进入前台 
     */
    _appBecomActive: function _appBecomActive() {
        var now = cc.sys.now();
        if (now - this._lastAppBecomActiveTime < 100) {
            return;
        }
        this._lastAppBecomActiveTime = now;

        this.resumeMusic();
    },

    /*确定按钮音效*/
    playBtnClickSFX: function playBtnClickSFX() {
        this._playSFX(this.buttonClickSure);
    },
    /*公共按钮，按键或者关闭按钮之类的音效*/
    palyBtnPublicSFX: function palyBtnPublicSFX() {
        this._playSFX(this.click_public);
    },

    /*取消按钮音效*/
    palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
        this._playSFX(this.click_cancel);
    },
    palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
        this._playSFX(this.click_createRoom);
    },
    palyWindowSFX: function palyWindowSFX() {
        this._playSFX(this.window);
    },
    palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
        this._playSFX(this.click_weixin_login);
    },
    palyFangPaiSFX: function palyFangPaiSFX() {
        this._playSFX(this.fangPai);
    }
});

module.exports = AudioManager;

cc._RFpop();
},{"manager":"manager"}],1:[function(require,module,exports){
'use strict'

exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function placeHoldersCount (b64) {
  var len = b64.length
  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // the number of equal signs (place holders)
  // if there are two placeholders, than the two characters before it
  // represent one byte
  // if there is only one, then the three characters before it represent 2 bytes
  // this is just a cheap hack to not do indexOf twice
  return b64[len - 2] === '=' ? 2 : b64[len - 1] === '=' ? 1 : 0
}

function byteLength (b64) {
  // base64 is 4/3 + up to two characters of the original data
  return b64.length * 3 / 4 - placeHoldersCount(b64)
}

function toByteArray (b64) {
  var i, j, l, tmp, placeHolders, arr
  var len = b64.length
  placeHolders = placeHoldersCount(b64)

  arr = new Arr(len * 3 / 4 - placeHolders)

  // if there are placeholders, only get up to the last complete 4 chars
  l = placeHolders > 0 ? len - 4 : len

  var L = 0

  for (i = 0, j = 0; i < l; i += 4, j += 3) {
    tmp = (revLookup[b64.charCodeAt(i)] << 18) | (revLookup[b64.charCodeAt(i + 1)] << 12) | (revLookup[b64.charCodeAt(i + 2)] << 6) | revLookup[b64.charCodeAt(i + 3)]
    arr[L++] = (tmp >> 16) & 0xFF
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  if (placeHolders === 2) {
    tmp = (revLookup[b64.charCodeAt(i)] << 2) | (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[L++] = tmp & 0xFF
  } else if (placeHolders === 1) {
    tmp = (revLookup[b64.charCodeAt(i)] << 10) | (revLookup[b64.charCodeAt(i + 1)] << 4) | (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[L++] = (tmp >> 8) & 0xFF
    arr[L++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] + lookup[num >> 12 & 0x3F] + lookup[num >> 6 & 0x3F] + lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var output = ''
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    output += lookup[tmp >> 2]
    output += lookup[(tmp << 4) & 0x3F]
    output += '=='
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + (uint8[len - 1])
    output += lookup[tmp >> 10]
    output += lookup[(tmp >> 4) & 0x3F]
    output += lookup[(tmp << 2) & 0x3F]
    output += '='
  }

  parts.push(output)

  return parts.join('')
}

},{}],2:[function(require,module,exports){
(function (global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */

'use strict'

var base64 = require('base64-js')
var ieee754 = require('ieee754')
var isArray = require('isarray')

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"base64-js":1,"ieee754":3,"isarray":4}],3:[function(require,module,exports){
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = nBytes * 8 - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = (value * c - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}

},{}],4:[function(require,module,exports){
var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};

},{}],"CardPrefab":[function(require,module,exports){
"use strict";
cc._RFpush(module, '94cdbrbPc9KRqx+1sHumWI3', 'CardPrefab');
// scripts\CardPrefab.js

var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    graySprite: cc.Sprite,

    _cardName: null,
    _kqCardMode: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.graySprite.node.active = false;
  },

  // 通过牌名设置牌
  setCard: function setCard(cardName) {
    this._setCardName(cardName);

    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._kqCardMode;
  },

  _setCardName: function _setCardName(cardName) {
    this._cardName = cardName;
    this._kqCardMode = new KQCard(cardName);
  },

  // 设置选择状态
  setSelected: function setSelected() {
    var selected = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.graySprite.node.active = selected;
  },

  isSelected: function isSelected() {
    return this.graySprite.node.active;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("images/pokerList/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"CardTypeCombine":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45c41vwAhFNYYSXDvaKpEP0', 'CardTypeCombine');
// scripts\CardTypeCombine.js

var _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var AudioManager = require('AudioManager');
var play = require('play');
var KQCardScoretsHelper = require('KQCardScoretsHelper');
// 牌类型 component
//
cc.Class({
    'extends': cc.Component,
    statics: {
        instances: null
    },
    properties: {
        cardsLayout: cc.Layout,
        btnDuiZi: cc.Button,
        btnLiangDui: cc.Button,
        btnSanTiao: cc.Button,
        btnShunZi: cc.Button,
        btnTongHua: cc.Button,
        btnHuLu: cc.Button,
        btnTieZhi: cc.Button,
        btnTongHuaShun: cc.Button,
        btnWuTong: cc.Button,
        typeButtonsNode: cc.Node,
        btnDeleteTouDao: cc.Button, // 头道
        btnDeleteZhongDao: cc.Button, // 中道
        btnDeleteWeiDao: cc.Button, // 尾道
        btnCancelAll: cc.Button, // 全部取消
        btnDone: cc.Button, // 确定出牌
        timeNode: cc.Node,
        labelTime: cc.Label,
        layoutTouDao: cc.Layout,
        layoutZhongDao: cc.Layout,
        layoutWeiDao: cc.Layout,

        cardPrefab: cc.Prefab,
        cardTypePrefab: cc.Prefab,
        gongXiNi: cc.Node,
        teShuPai: cc.Node,
        /*#####*/
        wuTong_img: cc.SpriteFrame,
        tongHuaShun_img: cc.SpriteFrame,
        BtnClickGongXiNiComfirm: false, //用于检查用户是否点击了恭喜你页面的确定按钮
        cardsLayoutSortColor: false,
        /*#####*/

        _cardOffsetY: null,

        _kqCardModes: [],
        _allCardModes: [],
        _findCardTypeObject: null, // 用来记录找到的牌型对象

        _finishSelectCardsCallback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.BtnClickGongXiNiComfirm = false;
        this.cardsLayoutSortColor = false;
        this._cardOffsetY = 0;
        this._registerTouchEvents();
        this._registerDaosLayoutClickEvent();
        this.reset();
    },

    /*#####点击空白地方将牌收回去*/
    onClickCardTypeCombineNode: function onClickCardTypeCombineNode() {
        this._resetCardsPositionY();
    },

    _hideDeleteButtons: function _hideDeleteButtons() {
        this.btnDeleteTouDao.node.active = false;
        this.btnDeleteZhongDao.node.active = false;
        this.btnDeleteWeiDao.node.active = false;
    },

    // 重置，回到最初始有状态
    reset: function reset() {
        this._hideDeleteButtons();
        this.clearCards();
        this.timeStop();
        this._typeButtons().forEach(function (button) {
            button.interactable = false;
        });
        this._allCardModes = [];
    },

    cardsLayoutSort: function cardsLayoutSort(e) {
        cc.log(cc.maPai);
        var nodeAyy = e.target.children;
        if (nodeAyy[0].active == true) {
            //按大小
            this.cardsLayoutSortColor = true;
            nodeAyy[0].active = false;
            nodeAyy[1].active = true;
            this._resetCardsPositionX();
            return;
        } else if (nodeAyy[1].active == true) {
            //按花色
            this.cardsLayoutSortColor = false;
            nodeAyy[0].active = true;
            nodeAyy[1].active = false;
            this._resetCardsPositionX();
        }
        //this.cardsLayoutSortColor = nodeAyy[1].active == false;
        //this.cardsLayoutSortColor == true
    },

    addCards: function addCards(cardNames) {
        cc.assert(cardNames);
        this._resetCardsPositionY();
        //cardNames.sort(function(a1,a2){
        //    return a1.split('_')[0] - a2.split('_')[0];
        //})
        cardNames.forEach((function (card, index) {
            this.addCard(card, false, index);
        }).bind(this));
        //this.cardsLayoutSort();
        this._resetCardsPositionX();
        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels(this._kqCardModes);
    },

    addCard: function addCard(cardName) {
        var autoChangePositionX = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var index = arguments.length <= 2 || arguments[2] === undefined ? null : arguments[2];

        cc.assert(cardName.length > 0);

        var cardPrefab = cc.instantiate(this.cardPrefab);
        cardPrefab.name = cardName;
        if (cc.maPai) {
            var cardMaPai = '3_' + cc.maPai;
            if (cardName == cardMaPai) {
                cardPrefab.color = new cc.Color(226, 145, 145);
            }
        }
        cardPrefab.getComponent('CardPrefab').setCard(cardName, index);
        this.cardsLayout.node.addChild(cardPrefab);
        cardPrefab.setPositionY(this._cardOffsetY);

        if (autoChangePositionX) {
            this._resetCardsPositionX();
        }
        //let newCard = new KQCard(cardName,null,index);
        //let originCard = this._allCardModes.find(function(card) {
        //    return card.isEqual(newCard);
        //});
        //if (originCard == null && !autoChangePositionX) {
        //    this._allCardModes.push(newCard);
        //}
    },

    addCardModes: function addCardModes(cardNames) {
        cc.assert(cardNames.length > 0);
        this._allCardModes = [];
        cardNames.forEach((function (cardName, index) {
            var newCard = new KQCard(cardName, null, index);
            this._allCardModes.push(newCard);
        }).bind(this));
    },

    reloadCards: function reloadCards(cardNames) {
        //cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //三度同花
        // cardNames=['2_13', '2_5', '2_7', '3_1', '3_2', '3_4', '3_3', '3_13', '1_12', '1_6', '1_1', '1_4', '1_5'];
        //三同花顺
        //  cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '4_1', '4_2', '4_3'];
        //一条龙
        // cardNames=['2_1', '2_2', '2_3', '2_4', '2_5', '3_6', '3_7', '3_8', '3_9', '3_10', '1_11', '1_12', '1_13'];
        //三顺子
        //cardNames=['4_1', '3_2', '4_3', '1_7', '4_5', '4_6', '3_9', '4_8', '3_1', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_9', '3_9', '4_8', '3_10', '1_13', '4_12', '4_11', '2_10'];
        // cardNames=['3_5', '3_4', '4_3', '1_2', '3_1', '4_5', '3_6', '4_8', '3_6', '1_13', '4_12', '4_11', '2_7'];
        //cardNames=['3_4', '3_4', '4_6', '2_20', '1_20', '1_20', '3_6', '4_8', '3_6', '1_8', '4_12', '4_11', '2_20'];
        //三丰天下
        //cardNames=['1_1', '2_1', '3_1', '1_2', '2_2', '3_2', '4_1', '4_2', '3_3', '2_3', '1_3', '4_3', '1_13'];
        //4丰天下
        // cardNames=['1_1', '2_1', '3_1', '1_4', '2_4', '3_2', '4_2', '1_2', '3_4', '2_3', '1_3', '4_3', '1_2'];
        //六岁半
        // cardNames=['1_1', '2_1', '3_11', '1_12', '2_2', '3_2', '4_11', '4_12', '3_13', '2_5', '1_13', '4_3', '1_3'];
        //cardNames=['1_9', '2_11', '3_8', '1_12', '2_2', '3_2', '1_13', '2_5', '3_5','1_4', '2_4', '3_4', '3_10'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //   cardNames=['4_2', '2_3', '3_4', '3_5', '2_1', '2_4', '2_2', '2_5', '2_13','2_8', '2_10', '2_11', '2_12'];
        //cardNames=['4_1', '2_1', '1_4', '3_4', '1_6', '2_6', '1_8', '3_8', '2_8','2_12', '1_12', '2_13', '3_13'];
        // cardNames=['4_9', '2_3', '3_4', '3_6', '2_8', '2_9', '2_10', '2_11', '2_13','3_13', '3_12', '2_12', '1_12'];
        // cardNames=['4_9', '2_9', '3_4', '3_6', '1_8', '2_1', '2_5', '2_4', '2_3','3_13', '3_12', '2_2', '1_12'];
        //cardNames=['3_2', '4_2', '2_4', '3_5', '1_5', '3_7', '2_7', '3_10', '2_1','2_13', '2_10', '2_12', '2_11'];
        //cardNames=['4_2', '4_3', '4_4', '4_5', '4_5', '4_6', '4_12', '4_13', '2_12','3_12', '2_8', '3_8', '2_11'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '3_5', '2_5', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_3', '1_3', '4_5', '4_5', '2_20', '1_20', '1_20', '4_11', '3_12','4_12', '4_8', '4_1', '1_12'];
        //cardNames=['4_10', '4_11', '4_13', '4_5', '2_20', '1_20', '1_20', '4_12', '3_12','4_12', '4_8', '2_12', '1_12'];
        this.clearCards();
        this._kqCardModes = [];
        this.addCards(cardNames);
    },

    clearCards: function clearCards() {
        this.cardsLayout.node.removeAllChildren();
        this.layoutTouDao.node.removeAllChildren();
        this.layoutZhongDao.node.removeAllChildren();
        this.layoutWeiDao.node.removeAllChildren();
    },

    removeCard: function removeCard(cardName) {
        if (!cardName.length) {
            return;
        }

        this.cardsLayout.node.getChildByName(cardName).removeFromParent();
    },

    setFinishSelectCardsCallback: function setFinishSelectCardsCallback(callback) {
        this._finishSelectCardsCallback = callback;
        this.node.active = false;
    },

    _reloadKQCardModesInner: function _reloadKQCardModesInner() {
        this._kqCardModes = this.cardsLayout.node.children.map(function (cardPrefabNode) {
            var cardPrefab = cardPrefabNode.getComponent('CardPrefab');
            return cardPrefab.cardMode();
        }).sort(KQCard.sort);
        this._findCardTypeObject = null;
    },

    _typeButtons: function _typeButtons() {
        return [this.btnDuiZi, this.btnLiangDui, this.btnSanTiao, this.btnShunZi, this.btnTongHua, this.btnHuLu, this.btnTieZhi, this.btnTongHuaShun];
    },

    /*#####*/
    //this.btnWuTong,
    /*#####*/
    _resetTypeButtonEnablesWithModels: function _resetTypeButtonEnablesWithModels(cardModes) {
        /*cardModes.length == 13*/
        cardModes = cardModes || this._kqCardModes;

        /*#####初始化牌*/
        var ButtonsLayoutChilds = this.typeButtonsNode.children;
        for (var i = 0; i < ButtonsLayoutChilds.length; i++) {
            ButtonsLayoutChilds[i].interactable = false;
        }

        this.btnDuiZi.interactable = KQCard.containDuiZi(cardModes);
        this.btnLiangDui.interactable = KQCard.containLiaDui(cardModes);
        this.btnSanTiao.interactable = KQCard.containSanTiao(cardModes);
        this.btnShunZi.interactable = KQCard.containShunZi(cardModes);
        this.btnTongHua.interactable = KQCard.containTongHua(cardModes);
        this.btnHuLu.interactable = KQCard.containHuLu(cardModes);
        this.btnTieZhi.interactable = KQCard.containTieZhi(cardModes);
        this.btnTongHuaShun.interactable = KQCard.containTongHuaShun(cardModes);
        //this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        //KQCard.isTeShuPai(cardModes)
        //let typeName = KQCard.cardsTypeName(cardModes);
        //KQCard.isLiuDuiBan(cardModes);
        //cc.log(typeName); cc.log('特殊牌name');
        //alert(this.btnShunZi.interactable)
        /*#####如果有多一色，就是设置无同按钮的可交互性*/
        //if(cc.duoYiSe == 0) {
        //    this.wuTongNode = this.typeButtonsNode.getChildByName("btnWuTong");
        //    this.btnWuTong = this.wuTongNode.getComponent(cc.Button);
        //    this.btnWuTong.interactable = KQCard.containWuTong(cardModes);
        //}
        /*#####*/

        this._autoActiveTypeButtons();

        /*#####设置按钮可交互和不可交互时的透明度*/
        for (var i = 0; i < ButtonsLayoutChilds.length; i++) {
            if (ButtonsLayoutChilds[i].getComponent(cc.Button).interactable) {
                ButtonsLayoutChilds[i].opacity = 255;
            } else {
                ButtonsLayoutChilds[i].opacity = 125;
            }
        }
    },

    // 将找到了牌类型的牌突出出来
    _stickOutFindCardType: function _stickOutFindCardType(title, findMethods) {

        // 先根据牌类型找出所有的索引集合
        var findedIndexsArray = null;
        this._findCardTypeObject = this._findCardTypeObject || {};
        if (this._findCardTypeObject.title != title) {
            findedIndexsArray = (findMethods() || []).reverse();

            for (var i = 0; i < findedIndexsArray.length - 1; i++) {
                //删除同类型牌
                var index = findedIndexsArray[i];
                /*if(title == 'liangDui'){
                 let jStringspoint = index.map(function(indexs){
                 return this._kqCardModes[indexs].point;
                 }.bind(this));
                 var isBreak = false;
                 var repNum = jStringspoint.reduce(function(p,n){
                 if(!p[n]){
                 p[n] = 1;
                 }else{
                 p[n] += 1
                 }
                 return p
                 },{});
                 for(var y in repNum){
                 if(repNum[y] >= 3){
                 isBreak = true;
                 }
                 }
                 if(isBreak){
                 cc.log(repNum)
                 cc.log(findedIndexsArray)
                 cc.log(i)
                 cc.log('--------291')
                 findedIndexsArray.splice(i,1);
                 continue;
                 }
                 }*/
                var iString = '';
                for (var j = i + 1; j < findedIndexsArray.length; j++) {
                    var s = findedIndexsArray[j];
                    var jString = '';

                    var iStrings = s.map((function (index) {
                        var cardModel = this._kqCardModes[index];
                        return cardModel.cardName();
                    }).bind(this));

                    var jStrings = index.map((function (indexs) {
                        var cardModel = this._kqCardModes[indexs];
                        return cardModel.cardName();
                    }).bind(this));

                    for (var r = 0; r < index.length; r++) {
                        jString = jString + iStrings[r];
                        iString = iString + jStrings[r];
                    }

                    if (jString == iString) {
                        findedIndexsArray.splice(i, 1);
                        break;
                    }
                }
            }

            this._findCardTypeObject = {
                title: title,
                indexsArray: findedIndexsArray,
                //index: title=="duiZi"?findedIndexsArray.length-1:0
                index: 0
            };
        }

        findedIndexsArray = this._findCardTypeObject.indexsArray;
        if (!findedIndexsArray || findedIndexsArray.length == 0) {
            return;
        }
        // 将已有的突出的牌的位置重置回初始位置
        this._resetCardsPositionY();

        // 计算出要突出的牌数组
        var index = this._findCardTypeObject.index;
        var indexs = findedIndexsArray[index];

        var selectedCardNames = indexs.map((function (index) {
            var cardModel = this._kqCardModes[index];
            return cardModel.cardName();
        }).bind(this));

        //cc.log(selectedCardNames)
        var cardNodes = this.cardsLayout.node.children.filter(function (cardNode) {
            var cardPrefab = cardNode.getComponent('CardPrefab');
            if (selectedCardNames.includes(cardPrefab.cardName())) {
                var nameIndex = selectedCardNames.indexOf(cardPrefab.cardName());
                selectedCardNames.splice(nameIndex, 1);
                return true;
            }
            return false;
        });
        //cc.log(cardNodes)
        //cc.log(index)
        //cc.log(findedIndexsArray)
        //cc.log('----------248')
        // 突出计算出来的牌数组
        this._changeCardPrefabsY(cardNodes);
        // 保存好，用于再次点击了突出下一组牌
        index = (index + 1) % findedIndexsArray.length;
        this._findCardTypeObject.index = index;
    },

    clickDuiZi: function clickDuiZi() {
        this._stickOutFindCardType("duiZi", (function () {
            return KQCard.findDuiZi(this._kqCardModes);
        }).bind(this));
    },

    clickLiangDui: function clickLiangDui() {
        this._stickOutFindCardType("liangDui", (function () {
            return KQCard.findLiaDui(this._kqCardModes);
        }).bind(this));
    },

    clickSanTiao: function clickSanTiao() {
        this._stickOutFindCardType("sanTiao", (function () {
            return KQCard.findSanTiao(this._kqCardModes);
        }).bind(this));
    },

    clickShunZi: function clickShunZi() {
        this._stickOutFindCardType("shunZi", (function () {
            return KQCard.findShunZi(this._kqCardModes);
        }).bind(this));
    },

    clickTongHua: function clickTongHua() {
        this._stickOutFindCardType("tongHua", (function () {
            return KQCard.findTongHua(this._kqCardModes);
        }).bind(this));
    },

    clickHuLu: function clickHuLu() {
        this._stickOutFindCardType("huLu", (function () {
            return KQCard.findHuLu(this._kqCardModes);
        }).bind(this));
    },

    clickTieZhi: function clickTieZhi() {
        this._stickOutFindCardType("tieZhi", (function () {
            return KQCard.findTieZhi(this._kqCardModes);
        }).bind(this));
    },

    /*#####*/
    clickWuTong: function clickWuTong() {
        //console.log("点击了五同按钮");
        this._stickOutFindCardType("wuTong", (function () {
            return KQCard.findWuTong(this._kqCardModes);
        }).bind(this));
    },
    /*#####*/

    clickTongHuaShun: function clickTongHuaShun() {
        this._stickOutFindCardType("tongHuaShun", (function () {
            return KQCard.findTongHuaShun(this._kqCardModes);
        }).bind(this));
    },

    clickCancelAll: function clickCancelAll() {
        this.clickDeleteTouDao();
        this.clickDeleteZhongDao();
        this.clickDeleteWeiDao();
    },

    /*点击完成按钮*/
    clickDone: function clickDone() {
        var touCardModels = this._taoDaoCardModes();
        var zhongCardModes = this._zhongDaoCardModes();
        var weiCardModes = this._weiDaoCardModes();
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    /*点击恭喜你页面的确定按钮*/
    onBtnGongXiNiComfirmClick: function onBtnGongXiNiComfirmClick() {
        //记录玩家点击了确定按钮：
        this.BtnClickGongXiNiComfirm = true;
        //先要得到玩家的13张牌 teShuPaiCards[{'number':1,'suit':'s'},{...},{...}]
        var teShuPaiCards = cc.teShuPaiCards;
        console.log(teShuPaiCards);
        var teShuPaiCardsServerInfo = this._convertCardsToServerModel2(teShuPaiCards);
        var result = [teShuPaiCardsServerInfo];
        console.log("点击了恭喜你页面的确定按钮");
        console.log(teShuPaiCardsServerInfo);
        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    _didSelectedCards: function _didSelectedCards(touCards, zhongCards, weiCards) {
        touCards = touCards || [];
        zhongCards = zhongCards || [];
        weiCards = weiCards || [];
        var touServerInfo = this._convertCardsToServerModel(touCards);
        var zhongServerInfo = this._convertCardsToServerModel(zhongCards);
        var weiServerInfo = this._convertCardsToServerModel(weiCards);
        var result = [touServerInfo, zhongServerInfo, weiServerInfo];

        if (this._finishSelectCardsCallback) {
            this._finishSelectCardsCallback(result);
        }
    },

    clickDeleteTouDao: function clickDeleteTouDao() {
        this._deleteDaoCardsOfLayout(this.layoutTouDao.node);
    },

    clickDeleteZhongDao: function clickDeleteZhongDao() {
        this._deleteDaoCardsOfLayout(this.layoutZhongDao.node);
    },

    clickDeleteWeiDao: function clickDeleteWeiDao() {
        this._deleteDaoCardsOfLayout(this.layoutWeiDao.node);
    },

    // 计时器事件
    timeStart: function timeStart(duration) {
        cc.assert(duration > 0);
        this.timeStop();
        this.timeNode.active = true;

        this._timeRemainDuration = duration;
        this.labelTime.string = String(duration);
        this.schedule(this._timeMethod, 1, duration);
    },

    timeStop: function timeStop() {
        this.unschedule(this._timeMethod);
        this.timeNode.active = false;
    },

    _timeMethod: function _timeMethod() {
        this._timeRemainDuration = this._timeRemainDuration - 1;

        var remain = Math.max(this._timeRemainDuration, 0);
        this.labelTime.string = remain < 10 && remain > 0 ? '0' + remain : remain;

        if (this._timeRemainDuration <= 0) {
            this.timeStop();
            this._timeOutAutoSelectCards();
            return;
        }
    },

    // 超时后，自动选牌
    _timeOutAutoSelectCards: function _timeOutAutoSelectCards() {
        /**
         * 隐藏恭喜你
         */
        play.gongXiNiShow(false);
        if (typeof cc.teShuPaiCards != "undefined" && cc.teShuPaiCards != null && cc.teShuPaiCards != '') {
            this.onBtnGongXiNiComfirmClick();
            return;
        }

        var _cacleAutoSelectedCards2 = this._cacleAutoSelectedCards();

        var _cacleAutoSelectedCards22 = _slicedToArray(_cacleAutoSelectedCards2, 3);

        var touCardModels = _cacleAutoSelectedCards22[0];
        var zhongCardModes = _cacleAutoSelectedCards22[1];
        var weiCardModes = _cacleAutoSelectedCards22[2];

        if (touCardModels == null || zhongCardModes == null || weiCardModes == null) {
            touCardModels = this._allCardModes.slice(-3);
            zhongCardModes = this._allCardModes.slice(5, 10);
            weiCardModes = this._allCardModes.slice(0, 5);
        }

        cc.log(touCardModels);
        cc.log(zhongCardModes);
        cc.log(weiCardModes);
        cc.log(this._allCardModes);
        cc.log("自动选牌 touCardModels zhongCardModes weiCardModes：");
        this._didSelectedCards(touCardModels, zhongCardModes, weiCardModes);
    },

    _cacleAutoSelectedCards: function _cacleAutoSelectedCards() {
        var cards = this._allCardModes.filter(function (i) {
            return i;
        });
        var resultCards = [];
        for (var i = 1; i < 3; i++) {
            var cardss = KQCard.autoSelectCards(cards, 5);
            cards = cards.kq_excludes(cardss);
            resultCards.push(cardss);
        }
        resultCards.push(cards);
        var touScore = KQCard.scoreOfCards(resultCards[2]);
        var zhongScore = KQCard.scoreOfCards(resultCards[1]);
        var weiScore = KQCard.scoreOfCards(resultCards[0]);
        cc.log(resultCards);
        cc.log(this._allCardModes);
        cc.log("牌分数自动选牌：", touScore, zhongScore, weiScore);
        //let weiCardModes = KQCard.autoSelectCards(cards, 5);
        //cards = cards.kq_excludes(weiCardModes);
        //
        //let zhongCardModes = KQCard.autoSelectCards(cards, 5);
        //
        //let touCardModes = cards.kq_excludes(zhongCardModes);
        //if (touCardModes.length == 3 && zhongCardModes.length == 5 && weiCardModes.length == 5) {
        //    return [touCardModes, zhongCardModes, weiCardModes];
        //}
        if (resultCards[2].length == 3 && resultCards[1].length == 5 && resultCards[0].length == 5) {
            return [resultCards[2], resultCards[1], resultCards[0]];
        }

        return [];
    },

    _convertCardsToServerModel: function _convertCardsToServerModel(cards) {
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = KQCard.scoreOfCards(cards);
        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {
            // 特殊牌
            result.isContainExtra = this._isContainExtraCardsType(result.type, cards);
            //result.isContainExtra = true;
            result.cards = cards;
        } else {
            result.cards = KQCard.convertToServerCards(cards);
        }
        return result;
    },

    /*#####*/
    _convertCardsToServerModel2: function _convertCardsToServerModel2(cards) {
        var result = {};
        result.type = KQCard.cardsType(cards);
        result.value = KQCard.scoreOfCards2(cards);
        if (result.type >= KQCard.TYPE.SanTaoHua && cc.moshi != 1) {
            // 特殊牌
            result.isContainExtra = true;
            result.cards = cards;
        }

        return result;
    },
    /*#####*/
    // 特殊牌里是否还含有特殊牌
    // 包含的情况有：
    // 三桃花 可能含有同花顺
    // 三顺子 可能含有同花顺
    // 六对半 可能含有铁支
    _isContainExtraCardsType: function _isContainExtraCardsType(type, cards) {
        if (type == KQCard.TYPE.SanTaoHua) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.SanShunZi) {
            return KQCard.containTongHuaShun(cards);
        } else if (type == KQCard.TYPE.LiuDuiBan) {
            return KQCard.containTieZhi(cards);
        }
        return false;
    },

    // 触摸事件
    _registerTouchEvents: function _registerTouchEvents() {
        this.cardsLayout.node.on(cc.Node.EventType.TOUCH_START, this._touchCardLayout.bind(this));
        this.cardsLayout.node.on(cc.Node.EventType.TOUCH_MOVE, this._touchCardLayout.bind(this));
        this.cardsLayout.node.on(cc.Node.EventType.TOUCH_END, this._touchCardLayoutEnd.bind(this));
        this.cardsLayout.node.on(cc.Node.EventType.TOUCH_CANCEL, this._touchCardLayoutEnd.bind(this));
    },

    _touchCardLayout: function _touchCardLayout(event) {
        event.bubbles = true;
        var location = event.getLocation();
        var cardPrefab = this._cardPrefabInCardLayoutWithLocation(location);
        if (cardPrefab) {
            cardPrefab.getComponent('CardPrefab').setSelected(true);
            event.stopPropagation();
        }
    },

    _touchCardLayoutEnd: function _touchCardLayoutEnd(event) {
        this._changeSelectedCardPrefabsY();
        this._diseclectCardPrefabs();
    },

    _cardPrefabInCardLayoutWithLocation: function _cardPrefabInCardLayoutWithLocation(location) {
        location = this.cardsLayout.node.convertToNodeSpaceAR(location);
        var cardNodes = this.cardsLayout.node.children.sort(function (cardNode1, cardNode2) {
            var rect1 = cardNode1.getBoundingBox();
            var rect2 = cardNode2.getBoundingBox();
            return rect2.x - rect1.x;
        });
        for (var index in cardNodes) {
            var cardNode = cardNodes[index];

            var rect = cardNode.getBoundingBox();

            if (cc.rectContainsPoint(rect, location)) {
                return cardNode;
            }
        }

        return null;
    },

    _changeSelectedCardPrefabsY: function _changeSelectedCardPrefabsY() {
        var cardNodes = this._selectedCardPrefabs();
        this._changeCardPrefabsY(cardNodes);

        AudioManager.instance.playPokerClick();
    },

    _changeCardPrefabsY: function _changeCardPrefabsY(cardNodes) {
        cardNodes.forEach((function (cardNode) {
            var y = cardNode.getPositionY();
            if (y == this._cardOffsetY) {
                cardNode.setPositionY(this._cardOffsetY + 55);
            } else {
                cardNode.setPositionY(this._cardOffsetY);
            }
        }).bind(this));
    },

    _selectedCardPrefabs: function _selectedCardPrefabs() {
        var includeStickOut = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

        var cardNodes = this.cardsLayout.node.children || [];
        return cardNodes.filter(function (cardNode) {
            var cardPrefab = cardNode.getComponent('CardPrefab');
            var isSelected = cardPrefab.isSelected();
            if (!isSelected && includeStickOut) {
                isSelected = cardNode.getPositionY() > 10;
            }

            return isSelected;
        });
    },

    _diseclectCardPrefabs: function _diseclectCardPrefabs() {
        var cardNodes = this.cardsLayout.node.children;
        cardNodes.forEach(function (node) {
            node.getComponent('CardPrefab').setSelected(false);
        });
    },

    // 重置 cards 的 X
    _resetCardsPositionX: function _resetCardsPositionX() {
        //let interval = 98;
        var interval = 78;
        var cardNodes = this.cardsLayout.node.children || [];
        var length = cardNodes.length;
        if (length == 0) {
            return;
        }

        var middleIndex = length / 2;
        var cardWidth = 154;

        //this.cardsLayoutSort();
        if (this.cardsLayoutSortColor == true) {
            this.cardsLayout.node.children.sort(function (n1, n2) {
                var component1 = n1.getComponent('CardPrefab');
                var component2 = n2.getComponent('CardPrefab');
                return component2.cardMode().color - component1.cardMode().color;
            });
        } else {
            this.cardsLayout.node.children.sort(function (n1, n2) {
                var component1 = n1.getComponent('CardPrefab');
                var component2 = n2.getComponent('CardPrefab');
                return component1.cardMode().sort(component2.cardMode());
            });
        }
        //cardNodes.sort(function (n1, n2) {
        //    let component1 = n1.getComponent('CardPrefab');
        //    let component2 = n2.getComponent('CardPrefab');
        //
        //    return component1.cardMode().sort(component2.cardMode());
        //});

        cardNodes.forEach(function (cardNode, index) {
            cardNode.zIndex = index;
            var x = (index - middleIndex) * interval + cardWidth / 3;
            cardNode.setPositionX(x);
        });
    },

    // 重置 cards 的 X为0
    resetCardsPositionX1: function resetCardsPositionX1() {
        var cardNodes = this.cardsLayout.node.children || [];
        var length = cardNodes.length;
        if (length == 0) {
            return;
        }
        cardNodes.forEach(function (cardNode) {
            cardNode.setPositionY(0);
        });
    },

    _resetCardsPositionY: function _resetCardsPositionY() {
        var cardNodes = this.cardsLayout.node.children || [];
        cardNodes.forEach((function (cardNode) {
            cardNode.setPositionY(this._cardOffsetY);
        }).bind(this));
    },

    // 头、中、尾道 layout 的点击事件
    _registerDaosLayoutClickEvent: function _registerDaosLayoutClickEvent() {
        var layoutTouDao = this.layoutTouDao;
        var layoutZhongDao = this.layoutZhongDao;
        var layoutWeiDao = this.layoutWeiDao;
        var self = this;
        //头道点击
        this.layoutTouDao.node.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickTouDaoLayout(event);
            /*#####点击第二道剩下的牌自动选上去##### begin*/
            //如果剩下的牌小于5张
            if (this.cardsLayout.node.children.length <= 5) {
                //如果尾道填满，把它放入中道
                if (layoutZhongDao.node.children.length < 5 && layoutWeiDao.node.children.length == 5) {
                    // 突出计算出来的牌数组
                    var cardNodes = this.cardsLayout.node.children;
                    self._changeCardPrefabsY(cardNodes);
                    self._addDaoCardToLayout(layoutZhongDao.node);
                }
                //如果中道填满，把它放入尾道
                else if (layoutWeiDao.node.children.length < 5 && layoutZhongDao.node.children.length == 5) {
                        var cardNodes = this.cardsLayout.node.children;
                        self._changeCardPrefabsY(cardNodes);
                        self._addDaoCardToLayout(layoutWeiDao.node);
                    }
            }
            /*#####end*/
        }).bind(this));
        //中道点击
        this.layoutZhongDao.node.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickZhongDaoLayout(event);
            /*#####begin*/
            //中道必须填满才来执行
            if (layoutZhongDao.node.children.length == 5) {
                //如果剩下的牌小于等于5张
                if (this.cardsLayout.node.children.length <= 5) {
                    //如果尾道填满，把它放入头道
                    if (layoutTouDao.node.children.length < 3 && layoutWeiDao.node.children.length == 5) {
                        // 突出计算出来的牌数组
                        var cardNodes = this.cardsLayout.node.children;
                        self._changeCardPrefabsY(cardNodes);
                        self._addDaoCardToLayout(layoutTouDao.node);
                    }
                    //如果头道填满，把它放入尾道
                    else if (layoutWeiDao.node.children.length < 5 && layoutTouDao.node.children.length == 3) {
                            var cardNodes = this.cardsLayout.node.children;
                            self._changeCardPrefabsY(cardNodes);
                            self._addDaoCardToLayout(layoutWeiDao.node);
                        }
                }
            }

            /*#####end*/
        }).bind(this));
        //尾道点击
        this.layoutWeiDao.node.on(cc.Node.EventType.TOUCH_END, (function (event) {
            this._clickWeiDaoLayout(event);
            /*#####begin*/
            //尾道必须填满才来执行
            if (layoutWeiDao.node.children.length == 5) {
                //如果剩下的牌小于等于5张
                if (this.cardsLayout.node.children.length <= 5) {
                    //如果中道填满，把它放入头道
                    if (layoutTouDao.node.children.length < 3 && layoutZhongDao.node.children.length == 5) {
                        // 突出计算出来的牌数组
                        var cardNodes = this.cardsLayout.node.children;
                        self._changeCardPrefabsY(cardNodes);
                        self._addDaoCardToLayout(layoutTouDao.node);
                    }
                    //如果头道填满，把它放入中道
                    else if (layoutZhongDao.node.children.length < 5 && layoutTouDao.node.children.length == 3) {
                            var cardNodes = this.cardsLayout.node.children;
                            self._changeCardPrefabsY(cardNodes);
                            self._addDaoCardToLayout(layoutZhongDao.node);
                        }
                }
            }

            /*#####end*/
        }).bind(this));
    },

    _clickTouDaoLayout: function _clickTouDaoLayout(event) {
        var clickCard = this._daoCardNodeInLayoutWithEvent(this.layoutTouDao.node, event);
        if (clickCard) {
            this._deleteDaoCard(clickCard, true);
            return;
        }
        this._addDaoCardToLayout(this.layoutTouDao.node, 3);
    },

    _clickZhongDaoLayout: function _clickZhongDaoLayout(event) {
        var clickCard = this._daoCardNodeInLayoutWithEvent(this.layoutZhongDao.node, event);
        if (clickCard) {
            this._deleteDaoCard(clickCard, true);
            return;
        }

        this._addDaoCardToLayout(this.layoutZhongDao.node);
    },

    _clickWeiDaoLayout: function _clickWeiDaoLayout(event) {
        var clickCard = this._daoCardNodeInLayoutWithEvent(this.layoutWeiDao.node, event);
        if (clickCard) {
            this._deleteDaoCard(clickCard, true);
            return;
        }
        this._addDaoCardToLayout(this.layoutWeiDao.node);
    },

    _daoCardNodeInLayoutWithEvent: function _daoCardNodeInLayoutWithEvent(node, event) {
        var cardNodes = node.children || [];
        var location = event.getLocation();
        location = node.convertToNodeSpaceAR(location);
        for (var index in cardNodes) {
            var cardNode = cardNodes[index];
            var rect = cardNode.getBoundingBox();
            if (cc.rectContainsPoint(rect, location)) {
                return cardNode;
            }
        }

        return null;
    },

    _addDaoCardToLayout: function _addDaoCardToLayout(node) {
        var maxNumberCard = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

        var cardNodes = node.children || [];
        if (cardNodes.length >= 5) {
            return;
        }

        var remainCount = maxNumberCard - cardNodes.length;
        var selectedCards = this._selectedCardPrefabs(true) || [];
        if (selectedCards.length == 0) {
            return;
        }

        if (selectedCards.length > remainCount) {
            selectedCards = selectedCards.slice(0, remainCount);
        }

        var selectedCardNames = selectedCards.map(function (cardPrefab) {
            return cardPrefab.getComponent('CardPrefab').cardName();
        });

        cardNodes.forEach(function (cardTypeNode) {
            selectedCardNames.push(cardTypeNode.getComponent('CardTypeSprite').cardName());
        });

        var cardModes = selectedCardNames.map(function (cardName, index) {
            return new KQCard(cardName, null, index);
        }).sort(function (c1, c2) {
            return KQCard.sort(c1, c2, false);
        });

        var touCardModes = node == this.layoutTouDao.node ? cardModes : this._taoDaoCardModes();
        var zhongCardModes = node == this.layoutZhongDao.node ? cardModes : this._zhongDaoCardModes();
        var weiCardModes = node == this.layoutWeiDao.node ? cardModes : this._weiDaoCardModes();
        if (!this._isValidCardModes(touCardModes, zhongCardModes, weiCardModes)) {
            return;
        }

        node.removeAllChildren();

        cardModes.forEach((function (cardMode) {
            var cardName = cardMode.cardName();
            var cardTypeSprite = cc.instantiate(this.cardTypePrefab);
            if (cc.maPai) {
                var cardMaPai = '3_' + cc.maPai;
                if (cardName == cardMaPai) {
                    cardTypeSprite.color = new cc.Color(226, 145, 145);
                }
            }
            cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName);
            node.addChild(cardTypeSprite);
        }).bind(this));

        selectedCards.forEach(function (node) {
            node.removeFromParent();
        });
        this._resetCardsPositionY();
        this._resetCardsPositionX();

        this._autoActiveDeleteDaoButtons();

        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels();
    },

    // 删除 头、中或尾道中的某中牌
    _deleteDaoCard: function _deleteDaoCard(cardTypeNode) {
        var reloadTypeButtonEnables = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];

        var cardName = cardTypeNode.getComponent('CardTypeSprite').cardName();
        this.addCard(cardName, true);

        this._resetCardsPositionY();

        cardTypeNode.removeFromParent(true);
        this._autoActiveDeleteDaoButtons();

        if (reloadTypeButtonEnables) {
            this._reloadKQCardModesInner();
            this._resetTypeButtonEnablesWithModels();
        }
    },

    // 删除 头道或中道或尾道上所有的 牌
    _deleteDaoCardsOfLayout: function _deleteDaoCardsOfLayout(daoLayout) {
        var cardNodes = Array.from(daoLayout.children);
        cardNodes.forEach(this._deleteDaoCard.bind(this));

        this._reloadKQCardModesInner();
        this._resetTypeButtonEnablesWithModels();
    },

    // 判断能否使用选择中的牌
    // 即：头道要小于中道、中道要小于尾道
    _isValidCardModes: function _isValidCardModes(touCardModes, zhongCardModes, weiCardModes) {
        touCardModes = touCardModes || [];
        zhongCardModes = zhongCardModes || [];
        weiCardModes = weiCardModes || [];
        cc.log(touCardModes.length, zhongCardModes.length, weiCardModes.length);
        if (touCardModes.length < 3 || zhongCardModes.length < 5 || weiCardModes.length < 5) {
            return true;
        }

        var touScore = KQCard.scoreOfCards(touCardModes);
        var zhongScore = KQCard.scoreOfCards(zhongCardModes);
        var weiScore = KQCard.scoreOfCards(weiCardModes);
        cc.log("牌分数：", touScore, zhongScore, weiScore);
        return touScore < zhongScore && zhongScore <= weiScore;
    },

    // 头道上已有的牌
    _taoDaoCardModes: function _taoDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.layoutTouDao.node.children);
    },

    // 中道上已有的牌
    _zhongDaoCardModes: function _zhongDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.layoutZhongDao.node.children);
    },

    // 尾道上已有的牌
    _weiDaoCardModes: function _weiDaoCardModes() {
        return this._cardModesOfCardPrefabs(this.layoutWeiDao.node.children);
    },

    _cardModesOfCardPrefabs: function _cardModesOfCardPrefabs(cardTypeNodes) {
        if (!cardTypeNodes) {
            return [];
        }

        var cardModes = cardTypeNodes.map(function (node) {
            var component = node.getComponent('CardTypeSprite');
            return component.cardMode();
        });

        return cardModes || [];
    },

    // 自动设置 头、中、尾道的删除按钮的可见性
    _autoActiveDeleteDaoButtons: function _autoActiveDeleteDaoButtons() {
        this._autoActiveDeleteDaoButton(this.layoutTouDao.node, this.btnDeleteTouDao.node);
        this._autoActiveDeleteDaoButton(this.layoutZhongDao.node, this.btnDeleteZhongDao.node);
        this._autoActiveDeleteDaoButton(this.layoutWeiDao.node, this.btnDeleteWeiDao.node);
    },

    _autoActiveDeleteDaoButton: function _autoActiveDeleteDaoButton(layout, button) {
        button.active = layout.children.length > 0;
    },

    // 自动设置 “全部取消”、“确定出牌”、“类型选择”按钮的可见性
    _autoActiveTypeButtons: function _autoActiveTypeButtons() {
        var cardNodes = this.cardsLayout.node.children || [];
        var hasCardUnSelected = cardNodes.length > 0;
        this.btnDone.node.active = !hasCardUnSelected;
        this.btnCancelAll.node.active = this.btnDone.node.active;
        this.typeButtonsNode.active = hasCardUnSelected;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardScoretsHelper":"KQCardScoretsHelper","play":"play"}],"CardTypeSprite":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e614c0FMndAtrOMcy8/PcZw', 'CardTypeSprite');
// scripts\CardTypeSprite.js

var KQCard = require('KQCard');
cc.Class({
  'extends': cc.Component,

  properties: {
    _cardName: null,
    _cardModel: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setCard: function setCard(cardName) {
    this._cardName = cardName;
    this._cardModel = new KQCard(cardName);
    this._loadCardFrame(cardName, (function (spriteFrame) {
      this.node.getComponent('cc.Sprite').spriteFrame = spriteFrame;
    }).bind(this));
  },

  cardName: function cardName() {
    return this._cardName;
  },

  cardMode: function cardMode() {
    return this._cardModel;
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("images/pokerList/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        cc.error(err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
});

cc._RFpop();
},{"KQCard":"KQCard"}],"ChatMessage":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dc8980X2ZVNKrH9BsIsSE4D', 'ChatMessage');
// scripts\Chat\ChatMessage.js

// 用于在游戏过程中，展示用户的聊天消息

var ChatMessage = cc.Class({
  "extends": cc.Component,

  properties: {
    richText: cc.RichText,
    spriteBackground: cc.Sprite
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setString: function setString() {
    var string = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];
    var autoHide = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

    if (string.length == 0) {
      return;
    }

    this.node.active = true;

    var maxWidth = 300;
    var realStr = ChatMessage.parseString(string);

    // 由于 cc.RichText 在指定 maxWidth 后，该结点的 width 会一直
    // 是 maxWidth 值。而在将 maxWidth 指定为0时，其 contentSize.width 会
    // 是内容的真正所需的宽度
    //
    // 所以这里先将 maxWidth 设为 0，获取其实际内容 width 后再调整
    this.richText.maxWidth = 0;
    this.richText.string = realStr;

    var contentWidth = this.richText.node.getContentSize().width;
    if (contentWidth > maxWidth) {
      this.richText.maxWidth = maxWidth;
      this.richText.string = realStr;
      contentWidth = maxWidth;
    }

    this.node.width = contentWidth + 28;
    this.node.height = this.richText.node.getContentSize().height + 20;

    this.spriteBackground.node.width = this.node.width;
    this.spriteBackground.node.height = this.node.height;

    if (autoHide) {
      this.unscheduleAllCallbacks();
      this.scheduleOnce(this._hideNode.bind(this), 3);
    }
  },

  _hideNode: function _hideNode() {
    this.node.active = false;
  }

});

// 将 <bq10> 改为： <img src='bg10'/>
ChatMessage.parseString = function (str) {
  var result = str.replace(/<bq\d{1,2}>/g, function (match) {
    var bq = match.replace("<", " <img src='").replace(">", "'/> ");
    return bq;
  });

  return result;
}, module.exports = ChatMessage;

cc._RFpop();
},{}],"ChatTextRecord":[function(require,module,exports){
"use strict";
cc._RFpush(module, '88d10U9tIpHNK1entoUH0Ju', 'ChatTextRecord');
// scripts\Pefabs\ChatTextRecord.js

cc.Class({
  'extends': cc.Component,

  properties: {},

  // use this for initialization
  onLoad: function onLoad() {},

  setString: function setString(str) {
    this._richText().string = str;
  },

  _richText: function _richText() {
    return this.node.getComponent('cc.RichText');
  }

});

cc._RFpop();
},{}],"CompareCards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9aa4aH/Ha1JfaEeY5nFj5P1', 'CompareCards');
// scripts\Pefabs\CompareCards.js

var KQCardResHelper = require('KQCardResHelper');
var AudioManager = require('AudioManager');
var KQCard = require('KQCard');

cc.Class({
    'extends': cc.Component,

    properties: {
        touLayout: cc.Layout,
        zhongLayout: cc.Layout,
        weiLayout: cc.Layout,
        labelTouScore: cc.Label,
        labelTouScoreRight: cc.Label,
        labelZhongScore: cc.Label,
        labelZhongScoreRight: cc.Label,
        labelWeiScore: cc.Label,
        labelWeiScoreRight: cc.Label,

        touScroeTitle: cc.Node, //头道字
        zhongScroeTitle: cc.Node, //中道字
        weiScroeTitle: cc.Node, //尾道字

        scoreStyle: 0, // 0 表示分数在左边  1 表示分数在右边 2不显示分数
        _daoLayouts: null, // 头、中、尾集合
        _labelScores: null,
        _scores: null,

        teShuLayout: cc.Layout,
        labelTeShuPaiTitle: cc.Label,
        pNum: 0, //玩家人数
        teShuTime: 0, //特殊牌出牌顺序
        teShuNum: 0, //特殊牌人数
        // [{
        //     'cards':[{'suit':suit,'number':number},{}],//特殊牌不用传
        //     'type':0,
        //     'value':4,
        //     'isContainExtra':true,//is Special 特殊牌传
        //    },
        //    {
        //     'cards':[{'suit':suit,'number':number},{}],
        //     'type':0,
        //     'value':4
        //   }]
        _user: null, // 用于比牌的数据
        _cardsInfo: null,
        _compareIndex: 0 },

    // 将要比较的 索引  0~2
    // use this for initialization
    onLoad: function onLoad() {
        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        this._labelScores = [[this.labelTouScore, this.labelTouScoreRight], [this.labelZhongScore, this.labelZhongScoreRight], [this.labelWeiScore, this.labelWeiScoreRight]];
        this.reset();

        if (this._scores) {
            this.setScores(this._scores);
        }
    },

    reset: function reset() {
        this._compareIndex = 0;
        this.teShuLayout.node.active = false;
        this.labelTeShuPaiTitle.string = '';
        this.node.children.forEach(function (node) {
            node.active = false;
        });
    },

    _setCardsToLayout: function _setCardsToLayout(layout, cards) {
        var node = layout.node;
        node.children.forEach(function (spriteNode, index) {
            var sprite = spriteNode.getComponent('cc.Sprite');
            var card = cards[index];
            if (!card) {
                return;
            }
            KQCardResHelper.setCardSpriteFrame(sprite, card.cardName());
            spriteNode.color = new cc.Color(255, 255, 255);
            if (cc.maPai) {
                var cardMaPai = '3_' + cc.maPai;
                if (card.cardName() == cardMaPai) {
                    spriteNode.color = new cc.Color(226, 145, 145);
                }
            }
        });
    },

    setCompareData: function setCompareData(user) {
        this._user = user;
        this._cardsInfo = user.cardInfo;
        var cardsInfo = user.cardInfo;
        var cards = cardsInfo.map(function (cardInfoItem) {
            return KQCard.cardsFromArray(cardInfoItem.cards);
        }).reduce(function (array, subCards) {
            return array.concat(subCards);
        }, []);

        //特殊牌
        this.teShuLayout.node.active = false;
        this.labelTeShuPaiTitle.string = '';
        this.pNum = user.playerNum; //玩家人数
        this.teShuTime = user.teShuTime; //特殊牌出牌顺序人数
        this.teShuNum = user.TeShuNum; //特殊牌人数
        var scores = [user.score1 || 0, user.score2 || 0, user.score3 || 0];
        this.setCards(cards);
        this.setScores(scores);
    },

    // 下一个要比较的分数
    // 如果没有要比较的了，则返回 0
    nextCompareScore: function nextCompareScore() {
        if (!this._user) {
            return 0;
        }

        var data = this._cardsInfo[this._compareIndex];
        if (!data) {
            return 0;
        }

        return data.value;
    },

    setTeShuCards: function setTeShuCards(cards, cardsNames) {
        cards.forEach(function (card) {
            if (card.point == 14) {
                card.point = 1;
            }
        });
        var time = (this.pNum - this.teShuNum) * 3 + this.teShuTime; //3 是3道牌的时间
        var typeName = KQCard.cardsTypeName(cardsNames);
        if (typeName == "三同花") {
            cards.sort(KQCard.sortByColor);
        } else {
            cards.sort(KQCard.sortByPoint);
        }
        this.scheduleOnce(function () {
            this.teShuLayout.node.active = true;
            this._setCardsToLayout(this.teShuLayout, cards);
            this.labelTeShuPaiTitle.string = typeName;
            AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[0].type);
        }, time);
    },
    _convertCardsToCardNames: function _convertCardsToCardNames(cards) {
        // [{"suit":"s","number":10}]
        var suitColorMap = ['', 'd', 'c', 'h', 's'];
        return cards.map(function (card) {
            var cardNumber = card.point;
            var color = suitColorMap[card.color];
            var number = Math.max(Math.min(cardNumber, 13), 1);
            return { number: number, suit: color };
        });
    },
    setCards: function setCards(cards) {

        // 不会再有特殊牌了
        this.teShuLayout.node.active = false;

        if (this._user.isContainExtra == true) {
            var cardsNames = this._convertCardsToCardNames(cards);
            if (KQCard.isTeShuPai(cardsNames) && cc.moshi != 1) {
                this.setTeShuCards(cards, cardsNames);
                return;
            }
        }

        var cardSprites = this._allCardSprites();
        cards.forEach(function (kqCard, index) {
            if (index >= cardSprites.length) {
                return;
            }

            var cardSprite = cardSprites[index];

            KQCardResHelper.loadCardSpriteFrame(kqCard.cardName(), function (spriteFrame) {
                cardSprite.spriteFrame = spriteFrame;
                cardSprite.node.color = new cc.Color(255, 255, 255);
                if (cc.maPai) {
                    var cardMaPai = 'public-pic-card-poker-3_' + cc.maPai;
                    if (spriteFrame.name == cardMaPai) {
                        cardSprite.node.color = new cc.Color(226, 145, 145);
                    }
                }
            });
        });
    },

    setScores: function setScores(scores) {
        if (this._labelScores == null) {
            this._scores = scores;
            return;
        }

        var scoreStrings = scores.map(function (score) {
            score = Number(score);
            var result = score > 0 ? "+ " + score : "- " + score * -1;
            return result;
        });

        scoreStrings.forEach((function (string, index) {
            var labels = this._labelScores[index];
            labels.forEach(function (label) {
                label.string = string;
            });
        }).bind(this));
    },

    showTouCards: function showTouCards() {
        if (this._user.isContainExtra == true) {
            return;
        }
        this.touLayout.node.active = true;
        if (this.scoreStyle == 1) {
            this.labelTouScoreRight.node.active = true;
        } else if (this.scoreStyle == 0) {
            this.labelTouScore.node.active = true;
            if (this.touScroeTitle) {
                this.touScroeTitle.active = true;
            }
        }
        var types = this._cardsInfo[this._compareIndex].type == 3 ? 333 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showZhongCards: function showZhongCards() {
        if (this._user.isContainExtra == true) {
            return;
        }
        this.zhongLayout.node.active = true;
        if (this.scoreStyle == 1) {
            this.labelZhongScoreRight.node.active = true;
        } else if (this.scoreStyle == 0) {
            this.labelZhongScore.node.active = true;
            if (this.zhongScroeTitle) {
                this.zhongScroeTitle.active = true;
            }
        }
        var types = this._cardsInfo[this._compareIndex].type == 6 ? 555 : this._cardsInfo[this._compareIndex].type;
        AudioManager.instance.playCardType(this._user.sex, types);
        this._compareIndex += 1;
    },

    showWeiCards: function showWeiCards() {
        if (this._user.isContainExtra == true) {
            return;
        }
        this.weiLayout.node.active = true;
        if (this.scoreStyle == 1) {
            this.labelWeiScoreRight.node.active = true;
        } else if (this.scoreStyle == 0) {
            this.labelWeiScore.node.active = true;
            if (this.weiScroeTitle) {
                this.weiScroeTitle.active = true;
            }
        }

        AudioManager.instance.playCardType(this._user.sex, this._cardsInfo[this._compareIndex].type);
        this._compareIndex += 1;
    },

    showNextCards: function showNextCards() {
        this._daoLayouts = [this.touLayout, this.zhongLayout, this.weiLayout];
        var layout = this._daoLayouts.find(function (layout) {
            return !layout.node.active;
        });

        if (layout == this.touLayout) {
            this.showTouCards();
        } else if (layout == this.zhongLayout) {
            this.showZhongCards();
        } else if (layout == this.weiLayout) {
            this.showWeiCards();
        }
    },

    _clearCards: function _clearCards() {
        this._clearLayoutCards(this.touLayout);
        this._clearLayoutCards(this.zhongLayout);
        this._clearLayoutCards(this.weiLayout);
    },

    _clearLayoutCards: function _clearLayoutCards(layout) {
        this._cardSpritesWithLayout(layout).forEach(function (sprite) {
            sprite.spriteFrame = null;
        });
    },

    _cardSpritesWithLayout: function _cardSpritesWithLayout(layout) {
        var node = layout.node;
        return node.children.map(function (node) {
            return node.getComponent('cc.Sprite');
        });
    },

    _allCardSprites: function _allCardSprites() {
        var touCardSprites = this._cardSpritesWithLayout(this.touLayout);
        var zhongCardSprites = this._cardSpritesWithLayout(this.zhongLayout);
        var weiCardSprites = this._cardSpritesWithLayout(this.weiLayout);
        var result = touCardSprites.concat(zhongCardSprites).concat(weiCardSprites);
        return result;
    }

});

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardResHelper":"KQCardResHelper"}],"Countdown":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6406dyBk8tKVrlJ1+mg7cLt', 'Countdown');
// scripts\Pefabs\Countdown.js

cc.Class({
    "extends": cc.Component,

    properties: {
        labelTime: cc.Label,

        _callback: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.labelTime.string = "0";
    },

    /**
     * 开始倒计时
     * 
     * @param  {Number} time 时长
     * @param  {Function} callback 倒计时的回调
     */
    startCountdown: function startCountdown(time, callback) {
        this.stop();
        this._callback = callback;

        this.node.active = true;
        this.labelTime.string = "" + time;
        this.schedule(this._countDown, 1, time);
    },

    stop: function stop() {
        this.unschedule(this._countDown);
        this.node.active = false;

        if (this._callback) {
            var isTimeout = Number(this.labelTime.string) <= 0;
            var callback = this._callback;
            this._callback = null;
            callback(isTimeout);
        }

        this._callback = null;
    },

    _countDown: function _countDown() {
        var time = Number(this.labelTime.string || "0");
        time = time - 1;

        if (time <= 0) {
            this.stop();
        }

        this.labelTime.string = String(time);
    }

});

cc._RFpop();
},{}],"GameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6a3cdd+2shGlZ+jeI3trSsB', 'GameResult');
// scripts\Play\GameResult.js

var KQCard = require('KQCard');
var AudioManager = require('AudioManager');

var ResultStatus = {
  WIN: 2,
  DRAW: 1,
  LOSE: 0
};

var GameResult = cc.Class({
  'extends': cc.Component,

  properties: {
    winNode: cc.Node,
    loseNode: cc.Node,
    drawNode: cc.Node,
    contentNode: cc.Node,

    resultItems: [cc.Node],

    _deskInfo: null,
    _userId: null,
    _closeCallback: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._hideResultItems();
  },

  showResults: function showResults(deskInfo, currentUserId) {
    this._deskInfo = deskInfo;
    this._userId = currentUserId;

    var resultStatus = this._resultStatus();
    this.contentNode.active = true;
    this.winNode.active = resultStatus == ResultStatus.WIN;
    this.drawNode.active = resultStatus == ResultStatus.DRAW;
    this.loseNode.active = resultStatus == ResultStatus.LOSE;

    if (this.winNode.active) {
      AudioManager.instance.playWin();
    } else if (this.loseNode.active) {
      AudioManager.instance.playLose();
    }

    this.node.getComponent('alert').alert();
    this.node.getComponent('alert').setDismissCallback((function () {
      this._closeCallback;
    }).bind(this));

    var playerInfos = deskInfo.players.sort(function (p1, p2) {
      return p2.cScore - p1.cScore;
    });
    var itemComps = this.resultItems.map(function (node) {
      return node.getComponent('ResultItem');
    });
    itemComps.forEach((function (itemComp, index) {
      itemComp.node.active = index < playerInfos.length;
      if (!itemComp.node.active) {
        return;
      }

      var user = playerInfos[index];
      itemComp.updateWithPlayerInfo(user, deskInfo.isRandomDesk);
      var cards = this._cardsFromUser(user);
      itemComp.setCards(cards);
    }).bind(this));
  },

  setCloseCallback: function setCloseCallback(callback) {
    this._closeCallback = callback;
  },

  _cardsFromUser: function _cardsFromUser(user) {
    var cards = user.cardInfo.map(function (cardInfoItem) {
      return KQCard.cardsFromArray(cardInfoItem.cards);
    }).reduce(function (array, subCards) {
      return array.concat(subCards);
    }, []);

    return cards;
  },

  _hideResultItems: function _hideResultItems() {
    this.resultItems.forEach(function (node) {
      node.acitve = false;
    });
  },

  _resultStatus: function _resultStatus() {
    var playerInfos = this._deskInfo.players;
    var user = playerInfos.find((function (user) {
      return user.id == this._userId;
    }).bind(this));

    var score = user.cScore;
    if (this._deskInfo.isRandomDesk) {
      // 如果是随机场的话，应该用钻石来判断输赢
      score = user.diamond;
    }

    if (score > 0) {
      return ResultStatus.WIN;
    } else if (score < 0) {
      return ResultStatus.LOSE;
    }

    return ResultStatus.DRAW;
  }
});

module.exports = GameResult;

cc._RFpop();
},{"AudioManager":"AudioManager","KQCard":"KQCard"}],"GetCardPointsSameCount":[function(require,module,exports){
"use strict";
cc._RFpush(module, '64665arSbVGtqTVZeISv/TD', 'GetCardPointsSameCount');
// scripts\KQCard\GetCardPointsSameCount.js

/*#####*/
//��������һ���������ڵ���ͬ�������Ƶ�����
var GetCardPointsSameCount = function GetCardPointsSameCount(cards) {
    this.cardNumbers = {};
    for (var i in cards) {
        var s;
        if (typeof cards[i].number == 'undefined') {
            s = cards[i].point;
        } else {
            s = cards[i].number;
        }
        if (this.cardNumbers[s]) {
            this.cardNumbers[s]++;
        } else {
            this.cardNumbers[s] = 1;
        }
        //cc.log(this.cardNumbers[cards[i].number])
        //cc.log(cards)
        //cc.log(cards[i].number)
        //cc.log('---7')
    }
    return this.cardNumbers;
};

module.exports = GetCardPointsSameCount;

cc._RFpop();
},{}],"Invit":[function(require,module,exports){
"use strict";
cc._RFpush(module, '37d962bf0NPxaQIYUcZDwR3', 'Invit');
// scripts\Invit.js

var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }
    var isComplete = this._lastEmptyLabel() == null;
    var inviteNumber = this._roomNumber();
    if (inviteNumber.length == 6) {
      this.callbackJoinRoom = inviteNumber;
    }
  },

  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackJoinRoom;
    console.log(inviteNumber, "------------------------");
    if (inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackJoinRoom = ''; //清空邀请码
    }
  },

  clickClear: function clickClear() {
    this.callbackJoinRoom = '';
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"KQCardColorsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf1deKQQ4NMMYVV+7xEr9Jf', 'KQCardColorsHelper');
// scripts\KQCard\KQCardColorsHelper.js

// 牌花色帮助类
// 用于计算一个牌数组的花色相同的牌的张数
var KQCardColorsHelper = function KQCardColorsHelper(cards) {
  this.colorNumber = {};

  cards.forEach((function (card) {
    var color = card.color;
    var number = this.colorNumber[color] || 0;
    this.colorNumber[color] = number + 1;
  }).bind(this));
};

// 相同花色的牌的最大数量
KQCardColorsHelper.prototype.maxNumber = function () {
  var result = 0;
  for (var prop in this.colorNumber) {
    var number = this.colorNumber[prop];
    result = Math.max(number, result);
  }

  return result;
};

module.exports = KQCardColorsHelper;

cc._RFpop();
},{}],"KQCardFindTypeExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '54a95JOLVRACIP91XEFodqF', 'KQCardFindTypeExtension');
// scripts\KQCard\KQCardFindTypeExtension.js

var KQCard = require('KQCard');
var ArrayExtension = require('ArrayExtension');
var KQCardPointsHelper = require('KQCardPointsHelper');

module.exports = {};

// 寻找 cardModes 中的 对子
// 这会返回 对子 的索引数组
// 如：[[1, 3], [4, 5]]
KQCard.findDuiZi = function (cardModes) {
  var sDuiZiIndexs = KQCard.findSanTiao(cardModes) || [];
  var result = KQCard._findPointLength(cardModes, 2) || [];
  if (result.length < 2) {
    if (sDuiZiIndexs.length > 0) {
      sDuiZiIndexs.forEach(function (indexs) {
        var s1 = [indexs[0], indexs[1]];
        //var s2 = [indexs[1],indexs[2]];
        //result.push(s2);
        result.push(s1);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 2);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }

  result = KQCard.repeat(result);

  return result.length > 0 ? result : [];
};

KQCard._findPointLength = function (cardModes, length) {
  if (cardModes.length < length) {
    return [];
  }

  var obj = cardModes.reduce(function (obj, card, index) {
    var pointIndexs = obj[card.point] || [];
    obj[card.point] = pointIndexs;
    pointIndexs.push(index);
    return obj;
  }, {});

  var result = [];
  for (var prop in obj) {
    var pointIndexs = obj[prop];
    if (pointIndexs.length == length) {
      pointIndexs.sort(function (n1, n2) {
        return n1 - n2;
      });
      result.push(pointIndexs);
    }
  }

  result.sort(function (arr1, arr2) {
    var n1 = arr1[0];
    var n2 = arr2[0];
    return n2 - n1;
  });
  return result.length > 0 ? result : [];
};

// 找 两对 的索引数组
// 如：[[1, 2, 3, 4], [5, 6, 7, 8]]
KQCard.findLiaDui = function (cardModes) {
  var duiZiIndexs = KQCard.findDuiZi(cardModes) || [];
  var duiZiIndex = KQCard.findGuiPai(cardModes, 2) || [];

  if (duiZiIndexs.length < 1 && duiZiIndex.length > 0) {
    duiZiIndex.forEach(function (indexs) {
      duiZiIndexs.unshift(indexs);
    });
  }
  if (duiZiIndexs.length < 2) {
    return [];
  }

  var result = [];
  for (var i = 0; i < duiZiIndexs.length; ++i) {
    for (var j = i + 1; j < duiZiIndexs.length; ++j) {
      if (result.length < 10) {
        var pre = duiZiIndexs[i];
        var next = duiZiIndexs[j];
        var s = pre.concat(next);
        var newS = [];
        for (var q = 0; q < s.length; q++) {
          if (newS.indexOf(s[q]) == -1) {
            newS.push(s[q]);
          } else {
            break;
          }
        }
        if (newS.length == 4) {
          newS.sort(function (n1, n2) {
            return n1 - n2;
          });
          result.unshift(newS);
        }
      } else {
        break;
      }
    }
  }
  result = KQCard.repeat(result);
  if (result.length > 6) {
    result = result.slice(0, 6);
  }
  return result;
};

// 找三条
// 如：[[1, 2, 3]];
KQCard.findSanTiao = function (cardModes) {
  if (cardModes.length < 3) {
    return [];
  }
  var result = KQCard._findPointLength(cardModes, 3) || [];
  //for(var q =0;q<result.length;q++){
  //  var indexs = result[q][0];
  //  if(cardModes[indexs].point >= 20){
  //    result.splice(q,1);
  //  }
  //}
  if (result.length < 2) {
    var tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray.length > 0) {
      tieZhiIndexsArray.forEach(function (indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        var sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
    var tresult = KQCard.findGuiPai(cardModes, 3);
    for (var i = 0; i < tresult.length; i++) {
      result.push(tresult[i]);
    }
  }
  /*if(result.length < 1){
    // 铁支是包含三条的
    let tieZhiIndexsArray = KQCard.findTieZhi(cardModes);
    if (tieZhiIndexsArray) {
      tieZhiIndexsArray.forEach(function(indexs) {
        //let sanTiaoIndexs1 = [indexs[1], indexs[2], indexs[3]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[1], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[0], indexs[2], indexs[3]];
        let sanTiaoIndexs0 = [indexs[0], indexs[1], indexs[2]];
        result.push(sanTiaoIndexs0);
        //result.unshift(sanTiaoIndexs1);
        //result.unshift(sanTiaoIndexs2);
        //result.unshift(sanTiaoIndexs3);
      });
    }
  }*/

  //if(result.length > 10){
  //  result = result.slice(0,10);
  //}

  result = KQCard.repeat(result);
  return result.length > 0 ? result : [];
};

// 找同花顺
KQCard.findTongHuaShun = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  var result = [];
  var sanShunZi = KQCard.sanShunZi1(cardModes, length);
  if (sanShunZi[0] == null) {
    return false;
  }
  for (var i = 0; i < sanShunZi[0].length; i++) {
    var s = sanShunZi[0][i];
    if (KQCard.isTongHuaShun(s, length)) {
      result.push(sanShunZi[1][i]);
    }
  }
  if (result.length > 0) {
    return result;
  } else {
    return KQCard.findTongHuaShun1(cardModes);
  }
};
KQCard.findTongHuaShun1 = function (cards) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cards.length < length) {
    return [];
  }
  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= 5) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var start = 0; start + 5 <= s.length; ++start) {
      var subCards = s.slice(start, start + 5);
      if (KQCard.isTongHuaShun(subCards)) {
        (function () {
          var indexs = [];
          subCards.forEach(function (ca) {
            for (var q = 0; q < cards.length; q++) {
              var r = cards[q];
              if (r === ca) {
                indexs.push(q);
                break;
              }
            }
          });
          indexs.sort(Array.sortByPoint);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
      cards.forEach(function (adfs) {
        if (adfs.point == 14) {
          adfs.point = 1;
          adfs.scores = 1;
        }
      });
      return KQCard.findTongHuaShun20(cards);
    }
    return KQCard.findTongHuaShun1(convertedCards);
  }
  //return result.length > 0 ? result : null;
};
KQCard.findTongHuaShun20 = function (card) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (card.length < length) {
    return false;
  }
  var card20 = KQCard.contain20(card) || [];
  var cards = card.kq_excludes(card20);

  cards = Array.from(cards);
  var colorS = []; //黑桃
  var colorH = []; //红心
  var colorC = []; //梅花
  var colorD = []; //方块
  var pointS = []; //黑桃
  var pointH = []; //红心
  var pointC = []; //梅花
  var pointD = []; //方块
  for (var i = 0; i < cards.length; i++) {
    if (cards[i].color == '4') {
      if (pointS.indexOf(cards[i].point) == -1) {
        pointS.push(cards[i].point);
        colorS.push(cards[i]);
      }
    } else if (cards[i].color == '3') {
      if (pointH.indexOf(cards[i].point) == -1) {
        pointH.push(cards[i].point);
        colorH.push(cards[i]);
      }
    } else if (cards[i].color == '2') {
      if (pointC.indexOf(cards[i].point) == -1) {
        pointC.push(cards[i].point);
        colorC.push(cards[i]);
      }
    } else if (cards[i].color == '1') {
      if (pointD.indexOf(cards[i].point) == -1) {
        pointD.push(cards[i].point);
        colorD.push(cards[i]);
      }
    }
  }

  var color = [colorS, colorH, colorC, colorD];
  var colorSum = []; //总共有几种花色 [5,3,0....]
  for (var i = 0; i < color.length; i++) {
    if (color[i].length >= parseInt(5 - card20.length)) {
      color[i].sort(function (a1, a2) {
        return a1.point - a2.point;
      });
      colorSum.push(color[i]);
    }
  }
  cc.log(colorSum);

  var result = [];
  for (var i = 0; i < colorSum.length; i++) {
    var s = colorSum[i];
    for (var j = 1; j <= card20.length; ++j) {
      var num = 5 - j;
      for (var start = 0; start + num <= s.length; ++start) {
        var subCards = s.slice(start, start + num);
        var bool = parseInt(subCards[num - 1]['scores']) - parseInt(subCards[0]['scores']) < 5;
        if (bool) {
          var newCard20;

          (function () {
            var indexs = [];
            newCard20 = card20.slice(0, j);

            subCards = subCards.concat(newCard20);
            subCards.forEach(function (ca) {
              for (var q = 0; q < card.length; q++) {
                var r = card[q];
                if (r === ca) {
                  indexs.push(q);
                  break;
                }
              }
            });
            indexs.sort(Array.sortByNumber);

            result.unshift(indexs);
          })();
        }
      }
    }
  }
  cc.log(result);
  cc.log('--------357');
  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
      return [];
    }
    return KQCard.findTongHuaShun20(convertedCards);
  }
  //return result.length > 0 ? result : null;
};

// 找铁支
// 如：[[1,2,3,4]]
KQCard.findTieZhi = function (cardModes) {
  var result = KQCard._findPointLength(cardModes, 4);
  if (result.length > 0) {
    return result;
  }
  result = [];
  // 五同是包含铁支的
  var wuTongIndexsArray = KQCard.findWuTong(cardModes);
  if (wuTongIndexsArray) {
    wuTongIndexsArray.forEach(function (indexs) {
      var tieZhiIndexs0 = [indexs[0], indexs[1], indexs[2], indexs[3]];
      var tieZhiIndexs1 = [indexs[0], indexs[1], indexs[2], indexs[4]];
      var tieZhiIndexs2 = [indexs[0], indexs[1], indexs[3], indexs[4]];
      var tieZhiIndexs3 = [indexs[0], indexs[2], indexs[3], indexs[4]];
      var tieZhiIndexs4 = [indexs[1], indexs[2], indexs[3], indexs[4]];
      result.push(tieZhiIndexs0);
      result.push(tieZhiIndexs1);
      result.push(tieZhiIndexs2);
      result.push(tieZhiIndexs3);
      result.push(tieZhiIndexs4);
    });
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result);
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 4);
};
//找五同
KQCard.findWuTong = function (cardModes) {
  if (cardModes.length < 5) {
    return [];
  }
  var result = this._findPointLength(cardModes, 5) || [];
  return result.length > 0 ? result : KQCard.findGuiPai(cardModes, 5);
};
// 找顺子
// 如：[[1, 2, 3, 4, 5]]
KQCard.findShunZi = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }
  if (typeof cardModes[0]['point'] == "undefined") {
    cardModes = KQCard.cardsFromArray(cardModes);
  }
  // 先根据点数去重
  var uniqueCards = cardModes.unique(function (card1, card2) {
    return card1.point == card2.point;
  });
  uniqueCards.sort(KQCard.sortByPoint);

  // 如果有 A，则在最后添加 14
  var cardA = cardModes.find(function (card) {
    return card.point == 1;
  });
  if (cardA) {
    var cardAPlus = new KQCard(cardA);
    cardAPlus.point = 14;
    uniqueCards.push(cardAPlus);
  }

  var result = [];

  // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
  for (var start = 0; start + length <= uniqueCards.length; ++start) {
    var subCards = uniqueCards.slice(start, start + length);
    if (KQCard.isShunZi(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {

            if (card.point == 14) {
              return originCard.point == 1;
            }

            return card === originCard;
          });
          indexs.push(index);
        });

        indexs.sort(Array.sortByNumber);
        result.push(indexs);
      })();
    }
  }

  // 处理点数重复的情况
  // 比如 A A K Q J 10 这种
  var repeatIndexsArray = KQCard._findRepeatPointIndexsArray(result, cardModes);
  repeatIndexsArray.forEach(function (indexs) {
    result.push(indexs);
  });

  result.sort(function (arr1, arr2) {
    return arr1[0] - arr2[0];
  });

  return result.length > 0 ? result : KQCard.findShunZi20(cardModes);
};
KQCard.findShunZi20 = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return false;
  }
  var card20 = KQCard.contain20(cardModes);
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  var newArr = [];
  var newArrs = [];
  for (var i = 0; i < cards.length; i++) {
    if (newArrs.indexOf(cards[i]['point']) == -1) {
      newArr.push(cards[i]);
      newArrs.push(cards[i].point);
    }
  }

  newArr.sort(function (n1, n2) {
    return n1.point - n2.point;
  });
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = length - j;
    for (var start = 0; start + num <= newArr.length; ++start) {
      var subCards = newArr.slice(start, start + num);
      var bool = parseInt(subCards[num - 1]['point']) - parseInt(subCards[0]['point']) < length;
      if (bool) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  if (result.length > 0) {
    return result;
  } else {
    var convertedCards = KQCard._convertOneToA1(cardModes);
    if (cardModes === convertedCards) {
      return false;
    }
    return KQCard.findShunZi20(convertedCards);
  }
};
KQCard._findRepeatPointIndexsArray = function (indexsArray, originCards) {
  var repeatIndexsArray = [];
  indexsArray.forEach(function (indexs) {
    var cards = indexs.map(function (index) {
      return originCards[index];
    });

    cards.forEach(function (card, index) {
      var originIndex = originCards.findIndex(function (originCard) {
        if (typeof card == 'undefined') {
          return;
        }
        if (originCard !== card && originCard.point == card.point) {
          return true;
        }
        return false;
      });

      if (originIndex < 0) {
        return;
      }

      var repeatIndexs = indexs.slice();
      repeatIndexs[index] = originIndex;
      repeatIndexsArray.push(repeatIndexs);
    });
  });

  return repeatIndexsArray;
};

// 找同花
// 如：[[1, 2, 3, 4, 5]]
KQCard.findTongHua = function (cardModes) {
  var length = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

  if (cardModes.length < length) {
    return [];
  }

  var cards = Array.from(cardModes);
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var start = 0; start + length <= cards.length; ++start) {
    var subCards = cards.slice(start, start + length);
    if (KQCard.isTongHua(subCards, length)) {
      (function () {
        var indexs = [];
        subCards.forEach(function (card) {
          var index = cardModes.findIndex(function (originCard) {
            return card === originCard;
          });
          indexs.push(index);
        });
        //indexs = indexs.length > 5 ? indexs.splice(1,1) : indexs;
        indexs.sort(Array.sortByNumber);
        result.push(indexs);
      })();
    }
  }
  return result.length > 0 ? result : KQCard.findTongHua20(cardModes);
};
KQCard.findTongHua20 = function (cardModes) {
  if (cardModes.length < 5) {
    return false;
  }
  var card20 = KQCard.contain20(cardModes);
  var cards = cardModes.kq_excludes(card20);
  // 先根据点数去重
  cards.sort(KQCard.sortByColor);

  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = 5 - j;
    for (var start = 0; start + num <= cards.length; ++start) {
      var subCards = cards.slice(start, start + num);
      if (KQCard.isTongHua(subCards, num)) {
        var newCard20;

        (function () {
          var indexs = [];
          newCard20 = card20.slice(0, j);

          subCards = subCards.concat(newCard20);
          subCards.forEach(function (card) {
            for (var q = 0; q < cardModes.length; q++) {
              var r = cardModes[q];
              if (r === card) {
                indexs.push(q);
                break;
              }
            }
          });

          indexs.sort(Array.sortByNumber);
          result.unshift(indexs);
        })();
      }
    }
  }

  return result.length > 0 ? result : [];
};

KQCard.findHuLu = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }

  var p_3 = KQCard.findSanTiao(cardModes);
  var p_4 = KQCard.findTieZhi(cardModes);
  var p2 = KQCard.findDuiZi(cardModes) || [];
  //var p_3 =  this._findPointLength(cardModes, 3) || [];
  //var p_4 = this._findPointLength(cardModes, 4) || [];
  //var p2 = this._findPointLength(cardModes, 2) || [];
  if (p2.length <= 0) {
    if (p_3) {
      p_3.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        var sanTiaoIndexs3 = [indexs[1], indexs[2]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        p2.push(sanTiaoIndexs3);
      });
    }

    if (p_4) {
      p_4.forEach(function (indexs) {
        var sanTiaoIndexs0 = [indexs[0], indexs[1]];
        //let sanTiaoIndexs1 = [indexs[0], indexs[2]];
        //let sanTiaoIndexs2 = [indexs[0], indexs[3]];
        //let sanTiaoIndexs3 = [indexs[1], indexs[2]];
        //let sanTiaoIndexs4 = [indexs[1], indexs[3]];
        var sanTiaoIndexs6 = [indexs[2], indexs[3]];
        p2.push(sanTiaoIndexs0);
        //p2.unshift(sanTiaoIndexs1);
        //p2.unshift(sanTiaoIndexs2);
        //p2.unshift(sanTiaoIndexs3);
        //p2.unshift(sanTiaoIndexs4);
        p2.push(sanTiaoIndexs6);
      });
    }
  }

  if (p2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.push(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : KQCard.findHuLu20(cardModes);
};
KQCard.findHuLu20 = function (cardModes) {
  var length = 5;
  if (cardModes.length < length) {
    return [];
  }
  var p_3 = KQCard.findGuiPai(cardModes, 3);
  var p_4 = KQCard.findGuiPai(cardModes, 4);
  var p_2 = KQCard.findGuiPai(cardModes, 2);
  if (p_2 == null) {
    p_2 = [];
  }
  if (p_3) {
    p_3.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs3 = [indexs[1], indexs[2]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs3);
    });
  }

  if (p_4) {
    p_4.forEach(function (indexs) {
      var sanTiaoIndexs0 = [indexs[0], indexs[1]];
      var sanTiaoIndexs6 = [indexs[2], indexs[3]];
      p_2.unshift(sanTiaoIndexs0);
      p_2.unshift(sanTiaoIndexs6);
    });
  }

  if (p_2 == null || p_3 == null) {
    return [];
  }
  var tresult = [];
  p_2.forEach(function (i_3) {
    var s = i_3;
    p_3.forEach(function (i_2) {
      s = i_3.concat(i_2);
      for (var i = 0; i < s.length - 1; i++) {
        var index = s[i];
        for (var j = i + 1; j < s.length; j++) {
          if (index == s[j]) {
            s = null;
            break;
          }
        }
        if (s == null) {
          break;
        }
      }
      if (s !== null) {
        tresult.unshift(s);
      }
    });
  });
  if (tresult.length > 10) {
    tresult = tresult.slice(0, 10);
  }
  return tresult.length > 0 ? tresult : [];
};

KQCard.findGuiPai = function (cardModes) {
  var numBer = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

  var card20 = KQCard.contain20(cardModes).map(function (card) {
    //得到鬼牌的索引
    for (var q = 0; q < cardModes.length; q++) {
      var r = cardModes[q];
      if (r === card) {
        return q;
      }
    }
  });

  var cards = cardModes.kq_excludes(KQCard.contain20(cardModes)); //删除所有牌的鬼牌
  var result = [];
  for (var j = 1; j <= card20.length; ++j) {
    var num = numBer - j; //除鬼牌外 我应该找多少张牌匹配
    var indexs = KQCard._findPointLength(cardModes, num) || [];
    for (var t = 0; t < indexs.length; t++) {
      if (numBer == 2) {
        //是对子的时候把鬼牌和单张匹配都循环一遍
        for (var o = 0; o < card20.length; ++o) {
          var s = indexs[t].concat(card20[o]);
          if (s.length == numBer) {
            result.push(s);
          }
        }
      } else {
        var s = indexs[t].concat(card20.slice(0, j)); //依次相加鬼牌第一次加一张 递增
        if (s.length == numBer) {
          result.push(s);
        }
      }
    }
  }
  if (result.length > 10) {
    result = result.slice(0, 10);
  }
  result = KQCard.repeat(result); //去重
  return result.length > 0 ? result : [];
};

KQCard.repeat = function (result) {
  for (var i = 0; i < result.length; i++) {
    var index = result[i];

    var newAyy = [];
    for (var o = 0; o < index.length; o++) {
      //有重复干掉你
      if (newAyy.indexOf(index[o]) == -1) {
        newAyy.push(index[o]);
      } else {
        result.splice(i, 1);
        break;
      }
    }

    for (var j = i + 1; j < result.length - 1; j++) {
      var s = result[j];
      var jString = '';
      var iString = '';
      for (var r = 0; r < s.length; r++) {
        jString = jString + s[r];
        iString = iString + index[r];
      }
      if (jString == iString) {
        //有重复干掉你
        result.splice(i, 1);
        break;
      }
    }
  }
  return result;
};

KQCard.testFind = function (cardModes) {
  var WuTong = KQCard.findWuTong(cardModes) || [];
  var TongHuaShun = KQCard.findTongHuaShun(cardModes) || [];
  var TieZhi = KQCard.findTieZhi(cardModes) || [];
  var HuLu = KQCard.findHuLu(cardModes) || [];
  var TongHua = KQCard.findTongHua(cardModes) || [];
  var ShunZi = KQCard.findShunZi(cardModes) || [];
  var SanTiao = KQCard.findSanTiao(cardModes) || [];
  var LiaDui = KQCard.findLiaDui(cardModes) || [];
  var DuiZi = KQCard.findDuiZi(cardModes) || [];
  var result = [WuTong, TongHuaShun, TieZhi, HuLu, TongHua, ShunZi, SanTiao, LiaDui, DuiZi];
  return result;
};

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","KQCard":"KQCard","KQCardPointsHelper":"KQCardPointsHelper"}],"KQCardPointsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '42d3e866XhHdbkspy3Qytap', 'KQCardPointsHelper');
// scripts\KQCard\KQCardPointsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardPointsHelper = function KQCardPointsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.point;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardPointsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardPointsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardResHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'be420vtWaJOHoxQcZwP2xN2', 'KQCardResHelper');
// scripts\KQCard\KQCardResHelper.js

var Helper = {
  loadCardSpriteFrame: function loadCardSpriteFrame(cardName, callback) {
    this._loadCardFrame(cardName, callback);
  },

  setCardSpriteFrame: function setCardSpriteFrame(sprite, cardName) {
    this.loadCardSpriteFrame(cardName, function (spriteFrame) {
      sprite.spriteFrame = spriteFrame;
    });
  },

  _cardFullName: function _cardFullName(cardShortName) {
    var cardName = cardShortName;
    if (!cardName.startsWith("public-pic-card-poker")) {
      cardName = "public-pic-card-poker-" + cardName;
    }

    return cardName;
  },

  _loadCardFrame: function _loadCardFrame(cardName, callback) {
    cc.assert(callback);

    cc.loader.loadRes("images/pokerList/pockList", cc.SpriteAtlas, (function (err, atlas) {
      if (err) {
        callback(null, err);
        return;
      }

      cardName = this._cardFullName(cardName);
      var frame = atlas.getSpriteFrame(cardName);
      callback(frame);
    }).bind(this));
  }
};

module.exports = Helper;

cc._RFpop();
},{}],"KQCardScoreExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3f5d8wDA+tMPbPd/k4hBAAR', 'KQCardScoreExtension');
// scripts\KQCard\KQCardScoreExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardScoretsHelper = require('KQCardScoretsHelper');

KQCard.scoreOfCards = function (cards) {
  if (cards == null || cards.length == null) {
    cards = [];
  }

  var isTou = cards.length == 3;
  var typeScore = KQCard._typeScoreOfCards(cards);
  var caleCards = KQCard._convertOneToA(cards.slice());
  caleCards.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  //caleCards = KQCard.Sort(caleCards);
  var card20 = KQCard.contain20(caleCards);
  var pointHelper = new KQCardScoretsHelper(caleCards.kq_excludes(card20));
  var maxNum = pointHelper.maxNumber() /*-card20.length == 0 ? 1: pointHelper.maxNumber()-card20.length*/;

  var maxScore = 0; //获取除鬼牌外最大的的点数
  for (var i in pointHelper.pointNumbers) {
    if (parseInt(i) > maxScore && pointHelper.pointNumbers[i] == maxNum) {
      maxScore = parseInt(i);
    }
  }
  caleCards.forEach(function (card) {
    if (card.scores >= 20) {
      card.scores = maxScore;
    }
  });
  card20.forEach(function (card) {
    card.scores = maxScore;
  });
  //cc.log(maxNum)
  //cc.log(maxScore)
  //cc.log(caleCards.kq_excludes(card20))
  //cc.log('----35')
  caleCards.sort(KQCard.sort);
  if (typeScore == 9000000000000000) {
    //五同
    caleCards.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var totalValue = "";
    //var totalColor = "";
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      //var c = caleCards[i].color;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      //totalColor = c+totalColor;
    }
    //totalValue = totalValue+totalColor;
    //cc.log(totalValue)
    //cc.log(parseInt(totalValue))
    //cc.log(typeScore+parseInt(totalValue))
    return typeScore + parseInt(totalValue);
  } else if (typeScore == 8000000000000000) {
    //同花顺比最大的那张，如果两张相同那就是相同
    if (card20.length > 0) {
      //有鬼牌的时候要改变鬼牌的分数
      caleCards = KQCard._changeCardScors(caleCards);
    }
    var totalValue = "";
    var valueColor = ""; //牌色
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;
      var c = caleCards[i].color; //牌色
      valueColor = c + valueColor; //牌色
    }
    return typeScore + parseInt(totalValue + valueColor);
  } else if (typeScore == 7000000000000000) {
    //铁支,找出那四张是什么牌

    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }
    var qwe = '';
    qwe = oneValueColor.substr(0, oneValueColor.length - 1);
    oneValueColor = oneValueColor.substr(oneValueColor.length - 1);
    str = str + oneValue + oneValueColor + valueColor + qwe;
    return typeScore + parseInt(str);
  } else if (typeScore == 6000000000000000) {
    //葫芦
    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          oneValueColor = c + oneValueColor; //牌色
        }
    }

    if (isTou) {
      oneValue = oneValue + '0000';
      oneValueColor = oneValueColor + '00';
    }

    str = str + oneValue + valueColor + oneValueColor;
    return typeScore + parseInt(str);
  } else if (typeScore == 5000000000000000) {
    //同花,有可能需要比5张牌
    var totalScore = "";
    var totalColor = "";
    //var colors = 0;//获取牌的类型颜色
    //for(var i in caleCards) {
    //  if(parseInt(caleCards[i].point) < 20){
    //    colors = parseInt(caleCards[i].color);
    //    break;
    //  }
    //}

    for (var i in caleCards) {
      var paiPoint = parseInt(caleCards[i].point);
      var colors = parseInt(caleCards[i].point) < 20 ? caleCards[i].color : 5;
      totalColor = colors + totalColor;
      totalScore = (paiPoint >= 10 ? paiPoint : "0" + paiPoint) + totalScore;
    }
    return typeScore + parseInt(totalScore + totalColor);
  } else if (typeScore == 4000000000000000) {
    //顺子
    if (card20.length > 0) {
      //有鬼牌的时候要改变鬼牌的分数
      caleCards = KQCard._changeCardScors(caleCards);
    }
    var totalValue = "";
    var valueColor = ""; //牌色
    for (var i in caleCards) {
      var s = caleCards[i].scores;
      totalValue = (parseInt(s) >= 10 ? s : "0" + s) + totalValue;

      var c = caleCards[i].color; //牌色
      valueColor = c + valueColor; //牌色
    }
    return typeScore + parseInt(totalValue + valueColor);
  } else if (typeScore == 3000000000000000) {
    //三条，找出是哪张牌有3张
    //caleCards.sort(KQCard.sort);
    var str = "";
    var oneValue = "";
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    var oneValueColor20 = ""; //牌色
    for (var w in caleCards) {
      if (maxScore == caleCards[w].scores) {
        //三条
        var s = caleCards[w].scores;
        str = (parseInt(s) >= 10 ? s : "0" + s) + str;

        var c = caleCards[w].color; //牌色
        valueColor = c + valueColor; //牌色
      } else {
          var s = caleCards[w].scores;
          oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

          var c = caleCards[w].color; //牌色
          if (parseInt(s) < 20) {
            oneValueColor = c + oneValueColor; //牌色
          } else {
              oneValueColor20 = c + oneValueColor20; //牌色
            }
        }
    }
    if (isTou) {
      oneValue = oneValue + '0000';
      valueColor = valueColor + '00';
    }
    str = str + oneValue + oneValueColor + valueColor + oneValueColor20;
    return typeScore + parseInt(str);
  } else if (typeScore == 2000000000000000) {
    //caleCards.sort(KQCard.sort);
    //两对,有可能需要比5张牌
    var str = "";
    var oneValue = '';
    var valueColor = ""; //牌色
    var oneValueColor = ""; //牌色
    for (var i in pointHelper.pointNumbers) {
      if (pointHelper.pointNumbers[i] == 2) {
        //两对
        for (var w in caleCards) {
          if (i == caleCards[w].scores) {
            var s = caleCards[w].scores;
            str = (parseInt(s) >= 10 ? s : "0" + s) + str;
            var c = caleCards[w].color; //牌色
            valueColor = c + valueColor; //牌色
          }
        }
      } else {
          for (var q in caleCards) {
            //单张加花色
            if (i == caleCards[q].scores) {
              var s = caleCards[q].scores;
              oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;

              var c = caleCards[q].color; //牌色
              oneValueColor = oneValueColor + c; //牌色
            }
          }
        }
    }
    cc.log(str);
    cc.log(oneValue);
    str = str + oneValue + oneValueColor + valueColor;
    return typeScore + parseInt(str);
  } else if (typeScore == 1000000000000000) {
    //对子
    //caleCards.sort(KQCard.sort);
    var str = "";
    var oneValue = "";
    var oneValueColor = "";
    var valueColor = "";

    if (card20.length > 0) {
      caleCards.sort(function (card1, card2) {
        return card2.point - card1.point;
      });
      caleCards = caleCards.kq_excludes(card20);
      caleCards.forEach(function (card, index) {
        var s = card.scores;
        var c = card.color;
        str = str + (parseInt(s) >= 10 ? s : "0" + s);
        if (index == 0) {
          var s20 = card20[0].scores;
          str = str + (parseInt(s20) >= 10 ? s20 : "0" + s20);
          valueColor = valueColor + c;
          valueColor = valueColor + card20[0].color;
        } else {
          oneValueColor = oneValueColor + c;
        }
      });
      cc.log(str);
      cc.log('--------274');
      if (isTou) {
        str = str + '0000';
        valueColor = valueColor + '00';
      }
      str = str + oneValueColor + valueColor;
      return typeScore + parseInt(str);
    }

    for (var i in pointHelper.pointNumbers) {
      if (pointHelper.pointNumbers[i] == maxNum) {
        //对子
        for (var w in caleCards) {
          //对子加花色
          if (i == caleCards[w].scores) {
            var s = caleCards[w].scores;
            valueColor = caleCards[w].color + valueColor;
            str = (parseInt(s) >= 10 ? s : "0" + s) + str;
          }
        }
      } else {
        for (var q in caleCards) {
          //单张加花色
          if (i == caleCards[q].scores) {
            var s = caleCards[q].scores;
            oneValueColor = caleCards[q].color + oneValueColor;
            oneValue = (parseInt(s) >= 10 ? s : "0" + s) + oneValue;
          }
        }
      }
    }
    //cc.log(oneValueColor)
    //cc.log(valueColor)
    if (isTou) {
      oneValue = oneValue + '0000';
      valueColor = valueColor + '00';
    }
    str = str + oneValue + oneValueColor + valueColor;
    return typeScore + parseInt(str);
  } else if (typeScore == 0) {
    //乌龙
    var valuePoint = "";
    var valueColor = "";
    for (var q in caleCards) {
      var s = caleCards[q].scores;
      var c = caleCards[q].color; //单张加花色
      valuePoint = (parseInt(s) >= 10 ? s : "0" + s) + valuePoint;
      valueColor = c + valueColor;
    }
    if (isTou) {
      valuePoint = valuePoint + '0000';
      valueColor = valueColor + '00';
    }
    valuePoint = valuePoint + valueColor;
    return typeScore + parseInt(valuePoint);
  }

  var cardsTotalPoint = 0;
  caleCards.forEach(function (card) {
    cardsTotalPoint += card.point;
  });

  var result = typeScore + cardsTotalPoint;
  return result;
};
KQCard._changeCardScors = function (cardModel) {
  cardModel.forEach(function (card) {
    card.scores = card.point;
    if (card.scores == 14) {
      card.scores = 1;
    }
  });
  var is14 = false; //是 k q j 10 A;
  var is1 = false; //不是1 2 3 4 5
  cardModel.forEach(function (card) {
    if (card.scores < 9) {
      is14 = true; //不是 k q j 10 A;
      if (card.scores < 6 && card.scores > 1) {
        is1 = true; //是1 2 3 4 5
      }
    }
  });

  if (is14) {
    //不是 k q j 10 A;
    cardModel.forEach(function (card) {
      if (card.scores == 14) {
        card.scores = 1;
      }
    });
  }
  if (is14 && !is1) {
    //不是 k q j 10 A;
    cardModel.sort(function (a1, a2) {
      return a1.scores - a2.scores;
    });

    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      var s = parseInt(cardModel[0].scores) + i; //最小的牌的分数
      scoresAyy.push(s);
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    cardModel.forEach((function (card) {
      //改变牌的分数
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
  } else {
    //是 k q j 10 A;
    cardModel.sort(function (a1, a2) {
      return a2.scores - a1.scores;
    });
    var num = 14;
    if (is1) {
      //是1 2 3 4 5
      num = 5;
    }
    var scoresAyy = []; //一副牌的分数
    for (var i = 0; i < 5; i++) {
      scoresAyy.push(num);
      num -= 1;
    }
    for (var j = 0; j < scoresAyy.length; j++) {
      for (var i = 0; i < cardModel.length; i++) {
        var cardScores = cardModel[i].scores;
        if (cardScores == scoresAyy[j] && cardScores < 15) {
          scoresAyy.splice(j, 1); //删除不是鬼牌的分
        }
      }
    }
    cc.log(scoresAyy);
    cc.log(cardModel);
    cc.log('----------412');
    cardModel.forEach((function (card) {
      //找出选中的牌
      if (card.point >= 20) {
        card.scores = scoresAyy.splice(0, 1)[0];
      }
    }).bind(this));
    cc.log(cardModel);
  }

  cardModel.forEach(function (card) {
    if (card.scores == 1) {
      card.scores = 14;
    }
  });
  cardModel.sort(function (a1, a2) {
    return a1.scores - a2.scores;
  });
  return cardModel;
};
/*#####*/
KQCard.scoreOfCards2 = function (cards) {
  if (cards == null || cards.length == null) {
    cards = [];
  }
  if (typeof cards[0].point == 'undefined') {
    cards = KQCard.cardsFromArray(cards);
  }
  var caleCards = KQCard._convertOneToA(cards.slice());
  caleCards.sort(KQCard.sort);
  //var pointHelper = new KQCardPointsHelper(caleCards);
  var valueStr = "";
  for (var i in caleCards) {
    var s = caleCards[i].point;
    valueStr = (parseInt(s) >= 10 ? s : "0" + s) + valueStr;
    if (i == 4) {
      valueStr = '.' + valueStr;
    }
  }
  //cc.log(Number(valueStr))
  //cc.log(valueStr)
  //cc.log('---------特殊牌算分')
  return valueStr;
};

KQCard._typeScoreOfCards = function (cards) {
  var typeScore = 0;
  if (KQCard.containWuTong(cards)) {
    typeScore = 9000000000000000;
  } else if (KQCard.containTongHuaShun(cards)) {
    typeScore = 8000000000000000;
  } else if (KQCard.containTieZhi(cards)) {
    typeScore = 7000000000000000;
  } else if (KQCard.containHuLu(cards)) {
    typeScore = 6000000000000000;
  } else if (KQCard.containTongHua(cards)) {
    typeScore = 5000000000000000;
  } else if (KQCard.containShunZi(cards)) {
    typeScore = 4000000000000000;
  } else if (KQCard.containSanTiao(cards)) {
    typeScore = 3000000000000000;
  } else if (KQCard.containLiaDui(cards)) {
    typeScore = 2000000000000000;
  } else if (KQCard.containDuiZi(cards)) {
    typeScore = 1000000000000000;
  }

  return typeScore;
};

// 根据牌型进行排序
KQCard._typeCardsSort = function (cards) {
  if (cards == null || cards.length == 0) {
    return cards;
  }
  if (KQCard.containWuTong(cards)) {
    return KQCard._typeCardsSortWutong(cards);
  } else if (KQCard.containTongHuaShun(cards)) {
    return KQCard._typeCardsSortShunZi(cards);
  } else if (KQCard.containTieZhi(cards)) {
    return KQCard._typeCardsSortTieZhi(cards);
  } else if (KQCard.containHuLu(cards)) {
    return KQCard._typeCardsSortHuLu(cards);
  } else if (KQCard.containTongHua(cards)) {
    return KQCard._typeCardsSortTongHua(cards);
  } else if (KQCard.containShunZi(cards)) {
    return KQCard._typeCardsSortShunZi(cards);
  } else if (KQCard.containSanTiao(cards)) {
    return KQCard._typeCardsSortSanTiao(cards);
  } else if (KQCard.containLiaDui(cards)) {
    return KQCard._typeCardsSortLiangDui(cards);
  } else if (KQCard.containDuiZi(cards)) {
    return KQCard._typeCardsSortDuiZi(cards);
  }

  return cards.sort(KQCard.sortByPoint).reverse();
};

KQCard._typeCardsSortShunZi = function (cards) {
  return cards.sort(KQCard.sortByPoint).reverse();
};

KQCard._typeCardsSortTieZhi = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

/*#####*/
KQCard._typeCardsSortWutong = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};
/*#####*/

KQCard._typeCardsSortHuLu = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

KQCard._typeCardsSortTongHua = function (cards) {
  return cards.sort(KQCard.sortByPoint).reverse();
};

KQCard._typeCardsSortSanTiao = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

KQCard._typeCardsSortLiangDui = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

KQCard._typeCardsSortDuiZi = function (cards) {
  return KQCard._typeCardsSortByNumberOfPoints(cards);
};

KQCard._typeCardsSortByNumberOfPoints = function (cards) {
  var pointHelper = new KQCardScoretsHelper(cards);
  var newCards = cards.slice().sort(function (card1, card2) {
    var numberOfCard1 = pointHelper.pointNumbers[card1.point];
    var numberOfCard2 = pointHelper.pointNumbers[card2.point];

    if (numberOfCard2 != numberOfCard1) {
      return numberOfCard2 - numberOfCard1;
    }

    return card2.point - card1.point;
  });

  return newCards;
};

KQCard.testScore = function () {};

cc._RFpop();
},{"KQCard":"KQCard","KQCardColorsHelper":"KQCardColorsHelper","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQCardScoretsHelper":"KQCardScoretsHelper"}],"KQCardScoretsHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3d3b5YPHXhN44h/B0miZFRE', 'KQCardScoretsHelper');
// scripts\KQCard\KQCardScoretsHelper.js

// 牌点数帮助类
// 用来计算一个牌数组内的相同点数的牌的张数
var KQCardScoretsHelper = function KQCardScoretsHelper(cards) {
    this.pointNumbers = {};
    cards.forEach((function (card) {
        var point = card.scores;
        var number = this.pointNumbers[point] || 0;
        this.pointNumbers[point] = number + 1;
    }).bind(this));
};

// 相同点数牌的最大数量
KQCardScoretsHelper.prototype.maxNumber = function () {
    var result = 0;
    for (var prop in this.pointNumbers) {
        var number = this.pointNumbers[prop];
        //if(number < 20){
        result = Math.max(number, result);
        //}
    }

    return result;
};

module.exports = KQCardScoretsHelper;

/*var cards = [
    {'suit':'s',number:2},
    {'suit':'s',number:2},
    {'suit':'s',number:4},
    {'suit':'s',number:4},
    {'suit':'s',number:6},
    {'suit':'s',number:6},
    {'suit':'s',number:8},
    {'suit':'s',number:8},
    {'suit':'s',number:10},
    {'suit':'s',number:10},
    {'suit':'s',number:12},
    {'suit':'s',number:12},
    {'suit':'s',number:14}
];
var test = new KQCardPointsSame(cards);
console.log(test);*/

cc._RFpop();
},{}],"KQCardSelectExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '66642YNpFVIzb+JM2CkwEgS', 'KQCardSelectExtension');
// scripts\KQCard\KQCardSelectExtension.js

var KQCard = require('KQCard');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');

// 牌自动选择的扩展

/**
 * 自动选择牌，由大到小
 *
 * @param  {[KQCard]} originCards  被选择的原始牌数组
 *
 * @return {[KQCard]}
 */
KQCard.autoSelectCards = function (originCards, maxLength) {
    if (originCards.length <= maxLength) {
        return originCards;
    }
    originCards.forEach(function (card) {
        if (card.scores == 1) {
            card.scores = 14;
        }
    });
    var cards = originCards.slice().sort(function (a, b) {
        return a.scores - b.scores;
    });
    //cc.log(cards)
    //cc.log(originCards)
    //cc.log('--------25')
    //cards.sort(function(a,b){
    //    return a.scores - b.scores;
    //});
    //originCards = KQCard._convertOneToA(originCards);

    var findFuncs = [KQCard.findWuTong, KQCard.findTongHuaShun, KQCard.findTieZhi, KQCard.findHuLu, KQCard.findTongHua, KQCard.findShunZi, KQCard.findSanTiao, KQCard.findLiaDui, KQCard.findDuiZi];

    var indexArrays = null;
    for (var i = 0; i < findFuncs.length; ++i) {
        var func = findFuncs[i];
        indexArrays = func.bind(KQCard)(cards);
        if (indexArrays && indexArrays.length > 0) {
            break;
        }
    }

    var indexs = [];
    if (indexArrays && indexArrays.length > 0) {
        // 找出同类型的牌里的分数最大的牌
        var maxScore = 0;
        indexArrays.forEach(function (tempIndexs) {
            var tempCards = tempIndexs.map(function (index) {
                return cards[index];
            });
            var score = KQCard.scoreOfCards(tempCards);
            if (score > maxScore) {
                maxScore = score;
                indexs = tempIndexs;
            }
        });
    }

    var targetCards = indexs.map(function (index) {
        return cards[index];
    });

    if (targetCards.length < maxLength) {
        cards = cards.kq_excludes(targetCards);
        while (targetCards.length < maxLength) {
            targetCards.push(cards.pop());
        }
    } else if (targetCards.length > maxLength) {
        targetCards = targetCards.slice(o, maxLength);
    }

    return targetCards;
};

KQCard.testAutoSelect = function (cards) {};

cc._RFpop();
},{"KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension"}],"KQCard":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c548c0gMf5BGIH4309MULw+', 'KQCard');
// scripts\KQCard\KQCard.js

var KQCardColorsHelper = require('KQCardColorsHelper');
var KQCardPointsHelper = require('KQCardPointsHelper');
var NumberExtension = require('NumberExtension');
var GetCardPointsSameCount = require('GetCardPointsSameCount');

cc = cc || {};
cc.assert = cc.assert || console.assert || function () {};
cc.log = cc.log || console.log || function () {};
cc.error = cc.error || console.error || function () {};

// 牌 Model 类，封装了花色和点数
// 使用：
// new KQCard(22);
var KQCard = function KQCard(point, color, index) {
    this.color = null;
    this.point = null;
    this.sindex = index;
    this._initWithColorAndPoint = function (color, point) {
        if (color == 's') {
            color = 4;
        }
        if (color == 'h') {
            color = 3;
        }
        if (color == 'c') {
            color = 2;
        }
        if (color == 'd') {
            color = 1;
        }

        this.point = Number(point);
        this.scores = Number(point);
        this.color = Number(color);
        this.colorScores = Number(color);

        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithNumber = function (number) {
        this.point = Math.floor(number / 10);
        this.color = number % 10;
        cc.assert(this.point > 0);
        cc.assert(this.color > 0);
    };

    this._initWithObject = function (object) {
        if (object.point) {
            this._initWithColorAndPoint(object.color, object.point);
        } else if (object.suit) {
            this._initWithColorAndPoint(object.suit, object.number);
        }
    };

    this.description = function () {
        return this.cardName();
    };

    this.cardName = function () {
        return this.color + "_" + this.point;
    };

    this.sort = function (otherCard) {
        var asc = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
        var AisMax = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

        return KQCard.sort(this, otherCard, asc, AisMax);
    };

    this.isEqual = function (otherCard) {
        if (!otherCard) {
            return false;
        }
        return this.point == otherCard.point && this.color == otherCard.color && this.sindex == otherCard.sindex;
    };

    if (point && color) {
        this._initWithColorAndPoint(color, point);
        return;
    }

    var number = Number(point);
    if (!Number.isNaN(number)) {
        this._initWithNumber(number);
        return;
    }

    if (typeof point == 'string') {
        // 解析 xxxxd_d 形式
        var found = point.match(/(\.)*\d_\d+/);
        if (found instanceof Array && found.length > 0) {
            var result = found[0];
            var numbers = result.split('_');

            var _color = Number(numbers[0]);
            var _point = Number(numbers[1]);
            this._initWithColorAndPoint(_color, _point);
        }

        return;
    }

    if (typeof point == 'object') {
        this._initWithObject(point);
        return;
    }

    cc.error("初始化错误：" + point + " " + color);
};

// 转换成服务器的牌 model
KQCard.prototype.toServerCard = function () {
    return {
        'suit': this.color,
        'number': this.point
    };
};

KQCard.COLOR_SPADE = 4;
KQCard.COLOR_HEART = 3;
KQCard.COLOR_CLUB = 2;
KQCard.COLOR_DIAMOND = 1;

module.exports = KQCard;

KQCard.cardsFromArray = function (cardNames) {
    return cardNames.map(function (cardName, index) {
        return new KQCard(cardName, null, index);
    });
};

// 将多张牌转换成服务器的形式
KQCard.convertToServerCards = function (cards) {
    return cards.map(function (card) {
        return card.toServerCard();
    });
};

KQCard.TYPE = {
    WuLong: 0,
    DuiZi: 1,
    LiangDui: 2,
    SanTiao: 3,
    ShunZi: 4,
    TongHua: 5,
    HuLu: 6,
    TieZhi: 7,
    TongHuaShun: 8,
    /*#####*/
    WuTong: 9,
    /*#####*/
    SanTaoHua: 10, // 特殊牌
    SanShunZi: 11,
    LiuDuiBan: 12,

    WuDuiSanTiao: 13,
    SiTaoSanTiao: 14,

    CouYiSe: 15,
    SanFenTianXia: 16,
    SanTongHuaShun: 17,
    YiTiaoLong: 18,
    QingLong: 19
};

// 牌类型名
KQCard.cardsTypeName = function (cards) {
    var names = ['乌龙', '对子', '两对', '三条', '顺子', '同花', '葫芦', '铁支', '同花顺', '五同', '三同花', '三顺子', '六对半', '五对三条', '四套三条', '凑一色', '三分天下', '三同花顺', '一条龙', '清龙'];
    var type = KQCard.cardsType(cards);
    return names[type];
};

// 找出牌的类型
KQCard.cardsType = function (cards) {
    if (KQCard.isQingLong(cards)) {
        return KQCard.TYPE.QingLong;
    }

    if (KQCard.isYiTiaoLong(cards)) {
        return KQCard.TYPE.YiTiaoLong;
    }

    if (KQCard.isSanTongHuaShun(cards)) {
        return KQCard.TYPE.SanTongHuaShun;
    }

    if (KQCard.isSanFenTianXia(cards)) {
        return KQCard.TYPE.SanFenTianXia;
    }

    if (KQCard.isLiuDuiBan(cards)) {
        return KQCard.TYPE.LiuDuiBan;
    }

    if (KQCard.isSanTongHua(cards)) {
        return KQCard.TYPE.SanTaoHua;
    }

    if (KQCard.isSanShunZi(cards)) {
        return KQCard.TYPE.SanShunZi;
    }

    if (KQCard.isSanShunZi1(cards)) {
        return KQCard.TYPE.SanShunZi;
    }

    if (KQCard.isCouYiSe(cards)) {
        return KQCard.TYPE.CouYiSe;
    }

    if (KQCard.isWuDuiSanTiao(cards)) {
        return KQCard.TYPE.WuDuiSanTiao;
    }

    if (KQCard.isSiTaoSanTiao(cards)) {
        return KQCard.TYPE.SiTaoSanTiao;
    }

    /*#####*/
    if (KQCard.containWuTong(cards, 5)) {
        return KQCard.TYPE.WuTong;
    }

    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    //
    //if (KQCard.containWuTong(cards)) {
    //    return KQCard.TYPE.WuTong;
    //}
    /*#####*/

    if (KQCard.containTongHuaShun(cards, 5)) {
        return KQCard.TYPE.TongHuaShun;
    }

    if (KQCard.containTieZhi(cards)) {
        return KQCard.TYPE.TieZhi;
    }

    if (KQCard.containHuLu(cards)) {
        return KQCard.TYPE.HuLu;
    }

    if (KQCard.containTongHua(cards)) {
        return KQCard.TYPE.TongHua;
    }

    if (KQCard.containShunZi(cards)) {
        return KQCard.TYPE.ShunZi;
    }

    if (KQCard.containSanTiao(cards)) {
        return KQCard.TYPE.SanTiao;
    }

    if (KQCard.containLiaDui(cards)) {
        return KQCard.TYPE.LiangDui;
    }

    if (KQCard.containDuiZi(cards)) {
        return KQCard.TYPE.DuiZi;
    }

    return KQCard.TYPE.WuLong;
};

// 判断是否是同花
KQCard.isTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    var colors = cards.map(function (card) {
        return card.color;
    });

    var color = colors[0];
    for (var index in colors) {
        var e = colors[index];
        if (e != color) {
            return false;
        }
    }
    return true;
};

// 是否包含同花
KQCard.containTongHua = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findTongHua(cards).length > 0) {
        return true;
    }
    return false;
    //cards = Array.from(cards);
    //cards.sort(KQCard.sortByColor);
    //
    //for (var start = 0; (start + minLength) <= cards.length; ++start) {
    //    let subCards = cards.slice(start, start + minLength);
    //    if (KQCard.isTongHua(subCards, minLength)) {
    //        return true;
    //    }
    //}

    //return KQCard.containTongHua20(cards);
};
KQCard.containTongHua20 = function (card) {
    if (card.length < 5) {
        return false;
    }
    var card20 = KQCard.contain20(card);
    var cards = card.kq_excludes(card20);
    cards.sort(KQCard.sortByColor);

    for (var j = 1; j <= card20.length; ++j) {
        var num = 5 - j;
        for (var start = 0; start + num <= cards.length; ++start) {
            var subCards = cards.slice(start, start + num);
            if (KQCard.isTongHua(subCards, num)) {
                return true;
            }
        }
    }
    return false;
};
// 判断是否是顺子
KQCard.isShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }

    if (KQCard._isShunZiAKQ(cards)) {
        return true;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });

    var point = points[0];
    for (var index in points) {
        var e = points[index];
        if (e != point) {
            return false;
        }

        point = point + 1;
    }

    return true;
};

// 判断是否是 A K Q J 10 这个顺子
KQCard._isShunZiAKQ = function (cards) {
    var length = cards.length;
    if (length.length < 3) {
        return false;
    }

    var point1s = [1];
    var point14s = [14];
    var pointK = 13;

    Number(length - 1).kq_times(function (times) {
        point1s.push(pointK - times);
        point14s.push(pointK - times);
    });

    return KQCard._isCardsContainPoints(cards, point1s) || KQCard._isCardsContainPoints(cards, point14s);
};

// cards 中是否包含 points 这些点数

KQCard._isCardsContainPoints = function (cards, points) {
    var _loop = function (index) {
        var point = points[index];
        var pointCardIndex = cards.findIndex(function (card) {
            return card.point == point;
        });

        if (pointCardIndex < 0) {
            return {
                v: false
            };
        }
    };

    for (var index = 0; index < points.length; ++index) {
        var _ret = _loop(index);

        if (typeof _ret === 'object') return _ret.v;
    }

    return true;
};
KQCard.contain20 = function (cards) {
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var newCard = cards.filter(function (card) {
        //重新赋值cards
        if (card.point >= 20) {
            return card;
        }
    });
    return newCard || [];
};
// 是否包含顺子
KQCard.containShunZi = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findShunZi(cards).length > 0) {
        return true;
    }
    return false;
    //let uniqueCards = cards.unique(function(card1, card2) {
    //    return card1.point == card2.point;
    //});
    //uniqueCards.sort(KQCard.sortByPoint);
    //
    //let minPointCard = uniqueCards[0];
    //if (minPointCard.point == 1) {
    //    let APlusCard = new KQCard(minPointCard);
    //    APlusCard.point = 14;
    //    uniqueCards.push(APlusCard);
    //}
    //
    //for (var start = 0; (start + minLength) <= uniqueCards.length; ++start) {
    //    let subCards = uniqueCards.slice(start, start + minLength);
    //    if (KQCard.isShunZi(subCards, minLength)) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containShunZi20(cards);
};
/*KQCard.containShunZi20 = function (card) {
    if (card.length < 5) {
        return false;
    }
    var card20 = KQCard.contain20(card);
    var cards = card.kq_excludes(card20);
    // 先根据点数去重
    var newArr = [];
    var newArrs = [];
    for (var i = 0; i < cards.length; i++) {
        if (newArrs.indexOf(cards[i].point) == -1) {
            newArr.push(cards[i]);
            newArrs.push(cards[i].point);
        }
    }
    //newArr.forEach(function(card){
    //    if(card.scores == 14){
    //        card.scores = 1;
    //    }
    //})
    newArr.sort(function (n1, n2) {
        return n1.point - n2.point;
    });
    for(var j = 1;j <= card20.length;++j){
        var num = 5 - j;
        for (var start = 0; (start + num) <= newArr.length; ++start) {
            var subCards = newArr.slice(start, start + num);
            var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
            if(bool){
                return true;
            }
        }
    }
    // 由于点数是唯一且升序，只需要依次遍历判断是否是顺子即可
    let convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
        return false;
    }
    return KQCard.containShunZi20(convertedCards);
};*/
// 是否是同花顺
KQCard.isTongHuaShun = function (cards) {
    return KQCard.isTongHua(cards) && KQCard.isShunZi(cards);
};

// 是否包含有同花顺
KQCard.containTongHuaShun = function (cards) {
    var minLength = arguments.length <= 1 || arguments[1] === undefined ? 5 : arguments[1];

    if (cards.length < minLength) {
        return false;
    }
    if (KQCard.findTongHuaShun(cards).length > 0) {
        return true;
    }
    return false;
    //var sanShunZi = KQCard.sanShunZi1(cards,minLength)[0];
    //if(sanShunZi == null){
    //    return false;
    //}
    //var result = false;
    //for(var i=0;i<sanShunZi.length;i++) {
    //    var s = sanShunZi[i];
    //    if (KQCard.isTongHuaShun(s, minLength)) {
    //        return true;
    //    }
    //}
    //return KQCard.containTongHuaShun1(cards);
};
/*KQCard.containTongHuaShun1 = function (cards, minLength = 5) {
    if (cards.length < minLength) {
        return false;
    }
    let tempCards = Array.from(cards).sort(KQCard.sortByColor);
    for (var start = 0; (start + minLength) <= tempCards.length; ++start) {
        let subCards = tempCards.slice(start, start + minLength);
        if (KQCard.isTongHuaShun(subCards, minLength)) {
            return true;
        }
    }

    let convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
        return KQCard.containTongHuaShun20(cards);
    }
    return KQCard.containTongHuaShun1(convertedCards);
    //return false;
};
KQCard.containTongHuaShun20 = function (card, minLength = 5) {
    if (card.length < minLength) {
        return false;
    }
    var card20 = KQCard.contain20(card) || [];
    var cards = card.kq_excludes(card20);

    cards = Array.from(cards);
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    var pointS = []; //黑桃
    var pointH = []; //红心
    var pointC = []; //梅花
    var pointD = []; //方块
    for(var i=0;i<cards.length;i++){
        if(cards[i].color == '4'){
            if(pointS.indexOf(cards[i].point) == -1){
                pointS.push(cards[i].point);
                colorS.push(cards[i]);
            }

        }else if(cards[i].color == '3'){
            if(pointH.indexOf(cards[i].point) == -1){
                pointH.push(cards[i].point);
                colorH.push(cards[i]);
            }
        }else if(cards[i].color == '2'){
            if(pointC.indexOf(cards[i].point) == -1){
                pointC.push(cards[i].point);
                colorC.push(cards[i]);
            }
        }else if(cards[i].color == '1'){
            if(pointD.indexOf(cards[i].point) == -1){
                pointD.push(cards[i].point);
                colorD.push(cards[i]);
            }
        }
    }

    var color = [colorS,colorH,colorC,colorD];
    var colorSum = [];    //总共有几种花色 [5,3,0....]
    for(var i=0;i<color.length;i++){
        if(color[i].length >= parseInt(5 - card20.length)){
            //color[i].forEach(function(ca){
            //    if(ca.scores == 14){
            //        ca.scores = 1;
            //    }
            //})
            color[i].sort(function(a1,a2){
                return a1 - a2;
            })
            colorSum.push(color[i]);
        }
    }

    for(var i=0;i<colorSum.length;i++) {
        var s = colorSum[i]
        for(var j = 1;j <= card20.length;++j){
            var num = 5 - j;
            for (var start = 0; (start + num) <= s.length; ++start) {
                var subCards = s.slice(start, start + num);
                var bool = parseInt(subCards[num-1]['scores']) - parseInt(subCards[0]['scores']) < 5;
                if(bool){
                    return true;
                }
            }
        }
    }



    let convertedCards = KQCard._convertOneToA1(card);
    if (card === convertedCards) {
        return false;
    }
    return KQCard.containTongHuaShun20(convertedCards);
};*/

// 是否是清龙
KQCard.isQingLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    /**
     *
     */
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
        }
    }
    if (colorSum.length == 1) {
        if (colorSum[0] == 13) {
            return KQCard.isYiTiaoLong(cards);
        }
    }
    //return KQCard.isTongHuaShun(cards);
    return false;
};

// 是否是一条龙
KQCard.isLong = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }

    return KQCard.isShunZi(cards);
};

/*#####*/
/*是否一条龙*/
KQCard.isYiTiaoLong = function (cards) {
    //cards:{number:1~13 ,'suit':'h'...}
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].number == 'undefined') {
        cards = KQCard.convertToServerCards(cards);
    }
    var number = cards.map(function (card) {
        return card.number;
    }).sort(function (n1, n2) {
        return n1 - n2;
    });
    for (var i = 0; i < cards.length - 1; i++) {
        if (number[i] != number[i + 1] - 1) {
            return false;
        }
    }
    return true;
};
/*#####*/
/*是否三同花*/
KQCard.isSanTongHua = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == "undefined") {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    var colorC = []; //梅花
    var colorD = []; //方块
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's') {
            colorS.push(cards[i]);
        } else if (cards[i].suit == 'h') {
            colorH.push(cards[i]);
        } else if (cards[i].suit == 'c') {
            colorC.push(cards[i]);
        } else if (cards[i].suit == 'd') {
            colorD.push(cards[i]);
        }
    }
    var ls = colorS.length; //黑桃个数
    var lh = colorH.length; //红桃个数
    var lc = colorC.length; //梅花个数
    var ld = colorD.length; //方块个数
    var color = [ls, lh, lc, ld];
    var colorSum = []; //总共有几种花色 [5,3,0....]
    for (var i = 0; i < color.length; i++) {
        if (color[i] != 0) {
            colorSum.push(color[i]);
        }
    }

    //如果牌中包含四种花色就不可能是三同花
    if (colorSum.length == 4) {
        return false;
    }

    //三种花色
    if (colorSum.length == 3) {
        for (var i = 0; i < colorSum.length; i++) {
            if (colorSum[i] != 5 && colorSum[i] != 3) {
                return false;
            }
        }
        return true;
    }
    //两种花色
    else if (colorSum.length == 2) {
            for (var i = 0; i < colorSum.length; i++) {
                if (colorSum[i] != 10 && colorSum[i] != 3 && colorSum[i] != 8 && colorSum[i] != 5) {
                    return false;
                }
            }

            return true;
        }
        //一种花色
        else if (colorSum.length == 1) {
                if (colorSum[0] == 13) {
                    return true;
                }
            }
};
/*是否凑一色*/
KQCard.isCouYiSe = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    var colorS = []; //黑桃
    var colorH = []; //红心
    for (var i = 0; i < cards.length; i++) {
        if (cards[i].suit == 's' || cards[i].suit == 'c') {
            colorS.push(cards[i]); //全黑
        } else if (cards[i].suit == 'h' || cards[i].suit == 'd') {
                colorH.push(cards[i]); //全红
            }
    }

    //如果牌中包含四种花色就不可能是三同花
    if (colorS.length == 13 || colorH.length == 13) {
        return true;
    }
    //else if(colorH.length == 13){
    //    return true;
    //}
    return false;
};
/*#####*/
// 是否是六对半
KQCard.isLiuDuiBan = function (cards) {
    var length = 12;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfYi = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value >= 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        } else if (value == 1) {
            numberOfYi += 1;
        }
    }
    return numberOfDuiZi == 6;
};

KQCard.isWuDuiSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var duiZiLength = 2;
    var sanTiaoLength = 3;
    //计算一个牌数组内的相同点数的牌的张数
    var cardNumbers = new GetCardPointsSameCount(cards);
    var numberOfDuiZi = 0;
    var numberOfSanTiao = 0;
    for (var prop in cardNumbers) {
        var value = cardNumbers[prop];
        if (value == duiZiLength) {
            numberOfDuiZi = numberOfDuiZi + 1;
        } else if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        } else if (value >= 4) {
            numberOfDuiZi = numberOfDuiZi + 2;
        }
    }
    return numberOfDuiZi == 5 && numberOfSanTiao == 1;
};
/*#####*/
KQCard.isSanShunZi1 = function (cards) {
    if (cards.length != 13) {
        return false;
    }

    //取出牌的点数
    if (typeof cards[0].suit == 'undefined') {
        cards = KQCard._convertCardsToCardNames(cards);
    }
    //var card20 = KQCard.contain20(cards);
    //if(card20.length > 0) {
    //    return false;
    //}
    var number = cards.map(function (card) {
        return card.number;
    });
    //排序
    number.sort(function (n1, n2) {
        return n1 - n2;
    });
    if (KQCard.fenZhu(number, 5, 5) == false) {
        var number = cards.map(function (card) {
            return card.number;
        });
        //排序
        number.sort(function (n1, n2) {
            return n1 - n2;
        });
        if (KQCard.fenZhu(number, 5, 3) == false) {
            var number = cards.map(function (card) {
                return card.number;
            });
            //排序
            number.sort(function (n1, n2) {
                return n1 - n2;
            });
            if (KQCard.fenZhu(number, 3, 5) == false) {
                var AIsExist = false; //是否存在A
                for (var i in cards) {
                    if (cards[i].number == 1) {
                        AIsExist = true;
                        break;
                    }
                }
                if (!AIsExist) {
                    return false;
                }

                for (var i in cards) {
                    if (cards[i].number == 1) {
                        cards[i].number = 14;
                        break;
                    }
                }
                return KQCard.isSanShunZi1(cards);
            } else {
                return true;
            }
        } else {
            return true;
        }
    } else {
        return true;
    }
};

//判断5张或者3张是否顺子
KQCard.isShunZi1 = function (arr) {
    for (var i = 0; i < arr.length - 1; i++) {
        if (arr[i + 1] - arr[i] != 1) {
            //不是顺子
            return false;
        }
    }
    return true;
};

KQCard.fenZhu = function (number, num1, num2) {
    var arr1 = [];
    var arr2 = [];
    for (var i = 0; i < number.length - 1; i++) {
        if (i == 0) {
            arr1.push(number[0]);
        }
        if (number[i + 1] - number[i] == 0) {
            continue;
        }
        arr1.push(number[i + 1]);
        if (arr1.length == num1) {
            //取第一组是顺子
            if (KQCard.isShunZi1(arr1)) {
                //这5个是顺子,从数组中移除
                for (var i = 0; i < arr1.length; i++) {
                    for (var j = 0; j < number.length - 1; j++) {
                        if (number[j] == arr1[i]) {
                            //两个数一样的只删除一个
                            if (number[j] == number[j + 1]) {
                                continue;
                            }
                            number.splice(j, 1); //从number中移除
                        }
                    }
                }
                //接下来取第二组
                for (var i = 0; i < number.length - 1; i++) {
                    if (i == 0) {
                        arr2.push(number[0]);
                    }
                    if (number[i + 1] - number[i] == 0) {
                        continue;
                    }
                    arr2.push(number[i + 1]);
                    if (arr2.length == num2) {
                        //取第二组是顺子
                        if (KQCard.isShunZi1(arr2)) {
                            for (var i = 0; i < arr2.length; i++) {
                                for (var j = 0; j < number.length - 1; j++) {
                                    if (number[j] == arr2[i]) {
                                        //两个数一样的只删除一个
                                        if (number[j] == number[j + 1]) {
                                            continue;
                                        }
                                        number.splice(j, 1); //从number中移除
                                    }
                                }
                            }
                            //接下来就是剩下的了
                            if (KQCard.isShunZi1(number)) {
                                //第三组也是顺子
                                return true;
                            }
                            //第三组不是顺子
                            return false;
                        }
                        //第二组不是顺子
                        return false;
                    }
                }
            }
            //第一组不是顺子
            return false;
        }
    }
};
// isSanShunZi2是我写的
KQCard.isSanShunZi = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    if (typeof cards[0].point == 'undefined') {
        cards = KQCard.cardsFromArray(cards);
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    cards = Array.from(cards);
    cards.sort(KQCard.sortByPoint);
    var wei = [];
    var zhong = [];
    var tou = [];
    var sanShunZi = KQCard.sanShunZi1(cards)[0]; //获取所有组合的头道
    if (!sanShunZi) {
        //你连头道都没有 怎么更我混
        return false;
    }

    var newCard = cards.filter(function (i) {
        //重新赋值cards
        return i;
    });
    var newCards1 = [];
    var newPoint = []; //判断point是否相同
    var duiZi = []; //取出有对子当中的一张牌
    for (var s in cards) {
        if (newPoint.indexOf(cards[s].point) < 0) {
            newCards1.push(cards[s]);
            newPoint.push(cards[s].point);
        } else {
            //取出有对子当中的一张牌
            duiZi.push(cards[s]);
        }
    }

    for (var j = 0; j < sanShunZi.length; ++j) {
        //循环所有头道
        var number3 = sanShunZi[j];
        if (typeof number3 == 'undefined') {
            continue;
        }
        for (var i = 0; i < cards.length; ++i) {
            var newCards = newCards1.filter(function (i) {
                //重新赋值cards
                return i;
            });

            newCards = newCards.kq_excludes(number3); //删除牌里的头道
            if (wei.length != 5) {
                var subCards = newCards.slice(i, i + 5);
                if (KQCard.isShunZi(subCards)) {
                    //得到尾道 删除牌里的尾道
                    wei = subCards;
                    newCards = newCards.kq_excludes(subCards);
                }
            }
            if (wei.length == 5) {
                //把剩余的牌和对子的单张合并
                var tasks = duiZi.filter(function (i) {
                    //重新赋值对子
                    return i;
                });
                tasks = tasks.kq_excludes(number3); //判断头道和对子的单张是否有相同 有的话就删除
                newCards = newCards.concat(tasks); //把剩余的牌和对子的单张合并
            }
            if (zhong.length != 5 && newCards.length == 5) {
                if (KQCard.isShunZi(newCards)) {
                    //是三顺子
                    zhong = newCards;
                }
            }
            if (wei.length == 5 && zhong.length == 5) {
                //是三顺子终止循环
                break;
            } else {
                //来吧 继续吧
                zhong = [];wei = [];tou = [];
            }
        }
        if (wei.length == 5 && zhong.length == 5) {
            //是三顺子终止循环
            tou = number3;
            break;
        } else {
            //来吧 继续吧
            zhong = [];wei = [];tou = [];
        }
    }

    cards = newCard;
    if (KQCard._isSanShunZi(tou, zhong, wei)) {
        //是三顺子
        return true;
    }
    var convertedCards = KQCard._convertOneToA1(cards);
    if (cards === convertedCards) {
        return false;
    }
    return KQCard.isSanShunZi(convertedCards);
};

KQCard.sanShunZi1 = function (cards) {
    var length = arguments.length <= 1 || arguments[1] === undefined ? 3 : arguments[1];

    var shunzi = KQCard.findShunZi(cards, length);
    var cardsT = [];
    var cardsIndex = [];
    if (shunzi == null) {
        return false;
    }
    for (var i = 0; i < shunzi.length; i++) {
        var a = shunzi[i];
        var cardsShunzi = [];
        // var cardsIndex = [];
        for (var j = 0; j < a.length; j++) {
            var index = a[j];
            if (typeof cards[index] == 'undefined') {
                continue;
            }
            cardsShunzi.push(cards[index]);
        }
        cardsIndex.push(a);
        cardsT.push(cardsShunzi);
    }
    return [cardsT, cardsIndex];
};

KQCard._isSanShunZi = function (touCards, zhongCards, weiCards) {
    return KQCard.isShunZi(touCards) && KQCard.isShunZi(zhongCards) && KQCard.isShunZi(weiCards);
};
// 是否是三同花顺
KQCard.isSanTongHuaShun = function (cards) {
    var length = 13;
    if (cards.length != length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorCardsObject = KQCard._colorClassCards(cards);

    var subCards = [];
    for (var prop in colorCardsObject) {
        var _cards = colorCardsObject[prop];
        subCards.push(_cards);
    }

    if (subCards.length != 3) {
        return false;
    }

    subCards = subCards.sort(function (s1, s2) {
        return s1.length > s2.length;
    });

    var touCards = subCards[0];
    var zhongCards = subCards[1];
    var weiCards = subCards[2];

    if (touCards.length != 3 || zhongCards.length != 5 || weiCards.length != 5) {
        return false;
    }

    return KQCard._isSanTongHuaShun(touCards, zhongCards, weiCards);
};

// 将牌根据 color 进行分类
KQCard._colorClassCards = function (cards) {
    var colorCardsObject = {};
    cards.forEach(function (card) {
        var color = card.color;
        var subCards = colorCardsObject[color];
        if (!subCards) {
            subCards = [];
            colorCardsObject[color] = subCards;
        }
        subCards.push(card);
    });

    return colorCardsObject;
};

// 是否是三同花顺
KQCard._isSanTongHuaShun = function (touCards, zhongCards, weiCards) {
    return KQCard.isTongHuaShun(touCards) && KQCard.isTongHuaShun(zhongCards) && KQCard.isTongHuaShun(weiCards);
};

// 是否是 “三分天下”
KQCard.isSanFenTianXia = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }

    var tieZhiLength = 4;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfTieZhi = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == tieZhiLength) {
            numberOfTieZhi = numberOfTieZhi + 1;
        }
    }
    return numberOfTieZhi === 3;
};

// 是否是 “四套三条”
KQCard.isSiTaoSanTiao = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var sanTiaoLength = 3;
    var pointHelper = new KQCardPointsHelper(cards);
    var numberOfSanTiao = 0;
    for (var prop in pointHelper.pointNumbers) {
        var value = pointHelper.pointNumbers[prop];
        if (value == sanTiaoLength) {
            numberOfSanTiao = numberOfSanTiao + 1;
        }
    }

    return numberOfSanTiao == 4;
};

// 是否是 “三桃花”
// 头、中、尾道为相同花色的牌
KQCard.isSanTaoHua = function (cards) {
    var length = 13;
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    if (card20.length > 0) {
        return false;
    }
    var colorHelper = new KQCardColorsHelper(cards);
    var colorNumbers = [];
    for (var prop in colorHelper.colorNumber) {
        colorNumbers.push(colorHelper.colorNumber[prop]);
    }

    colorNumbers.sort(function (n1, n2) {
        return n1 - n2;
    });

    if (colorNumbers.length != 3) {
        return false;
    }

    if (colorNumbers[0] == 3 && colorNumbers[1] == 5 && colorNumbers[2] == 5) {
        return true;
    }

    return false;
};

// 判断是否包含铁支
// 四张同样点数的牌
KQCard.containTieZhi = function (cards) {
    var length = 4;
    if (cards.length < length) {
        return false;
    }
    //let helper = new KQCardPointsHelper(cards);
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}else{
    //    return KQCard.containGuiPai(cards,4);
    //}
    if (KQCard.findTieZhi(cards).length > 0) {
        return true;
    }
    return false;
};

// 判断是否是铁支
KQCard.isTieZhi = function (cards) {
    var length = 4;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};

/*#####是否包含五同*/
//五张同样点数的牌
KQCard.containWuTong = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    //五张牌相同的
    //let helper = new KQCardPocontain20intsHelper(cards);
    //if(helper.maxNumber() >= length){
    //    return helper.maxNumber() >= length;
    //}else{
    //    return KQCard.containGuiPai(cards,5);
    //}
    if (KQCard.findWuTong(cards).length > 0) {
        return true;
    }
    return false;
};

/*判断是否五同*/
KQCard.isWuTong = function (cards) {
    var length = 5;
    if (cards.length != length) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (point == card.point) {
            return point;
        }
        return -1;
    }, cards[0].point);

    return result != -1;
};
/*#####*/

// 是否是 “葫芦”
// 三张相同 + 一对
KQCard.containHuLu = function (cards) {
    var length = 5;
    if (cards.length < length) {
        return false;
    }
    if (KQCard.findHuLu(cards).length > 0) {
        return true;
    }
    //let pointHelper = new KQCardPointsHelper(cards);
    //var pointNumbers = [];
    //var index = 0;
    //for (let prop in pointHelper.pointNumbers) {
    //    pointNumbers[index] = pointHelper.pointNumbers[prop];
    //    index = index + 1;
    //}
    //var h=[];
    //var h1=[];
    //for(var i in pointNumbers){
    //    var s=pointNumbers[i];
    //    if(s == 3){
    //        h.push(s)
    //    }
    //    else if(s==4){
    //        h1.push(s)
    //    }
    //
    //}
    //
    //if ((pointNumbers.indexOf(3) != -1) && (pointNumbers.indexOf(2) != -1)
    // || h.length > 1 || h1.length > 1 ||(pointNumbers.indexOf(4) != -1)
    // && (pointNumbers.indexOf(2) != -1)) {
    //    return true;
    //}

    return false;
};

// 判断是否是 葫芦
KQCard.isHuLu = function (cards) {
    if (cards.length != 5) {
        return false;
    }

    var points = cards.map(function (card) {
        return card.point;
    }).sort(function (p1, p2) {
        return p1 - p2;
    });

    var p1 = points[0];
    var p2 = p1;
    var numberP1 = 0;
    var numberP2 = 0;

    points.forEach(function (point) {
        if (point != p1 && point != p2) {
            p2 = point;
            numberP2 = 0;
        }

        numberP1 = numberP1 + (point == p1 ? 1 : 0);
        numberP2 = numberP2 + (point == p2 ? 1 : 0);
    });

    var maxNumber = Math.max(numberP1);
    var minNumber = Math.min(numberP2);

    return minNumber == 2 && maxNumber == 3;
};

// 是否包含有 “三条”
KQCard.containSanTiao = function (cards) {
    if (cards.length < 3) {
        return false;
    }
    if (KQCard.findSanTiao(cards).length > 0) {
        return true;
    }
    return false;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] >= 3) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containGuiPai(cards,3);
};

// 是否是 “三条”
KQCard.isSanTiao = function (cards) {
    if (cards.length != 3) {
        return false;
    }

    var result = cards.reduce(function (point, card) {
        if (card.point == point) {
            return point;
        }

        return -1;
    }, cards[0].point);

    return result != -1;
};

// 是否包含有 ：两对
KQCard.containLiaDui = function (cards) {
    if (cards.length < 4) {
        return false;
    }
    if (KQCard.findLiaDui(cards).length > 0) {
        return true;
    }
    //var numberOfDuiZi = 0;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] == 2) {
    //        numberOfDuiZi = numberOfDuiZi + 1;
    //        if (numberOfDuiZi == 2) {
    //            return true;
    //        }
    //    }
    //}

    return false;
};

// 是否是 两对
KQCard.isLiaDui = function (cards) {
    if (cards.length != 4) {
        return false;
    }

    var pointHelper = new KQCardPointsHelper(cards);
    for (var prop in pointHelper.pointNumbers) {
        if (pointHelper.pointNumbers[prop] != 2) {
            return false;
        }
    }
    return true;
};

// 是不是对子
KQCard.isDuiZi = function (cards) {
    if (cards.length != 2) {
        return false;
    }

    var card1 = cards[0];
    var card2 = cards[1];

    return card1.point == card2.point;
};

// 是否包含对子
KQCard.containDuiZi = function (cards) {
    if (cards.length < 2) {
        return false;
    }
    if (KQCard.findDuiZi(cards).length > 0) {
        return true;
    }
    return false;
    //let pointHelper = new KQCardPointsHelper(cards);
    //for (let prop in pointHelper.pointNumbers) {
    //    if (pointHelper.pointNumbers[prop] == 2) {
    //        return true;
    //    }
    //}
    //
    //return KQCard.containGuiPai(cards,2);
};

KQCard.containGuiPai = function (cards, length) {
    if (cards.length < length) {
        return false;
    }
    var card20 = KQCard.contain20(cards);
    cards = cards.kq_excludes(card20);
    var helper = new KQCardPointsHelper(cards);
    var maxNumber = helper.maxNumber() + card20.length;
    return maxNumber >= length;
};
/*#####*/
// 是否是特殊牌
KQCard.isTeShuPai = function (cards) {
    if (cards.length < 13) {
        return false;
    }

    return KQCard.isQingLong(cards) || KQCard.isYiTiaoLong(cards)
    /*|| KQCard.isSanTongHuaShun(cards)
    || KQCard.isSanFenTianXia(cards)
    || KQCard.isSiTaoSanTiao(cards)
    || KQCard.isLiuDuiBan(cards)
    || KQCard.isSanShunZi(cards)
    || KQCard.isSanShunZi1(cards)
    || KQCard.isSanTongHua(cards)
    || KQCard.isWuDuiSanTiao(cards)
    || KQCard.isCouYiSe(cards)*/;
};

// 将牌中的 1 变化为 A（14)
KQCard._convertOneToA = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var result = cards.map(function (card) {
        if (card.point == 1) {
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

KQCard._convertOneToA1 = function (cards) {
    if (cards.find(function (card) {
        return card.point == 1;
    }) == undefined) {
        return cards;
    }
    var num = 0;
    var result = cards.map(function (card) {
        if (card.point == 1 && num == 0) {
            num++;
            var newCard = new KQCard(14, card.color);
            return newCard;
        }
        return card;
    });

    return result;
};

// KQCard 的排序方法
KQCard.sortByPoint = function (card1, card2) {
    var result = Number(card1.point) - Number(card2.point);
    return result;
};

KQCard.sortByColor = function (card1, card2) {
    var pointAsc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];

    if (card2.color == card1.color) {
        return (card1.point - card2.point) * (pointAsc ? 1 : -1);
    }
    return card2.color - card1.color;
};

KQCard.sort = function (card1, card2) {
    var asc = arguments.length <= 2 || arguments[2] === undefined ? true : arguments[2];
    var AisMax = arguments.length <= 3 || arguments[3] === undefined ? true : arguments[3];

    var result = 1;
    if (card1.point == card2.point) {
        result = card1.color - card2.color;
    } else {
        var point1 = card1.point;
        var point2 = card2.point;
        if (AisMax && point1 == 1) {
            point1 = 14;
        }

        if (AisMax && point2 == 1) {
            point2 = 14;
        }

        result = point1 - point2;
    }

    return result * (asc ? 1 : -1);
};

//转为客户端的牌
KQCard._convertCardsToCardNames = function (cards) {
    // [{"suit":"s","number":10}]
    var suitColorMap = ['', 'd', 'c', 'h', 's'];
    return cards.map(function (card) {
        var cardNumber = card.point;
        var color = suitColorMap[card.color];
        var number = Math.max(Math.min(cardNumber, 13), 1);
        return { number: number, suit: color };
    });
};

cc._RFpop();
},{"GetCardPointsSameCount":"GetCardPointsSameCount","KQCardColorsHelper":"KQCardColorsHelper","KQCardPointsHelper":"KQCardPointsHelper","NumberExtension":"NumberExtension"}],"KQGlabolSocketEventHander":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'babea3CWj9G1pWM9AkXao0n', 'KQGlabolSocketEventHander');
// scripts\Socket\KQGlabolSocketEventHander.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var KQGlabolSocketEventHander = {
    start: function start() {
        if (this._didStart) {
            return;
        }
        this._didStart = true;

        KQGlobalEvent.on(Socket.Event.ReceiveForceExit, this._forceExitApp, this);
    },

    _forceExitApp: function _forceExitApp(response) {
        KQNativeInvoke.forceExitApp();
    }
};

module.exports = KQGlabolSocketEventHander;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","socket":"socket"}],"KQGlobalEvent":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd90d6OrggVEXa29ffA+vZY0', 'KQGlobalEvent');
// scripts\Event\KQGlobalEvent.js

var KQGlobalEvent = {
    _handles: {},
    //发送事件
    emit: function emit(eventName) {
        var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

        if (typeof data == 'string') {
            data = { 'data': data };
        }

        var returns = []; //返回值
        data.eventName = eventName; //保存一下事件名字

        for (var findEvenName in this._handles) {
            if (findEvenName == eventName) {
                for (var i = 0; i < this._handles[findEvenName].length; i++) {
                    var returnValue = this._handles[findEvenName][i](data);
                    returns.push(returnValue);
                }
            }
        }

        return returns;
    },
    //添加普通事件
    on: function on(eventName, callback, target) {
        // console.log('收到事件', eventName);
        this._handles[eventName] = this._handles[eventName] || [];

        this._handles[eventName].push(callback.bind(target));
        callback._caller = target;
    },

    //通过事件名移除一个监听器
    off: function off(eventName) {
        for (var i = 0; i < this._handles[eventName].length; i++) {
            this._handles[eventName][i] = null;
        }
    },

    // 移动一个 target 上所有的监听
    offTarget: function offTarget(target) {
        for (var name in this._handles) {
            var eventHandlers = this._handles[name];
            var indexs = eventHandlers.filter(function (callback) {
                return callback._caller = target;
            }).map(function (callback, index) {
                return index;
            });

            var indexOffset = 0;
            indexs.forEach(function (index) {
                eventHandlers.splice(index + indexOffset, 1);
                indexOffset = indexOffset + 1;
            });
        }
    }
};

module.exports = KQGlobalEvent;

cc._RFpop();
},{}],"KQNativeInvoke":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7327dLBqWVNaJ14fJQ4jq6Y', 'KQNativeInvoke');
// scripts\Utils\KQNativeInvoke.js

var KQNativeInvoke = {
  IOSClassName: "AppController",
  ANDRIODClassName: "com/lling/ssz/AppActivity",

  isNativeIOS: function isNativeIOS() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.IPHONE || platform == cc.sys.IPAD) {
      return true;
    }
    return false;
  },

  isNativeAndroid: function isNativeAndroid() {
    var platform = cc.sys.platform;
    if (platform == cc.sys.ANDROID) {
      return true;
    }
    return false;
  },

  isNative: function isNative() {
    return cc.sys.isNative == true;
  }
};

// MARK: 可调用的本地方法
/**
 * 微信登录
 */
KQNativeInvoke.wxLogin = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
  } else if (KQNativeInvoke.isNativeAndroid()) {
      //Android
      jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
    }
};

/**
 * 分享大厅信息到微信好友
 * 
 */
KQNativeInvoke.shareHallToWeChatFriend = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallFriend", "()V");
  }
};

/**
 * 分享大厅信息到朋友圈
 * 
 */
KQNativeInvoke.shareHallToWeChatTimeline = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", "()V");
  }
};

/**
 * 强制退出 APP
 * 
 */
KQNativeInvoke.forceExitApp = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
  }
};

/**
 * 下载新版本
 * 
 * @param {String} iosUrl      iOS 版本地址
 * @param {String} androidUrl  安卓版本地址
 */
KQNativeInvoke.downloadNewVersion = function (iosUrl, androidUrl) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", iosUrl);
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", androidUrl);
  }
};

/**
 * 分享房间给微信好友
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatFriend = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", id, description);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", "(Ljava/lang/String;Ljava/lang/String;)V", id, description);
  }
};

/**
 * 分享房间到微信朋友圈
 * 
 * @param {String} roomId         房间 id 信息
 * @param {String} description    文本描述
 */
KQNativeInvoke.shareRoomToWeChatTimeline = function (roomId, description) {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShare:description:", id, description);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShare", "(Ljava/lang/String;Ljava/lang/String;)V", id, description);
  }
};

/**
 * 分享屏幕截图到微信好友
 */
KQNativeInvoke.shareScreenToWeChatFriend = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShareFriend", "()V");
  }
};

/**
 * 分享屏幕截图到微信朋友圈
 */
KQNativeInvoke.shareScreenToWeChatTimeline = function () {
  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
  } else {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
  }
};

/**
 * 开始录音
 */
KQNativeInvoke.startRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
  }
};

/**
 * 结束录音
 */
KQNativeInvoke.endRecord = function () {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
  } else if (KQNativeInvoke.isNativeAndroid()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
  }
};

KQNativeInvoke.screenshotShare = function () {
  var strings = arguments.length <= 0 || arguments[0] === undefined ? 'shareIMG' : arguments[0];

  if (this._isCapturing) {
    return;
  }
  this._isCapturing = true;
  var size = cc.director.getWinSize();
  var fileName = "result_share.jpg";
  var fullPath = jsb.fileUtils.getWritablePath() + fileName;
  if (jsb.fileUtils.isFileExist(fullPath)) {
    jsb.fileUtils.removeFile(fullPath);
  }
  var texture = new cc.RenderTexture(Math.floor(size.width), Math.floor(size.height), cc.IMAGE_FORMAT_PNG, gl.DEPTH24_STENCIL8_OES);
  texture.setPosition(cc.p(size.width / 2, size.height / 2));
  texture.begin();
  cc.director.getRunningScene().visit();
  texture.end();
  texture.saveToFile(fileName, cc.IMAGE_FORMAT_PNG);

  var self = this;
  var tryTimes = 0;
  var fn = function fn() {
    if (jsb.fileUtils.isFileExist(fullPath)) {

      if (cc.sys.os == cc.sys.OS_ANDROID) {
        jsb.reflection.callStaticMethod(self.ANDRIODClassName, strings, "(Ljava/lang/String;)V", fullPath);
      }
      self._isCapturing = false;
    } else {
      tryTimes++;
      if (tryTimes > 10) {
        console.log("time out...");
        return;
      }
      setTimeout(fn, 50);
    }
  };
  setTimeout(fn, 50);
};

/**
 * 播放网络语音
 * 
 * @param {String} audioUrl 语音地址
 */
KQNativeInvoke.playAudioWithUrl = function (audioUrl) {
  if (!KQNativeInvoke.isNative()) {
    return;
  }

  if (KQNativeInvoke.isNativeIOS()) {
    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", audioUrl);
  } else if (KQNativeInvoke.isNativeAndroid()) {
    //Android
    jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", audioUrl);
  }
};

module.exports = KQNativeInvoke;

cc._RFpop();
},{}],"MsgControl":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'dd242dsY+hBG5LpL7ZF7Kn6', 'MsgControl');
// scripts\Chat\MsgControl.js

var Socket = require('socket');
var ChatMessage = require('ChatMessage');
var AudioManager = require('AudioManager');

// 用来发送消息的 component
cc.Class({
  'extends': cc.Component,

  properties: {
    bqNode: cc.Node,
    bqNode1: cc.Node,
    btnLanguageNode: cc.Node,
    btnLanguageNode1: cc.Node,
    btnChartNode: cc.Node,
    btnChartNode1: cc.Node,
    textScrollView: cc.Node,
    imageContentNode: cc.Node,

    editBox: cc.EditBox,

    textRecordScrollView: cc.ScrollView,
    textRecordLayout: cc.Layout,

    textPrefab: cc.Prefab,
    chatTextRecordPrefab: cc.Prefab,
    // imagePrefab:cc.Prefab,

    inputNode: cc.Node,

    _userId: null,

    _playerInfos: null, // 记录用户信息
    _chatTextMessageRecords: null },

  // 聊天文本消息记录
  // use this for initialization
  onLoad: function onLoad() {
    this._userId = Socket.instance.userInfo.id;
    this._playerInfos = [];
    this.textContent = this.textScrollView.getComponent(cc.ScrollView).content;
    // this.imageContent = this.imageScrollView.getComponent(cc.ScrollView).content;

    var self = this;

    var textData = AudioManager.instance.chatTexts();
    for (var i = 0; i < textData.length; i++) {
      var item = cc.instantiate(this.textPrefab);
      item.getComponent('cellText').setText(textData[i]);
      item.getComponent('cellText').onSelectAction = function (text) {
        self.onTextClickAction(text);
      };
      this.textContent.h = 1000;
      this.textContent.addChild(item);
    }
  },

  onTextClickAction: function onTextClickAction() {
    var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    this.editBox.string = "";
    this.sendText(text);
  },

  clickEmoji: function clickEmoji(event, emojiName) {
    var string = this.editBox.string;
    this.editBox.string = string + "<" + emojiName + ">";
  },

  clickSend: function clickSend() {
    var string = this.editBox.string || "";
    if (string.length == 0) {
      return;
    }

    this.editBox.string = "";
    this.sendText(string);
  },

  sendText: function sendText() {
    var text = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    if (text.length == 0) {
      return;
    }

    Socket.sendText(this._userId, text);
    this.dismiss();
  },

  dismiss: function dismiss() {
    this.node.active = false;
  },

  bqAction: function bqAction() {
    this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode1.active = true;
    this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode.active = false;
    this.textScrollView.active = false;
    this.imageContentNode.active = true;
    this.textRecordScrollView.node.active = false;
  },

  textAction: function textAction() {
    this.bqNode1.active = this.btnLanguageNode.active = this.btnChartNode.active = false;
    this.bqNode.active = this.btnLanguageNode1.active = this.btnChartNode1.active = true;
    this.textScrollView.active = true;
    this.imageContentNode.active = false;
    this.textRecordScrollView.node.active = false;
  },

  chartAction: function chartAction() {
    this.bqNode1.active = this.btnLanguageNode1.active = this.btnChartNode1.active = false;
    this.bqNode.active = this.btnLanguageNode.active = this.btnChartNode.active = true;
    this.textScrollView.active = this.imageContentNode.active = false;
    this.textRecordScrollView.node.active = true;
  },

  addPlayerInfos: function addPlayerInfos(playerInfos) {
    this._playerInfos = this._playerInfos || [];

    playerInfos.forEach((function (userInfo) {
      var haveUserInfo = this._playerInfos.find(function (ownUserInfo) {
        return ownUserInfo.id == userInfo.id;
      });

      if (haveUserInfo == null) {
        this._playerInfos.push(userInfo);
      }
    }).bind(this));
  },

  addChatTextMessage: function addChatTextMessage(userId, text) {
    this._playerInfos = this._playerInfos || [];

    var nickname = "[ID:" + userId + "说]：";
    var userInfo = this._playerInfos.find(function (userInfo) {
      return userInfo.id == userId;
    });

    if (userInfo) {
      nickname = "[" + userInfo.nickname + "说]：";
    }

    var str = nickname + text;
    str = ChatMessage.parseString(str);
    this._addChatTextToRecord(str);
  },

  _addChatTextToRecord: function _addChatTextToRecord(text) {
    var item = cc.instantiate(this.chatTextRecordPrefab);
    var chatTextRecord = item.getComponent('ChatTextRecord');
    chatTextRecord.setString(text);

    this.textRecordLayout.node.addChild(item);
    this.textRecordScrollView.scrollToBottom();
  }
});

cc._RFpop();
},{"AudioManager":"AudioManager","ChatMessage":"ChatMessage","socket":"socket"}],"NetworkError":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'c99d35Sy6hDPbrte9nVczxP', 'NetworkError');
// scripts\NetworkError.js

var manager = require('manager');
var KQNativeInvoke = require('KQNativeInvoke');

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    exitAction: function exitAction() {
        cc.director.end();
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"NumberExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '80e21gZRpNM4pIiCpZ+7s8m', 'NumberExtension');
// scripts\Extensions\NumberExtension.js

// number.kq_times(f)   调用多次

if (!Number.prototype.kq_times) {

    /**
     * 调用一个方法 this 次
     * 
     * @param  {Function} f 要调用的方法
     * @param  {Object}   thisArg   可选； f 的 this值
     */
    Number.prototype.kq_times = function (f, thisArg) {
        if (!f) {
            return;
        }

        for (var i = 0; i < this; ++i) {
            if (thisArg) {
                f.apply(thisArg, i);
            } else {
                f(i);
            }
        }
    };
}

cc._RFpop();
},{}],"Playback":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0d3095dnBVFo5D1hEDDa5KQ', 'Playback');
// scripts\Playback\Playback.js

var Socket = require('socket');

// 用于回放的组件
var Playback = cc.Class({
  "extends": cc.Component,

  properties: {
    _playbackDatas: null, // 用于回放的数据
    _isPlaybacking: false
  },

  statics: {
    instance: null
  },

  onLoad: function onLoad() {
    Playback.instance = this;
    cc.game.addPersistRootNode(this.node);
  },

  // 设置回放数据
  setPlaybackDatas: function setPlaybackDatas(datas) {
    this._playbackDatas = datas;
  },

  // 清空回放数据。同时会清空回放
  removePlaybackDatas: function removePlaybackDatas() {
    this.setPlaybackDatas(null);
    this.stopPlayback();
  },

  // 是否包含回放数据
  isContainPlaybackDatas: function isContainPlaybackDatas() {
    return this._playbackDatas != null;
  },

  // 开始回放
  startPlayback: function startPlayback() {
    // 模拟 socket 接收到了事件即可
    cc.log("Playback 开始回放");

    this._isPlaybacking = true;

    if (!this._playbackDatas) {
      cc.error("想回放，却没有回放数据");
      this.stopPlayback();
      return;
    }

    this._executePlayback();
  },

  // 停止回放
  stopPlayback: function stopPlayback() {
    this._isPlaybacking = false;
    this.unscheduleAllCallbacks();
  },

  // 是否正在回放
  isPlaybacking: function isPlaybacking() {
    return this._isPlaybacking;
  },

  // 执行真正的回放操作
  _executePlayback: function _executePlayback() {
    var startTime = 1.0;
    var interval = 3.0;
    cc.log(this._playbackDatas);

    // 在某些特殊情况下
    // 回放数据里会包含两套 gameOver action
    // 所以需要过滤掉其中一个
    this._playbackDatas = this._playbackDatas.filter((function (string, index) {
      if (index == this._playbackDatas.length - 1) {
        return true;
      }

      return string.indexOf('"action":"gameOver') == -1;
    }).bind(this));

    this._playbackDatas.forEach((function (data, index) {
      var delay = startTime + index * interval;
      if (index == this._playbackDatas.length - 1) {
        // 如果是最后一个，则应该只间隔一秒
        delay = startTime + (index - 1) * interval + 1;
      }

      this.scheduleOnce(function () {
        cc.log("回放开始模拟 Socket 接收到服务器消息, ", index);
        Socket.instance._dispatchResponse(data);
      }, delay);
    }).bind(this));
  }

});

module.exports = Playback;

cc._RFpop();
},{"socket":"socket"}],"Player":[function(require,module,exports){
"use strict";
cc._RFpush(module, '6ffa0O02PFOp78QADTW5zGf', 'Player');
// scripts\Play\Player.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
cc.Class({
  'extends': cc.Component,

  properties: {
    foldCardNode: cc.Node, // 牌盖着时的样子
    foldCardNode1: cc.Node, // 牌盖着时的样子
    cardsBackLayout: cc.Layout, // 13张牌背影，可用来展示发牌动画 含 cardsBack Component
    compareCardsNode: cc.Node, // compareCards   含 CompareCards Component
    userInfoNode: cc.Node, // 包含用户信息 含 userInfo Component
    chatMessageNode: cc.Node, // 聊天消息 包含 ChatMessage Component
    userAvatarNode: cc.Node,
    userSampleInfoNode: cc.Node,
    userId: 0,
    /*#####*/
    teShuPaiLabel: cc.Node,
    cardTypePrefab: cc.Prefab,
    // 用户信息
    // 1、 如果 包含：cardInfo:[]，表明用户已经出牌
    //
    _userInfo: null,
    _deskInfo: null,
    /**/
    playedCompareCardsIndexs: {
      visible: false,
      'default': undefined
    }
    /**/
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.userAvatarNode.on(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
    this.reset();
  },

  onDestroy: function onDestroy() {
    this.userAvatarNode.off(cc.Node.EventType.TOUCH_START, this._showUserInfo, this);
  },

  _showUserInfo: function _showUserInfo() {
    this.userSampleInfoNode.getComponent('UserSampleInfo').updateWithUser(this._userInfo);
  },

  reset: function reset() {
    this.foldCardNode.active = false;
    this.foldCardNode1.active = false;
    this.teShuPaiLabel.active = false;
    this.cardsBackLayout.active = false;
    this.compareCardsNode.active = false;
    this.compareCardsNode.getComponent('CompareCards').reset();
  },

  /*####*/
  reset2: function reset2() {
    this.foldCardNode.active = false;
    this.foldCardNode1.active = false;
    this.teShuPaiLabel.active = false;
    this.cardsBackLayout.active = false;
    //this.compareCardsNode.active = false;
    //this.compareCardsNode.getComponent('CompareCards').reset();
  },
  /*#####*/

  updateUserInfoWithUsers: function updateUserInfoWithUsers(users) {
    var user = users.find((function (e) {
      return this.userId == e.id;
    }).bind(this));

    this.updateUserInfo(user);
  },

  updateUserInfo: function updateUserInfo(user) {
    this._userInfo = user;
    this.node.active = user != null;
    this.userInfoNode.active = this.node.active;
    if (!user) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.updateAvatar(user.avatarUrl);
    userInfo.updateNickname(user.nickname);
    userInfo.setOfflineVisible(!user.onlineStatus);

    //if (this._deskInfo && this._deskInfo.cIndex > 0) {
    //  if (UserModelHelper.isPlayedCards(user)) {
    //    this.playCard(user.id);
    //    this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
    //  }
    //}
    /**/
    var cIndex = this._deskInfo.cIndex;
    if (this._deskInfo && cIndex > 0 && this.playedCompareCardsIndexs.indexOf(cIndex) == -1) {
      if (UserModelHelper.isPlayedCards(user)) {
        this.playCard(user.id, user.cardInfo);
        this.compareCardsNode.getComponent('CompareCards').setCompareData(user);
      }
    }
    /**/
  },

  // 更新房主信息
  updateBanker: function updateBanker() {
    var userInfoComp = this.userInfoNode.getComponent('userInfo');
    if (!this._userInfo) {
      userInfoComp.setIsBanker(false);
      return;
    }

    var isBanker = this._userInfo ? this._userInfo.isBanker : false;
    userInfoComp.setIsBanker(isBanker);
  },

  showFangZhuStatus: function showFangZhuStatus(createId) {
    var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

    if (!this.node.active) {
      return;
    }
    if (this._userInfo.id == createId) {
      this.userInfoNode.getComponent('userInfo').setFangZhuNodeVisible(visible);
    }
  },

  /**
   * 更新分数 
   * 
   * @param {Number} score 用户分数、可选
   */
  updateScore: function updateScore(score) {
    if (!score && this._userInfo) {
      score = this._userInfo.totalScore;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.updateScore(score);
  },

  showReadyStatus: function showReadyStatus(userId) {
    var visible = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

    if (!this.node.active) {
      return;
    }

    if (this._userInfo.id == userId) {
      this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(visible);
    }
  },

  /*setDeskInfo: function (deskInfo) {
   this._deskInfo = deskInfo;
   },*/
  updateDeskInfo: function updateDeskInfo(deskInfo) {
    this._deskInfo = deskInfo;

    if (deskInfo && !deskInfo.isCBegin) {
      this.reset();
    }
  },
  /**/

  hideReadyStatus: function hideReadyStatus() {
    this.userInfoNode.getComponent('userInfo').setReadyNodeVisible(false);
  },

  playFaPaiAnimation: function playFaPaiAnimation() {
    cc.log("playFaPaiAnimation");
    if (!this.node.active) {
      return;
    }

    if (UserModelHelper.isPlayedCards(this._userInfo)) {
      return;
    }

    var cardsBack = this.cardsBackLayout.getComponent('cardsBack');
    cardsBack.showPlayCardBacks();
  },

  shouldShowFaPaiAnimation: function shouldShowFaPaiAnimation() {
    return UserModelHelper.isPlayedCards(this._userInfo);
  },

  setUserOnlineStatus: function setUserOnlineStatus(userId) {
    var status = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];

    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.setOfflineVisible(status != 1);
  },

  showChatText: function showChatText(userId, message) {
    if (userId != this.userId) {
      return;
    }

    var chatMessage = this.chatMessageNode.getComponent('ChatMessage');
    chatMessage.setString(message);
  },

  // 用户已经出牌，处于三堆盖着牌的状态
  playCard: function playCard(userId, cardInfo) {
    if (this.userId != userId) {
      return;
    }

    this.cardsBackLayout.node.active = false;
    this.compareCardsNode.active = false;
    this.teShuPaiLabel.active = false;
    /*#####如果是特殊牌就显示特殊牌型这四个字在盖着牌的上面*/
    var play = cc.find("Canvas").getComponent("play"); //play组件
    //如果点击了恭喜你页面的确定按钮
    //if(this.compareCardsNode.getComponent("CardTypeCombine").BtnClickGongXiNiComfirm){
    if (cc.moshi != 1) {
      if (play.getIsTeShuPai(this.userId)) {
        this.teShuPaiLabel.active = true;
      } else {
        this.teShuPaiLabel.active = false;
      }
    }
    cc.log(this);
    cc.log('------229');
    if (Playback.instance.isPlaybacking()) {
      //"回放";
      this.foldCardNode1.active = true;
      return;
    }
    this.foldCardNode.active = true;
    this.foldCardNode1.active = true;
    if (this.foldCardNode.name != "foldCardNodeSelf") {
      return;
    }
    for (var i = 0; i < 3; i++) {
      var node = this.foldCardNode.children[i];

      node.removeAllChildren();
      var cardModes = [];
      for (var j = 0; j < cardInfo[i].cards.length; j++) {
        var s = cardInfo[i].cards[j];
        cardModes.push(s);
      }
      cardModes = cardModes.map(function (serCard) {
        return serCard.suit + '_' + serCard.number;
      });
      cardModes.forEach((function (cardName) {
        var cardTypeSprite = cc.instantiate(this.cardTypePrefab);
        if (cc.maPai) {
          var cardMaPai = '3_' + cc.maPai;
          if (cardName == cardMaPai) {
            cardTypeSprite.color = new cc.Color(226, 145, 145);
          }
        }
        if (i == 0) {
          cardTypeSprite.y = 0;
        } else if (i == 1) {
          cardTypeSprite.y = 0;
        } else if (i == 2) {
          cardTypeSprite.y = 9;
        }
        cardTypeSprite.width = 66;
        cardTypeSprite.height = 92;
        cardTypeSprite.getComponent('CardTypeSprite').setCard(cardName);
        node.addChild(cardTypeSprite);
      }).bind(this));
      cc.log(node);
      cc.log(this.foldCardNode);
      cc.log(this.foldCardNode1);
      cc.log('-------239');
    }
    //}
  },

  // 准备好开始比牌
  readyToCompareCards: function readyToCompareCards() {
    this.cardsBackLayout.node.active = false;
    this.compareCardsNode.active = true;
    this.foldCardNode.active = false;
    this.foldCardNode1.active = false;
    this.teShuPaiLabel.active = false;
  },

  // 播放打枪动画
  // @param userId   要主动打枪的用户id
  // @param toUserIndex  挨枪的用户的 index
  playShootAnimation: function playShootAnimation(userId, toUserIndex) {
    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.playShootAnimation(toUserIndex);
  },

  // 播放中枪动画
  playBulletHoleAnimation: function playBulletHoleAnimation(userId) {
    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.playBulletHoleAnimation();
  },

  // 播放全垒打动画
  playHomeRunAimation: function playHomeRunAimation(userId) {
    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.playHomeRunAimation();
  },

  playSpeakAnimation: function playSpeakAnimation(userId) {
    if (userId != this.userId) {
      return;
    }

    var userInfo = this.userInfoNode.getComponent('userInfo');
    userInfo.playSpeakAnimation();
  },

  nextCompareScore: function nextCompareScore() {
    if (!this.node.active) {
      return 0;
    }

    var score = this.compareCardsNode.getComponent('CompareCards').nextCompareScore();
    return score;
  },

  showNextCompareCards: function showNextCompareCards() {
    if (this.nextCompareScore() <= 0) {
      return;
    }

    this.compareCardsNode.getComponent('CompareCards').showNextCards();
  }
});

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","KQGlobalEvent":"KQGlobalEvent","Playback":"Playback","UserModelHelper":"UserModelHelper","socket":"socket"}],"ResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9b2behcoUlLYL1MIMs+04wI', 'ResultItem');
// scripts\Play\ResultItem.js

var KQCardResHelper = require('KQCardResHelper');
var SpriteHelper = require('SpriteHelper');
var KQCard = require('KQCard');

cc.Class({
  'extends': cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelNickname: cc.Label,
    labelResultNumber: cc.Label,
    layoutTouDao: cc.Layout,
    layoutZhongDao: cc.Layout,
    layoutWeiDao: cc.Layout,
    layoutTeShu: cc.Layout,

    labelTeShuPaiTitle: cc.Label,

    scoreUnitNode: cc.Node, // 积分
    diamondUnitNode: cc.Node },

  // 钻石
  onLoad: function onLoad() {},

  //{"id":100049,"nickname":"imya","openId":"xx","avatarUrl":"xx","sex":1,
  // "cardNumber":3,"onlineStatus":1,"inviteCode":"","ipAddress":"::ffff:222.244.65.201",
  // "lastLoginTime":"2017-04-13 22:09:01","createAt":"2017-04-11 22:39:30",
  // "updateAt":"2017-04-13 22:09:01",
  // "cards":[],"roomId":"598883","readyStatus":true,"totalScore":0,
  // "cScore":0,"isBanker":false}
  updateWithPlayerInfo: function updateWithPlayerInfo(playerInfo) {
    var isRandomRoom = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];

    SpriteHelper.setImageUrl(this.avatarSprite, playerInfo.avatarUrl);
    this.labelNickname.string = playerInfo.nickname;
    //cc.log(this.labelResultNumber.string)
    //cc.log(playerInfo)
    //cc.log(playerInfo.cScore)
    //cc.log('---36')
    this.labelResultNumber.string = playerInfo.cScore;

    this.scoreUnitNode.active = !isRandomRoom;
    this.diamondUnitNode.active = isRandomRoom;
    var Number = playerInfo.cScore;
    if (isRandomRoom) {
      // 如果是随机场的话，则显示钻石数量
      Number = playerInfo.cScore * 5;
    }
    this.labelResultNumber.string = Number;
  },

  setCards: function setCards(cards) {
    cc.assert(cards.length == 13);

    // 不会再有特殊牌了
    /*if (KQCard.isTeShuPai(cards)) {
      this.setTeShuCards(cards);
      return;
      }
    */

    //let touCards = cards.slice(0, 3);
    //let zhongCards = cards.slice(3, 3 + 5);
    //let weiCards = cards.slice(8);
    //this.setTouCards(touCards);
    //this.setZhongCards(zhongCards);
    //this.setWeiCards(weiCards);
  }

});
/*setTouCards: function (cards) {
  this._setCardsToLayout(this.layoutTouDao, cards);
},
 setZhongCards: function (cards) {
  this._setCardsToLayout(this.layoutZhongDao, cards);
},
  setWeiCards: function (cards) {
  this._setCardsToLayout(this.layoutWeiDao, cards);
},*/

//结算  将特殊牌放入Layout
/*setTeShuCards: function (cards) {
  this.layoutTeShu.node.active = true;
  this.layoutTouDao.node.active = false;
  this.layoutZhongDao.node.active = false;
  this.layoutWeiDao.node.active = false;
  this._setCardsToLayout(this.layoutTeShu, cards);
   let typeName = KQCard.cardsTypeName(cards);
  this.labelTeShuPaiTitle.string = typeName;
},*/

//结算将牌放到Layout里面
/*_setCardsToLayout: function (layout, cards) {
  let node = layout.node;
  node.children.forEach(function (spriteNode, index) {
    let sprite = spriteNode.getComponent('cc.Sprite');
    let card = cards[index];
    if (!card) {
      return;
    }
     KQCardResHelper.setCardSpriteFrame(sprite, card.cardName());
  });
},*/

cc._RFpop();
},{"KQCard":"KQCard","KQCardResHelper":"KQCardResHelper","SpriteHelper":"SpriteHelper"}],"Setting":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3ad6mNk4BMBZzipGQDNlr4', 'Setting');
// scripts\Setting\Setting.js

var Manager = require('manager');

cc.Class({
  'extends': cc.Component,

  properties: {
    musicSlider: cc.Node,
    effectSlider: cc.Node,
    btnSwitchAccount: cc.Button,

    _audioManager: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this._audioManager = cc.find('AudioManager') || {};
    this._audioManager = this._audioManager.getComponent('AudioManager');

    this._initSliders();
  },

  _initSliders: function _initSliders() {
    this._initSliderEvents();

    var musicVal = Manager.getMusicValue();
    var effectVal = Manager.getMusicEffectValue();

    this._audioManager.setBgMusicVolumn(musicVal);
    this._audioManager.setEffectMusicVolum(effectVal);

    this.musicSlider.getComponent('slider').setValue(musicVal);
    this.effectSlider.getComponent('slider').setValue(effectVal);
  },

  _initSliderEvents: function _initSliderEvents() {
    var self = this;
    this.musicSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicValue(value);
      self._audioManager.setBgMusicVolumn(value);
    };

    this.effectSlider.getComponent('slider').onValueChange = function (value) {
      Manager.setMusicEffectValue(value);
      self._audioManager.setEffectMusicVolum(value);
    };
  },

  clickSwitch: function clickSwitch() {},

  hideSwitch: function hideSwitch() {
    if (this.btnSwitchAccount) {
      this.btnSwitchAccount.node.active = false;
    }
  }
});

cc._RFpop();
},{"manager":"manager"}],"SpriteHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '936f2uPA8NAuqUZv0R8ZxgP', 'SpriteHelper');
// scripts\Extensions\SpriteHelper.js

var SpriteHelper = {
  setImageUrl: function setImageUrl(sprite, url) {
    if (url.endsWith("png") || url.endsWith("jpg") || url.endsWith("gif")) {} else {
      url = url + ".png";
    }

    cc.loader.load(url, function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      sprite.spriteFrame = frame;
    });
  }
};

module.exports = SpriteHelper;

cc._RFpop();
},{}],"StringExtension":[function(require,module,exports){
"use strict";
cc._RFpush(module, '7b106eQ/I5F1J85hMxFBIlw', 'StringExtension');
// scripts\Extensions\StringExtension.js

// 给 String 添加功能

// str.startsWith("");
// str.endsWith("");

if (!String.prototype.startsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var startsWith = function startsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var position = arguments.length > 1 ? arguments[1] : undefined;
			// `ToInteger`
			var pos = position ? Number(position) : 0;
			if (pos != pos) {
				// better `isNaN`
				pos = 0;
			}
			var start = Math.min(Math.max(pos, 0), stringLength);
			// Avoid the `indexOf` call if no match is possible
			if (searchLength + start > stringLength) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'startsWith', {
				'value': startsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.startsWith = startsWith;
		}
	})();
}

// str.endsWith("");
if (!String.prototype.endsWith) {
	(function () {
		'use strict'; // needed to support `apply`/`call` with `undefined`/`null`
		var defineProperty = (function () {
			// IE 8 only supports `Object.defineProperty` on DOM elements
			try {
				var object = {};
				var $defineProperty = Object.defineProperty;
				var result = $defineProperty(object, object, object) && $defineProperty;
			} catch (error) {}
			return result;
		})();
		var toString = ({}).toString;
		var endsWith = function endsWith(search) {
			if (this == null) {
				throw TypeError();
			}
			var string = String(this);
			if (search && toString.call(search) == '[object RegExp]') {
				throw TypeError();
			}
			var stringLength = string.length;
			var searchString = String(search);
			var searchLength = searchString.length;
			var pos = stringLength;
			if (arguments.length > 1) {
				var position = arguments[1];
				if (position !== undefined) {
					// `ToInteger`
					pos = position ? Number(position) : 0;
					if (pos != pos) {
						// better `isNaN`
						pos = 0;
					}
				}
			}
			var end = Math.min(Math.max(pos, 0), stringLength);
			var start = end - searchLength;
			if (start < 0) {
				return false;
			}
			var index = -1;
			while (++index < searchLength) {
				if (string.charCodeAt(start + index) != searchString.charCodeAt(index)) {
					return false;
				}
			}
			return true;
		};
		if (defineProperty) {
			defineProperty(String.prototype, 'endsWith', {
				'value': endsWith,
				'configurable': true,
				'writable': true
			});
		} else {
			String.prototype.endsWith = endsWith;
		}
	})();
}

cc._RFpop();
},{}],"TotalGameResultItem":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1c6f93a1BOnoSiX6kJ0Efn', 'TotalGameResultItem');
// scripts\Play\TotalGameResultItem.js

var SpriteHelper = require('SpriteHelper');
cc.Class({
  "extends": cc.Component,

  properties: {
    avatarSprite: cc.Sprite,
    labelUserId: cc.Label,
    labelScore: cc.Label,
    labelNickname: cc.Label,

    _deskInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setUserInfo: function setUserInfo(user, deskInfo) {
    if (!user) {
      return;
    }

    var totalScore = user.totalScore;
    if (deskInfo && (deskInfo.setting1 == 0 || deskInfo.setting1 == 1)) {
      var baseScore = deskInfo.setting1 == 0 ? 100 : 200;
      totalScore = totalScore - baseScore;
    }

    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);
    this.labelUserId.string = "" + user.id;
    this.labelScore.string = totalScore > 0 ? "+ " + totalScore : "- " + totalScore * -1;
    if (totalScore == 0) {
      this.labelScore.string = "0";
    }
    this.labelNickname.string = user.nickname;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"TotalGameResult":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f7fb2e7foJFNJzjdtbAtk7O', 'TotalGameResult');
// scripts\Play\TotalGameResult.js

var KQNativeInvoke = require('KQNativeInvoke');
cc.Class({
    'extends': cc.Component,

    properties: {
        itemLayout: cc.Layout,
        itemPrefab: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setPlayerInfos: function setPlayerInfos(playerInfos, deskInfo) {
        this.itemLayout.node.removeAllChildren();
        playerInfos.forEach((function (user) {
            var item = cc.instantiate(this.itemPrefab);
            item.getComponent('TotalGameResultItem').setUserInfo(user, deskInfo);
            if (deskInfo.createId == user.id) {
                item.children[6].active = true;
            } else {
                item.children[6].active = false;
            }
            this.itemLayout.node.addChild(item);
        }).bind(this));
    },

    clickShareWeiChat: function clickShareWeiChat() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShareFriend");
        } else {
            //Android
            KQNativeInvoke.screenshotShare();
        }
    },

    clickSharePengYouQuan: function clickSharePengYouQuan() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxScreenShare", "()V");
        }
    }
});

cc._RFpop();
},{"KQNativeInvoke":"KQNativeInvoke"}],"UserModelHelper":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98854aScapF5oQnHKxJsvmF', 'UserModelHelper');
// scripts\ModelUtils\UserModelHelper.js

var UserModelHelper = {
  // 用户是否已出牌
  isPlayedCards: function isPlayedCards(user) {
    cc.assert(user);

    if (user && user.cardInfo && user.cardInfo.length > 0) {
      return true;
    }

    return false;
  },

  // 用户是否已准备
  isUserReady: function isUserReady(user) {
    return user.readyStatus == true;
  }
};

module.exports = UserModelHelper;

cc._RFpop();
},{}],"UserSampleInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, '3a9f7A0IgRGPrAZvy1p9s4i', 'UserSampleInfo');
// scripts\Play\UserSampleInfo.js

var SpriteHelper = require('SpriteHelper');

cc.Class({
  'extends': cc.Component,

  properties: {
    labelUserId: cc.Label,
    labelUserIP: cc.Label,
    labelNickname: cc.Label,
    avatarSprite: cc.Sprite,
    manSprite: cc.Sprite,
    womenSprite: cc.Sprite,

    _didShowUserInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  updateWithUser: function updateWithUser(user) {
    if (!user) {
      return;
    }

    if (this._didShowUserInfo == user) {
      this.unscheduleAllCallbacks();
      this._disappearUserInfo();
      return;
    }

    this._didShowUserInfo = user;
    if (!this.node.active) {
      this.node.getComponent('alert').alert();
    }

    this.unscheduleAllCallbacks();
    this.scheduleOnce((function () {
      this._disappearUserInfo();
    }).bind(this), 5);

    this.labelUserId.string = "UID:\n" + user.id;
    this.labelUserIP.string = "用户IP:\n" + user.ipAddress.replace("::ffff:", "");
    this.labelNickname.string = user.nickname;
    this.avatarSprite.spriteFrame = null;
    SpriteHelper.setImageUrl(this.avatarSprite, user.avatarUrl);

    var sex = user.sex; // sex: 1 男  2 女
    this.manSprite.node.active = sex == 1;
    this.womenSprite.node.active = sex != 1;
  },

  _disappearUserInfo: function _disappearUserInfo() {
    this.node.active = false;
    this._didShowUserInfo = null;
  }
});

cc._RFpop();
},{"SpriteHelper":"SpriteHelper"}],"agreement":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8f601dzNnZLtq+KGT0uqDqF', 'agreement');
// scripts\agreement.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');
cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        agreement: {
            'default': null,
            type: cc.Label
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        cc.log('----61');
        cc.log(this.agreement);
    },
    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (!response.result) {
            return;
        }
        var s = cc.find('Canvas/agreement');
        var data = response.data;
        //this._info1 = response.data;
        cc.log(this.agreement);
        cc.log(s);
        cc.log('----61');
        this.agreement.string = data.info1 || "";
    }
});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"alert":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16cd2qs73lByZaHhJkQAEee', 'alert');
// scripts\alert.js

var AudioManager = require('AudioManager');
cc.Class({
  'extends': cc.Component,

  properties: {
    // foo: {
    //    default: null,      // The default value will be used only when the component attaching
    //                           to a node for the first time
    //    url: cc.Texture2D,  // optional, default is typeof default
    //    serializable: true, // optional, default is true
    //    visible: true,      // optional, default is true
    //    displayName: 'Foo', // optional
    //    readonly: false,    // optional, default is false
    // },
    // ...
    popNode: cc.Node,
    label: cc.Label,

    _alertCallback: null,
    _willDismissCallback: null,
    _dismissCallback: null,
    _confirmCallback: null, // 点击确定后的回调
    _tishi: null,
    _card_num: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  alert: function alert() {
    this.node.active = true;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },
  /*#####弹出结果*/
  alertResult: function alertResult() {
    this.node.active = true;
    cc.find("Canvas/show_result").active = false;
    var anim = this.popNode.getComponent(cc.Animation);
    anim.play('pop');

    if (this._alertCallback) {
      this._alertCallback(this.node);
    }
  },

  /*#####点击确定*/
  playBtnClickSFX: function playBtnClickSFX() {
    AudioManager.instance.playBtnClickSFX();
  },

  /*#####点击取消*/
  palyBtnCancelClickSFX: function palyBtnCancelClickSFX() {
    AudioManager.instance.palyBtnCancelClickSFX();
  },

  /*#####点击关闭或者按键之类的按钮，播放音效*/
  palyBtnPublicSFX: function palyBtnPublicSFX() {
    AudioManager.instance.palyBtnPublicSFX();
  },

  /*#####点击创建房间，播放音效*/
  palyBtnCreateRoomSFX: function palyBtnCreateRoomSFX() {
    AudioManager.instance.palyBtnCreateRoomSFX();
  },
  /*#####点击创建房间，播放音效*/
  palyWindowSFX: function palyWindowSFX() {
    AudioManager.instance.palyWindowSFX();
  },

  palyWeiXinLoginSFX: function palyWeiXinLoginSFX() {
    AudioManager.instance.palyWeiXinLoginSFX();
  },
  palyFangPaiSFX: function palyFangPaiSFX() {
    AudioManager.instance.palyFangPaiSFX();
  },

  dismissAction: function dismissAction() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
  },

  /*#####隐藏结果页面*/
  dismissActionResult: function dismissActionResult() {
    var willDismissCallback = this._willDismissCallback;
    if (willDismissCallback) {
      var result = willDismissCallback();
      if (result) {
        this.dismissComplete();
        return;
      }
    }

    var anim = this.popNode.getComponent(cc.Animation);
    var dismissAnim = anim.getAnimationState('pop_dismiss');
    dismissAnim.on('finished', this.dismissComplete, this);
    anim.play('pop_dismiss');
    cc.find("Canvas/show_result").active = true;
  },

  dismissComplete: function dismissComplete() {
    this.node.active = false;

    if (this.onDismissComplete) {
      this.onDismissComplete();
    }

    if (this._dismissCallback) {
      this._dismissCallback(this.node);
    }
  },
  dismissPlay: function dismissPlay() {
    cc.director.loadScene("hall");
  },

  onDismissComplete: function onDismissComplete() {
    cc.log("onDismissComplete");
  },

  doneAction: function doneAction() {
    this.dismissAction();
    this.onDoneAction();

    var confirmCallback = this._confirmCallback;
    if (confirmCallback) {
      confirmCallback(this.node);
    }
  },

  onDoneAction: function onDoneAction() {},

  setMessage: function setMessage(msg) {
    this.label.string = msg;
  },

  getMessage: function getMessage() {
    return this.label.string;
  },

  setAlertCallbck: function setAlertCallbck(callback) {
    this._alertCallback = callback;
  },

  setWillDismissCallback: function setWillDismissCallback(callback) {
    this._willDismissCallback = callback;
  },

  setDismissCallback: function setDismissCallback(callback) {
    this._dismissCallback = callback;
  },

  setConfirmCallback: function setConfirmCallback(callback) {
    this._confirmCallback = callback;
  }

});
/*setMessage: function (message) {
  this.label.getComponent('cc.Label').string = message;
},*/

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"AudioManager":"AudioManager"}],"cardsBack":[function(require,module,exports){
"use strict";
cc._RFpush(module, '98986IsXIdHiqLGEVIG2CWP', 'cardsBack');
// scripts\cardsBack.js

// 牌背影列表 component
// 可以显示、隐藏牌背影列表
cc.Class({
  "extends": cc.Component,

  properties: {
    cardsBackLayout: cc.Layout,
    cardsBackList: [cc.Sprite]
  },

  // use this for initialization
  onLoad: function onLoad() {},

  // 以动画的方式显示牌背影
  showPlayCardBacks: function showPlayCardBacks() {
    cc.log("显示牌背影");
    this.hideCardBacks();
    this.cardsBackLayout.node.active = true;

    var interval = 0.05;
    var startTime = 0;
    this.cardsBackList.forEach((function (cardBack) {
      this.scheduleOnce(function () {
        cardBack.node.active = true;
      }, startTime);
      startTime = startTime + interval;
    }).bind(this));
  },

  // 隐藏显示牌背影
  hideCardBacks: function hideCardBacks() {
    this.cardsBackLayout.node.active = false;
    this.cardsBackList.forEach(function (cardBack) {
      cardBack.node.active = false;
    });
  }
});

cc._RFpop();
},{}],"cards":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0fcbct/TBxC742saKLuFviQ', 'cards');
// scripts\cards.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        /*牌花色*/
        spadesImages: [cc.SpriteFrame],
        heartsImages: [cc.SpriteFrame],
        clubImages: [cc.SpriteFrame],
        diamondImages: [cc.SpriteFrame]
    },

    // use this for initialization
    onLoad: function onLoad() {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"cellText":[function(require,module,exports){
"use strict";
cc._RFpush(module, '9c9fd3OxWNEp4rijfjJv05t', 'cellText');
// scripts\cellText.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        labelMsg: cc.Label
    },

    // use this for initialization
    onLoad: function onLoad() {},

    setText: function setText(text) {
        this.labelMsg.getComponent(cc.Label).string = text;
    },

    clickAction: function clickAction() {
        var text = this.labelMsg.getComponent(cc.Label).string;
        this.onSelectAction(text);
    },

    onSelectAction: function onSelectAction(msg) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"checkSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '974a0c6jzZPRI5AeaAb4U0z', 'checkSelect');
// scripts\checkSelect.js

cc.Class({
    "extends": cc.Component,

    properties: {
        selectedIndex: 0,
        selectedNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selected = true;
        this.selectedIndex = 0;
        this.selectedNode.active = true;
    },
    clickAction: function clickAction(e, data) {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        this.selectedIndex = this.selected ? 0 : null;
    }

    // called every frame, uncomment this function to activate update callback
    // update: function (dt) {

    // },
});

cc._RFpop();
},{}],"choujiang":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f64e0whLhNLmbOHtPpK94CG', 'choujiang');
// scripts\choujiang.js

var socket = require("socket");
cc.Class({
    "extends": cc.Component,

    properties: {
        option: {
            "default": [],
            type: cc.Node
        }
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickBtnchoujiang: function clickBtnchoujiang() {
        for (var i = 0; i < this.option.length; i++) {
            this.option[i].opacity = 255;
        }
        var index = 0;
        this._tishi = this.node.getChildByName("choujiang_bg").getChildByName("tishi");
        this._card_num = cc.find("Canvas/user/shop_bg/card_num");
        var comp = this._card_num.getComponent(cc.Label);
        this.callback = function () {
            if (index == 0) {
                this.option[index].opacity = 128;
                this.option[this.option.length - 1].opacity = 255;
            } else if (index == 1) {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            } else {
                this.option[index].opacity = 128;
                this.option[index - 1].opacity = 255;
            }
            index++;
            if (index == this.option.length) {
                index = 0;
            }
        };
        if (comp.string < 20) {
            this._tishi.active = true;
        } else {
            //choujiang
            this.schedule(this.callback, 0.05);
            this.schedule(function () {
                this.unschedule(this.callback);
                for (var i = 0; i < this.option.length; i++) {
                    this.option[i].opacity = 255;
                }
                var i = Math.floor(Math.random() * 12);
                this.option[i].opacity = 128;
            }, 3, 0, 1);
        }
    },

    //***
    clickBtnComfirm: function clickBtnComfirm() {
        this._tishi.active = false;
        //this.node.active = false;
    }
});
//****

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{"socket":"socket"}],"fecha":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e517077l0xMarB9uQsXGzvk', 'fecha');
// scripts\Extensions\fecha.js

(function (main) {
  'use strict';

  /**
   * Parse or format dates
   * @class fecha
   */
  var fecha = {};
  var token = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g;
  var twoDigits = /\d\d?/;
  var threeDigits = /\d{3}/;
  var fourDigits = /\d{4}/;
  var word = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;
  var literal = /\[([^]*?)\]/gm;
  var noop = function noop() {};

  function shorten(arr, sLen) {
    var newArr = [];
    for (var i = 0, len = arr.length; i < len; i++) {
      newArr.push(arr[i].substr(0, sLen));
    }
    return newArr;
  }

  function monthUpdate(arrName) {
    return function (d, v, i18n) {
      var index = i18n[arrName].indexOf(v.charAt(0).toUpperCase() + v.substr(1).toLowerCase());
      if (~index) {
        d.month = index;
      }
    };
  }

  function pad(val, len) {
    val = String(val);
    len = len || 2;
    while (val.length < len) {
      val = '0' + val;
    }
    return val;
  }

  var dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
  var monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  var monthNamesShort = shorten(monthNames, 3);
  var dayNamesShort = shorten(dayNames, 3);
  fecha.i18n = {
    dayNamesShort: dayNamesShort,
    dayNames: dayNames,
    monthNamesShort: monthNamesShort,
    monthNames: monthNames,
    amPm: ['am', 'pm'],
    DoFn: function DoFn(D) {
      return D + ['th', 'st', 'nd', 'rd'][D % 10 > 3 ? 0 : (D - D % 10 !== 10) * D % 10];
    }
  };

  var formatFlags = {
    D: function D(dateObj) {
      return dateObj.getDate();
    },
    DD: function DD(dateObj) {
      return pad(dateObj.getDate());
    },
    Do: function Do(dateObj, i18n) {
      return i18n.DoFn(dateObj.getDate());
    },
    d: function d(dateObj) {
      return dateObj.getDay();
    },
    dd: function dd(dateObj) {
      return pad(dateObj.getDay());
    },
    ddd: function ddd(dateObj, i18n) {
      return i18n.dayNamesShort[dateObj.getDay()];
    },
    dddd: function dddd(dateObj, i18n) {
      return i18n.dayNames[dateObj.getDay()];
    },
    M: function M(dateObj) {
      return dateObj.getMonth() + 1;
    },
    MM: function MM(dateObj) {
      return pad(dateObj.getMonth() + 1);
    },
    MMM: function MMM(dateObj, i18n) {
      return i18n.monthNamesShort[dateObj.getMonth()];
    },
    MMMM: function MMMM(dateObj, i18n) {
      return i18n.monthNames[dateObj.getMonth()];
    },
    YY: function YY(dateObj) {
      return String(dateObj.getFullYear()).substr(2);
    },
    YYYY: function YYYY(dateObj) {
      return dateObj.getFullYear();
    },
    h: function h(dateObj) {
      return dateObj.getHours() % 12 || 12;
    },
    hh: function hh(dateObj) {
      return pad(dateObj.getHours() % 12 || 12);
    },
    H: function H(dateObj) {
      return dateObj.getHours();
    },
    HH: function HH(dateObj) {
      return pad(dateObj.getHours());
    },
    m: function m(dateObj) {
      return dateObj.getMinutes();
    },
    mm: function mm(dateObj) {
      return pad(dateObj.getMinutes());
    },
    s: function s(dateObj) {
      return dateObj.getSeconds();
    },
    ss: function ss(dateObj) {
      return pad(dateObj.getSeconds());
    },
    S: function S(dateObj) {
      return Math.round(dateObj.getMilliseconds() / 100);
    },
    SS: function SS(dateObj) {
      return pad(Math.round(dateObj.getMilliseconds() / 10), 2);
    },
    SSS: function SSS(dateObj) {
      return pad(dateObj.getMilliseconds(), 3);
    },
    a: function a(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0] : i18n.amPm[1];
    },
    A: function A(dateObj, i18n) {
      return dateObj.getHours() < 12 ? i18n.amPm[0].toUpperCase() : i18n.amPm[1].toUpperCase();
    },
    ZZ: function ZZ(dateObj) {
      var o = dateObj.getTimezoneOffset();
      return (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4);
    }
  };

  var parseFlags = {
    D: [twoDigits, function (d, v) {
      d.day = v;
    }],
    Do: [new RegExp(twoDigits.source + word.source), function (d, v) {
      d.day = parseInt(v, 10);
    }],
    M: [twoDigits, function (d, v) {
      d.month = v - 1;
    }],
    YY: [twoDigits, function (d, v) {
      var da = new Date(),
          cent = +('' + da.getFullYear()).substr(0, 2);
      d.year = '' + (v > 68 ? cent - 1 : cent) + v;
    }],
    h: [twoDigits, function (d, v) {
      d.hour = v;
    }],
    m: [twoDigits, function (d, v) {
      d.minute = v;
    }],
    s: [twoDigits, function (d, v) {
      d.second = v;
    }],
    YYYY: [fourDigits, function (d, v) {
      d.year = v;
    }],
    S: [/\d/, function (d, v) {
      d.millisecond = v * 100;
    }],
    SS: [/\d{2}/, function (d, v) {
      d.millisecond = v * 10;
    }],
    SSS: [threeDigits, function (d, v) {
      d.millisecond = v;
    }],
    d: [twoDigits, noop],
    ddd: [word, noop],
    MMM: [word, monthUpdate('monthNamesShort')],
    MMMM: [word, monthUpdate('monthNames')],
    a: [word, function (d, v, i18n) {
      var val = v.toLowerCase();
      if (val === i18n.amPm[0]) {
        d.isPm = false;
      } else if (val === i18n.amPm[1]) {
        d.isPm = true;
      }
    }],
    ZZ: [/([\+\-]\d\d:?\d\d|Z)/, function (d, v) {
      if (v === 'Z') v = '+00:00';
      var parts = (v + '').match(/([\+\-]|\d\d)/gi),
          minutes;

      if (parts) {
        minutes = +(parts[1] * 60) + parseInt(parts[2], 10);
        d.timezoneOffset = parts[0] === '+' ? minutes : -minutes;
      }
    }]
  };
  parseFlags.dd = parseFlags.d;
  parseFlags.dddd = parseFlags.ddd;
  parseFlags.DD = parseFlags.D;
  parseFlags.mm = parseFlags.m;
  parseFlags.hh = parseFlags.H = parseFlags.HH = parseFlags.h;
  parseFlags.MM = parseFlags.M;
  parseFlags.ss = parseFlags.s;
  parseFlags.A = parseFlags.a;

  // Some common format strings
  fecha.masks = {
    'default': 'ddd MMM DD YYYY HH:mm:ss',
    shortDate: 'M/D/YY',
    mediumDate: 'MMM D, YYYY',
    longDate: 'MMMM D, YYYY',
    fullDate: 'dddd, MMMM D, YYYY',
    shortTime: 'HH:mm',
    mediumTime: 'HH:mm:ss',
    longTime: 'HH:mm:ss.SSS'
  };

  /***
   * Format a date
   * @method format
   * @param {Date|number} dateObj
   * @param {string} mask Format of the date, i.e. 'mm-dd-yy' or 'shortDate'
   */
  fecha.format = function (dateObj, mask, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof dateObj === 'number') {
      dateObj = new Date(dateObj);
    }

    if (Object.prototype.toString.call(dateObj) !== '[object Date]' || isNaN(dateObj.getTime())) {
      throw new Error('Invalid Date in fecha.format');
    }

    mask = fecha.masks[mask] || mask || fecha.masks['default'];

    var literals = [];

    // Make literals inactive by replacing them with ??
    mask = mask.replace(literal, function ($0, $1) {
      literals.push($1);
      return '??';
    });
    // Apply formatting rules
    mask = mask.replace(token, function ($0) {
      return $0 in formatFlags ? formatFlags[$0](dateObj, i18n) : $0.slice(1, $0.length - 1);
    });
    // Inline literal values back into the formatted value
    return mask.replace(/\?\?/g, function () {
      return literals.shift();
    });
  };

  /**
   * Parse a date string into an object, changes - into /
   * @method parse
   * @param {string} dateStr Date string
   * @param {string} format Date parse format
   * @returns {Date|boolean}
   */
  fecha.parse = function (dateStr, format, i18nSettings) {
    var i18n = i18nSettings || fecha.i18n;

    if (typeof format !== 'string') {
      throw new Error('Invalid format in fecha.parse');
    }

    format = fecha.masks[format] || format;

    // Avoid regular expression denial of service, fail early for really long strings
    // https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS
    if (dateStr.length > 1000) {
      return false;
    }

    var isValid = true;
    var dateInfo = {};
    format.replace(token, function ($0) {
      if (parseFlags[$0]) {
        var info = parseFlags[$0];
        var index = dateStr.search(info[0]);
        if (! ~index) {
          isValid = false;
        } else {
          dateStr.replace(info[0], function (result) {
            info[1](dateInfo, result, i18n);
            dateStr = dateStr.substr(index + result.length);
            return result;
          });
        }
      }

      return parseFlags[$0] ? '' : $0.slice(1, $0.length - 1);
    });

    if (!isValid) {
      return false;
    }

    var today = new Date();
    if (dateInfo.isPm === true && dateInfo.hour != null && +dateInfo.hour !== 12) {
      dateInfo.hour = +dateInfo.hour + 12;
    } else if (dateInfo.isPm === false && +dateInfo.hour === 12) {
      dateInfo.hour = 0;
    }

    var date;
    if (dateInfo.timezoneOffset != null) {
      dateInfo.minute = +(dateInfo.minute || 0) - +dateInfo.timezoneOffset;
      date = new Date(Date.UTC(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0));
    } else {
      date = new Date(dateInfo.year || today.getFullYear(), dateInfo.month || 0, dateInfo.day || 1, dateInfo.hour || 0, dateInfo.minute || 0, dateInfo.second || 0, dateInfo.millisecond || 0);
    }
    return date;
  };

  /* istanbul ignore next */
  if (typeof module !== 'undefined' && module.exports) {
    module.exports = fecha;
  } else if (typeof define === 'function' && define.amd) {
    define(function () {
      return fecha;
    });
  } else {
    main.fecha = fecha;
  }
})(this);

cc._RFpop();
},{}],"game":[function(require,module,exports){
"use strict";
cc._RFpush(module, '45811N61jFFA6UrygQla5+x', 'game');
// scripts\game.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        messageNode: cc.Node,
        playNode: cc.Node

    },

    // use this for initialization
    onLoad: function onLoad() {},

    showMessageAlert: function showMessageAlert() {
        this.messageNode.active = true;
        var comp = this.messageNode.getComponent(cc.Animation);
        comp.play('pop');
    },

    dismissMessageAlert: function dismissMessageAlert() {
        var self = this;
        this.scheduleOnce(function () {
            self.messageNode.active = false;
        }, 0.3);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"hall":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1e6741Q2VFGDLupV88mg60Z', 'hall');
// scripts\hall.js

var manager = require('manager');
var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var Playback = require('Playback');

var hall = cc.Class({
    'extends': cc.Component,

    properties: {

        productNodes: [cc.Node],
        shopAlertNode: cc.Node,
        createNode: cc.Node,
        joinNode: cc.Node,
        invitNode: cc.Node,
        hasCode: cc.Node,
        gengxin: cc.Node,
        alertPrefab: cc.Prefab,
        tsSingleSelect: [cc.Node], //创建房间信息，单选
        tsCheckSeclect: [cc.Node], //创建房间信息，复选
        selectMoShi: cc.Node, //创建房间信息，模式（庄家模式和无特殊牌）
        selectGuiPai: cc.Node, //创建房间信息，模式（庄家模式和无特殊牌）
        labelNotice: cc.Label, // 公告
        labelBanner: cc.Label, // banner label
        shareAlertNode: cc.Node,
        shareAlertNode1: cc.Node,
        shareAlertNodeBg: cc.Node,
        shareAlertButton: cc.Button,
        recordNode: cc.Node,
        waitingPrefab: cc.Prefab,
        //用户信息
        avatarNode: cc.Node,
        nickNameLabel: cc.Label,
        cardNumberLabel: cc.Label,
        userIdLabel: cc.Label,
        codeLabel: cc.Label,
        // userInfoMsgNode:cc.Node,
        //退出
        exitNode: cc.Node,
        logoutNode: cc.Node,
        //战绩
        recordMsgNode: cc.Node,
        feedbackEditBox: cc.EditBox, //反馈
        feedbackNode: cc.Node,

        _userId: 0,
        _openId: null,
        _help: null,
        _close: null,
        iosUrl: null,
        aUrl: null

    },

    statics: {
        lastHallInfo: null, // 上一次收到的大厅信息
        cacheImageInfo: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        cc.from = {};
        cc.from.isUseMa = true;
        cc.from.ma = 0;
        cc.isRoomViewShow = false;
        this._btn = this.node.getChildByName("btn");
        this._buttons = this.node.getChildByName("buttons");
        AudioManager.instance.playMusic();
        Playback.instance.removePlaybackDatas();

        hall.cacheImageInfo = hall.cacheImageInfo || {};

        this._registerSocketEvent();
        this._startBannerAnimation();
        this._initJoinRoom();
        this._initInvit();

        this._userId = Socket.instance.userInfo.id;
        this._openId = Socket.instance.userInfo.openId;
        this._inviteCode = Socket.instance.userInfo.inviteCode; //邀请码
        //cc.log(this._inviteCode,"邀请码---------------------");
        if (this._inviteCode) {
            //邀请码处理
            this.codeLabel.string = "CODE：" + this._inviteCode;
            this.hasCode.active = true;
            this.invitNode.active = false;
        } else {
            this.hasCode.active = false;
            this.invitNode.active = true;
            this.codeLabel.string = '';
        }

        var self = this;

        for (var i = 0; i < this.productNodes.length; i++) {
            var comp = this.productNodes[i].getComponent('product');
            comp.onClickAction = function (productId) {};
        }
        this.socket = cc.find('GameSocket').getComponent('socket');
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
        };

        this.socket.connectionSuccess = function () {
            self.hiddenNetworkMessage();
            self.hiddenCheckMessage();
        };
        this.socket.connectionDisconnect = function () {
            self.showNetworkMessage('网络链接断开，重新连接中...');
        };
        this.socket.checkNetworkNow = function () {
            self.showCheckMessage('检查网络中...');
        };
        this.socket.checkNetworkEnd = function () {
            self.hiddenCheckMessage();
            self.hiddenNetworkMessage();
        };

        //  /*设置用户信息*/
        this.updateUserInfo();
        /*刷新用户信息*/
        Socket.sendGetUserInfo(this._userId, this._openId);
        /*定时刷新用户信息*/
        this.schedule((function () {
            Socket.sendGetUserInfo(this._userId, this._openId);
        }).bind(this), 10); //10s一次

        Socket.sendGetHallInfo(this.socket.userInfo.id);
        //hall.lastHallInfo = cc._loginInfo;
        if (hall.lastHallInfo) {
            this.updateBanner(hall.lastHallInfo.info);
            this.updateNotice(hall.lastHallInfo.broadcast);
            //this.labelBanner.string = hall.lastHallInfo.info;
            //this.labelNotice.string = hall.lastHallInfo.broadcast;
        }
        cc.onShareWXResp = this._shareResult.bind(this);
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
        this.socket.connectionSuccess = function () {};
        this.socket.connectionDisconnect = function () {};
        this.socket.checkNetworkNow = function () {};
        this.socket.checkNetworkEnd = function () {};

        KQGlobalEvent.offTarget(this);
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.JoinDesk, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._jiinRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveCreateDesk, this._createRoomSocketCallback, this);
        KQGlobalEvent.on(Socket.Event.ReceiveHallInfo, this._socketReceiveHallInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGetUserInfo, this._socketReceiveUserInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        KQGlobalEvent.on(Socket.Event.ReceiveInviteCode, this._socketReceiveInviteCode, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        KQGlobalEvent.on(Socket.Event.ReceiveSharePng, this._socketSharePng, this);
    },
    //接受邀请码数据
    _socketReceiveInviteCode: function _socketReceiveInviteCode(response) {
        var inviteCode = response.data;
        //cc.log(inviteCode,"------------ 邀请码 ------------");
        if (inviteCode) {
            //邀请码处理
            this._inviteCode = inviteCode;
            this.codeLabel.string = "CODE：" + inviteCode;
            this.hasCode.active = true;
            this.invitNode.active = false;
        } else {
            this.alertMessage("输入的邀请码不存在");
            this.hasCode.active = false;
            this.invitNode.active = true;
            this.codeLabel.string = '';
        }
    },

    _startBannerAnimation: function _startBannerAnimation() {
        var anim = this.labelBanner.getComponent(cc.Animation);
        anim.play('banner');
    },

    _initJoinRoom: function _initJoinRoom() {
        var self = this;
        var joinRoom = this.joinNode.getComponent('joinRoom');

        joinRoom.callbackJoinRoom = function (number) {
            self.joinNode.getComponent('alert').dismissAction();
            self.showWaitingMessage('加入中...');
            self.scheduleOnce(function () {
                self.hiddenWaitingMessage();
            }, 2.0);

            /*加入房间请求*/
            var userId = Socket.instance.userInfo.id;
            Socket.sendJoinDesk(number, userId);
        };
    },

    _initInvit: function _initInvit() {
        //var self = this;
        //let Invit = this.invitNode.getComponent('Invit');

        // Invit.callbackJoinRoom = function (number) {
        //     self.invitNode.getComponent('alert').dismissAction();
        //     self.scheduleOnce(function() {
        //         self.hiddenWaitingMessage();
        //     }, 2.0);
        //     cc.log(number)
        //     cc.log('------191')
        //     let userId = Socket.instance.userInfo.id;
        // };
    },

    _jiinRoomSocketCallback: function _jiinRoomSocketCallback(response) {
        var _this = this;

        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            (function () {
                if (cc.from == null) {
                    cc.from = {};
                }
                var joinRoom = _this.joinNode.getComponent('joinRoom');

                _this.joinNode.getComponent('alert').setAlertCallbck(function () {
                    joinRoom.clickClear();
                });
                cc.from.ma = response.data.maPai;
                cc.director.loadScene('play');
            })();
        } else {
            var reasonInfo = this._joinReasonMap(response.data.reason);
            this.alertMessage(reasonInfo);
        }
    },

    _socketReceiveHallInfo: function _socketReceiveHallInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!response.result) {
            return;
        }
        var data = response.data;
        hall.lastHallInfo = data;

        var isIOS = data.isIOS;
        var isAndroid = data.isA;
        var vIOS = data.vIOS;
        var vA = data.vA;
        this.iosUrl = data.iosUrl;
        this.aUrl = data.aUrl;

        if (KQNativeInvoke.isNativeIOS()) {
            if (isIOS == 1) {
                if (vIOS != '1.0.1') {
                    this.gengxin.active = true;
                }
            }
        } else {
            //Android
            if (isAndroid == 1) {
                if (vA != '1.0.1') {
                    this.gengxin.active = true;
                }
            }
        }

        var notice = data.broadcast;
        var banner = data.info;
        this.updateNotice(notice);
        this.updateBanner(banner);
    },
    downloadNewVersion: function downloadNewVersion() {
        if (KQNativeInvoke.isNativeIOS()) {
            cc.sys.openURL(this.iosUrl);
            // jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "downloadNewVersion:", this.iosUrl);
        } else {
                //Android
                cc.sys.openURL(this.aUrl);
                // jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "downloadNewVersion", "(Ljava/lang/String;)V", this.aUrl);
            }
    },
    _createRoomSocketCallback: function _createRoomSocketCallback(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        this.hiddenWaitingMessage();

        if (response.result) {
            cc.director.loadScene('play');
        }
        /*如果钻石不足，则提示*/
        else {
                this.alertMessage("您的钻石不足");
            }
    },

    _joinReasonMap: function _joinReasonMap(reason) {
        var reasonInfo = {
            notExist: "房间不存在!",
            cardNumber: "您房卡不足!"
        };

        var info = reasonInfo[reason] || "房间已满!";
        return info;
    },

    /*shop*/
    shopAction: function shopAction() {
        var comp = this.shopAlertNode.getComponent('alert');
        comp.alert();
    },
    /*提示*/
    alertMessage: function alertMessage(msg) {
        var node = cc.instantiate(this.alertPrefab);
        this.node.addChild(node);
        var comp = node.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    updateNotice: function updateNotice(notice) {
        if (this.labelNotice == null) {
            return;
        }
        this.labelNotice.string = notice || "";
    },

    updateBanner: function updateBanner() {
        var banner = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

        if (this.labelBanner == null) {
            return;
        }
        this.labelBanner.string = banner;
    },

    /*
    createDoneAction:function() {
        var info = {};
        var key = ['setting1','setting2','setting3','setting4'];
        for (var i = 0; i < this.tsSingleSelect.length; i++) {
            var tsIndex =  this.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;
            info[key[i]] = tsIndex;
        }
        info['userId'] = this.socket.userInfo.id;
        this.socket.sendMessage('createDesk',info);
         this.createNode.getComponent('alert').dismissAction();
         let self = this;
        this.showWaitingMessage('创建中...');
        this.scheduleOnce(function() {
            self.hiddenWaitingMessage();
        }, 2.0);
    },
    */
    /*#####
    * setting1 局数  (0 | 1 | 2)
    * setting2 人数  (0 | 1 | 2 |3)
    * setting3 玩法  (0 | 1)
    * setting4 AA制收取房费  (null | 0)
    * setting5 马牌   （null | 0 | 1 | 2）
    * setting6 打枪计分 (0 | 1)
    * setting7 多一色  (null | 0)
    * */
    createDoneAction: function createDoneAction() {
        var info = {};
        //单选
        var key = ['setting1', 'setting2', 'setting6'];
        for (var i = 0; i < this.tsSingleSelect.length; i++) {
            var tsIndex = this.tsSingleSelect[i].getComponent('singleSelect').selectedIndex;
            info[key[i]] = tsIndex;
        }
        //可选可不选
        var key1 = ['setting4', 'setting7'];
        for (var i = 0; i < this.tsCheckSeclect.length - 1; i++) {
            var tsCheckIndex = this.tsCheckSeclect[i].getComponent('checkSelect').selectedIndex;
            info[key1[i]] = tsCheckIndex;
        }
        if (cc.from.isUseMa && cc.from.ma == null) {
            cc.from.ma = 0;
        }
        if (cc.from.isUseMa) {
            info['setting5'] = cc.from.ma;
        }
        //setting3 selectMoShiIndex为 ：null || 0 || 1
        var selectMoShiIndex = this.selectMoShi.getComponent('selectMoShi').selectIndex;
        info['setting3'] = selectMoShiIndex;

        var selectMoShiIndex = this.selectGuiPai.getComponent('selectMoShi').selectIndex;
        //info['setting8'] = selectMoShiIndex;
        info['setting8'] = null;
        //用户Id
        info['userId'] = this.socket.userInfo.id;

        if (info['setting6'] == 0) {
            info['setting6'] = 1;
        } else {
            info['setting6'] = 0;
        }
        if (info['setting2'] == 3) {
            //五人场必须多一色
            info['setting7'] = 0;
        }
        info['setting7'] = null;
        console.log("打印出创建房间信息");
        console.log(info);
        //return;
        this.socket.sendMessage('createDesk', info);

        this.createNode.getComponent('alert').dismissAction();

        var self = this;
        this.showWaitingMessage('创建中...');
        this.scheduleOnce(function () {
            self.hiddenWaitingMessage();
        }, 2.0);
    },

    // 随机场
    /*clickRandRoom: function () {
      cc.director.loadScene('randRoom');
    },*/

    clickShare: function clickShare() {
        this.shareAlertNode.getComponent('alert').alert();
    },

    clickShare1: function clickShare1() {
        this.shareAlertNode1.getComponent('alert').alert();
    },

    clickRecord: function clickRecord() {
        var comp = this.recordNode.getComponent('alert');
        comp.alert();
        Socket.sendGetRecrod(Socket.instance.userInfo.id);
    },

    clickPlayRule: function clickPlayRule() {
        //cc.director.loadScene('rule');
        this.help = this.node.getChildByName("help");
        var comp = this.help.getComponent('alert');
        comp.alert();
    },

    /*share*/
    shareToFriend: function shareToFriend() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallFriend");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallFriend", "()V");
        }
    },

    shareToTimeline: function shareToTimeline() {
        this.shareAlertNode.getComponent('alert').dismissAction();
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareHallTimeline");
        } else {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareHallTimeline", "()V");
        }
    },
    //点击分享
    shareToTimelinePng: function shareToTimelinePng() {

        this.shareAlertNodeBg.active = true;
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxScreenShare");
        } else {
            //Android
            KQNativeInvoke.screenshotShare("shareIMGTimeline");
        }
        this.scheduleOnce((function () {
            this.shareAlertNodeBg.active = false;
        }).bind(this), 0.01); //10s一次
    },
    //点击分享返回值 1：成功  0：已经领取
    _socketSharePng: function _socketSharePng(data) {
        this.shareAlertNodeBg.active = false;
        var self = this;
        var sting;
        if (data.data == 1) {
            Socket.sendGetUserInfo(this._userId, this._openId);
            sting = '分享成功！';
            //this.scheduleOnce(function(){
            self.showCheckMessage(sting);
            //}.bind(this),0.5);//10s一次
            this.scheduleOnce((function () {
                self.hiddenCheckMessage();
            }).bind(this), 2); //10s一次
        } else {
                sting = '今天已经分享了！';
                self.showCheckMessage(sting);
                this.scheduleOnce((function () {
                    self.hiddenCheckMessage();
                }).bind(this), 1.5); //10s一次
            }
    },

    _shareResult: function _shareResult() {
        if (this.shareAlertNode1.active == false) {
            return;
        }
        Socket.sendSharePng(this._userId);
    },

    clickExit: function clickExit() {
        var comp = this.exitNode.getComponent('alert');
        comp.alert();
    },
    /*切换账号*/
    clickCancelLation: function clickCancelLation() {
        this.logoutNode.getComponent('alert').alert();
    },

    logoutAction: function logoutAction() {
        manager.setUserInfo('');
        cc.director.loadScene('login');

        hall.cacheImageInfo = null;
    },

    exitAction: function exitAction() {
        manager.setUserInfo('');
        if (!cc.sys.isNative) {
            cc.director.loadScene('login');
            hall.cacheImageInfo = null;
            return;
        }

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "exitApp");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "exitApp", "()V");
        }
        cc.director.end();
    },

    //接收处理用户数据
    _socketReceiveUserInfo: function _socketReceiveUserInfo(response) {
        if (cc.isRoomViewShow) {
            return;
        }
        if (!this.socket.userInfo) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }
        this.nickNameLabel.string = response.data.nickname;
        this.userIdLabel.string = 'ID: ' + response.data.id;
        this.cardNumberLabel.string = response.data.cardNumber;
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        cc.loader.load(response.data.avatarUrl + ".jpg", function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;
            }
        });
    },

    _socketDisconnect: function _socketDisconnect() {
        this.showNetworkMessage("网络链接断开，重新连接中...");
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    //更新用户信息
    updateUserInfo: function updateUserInfo() {
        var info = this.socket.userInfo;
        if (!info) {
            cc.error("this.socket.userInfo 为空!!!");
            return;
        }

        this.nickNameLabel.string = info.nickname;
        this.userIdLabel.string = 'ID: ' + info.id;
        this.cardNumberLabel.string = info.cardNumber;

        var avatarUrl = info.avatarUrl + ".jpg";
        var sprite = this.avatarNode.getComponent(cc.Sprite);
        var texture = hall.cacheImageInfo[avatarUrl];
        if (texture) {
            var frame = new cc.SpriteFrame(texture);
            if (frame) {
                cc.log("从缓存中加载头像");
                sprite.spriteFrame = frame;
                return;
            }
        }

        cc.loader.load(info.avatarUrl + ".jpg", function (err, tex) {
            if (!err) {
                var frame = new cc.SpriteFrame(tex);
                sprite.spriteFrame = frame;

                hall.cacheImageInfo[avatarUrl] = tex;
            }
        });
    },

    /*提交意见*/
    feedbackAcion: function feedbackAcion() {
        var userId = this.socket.userInfo.id;
        var text = this.feedbackEditBox.string;
        if (text.length > 0) {
            this.feedbackNode.getComponent('alert').dismissAction();
            Socket.sendFeedback(userId, text);
            this.feedbackEditBox.string = '';
        }
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.sys.isObjectValid(this.waitingNode)) {
            this.waitingNode.destory();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    //network
    showNetworkMessage: function showNetworkMessage(msg) {
        if (this.networkNode && this.networkNode.active) {
            var _alert = this.networkNode.getComponent('alert');
            if (_alert.getMessage() == msg) {
                return;
            }
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage(msg) {
        if (!(this.checkNode && this.checkNode.active)) {} else {
            var _alert2 = this.checkNode.getComponent('alert');
            if (_alert2.getMessage() == msg) {
                return;
            }
        }

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },
    onBtnClick: function onBtnClick() {
        if (this._buttons.active) {
            this._buttons.active = false;
        } else {
            this._buttons.active = true;
        }
    }

});

// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },
module.exports = hall;

cc._RFpop();
},{"AudioManager":"AudioManager","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","manager":"manager","socket":"socket"}],"help":[function(require,module,exports){
"use strict";
cc._RFpush(module, '09981CwNMZOI4DHUg8u9kcj', 'help');
// scripts\help.js

cc.Class({
    "extends": cc.Component,
    properties: {
        /*sprites: {
            default: null,
            type: cc.SpriteAtlas
        },*/
        play_method_before: cc.Node, //玩法介绍
        play_method_content_label: cc.Node, //玩法介绍内容
        introduce_pai_before: cc.Node, //牌型介绍
        details: cc.Node, //牌型介绍内容
        caozuo_before: cc.Node, //操作介绍
        caozuo_content: cc.Node, //操作介绍内容
        _btn: null,
        _content: null,
        _buttonCom: null,
        _play_method_button: null,
        _introduce_pai_button: null,
        _caozuo_button: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._play_method_button = this.play_method_before.getComponent(cc.Button);
        this._introduce_pai_button = this.introduce_pai_before.getComponent(cc.Button);
        this._caozuo_button = this.caozuo_before.getComponent(cc.Button);
        this._btn = [this.play_method_before, this.introduce_pai_before, this.caozuo_before];
        this._content = [this.play_method_content_label, this.details, this.caozuo_content];
        this._buttonCom = [this._play_method_button, this._introduce_pai_button, this._caozuo_button];
        //刚开始牌型介绍的按钮不可用
        this._buttonCom[1].interactable = false;
    },
    // 点击玩法介绍
    onBtnPlayMethodClick: function onBtnPlayMethodClick() {
        for (var i = 0; i < 3; i++) {
            //所有按钮设置为可用
            this._buttonCom[i].interactable = true;
            //所有的内容都隐藏掉
            this._content[i].active = false;
        }
        //当前点击的设置为不可用
        this._buttonCom[0].interactable = false;
        //当前点击的对应的内容可见
        this._content[0].active = true;
    },
    //点击牌型介绍
    onBtnIntroducePaiClick: function onBtnIntroducePaiClick() {
        for (var i = 0; i < 3; i++) {
            //所有按钮设置为可用
            this._buttonCom[i].interactable = true;
            //所有的内容都隐藏掉
            this._content[i].active = false;
        }
        //当前点击的设置为不可用
        this._buttonCom[1].interactable = false;
        //当前点击的对应的内容可见
        this._content[1].active = true;
    },
    //点击操作介绍
    onBtnCaozuoClick: function onBtnCaozuoClick() {
        for (var i = 0; i < 3; i++) {
            //所有按钮设置为可用
            this._buttonCom[i].interactable = true;
            //所有的内容都隐藏掉
            this._content[i].active = false;
        }
        //当前点击的设置为不可用
        this._buttonCom[2].interactable = false;
        //当前点击的对应的内容可见
        this._content[2].active = true;
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"inviteCode":[function(require,module,exports){
"use strict";
cc._RFpush(module, '777f9/eB7RKK4aO7FmNYFgO', 'inviteCode');
// scripts\inviteCode.js

/**
 * 邀请码
 * @authors 黄成(you@example.org)
 * @date    2017-06-16 09:44:10
 * @version $Id$
 */
var Socket = require('socket');
cc.Class({
  'extends': cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackInviteCode: ''
  },

  onLoad: function onLoad() {
    this.clickClear(); //清除数字
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
      cc.log(label.string, "----------------");
    } else {
      return;
    }
    var isComplete = this._lastEmptyLabel() == null;
    cc.log("isComplete-------------", this.callbackInviteCode);
    var inviteNumber = this._inviteNumber();

    if (inviteNumber.length == 6) {
      cc.log(inviteNumber, "--------------------38"); //邀请码
      var userId = Socket.instance.userInfo.id;
      //Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = inviteNumber;
    }
  },
  sendCode: function sendCode() {
    //发送邀请码
    var userId = Socket.instance.userInfo.id;
    var inviteNumber = this.callbackInviteCode;
    //cc.log(inviteNumber,"--------------------38")
    if (inviteNumber && inviteNumber.length == 6) {
      Socket.sendInviteCode(inviteNumber, userId);
      this.callbackInviteCode = ''; //清空邀请码
    }
  },
  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _inviteNumber: function _inviteNumber() {
    return this.labelNumbers.reduce(function (inviteNumber, label) {
      //cc.log(inviteNumber,"-----------------");
      return inviteNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{"socket":"socket"}],"joinRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'd5dcb9CJvpPJpnsCQ/q197x', 'joinRoom');
// scripts\joinRoom.js

cc.Class({
  "extends": cc.Component,

  properties: {
    labelNumbers: [cc.Label],
    callbackJoinRoom: null
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.clickClear();
  },

  clickNumber: function clickNumber(event, number) {
    var label = this._lastEmptyLabel();
    if (label) {
      label.string = number;
    } else {
      return;
    }

    var isComplete = this._lastEmptyLabel() == null;
    if (isComplete && this.callbackJoinRoom) {
      var roomNumber = this._roomNumber();
      // cc.log("要加入的房间号是：", roomNumber);
      this.callbackJoinRoom(roomNumber);
    }
  },

  clickClear: function clickClear() {
    this.labelNumbers.forEach(function (label) {
      label.string = "";
    });
  },

  clickDeleteOne: function clickDeleteOne() {
    var label = this._lastNumberLabel();
    if (label) {
      label.string = "";
    }
  },

  _lastEmptyLabel: function _lastEmptyLabel() {
    for (var index in this.labelNumbers) {
      var label = this.labelNumbers[index];
      if (label.string == null || label.string.length <= 0) {
        return label;
      }
    }
    return null;
  },

  _lastNumberLabel: function _lastNumberLabel() {
    for (var index = this.labelNumbers.length - 1; index >= 0; --index) {
      var label = this.labelNumbers[index];
      if (label.string && label.string.length > 0) {
        return label;
      }
    }

    return null;
  },

  _roomNumber: function _roomNumber() {
    return this.labelNumbers.reduce(function (roomNumber, label) {
      return roomNumber + (label.string || "");
    }, "");
  }
});

cc._RFpop();
},{}],"launch":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0efb2ngHglDtK2A+W4dmfzt', 'launch');
// scripts\launch.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.scheduleOnce(function () {
            cc.director.loadScene('login');
        }, 0.5);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"login":[function(require,module,exports){
(function (Buffer){
"use strict";
cc._RFpush(module, '9c72dn88ytPxZWrZRaxt5cr', 'login');
// scripts\login.js

var manager = require('manager');
var KQCard = require('KQCard');
var Socket = require('socket');
var KQCardFindTypeExtension = require('KQCardFindTypeExtension');
var KQGlobalEvent = require('KQGlobalEvent');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var KQGlabolSocketEventHander = require('KQGlabolSocketEventHander');

cc.Class({
    'extends': cc.Component,

    properties: {
        selectNode: cc.Node,
        alertPrefab: cc.Prefab,
        canvasNode: cc.Node,
        //agreement: {
        //    default: null,
        //    type: cc.Label
        //},
        vLabel: cc.Label,
        scroll_View: {
            'default': null,
            type: cc.ScrollView
        },
        agreementLabel: cc.Label,
        agreementNode: cc.Node,
        waitingPrefab: cc.Prefab
    },

    goUpdateAction: function goUpdateAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod("AppController", "downloadNewVersion:", this.iosUrl);
        } else {
            //Android
            jsb.reflection.callStaticMethod("com/lling/ssz/AppActivity", "downloadNewVersion", "(Ljava/lang/String;)V", this.androidUrl);
        }
    },

    checkVersion: function checkVersion(vData) {
        //var version = vData.version;
        cc.info1 = vData.version;
        this.iosUrl = vData.iosUrl;
        this.androidUrl = vData.androidUrl;
        //if (manager.version != version) {//更新版本
        //    this.versionEnable = false;
        //    this.goUpdateAction();
        //    //this.versionLabel.string = '请到服务器更新到最新版本';
        //}
        //else {
        //this.versionLabel.string = '当前版本 ' + manager.version;
        this.versionEnable = true;
        var self = this;
        var info = manager.getUserInfo();
        if (info.length == 0) {
            this.loginEnable = true;
        }
        this.scheduleOnce(function () {
            if (info.length > 0) {
                this.loginEnable = true;
                self.loginAction();
            }
        }, 0.5);
        //}
    },

    // use this for initialization
    onLoad: function onLoad() {
        //console.log(cc.sys.localStorage,"-----------------------------135");
        cc.sys.localStorage.userinfo = '';
        this.scroll_View.scrollToTop();
        KQGlabolSocketEventHander.start();
        var self = this;
        this.loginEnable = false;
        this.socket = cc.find('GameSocket').getComponent('socket');
        this.socket.receviceMessage = function (response) {
            var data = JSON.parse(response);
            if (data.action == 'checkVersion') {
                self.checkVersion(data.data);
            } else if (data.action == 'login') {
                if (data.result) {
                    //成功
                    self.socket.userInfo = data.data; //运行时态信息
                    if (data.data.roomId.length > 0) {
                        self.scheduleOnce(function () {
                            cc.director.preloadScene('hall');
                            cc.director.loadScene('play');
                        }, 1);
                    } else {
                        self.scheduleOnce(function () {
                            cc.director.preloadScene('play');
                            cc.director.loadScene('hall');
                        }, 1);
                    }
                } else {
                    self.alertMessage('登录失败!');
                }
            }
        };

        //从本地调
        // this.socket.getWxInfo = function(info) {
        //    //console.log("进来这里了？？？");
        //     manager.setUserInfo(info);//保存本地
        //     var data = JSON.parse(info);//str -> json(obj)
        //     self.scheduleOnce(function(){//延迟执行 1s
        //         self.sendLoginRequest(data);//登录请求
        //     },1);
        // };
        //debug
        //var testData = '{"openid":"os04AwmQ1W0JSnyDtH89jBt9xHuE","nickname":"元芳","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/8D8dOtAcDic5Sichv3lxtMXYJgmunTLOLvTT5AFM4zaqKEthZibv8xdWkgjN9Yb4AQnwvSurz27UB29xx81XORwx55XanxqctdD\/0","privilege":[]}';
        function getQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]);return null;
        }
        var code = getQueryString("code");
        if (code) {
            var obj = new XMLHttpRequest(); // XMLHttpRequest对象用于在后台与服务器交换数据  
            //var url = "./access_token.php";      
            var url = "http:\/\/honggefeng.cn\/sszWeb\/access_token.php"; //测试   
            obj.open("POST", url, true);
            obj.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); // 添加http头，发送信息至服务器时内容编码类型
            obj.onreadystatechange = function () {
                if (obj.readyState == 4 && (obj.status == 200 || obj.status == 304)) {
                    // 304未修改
                    var userInfo = JSON.parse(obj.responseText);
                    manager.setUserInfo(userInfo);
                    console.log(userInfo);
                }
            };
            obj.send("code=" + code);
        }

        // if (!cc.sys.isNative && window.location) {
        //     let search = window.location.search;
        //     if (search) {
        //         let query = search.substring(1);
        //         let attrs = query.split('&');
        //         let obj = JSON.parse(testData);

        //         var url = window.location.search;
        //         var loc = url.substring(url.lastIndexOf('=')+1, url.length);

        //         attrs.forEach(function (attr) {
        //             let keyValueArr = attr.split('=');
        //             let key = keyValueArr[0];
        //             let value = keyValueArr[1];
        //             obj[key] = value;
        //         });

        //         testData = JSON.stringify(obj);
        //     }
        // }

        if (!cc.sys.isNative) {
            //console.log(cc.sys.localStorage,"-----------------------------135");
            //manager.setUserInfo(testData);
        }
    },

    agreements: function agreements() {
        this.agreementNode.active = true;
        //this.agreementLabel.string = cc.info1;
        this.agreementLabel.node.y = 0;
    },

    onDestroy: function onDestroy() {
        this.socket.receviceMessage = function () {};
    },

    sendLoginRequest: function sendLoginRequest(data) {
        this.showWaitingMessage('登录中...');
        this.socket.sendMessage('login', data);
    },

    loginAction: function loginAction() {
        var comp = this.selectNode.getComponent('select');
        if (!comp.selected) {
            this.showMsg = cc.instantiate(this.alertPrefab);
            this.canvasNode.addChild(this.showMsg);
            var _comp = this.showMsg.getComponent('alert');
            //comp.setMessage('请同意用户协议');
            return;
        }
        var info = manager.getUserInfo();
        if (info.length > 0) {
            var data = JSON.parse(info);
            this.sendLoginRequest(data);
            return;
        }

        console.log(cc.sys.isNative, "？？？");
        if (!cc.sys.isNative) {
            window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx9128d12e699ab6a7&redirect_uri=http%3A%2F%2Fwww.honggefeng.cn%2FsszWeb%2Findex.html&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";
            //window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx9128d12e699ab6a7&redirect_uri=http%3A%2F%2Fwww.phpvideo.cn%2Fmobile%2Findex.html&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect";
        } else {
                if (KQNativeInvoke.isNativeIOS()) {
                    jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxLogin"); //IOS
                } else if (KQNativeInvoke.isNativeAndroid()) {
                        //Android
                        jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxLogin", "()V");
                    }
            }
    },

    loginYkAction: function loginYkAction() {
        var comp = this.selectNode.getComponent('select');
        if (!comp.selected) {
            this.showMsg = cc.instantiate(this.alertPrefab);
            this.canvasNode.addChild(this.showMsg);
            var _comp2 = this.showMsg.getComponent('alert');
            _comp2.setMessage('请同意用户协议');
            return;
        }
        var testDate = new Date();
        var time = "'" + testDate.toLocaleString() + "'";
        var openid = new Buffer(time).toString('base64');
        var testData = '{"openid":"' + openid + '","nickname":"游客","sex":1,"language":"zh_CN","city":"Changsha","province":"Hunan","country":"CN","headimgurl":"http:\/\/wx.qlogo.cn\/mmopen\/BVyz4R8q6puJibEv1hrsaTmIKQhkaTS9FyvcevvC5hlxFnfOuspDjicG0GtzyJXOhNT7g1WZDeCDQhnRdEOgz3QMnP0F9iboQGy\/0","privilege":[]}';
        //if (!cc.sys.isNative && window.location) {
        var search = '  ';
        if (search) {
            (function () {
                var query = search.substring(1);
                var attrs = query.split('&');
                var obj = JSON.parse(testData);
                attrs.forEach(function (attr) {
                    var keyValueArr = attr.split('=');
                    var key = keyValueArr[0];
                    var value = keyValueArr[1];
                    obj[key] = value;
                });
                testData = JSON.stringify(obj);
            })();
        }
        //}

        //var info = manager.getUserInfo();
        //if (info.length > 0) {
        var data = JSON.parse(testData);
        this.sendLoginRequest(data);
        //    return;
        //}else{
        manager.setUserInfo(testData);
        //}
    },

    showWaitingMessage: function showWaitingMessage(msg) {
        if (this.waitingNode != null && cc.sys.isNative && cc.isValid(this.waitingNode)) {
            if (msg == this.waitingNode.getComponent('alert').getMessage()) {
                return;
            }

            this.waitingNode.removeFromParent();
            this.waitingNode = null;
        }
        this.waitingNode = cc.instantiate(this.waitingPrefab);
        this.canvasNode.addChild(this.waitingNode);
        var comp = this.waitingNode.getComponent('alert');
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenWaitingMessage: function hiddenWaitingMessage() {
        if (this.waitingNode != null) {
            this.waitingNode.getComponent('alert').dismissAction();
        }
    },

    protocolAction: function protocolAction() {
        cc.log('protocol action');
    }
});

cc._RFpop();
}).call(this,require("buffer").Buffer)

},{"AudioManager":"AudioManager","KQCard":"KQCard","KQCardFindTypeExtension":"KQCardFindTypeExtension","KQGlabolSocketEventHander":"KQGlabolSocketEventHander","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","buffer":2,"manager":"manager","socket":"socket"}],"maPai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8b896xHkCtE1IzD8BDK4cWL', 'maPai');
// scripts\Play\maPai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        maPaiSprite: [cc.SpriteFrame],
        spriteNode: cc.Sprite,
        labelNode: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {}

});

cc._RFpop();
},{}],"manager":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4a47fj0J/VHup24OT7njkko', 'manager');
// scripts\manager.js

module.exports = {
    version: 'v1.0.0',

    setUserInfo: function setUserInfo(str) {
        cc.sys.localStorage.setItem('userinfo', str);
    },

    getUserInfo: function getUserInfo() {
        var value = cc.sys.localStorage.getItem('userinfo');
        if (!value) {
            return "";
        }
        return value;
    },

    setMusicValue: function setMusicValue(value) {
        cc.sys.localStorage.setItem('musicVolumn', value);
    },

    getMusicValue: function getMusicValue() {
        var value = cc.sys.localStorage.getItem('musicVolumn');
        if (!value) {
            return 1;
        }
        return value;
    },

    setMusicEffectValue: function setMusicEffectValue(value) {
        cc.sys.localStorage.setItem('musicEffectVolumn', value);
    },

    getMusicEffectValue: function getMusicEffectValue() {
        var value = cc.sys.localStorage.getItem('musicEffectVolumn');
        if (!value) {
            return 1;
        }
        return value;
    }
};

cc._RFpop();
},{}],"play":[function(require,module,exports){
"use strict";
cc._RFpush(module, '16c65H2Pw9PBaQSvw69LGLQ', 'play');
// scripts\play.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');
var ArrayExtension = require('ArrayExtension');
var Manager = require('manager');
var AudioManager = require('AudioManager');
var KQNativeInvoke = require('KQNativeInvoke');
var UserModelHelper = require('UserModelHelper');
var Playback = require('Playback');
var fecha = require('fecha');
/*#####*/
var KQCard = require('KQCard');
/**/
var Player = require('Player');
/**/
//const isTeShuPai = require('isTeShuPai');
//特殊牌类型
var TESHUPAITYPE = {
    isTeShuPai: false,
    isLiuDuiBan: false,
    isSanShunZi: false,
    isSanTaoHua: false,

    isQingLong: false,
    isYiTiaoLong: false,
    isSanTongHuaShun: false,
    isSanFenTianXia: false,
    isCouYiSe: false,
    isSiTaoSanTiao: false,
    isWuDuiSanTiao: false
};

var GAMESTATUS = {
    WAIT_PEOPLE: 0, // 等人
    WAIT_READY: 1, // 等待他人准备
    PLAYING: 2 };

// 布局
//          2
//   3            1
//     self 0
// 正在玩游戏
var Play = cc.Class({
    'extends': cc.Component,

    properties: {
        playerNodes: [cc.Node],
        chatNode: cc.Node,
        cardTypeCombineNode: cc.Node,
        /*#####*/
        typeButtonsNode: cc.Node,
        /*#####*/

        labelRoomNumber: cc.Label,
        labelOverview: cc.Label,
        labelRemainTime: cc.Label,
        btnShare: cc.Button,
        btnReady: cc.Button, // 准备开始按钮
        fapaiNode: cc.Node,
        btnChatVoice: cc.Button,
        btnChatText: cc.Button,
        startCompareCardsNode: cc.Node,
        voiceRecordAnimationNode: cc.Node,
        settingNode: cc.Node,
        playbackNode: cc.Node,

        oneGameResult: cc.Node, // 一局结果
        totalGameResult: cc.Node,

        alertRequestExitNode: cc.Node, // 申请退出 Node
        alertRequestExitCountdownNode: cc.Node, // 申请退出倒计时 Node
        btnAlertRequestExitConfirmButton: cc.Button,
        btnAlertRequestExitCancelButton: cc.Button,
        btnButtonNode: cc.Node,
        btnButtons: cc.Node,

        alertAnsowerExitNode: cc.Node, // 回答申请退出  Node
        alertAnsowerExitCountdownNode: cc.Node, // 回答以上请退出的倒计时

        alert: cc.Node,

        alertForceExitNode: cc.Node, // 强制退出 Node

        waitingPrefab: cc.Prefab,
        /**/
        playerComps: [Player],
        /**/
        /*#####*/
        teshupai_min: [cc.Node],
        teshupai_max: [cc.Node],
        gongXiNi: cc.Node,
        teShuPai: cc.Node,
        _liuDuiBan: false,
        _sanShunZi: false,
        _sanTongHua: false,
        _yiTiaoLong: false,

        _QingLong: false,
        _SanTongHuaShun: false,
        _SanFenTianXia: false,
        _CouYiSe: false,
        _SiTaoSanTiao: false,
        _WuDuiSanTiao: false,

        wuTong_img: cc.SpriteFrame,
        tongHuaShun_img: cc.SpriteFrame,
        /*#####*/

        _playerComponents: null,
        _msgControl: null,

        _socket: null,
        _userId: 0,
        _playerInfos: null,
        _deskInfo: null, // createTime 创建时间  isDissolving 表示是否正在解散 dissolveLeftTime 离解散剩余多长时间 dissolveAnswerInfo [处理过的人的信息]
        _gameStatus: GAMESTATUS.WAIT_PEOPLE,
        _enterTime: null,
        _players: null,
        /**/
        _isComparingCardsNow: false, // 是否正在比牌
        _playedCompareCardsIndexs: [] },

    // 已经播放过比牌的局数
    /**/
    // use this for initialization
    onLoad: function onLoad() {
        var _this = this;

        this.BtnClickGongXiNiComfirm = this.cardTypeCombineNode.getComponent("CardTypeCombine").BtnClickGongXiNiComfirm;
        this._enterTime = Date.now();
        /**/
        this.playerComps.forEach(function (playerComp) {
            playerComp.playedCompareCardsIndexs = _this._playedCompareCardsIndexs;
        });
        /**/
        /*AudioManager.instance.playDeskMusic();*/
        AudioManager.instance.stopHallMusic();
        this._initPlayerComponents();
        this._initSelectCardNode();
        this._initOneGameResult();
        this._remainTimeStartUpdate();

        this._userId = Socket.instance.userInfo.id;
        this._msgControl = this.chatNode.getComponent('MsgControl');

        this.settingNode.getComponent("Setting").hideSwitch();
        this.labelRoomNumber.string = "";
        this.labelRemainTime.node.active = false;

        this._registerVoiceNodeEvents();
        this._registerSocketEvent();

        /*#####*/
        this._initMaPai();
        Play.instances = this;
        this._gongXiNiShow(false);
        /*#####*/
        if (Playback.instance.isContainPlaybackDatas()) {
            Playback.instance.startPlayback();
            this.playbackNode.active = true;
            this.btnChatVoice.node.active = false;
            //this.cardsFromArray.node.active = false;
        } else {
                this._loadDeskInfo();
            }

        this._socket = Socket.instance;

        // this.scheduleOnce(function () {
        //   // this._showOneGameResult();
        //   // this._startCompareCards();
        // }.bind(this), 2);
    },

    /*#####*/
    /*显示马牌*/
    _initMaPai: function _initMaPai() {
        //"mapai"脚本上挂着马牌精灵
        var maPaiCom = this.node.getComponent("maPai");
        var spriteNode = maPaiCom.spriteNode; //马牌精灵节点
        var labelNode = maPaiCom.labelNode; //马牌文字节点
        if (this.maPai != null) {
            labelNode.active = true;
        }
        if (this.maPai == 1) {
            spriteNode.spriteFrame = maPaiCom.maPaiSprite[0];
        } else if (this.maPai == 5) {
            spriteNode.spriteFrame = maPaiCom.maPaiSprite[1];
        } else if (this.maPai == 10) {
            spriteNode.spriteFrame = maPaiCom.maPaiSprite[2];
        } else {
            spriteNode.spriteFrame = null;
            labelNode.active = false;
        }
    },

    _initPlayerComponents: function _initPlayerComponents() {
        this._playerComponents = this.playerNodes.map(function (node) {
            return node.getComponent('Player');
        });
    },

    _initSelectCardNode: function _initSelectCardNode() {
        var self = this;
        var cardTypeCombineComp = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombineComp.setFinishSelectCardsCallback(function (serverCardsInfo) {
            cardTypeCombineComp.reset();
            Socket.sendPlayCard(self._userId, serverCardsInfo);
            self.cardTypeCombineNode.active = false;
        });
    },
    /**/
    _initOneGameResult: function _initOneGameResult() {
        var self = this;
        this.oneGameResult.setCloseCallback = function () {
            if (self._isRandomRoom()) {
                cc.director.loadScene('hall');
            }
        };
    },
    /**/
    //_initOneGameResult: function () {
    //  const self = this;
    //  this.oneGameResult.setCloseCallback = function () {
    //    if (self._isRandomRoom()) {
    //      cc.director.loadScene('hall');
    //    }
    //  };
    //},

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickExit: function clickExit() {
        if (Playback.instance.isPlaybacking()) {
            cc.director.loadScene('hall');
            return;
        }
        /**/
        if (this._deskInfo && this._deskInfo.isDeskOver) {
            if (!this._isComparingCardsNow) {
                // 如果房间已结束，并且不是正在播放打牌动画, 则直接离开房间
                cc.director.loadScene('hall');
            }
            return;
        }
        /**/
        //if (this._isRandomRoom()) {
        //    this.alertForceExitNode.getComponent('alert').alert();
        //    return;
        //}

        if (this._deskInfo.cIndex == 0) {
            if (this._deskInfo.createId == this._userId) {
                Socket.sendDissolveDesk(this._userId);
            } else {
                Socket.sendLeaveDesk(this._userId);
            }
            return;
        }

        this.btnAlertRequestExitCancelButton.node.active = true;
        this.btnAlertRequestExitConfirmButton.node.active = true;

        var alert = this.alertRequestExitNode.getComponent('alert');
        alert.unscheduleAllCallbacks();
        alert.setMessage("您在申请协商退出，如果所有玩家同意，您将退出游戏。");
        alert.alert();

        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },

    //点击分享按钮
    clickShare: function clickShare() {
        var roomId = String(this._deskInfo.roomId);
        var description = "金麟十三道 玩法:";
        //+ this._deskInfoGameWay();
        description = description + " " + this._deskInfoNumberOfPeople();
        description = description + "," + this._deskInfoPayInfo();
        //description = description + "," + this._deskInfoJiaYiSeInfo();
        //description = description + "," + this._deskInfoGuiPaiInfo();
        description = description + " " + this._deskInfoNumberOfGame();

        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "wxShareFriend:description:", roomId, description);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "wxShareFriend", "(Ljava/lang/String;Ljava/lang/String;)V", roomId, description);
        }
    },

    //点击准备按钮
    clickReady: function clickReady() {
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        /*#####点击准备的时候，上一局比牌的数据消失*/
        this._playerComponents.forEach(function (playerComp) {
            //playerComp.reset();
            playerComp.reset(); //#####
        });
        cc.find("Canvas/show_result").active = false;
        Socket.sendReady(this._userId);
    },

    updateRoomNumber: function updateRoomNumber(roomNumber) {
        var gameNumberString = "";
        if (this._deskInfo.setting1 != 0 && this._deskInfo.setting1 != 1) {
            gameNumberString = "局数 : " + "" + this._deskInfo.cIndex + "/" + this._deskInfo.mMax;
        } else if (this._deskInfo.setting1 == 0) {
            gameNumberString = "局数 : 10局";
        } else if (this._deskInfo.setting1 == 1) {
            gameNumberString = "局数 : 20局";
        }
        this.labelRoomNumber.string = "房号 : " + "" + roomNumber + "\n" + gameNumberString;
    },

    updateGameStatus: function updateGameStatus() {
        var status = arguments.length <= 0 || arguments[0] === undefined ? GAMESTATUS.WAIT_PEOPLE : arguments[0];

        this._gameStatus = status;

        this.btnShare.node.active = status == GAMESTATUS.WAIT_PEOPLE;
        this.btnReady.node.active = status == GAMESTATUS.WAIT_READY;
        this.isReadyStatus();
        //if (status == GAMESTATUS.PLAYING) {
        //  this._playerComponents.forEach(function(playerComp){
        //    //playerComp.hideReadyStatus();
        //  });
        //}
    },

    gameStatus: function gameStatus() {
        return this._gameStatus;
    },
    isReadyStatus: function isReadyStatus() {
        //console.log(this._playerInfos)
        if (this._playerInfos && this._playerInfos.length > 0) {
            this._playerInfos.forEach((function (playerInfo) {
                var userInfoSelf = cc.find('Canvas/playSelf/userInfoSelf');
                if (playerInfo.id == this._userId) {
                    if (!playerInfo.readyStatus && !this._isComparingCardsNow && !Playback.instance.isPlaybacking() && !Playback.instance.isContainPlaybackDatas()) {
                        userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);
                        if (this._deskInfo.cIndex == 0) {
                            //一局还没开始
                            //if(this._deskInfo.createId != this._userId){////是否是房主
                            this.btnReady.node.active = true;
                            if (this._deskInfo.players.length < this._deskInfo.maxNumber) {
                                this.btnShare.node.active = true;
                            } else {
                                this.btnShare.node.active = false;
                            }
                            //}else{
                            //    this.btnReady.node.active = false;
                            //}
                        } else {
                                var oneGameResult = this.oneGameResult.getComponent('GameResult');
                                oneGameResult.unscheduleAllCallbacks();
                                oneGameResult.showResults(this._deskInfo, this._userId);
                                this.btnShare.node.active = false;
                                this.btnReady.node.active = false;
                            }
                        console.log("未曾准备");
                    } else {
                        this.btnReady.node.active = false;
                        this.btnShare.node.active = false;
                        cc.find("Canvas/show_result").active = false;
                        if (!this._isComparingCardsNow) {
                            userInfoSelf.getComponent('userInfo').setReadyNodeVisible(true);
                        } else {
                            //userInfoSelf.getComponent('userInfo').setReadyNodeVisible(false);
                            this._playerComponents.forEach(function (playerComp) {
                                playerComp.hideReadyStatus();
                            });
                        }
                        console.log("已准备");
                    }
                }
            }).bind(this));
        }
    },
    /// 游戏动画
    _startGame: function _startGame() {
        if (this.gameStatus() == GAMESTATUS.PLAYING) {
            return;
        }
        this._isComparingCardsNow = true;
        this.updateGameStatus(GAMESTATUS.PLAYING);
        this._playFaPaiAnimation();

        if (!UserModelHelper.isPlayedCards(this._findPlayerInfoByUserId(this._userId))) {
            this.scheduleOnce((function () {
                this._showCardTypeCombine();
            }).bind(this), 1.0);

            //let self = this;
            //  //this.fapaiNode.getComponent('alert').alert();
            //  self.fapaiNode.active = true;
            //  var anim = this.fapaiNode.getComponent(cc.Animation);
            //  anim.play('fapai');
            //this.scheduleOnce(function () {
            //  self.fapaiNode.active = false;
            //}, 2.0);
        }
    },

    _playFaPaiAnimation: function _playFaPaiAnimation() {
        this._playerComponents.forEach(function (player) {
            player.playFaPaiAnimation();
        });

        AudioManager.instance.playFaPai();
    },

    /*#####*/
    //是否特殊牌
    isTeShuPai: function isTeShuPai(cards) {
        var result = KQCard.isTeShuPai(cards);
        if (result) {
            TESHUPAITYPE.isTeShuPai = true;
        } else {
            TESHUPAITYPE.isTeShuPai = false;
        }
        return result;
    },
    //是否一条龙
    isYiTiaoLong: function isYiTiaoLong(cards) {
        var result = KQCard.isYiTiaoLong(cards);
        if (result) {
            TESHUPAITYPE.isYiTiaoLong = true;
        } else {
            TESHUPAITYPE.isYiTiaoLong = false;
        }
        return result;
    },
    //是否六对半
    isLiuDuiBan: function isLiuDuiBan(cards) {
        var result = KQCard.isLiuDuiBan(cards);
        if (result) {
            TESHUPAITYPE.isLiuDuiBan = true;
        } else {
            TESHUPAITYPE.isLiuDuiBan = false;
        }
    },
    //是否三顺子
    isSanShunZi: function isSanShunZi(cards) {
        var result = KQCard.isSanShunZi(cards);
        if (result) {
            TESHUPAITYPE.isSanShunZi = true;
        } else {
            TESHUPAITYPE.isSanShunZi = false;
        }
    },
    //是否三同花
    isSanTongHua: function isSanTongHua(cards) {
        var result = KQCard.isSanTongHua(cards);
        if (result) {
            TESHUPAITYPE.isSanTaoHua = true;
        } else {
            TESHUPAITYPE.isSanTaoHua = false;
        }
    },
    //是否三同花顺
    isSanTongHuaShun: function isSanTongHuaShun(cards) {
        var result = KQCard.isSanTongHuaShun(cards);
        if (result) {
            TESHUPAITYPE.isSanTongHuaShun = true;
        } else {
            TESHUPAITYPE.isSanTongHuaShun = false;
        }
    },
    //是否是清龙
    isQingLong: function isQingLong(cards) {
        var result = KQCard.isQingLong(cards);
        if (result) {
            TESHUPAITYPE.isQingLong = true;
        } else {
            TESHUPAITYPE.isQingLong = false;
        }
    },
    //是否是 “三分天下”
    isSanFenTianXia: function isSanFenTianXia(cards) {
        var result = KQCard.isSanFenTianXia(cards);
        if (result) {
            TESHUPAITYPE.isSanFenTianXia = true;
        } else {
            TESHUPAITYPE.isSanFenTianXia = false;
        }
    },
    //是否是 “四套三条”
    isSiTaoSanTiao: function isSiTaoSanTiao(cards) {
        var result = KQCard.isSiTaoSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isSiTaoSanTiao = true;
        } else {
            TESHUPAITYPE.isSiTaoSanTiao = false;
        }
    },
    //是否是五对三条
    isWuDuiSanTiao: function isWuDuiSanTiao(cards) {
        var result = KQCard.isWuDuiSanTiao(cards);
        if (result) {
            TESHUPAITYPE.isWuDuiSanTiao = true;
        } else {
            TESHUPAITYPE.isWuDuiSanTiao = false;
        }
    },
    //是否是凑一色
    isCouYiSe: function isCouYiSe(cards) {
        var result = KQCard.isCouYiSe(cards);
        if (result) {
            TESHUPAITYPE.isCouYiSe = true;
        } else {
            TESHUPAITYPE.isCouYiSe = false;
        }
    },
    /*#####*/

    /*显示配牌页面*/
    _showCardTypeCombine: function _showCardTypeCombine() {
        if (Playback.instance.isPlaybacking()) {
            return;
        }

        if (this.cardTypeCombineNode.active) {
            return;
        }

        var cardTypeCombine = this.cardTypeCombineNode.getComponent('CardTypeCombine');
        cardTypeCombine.reloadCards([]);
        cardTypeCombine.node.active = true;
        cardTypeCombine.timeStart(120); //sd

        var cards = this._findCardsByUserId(this._userId);
        //cards = [{suit: "c", number:20},{suit: "d", number:12}, {suit: "s", number:12},//青龙
        //    {suit: "c", number:12}, {suit: "s", number:10},
        //    {suit: "d", number:10}, {suit: "h", number:8}, {suit: "h", number:6},
        //    {suit: "d", number:6}, {suit: "s", number:5},
        //    {suit: "s", number:2}, {suit: "s", number:2}, {suit: "h", number:2},];
        /*if(this._userId == 1){
            cards = [{suit: "s", number:3},{suit: "s", number:6}, {suit: "s", number:7},//青龙
                {suit: "s", number:9}, {suit: "s", number:13},
                {suit: "h", number:10}, {suit: "h", number:12}, {suit: "h", number:13},
                {suit: "d", number:2}, {suit: "d", number:5},
                {suit: "d", number:3}, {suit: "d", number:7}, {suit: "d", number:8},];
        }
        else if(this._userId == 2){
            cards = [{suit: "s", number:1},{suit: "s", number:2}, {suit: "s", number:2},//青龙
                {suit: "h", number:4}, {suit: "s", number:4},
                {suit: "d", number:6}, {suit: "h", number:6}, {suit: "h", number:9},
                {suit: "c", number:9}, {suit: "s", number:10},
                {suit: "c", number:10}, {suit: "c", number:12}, {suit: "d", number:12},];
        }
        else if(this._userId == 3){
            cards = [{suit: "c", number:1},{suit: "h", number:3}, {suit: "s", number:12},//青龙
                {suit: "h", number:2}, {suit: "c", number:3},
                {suit: "d", number:4}, {suit: "h", number:5}, {suit: "s", number:6},
                {suit: "h", number:8}, {suit: "s", number:8},
                {suit: "s", number:11}, {suit: "s", number:11}, {suit: "h", number:11},];
        }
        else if(this._userId == 4){
            cards = [{suit: "c", number:11},{suit: "d", number:13}, {suit: "d", number:11},//青龙
                {suit: "d", number:1}, {suit: "h", number:1},
                {suit: "c", number:2}, {suit: "s", number:4}, {suit: "s", number:9},
                {suit: "c", number:7}, {suit: "h", number:7},
                {suit: "s", number:5}, {suit: "s", number:5}, {suit: "c", number:5},];
        }
        else if(this._userId == 5){
            cards = [{suit: "d", number:4},{suit: "d", number:13}, {suit: "s", number:13},//青龙
                {suit: "d", number:6}, {suit: "s", number:7},
                {suit: "d", number:8}, {suit: "c", number:9}, {suit: "c", number:10},
                {suit: "s", number:1}, {suit: "s", number:3},
                {suit: "s", number:10}, {suit: "s", number:8}, {suit: "s", number:12},];
        }*/

        var cardNames = this._convertCardsToCardNames(cards);
        cardTypeCombine.reloadCards(cardNames);
        cardTypeCombine.addCardModes(cardNames);

        /*#####发牌完执行*/

        //cards:[{'number':1~13,'suit':'s' | 'h' | 'c' | 'd'}]
        //cc.from.moshi == 0选择了庄家模式
        if (cc.moshi != 1) {
            this.isTeShuPai(cards);
            this.isYiTiaoLong(cards);
            this.isQingLong(cards);
            //this.isLiuDuiBan(cards);
            //this.isSanShunZi(cards);
            //this.isSanTongHua(cards);
            //
            //this.isSanTongHuaShun(cards);
            //this.isSanFenTianXia(cards);
            //this.isSiTaoSanTiao(cards);
            //this.isWuDuiSanTiao(cards);
            //this.isCouYiSe(cards);

            this._showGongXiNiAndBtnTeShuPai();
        }
        cc.teShuPaiCards = '';
        if (TESHUPAITYPE.isTeShuPai) {
            //如果是特殊牌将牌存起来
            cc.teShuPaiCards = cards;
        }

        /*#####*/
    },

    getIsTeShuPai: function getIsTeShuPai(userId) {
        var cards = this._findCardsByUserId(userId);
        return this.isTeShuPai(cards);
    },

    /*#####检测特殊牌类型，显示相对应的恭喜你页面和特殊牌精灵*/
    _showGongXiNiAndBtnTeShuPai: function _showGongXiNiAndBtnTeShuPai() {
        /*如果有特殊牌*/
        if (TESHUPAITYPE.isTeShuPai) {
            if (TESHUPAITYPE.isYiTiaoLong) {
                this._gongXiNiShow(true);
                this._yiTiaoLong = true;
            } else if (TESHUPAITYPE.isQingLong) {
                this._gongXiNiShow(true);
                this._sanTongHua = true;
            }
            //else if(TESHUPAITYPE.isLiuDuiBan){
            //    this._gongXiNiShow(true);
            //    this._liuDuiBan = true;
            //}
            //else if(TESHUPAITYPE.isSanShunZi){
            //    this._gongXiNiShow(true);
            //    this._sanShunZi = true;
            //}
            //else if(TESHUPAITYPE.isSanTaoHua){
            //    this._gongXiNiShow(true);
            //    this._sanTongHua = true;
            //}
            //else if(TESHUPAITYPE.isSanTongHuaShun){
            //    this._gongXiNiShow(true);
            //    this._SanTongHuaShun = true;
            //}
            //else if(TESHUPAITYPE.isSanFenTianXia){
            //    this._gongXiNiShow(true);
            //    this._SanFenTianXia = true;
            //}
            //else if(TESHUPAITYPE.isCouYiSe){
            //    this._gongXiNiShow(true);
            //    this._CouYiSe = true;
            //}
            //else if(TESHUPAITYPE.isSiTaoSanTiao){
            //    this._gongXiNiShow(true);
            //    this._SiTaoSanTiao = true;
            //}
            //else if(TESHUPAITYPE.isWuDuiSanTiao){
            //    this._gongXiNiShow(true);
            //    this._WuDuiSanTiao = true;
            //}
            else {
                    this._gongXiNiShow(false);
                }
        }
        this._initTeShuPaiSprite();
    },

    /*#####控制特殊牌精灵的显示*/
    _initTeShuPaiSprite: function _initTeShuPaiSprite() {
        /*把所有的特殊牌精灵都隐藏掉*/
        for (var i = 0; i < this.teshupai_min.length; i++) {
            this.teshupai_min[i].active = false;
            this.teshupai_max[i].active = false;
        }
        /*如果是一条龙，就显示一条龙的精灵*/
        if (this._yiTiaoLong) {
            this.teshupai_min[3].active = true;
            this.teshupai_max[3].active = true;
        }
        /*如果是六对半就显示六对半的精灵*/
        else if (this._liuDuiBan) {
                this.teshupai_min[0].active = true;
                this.teshupai_max[0].active = true;
            }
            /*如果是三顺子就显示三顺子的精灵*/
            else if (this._sanShunZi) {
                    this.teshupai_min[1].active = true;
                    this.teshupai_max[1].active = true;
                }
                /*如果是三同花，就显示三同花的精灵*/
                else if (this._sanTongHua) {
                        this.teshupai_min[2].active = true;
                        this.teshupai_max[2].active = true;
                    }
                    /*如果是三同花，就显示三同花的精灵*/
                    else if (this._QingLong) {
                            this.teshupai_min[4].active = true;
                            this.teshupai_max[4].active = true;
                        }
                        /*如果是三同花，就显示三同花的精灵*/
                        else if (this._SanTongHuaShun) {
                                this.teshupai_min[5].active = true;
                                this.teshupai_max[5].active = true;
                            }
                            /*如果是三同花，就显示三同花的精灵*/
                            else if (this._SanFenTianXia) {
                                    this.teshupai_min[6].active = true;
                                    this.teshupai_max[6].active = true;
                                }
                                /*如果是三同花，就显示三同花的精灵*/
                                else if (this._CouYiSe) {
                                        this.teshupai_min[7].active = true;
                                        this.teshupai_max[7].active = true;
                                    }
                                    /*如果是三同花，就显示三同花的精灵*/
                                    else if (this._SiTaoSanTiao) {
                                            this.teshupai_min[8].active = true;
                                            this.teshupai_max[8].active = true;
                                        }
                                        /*如果是三同花，就显示三同花的精灵*/
                                        else if (this._WuDuiSanTiao) {
                                                this.teshupai_min[9].active = true;
                                                this.teshupai_max[9].active = true;
                                            }
    },

    /*#####*/
    //显示gongXiNi 页面和teShuPai
    _gongXiNiShow: function _gongXiNiShow(statues) {
        var alterCom = this.gongXiNi.getComponent("alert");
        if (statues) {
            alterCom.alert();
        } else {
            alterCom.dismissAction();
        }

        this.teShuPai.active = statues;
    },
    /*#####*/

    //  结果相关
    // 显示一局结果
    _showOneGameResult: function _showOneGameResult() {
        /**/
        this._isComparingCardsNow = false;
        /**/
        this.updateGameStatus(GAMESTATUS.WAIT_PEOPLE);
        var oneGameResult = this.oneGameResult.getComponent('GameResult');
        oneGameResult.unscheduleAllCallbacks();
        oneGameResult.showResults(this._deskInfo, this._userId);
        this._updateUserScores();
        this._updateBanker();

        var self = this;
        this.scheduleOnce(function () {
            self._playerComponents.forEach(function (playerComp) {
                //playerComp.reset();
                //playerComp.reset2();  //#####
            });

            if (!self._isRandomRoom()) {
                //if (self._deskInfo.cIndex == 0) {//一局还没开始
                //    self.btnReady.node.active = true;
                //}
                if (self._isTotalGameOver()) {
                    self._showTotalGameResult();
                }
            }
        }, 0.5);

        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.scheduleOnce(function () {
                oneGameResult.getComponent('alert').dismissAction();
                cc.director.loadScene('hall');
            }, 2);
            return true;
        }
    },

    // 显示总结果
    _showTotalGameResult: function _showTotalGameResult() {
        var showDelay = arguments.length <= 0 || arguments[0] === undefined ? 2 : arguments[0];

        cc.find("Canvas/show_result").active = false;
        this.btnReady.node.active = false;
        this.btnShare.node.active = false;
        this.alertAnsowerExitNode.active = false;
        this.alertRequestExitNode.active = false;

        var totalGameResultComp = this.totalGameResult.getComponent('TotalGameResult');
        totalGameResultComp.setPlayerInfos(this._deskInfo.players, this._deskInfo);

        var alert = this.totalGameResult.getComponent('alert');
        this.scheduleOnce((function () {
            this.oneGameResult.active = false;
            //alert.alert();
            /**/
            if (!this.totalGameResult.active) {
                alert.alert();
            }
            /**/
        }).bind(this), showDelay);

        alert.setDismissCallback(function () {
            cc.director.loadScene('hall');
        });
    },

    // MARK: Socket 相关
    _loadDeskInfo: function _loadDeskInfo() {
        Socket.sendGetDesckInfo(this._userId);
    },
    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.ReceiveOnlineStatus, this._socketReciveOnlineStatus, this);
        KQGlobalEvent.on(Socket.Event.ReceiveChatText, this._socketReciveChatTextMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolve, this._socketReceiveRequestExitMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveRequestDissolveResult, this._socketReceiveRequestExitResultMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceiveAudioMessage, this._socketReceiveAudioMessage, this);
        KQGlobalEvent.on(Socket.Event.ReceivePlayCard, this._socketReceivePlayCard, this);
        KQGlobalEvent.on(Socket.Event.ReceiveGameOver, this._socketReceiveGameOver, this);
        KQGlobalEvent.on(Socket.Event.ReceiveFaPai, this._socketReciveFaPai, this);
        KQGlobalEvent.on(Socket.Event.ReceiveReady, this._socketReciveReady, this);
        KQGlobalEvent.on(Socket.Event.ReceiveDissolveDesk, this._socketReceiveDissolveDesk, this);
        /**/
        KQGlobalEvent.on(Socket.Event.ReceiveLeaveDesk, this._socketLeaveDesk, this);
        /**/
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._receiveSocketConnectError, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._receiveSocketConnectSuccessed, this);
        KQGlobalEvent.on(Socket.Event.ReceivePause, this._socketReceivePause, this);
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        var data = response.data;
        /*#####添加五同按钮*/
        cc.moshi = response.data.setting3;
        if (data.setting8 != null) {
            cc.moshi = 1;
        }
        cc.maPai = response.data.maPai;
        cc.duoYiSe = response.data.setting7; //setting7为  0 || null  0就是选择了多一色
        /*if(cc.duoYiSe == 0){
            this.btnWuTong = new cc.Node(); //创建一个节点对象
            this.btnWuTong.addComponent(cc.Sprite); //添加精灵组件
            this.btnWuTong.addComponent(cc.Button); //添加Button组件
            var btnSprite = this.btnWuTong.getComponent(cc.Sprite);
            btnSprite.spriteFrame = this.wuTong_img;
            this.btnWuTong.name = "btnWuTong";
            if(!this.typeButtonsNode.getChildByName("btnWuTong")){
                this.typeButtonsNode.addChild(this.btnWuTong);
                this.btnWuTong.interactable = true;
            }
            var tongHuaShunSpriteCom = this.typeButtonsNode.getChildByName("btnTongHuaShun").getComponent(cc.Sprite);
            tongHuaShunSpriteCom.spriteFrame = this.tongHuaShun_img;  //改变同花顺的精灵
              //给五同按钮添加事件：
            var clickEventWuTong = new cc.Component.EventHandler();
            clickEventWuTong.target = this.cardTypeCombineNode;
            clickEventWuTong.component = "CardTypeCombine"; //脚本名
            clickEventWuTong.handler = "clickWuTong";  //执行的函数
              var ButtonsClickEvents = this.btnWuTong.getComponent(cc.Button).clickEvents;
            ButtonsClickEvents.push(clickEventWuTong);
        }*/
        /*#####*/
        this.maPai = data.maPai;
        /*#####*/
        this._initMaPai();
        /*#####*/
        this._deskInfo = data;
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(data.roomId);

        var playerIndexs = data.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._updateUserScores();
        this._updateBanker();
        this._msgControl.addPlayerInfos(this._playerInfos);

        var currentUserInfo = players.find((function (playerInfo) {
            return playerInfo.id == this._userId;
        }).bind(this));
        this._playerComponents.forEach(function (player) {
            if (data.createId == player.userId) {
                //显示房主
                player.showFangZhuStatus(data.createId, true);
            } else {
                player.showFangZhuStatus(player.userId, false);
            }
        });
        //if (this._deskInfo.cIndex == 0) {
        //  return;
        //}
        /**/

        if (!this._deskInfo.isCBegin) {
            this._gameStatus = GAMESTATUS.WAIT_READY;
        }

        ////没有发牌，不是随机场,不是回放，显示准备按钮
        //if (!this._deskInfo.isCBegin
        //    && !this._isRandomRoom()
        //    && !Playback.instance.isPlaybacking()
        //    && !this._getSelfReadyStatus()
        //) {
        //    this.btnReady.node.active = true;
        //    if(this._deskInfo.cIndex != 0) {
        //        this.btnReady.node.x = 0;
        //        this.btnReady.node.y = 0;
        //    }
        //    else {
        //        this.btnReady.node.x = -150;
        //        this.btnReady.node.y = -24;
        //    }
        //}
        for (var i = 0; i < players.length; i++) {
            var s = players[i];
            var is = s.readyStatus; //true/false
            var userId = s.id;
            this._playerComponents.forEach(function (player) {
                player.showReadyStatus(userId, is);
            });
        }
        if (currentUserInfo && currentUserInfo.cards.length > 0 && this._deskInfo.isCBegin) {
            this._startGame();
        } else if (UserModelHelper.isPlayedCards(currentUserInfo) && !this._deskInfo.isCBegin) {
            this._socketReceiveGameOver(response);
        }
        this.isReadyStatus();
        //if (!this._deskInfo.isCBegin && !this._isRandomRoom()) {
        //  this.btnReaduy.node.active = true;
        //}
        /**/
        //if (!this._deskInfo.isCBegin && !this._isRandomRoom() && !this._deskInfo.isDeskOver) {
        //    //this.btnReady.node.active = true;
        //    cc.log(this._deskInfo)
        //    cc.log('那就是你了------')
        //    if (this._isComparingCardsNow) {
        //        this.btnReady.node.active = false;
        //    }
        //} else {
        //    this.btnReady.node.active = false;
        //}
        /**/
        this._handleUpdateDeskInfoAboutExitRoom(this._deskInfo);
    },

    _socketReciveFaPai: function _socketReciveFaPai(response) {
        this._socketReceiveDeskInfo(response);
    },

    _socketReciveOnlineStatus: function _socketReciveOnlineStatus(response) {
        //{"action":"sendOnlineStatus","result":true,"data":{"userId":100049,"status":1}}
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }

        var data = response.data;
        var userId = data.userId;
        var status = data.status;

        this._playerComponents.forEach(function (player) {
            player.setUserOnlineStatus(userId, status);
        });
    },

    _socketReciveChatTextMessage: function _socketReciveChatTextMessage(response) {
        var userId = response.data.userId;
        var message = response.data.msg;

        this._playerComponents.forEach(function (player) {
            player.showChatText(userId, message);
        });

        this._msgControl.addChatTextMessage(userId, message);

        var sex = this._playerInfos.find(function (user) {
            return user.id == userId;
        }).sex;
        AudioManager.instance.playChatAudio(sex, message);
    },

    _socketReceiveRequestExitMessage: function _socketReceiveRequestExitMessage(response) {
        if (response.data.userId == this._userId) {
            return;
        }

        var alertComp = this.alertAnsowerExitNode.getComponent('alert');
        alertComp.alert();
        alertComp.unscheduleAllCallbacks();

        var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');
        countdown.startCountdown(120, (function (isTimeout) {
            if (isTimeout) {
                this.clickAgreeOtherPlayerExit();
                return;
            }
        }).bind(this));
    },

    _socketReceiveRequestExitResultMessage: function _socketReceiveRequestExitResultMessage(response) {
        this._hideReqestExitNode();
        if (this.alertAnsowerExitNode.active) {
            this.alertAnsowerExitNode.getComponent('alert').dismissAction();
            this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        }

        if (response.data.result) {
            // 解散成功
        } else {
                var userId = response.data.userId;
                var nickname = this._findPlayerInfoByUserId(userId).nickname;
                this.showAlertMessage('解散失败，因为' + nickname + '不同意退出');
            }
    },

    _socketReceiveAudioMessage: function _socketReceiveAudioMessage(response) {
        var userId = response.data.userId;
        this.playSpeakAnimation(userId);

        if (userId == this._userId) {
            return;
        }

        var url = response.data.url;
        this.playAudioUrl(url);
    },

    _socketReceivePlayCard: function _socketReceivePlayCard(response) {
        // 有用户已经准备好了牌
        cc.log(response);
        cc.log('--------972');
        var userId = response.data[0].userId;
        var cardInfo = response.data[1].card;
        this._playerComponents.forEach(function (player) {
            player.playCard(userId, cardInfo);
        });

        if (userId == this._userId) {
            this.cardTypeCombineNode.active = false;
        }
    },
    _getSelfReadyStatus: function _getSelfReadyStatus() {
        var self = this._findPlayerInfoByUserId(this._userId);
        return self.readyStatus;
    },
    _socketReciveReady: function _socketReciveReady(response) {
        var userId = response.data.userId;
        this._playerComponents.forEach(function (player) {
            player.showReadyStatus(userId);
        });
    },

    //收到游戏结束
    _socketReceiveGameOver: function _socketReceiveGameOver(response) {
        this._hideReqestExitNode();

        // 一局游戏结束
        if (!response.result) {
            cc.error("错误：", response);
            return;
        }
        /**/
        var deskInfo = response.data;
        if (response.action == 'gameOver' && deskInfo.isDeskOver) {
            Socket.sendDidReceiveGameOverAction(this._userId);
        }
        /**/
        this._deskInfo = response.data;

        // 如果是强制解散房间，则直接显示总成绩
        if (this._isDissvledRoom() && !Playback.instance.isPlaybacking()) {
            this._showTotalGameResult(0.1);
            return;
        }

        if (Date.now() - this._enterTime < 1000 * 4) {
            // 刚进来的话，不展示比牌动画
            var oneGameResult = this.oneGameResult.getComponent('GameResult');
            oneGameResult.unscheduleAllCallbacks();
            oneGameResult.showResults(this._deskInfo, this._userId);
            this.btnShare.node.active = false;
            this.btnReady.node.active = false;
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
            /**/
            this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
            /**/
            return;
        }

        var data = response.data;
        this._deskInfo = data;
        this._updatGameOverview(this._deskInfo);

        var playerIndexs = data.playersIndex; // [100049]

        var players = data.players;
        this._playerInfos = players;
        this._updateUserInfos(players);

        if (UserModelHelper.isUserReady(this._findCurrentUserInfo())) {
            this._playerComponents.forEach(function (playerComp) {
                playerComp.reset();
            });
        } else {
            this._startCompareCards(response);
        }
    },

    _socketReceiveDissolveDesk: function _socketReceiveDissolveDesk(response) {
        this.cardTypeCombineNode.active = false;

        var message = "房主已解散房间";
        if (this._isRandomRoom()) {
            message = "有玩家已强制退出房间，游戏结束。本局游戏不会扣除您的钻石。";
        }

        this.showAlertMessage(message, false);
        this.alert.getComponent('alert').setWillDismissCallback(function () {
            cc.director.loadScene('hall');
            return true;
        });
    },
    /**/
    _socketLeaveDesk: function _socketLeaveDesk(response) {
        if (!response.result) {
            return;
        }

        if (this._deskInfo.isDeskOver) {
            // 如果房间已结束，也不用再自动退回到大厅了
            return;
        }

        cc.director.loadScene('hall');
    },
    /**/
    // socket 收到有人手机进入后台消息
    _socketReceivePause: function _socketReceivePause(response) {
        if (!response.result) {
            return;
        }

        var userId = response.data.userId;
        this._playerComponents.forEach(function (player) {
            if (player.userId == userId) {
                player.setUserOnlineStatus(userId, 0);
            }
        });
    },

    _receiveSocketConnectError: function _receiveSocketConnectError(response) {
        this.showNetworkMessage();
    },

    _receiveSocketConnectSuccessed: function _receiveSocketConnectSuccessed(response) {
        this.hiddenNetworkMessage();

        if (!Playback.instance.isPlaybacking()) {
            this._loadDeskInfo();
        }
    },
    /**/
    // MARK: 更新房间信息
    updateDeskInfo: function updateDeskInfo(deskInfo) {
        this._deskInfo = deskInfo;
        this._updatGameOverview(this._deskInfo);
        this.updateRoomNumber(deskInfo.roomId);

        var playerIndexs = deskInfo.playersIndex; // [100049]
        this._injectUserIdToPlayerComponents(playerIndexs);

        var players = deskInfo.players;
        this._playerInfos = players;
        this._updateUserInfos(players);
        this._msgControl.addPlayerInfos(this._playerInfos);
        if (deskInfo.cIndex == 0 && this._deskInfo.players.length < this._deskInfo.maxNumber) {
            this.btnShare.node.active = true;
        }
    },
    /**/
    _injectUserIdToPlayerComponents: function _injectUserIdToPlayerComponents(playerIndexs) {
        var currentUserIdIndex = playerIndexs.findIndex((function (userId) {
            return userId == this._userId;
        }).bind(this));

        var fixedPlayerIndexs = playerIndexs.translationWithStartIndex(currentUserIdIndex);
        this._playerComponents.forEach(function (playerComponent, index) {
            var userId = fixedPlayerIndexs.length > index ? fixedPlayerIndexs[index] : null;
            playerComponent.userId = userId;
        });
    },

    _updateUserInfos: function _updateUserInfos(userInfos) {
        var self = this;
        this._playerComponents.forEach(function (playerComponent, index) {
            //playerComponent.setDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateDeskInfo(self._deskInfo);
            /**/
            playerComponent.updateUserInfoWithUsers(userInfos);
        });

        this._handleTheSameOfIPAdress(userInfos);
    },

    _updateUserScores: function _updateUserScores(userInfos) {
        this._playerComponents.forEach(function (player) {
            player.updateScore();
        });
    },

    _updateBanker: function _updateBanker() {
        this._playerComponents.forEach(function (player) {
            player.updateBanker();
        });
    },

    // 私有方法
    _findCardsByUserId: function _findCardsByUserId(userId) {
        var player = this._findPlayerInfoByUserId(userId);

        return player != null ? player.cards : null;
    },

    _findPlayerInfoByUserId: function _findPlayerInfoByUserId(userId) {
        var player = (this._playerInfos || []).find(function (playerInfo) {
            return userId == playerInfo.id;
        });

        return player;
    },

    _findPlayerIndexByUserId: function _findPlayerIndexByUserId(userId) {
        var index = this._playerComponents.findIndex(function (playerComp) {
            return playerComp.userId == userId;
        });

        return index;
    },

    _findCurrentUserInfo: function _findCurrentUserInfo() {
        return this._findPlayerInfoByUserId(this._userId);
    },

    _convertCardsToCardNames: function _convertCardsToCardNames(cards) {
        // [{"suit":"s","number":10}]
        var suitColorMap = {
            s: 4,
            h: 3,
            c: 2,
            d: 1
        };
        return cards.map(function (card) {
            var cardNumber = card.number;

            // 服务器中的 14 是 A
            if (card.number == 14) {
                cardNumber = 1;
            }
            var color = suitColorMap[card.suit];
            var number = Math.max(Math.min(cardNumber, 21), 1);
            return color + "_" + number;
        });
    },

    // 更新游戏总览信息
    _updatGameOverview: function _updatGameOverview(deskInfo) {
        if (Playback.instance.isPlaybacking()) {
            this.labelOverview.string = "回放";
            return;
        }

        if (this._isRandomRoom()) {
            this.labelOverview.string = "";
            return;
        }

        //let gameNumberString = "";
        //if (deskInfo.setting1 != 0 && deskInfo.setting1 != 1) {
        //  gameNumberString = "局数 : " + "" + deskInfo.cIndex + "/" + deskInfo.mMax;
        //} else if (deskInfo.setting1 == 0) {
        //  gameNumberString = "局数 : 10局";
        //} else if (deskInfo.setting1 == 1) {
        //  gameNumberString = "局数 : 20局";
        //}

        //let gameWayName = this._deskInfoGameWay();
        this.labelOverview.string = /*+ gameWayName " " + gameNumberString +"\n"+*/
        "模式 : " + "" + deskInfo.maxNumber + "人";
    },

    /*+ "\n " + this._deskInfoJiaYiSeInfo()
    + "，"  + this._deskInfoGuiPaiInfo()*/ // 是否是随机房
    _isRandomRoom: function _isRandomRoom() {
        if (this._deskInfo == null) {
            return true;
        }

        return this._deskInfo.isRandomDesk;
    },

    // 是否所有局数都用完了
    _isTotalGameOver: function _isTotalGameOver() {
        if (this._deskInfo == null) {
            return false;
        }

        if (this._deskInfo.isDeskOver) {
            return true;
        }

        return this._deskInfo.mMax <= this._deskInfo.cIndex;
    },

    // 是否已解散房间
    _isDissvledRoom: function _isDissvledRoom() {
        if (this._deskInfo) {
            return this._deskInfo.dissolveStatus;
        }

        return false;
    },

    //// 比牌逻辑
    // 开始比牌
    _startCompareCards: function _startCompareCards(data) {
        console.log("打印data信息");
        console.log(data);
        /**/
        this._isComparingCardsNow = true;
        this._gongXiNiShow(false);
        /**/
        this._players = data.data.players;
        var user = this._findPlayerInfoByUserId(this._userId);
        AudioManager.instance.playStartCompare(user.sex);

        this.startCompareCardsNode.getComponent('alert').alert();
        this.scheduleOnce((function () {
            this.startCompareCardsNode.active = false;
            this._showCompareCardDetails(data);
        }).bind(this), 2.0);
    },

    _showCompareCardDetails: function _showCompareCardDetails(data) {
        //var _this = this;
        //this._playerComponents.forEach(function (playerComp) {
        //    playerComp.readyToCompareCards();
        //});
        //let comparePlayers = this._playerComponents.filter(function (player) {
        //    if(player.userId == null) {
        //        return false;
        //    }
        //    for(var i in _this._players) {
        //        if(_this._players[i].id == player.userId) {
        //            if(_this._players[i].cardInfo.length <= 1) {
        //                //将是特殊牌的玩家存起来
        //                if(_this._players[i].cardInfo.length == 1){
        //                    _this.teShuPlayId = _this._players[i].id;
        //                }
        //                return false;
        //            }
        //            else if(_this._players[i].cardInfo.length == 3) {
        //                return true;
        //            }
        //        }
        //    }
        //});
        this._playerComponents.forEach(function (playerComp) {
            playerComp.readyToCompareCards();
        });

        var comparePlayers = this._playerComponents.filter(function (player) {
            return player.node.active;
        });
        var self = this;
        var duration = this._showCompareCardStep(0, comparePlayers);
        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers);
        }, duration);

        this.scheduleOnce(function () {
            self._showCompareCardStep(0, comparePlayers);
        }, duration * 2);

        /**
         * 如果有特殊牌的话就改变时间 duration
         */
        var players = data.data.players;
        for (var i = 0; i < players.length; i++) {
            var s = players[i];
            if (s.cardInfo.length == 1) {
                duration += 1.5;
            }
        }

        duration = duration * 3 + 0.5;
        var shootDuration = 1.5;

        var shootDatas = this._shootDatas() || [];

        var shotData = this._shotData() || [];

        var homeRunUserId = this._homeRunUserId();

        var shotDataTimes = 0;
        shotData.forEach(function (data, index) {
            self.scheduleOnce(function () {
                self.playShoot(data.fromUserId, data.toUserId);
            }, duration + index * shootDuration);
            shotDataTimes += 1;
            duration += 1;
        });
        if (homeRunUserId.length >= 1) {
            shootDatas.forEach(function (data, index) {
                self.scheduleOnce(function () {
                    self.playShoot(data.fromUserId, data.toUserId);
                }, duration + (index + shotDataTimes) * shootDuration);
                duration += 1;
            });
        }

        duration = duration + shootDatas.length * shootDuration + shotData.length * shootDuration;

        if (homeRunUserId > 0) {
            self.scheduleOnce(function () {
                self.playHomeRun(homeRunUserId);
            }, duration);
            duration = duration + 1.0;
        }

        if (homeRunUserId) {
            duration = duration + 1;
        }

        //显示结果
        this.scheduleOnce(function () {
            self._showCompareCardFinished();
        }, duration);
    },

    _showCompareCardStep: function _showCompareCardStep() {
        var startTime = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];
        var comparePlayers = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];

        var duration = startTime;
        var interval = 1;
        var self = this;

        comparePlayers = comparePlayers.sort(function (player1, player2) {
            return player1.nextCompareScore() - player2.nextCompareScore();
        });
        // 干掉特殊牌的时间
        var co = comparePlayers;
        for (var i = 0; i < co.length; i++) {
            var s = co[i]._userInfo;
            if (s.isContainExtra) {
                co.splice(i, 1);
            }
        }
        co.forEach(function (player) {
            self.scheduleOnce(function () {
                player.showNextCompareCards();
            }, duration);
            duration = duration + interval;
        });

        return duration;
    },

    _isGameOver: function _isGameOver() {},

    // 比牌完成后会调用的方法
    _showCompareCardFinished: function _showCompareCardFinished() {
        this._showOneGameResult();
        /**/
        this._playedCompareCardsIndexs.push(this._deskInfo.cIndex);
        /**/
    },

    //network
    showNetworkMessage: function showNetworkMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? "网络链接断开，重新连接中..." : arguments[0];

        if (this.networkNode && this.networkNode.active) {
            return;
        }

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg, autoDismiss) {
        var alertComp = this.alert.getComponent('alert');
        if (!this.alert.active) {
            alertComp.alert();
        }

        alertComp.setMessage(msg);
        alertComp.unscheduleAllCallbacks();
        if (autoDismiss) {
            alertComp.scheduleOnce(function () {
                alertComp.dismissAction();
            }, 5);
        }
    },

    //checkNode
    showCheckMessage: function showCheckMessage() {
        var msg = arguments.length <= 0 || arguments[0] === undefined ? '检查网络中...' : arguments[0];

        if (this.checkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.checkNode.runAction(removeSelfAction);
            this.checkNode = null;
        }
        this.checkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.checkNode);
        var comp = this.checkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.checkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenCheckMessage: function hiddenCheckMessage() {
        if (this.checkNode != null && this.checkNode.active) {
            this.checkNode.getComponent('alert').dismissAction();
        }
    },

    /////  聊天语音逻辑
    _registerVoiceNodeEvents: function _registerVoiceNodeEvents() {
        var self = this;
        var chatVoiceNode = this.btnChatVoice.node;
        this.endRecordTime = Date.now();
        chatVoiceNode.on(cc.Node.EventType.TOUCH_START, function (event) {
            if (Date.now() - self.endRecordTime >= 1000) {
                self.nativeRecordAction();
                self.voiceRecordAnimationNode.active = true;

                var action = cc.scaleTo(0.12, 1.2);
                self.btnChatVoice.node.runAction(action);

                self._isRecording = true;
            }
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        chatVoiceNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            if (self._isRecording) {
                self.endRecordTime = Date.now();
            }
            self._isRecording = false;

            self.nativeEndRecordAction();
            self.voiceRecordAnimationNode.active = false;

            var action = cc.scaleTo(0.12, 1);
            self.btnChatVoice.node.runAction(action);
        });
        Socket.instance.uploadFinish = function (url) {
            var userId = self._userId;
            Socket.sendAudioMessage(userId, url);
            self.playSpeakAnimation(self._userId);
        };
    },

    nativeRecordAction: function nativeRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "record");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android com.lling.qianjianglzg
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "record", "()V");
            AudioManager.instance.pauseMusic();
        }
    },

    nativeEndRecordAction: function nativeEndRecordAction() {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "endRecord");
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "endRecord", "()V");
            AudioManager.instance.resumeMusic();
        }
    },

    playAudioUrl: function playAudioUrl(url) {
        if (KQNativeInvoke.isNativeIOS()) {
            jsb.reflection.callStaticMethod(KQNativeInvoke.IOSClassName, "playUrl:", url);
        } else if (KQNativeInvoke.isNativeAndroid()) {
            //Android
            jsb.reflection.callStaticMethod(KQNativeInvoke.ANDRIODClassName, "playUrl", "(Ljava/lang/String;)V", url);
        }
    },

    // MARK:  退出游戏逻辑
    _handleUpdateDeskInfoAboutExitRoom: function _handleUpdateDeskInfoAboutExitRoom(deskInfo) {
        if (!deskInfo.isDissolving) {
            return;
        }

        var dissolveLeftTime = deskInfo.dissolveLeftTime || 120;
        var dissolveUserId = deskInfo.dissolveUserId;
        if (dissolveUserId == this._userId) {
            this.alertRequestExitNode.active = true;
            this.btnAlertRequestExitCancelButton.node.active = false;
            this.btnAlertRequestExitConfirmButton.node.active = false;
            var _alert = this.alertRequestExitNode.getComponent('alert');
            _alert.setMessage("您正在申请协商退出，等待其他玩家同意");
            this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(dissolveLeftTime);
            return;
        }

        var dissolveAnswerInfos = deskInfo.dissolveAnswerInfo;
        var currentUserIdIndex = deskInfo.playersIndex.findIndex((function (userId) {
            return this._userId == userId;
        }).bind(this));

        var answerResult = dissolveAnswerInfos[currentUserIdIndex];
        if (answerResult == -1) {
            // -1 表示未处理  0 表示拒绝  1表示同意
            this.alertAnsowerExitNode.active = true;

            var countdown = this.alertAnsowerExitCountdownNode.getComponent('Countdown');
            countdown.startCountdown(dissolveLeftTime, (function (isTimeout) {
                if (isTimeout) {
                    this.clickAgreeOtherPlayerExit();
                }
            }).bind(this));
        }
    },

    // 确定要强制退出游戏
    clickButton: function clickButton() {
        var anim = this.btnButtonNode.getComponent(cc.Animation);
        if (this.btnButtons.rotation == 270) {
            anim.play('topRightButtonsLayout');
            this.btnButtons.rotation = 90;
        } else {
            //anim.stop('topRightButtonsLayout');
            this.btnButtonNode.x = 891;
            this.btnButtons.rotation = 270;
        }
    },

    // 确定要强制退出游戏
    clickConfirmForceExit: function clickConfirmForceExit() {
        Socket.sendForceExitRoom(this._userId);
        cc.director.loadScene('hall');
    },

    // 确认请求退出游戏
    clickConfirmRequestExit: function clickConfirmRequestExit() {
        this.btnAlertRequestExitCancelButton.node.active = false;
        this.btnAlertRequestExitConfirmButton.node.active = false;

        var alert = this.alertRequestExitNode.getComponent('alert');
        alert.setMessage("您正在申请协商退出，等待其他玩家同意");
        this.alertRequestExitCountdownNode.getComponent('Countdown').startCountdown(120);

        Socket.sendLeaveDesk(this._userId);
    },

    // 同意他人退出
    clickAgreeOtherPlayerExit: function clickAgreeOtherPlayerExit() {
        this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();

        Socket.sendAnswerDissolve(this._userId, 1);
    },

    // 不同意他人退出
    clickDisagreeOtherPlayerExit: function clickDisagreeOtherPlayerExit() {
        this.alertAnsowerExitNode.getComponent('alert').dismissAction();
        this.alertAnsowerExitNode.getComponent('alert').unscheduleAllCallbacks();
        this.alertAnsowerExitCountdownNode.getComponent('Countdown').stop();
        Socket.sendAnswerDissolve(this._userId, 0);
    },

    // 隐藏请求退出 Node
    _hideReqestExitNode: function _hideReqestExitNode() {
        if (!this.alertRequestExitNode.active) {
            return;
        }

        this.alertRequestExitNode.active = false;
        this.alertRequestExitCountdownNode.getComponent('Countdown').stop();
    },

    //// 打枪
    playShoot: function playShoot(fromUserId, toUserId) {
        var user = this._findPlayerInfoByUserId(fromUserId);
        if (user) {
            AudioManager.instance.playHumanDaQiang(user.sex);
        }

        var toUserIndex = this._findPlayerIndexByUserId(toUserId);

        this._playerComponents.forEach(function (player) {
            player.playShootAnimation(fromUserId, toUserIndex);
            player.playBulletHoleAnimation(toUserId);
        });
    },

    // 播放全垒打动效
    playHomeRun: function playHomeRun(userId) {
        var user = this._findPlayerInfoByUserId(userId);
        if (user) {
            AudioManager.instance.playHomeRun(user.sex);
        }

        this._playerComponents.forEach(function (player) {
            player.playHomeRunAimation(userId);
        });
    },

    playSpeakAnimation: function playSpeakAnimation(userId) {
        this._playerComponents.forEach(function (player) {
            player.playSpeakAnimation(userId);
        });
    },

    _shootDatas: function _shootDatas() {
        var homeRunUserId = this._homeRunUserId(); // 全垒打
        var shootDatas = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId == homeRunUserId;
        });
        return shootDatas;
    },

    _shotData: function _shotData() {
        var homeRunUserId = this._homeRunUserId(); // 打枪
        var shotData = this._deskInfo.shotData.filter(function (data) {
            return data.fromUserId != homeRunUserId;
        });
        return shotData;
    },

    _homeRunUserId: function _homeRunUserId() {
        return this._deskInfo.allShotData;
    },

    // MARK: 房间信息部分

    // 获取房间的玩法
    _deskInfoGameWay: function _deskInfoGameWay() {
        var setting = this._deskInfo.setting3;
        if (setting == null) {
            setting = 2;
        }
        var names = ["庄家模式", "无特殊牌", "普通模式"];
        return names[setting];
    },

    _deskInfoNumberOfGame: function _deskInfoNumberOfGame() {
        var setting = this._deskInfo.setting1;
        var infos = ['10局', '20局', '40局', '5局'];
        /*if (setting <= 1) {
          return '条数：' + infos[setting];
        }*/
        if (setting == 2) {
            setting = 0;
        } else if (setting == 3) {
            setting = 1;
        } else if (setting == 4) {
            setting = 2;
        } else if (setting == 5) {
            setting = 3;
        }
        return '局数：' + infos[setting];
    },

    _deskInfoNumberOfPeople: function _deskInfoNumberOfPeople() {
        var setting = this._deskInfo.setting2;
        var infos = ['2人', '3人', '4人', '5人'];
        return infos[setting];
    },

    _deskInfoPayInfo: function _deskInfoPayInfo() {
        var setting = this._deskInfo.setting4;
        if (setting == null) {
            setting = 0;
        }
        if (setting == 0) {
            setting = 1;
        }
        var infos = ['房主霸主庄', '房费AA'];
        return infos[setting];
    },

    _deskInfoJiaYiSeInfo: function _deskInfoJiaYiSeInfo() {
        var setting = this._deskInfo.setting7 == 0 ? 1 : 0;
        var infos = ['无多一色', '多一色'];
        return infos[setting];
    },

    _deskInfoGuiPaiInfo: function _deskInfoGuiPaiInfo() {
        var setting = undefined;
        if (this._deskInfo.setting8 == null) {
            setting = 0;
        } else if (this._deskInfo.setting8 == 0) {
            setting = 1;
        } else if (this._deskInfo.setting8 == 1) {
            setting = 2;
        }
        var infos = ['无王牌', '两张王牌', '四张王牌'];
        return infos[setting];
    },

    // MARK: 剩余时间
    _remainTimeStartUpdate: function _remainTimeStartUpdate() {
        //this.schedule(this._remainTimeUpdate, 1.0, cc.macro.REPEAT_FOREVER);
    },

    _remainTimeUpdate: function _remainTimeUpdate() {
        if (this._isRandomRoom() || Playback.instance.isPlaybacking()) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        if (this._deskInfo == null) {
            this.labelRemainTime.string = "";
            this.labelRemainTime.node.active = false;
            return;
        }

        var isTaoShu = this._deskInfo.setting1 == 0 || this._deskInfo.setting1 == 1;
        if (isTaoShu) {
            this.labelRemainTime.node.active = false;
            return;
        }

        if (!this._deskInfo.createTime) {
            return;
        }

        this.labelRemainTime.node.active = true;
        var createTime = fecha.parse(this._deskInfo.createTime, 'YYYY-MM-DD HH:mm:ss').getTime();
        var oneHour = 60 * 60;
        var remain = (Date.now() - createTime) / 1000;
        remain = Math.max(oneHour - remain, 0);

        var mins = Math.floor(remain / 60);
        var secs = Math.floor(remain % 60);
        if (mins == 0 && secs == 0) {
            this.labelRemainTime.string = "";
            return;
        }

        var minsString = "" + mins;
        if (minsString.length < 2) {
            minsString = "0" + minsString;
        }

        var secsString = "" + secs;
        if (secsString.length < 2) {
            secsString = "0" + secsString;
        }

        var string = "剩余时间：00:" + minsString + ":" + secsString;
        this.labelRemainTime.string = string;
    },

    // MARK: 处理同 IP 的用户
    _handleTheSameOfIPAdress: function _handleTheSameOfIPAdress(userInfos) {
        if (!userInfos || userInfos.length == 0) {
            return;
        }

        var ipUserInfos = userInfos.reduce(function (ips, userInfo) {
            var users = ips[userInfo.ipAddress] || [];
            users.push(userInfo);

            ips[userInfo.ipAddress] = users;
            return ips;
        }, {});

        var sameIpUsers = null;
        for (var ip in ipUserInfos) {
            var users = ipUserInfos[ip];
            if (users.length > 1) {
                sameIpUsers = users;
                break;
            }
        }

        if (sameIpUsers == null) {
            return;
        }

        this._alertSameIpUserInfos(sameIpUsers);
    },

    _alertSameIpUserInfos: function _alertSameIpUserInfos(users) {
        var message = "";
        var userIds = "";
        users.forEach(function (user, index) {
            message = message + (index > 0 ? ' 和 ' : '') + user.nickname;
            userIds = userIds + user.id;
        });
        message = message + ' 在同一 IP 下！';

        this._didAlertSameIpMessage = this._didAlertSameIpMessage || {};
        if (this._didAlertSameIpMessage[userIds]) {
            return;
        }

        this.showAlertMessage(message, true);
        this._didAlertSameIpMessage[userIds] = true;
    }

});
Play.gongXiNiShow = function (type) {
    this.instances._gongXiNiShow(type);
};
module.exports = Play;

cc._RFpop();
},{"ArrayExtension":"ArrayExtension","AudioManager":"AudioManager","KQCard":"KQCard","KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","Playback":"Playback","Player":"Player","UserModelHelper":"UserModelHelper","fecha":"fecha","manager":"manager","socket":"socket"}],"product":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'a9ad2cC2BdEiaFSqV4XCWQV', 'product');
// scripts\product.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        productId: ''
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickAction: function clickAction() {
        this.onClickAction(this.productId);
    },

    onClickAction: function onClickAction(productId) {}

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"randRoom":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4d298BlaelCHqiV5dTDjhuY', 'randRoom');
// scripts\randRoom.js

var Socket = require('socket');
var KQGlobalEvent = require('KQGlobalEvent');

cc.Class({
    'extends': cc.Component,

    properties: {
        matchingLabel: cc.Label,
        timeNode: cc.Node,
        matchingNode: cc.Node,
        waitingPrefab: cc.Prefab,
        alertPrefab: cc.Prefab,

        tishi: cc.Node,

        _userId: null,
        _response: null
    },

    // use this for initialization
    onLoad: function onLoad() {
        this._userId = Socket.instance.userInfo.id;
        cc.isRoomViewShow = true;
        KQGlobalEvent.on(Socket.Event.ReceiveDeskInfo, this._socketReceiveDeskInfo, this);
        KQGlobalEvent.on(Socket.Event.SocketDisconnect, this._socketDisconnect, this);
        KQGlobalEvent.on(Socket.Event.SocketConnectSuccessed, this._socketConnected, this);
        KQGlobalEvent.on(Socket.Event.ReceiveInterRandom, this._socketReceiveInterRandom, this);
    },

    _socketReceiveDeskInfo: function _socketReceiveDeskInfo(response) {
        if (!response.result) {
            return;
        }

        cc.director.loadScene('play');
    },

    _socketReceiveInterRandom: function _socketReceiveInterRandom(response) {
        //服务器发送  {'action':'interRandom','result':false,'data':{'reason':reason}}
        this._response = response;
        this.unschedule(this._timeoutRandomAction);
        // 处理随机场匹配不成功的情况
        if (response.result) {
            return;
        }

        var reason = response.data.reason || "加入随机场失败";
        this.showAlertMessage(reason);

        if (reason == '你已经在匹配队列') {
            this._showMatching();
        } else {
            this._hideMatching();
        }
    },

    _socketDisconnect: function _socketDisconnect() {
        // 连接已断开
        this.matchingNode.active = false;
        this.showNetworkMessage('网络链接断开，重新连接中...');
    },

    _socketConnected: function _socketConnected() {
        this.hiddenNetworkMessage();
    },

    onDestroy: function onDestroy() {
        KQGlobalEvent.offTarget(this);
    },

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    },

    clickStart: function clickStart() {
        Socket.sendEnterRandom(this._userId);
        this._showMatching();

        /*#####begin*/
        //reason是服务器发送回来的
        /*if(this._response.data.reason == "你的钻石不足"){
            this.tishi.active = true;
        }*/
        /*#####end*/

        this.scheduleOnce(this._timeoutRandomAction, 5);
    },
    /*#####点击空白地方，砖石不足提示消失*/
    /*onBtnKong:function () {
        if(this.tishi.active){
            this.tishi.active = false;
        }else{
            //什么也不做
        }
    },*/
    /*取消匹配*/
    clickCancel: function clickCancel() {
        Socket.sendCancelRandom(this._userId);

        this._hideMatching();
    },

    _timeoutRandomAction: function _timeoutRandomAction() {
        this._hideMatching();
        this.showAlertMessage('进入匹配失败');
    },

    _showMatching: function _showMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.alert();
        this.matchingLabel.string = '正在匹配中，请稍后...';
        var num = 0;
        this.schedule(function () {
            num = num + 0.5;
            this.timeNode.rotation = num;
        }, 0.01);
    },

    _hideMatching: function _hideMatching() {
        var comp = this.matchingNode.getComponent('alert');
        comp.dismissAction();
    },

    showNetworkMessage: function showNetworkMessage(msg) {
        this.unschedule(this._timeoutRandomAction);

        if (this.networkNode != null) {
            var removeSelfAction = cc.removeSelf();
            this.networkNode.runAction(removeSelfAction);
            this.networkNode = null;
        }
        this.networkNode = cc.instantiate(this.waitingPrefab);
        this.node.addChild(this.networkNode);
        var comp = this.networkNode.getComponent('alert');
        var self = this;
        comp.onDismissComplete = function () {
            self.networkNode = null;
        };
        comp.setMessage(msg);
        comp.alert();
    },

    hiddenNetworkMessage: function hiddenNetworkMessage() {
        if (this.networkNode != null) {
            this.networkNode.getComponent('alert').dismissAction();
        }
    },

    showAlertMessage: function showAlertMessage(msg) {
        if (!msg) {
            cc.error("不能显示为空的信息");
            return;
        }

        if (!this.alertMessageNode) {
            this.alertMessageNode = cc.instantiate(this.alertPrefab);
            this.node.addChild(this.alertMessageNode);
        }

        this.alertMessageNode.getComponent('alert').setMessage(msg);
        this.alertMessageNode.getComponent('alert').alert();
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"recordInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e1457gdvd5I5aENjKvCTkCd', 'recordInfo');
// scripts\recordInfo.js

var Socket = require('socket');
var Playback = require('Playback');

cc.Class({
  'extends': cc.Component,

  properties: {
    timeLabel: cc.Label,
    nicknameLabels: [cc.Label],
    scoreLabels: [cc.Label],
    numNode: cc.Label,
    _parentId: null,
    playbackNode: cc.Node, //回放按钮
    watchNode: cc.Node, //查看按钮

    _recordItemInfo: null
  },

  // use this for initialization
  onLoad: function onLoad() {},

  setInfo: function setInfo(recordInfo) {
    this._parentId = recordInfo.id;
    this.playbackNode.active = false;
    this.watchNode.active = true;
    if (recordInfo.playersInfo.length == 0) {
      return;
    }

    var playersInfo = JSON.parse(recordInfo.playersInfo);
    this.timeLabel.string = "对战时间：" + playersInfo.time;
    for (var i = 0; i < playersInfo.players.length; i++) {
      this.nicknameLabels[i].string = playersInfo.players[i].nickname;
      this.scoreLabels[i].string = playersInfo.players[i].totalScore;
    }
  },

  clickAction: function clickAction() {
    if (this._recordItemInfo) {
      cc.log("点击了记录详情 item，开启回放");
      this._startPlayback(this._recordItemInfo._info8Array);
      return;
    }

    Socket.sendGetItemRecord(Socket.instance.userInfo.id, this._parentId);
  },

  _startPlayback: function _startPlayback(playBackInfo) {
    Playback.instance.setPlaybackDatas(playBackInfo);
    cc.director.loadScene('play');
  },

  detailAction: function detailAction(recordItemInfo, index) {
    this._recordItemInfo = recordItemInfo;
    this.playbackNode.active = true;
    this.watchNode.active = false;
    this.numNode.string = "第" + (index + 1) + "局";
    this.timeLabel.string = "对战时间：" + recordItemInfo.creatAt;
    var objArray = JSON.parse(recordItemInfo.info8);
    this._recordItemInfo._info8Array = objArray;
    var playersArray = objArray.map(function (str) {
      return JSON.parse(str);
    });

    var players = playersArray[playersArray.length - 1].data.players;
    for (var i = 0; i < players.length; i++) {
      this.nicknameLabels[i].string = players[i].nickname;
      this.scoreLabels[i].string = players[i].cScore;
    }
  }

});

cc._RFpop();
},{"Playback":"Playback","socket":"socket"}],"record":[function(require,module,exports){
"use strict";
cc._RFpush(module, '452f4rFUqRLFYlGEJS5kEWs', 'record');
// scripts\record.js

var KQGlobalEvent = require('KQGlobalEvent');
var Socket = require('socket');
cc.Class({
    'extends': cc.Component,

    properties: {
        scrollView: cc.Node,
        subScrollView: cc.Node,
        recordItem: cc.Prefab,
        subRecordItem: cc.Prefab
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.isSubPage = false;
        this.subScrollView.active = false;
        this.scrollViewContent = this.scrollView.getComponent(cc.ScrollView).content;
        this.subScrollViewContent = this.subScrollView.getComponent(cc.ScrollView).content;

        this._registerSocketEvent();
    },

    _registerSocketEvent: function _registerSocketEvent() {
        KQGlobalEvent.on(Socket.Event.GetRecord, this._ReceiveRecordInfo, this);
        KQGlobalEvent.on(Socket.Event.GetItemRecord, this._ReceiveRecordItem, this);
    },

    _ReceiveRecordInfo: function _ReceiveRecordInfo(response) {
        this.isSubPage = false;
        this.subScrollView.active = false;
        this.scrollView.active = true;

        this.scrollViewContent.removeAllChildren();

        response.data.filter(function (record) {
            return record.playersInfo.length > 0;
        }).forEach((function (recordInfo) {
            var item = cc.instantiate(this.recordItem);
            this.scrollViewContent.addChild(item);
            var comp = item.getComponent('recordInfo');
            comp.setInfo(recordInfo);
        }).bind(this));
    },

    _ReceiveRecordItem: function _ReceiveRecordItem(RecordItemInfo) {
        this.isSubPage = true;
        this.subScrollView.active = true;
        this.scrollView.active = false;

        this.subScrollViewContent.removeAllChildren();
        for (var i = 0; i < RecordItemInfo.data.length; i++) {
            var item = cc.instantiate(this.recordItem);
            this.subScrollViewContent.addChild(item);
            var comp = item.getComponent('recordInfo');
            var info = RecordItemInfo.data[i];
            comp.detailAction(info, i);
        }
    },

    closeAction: function closeAction() {
        if (this.isSubPage) {
            this.isSubPage = false;
            this.subScrollView.active = false;
            this.scrollView.active = true;
        } else {
            this.node.getComponent('alert').dismissAction();
        }
    }
});

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","socket":"socket"}],"rule":[function(require,module,exports){
"use strict";
cc._RFpush(module, '92f6eNs7RdDRJIRLCZnyulJ', 'rule');
// scripts\rule.js

cc.Class({
    'extends': cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
    },

    // use this for initialization
    onLoad: function onLoad() {},

    clickExit: function clickExit() {
        cc.director.loadScene('hall');
    }
});

cc._RFpop();
},{}],"selectMoShi":[function(require,module,exports){
"use strict";
cc._RFpush(module, '0030eDrh7xEm6AeR3FCg5WU', 'selectMoShi');
// scripts\selectMoShi.js

cc.Class({
    "extends": cc.Component,

    properties: {
        selectZhuangBg: cc.Node,
        selectZhuangRight: cc.Node,
        selectTeShuPaiBg: cc.Node,
        selectTeShuPaiRight: cc.Node,
        _zhuangSelected: null, //庄家模式是否选择  null为不选择，0为选择
        _teShuPaiSelected: null, //无特殊牌模式是否选择  null为不选择，1为选择
        selectIndex: null },

    //是否选择庄家模式或者无特殊牌  null为两者都不选  0为选择了庄家模式  1为选择了无特殊牌模式
    onLoad: function onLoad() {},

    /*#####点击庄家模式*/
    clickZhuanJiaKuang: function clickZhuanJiaKuang() {
        if (this._zhuangSelected == 0) {
            //没选上庄家模式
            this.selectZhuangRight.active = false;
            this._zhuangSelected = null;

            if (this._teShuPaiSelected == null) {
                this.selectIndex = null;
            }

            //选了无特殊牌就不能选庄家模式
            if (this._teShuPaiSelected == 0) {
                this.selectIndex = 1;
            }
        } else if (this._zhuangSelected == null) {
            //选上状态
            this.selectZhuangRight.active = true;
            this._zhuangSelected = 0;
            //庄家模式选上的时候无特殊牌必须为不选
            if (this._teShuPaiSelected == 0) {
                this.selectTeShuPaiRight.active = false;
                this._teShuPaiSelected = null;
            }
            this.selectIndex = 0;
        }
        console.log(this.selectIndex);
    },

    /*#####点击无特殊牌的选择框*/
    clickTeShuPaiKuang: function clickTeShuPaiKuang() {
        if (this._teShuPaiSelected == 0) {
            //没选上
            this.selectTeShuPaiRight.active = false;
            this._teShuPaiSelected = null;

            //如果庄家模式也没选上
            if (this._zhuangSelected == null) {
                this.selectIndex = null;
            } else {
                this.selectIndex = 0;
            }
        }
        //点击的时候把勾号打开，就是选上状态
        else if (this._teShuPaiSelected == null) {
                this.selectTeShuPaiRight.active = true;
                this._teShuPaiSelected = 0;
                this.selectIndex = 1;

                if (this._zhuangSelected == 0) {
                    this.selectZhuangRight.active = false;
                    this._zhuangSelected = null;
                    this.selectIndex = 1;
                }
            }
        console.log(this.selectIndex);
    }
});

cc._RFpop();
},{}],"select_mapai":[function(require,module,exports){
"use strict";
cc._RFpush(module, '8e7e53kJcJK9rwMSxnloqI5', 'select_mapai');
// scripts\select_mapai.js

cc.Class({
    "extends": cc.Component,

    properties: {
        // foo: {
        //    default: null,      // The default value will be used only when the component attaching
        //                           to a node for the first time
        //    url: cc.Texture2D,  // optional, default is typeof default
        //    serializable: true, // optional, default is true
        //    visible: true,      // optional, default is true
        //    displayName: 'Foo', // optional
        //    readonly: false,    // optional, default is false
        // },
        // ...
        pai: cc.Node,
        mapai: {
            "default": [],
            type: cc.SpriteFrame
        }
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selectMa = this.node.getComponent("select_ma");
        this.selectMa.onLoad();
        this.com = this.pai.getComponent(cc.Sprite);
    },

    clickBtnComfirm: function clickBtnComfirm() {
        this.com.spriteFrame = this.mapai[cc.from.ma];
        //console.log(this.com.spriteFrame);
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"select_ma":[function(require,module,exports){
"use strict";
cc._RFpush(module, '4bc0b2bZGRGXoAfdO3Y6Squ', 'select_ma');
// scripts\select_ma.js

cc.Class({
    "extends": cc.Component,

    properties: {
        rightIcon: [cc.Node],
        mapaiRight: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        if (cc.from == null) {
            cc.from = {};
        }
        //如果不带马，则马牌为空
        if (this.mapaiRight.active == false) {
            cc.from.isUseMa = false;
            cc.from.ma = null;
        } else {
            cc.from.isUseMa = true;
            //否则马牌默认为第0个，即黑桃5
            cc.from.ma = 0;
        }
        for (var i = 0; i < this.rightIcon.length; i++) {
            if (i == 0) {
                this.rightIcon[i].active = true;
                cc.from.ma = 0;
                this.select = this.rightIcon[i];
            } else {
                this.rightIcon[i].active = false;
            }
        }
    },
    onMaPaiClick: function onMaPaiClick(e) {
        var targetName = e.target.name;
        cc.log(targetName);
        if (targetName != this.select.parent.name) {
            if (targetName == "select_kuang1") {
                this.select = this.rightIcon[2];
                cc.from.ma = 2;
            } else if (targetName == "select_kuang2") {
                this.select = this.rightIcon[1];
                cc.from.ma = 1;
            } else if (targetName == "select_kuang3") {
                this.select = this.rightIcon[0];
                cc.from.ma = 0;
            }
            for (var i = 0; i < this.rightIcon.length; i++) {
                this.rightIcon[i].active = false;
            }
            this.select.active = true;
        }
        console.log(cc.from.ma);
    }

});

cc._RFpop();
},{}],"select":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e913aIwAtVEo5jMrf40D5rw', 'select');
// scripts\select.js

cc.Class({
    "extends": cc.Component,

    properties: {
        bgNode: cc.Node, //选择框
        selectedNode: cc.Node, //对号
        pai: cc.Node
    },

    // use this for initialization
    onLoad: function onLoad() {
        this.selected = true;
    },

    clickAction: function clickAction() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
    },

    setSelected: function setSelected(selected) {
        this.selected = selected;
        this.selectedNode.active = this.selected;
    },

    /*#####*/
    clickSelectKuang: function clickSelectKuang() {
        this.selected = !this.selected;
        this.selectedNode.active = this.selected;
        cc.from.isUseMa = this.selected;
        var mapaiCom = this.pai.getComponent(cc.Button);
        if (this.selectedNode.active === false) {
            mapaiCom.interactable = false;
        } else {
            mapaiCom.interactable = true;
        }
    }

});
// called every frame, uncomment this function to activate update callback
// update: function (dt) {

// },

cc._RFpop();
},{}],"singleSelect":[function(require,module,exports){
"use strict";
cc._RFpush(module, '194a8h4vXFO+bXX92yzqbfq', 'singleSelect');
// scripts\singleSelect.js

cc.Class({
    'extends': cc.Component,

    properties: {
        nodes: [cc.Node],
        selectedIndex: 0
    },
    /*原来的*/
    /*    onLoad: function () {
            var self = this;
            for (var i = 0; i < this.nodes.length; i++) {
                let isSelected = (this.selectedIndex == i);
                this.nodes[i].getComponent('select').setSelected(isSelected);
            }
            for (var i = 0; i < this.nodes.length; i++) {
                var tComp = this.nodes[i].getComponent('select');
                tComp.index = i;
                tComp.clickAction = function() {
                    for (var i = 0; i < self.nodes.length; i++) {
                        var comp = self.nodes[i].getComponent('select');
                        comp.setSelected(false);
                    }
                    this.setSelected(true);
                    self.selectedIndex = this.index;
                    self.onSelectChange(this.index);
                };
            }
        },
    */
    /*####*/
    onLoad: function onLoad() {
        var self = this;
        for (var i = 0; i < this.nodes.length; i++) {
            var isSelected = this.selectedIndex == i;
            this.nodes[i].getComponent('select').setSelected(isSelected);
        }
        for (var i = 0; i < this.nodes.length; i++) {
            var tComp = this.nodes[i].getComponent('select');
            tComp.index = i;
            tComp.clickAction = function () {
                for (var i = 0; i < self.nodes.length; i++) {
                    var comp = self.nodes[i].getComponent('select');
                    comp.setSelected(false);
                }
                this.setSelected(true);
                self.selectedIndex = this.index;
                self.onSelectChange(this.index);
            };
        }
    },

    onSelectChange: function onSelectChange(selectIndex) {
        cc.log(selectIndex);
    }

});

cc._RFpop();
},{}],"slider":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1c921w7bEFKUIdNwItOX3oG', 'slider');
// scripts\slider.js

cc.Class({
    "extends": cc.Component,

    properties: {
        indicatorNode: cc.Node,
        backgroundNode: cc.Node,
        selectedNode: cc.Node,

        value: 0
    },

    // use this for initialization
    onLoad: function onLoad() {
        var self = this;
        this.indicatorNode.on(cc.Node.EventType.TOUCH_START, function (event) {});
        this.indicatorNode.on(cc.Node.EventType.TOUCH_MOVE, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_END, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });
        this.indicatorNode.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {
            var pt = self.node.convertToNodeSpace(cc.v2(event.getLocationX(), event.getLocationY()));
            self.updateSlider(pt);
        });

        //this.maxWidth = this.node.width - 40;
        this.maxWidth = this.node.width - 28;
        this.setValue(this.value);
    },

    updateSlider: function updateSlider(pt) {
        var x = pt.x;
        if (x < 0) {
            x = 0;
        }

        if (x > this.maxWidth) {
            x = this.maxWidth;
        }
        this.setValue(x / this.maxWidth);
        this.onValueChange(this.value);
    },

    /*0 - 1*/
    setValue: function setValue(value) {
        this.value = value;
        if (this.value < 0) {
            this.value = 0;
        }
        if (this.value > 1) {
            this.value = 1;
        }
        //this.maxWidth = this.node.width - 38;
        this.maxWidth = this.node.width - 28;
        this.indicatorNode.x = this.value * this.maxWidth + 10;
        this.selectedNode.width = this.value * this.maxWidth + this.indicatorNode.width / 2;
    },

    onValueChange: function onValueChange(value) {
        cc.log(value);
    }
});

cc._RFpop();
},{}],"socket":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'cf75cLLNo1ETbJFrx/23i/H', 'socket');
// scripts\socket.js

var manager = require('manager');
var KQGlobalEvent = require('KQGlobalEvent');
var KQNativeInvoke = require('KQNativeInvoke');

var SocketConstant = {
  MaxReconnectCheckInterval: 5 };

/**
 * 这是对 WebSocket 的一个封装
 * 
 * 里面包含自动重连的功能
 */
// 重连检测时间片
var Socket = cc.Class({
  'extends': cc.Component,

  properties: {
    _lastReceiveMsgTime: 0, // 最后一次收到消息时间(毫秒)
    _timeout: 8 },

  // 超时时长 （秒）
  statics: {
    instance: null,
    url: 'ws://39.108.112.11:5001'
  },

  //url:"ws://192.168.0.120:5001",
  //url:"ws://183.3.205.149:5002",
  // use this for initialization
  onLoad: function onLoad() {
    Socket.instance = this;

    this.name = "socket";

    cc.game.addPersistRootNode(this.node);
    if (cc.game.isPersistRootNode(this.node)) {
      cc.log('添加全局节点 Socket 成功');
    }

    this._registerAppActiveChange();

    this.isCreating = false;
    this.createIndex = 0;
    this.createSocket();

    this.schedule(function () {
      this.checkConnection();
    }, 5);

    this.recvTime = Date.now(); //接收到最新一条服务器的信息的时间
    //cc.log(manager.version);

    this._checkSocket();
  },

  checkConnection: function checkConnection() {
    //客户端定时给服务端发送点数据，防止连接由于长时间没有通讯而被某些节点的防火墙关闭导致连接断开的情况。
    this.sendMessage('checkAction', '');
  },

  createSocket: function createSocket() {
    var self = this;
    this.createIndex++; //创建次数加1
    if (this.createIndex > 5) {
      this.networkError();
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.isCreating = true;

    KQGlobalEvent.emit(Socket.Event.SocketConnecting);
    this.ws = new WebSocket(Socket.url);
    if (this.ws === null) {
      this.networkError();
      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { 'data': 'Socket 创建失败' });
      KQNativeInvoke.forceExitApp();
      return;
    }
    this.socketError = false;

    // socket 连接成功
    this.ws.onopen = function (event) {
      //cc.log("WebSocket 连接成功：", event);

      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketConnectSuccessed, event);

      self.isCreating = false;
      self.socketError = false;
      self.createIndex = 0;
      self.connectionSuccess();
      self.sendReconnectInfo();
    };

    // socket 接收到消息
    this.ws.onmessage = function (event) {
      self._lastReceiveMsgTime = cc.sys.now();
      KQGlobalEvent.emit(Socket.Event.SocketReceiveMessage, event.data);

      self.isCreating = false;
      self.socketError = false;
      self.receviceMessage(event.data);
      self._dispatchResponse(event.data);
      self.recvTime = Date.now(); //接收最新一条信息的时间

      /**/
    };

    /**
     * socket 发生错误
     * 
     * socket 本身有 `onerror` 回调，但事实证明，其不靠谱，
     * 有很大的机率有误报的行为，常常在没有错误时，会给错误回调。
     * 且不能定制超时时长
     * 
     * @param {String} message 
     */
    this.ws._kq_onerror = function (message) {
      cc.error('WebSocket 连接错误：' + message);

      KQGlobalEvent.emit(Socket.Event.SocketConnectError, { data: message });
      self.ws.close();
      if (!self.ws) {
        return;
      }

      // 虽然调用了 websocket 的 close 方法，但是
      // 它并会立即调用 onclose 回调，而是在未来的某
      // 一时间再回调 onclose；但这里明显可以直接回调了。
      var ws = self.ws;

      self.ws.onclose();
      ws.onclose = function () {};
    };

    // socke 已关闭
    this.ws.onclose = function (event) {
      //cc.log('WebSocket 已关闭 close time=' + Date.now() + " event: " + event);

      self.isCreating = false;
      self.socketError = true;
      self.ws = null;
      self.connectionDisconnect();
      KQGlobalEvent.emit(Socket.Event.SocketDisconnect, event);
      //cc.log('socket close'+JSON.stringify(event));
    };
  },

  reconnect: function reconnect() {
    var self = this;
    this.scheduleOnce(function () {
      if (!self.isCreating && self.socketError) {
        self.createSocket();
      }
    }, 2);
  },

  sendReconnectInfo: function sendReconnectInfo() {
    var self = this;
    this.scheduleOnce(function () {
      if (this.userInfo != null) {
        var userId = self.userInfo.user_id || self.userInfo.id;
        self.sendMessage('reconnect', {
          'userId': userId
        });
      }
    }, 1);
  },

  receviceMessage: function receviceMessage(response) {},

  connectionDisconnect: function connectionDisconnect() {},

  connectionSuccess: function connectionSuccess() {},

  networkError: function networkError() {},

  checkNetworkStart: function checkNetworkStart() {},

  checkNetworkEnd: function checkNetworkEnd() {},

  _dispatchResponse: function _dispatchResponse(responseString) {
    //cc.log("WebSocket 接收到服务器消息：", responseString);
    var response = JSON.parse(responseString);
    var action = response["action"];
    if (action) {
      KQGlobalEvent.emit(action, response);
    }
  },

  // MARK: 前后台操作
  _registerAppActiveChange: function _registerAppActiveChange() {
    //cc.log("WebSocket 注册应用进入前、后台事件");
    cc.game.on(cc.game.EVENT_HIDE, this._appEnterBackground, this);
    cc.game.on(cc.game.EVENT_SHOW, this._appBecomActive, this);
  },

  /**
   * 进入后台
   */
  _appEnterBackground: function _appEnterBackground() {
    var now = cc.sys.now();
    if (now - this._lastAppEnterBackgroundTime < 100) {
      return;
    }
    this._lastAppEnterBackgroundTime = now;

    //cc.log("WebSocket 检测到应用进入后台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppPause(id);
    this._cancelCheckSocket();
  },

  /**
   * 进入前台 
   */
  _appBecomActive: function _appBecomActive() {
    var now = cc.sys.now();
    if (now - this._lastAppBecomActiveTime < 100) {
      return;
    }
    this._lastAppBecomActiveTime = now;

    //cc.log("WebSocket 检测到应用进入前台：", new Date());
    var id = this.userInfo ? this.userInfo.id : undefined;
    Socket.sendAppActive(id);
    this._checkSocket();

    this.scheduleOnce((function () {
      this._checkSocketExecute();
    }).bind(this), 1.5);
  },

  //进入后台操作
  enterbackgroudAction: function enterbackgroudAction() {
    this._appEnterBackground();
  },

  //进入前台操作
  resumeAction: function resumeAction() {
    //检查网络
    this._checkNetwork();
    this._appBecomActive();
  },

  sendMessage: function sendMessage(action, data) {
    data = this._strongVerifyData(data);

    if (this.socketError) {
      cc.error("socket 连接错误：" + this.socketError);
      this.reconnect();
      return;
    }
    //cc.log('WebSocket 发送消息：' + action, data);
    if (cc.sys.isObjectValid(this.ws)) {
      if (this.ws.readyState === WebSocket.OPEN) {
        this.ws.send(this._convertParameterToString(action, data));
      }
    } else {
      this.connectionDisconnect();
    }
  },

  _strongVerifyData: function _strongVerifyData() {
    var data = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

    if (typeof data == 'string') {
      data = { "string": data };
    }

    if (data == null) {
      data = {};
    }

    if (!data["userId"]) {
      if (this.userInfo && typeof this.userInfo == 'object' && this.userInfo.id) {
        data["userId"] = this.userInfo.id;
      }
    }
    return data;
  },

  _convertParameterToString: function _convertParameterToString(action) {
    var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var obj = {};
    obj.action = action;
    obj.data = data;

    return JSON.stringify(obj);
  },

  // 检查网络
  _checkNetwork: function _checkNetwork() {
    if (this.checkNetworkNow) {
      this.checkNetworkNow();
    }

    this.shouldCheck = true;
    if (!this.socketError) {
      this.recvTime = 0;
      this.sendMessage('checkAction', '');
      this.scheduleOnce(function () {
        this.checkNetworkEnd();
        this.shouldCheck = false;
        if (this.recvTime === 0) {
          this.connectionDisconnect();
        }
      }, 2.5);
    } else {
      this.connectionDisconnect();
    }
  },

  // MARK: socket 掉线尽早确认
  _checkSocket: function _checkSocket() {
    this.schedule(this._checkSocketExecute, SocketConstant.MaxReconnectCheckInterval, cc.macro.REPEAT_FOREVER);
  },

  _cancelCheckSocket: function _cancelCheckSocket() {
    this.unschedule(this._checkSocketExecute);
  },

  _checkSocketExecute: function _checkSocketExecute() {
    if (this._isSocketTimeout() && this.ws) {
      this.ws._kq_onerror('连接超时');
      return;
    }
  },

  // socket 是否已超时
  _isSocketTimeout: function _isSocketTimeout() {
    return this._lastReceiveMessageInterval() >= this._timeout;
  },

  // 上一次收到消息到现在的时间间隔
  _lastReceiveMessageInterval: function _lastReceiveMessageInterval() {
    var now = cc.sys.now();
    var interval = (now - this._lastReceiveMsgTime) / 1000;
    //cc.log(`WebSocket 现在距上一条收到消息的时间间隔是：${interval} 秒`);
    return interval;
  }

});

// MARK: Socket 事件定义
Socket.Event = {
  SocketConnecting: "SocketConnecting", // Socket 正在连接
  SocketConnectSuccessed: "SocketConnectSuccessed", // 连接成功
  SocketDisconnect: "SocketDisconnect", // Socket 断开连接
  SocketConnectError: "SocketConnectError", // Socket 连接错误
  SocketReceiveMessage: "SocketReceiveMessage", // Socket 接收到消息

  InviteCode: "inviteCode", // 客户端发送   邀请码
  JoinDesk: "joinDesk", // 客户端发送
  CreateDesk: "createDesk", // 客户端发送
  LeaveDesk: "leaveDesk", // 离开桌子
  DissolveDesk: "dissolveDesk", // 解散桌子
  AnswerDissolve: "answerDissolve", // 回答请求退出命令
  GetDeskInfo: "getDeskInfo", // 客户端发送
  SendImage: "sendImage", // 客户端发送
  SendText: "sendText", // 客户端发送
  SendAudioMessage: "sendAudioMessage", // 客户端发送  发送语音消息
  GetRecord: "getRecord", // 获取战绩信息
  GetItemRecord: "getItemRecord", // 获取战绩信息
  PlayCard: "playCard", // 客户端发送，用户打出牌
  TimeoutDissolve: "timeoutDissolve", // 请求退出超时时，需要发出的消息
  Feedback: "feedback", // 客户端发送  反馈信息
  SharePng: "sharePng", // 客户端发送  分享领取砖石
  EnterRandom: "interRandom", // 客户端发送  进入随机场
  CancelRandom: "cancelRandom", // 客户端发送  取消进入随机场
  ForceExitRandom: "dissolve", // 客户端发送 强制退出随机场
  Ready: "ready", // 客户端发送 准备
  GetHallInfo: "getHallInfo", // 客户端发送 获取大厅信息
  GetUserInfo: "getUserInfo", // 客户端发送 获取用户信息
  CheckAction: "checkAction", // 客户端发送，用来检测与服务器的连通性
  Pause: "pause", // 客户端进入后台时要发送的消息
  Active: "active", // 客户端回到前台时要发送的消息

  ReceiveRequestDissolve: "requestDissolve", // 请求解散桌子 服务器发送
  ReceiveRequestDissolveResult: "requestDissolveResult", // 请求解散桌子结果
  ReceiveChatText: "sendText", // 服务器发送
  ReceiveDeskInfo: "deskInfo", // 服务器发送
  ReceiveGameOver: "gameOver", // 服务器发送
  ReceiveFaPai: "fapai", // 服务器发送
  ReceiveSharePng: "sharePngs", // 服务器发送
  ReceiveOnlineStatus: "sendOnlineStatus", // 服务器发送
  ReceiveAudioMessage: "sendAudioMessage", // 服务器发送，接收到用户发送了语音消息
  ReceivePlayCard: "playCard", // 服务器发送，有用户已经准备好牌
  ReceiveCreateDesk: "createDesk", // 服务器发送，创建房间的回调
  ReceiveReady: "ready", // 服务器发送，有用户点击了准备
  ReceiveHallInfo: "getHallInfo", // 服务器发送
  ReceiveGetUserInfo: "getUserInfo", // 服务器发送 获取用户信息
  ReceiveCheckAction: "checkAction", // 服务器发送  用来确认 Socket 还在连着
  ReceiveForceExit: "forceExit", // 服务器发送  用来使客户端强退
  ReceiveDissolveDesk: "dissolveDesk", // 服务器发送   当房主退出时，解散桌子
  ReceiveInterRandom: "interRandom", // 服务器发送   进入随机场的反馈
  ReceivePause: "pause", // 服务器发送   当有用户设备进入后台时，会收到这条消息
  ReceiveInviteCode: 'inviteCode', // 服务器发送，收到邀请码的消息
  /**/
  ReceiveLeaveDesk: 'leaveDesk' };

// MARK: Socket 提供的可发给服务器消息的方法

// 服务器发送，收到需要离开桌子的消息
/**/
Socket.sendCheckAction = function () {
  this.instance.sendMessage(this.Event.CheckAction, null);
};
/**/
Socket.sendDidReceiveGameOverAction = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(Socket.Event.DidReceiveGameOverAction, param);
};
/**/

/**
 * 当 APP 进入后台时要发送的消息
 */
Socket.sendAppPause = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Pause, param);
};

/**
 * 当 APP 进入前台时发送的消息
 */
Socket.sendAppActive = function (userId) {
  var param = userId ? { "userId": userId } : null;
  this.instance.sendMessage(this.Event.Active, param);
};

// 开房
Socket.sendCreateDesk = function (createDescInfo, userId) {
  cc.assert(createDescInfo);
  cc.assert(userId);

  createDescInfo["userId"] = userId;
  this.instance.sendMessage(this.Event.CreateDesk, createDescInfo);
};

// 加入房间
Socket.sendJoinDesk = function (roomId, userId) {
  cc.assert(roomId);
  cc.assert(userId);

  var param = {
    "roomId": roomId,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.JoinDesk, param);
};

// 发送邀请码
Socket.sendInviteCode = function (inviteCode, userId) {
  var param = {
    "inviteCode": inviteCode,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.InviteCode, param);
};

// 获取房间信息
Socket.sendGetDesckInfo = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetDeskInfo, param);
};

Socket.sendText = function (userId, text) {
  cc.assert(userId);
  cc.assert(text);
  var param = {
    "msg": text,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendText, param);
};

Socket.sendAudioMessage = function (userId) {
  var url = arguments.length <= 1 || arguments[1] === undefined ? "" : arguments[1];

  cc.assert(userId);
  cc.assert(url.length > 0);

  if (url.length == 0) {
    return;
  }

  var param = {
    "url": url,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendAudioMessage, param);
};

Socket.sendImage = function (userId, image) {
  cc.assert(userId);
  cc.assert(image);
  var param = {
    "msg": image,
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SendImage, param);
};

Socket.sendGetRecrod = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetRecord, param);
};

Socket.sendDissolveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.DissolveDesk, param);
};

Socket.sendGetItemRecord = function (userId, parentId) {
  cc.assert(userId);
  cc.assert(parentId);
  var param = {
    "userId": userId,
    "parentId": parentId
  };

  this.instance.sendMessage(this.Event.GetItemRecord, param);
};

Socket.sendLeaveDesk = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.LeaveDesk, param);
},

/**
 * 回答退房请求
 * 
 * @param  {Number} userId 当前用户 id
 * @param  {NUmber} answer=1 回答。1 表示同意； 0 表示拒绝； -1 表示未选择
 */
Socket.sendAnswerDissolve = function (userId) {
  var answer = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];

  cc.assert(userId);
  var param = {
    "userId": userId,
    "answer": answer
  };

  this.instance.sendMessage(this.Event.AnswerDissolve, param);
}, Socket.sendForceExitRoom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.DissolveDesk, param);
},

// 十三张中
// cardInfo 类似于：
// [{
//         'cards':[{'suit':suit,'number':number},{}],//特殊牌不用传
//         'type':0,
//         'value':4,
//         'isContainExtra':true,// 特殊牌是否包含特殊牌
//     },
//     {
//         'cards':[{'suit':suit,'number':number},{}],
//         'type':0,
//         'value':4
//     }]
Socket.sendPlayCard = function (userId, cardInfo) {
  cc.assert(userId);
  var param = {
    "userId": userId,
    "card": cardInfo
  };

  this.instance.sendMessage(this.Event.PlayCard, param);
};

Socket.sendTimeoutDissolve = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.TimeoutDissolve, param);
};

Socket.sendFeedback = function (userId, text) {
  cc.assert(userId);
  cc.assert(text);
  var param = {
    "userId": userId,
    "text": text
  };

  this.instance.sendMessage(this.Event.Feedback, param);
};

Socket.sendSharePng = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };
  this.instance.sendMessage(this.Event.SharePng, param);
};
// 开始匹配随机场
Socket.sendEnterRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.EnterRandom, param);
};

// 取消匹配随机场
Socket.sendCancelRandom = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.CancelRandom, param);
};

// 准备
Socket.sendReady = function (userId) {
  cc.assert(userId);
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.Ready, param);
},

// 获取大厅信息
Socket.sendGetHallInfo = function (userId) {
  var param = {
    "userId": userId
  };

  this.instance.sendMessage(this.Event.GetHallInfo, param);
},

// 获取用户信息
Socket.sendGetUserInfo = function (userId, openId) {
  var param = {
    "userId": userId,
    "openId": openId
  };

  this.instance.sendMessage(this.Event.GetUserInfo, param);
}, module.exports = Socket;

cc._RFpop();
},{"KQGlobalEvent":"KQGlobalEvent","KQNativeInvoke":"KQNativeInvoke","manager":"manager"}],"test":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'f3a5ah1deZEh6HfPdghRXyA', 'test');
// scripts\KQCard\test.js

console.log(2 < 2);

cc._RFpop();
},{}],"userInfo":[function(require,module,exports){
"use strict";
cc._RFpush(module, 'e8d10xRGnJAn42wJsuC6aBi', 'userInfo');
// scripts\userInfo.js

var AudioManager = require('AudioManager');
var Playback = require('Playback');

cc.Class({
  'extends': cc.Component,

  properties: {
    spriteAvatar: cc.Sprite,
    labelNickname: cc.Label,
    labelScore: cc.Label,
    spriteOffline: cc.Sprite,
    voiceNode: cc.Node,
    homeRunNode: cc.Node,
    readyNode: cc.Node,
    shootNodes: [cc.Node],
    bankerNode: cc.Node,
    fangZhuNode: cc.Node
  },

  // use this for initialization
  onLoad: function onLoad() {
    this.updateScore();
  },

  setReadyNodeVisible: function setReadyNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.readyNode.active = visible != false;
  },

  setFangZhuNodeVisible: function setFangZhuNodeVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.fangZhuNode.active = visible != false;
  },

  updateScore: function updateScore() {
    var score = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    this.labelScore.string = "" + score;
  },

  updateNickname: function updateNickname() {
    var nickname = arguments.length <= 0 || arguments[0] === undefined ? "" : arguments[0];

    this.labelNickname.string = nickname;
  },

  updateAvatar: function updateAvatar(avatar) {
    if (avatar.endsWith("png") || avatar.endsWith("jpg") || avatar.endsWith("gif")) {} else {
      avatar = avatar + ".png";
    }

    cc.loader.load(avatar, (function (err, data) {
      if (err) {
        return;
      }

      var frame = new cc.SpriteFrame(data);
      this.spriteAvatar.spriteFrame = frame;
    }).bind(this));
  },

  setOfflineVisible: function setOfflineVisible() {
    var visible = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    if (Playback.instance.isPlaybacking()) {
      // 如果是处理回放状态，就不用再处理离线消息了
      return;
    }

    this.spriteOffline.node.active = visible;
  },

  setIsBanker: function setIsBanker() {
    var isBanker = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];

    this.bankerNode.active = isBanker;
  },

  playShootAnimation: function playShootAnimation() {
    var toIndex = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];

    var shootNode = this.shootNodes[toIndex];
    shootNode.active = true;
    var anim = shootNode.getComponent(cc.Animation);
    anim.play('shoot').on('finished', function () {
      shootNode.active = false;
    }, this);

    AudioManager.instance.playDaQiang();
  },

  playBulletHoleAnimation: function playBulletHoleAnimation() {
    var bulletHoleNode = this.node.getChildByName('bulletHole');
    bulletHoleNode.active = true;
    var anim = bulletHoleNode.getComponent(cc.Animation);
    anim.play('bulletHole').on('finished', function () {
      bulletHoleNode.active = false;
    }, this);
  },

  playSpeakAnimation: function playSpeakAnimation() {
    this.voiceNode.active = true;
    this.scheduleOnce((function () {
      this.voiceNode.active = false;
    }).bind(this), 4);
  },

  // 播放全垒打动画
  playHomeRunAimation: function playHomeRunAimation() {
    var alert = this.homeRunNode.getComponent('alert');
    alert.alert();
    this.scheduleOnce((function () {
      this.homeRunNode.active = false;
    }).bind(this), 2);
  }
});

cc._RFpop();
},{"AudioManager":"AudioManager","Playback":"Playback"}],"zhuanNumCtrl":[function(require,module,exports){
"use strict";
cc._RFpush(module, '1b0dfWuicJLYJDmjjT1lmQc', 'zhuanNumCtrl');
// scripts\zhuanNumCtrl.js

cc.Class({
    "extends": cc.Component,

    properties: {
        zhuanNumLabel: cc.Label,
        jushu: cc.Node,
        AA: cc.Node,
        _selectedPeopleIndex: null,
        _selectedJushuIndex: null,
        _selectedAAIndex: null
    },

    onLoad: function onLoad() {
        this._ctrl();
    },

    clickPeopleAction: function clickPeopleAction() {
        this._ctrl();
    },

    clickAAAction: function clickAAAction() {
        this._ctrl();
    },

    clickJushuAction: function clickJushuAction() {
        this._ctrl();
    },

    _ctrl: function _ctrl() {
        this._selectedPeopleIndex = this.node.getComponent("singleSelect").selectedIndex;
        this._selectedJushuIndex = this.jushu.getComponent("singleSelect").selectedIndex;
        this._selectedAAIndex = this.AA.getComponent("checkSelect").selectedIndex;
        //人数选2人时且没选上AA制收费
        var renShu = 2;
        if (this._selectedPeopleIndex == 0) {
            renShu = 2;
        } else if (this._selectedPeopleIndex == 1) {
            renShu = 3;
        } else if (this._selectedPeopleIndex == 2) {
            renShu = 4;
        } else if (this._selectedPeopleIndex == 3) {
            renShu = 5;
        }
        var zhuangShi = 20;
        if (this._selectedJushuIndex == 0) {
            zhuangShi = 20;
        } else if (this._selectedJushuIndex == 1) {
            zhuangShi = 40;
        } else if (this._selectedJushuIndex == 2) {
            zhuangShi = 80;
        } else if (this._selectedJushuIndex == 3) {
            zhuangShi = 10;
        }
        //AA
        if (this._selectedAAIndex != null) {
            zhuangShi = Math.ceil(zhuangShi / renShu);
        }
        this.zhuanNumLabel.string = zhuangShi;
        //if(this._selectedPeopleIndex == 0){
        //    if(this._selectedAAIndex == null){
        //局数选10局时
        //if(this._selectedJushuIndex == 0){
        //    this.zhuanNumLabel.string = "10";
        //}
        ////局数选20局时
        //if(this._selectedJushuIndex == 1){
        //    this.zhuanNumLabel.string = "30";
        //}
        ////局数选30局时
        //if(this._selectedJushuIndex == 2){
        //    this.zhuanNumLabel.string = "80";
        //}
        //}
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "8";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "15";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "23";
        //        }
        //    }
        //
        //}
        //人数选3人
        //else if(this._selectedPeopleIndex == 1){
        //    //没选上AA制收费
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "42";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "60";
        //        }
        //    }
        //    //选了AA收费
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "20";
        //        }
        //    }
        //
        //}
        ////人数选4人且没选上AA制收费
        //else{
        //    if(this._selectedAAIndex == null){
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "28";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "56";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "84";
        //        }
        //    }
        //    //AA制收费选上了
        //    else{
        //        //局数选10局时
        //        if(this._selectedJushuIndex == 0){
        //            this.zhuanNumLabel.string = "7";
        //        }
        //        //局数选20局时
        //        if(this._selectedJushuIndex == 1){
        //            this.zhuanNumLabel.string = "14";
        //        }
        //        //局数选30局时
        //        if(this._selectedJushuIndex == 2){
        //            this.zhuanNumLabel.string = "21";
        //        }
        //    }
        //}
    }
});

cc._RFpop();
},{}]},{},["AudioManager","CardPrefab","CardTypeCombine","CardTypeSprite","ChatMessage","MsgControl","KQGlobalEvent","ArrayExtension","NumberExtension","SpriteHelper","StringExtension","fecha","Invit","GetCardPointsSameCount","KQCard","KQCardColorsHelper","KQCardFindTypeExtension","KQCardPointsHelper","KQCardResHelper","KQCardScoreExtension","KQCardScoretsHelper","KQCardSelectExtension","test","UserModelHelper","NetworkError","ChatTextRecord","CompareCards","Countdown","GameResult","Player","ResultItem","TotalGameResult","TotalGameResultItem","UserSampleInfo","maPai","Playback","Setting","KQGlabolSocketEventHander","KQNativeInvoke","agreement","alert","cards","cardsBack","cellText","checkSelect","choujiang","game","hall","help","inviteCode","joinRoom","launch","login","manager","play","product","randRoom","record","recordInfo","rule","select","selectMoShi","select_ma","select_mapai","singleSelect","slider","socket","userInfo","zhuanNumCtrl"])

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L0NvY29zQ3JlYXRvci9yZXNvdXJjZXMvYXBwLmFzYXIvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvQXJyYXlFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9BdWRpby9BdWRpb01hbmFnZXIuanMiLCJDOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9iYXNlNjQtanMvaW5kZXguanMiLCJDOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9idWZmZXIvaW5kZXguanMiLCJDOi9Db2Nvc0NyZWF0b3IvcmVzb3VyY2VzL2FwcC5hc2FyL25vZGVfbW9kdWxlcy9pZWVlNzU0L2luZGV4LmpzIiwiQzovQ29jb3NDcmVhdG9yL3Jlc291cmNlcy9hcHAuYXNhci9ub2RlX21vZHVsZXMvaXNhcnJheS9pbmRleC5qcyIsImFzc2V0cy9zY3JpcHRzL0NhcmRQcmVmYWIuanMiLCJhc3NldHMvc2NyaXB0cy9DYXJkVHlwZUNvbWJpbmUuanMiLCJhc3NldHMvc2NyaXB0cy9DYXJkVHlwZVNwcml0ZS5qcyIsImFzc2V0cy9zY3JpcHRzL0NoYXQvQ2hhdE1lc3NhZ2UuanMiLCJhc3NldHMvc2NyaXB0cy9QZWZhYnMvQ2hhdFRleHRSZWNvcmQuanMiLCJhc3NldHMvc2NyaXB0cy9QZWZhYnMvQ29tcGFyZUNhcmRzLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGVmYWJzL0NvdW50ZG93bi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvR2FtZVJlc3VsdC5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9HZXRDYXJkUG9pbnRzU2FtZUNvdW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvSW52aXQuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkQ29sb3JzSGVscGVyLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvS1FDYXJkL0tRQ2FyZFBvaW50c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRSZXNIZWxwZXIuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmVFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkU2NvcmV0c0hlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0tRQ2FyZC9LUUNhcmRTZWxlY3RFeHRlbnNpb24uanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvS1FDYXJkLmpzIiwiYXNzZXRzL3NjcmlwdHMvU29ja2V0L0tRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIuanMiLCJhc3NldHMvc2NyaXB0cy9FdmVudC9LUUdsb2JhbEV2ZW50LmpzIiwiYXNzZXRzL3NjcmlwdHMvVXRpbHMvS1FOYXRpdmVJbnZva2UuanMiLCJhc3NldHMvc2NyaXB0cy9DaGF0L01zZ0NvbnRyb2wuanMiLCJhc3NldHMvc2NyaXB0cy9OZXR3b3JrRXJyb3IuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL051bWJlckV4dGVuc2lvbi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXliYWNrL1BsYXliYWNrLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9QbGF5ZXIuanMiLCJhc3NldHMvc2NyaXB0cy9QbGF5L1Jlc3VsdEl0ZW0uanMiLCJhc3NldHMvc2NyaXB0cy9TZXR0aW5nL1NldHRpbmcuanMiLCJhc3NldHMvc2NyaXB0cy9FeHRlbnNpb25zL1Nwcml0ZUhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvU3RyaW5nRXh0ZW5zaW9uLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHRJdGVtLmpzIiwiYXNzZXRzL3NjcmlwdHMvUGxheS9Ub3RhbEdhbWVSZXN1bHQuanMiLCJhc3NldHMvc2NyaXB0cy9Nb2RlbFV0aWxzL1VzZXJNb2RlbEhlbHBlci5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvVXNlclNhbXBsZUluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9hZ3JlZW1lbnQuanMiLCJhc3NldHMvc2NyaXB0cy9hbGVydC5qcyIsImFzc2V0cy9zY3JpcHRzL2NhcmRzQmFjay5qcyIsImFzc2V0cy9zY3JpcHRzL2NhcmRzLmpzIiwiYXNzZXRzL3NjcmlwdHMvY2VsbFRleHQuanMiLCJhc3NldHMvc2NyaXB0cy9jaGVja1NlbGVjdC5qcyIsImFzc2V0cy9zY3JpcHRzL2Nob3VqaWFuZy5qcyIsImFzc2V0cy9zY3JpcHRzL0V4dGVuc2lvbnMvZmVjaGEuanMiLCJhc3NldHMvc2NyaXB0cy9nYW1lLmpzIiwiYXNzZXRzL3NjcmlwdHMvaGFsbC5qcyIsImFzc2V0cy9zY3JpcHRzL2hlbHAuanMiLCJhc3NldHMvc2NyaXB0cy9pbnZpdGVDb2RlLmpzIiwiYXNzZXRzL3NjcmlwdHMvam9pblJvb20uanMiLCJhc3NldHMvc2NyaXB0cy9sYXVuY2guanMiLCJhc3NldHMvc2NyaXB0cy9sb2dpbi5qcyIsImFzc2V0cy9zY3JpcHRzL1BsYXkvbWFQYWkuanMiLCJhc3NldHMvc2NyaXB0cy9tYW5hZ2VyLmpzIiwiYXNzZXRzL3NjcmlwdHMvcGxheS5qcyIsImFzc2V0cy9zY3JpcHRzL3Byb2R1Y3QuanMiLCJhc3NldHMvc2NyaXB0cy9yYW5kUm9vbS5qcyIsImFzc2V0cy9zY3JpcHRzL3JlY29yZEluZm8uanMiLCJhc3NldHMvc2NyaXB0cy9yZWNvcmQuanMiLCJhc3NldHMvc2NyaXB0cy9ydWxlLmpzIiwiYXNzZXRzL3NjcmlwdHMvc2VsZWN0TW9TaGkuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RfbWFwYWkuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3RfbWEuanMiLCJhc3NldHMvc2NyaXB0cy9zZWxlY3QuanMiLCJhc3NldHMvc2NyaXB0cy9zaW5nbGVTZWxlY3QuanMiLCJhc3NldHMvc2NyaXB0cy9zbGlkZXIuanMiLCJhc3NldHMvc2NyaXB0cy9zb2NrZXQuanMiLCJhc3NldHMvc2NyaXB0cy9LUUNhcmQvdGVzdC5qcyIsImFzc2V0cy9zY3JpcHRzL3VzZXJJbmZvLmpzIiwiYXNzZXRzL3NjcmlwdHMvemh1YW5OdW1DdHJsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7OztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQU47QUFFSTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBRUk7QUFBSjtBQUNBO0FBQ0E7QUFFQTtBQUNFO0FBQ0U7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFBSjtBQUVJO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNFO0FBQ0U7QUFDQTtBQURKO0FBQ0E7QUFHTTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBRE47QUFDQTtBQUdNO0FBRE47QUFDQTtBQUdNO0FBQ0U7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUdNO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR007QUFETjtBQUNBO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUdRO0FBQ0U7QUFEVjtBQUdRO0FBRFI7QUFDQTtBQUNBO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDRTtBQUNFO0FBQ0E7QUFESjtBQUNBO0FBQ007QUFDRTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDTjtBQUNNO0FBQ0U7QUFDUjtBQUNRO0FBQ0U7QUFDQTtBQUNFO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDVTtBQUNFO0FBQ1o7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFFSTtBQUNFO0FBQ0E7QUFDRTtBQUFSO0FBRU07QUFDRTtBQUFSO0FBRU07QUFBTjtBQUVJO0FBQ0E7QUFDRTtBQUNBO0FBQU47QUFDQTtBQUNBO0FBRUk7QUFBSjtBQUVNO0FBQU47QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVNO0FBQ0U7QUFBUjtBQUNBO0FBQ0E7QUFFTTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBRVE7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUVRO0FBQ0U7QUFBVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRU07QUFBTjtBQUNBO0FBQ0E7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVNO0FBQU47QUFFTTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQVY7QUFFVTtBQUFWO0FBRVE7QUFBUjtBQUNBO0FBRU07QUFBTjtBQUVNO0FBQU47QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNFO0FBQUY7QUFDQTtBQUFJO0FBQ0U7QUFFTjtBQUNBO0FBQUk7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBRVY7QUFDQTtBQUFRO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFFVjtBQUFVO0FBRVY7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDQTtBQURNO0FBR047QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNFO0FBR0Y7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUNBO0FBSEE7QUFDRTtBQUNFO0FBQ0E7QUFLSjtBQUNBO0FBTE07QUFPTjtBQUNBO0FBTlE7QUFDQTtBQUNFO0FBUVY7QUFOUTtBQUNBO0FBQ0U7QUFRVjtBQU5VO0FBQ0E7QUFRVjtBQUNBO0FBQ0E7QUFwQk07QUFzQk47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpNO0FBY047QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFjUjtBQUNBO0FBWk07QUFDRTtBQWNSO0FBQ0E7QUFaTTtBQUNBO0FBQ0E7QUFjTjtBQVpNO0FBY047QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFjUjtBQUNBO0FBWk07QUFDRTtBQUNBO0FBY1I7QUFDQTtBQVpNO0FBY047QUFaTTtBQWNOO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBY1I7QUFDQTtBQVpNO0FBQ0E7QUFDRTtBQUNFO0FBY1Y7QUFDQTtBQUNBO0FBWk07QUFjTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNVlBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1E7QUFDRTtBQUNBO0FBQ1Y7QUFDQTtBQUNRO0FBQ0U7QUFDQTtBQUNWO0FBQ0E7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDUTtBQUNHO0FBQ0E7QUFDWDtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDRztBQUNBO0FBQ1g7QUFDUTtBQUNHO0FBQ0E7QUFDWDtBQUNRO0FBQ0c7QUFDQTtBQUNYO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDUTtBQUNBO0FBQ0E7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNFO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURNO0FBQ0E7QUFHTjtBQURNO0FBQ0E7QUFHTjtBQUNBO0FBREk7QUFDRTtBQUNBO0FBR047QUFDQTtBQUNBO0FBREk7QUFHSjtBQUNBO0FBSE07QUFDQTtBQUNBO0FBS047QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUtoQjtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUNBO0FBQ0E7QUFOTTtBQVFOO0FBTlU7QUFDQTtBQUNBO0FBQ0Y7QUFRUjtBQUNBO0FBTk07QUFDQTtBQUNBO0FBUU47QUFDQTtBQUNBO0FBTkk7QUFRSjtBQUNBO0FBUk07QUFDQTtBQUNBO0FBVU47QUFDQTtBQVJJO0FBQ0U7QUFDQTtBQVVOO0FBQ0E7QUFSSTtBQUNFO0FBQ0E7QUFVTjtBQUNBO0FBUkk7QUFDRTtBQUNBO0FBVU47QUFDQTtBQVJJO0FBQ0k7QUFDQTtBQUNFO0FBVVY7QUFDQTtBQUNBO0FBUkk7QUFDSTtBQVVSO0FBQ0E7QUFDQTtBQVJJO0FBQ0U7QUFDQTtBQUNFO0FBVVI7QUFDQTtBQVJRO0FBQ0E7QUFDQTtBQUNBO0FBVVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkk7QUFDRTtBQVVOO0FBQ0E7QUFLSTtBQUNJO0FBQ0E7QUFIUjtBQUNBO0FBS0k7QUFDSTtBQUNBO0FBSFI7QUFDQTtBQUtJO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFIWjtBQUNBO0FBS1E7QUFIUjtBQUNBO0FBQ0E7QUFLSTtBQUNJO0FBQ0E7QUFIUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUNBO0FBQ0k7QUFIWjtBQUtRO0FBSFI7QUFLUTtBQUhSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLRTtBQUNFO0FBQ0E7QUFDRTtBQUhOO0FBS0k7QUFISjtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUhSO0FBQ0E7QUFLSTtBQUNJO0FBSFI7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUhSO0FBS0k7QUFDSTtBQUhSO0FBQ0E7QUFDQTtBQUtBO0FBSEE7QUFDQTtBQUNBO0FDNVRBLEFENlRBO0FDNVRBLEFENlRBO0FDNVRBLEFENlRBO0FDNVRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNsSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzd2REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FDTEE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFETTtBQUdOO0FBQ0E7QUFESTtBQUNFO0FBR047QUFDQTtBQURJO0FBQ0U7QUFDQTtBQUNFO0FBR1I7QUFDQTtBQURNO0FBR047QUFDQTtBQURJO0FBQ0U7QUFHTjtBQURNO0FBQ0U7QUFDRTtBQUNBO0FBR1Y7QUFDQTtBQURRO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvRUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBREE7QUFDSTtBQUNBO0FBQ0k7QUFHUjtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBRFE7QUFHUjtBQURRO0FBQ0E7QUFDQTtBQUdSO0FBRFE7QUFHUjtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFHWjtBQURRO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBR1I7QUFGWTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSVo7QUFDQTtBQUZZO0FBQ0E7QUFDQTtBQUNBO0FBSVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUZRO0FBQ0k7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBSUo7QUFDQTtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQU9oQjtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBT1I7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFPWjtBQUNBO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxRO0FBQ0E7QUFDQTtBQU9SO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBT1I7QUFDQTtBQUxJO0FBQ0k7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQU9SO0FBQ0E7QUFMSTtBQUNJO0FBQ0E7QUFPUjtBQUNBO0FBTEk7QUFDSTtBQUNJO0FBQ0E7QUFPWjtBQUxRO0FBT1I7QUFDQTtBQUxJO0FBQ0k7QUFPUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFGSjtBQUlRO0FBRlI7QUFDQTtBQUlRO0FBQ0E7QUFDSTtBQUZaO0FBQ0E7QUFJUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlRO0FBRlI7QUFDQTtBQUlRO0FBQ0k7QUFDSTtBQUZoQjtBQUlnQjtBQUZoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFGSjtBQUNBO0FBSVE7QUFDQTtBQUNBO0FBQ0k7QUFGWjtBQUlZO0FBRlo7QUFHZ0I7QUFEaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR2dCO0FBQ0E7QUFDSTtBQUNBO0FBRHBCO0FBR29CO0FBQ0k7QUFDQTtBQUR4QjtBQUNBO0FBR29CO0FBQ0k7QUFDQTtBQUR4QjtBQUNBO0FBSW9CO0FBQ0k7QUFDQTtBQUZ4QjtBQUNBO0FBSW9CO0FBQ0k7QUFDQTtBQUZ4QjtBQUNBO0FBQ0E7QUFDQTtBQUlZO0FBQ0k7QUFDQTtBQUZoQjtBQUlnQjtBQUZoQjtBQUNBO0FBQ0E7QUFJUTtBQUNBO0FBQ0k7QUFGWjtBQUNBO0FBSVE7QUFGUjtBQUNBO0FBSVE7QUFDQTtBQUZSO0FBSVE7QUFDSTtBQUNBO0FBRlo7QUFDQTtBQUNBO0FBSVE7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBRmhCO0FBSVk7QUFGWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUTtBQUZSO0FBSVE7QUFDQTtBQUZSO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFDQTtBQUlJO0FBRko7QUFJUTtBQUNJO0FBRlo7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0E7QUFDQTtBQUZSO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFGUjtBQUNBO0FBQ0E7QUFJSTtBQUZKO0FBSVE7QUFGUjtBQUlRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFGWjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRlI7QUFJUTtBQUNJO0FBRlo7QUFDQTtBQUNBO0FBSUk7QUFDSTtBQUZSO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBQ0E7QUFDQTtBQUZSO0FBSVE7QUFDQTtBQUNBO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFDQTtBQUZSO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFJUTtBQUNBO0FBRlI7QUFJUTtBQUNJO0FBQ0E7QUFDQTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFGSjtBQUNBO0FBQ0E7QUFJUTtBQUNBO0FBQ0k7QUFDQTtBQUZaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRlE7QUFDSTtBQUNBO0FBQ0E7QUFJWjtBQUNBO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFDSTtBQUlaO0FBRlE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUlaO0FBRlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGUTtBQUNJO0FBSVo7QUFDQTtBQUZRO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFJUjtBQUZZO0FBSVo7QUFGWTtBQUlaO0FBRlk7QUFJWjtBQUZRO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBRlk7QUFDQTtBQUlaO0FBQ0E7QUFGUTtBQUlSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNJO0FBSVo7QUFGWTtBQUlaO0FBRlk7QUFJWjtBQUZRO0FBSVI7QUFDQTtBQUNBO0FBRkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUlaO0FBQ0E7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUlSO0FBQ0E7QUFGSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFJWjtBQUZRO0FBQ0k7QUFJWjtBQUZZO0FBSVo7QUFGWTtBQUNJO0FBSWhCO0FBQ0E7QUFDQTtBQUZRO0FBSVI7QUFDQTtBQUZJO0FBQ0k7QUFDQTtBQUlSO0FBRlE7QUFJUjtBQUNBO0FBRkk7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUloQjtBQUZnQjtBQUloQjtBQUNBO0FBQ0E7QUFDQTtBQUZJO0FBSUo7QUFDQTtBQUpRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQU1oQjtBQUNBO0FBSlk7QUFNWjtBQUNBO0FBQ0E7QUFKSTtBQUNJO0FBQ0E7QUFDSTtBQU1aO0FBQ0E7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUpRO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFNWjtBQUNBO0FBSlE7QUFDQTtBQU1SO0FBQ0E7QUFIUTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBS2hCO0FBQ0E7QUFIWTtBQUNJO0FBQ0E7QUFDQTtBQUtoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIUTtBQUNJO0FBQ0E7QUFDQTtBQUtaO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUtaO0FBSFE7QUFDSTtBQUtaO0FBQ0E7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNJO0FBS1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBS1I7QUFIUTtBQUNJO0FBS1o7QUFDQTtBQUhZO0FBS1o7QUFIZ0I7QUFLaEI7QUFIb0I7QUFDQTtBQUNBO0FBS3BCO0FBQ0E7QUFDQTtBQUhvQjtBQUNBO0FBQ0E7QUFLcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhRO0FBQ0k7QUFLWjtBQUNBO0FBSFk7QUFLWjtBQUhnQjtBQUtoQjtBQUhvQjtBQUtwQjtBQUh3QjtBQUNBO0FBQ0E7QUFLeEI7QUFDQTtBQUNBO0FBSHdCO0FBQ0E7QUFDQTtBQUt4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhRO0FBQ0k7QUFLWjtBQUNBO0FBSFk7QUFLWjtBQUhnQjtBQUtoQjtBQUhvQjtBQUtwQjtBQUh3QjtBQUNBO0FBQ0E7QUFLeEI7QUFDQTtBQUNBO0FBSHdCO0FBQ0E7QUFDQTtBQUt4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUtaO0FBSFE7QUFLUjtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUtaO0FBQ0E7QUFIUTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBS1o7QUFIUTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFLaEI7QUFDQTtBQUNBO0FBSFE7QUFLUjtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBTFE7QUFDQTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0E7QUFDQTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFDSTtBQU9aO0FBQ0E7QUFMUTtBQUNJO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUxZO0FBT1o7QUFDQTtBQUxRO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFPWjtBQUNBO0FBTFE7QUFPUjtBQUxRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBT3BCO0FBQ0E7QUFMWTtBQUNBO0FBT1o7QUFDQTtBQUxRO0FBQ0k7QUFPWjtBQUxRO0FBQ0E7QUFPUjtBQUxRO0FBT1I7QUFMUTtBQUNBO0FBT1I7QUFDQTtBQUNBO0FBSkk7QUFNSjtBQUNBO0FBTlE7QUFDQTtBQVFSO0FBTlE7QUFRUjtBQU5RO0FBQ0E7QUFRUjtBQU5RO0FBQ0k7QUFDQTtBQVFaO0FBQ0E7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNBO0FBUVI7QUFOUTtBQUNBO0FBUVI7QUFDQTtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBQ0E7QUFOUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQVFSO0FBQ0E7QUFDQTtBQU5JO0FBQ0k7QUFRUjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQU5JO0FBQ0k7QUFDSTtBQVFaO0FBQ0E7QUFOUTtBQUNJO0FBQ0E7QUFRWjtBQUNBO0FBTlE7QUFRUjtBQUNBO0FBQ0E7QUFOSTtBQUNJO0FBQ0E7QUFDQTtBQVFSO0FBQ0E7QUFOSTtBQUNJO0FBUVI7QUFDQTtBQUNBO0FBTkk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BqQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBR0k7QUFDRTtBQUROO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUROO0FBQ0E7QUFHSTtBQUNFO0FBRE47QUFHTTtBQUNFO0FBQ0U7QUFDQTtBQURWO0FBQ0E7QUFHUTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekRBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFBTTtBQUNFO0FBRVI7QUFDQTtBQUFNO0FBRU47QUFBTTtBQUNBO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQU07QUFDQTtBQUVOO0FBQU07QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUVSO0FBQ0E7QUFBTTtBQUNBO0FBRU47QUFBTTtBQUNBO0FBRU47QUFBTTtBQUNFO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUNBO0FBRUo7QUFDQTtBQUFFO0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekVBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUVJO0FBQUo7QUFJSTtBQUNFO0FBRk47QUFDQTtBQUlJO0FBQ0U7QUFGTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVE7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFBUjtBQUVRO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUFoQjtBQUVZO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUFwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQVo7QUFFWTtBQUFaO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFJUTtBQUNBO0FBQ0k7QUFGWjtBQUNBO0FBSVE7QUFGUjtBQUNBO0FBSUk7QUFDSTtBQUNJO0FBQ0k7QUFGaEI7QUFDQTtBQUlRO0FBQ0E7QUFDQTtBQUNJO0FBRlo7QUFLWTtBQUhaO0FBS1E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUhaO0FBQ0E7QUFNSTtBQUpKO0FBTVE7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBSlo7QUFDQTtBQU1JO0FBSko7QUFDQTtBQU1RO0FBSlI7QUFNUTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBSmhCO0FBQ0E7QUFDQTtBQU9RO0FBQ0E7QUFDSTtBQUNJO0FBTGhCO0FBQ0E7QUFPWTtBQUxaO0FBT1k7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFMeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU0k7QUFDSTtBQUNJO0FBQ0E7QUFQWjtBQUNBO0FBU1E7QUFDSTtBQUNBO0FBQ0E7QUFQWjtBQUNBO0FBU1E7QUFDSTtBQUNBO0FBQ0k7QUFQaEI7QUFDQTtBQUNBO0FBQ0E7QUFTSTtBQUNJO0FBQ0k7QUFQWjtBQVNRO0FBQ0E7QUFDSTtBQVBaO0FBVVk7QUFDQTtBQUNJO0FBUmhCO0FBQ0E7QUFVUTtBQUNBO0FBQ0E7QUFSUjtBQUNBO0FBV0k7QUFDSTtBQUNJO0FBVFo7QUFXUTtBQUNBO0FBQ0k7QUFUWjtBQVdZO0FBQ0E7QUFDSTtBQVRoQjtBQUNBO0FBV1E7QUFDQTtBQUNBO0FBVFI7QUFDQTtBQVdJO0FBQ0k7QUFDSTtBQVRaO0FBV1E7QUFDQTtBQUNJO0FBVFo7QUFXWTtBQUNBO0FBQ0k7QUFUaEI7QUFDQTtBQUNBO0FBV1E7QUFDQTtBQVRSO0FBQ0E7QUFXSTtBQUNJO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFXUTtBQUNJO0FBVFo7QUFXWTtBQVRaO0FBV1k7QUFUWjtBQUNBO0FBQ0E7QUFZSTtBQUNJO0FBQ0E7QUFDQTtBQVZSO0FBQ0E7QUFZSTtBQUNJO0FBQ0k7QUFWWjtBQUNBO0FBQ0E7QUFZSTtBQUNJO0FBQ0E7QUFDSTtBQVZaO0FBQ0E7QUFDQTtBQVlJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyVEE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ1E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNaO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0Y7QUFDQTtBQUVBO0FBQ0U7QUFBRjtBQUVFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFBSjtBQUVJO0FBQUo7QUFFSTtBQUNBO0FBQ0E7QUFBSjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQUo7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUFKO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFKO0FBRUk7QUFDRTtBQUFOO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFDQTtBQUVNO0FBQ0E7QUFDQTtBQUNBO0FBQU47QUFDQTtBQUNBO0FBRUU7QUFDRTtBQUFKO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFBTjtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUVFO0FBQ0U7QUFDRTtBQUFOO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFDQTtBQUVJO0FBQ0E7QUFBSjtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFBTjtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQUo7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEhBO0FBQ0E7QUFDQztBQUNHO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNZO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDTTtBQUNBO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFBTTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDRTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBQ0E7QUFFRTtBQUNWO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ1Y7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JGQTtBQUNBO0FBQ0E7QUFDRTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDSjtBQUNBO0FBQ0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDRTtBQUNGO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0U7QUFDUjtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDSjtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDRjtBQUNFO0FBQ0U7QUFDSTtBQUNSO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNRO0FBQ0U7QUFDRTtBQUNaO0FBQ1U7QUFDVjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFHRTtBQUNBO0FBQ0U7QUFESjtBQUdFO0FBREY7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNFO0FBQ0U7QUFESjtBQUdFO0FBREY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0U7QUFDRTtBQUNBO0FBQ0U7QUFETjtBQUNBO0FBQ0E7QUFHUTtBQUNBO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0E7QUFDRTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHRTtBQUNBO0FBREY7QUFDQTtBQUNBO0FBR0E7QUFEQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDSjtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ047QUFDQTtBQUVFO0FBQ0U7QUFBSjtBQUVJO0FBQUo7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUFFO0FBQ0U7QUFFSjtBQUFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFFUjtBQUNBO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUNSO0FBQ007QUFDTjtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ047QUFBUTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUVkO0FBQ0E7QUFDQTtBQUFRO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREU7QUFDRTtBQUdKO0FBREk7QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUNBO0FBR1Y7QUFDQTtBQURNO0FBR047QUFESTtBQUdKO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUhFO0FBQ0U7QUFLSjtBQUhFO0FBQ0E7QUFLRjtBQUhFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ0E7QUFLUjtBQUNBO0FBRk07QUFDRTtBQUNBO0FBSVI7QUFDQTtBQUZNO0FBQ0U7QUFDQTtBQUlSO0FBQ0E7QUFGTTtBQUNFO0FBQ0E7QUFJUjtBQUNBO0FBQ0E7QUFDQTtBQUZFO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUlSO0FBRk07QUFJTjtBQUNBO0FBRkU7QUFJRjtBQUZFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUlSO0FBQ0E7QUFDQTtBQUxVO0FBQ0k7QUFPZDtBQU5VO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBUWhCO0FBQ0E7QUFDQTtBQUxVO0FBT1Y7QUFMVTtBQU9WO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMRTtBQUNBO0FBQ0E7QUFDRTtBQU9KO0FBTEk7QUFDQTtBQUNFO0FBT047QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0U7QUFDQTtBQUNFO0FBT0o7QUFMRTtBQU9GO0FBTEU7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPTjtBQUNBO0FBTEU7QUFDRTtBQU9KO0FBTEU7QUFDQTtBQU9GO0FBQ0E7QUFMQTtBQUNFO0FBQ0U7QUFPSjtBQUxFO0FBQ0E7QUFPRjtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFQRTtBQUNFO0FBU0o7QUFQRTtBQUNFO0FBU0o7QUFDQTtBQVBFO0FBQ0U7QUFTSjtBQVBFO0FBU0Y7QUFDQTtBQVBFO0FBQ0U7QUFTSjtBQVBFO0FBQ0U7QUFDQTtBQUNBO0FBU0o7QUFDQTtBQVBFO0FBU0Y7QUFDQTtBQVBFO0FBQ0U7QUFDQTtBQVNKO0FBUk07QUFDQTtBQUNFO0FBVVI7QUFSVTtBQUNFO0FBVVo7QUFDQTtBQVJVO0FBVVY7QUFSUTtBQVVSO0FBQ0E7QUFSTTtBQUNBO0FBVU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEU7QUFDQTtBQUNFO0FBV0o7QUFDQTtBQVRFO0FBQ0U7QUFXSjtBQUNBO0FBVEU7QUFXRjtBQVRBO0FBV0E7QUFDQTtBQVhFO0FBQ0U7QUFhSjtBQVhFO0FBQ0E7QUFhRjtBQVhFO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQWFOO0FBQ0E7QUFDQTtBQVhFO0FBQ0U7QUFhSjtBQVhFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBYU47QUFDQTtBQUNBO0FBZFE7QUFDSTtBQWdCWjtBQWZRO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBaUJkO0FBQ0E7QUFDQTtBQUNBO0FBZFE7QUFDQTtBQWdCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZkU7QUFDRTtBQWlCSjtBQWZJO0FBQ0E7QUFDRTtBQWlCTjtBQWZJO0FBaUJKO0FBQ0E7QUFmQTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBaUJOO0FBQ0E7QUFmSTtBQUNFO0FBQ0U7QUFDRTtBQWlCVjtBQWZRO0FBQ0U7QUFpQlY7QUFmUTtBQWlCUjtBQUNBO0FBZk07QUFDRTtBQWlCUjtBQUNBO0FBZk07QUFDQTtBQUNBO0FBaUJOO0FBQ0E7QUFDQTtBQWZFO0FBaUJGO0FBQ0E7QUFDQTtBQUNBO0FBZkE7QUFpQkE7QUFDQTtBQWpCRTtBQUNFO0FBbUJKO0FBQ0E7QUFqQkU7QUFDQTtBQW1CRjtBQWpCRTtBQUNBO0FBQ0U7QUFDQTtBQW1CSjtBQWxCTTtBQUNBO0FBQ0U7QUFDRTtBQW9CVjtBQWxCVTtBQW9CVjtBQUNBO0FBbEJNO0FBQ0E7QUFvQk47QUFDQTtBQUNBO0FBbkJFO0FBcUJGO0FBbkJBO0FBQ0U7QUFDRTtBQXFCSjtBQW5CRTtBQUNBO0FBcUJGO0FBbkJFO0FBcUJGO0FBbkJFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQXFCTjtBQUNBO0FBQ0E7QUF0QlE7QUFDSTtBQXdCWjtBQXZCUTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQXlCZDtBQUNBO0FBQ0E7QUFDQTtBQXRCUTtBQUNBO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF2QkU7QUF5QkY7QUFDQTtBQXZCQTtBQUNFO0FBQ0E7QUFDRTtBQXlCSjtBQUNBO0FBdEJFO0FBQ0E7QUFDQTtBQXdCRjtBQUNBO0FBQ0E7QUF0QkU7QUFDRTtBQUNFO0FBQ0U7QUF3QlI7QUF0QlE7QUFDQTtBQXdCUjtBQXRCUTtBQXdCUjtBQUNBO0FBQ0E7QUF0Qkk7QUFDRTtBQUNFO0FBd0JSO0FBQ0E7QUFDQTtBQUNBO0FBdEJRO0FBQ0E7QUF3QlI7QUFDQTtBQUNBO0FBQ0E7QUF0QlE7QUF3QlI7QUFDQTtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQXNCSjtBQXBCRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBc0JaO0FBQ0E7QUFwQlE7QUFDRTtBQXNCVjtBQUNBO0FBcEJNO0FBQ0U7QUFzQlI7QUFDQTtBQUNBO0FBcEJFO0FBQ0U7QUFzQko7QUFwQkU7QUFzQkY7QUFwQkE7QUFDRTtBQUNBO0FBQ0U7QUFzQko7QUFwQkU7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQXNCSjtBQXBCRTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFzQk47QUFDQTtBQUNBO0FBcEJFO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQXNCTjtBQUNBO0FBQ0E7QUFwQkU7QUFDRTtBQXNCSjtBQXBCRTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBc0JaO0FBQ0E7QUFwQlE7QUFDRTtBQXNCVjtBQUNBO0FBcEJNO0FBQ0U7QUFzQlI7QUFDQTtBQUNBO0FBcEJFO0FBQ0U7QUFzQko7QUFwQkU7QUFzQkY7QUFDQTtBQXBCQTtBQXNCQTtBQUNBO0FBdEJFO0FBd0JGO0FBdkJJO0FBQ0U7QUFDQTtBQUNFO0FBeUJSO0FBQ0E7QUFDQTtBQUNBO0FBdkJFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBeUJOO0FBeEJRO0FBQ0U7QUFDQTtBQUNFO0FBMEJaO0FBQ0E7QUFDQTtBQXhCUTtBQUNBO0FBQ0U7QUEwQlY7QUFDQTtBQUNBO0FBQ0E7QUF4QkU7QUFDRTtBQTBCSjtBQXhCRTtBQUNBO0FBMEJGO0FBQ0E7QUF4QkE7QUFDRTtBQUNFO0FBMEJKO0FBeEJJO0FBQ0E7QUEwQko7QUF6Qk07QUFDRTtBQTJCUjtBQXpCUTtBQUNBO0FBMkJSO0FBQ0E7QUFDQTtBQXpCSTtBQUNJO0FBQ0E7QUFDQTtBQUNGO0FBQ0k7QUFDQTtBQTJCVjtBQXpCTTtBQTJCTjtBQTFCUTtBQUNBO0FBNEJSO0FBQ0E7QUFDQTtBQXpCRTtBQTJCRjtBQUNBO0FBeEJBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQWdCRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvMkJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0o7QUFDVTtBQUNWO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDQTtBQUdBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBQ007QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDRjtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ047QUFDQTtBQUNFO0FBQ0U7QUFDRTtBQUNOO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDRjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUVJO0FBQUo7QUFDTTtBQUNOO0FBQ0k7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBRUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSjtBQUNBO0FBR0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBRE47QUFFUTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBR0k7QUFDRTtBQUNBO0FBRE47QUFDQTtBQUdJO0FBQ0E7QUFESjtBQUNBO0FBS0k7QUFDQTtBQUhKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBSE47QUFLSTtBQUhKO0FBQ0E7QUFNSTtBQUpKO0FBS007QUFITjtBQUtJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFITjtBQUtNO0FBQ0E7QUFITjtBQUtJO0FBSEo7QUFDQTtBQUNBO0FBTUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFKTjtBQUtRO0FBQ0E7QUFIUjtBQUtRO0FBQ0E7QUFIUjtBQUtRO0FBQ0E7QUFIUjtBQUtRO0FBQ0E7QUFDRTtBQUhWO0FBS1U7QUFIVjtBQUNBO0FBQ0E7QUFLSTtBQUNFO0FBQ0E7QUFITjtBQUtJO0FBQ0E7QUFISjtBQUNBO0FBQ0E7QUFPSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFMTjtBQU1RO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUpaO0FBQ0E7QUFDQTtBQVFRO0FBTlI7QUFPVTtBQUNFO0FBQ0E7QUFMWjtBQU9ZO0FBQ0E7QUFMWjtBQUNBO0FBQ0E7QUFDQTtBQVVJO0FBQ0E7QUFDQTtBQUNBO0FBUko7QUFDQTtBQUNBO0FBV0k7QUFDQTtBQUNBO0FBQ0E7QUFUSjtBQVdJO0FBQ0U7QUFDRTtBQVRSO0FBV007QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFUVjtBQVdVO0FBVFY7QUFDQTtBQVdNO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFUUjtBQVdNO0FBQ0E7QUFUTjtBQUNBO0FBV0k7QUFDRTtBQVROO0FBVVE7QUFSUjtBQVNVO0FBQ0U7QUFDQTtBQUNBO0FBUFo7QUFDQTtBQUNBO0FBVVE7QUFSUjtBQVNVO0FBQ0U7QUFDQTtBQUNBO0FBUFo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBV0k7QUFDRTtBQUNBO0FBVE47QUFXSTtBQUNBO0FBVEo7QUFDQTtBQVlJO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBVk47QUFZSTtBQUNFO0FBQ0E7QUFWTjtBQVlJO0FBQ0E7QUFWSjtBQUNBO0FBYUU7QUFDQTtBQUNFO0FBWEo7QUFDQTtBQWFFO0FBQ0E7QUFYRjtBQWFBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFYTjtBQUNBO0FBYUU7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFYUjtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBWkY7QUFhSTtBQUNFO0FBQ0U7QUFYUjtBQUNBO0FBQ0E7QUFhRTtBQVhGO0FBWUk7QUFDRTtBQVZOO0FBQ0E7QUFZSTtBQUNBO0FBQ0U7QUFDQTtBQVZOO0FBWUk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQVZWO0FBQ0E7QUFDQTtBQVlJO0FBVko7QUFXTTtBQUNFO0FBVFI7QUFDQTtBQUNBO0FBQ0E7QUFVSTtBQUNFO0FBUk47QUFVSTtBQUNBO0FBUko7QUFTTTtBQVBOO0FBU0k7QUFDQTtBQUNFO0FBQ0E7QUFQTjtBQVNJO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFQVjtBQUNBO0FBQ0E7QUFTSTtBQUNBO0FBQ0E7QUFDQTtBQVBKO0FBUU07QUFDRTtBQU5SO0FBQ0E7QUFRSTtBQU5KO0FBQ0E7QUFRRTtBQUNFO0FBQ0U7QUFOTjtBQUNBO0FBUUU7QUFDRTtBQU5KO0FBUUU7QUFORjtBQUNBO0FBUUE7QUFDRTtBQUNFO0FBTko7QUFRRTtBQUNFO0FBTko7QUFRRTtBQUNBO0FBTkY7QUFRRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFOTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUU7QUFORjtBQUNBO0FBUUE7QUFDRTtBQUNBO0FBQ0U7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBQ0E7QUFRRTtBQU5GO0FBQ0E7QUFDQTtBQVFBO0FBQ0U7QUFDRTtBQU5KO0FBUUU7QUFDRTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFRSTtBQU5KO0FBUUk7QUFOSjtBQVFJO0FBTko7QUFDQTtBQVFFO0FBTkY7QUFDQTtBQVFBO0FBQ0U7QUFORjtBQUNBO0FBUUE7QUFDRTtBQU5GO0FBQ0E7QUFDQTtBQVFBO0FBQ0U7QUFORjtBQUNBO0FBQ0E7QUFRQTtBQUNFO0FBTkY7QUFDQTtBQVFBO0FBQ0U7QUFORjtBQUNBO0FBUUE7QUFDRTtBQU5GO0FBQ0E7QUFRQTtBQUNFO0FBTkY7QUFDQTtBQVFBO0FBQ0U7QUFORjtBQUNBO0FBUUE7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQU5KO0FBUUk7QUFDRTtBQU5OO0FBQ0E7QUFRSTtBQU5KO0FBQ0E7QUFRRTtBQU5GO0FBQ0E7QUFRQTtBQU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvaUJBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNFO0FBQ0o7QUFDVTtBQUNWO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDQTtBQUdBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQVdJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFDQTtBQVdJO0FBQ0E7QUFUSjtBQVdRO0FBQ0E7QUFDSTtBQVRaO0FBQ0E7QUFTWTtBQUNBO0FBQ0k7QUFDQTtBQVBoQjtBQUNBO0FBQ0E7QUFDQTtBQVNJO0FBQ0k7QUFQUjtBQUNBO0FBU0k7QUFDSTtBQUNBO0FBQ0k7QUFQWjtBQUNBO0FBU1E7QUFQUjtBQUNBO0FBU0k7QUFQSjtBQUNBO0FBU0E7QUFQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQW9CO0FBRTVCO0FBRFE7QUFBb0I7QUFJNUI7QUFIUTtBQUFvQjtBQU01QjtBQUxRO0FBQW9CO0FBUTVCO0FBQ0E7QUFQUTtBQUNBO0FBQ0E7QUFDQTtBQVNSO0FBUFE7QUFDQTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFDSTtBQVNaO0FBUFk7QUFTWjtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFTSjtBQUNBO0FBQ0E7QUFWUTtBQVlSO0FBQ0E7QUFWSTtBQUNJO0FBQ0k7QUFZWjtBQVZRO0FBWVI7QUFDQTtBQVRJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQUNBO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFUSTtBQVdKO0FBVFE7QUFDQTtBQUNJO0FBQ0E7QUFXWjtBQVRZO0FBQ0E7QUFDQTtBQVdaO0FBQ0E7QUFUUTtBQVdSO0FBQ0E7QUFUSTtBQUNJO0FBQ0E7QUFXUjtBQUNBO0FBVEk7QUFXSjtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBQ0k7QUFDQTtBQVdSO0FBQ0E7QUFDQTtBQVRBO0FBQ0E7QUFDQTtBQUNBO0FBV0E7QUFUQTtBQVdBO0FBVEE7QUFDSTtBQUNJO0FBV1I7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBQ0k7QUFXUjtBQUNBO0FBQ0E7QUFUQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdKO0FBVEk7QUFXSjtBQVRJO0FBQ0E7QUFDQTtBQVdKO0FBVEk7QUFDQTtBQVdKO0FBVEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdKO0FBQ0E7QUFDQTtBQVRBO0FBQ0k7QUFHQTtBQUNBO0FBU0o7QUFDQTtBQUNBO0FBUEE7QUFDSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQUNJO0FBU1I7QUFDQTtBQVBJO0FBQ0k7QUFTUjtBQUNBO0FBUEk7QUFDSTtBQVNSO0FBQ0E7QUFQSTtBQVNKO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQVRJO0FBQ0k7QUFXUjtBQUNBO0FBVEk7QUFDSTtBQVdSO0FBQ0E7QUFUSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBV1o7QUFDQTtBQVRJO0FBV0o7QUFDQTtBQUNBO0FBVEE7QUFXQTtBQUNBO0FBWEk7QUFDSTtBQWFSO0FBWEk7QUFDSTtBQWFSO0FBWEk7QUFhSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQUNJO0FBQ0k7QUFhUjtBQVhJO0FBQ0E7QUFDQTtBQWFKO0FBWEk7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBYWhCO0FBQ0E7QUFDQTtBQVhJO0FBYUo7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQWJJO0FBQ0k7QUFlUjtBQUNBO0FBYkk7QUFDSTtBQWVSO0FBQ0E7QUFiSTtBQUNJO0FBZVI7QUFiUTtBQWVSO0FBQ0E7QUFiSTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBZVo7QUFDQTtBQWJRO0FBZVI7QUFDQTtBQWJJO0FBZUo7QUFDQTtBQUNBO0FBYkE7QUFDSTtBQUNBO0FBQ0k7QUFlUjtBQUNBO0FBYkk7QUFDQTtBQUNBO0FBZUo7QUFiSTtBQUNJO0FBQ0E7QUFlUjtBQUNBO0FBYkk7QUFlSjtBQUNBO0FBQ0E7QUFDQTtBQWJBO0FBZUE7QUFiUTtBQUNBO0FBQ0k7QUFlWjtBQUNBO0FBYlE7QUFDSTtBQWVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExQkk7QUE0Qko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXJCSTtBQXVCSjtBQXJCQTtBQUNJO0FBQ0k7QUF1QlI7QUFyQkk7QUF1Qko7QUF0QlE7QUFDSTtBQXdCWjtBQUNBO0FBdEJJO0FBd0JKO0FBQ0E7QUF0QkE7QUF3QkE7QUFDQTtBQXhCSTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQTBCQTtBQUNBO0FBMUJJO0FBQ0k7QUE0QlI7QUExQkk7QUFDSTtBQTRCUjtBQTFCSTtBQTRCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0E7QUFDSTtBQTBCUjtBQUNBO0FBQ0E7QUFDQTtBQXhCSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQTBCWjtBQXhCWTtBQTBCWjtBQXhCWTtBQTBCWjtBQXhCWTtBQTBCWjtBQUNBO0FBeEJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQTBCWjtBQUNBO0FBeEJJO0FBQ0k7QUFDSTtBQTBCWjtBQUNBO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBQ0E7QUF4QkE7QUEwQkE7QUF4Qkk7QUFDQTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0k7QUEwQlI7QUF4QlE7QUEwQlI7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBMEJaO0FBeEJZO0FBMEJaO0FBeEJZO0FBMEJaO0FBeEJZO0FBMEJaO0FBQ0E7QUF4Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBMEJaO0FBQ0E7QUFDQTtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUFDQTtBQUNBO0FBeEJJO0FBQ0k7QUFDSTtBQUNJO0FBMEJoQjtBQUNBO0FBeEJRO0FBMEJSO0FBQ0E7QUFDQTtBQXhCUTtBQUNJO0FBQ0k7QUEwQmhCO0FBQ0E7QUFDQTtBQXhCUTtBQTBCUjtBQUNBO0FBQ0E7QUF4QlE7QUFDSTtBQTBCWjtBQUNBO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0E7QUFDSTtBQTBCUjtBQXhCSTtBQUNBO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBMEJaO0FBeEJZO0FBMEJaO0FBQ0E7QUFDQTtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUFDQTtBQUNBO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUEwQko7QUF4Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUEwQlo7QUF2Qlk7QUF5Qlo7QUF0Qlk7QUF3Qlo7QUFDQTtBQXRCSTtBQXdCSjtBQUNBO0FBdEJBO0FBQ0k7QUFDQTtBQUNJO0FBd0JSO0FBQ0E7QUF0Qkk7QUFDQTtBQXdCSjtBQXRCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQXdCWjtBQXJCWTtBQXVCWjtBQXBCWTtBQXNCWjtBQUNBO0FBcEJJO0FBc0JKO0FBQ0E7QUFwQkE7QUFDSTtBQUNJO0FBc0JSO0FBQ0E7QUFDQTtBQXBCSTtBQUNJO0FBc0JSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQkk7QUFDSTtBQXNCUjtBQUNBO0FBcEJJO0FBQ0k7QUFzQlI7QUFwQkk7QUFDSTtBQUNJO0FBc0JaO0FBQ0E7QUFwQlE7QUFDSTtBQXNCWjtBQXBCUTtBQUNJO0FBQ0k7QUFzQmhCO0FBQ0E7QUFwQlk7QUFDSTtBQXNCaEI7QUFwQlk7QUFDSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBc0J4QjtBQUNBO0FBcEJnQjtBQUNJO0FBc0JwQjtBQUNBO0FBcEJnQjtBQUNJO0FBQ0k7QUFDQTtBQXNCeEI7QUFDQTtBQXBCZ0I7QUFzQmhCO0FBcEJnQjtBQXNCaEI7QUFDQTtBQXBCWTtBQXNCWjtBQUNBO0FBcEJRO0FBc0JSO0FBQ0E7QUFDQTtBQUNBO0FBcEJBO0FBQ0k7QUFDSTtBQXNCUjtBQXBCWTtBQXNCWjtBQUNBO0FBcEJJO0FBc0JKO0FBQ0E7QUFwQkE7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBc0JaO0FBcEJRO0FBQ0k7QUFzQlo7QUFwQlE7QUFDQTtBQXNCUjtBQXBCWTtBQXNCWjtBQXBCZ0I7QUFDSTtBQUNJO0FBc0J4QjtBQXBCNEI7QUFDSTtBQXNCaEM7QUFwQjRCO0FBc0I1QjtBQUNBO0FBQ0E7QUFDQTtBQXBCZ0I7QUFDSTtBQUNJO0FBc0J4QjtBQXBCb0I7QUFDSTtBQXNCeEI7QUFwQm9CO0FBQ0E7QUFzQnBCO0FBcEJ3QjtBQUNJO0FBQ0k7QUFDSTtBQXNCcEM7QUFwQndDO0FBQ0k7QUFzQjVDO0FBcEJ3QztBQXNCeEM7QUFDQTtBQUNBO0FBQ0E7QUFwQjRCO0FBc0I1QjtBQXBCZ0M7QUFzQmhDO0FBQ0E7QUFwQjRCO0FBc0I1QjtBQUNBO0FBcEJ3QjtBQXNCeEI7QUFDQTtBQUNBO0FBQ0E7QUFwQlk7QUFzQlo7QUFDQTtBQUNBO0FBQ0E7QUFwQkE7QUFDSTtBQUNBO0FBQ0k7QUFzQlI7QUFwQkk7QUFDSTtBQXNCUjtBQXBCSTtBQUNBO0FBQ0k7QUFzQlI7QUFwQkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFzQko7QUFyQlE7QUF1QlI7QUFDQTtBQXJCSTtBQXVCSjtBQXRCUTtBQXdCUjtBQXRCSTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQXdCWjtBQUNBO0FBdkJZO0FBeUJaO0FBQ0E7QUFDQTtBQXZCSTtBQXlCSjtBQXhCUTtBQUNBO0FBQ0k7QUEwQlo7QUF4QlE7QUFDSTtBQTBCWjtBQXpCZ0I7QUEyQmhCO0FBQ0E7QUF6Qlk7QUFDQTtBQUNJO0FBQ0E7QUEyQmhCO0FBMUJvQjtBQUNBO0FBNEJwQjtBQUNBO0FBMUJZO0FBNEJaO0FBM0JnQjtBQTZCaEI7QUE1Qm9CO0FBOEJwQjtBQTVCZ0I7QUFDQTtBQThCaEI7QUE1Qlk7QUFDSTtBQThCaEI7QUE3Qm9CO0FBK0JwQjtBQUNBO0FBN0JZO0FBK0JaO0FBOUJnQjtBQWdDaEI7QUFDQTtBQTlCZ0I7QUFnQ2hCO0FBQ0E7QUE5QlE7QUFnQ1I7QUEvQlk7QUFDQTtBQWlDWjtBQUNBO0FBL0JZO0FBaUNaO0FBQ0E7QUFDQTtBQS9CSTtBQUNBO0FBaUNKO0FBaENRO0FBa0NSO0FBaENJO0FBQ0E7QUFDSTtBQWtDUjtBQWhDSTtBQWtDSjtBQUNBO0FBaENBO0FBa0NBO0FBQ0E7QUFsQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQW9DUjtBQWxDSTtBQUNJO0FBQ0E7QUFvQ1I7QUFsQ1E7QUFDSTtBQUNBO0FBQ0k7QUFvQ2hCO0FBbENZO0FBb0NaO0FBakNRO0FBQ0E7QUFtQ1I7QUFqQ0k7QUFtQ0o7QUFDQTtBQWpDQTtBQUNJO0FBbUNKO0FBQ0E7QUFoQ0E7QUFDSTtBQUNBO0FBQ0k7QUFrQ1I7QUFoQ0k7QUFDQTtBQUNJO0FBa0NSO0FBaENJO0FBa0NKO0FBaENJO0FBQ0E7QUFDSTtBQUNBO0FBa0NSO0FBQ0E7QUFoQ0k7QUFDSTtBQWtDUjtBQUNBO0FBaENJO0FBQ0k7QUFrQ1I7QUFDQTtBQWhDSTtBQUNBO0FBQ0E7QUFrQ0o7QUFoQ0k7QUFDSTtBQWtDUjtBQUNBO0FBaENJO0FBa0NKO0FBQ0E7QUFDQTtBQWhDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBa0NaO0FBaENRO0FBa0NSO0FBQ0E7QUFoQ0k7QUFrQ0o7QUFDQTtBQUNBO0FBaENBO0FBQ0k7QUFrQ0o7QUFDQTtBQUNBO0FBOUJBO0FBQ0k7QUFDQTtBQUNJO0FBZ0NSO0FBQ0E7QUE5Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFnQ1o7QUFDQTtBQTlCSTtBQWdDSjtBQUNBO0FBQ0E7QUE3QkE7QUFDSTtBQUNBO0FBQ0k7QUErQlI7QUE3Qkk7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUErQlo7QUFDQTtBQUNBO0FBN0JJO0FBK0JKO0FBQ0E7QUFDQTtBQUNBO0FBNUJBO0FBQ0k7QUFDQTtBQUNJO0FBOEJSO0FBNUJJO0FBQ0E7QUFDSTtBQThCUjtBQTVCSTtBQUNBO0FBQ0E7QUFDSTtBQThCUjtBQUNBO0FBNUJJO0FBQ0k7QUE4QlI7QUFDQTtBQTVCSTtBQUNJO0FBOEJSO0FBQ0E7QUE1Qkk7QUFHSTtBQTRCUjtBQUNBO0FBMUJJO0FBNEJKO0FBQ0E7QUFDQTtBQUNBO0FBekJBO0FBQ0k7QUFDQTtBQUNJO0FBMkJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekJJO0FBQ0k7QUEyQlI7QUF6Qkk7QUEyQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDQTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDSTtBQUNJO0FBMEJaO0FBeEJRO0FBMEJSO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNBO0FBQ0k7QUEwQlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCSTtBQUNJO0FBMEJSO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0E7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBQ0k7QUFDSTtBQTBCWjtBQXhCUTtBQTBCUjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNBO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBQ0k7QUEwQlI7QUF4QlE7QUEwQlI7QUFDQTtBQXhCSTtBQUNBO0FBQ0E7QUFDQTtBQTBCSjtBQXhCSTtBQUNJO0FBQ0k7QUFDQTtBQTBCWjtBQUNBO0FBeEJRO0FBQ0E7QUEwQlI7QUFDQTtBQXhCSTtBQUNBO0FBMEJKO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQXhCQTtBQUNJO0FBQ0k7QUEwQlI7QUF4Qkk7QUFDSTtBQTBCUjtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBQ0k7QUFDSTtBQTBCWjtBQUNBO0FBeEJRO0FBMEJSO0FBQ0E7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDSTtBQTBCUjtBQXhCSTtBQUNJO0FBMEJSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDQTtBQUNJO0FBQ0k7QUEwQlo7QUFDQTtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNJO0FBMEJSO0FBQ0E7QUF4Qkk7QUFDQTtBQTBCSjtBQXhCSTtBQTBCSjtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0k7QUEwQlI7QUF4Qkk7QUEwQko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4QkE7QUFDSTtBQUNJO0FBMEJSO0FBeEJJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEwQko7QUFDQTtBQUNBO0FBeEJBO0FBQ0k7QUFDSTtBQTBCUjtBQUNBO0FBeEJJO0FBMEJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRCQTtBQUNJO0FBQ1E7QUF3Qlo7QUF0QlE7QUF3QlI7QUF0Qkk7QUFDSTtBQUNJO0FBQ0E7QUF3Qlo7QUF0QlE7QUF3QlI7QUFDQTtBQXRCSTtBQXdCSjtBQUNBO0FBdEJBO0FBQ0k7QUFDUTtBQXdCWjtBQXRCUTtBQXdCUjtBQXRCSTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUF3Qlo7QUF0QlE7QUF3QlI7QUFDQTtBQXRCSTtBQXdCSjtBQUNBO0FBQ0E7QUF0QkE7QUFDSTtBQUNBO0FBd0JKO0FBQ0E7QUF0QkE7QUF3QkE7QUFDQTtBQXhCSTtBQUNJO0FBMEJSO0FBeEJJO0FBMEJKO0FBQ0E7QUF4QkE7QUEwQkE7QUFDQTtBQUNBO0FBM0JJO0FBQ0E7QUFDSTtBQTZCUjtBQTNCUTtBQUNBO0FBQ0E7QUFDSTtBQTZCWjtBQUNBO0FBM0JRO0FBQ0k7QUE2Qlo7QUFDQTtBQTNCUTtBQTZCUjtBQUNBO0FBM0JJO0FBNkJKO0FBQ0E7QUFDQTtBQTNCQTtBQTZCQTtBQTNCSTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUE2QlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNybURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0k7QUFHWjtBQUNBO0FBRFE7QUFDQTtBQUdSO0FBRFE7QUFDSTtBQUNJO0FBQ0k7QUFDQTtBQUdwQjtBQUNBO0FBQ0E7QUFDQTtBQURRO0FBR1I7QUFDQTtBQURJO0FBR0o7QUFEUTtBQUdSO0FBRFE7QUFDQTtBQUdSO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUdWO0FBRFU7QUFHVjtBQUNBO0FBRFE7QUFDQTtBQUNFO0FBQ0E7QUFHVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakVBO0FBQ0U7QUFDQTtBQUNGO0FBQ0U7QUFDRTtBQUNBO0FBQ0U7QUFDTjtBQUNJO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ047QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFBSTtBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQUk7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDQTtBQUFJO0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNFO0FBQ0U7QUFFSjtBQUNBO0FBQUU7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0U7QUFDRTtBQUVKO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0U7QUFDRTtBQUdKO0FBQ0E7QUFGSTtBQUlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0U7QUFDRTtBQUlKO0FBQ0E7QUFISTtBQUtKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0U7QUFDRTtBQUtKO0FBQ0E7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0U7QUFDRTtBQU1KO0FBQ0E7QUFKRTtBQUNFO0FBTUo7QUFKSTtBQU1KO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQU5RO0FBQ0k7QUFRWjtBQU5RO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTlE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUVI7QUFOUTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTmdCO0FBQ0k7QUFRcEI7QUFOZ0I7QUFRaEI7QUFMZ0I7QUFDQTtBQUNJO0FBQ0E7QUFPcEI7QUFMZ0I7QUFPaEI7QUFDQTtBQUxRO0FBT1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNFO0FBQ0U7QUFNSjtBQUNBO0FBSkU7QUFDRTtBQU1KO0FBQ0E7QUFMSTtBQU9KO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNJO0FBQ2hCO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURNO0FBQ0E7QUFHTjtBQUNBO0FBREk7QUFDRTtBQUNBO0FBR047QUFDQTtBQURJO0FBQ0U7QUFDQTtBQUNFO0FBR1I7QUFDQTtBQURNO0FBQ0E7QUFHTjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBSE07QUFDRTtBQUtSO0FBQ0E7QUFITTtBQUNBO0FBS047QUFDQTtBQUhJO0FBQ0U7QUFLTjtBQUNBO0FBSEk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUhJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtSO0FBQ0E7QUFISTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBS1I7QUFDQTtBQUhJO0FBQ0U7QUFLTjtBQUhNO0FBQ0U7QUFDRTtBQUtWO0FBQ0E7QUFIUTtBQUNFO0FBS1Y7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNFO0FBS047QUFITTtBQUNBO0FBQ0U7QUFLUjtBQUNBO0FBSE07QUFDRTtBQUtSO0FBQ0E7QUFITTtBQUNBO0FBQ0E7QUFLTjtBQUNBO0FBSEk7QUFDRTtBQUNBO0FBQ0E7QUFLTjtBQUhNO0FBQ0E7QUFLTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pLQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFDQTtBQUdZO0FBRFo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBRVE7QUFDSTtBQUNJO0FBQWhCO0FBRWdCO0FBQWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDTTtBQUNOO0FBQ007QUFDTjtBQUNNO0FBQ0U7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDTTtBQUNFO0FBQ0U7QUFDVjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDVTtBQUNWO0FBQ0E7QUFDUTtBQUNFO0FBQ0E7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDTTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ007QUFDQTtBQUNOO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDRjtBQUNBO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ007QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNFO0FBQ0U7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUdOO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFITTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0U7QUFLUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNJO0FBS1I7QUFIUTtBQUNJO0FBS1o7QUFDQTtBQUNBO0FBQ0E7QUFISTtBQUNFO0FBS047QUFDQTtBQUhJO0FBQ0U7QUFDQTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0U7QUFLUjtBQUNBO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBS047QUFDQTtBQUhJO0FBS0o7QUFDQTtBQUxNO0FBQ0U7QUFPUjtBQUNBO0FBTE07QUFDQTtBQU9OO0FBQ0E7QUFMSTtBQUNFO0FBQ0U7QUFPUjtBQUNBO0FBTE07QUFDQTtBQU9OO0FBQ0E7QUFDQTtBQUxJO0FBQ0U7QUFDRTtBQU9SO0FBQ0E7QUFMTTtBQUNBO0FBQ0E7QUFPTjtBQUxNO0FBT047QUFDQTtBQUxVO0FBQ0k7QUFDSTtBQU9sQjtBQUxrQjtBQU9sQjtBQUNBO0FBTFE7QUFDQTtBQUNBO0FBT1I7QUFOWTtBQUNBO0FBUVo7QUFOUTtBQUNBO0FBQ0E7QUFDSTtBQVFaO0FBTlE7QUFDSTtBQVFaO0FBTlk7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQVFoQjtBQU5ZO0FBQ0k7QUFRaEI7QUFOWTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFReEI7QUFDQTtBQU5nQjtBQUNJO0FBUXBCO0FBTG9CO0FBT3BCO0FBSm9CO0FBTXBCO0FBSmdCO0FBQ0E7QUFDQTtBQUNBO0FBTWhCO0FBSlk7QUFDQTtBQUNBO0FBQ0E7QUFNWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEk7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNGO0FBS047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhJO0FBQ0U7QUFDRTtBQUtSO0FBQ0E7QUFITTtBQUNBO0FBS047QUFDQTtBQUNBO0FBSEk7QUFDRTtBQUNFO0FBS1I7QUFDQTtBQUhNO0FBQ0E7QUFLTjtBQUNBO0FBQ0E7QUFISTtBQUNFO0FBQ0U7QUFLUjtBQUNBO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBQ0U7QUFLUjtBQUNBO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBQ0U7QUFLUjtBQUNBO0FBSE07QUFDQTtBQUtOO0FBQ0E7QUFISTtBQUNFO0FBQ0U7QUFLUjtBQUNBO0FBSE07QUFLTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFBTTtBQUNBO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFBTTtBQUVOO0FBQU07QUFDQTtBQUNBO0FBQ0E7QUFFTjtBQUFVO0FBRVY7QUFBUTtBQUVSO0FBQ0E7QUFBSTtBQUNFO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1R0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0U7QUFDQTtBQUNBO0FBQ047QUFDTTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ1I7QUFDQTtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNFO0FBQ0U7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0U7QUFDRTtBQUdFO0FBRE47QUFDQTtBQUdJO0FBQ0U7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDTTtBQUNFO0FBQ0E7QUFDQTtBQUNSO0FBQ007QUFDTjtBQUNJO0FBQ0E7QUFDRTtBQUNFO0FBQ1I7QUFDTTtBQUNBO0FBQ0U7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ047QUFBUTtBQUVSO0FBQU07QUFFTjtBQUFNO0FBQ0U7QUFFUjtBQUFNO0FBQ0E7QUFDRTtBQUNFO0FBRVY7QUFDQTtBQUFNO0FBRU47QUFBSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBRVI7QUFDQTtBQUFNO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0M7QUFDQztBQUNBO0FBRUY7QUFBRztBQUNDO0FBQ0E7QUFDQTtBQUVKO0FBQUc7QUFFSDtBQUFFO0FBQ0E7QUFDQztBQUNDO0FBRUo7QUFBRztBQUNBO0FBQ0M7QUFFSjtBQUFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQztBQUNBO0FBRUo7QUFBSztBQUNBO0FBRUw7QUFETTtBQUdOO0FBQ0E7QUFDQTtBQURHO0FBQ0E7QUFDQTtBQUNDO0FBR0o7QUFERztBQUNBO0FBQ0M7QUFDQztBQUdMO0FBQ0E7QUFERztBQUdIO0FBREU7QUFDQztBQUNDO0FBQ0E7QUFDQTtBQUdKO0FBQ0E7QUFERztBQUdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSEE7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNFO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBQ0E7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQURSO0FBR007QUFETjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFFSTtBQUNJO0FBQ0Y7QUFDRTtBQUNBO0FBQ0U7QUFDSTtBQUFkO0FBRWM7QUFBZDtBQUVRO0FBQVI7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNJO0FBQVY7QUFDQTtBQUVVO0FBQVY7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNJO0FBQVY7QUFDQTtBQUVVO0FBQVY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0U7QUFDRTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNFO0FBQ0U7QUFEUjtBQUNBO0FBR007QUFDRTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR007QUFDQTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFDRTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRE47QUFHTTtBQUNBO0FBQ0E7QUFETjtBQUNBO0FBR0k7QUFDRTtBQUNBO0FBRE47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0M7QUFDVDtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ1E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUdRO0FBQ0U7QUFEVjtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBRFY7QUFDQTtBQUNBO0FBR1E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQURWO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR1E7QUFDRTtBQURWO0FBQ0E7QUFHUTtBQUNFO0FBRFY7QUFDQTtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBR0k7QUFDRTtBQUROO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUdRO0FBQ0E7QUFDRTtBQURWO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFLSTtBQUNJO0FBSFI7QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFLSTtBQUNFO0FBSE47QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeExBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDQTtBQUROO0FBR007QUFDQTtBQUNBO0FBQ0U7QUFDRTtBQURWO0FBR1E7QUFEUjtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUNFO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDSTtBQUNJO0FBRFo7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBRHBCO0FBR29CO0FBQ0E7QUFEcEI7QUFHb0I7QUFDQTtBQURwQjtBQUdnQjtBQUNBO0FBQ0k7QUFEcEI7QUFDQTtBQUdRO0FBQ0k7QUFEWjtBQUNBO0FBR1k7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQURwQjtBQUdnQjtBQUNBO0FBRGhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJSTtBQUNJO0FBRlI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRjtBQUVFO0FBQ0U7QUFDQTtBQUNFO0FBQU47QUFFSTtBQUFKO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQU47QUFFSTtBQUFKO0FBQ0E7QUFFRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFBTjtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFBTjtBQUVJO0FBQ0U7QUFDQTtBQUFOO0FBQ0E7QUFDQTtBQUVFO0FBQ0U7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBRUk7QUFDRTtBQUFOO0FBQ007QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0U7QUFDTjtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFBTTtBQUNFO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUY7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQUNFO0FBQ0o7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDVjtBQUNVO0FBQ0U7QUFDQTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ047QUFDQTtBQUNJO0FBQ0E7QUFDRTtBQUNOO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFDTjtBQUVNO0FBQU47QUFHSTtBQURKO0FBQ0E7QUFDQTtBQUdFO0FBQ0U7QUFESjtBQUdJO0FBQ0U7QUFETjtBQUNBO0FBR0k7QUFESjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pWQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBRFI7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNKO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDUTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFBWTtBQUNBO0FBQ0E7QUFFWjtBQUFZO0FBQ0E7QUFDQTtBQUVaO0FBQ0E7QUFBUTtBQUVSO0FBQVE7QUFDSTtBQUNBO0FBRVo7QUFDUTtBQUNBO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ1o7QUFDUTtBQUNJO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFSO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUFSO0FBRVE7QUFBUjtBQUNZO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDWTtBQUNBO0FBQ0E7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUVRO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFBaEI7QUFDQTtBQUNBO0FBRVk7QUFDQTtBQUFaO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNRO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQVk7QUFDSTtBQUVoQjtBQUFZO0FBRVo7QUFBWTtBQUNJO0FBRWhCO0FBQVk7QUFDQTtBQUVaO0FBQ0E7QUFEWTtBQUNBO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFEUTtBQUNJO0FBR1o7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBQ0k7QUFDSTtBQUNJO0FBR3BCO0FBQ0E7QUFDQTtBQUNBO0FBRFk7QUFDSTtBQUNJO0FBR3BCO0FBQ0E7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFFUjtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFEUTtBQUdSO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUdOO0FBQ0E7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUdSO0FBQ0E7QUFESTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBREk7QUFDSTtBQUNJO0FBR1o7QUFETTtBQUdOO0FBQ0E7QUFESTtBQUdKO0FBQ0E7QUFIUTtBQUNJO0FBS1o7QUFITTtBQUtOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFEUTtBQUNBO0FBQ0k7QUFDQTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBQ0k7QUFDQTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBRFE7QUFDSTtBQUdaO0FBQ0E7QUFEUTtBQUNBO0FBR1I7QUFEUTtBQUdSO0FBRFE7QUFHUjtBQURRO0FBR1I7QUFEUTtBQUNJO0FBR1o7QUFBWTtBQUVaO0FBQVE7QUFFUjtBQURZO0FBR1o7QUFEUTtBQUNBO0FBQ0E7QUFHUjtBQURRO0FBR1I7QUFEUTtBQUdSO0FBRFE7QUFDQTtBQUNBO0FBQ0k7QUFHWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUdOO0FBQ0E7QUFESTtBQUNJO0FBR1I7QUFDQTtBQURJO0FBQ0k7QUFDQTtBQUNBO0FBR1I7QUFDQTtBQUFJO0FBRUo7QUFBUTtBQUNBO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0k7QUFFVjtBQUNBO0FBQVU7QUFFVjtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQ0E7QUFBWTtBQUVaO0FBQ0E7QUFDQTtBQUFJO0FBRUo7QUFBUTtBQUNBO0FBQ0k7QUFFWjtBQUNBO0FBQVk7QUFFWjtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ2dCO0FBQ2hCO0FBQ1k7QUFDSTtBQUNoQjtBQUNBO0FBQ1k7QUFDQTtBQUNBO0FBQ0k7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUVRO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBRVE7QUFBUjtBQUNBO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUVRO0FBQ0k7QUFBWjtBQUNBO0FBQ1k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFFTTtBQUNFO0FBQ0E7QUFBUjtBQUVNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFBZDtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUFSO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFBVjtBQUNBO0FBRVE7QUFDQTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFBaEI7QUFDQTtBQUNBO0FBRVE7QUFDSTtBQUNJO0FBQ0E7QUFBaEI7QUFFZ0I7QUFBaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNJO0FBQ0E7QUFBVjtBQUVNO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUNJO0FBQVY7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDQTtBQUNJO0FBQWhCO0FBQ0E7QUFDQTtBQUVRO0FBQ0k7QUFDQTtBQUNBO0FBQVo7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBWjtBQUVRO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBRUk7QUFDQTtBQUNJO0FBRGhCO0FBQ0E7QUFDQTtBQUdRO0FBQ0k7QUFDQTtBQUNBO0FBRFo7QUFHUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFEWjtBQUdRO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNJO0FBRFo7QUFDQTtBQUdJO0FBQ0k7QUFDSTtBQURaO0FBR1k7QUFEWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqdEJBO0FBQ0k7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNZO0FBQ1o7QUFDWTtBQUNaO0FBQ0E7QUFDUTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ1k7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDWTtBQUNaO0FBQ1k7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNNO0FBQ0E7QUFDQTtBQUNOO0FBQ007QUFDRTtBQUNBO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDSTtBQUNKO0FBQU07QUFDQTtBQUVOO0FBQU07QUFDRTtBQUNBO0FBRVI7QUFDQTtBQUFJO0FBQ0U7QUFDQTtBQUNFO0FBRVI7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBQ0E7QUFFRTtBQUNWO0FBQ0E7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDQTtBQUNFO0FBQ1Y7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0U7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNNO0FBQ0E7QUFDRTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNBO0FBRUU7QUFBVjtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRUk7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUVJO0FBQ0U7QUFDRTtBQUFSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDQTtBQUNJO0FBQ0E7QUFDWjtBQUNRO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0k7QUFDWjtBQUNBO0FBQ1k7QUFDWjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ1E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDWTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ2hCO0FBQ1k7QUFDSTtBQUNJO0FBQ0E7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0c7QUFDQTtBQUNJO0FBQ2Y7QUFFZTtBQUFmO0FBQ21CO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDM0I7QUFDQTtBQUV1QjtBQUNJO0FBQ0E7QUFBM0I7QUFDQTtBQUNBO0FBR21CO0FBRG5CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdVO0FBQ0k7QUFDQTtBQUNBO0FBRGQ7QUFHVTtBQUNBO0FBQ0k7QUFEZDtBQUdjO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFEaEI7QUFFb0I7QUFDQTtBQUNBO0FBQXBCO0FBQ0E7QUFFYztBQUFkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJTztBQUZQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNJO0FBSlI7QUFNUTtBQUpSO0FBQ0E7QUFNSTtBQUNFO0FBSk47QUFDQTtBQU1JO0FBQ0k7QUFDQTtBQUpSO0FBQ0E7QUFNSTtBQUNJO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFKVjtBQU1VO0FBSlY7QUFNUTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBSlY7QUFDQTtBQU1RO0FBQ0E7QUFDRTtBQUpWO0FBQ0E7QUFNVTtBQUNFO0FBSlo7QUFDQTtBQUtZO0FBSFo7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNJO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSlo7QUFNUTtBQUNBO0FBQ0E7QUFDQTtBQUpSO0FBTVk7QUFDQTtBQUpaO0FBS2dCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFIcEI7QUFLZ0I7QUFIaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSVk7QUFDQTtBQUZaO0FBQ0E7QUFJWTtBQUZaO0FBQ0E7QUFDQTtBQUtJO0FBQ0k7QUFDRTtBQUNFO0FBSFo7QUFDQTtBQUtZO0FBQ0E7QUFIWjtBQUtRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIUjtBQUNBO0FBS0k7QUFDSTtBQUNJO0FBSFo7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUhSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUN0UkE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDWjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNKO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFDQTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0k7QUFBSjtBQUVJO0FBQ0k7QUFDQTtBQUNBO0FBQVI7QUFFUTtBQUFSO0FBQ0E7QUFFUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFBUjtBQUVRO0FBQVI7QUFFUTtBQUFSO0FBRVE7QUFBUjtBQUNBO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUVRO0FBQ0E7QUFBUjtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVI7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBQ0E7QUFBUTtBQUNBO0FBRVI7QUFBUTtBQUNJO0FBRVo7QUFDQTtBQUNBO0FBQVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUVSO0FBQVE7QUFDQTtBQUNBO0FBRVI7QUFBUTtBQUNBO0FBRVI7QUFDQTtBQUFRO0FBQ0E7QUFDQTtBQUVSO0FBQVE7QUFDRTtBQUNBO0FBQ0E7QUFFVjtBQUNBO0FBQVU7QUFFVjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUFKO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFaO0FBRVE7QUFDSTtBQUFaO0FBRVk7QUFBWjtBQUVZO0FBQVo7QUFFWTtBQUNBO0FBQVo7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNJO0FBQVo7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFBUjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQWhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUFOO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFFUTtBQUNJO0FBQVo7QUFFZ0I7QUFBaEI7QUFFWTtBQUFaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRVE7QUFDSTtBQUNJO0FBQWhCO0FBRWdCO0FBQWhCO0FBRVk7QUFBWjtBQUNBO0FBRVE7QUFDQTtBQUFSO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFBUjtBQUVRO0FBQVI7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNBO0FBQU47QUFFTTtBQUNBO0FBQU47QUFDQTtBQUVNO0FBQU47QUFFTTtBQUNFO0FBQVI7QUFDQTtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNNO0FBQ047QUFDVTtBQUNWO0FBQ007QUFDQTtBQUNOO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1k7QUFDWjtBQUNZO0FBQ1o7QUFDTTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFETTtBQUdOO0FBRE07QUFDQTtBQUNFO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNFO0FBR047QUFESTtBQUdKO0FBRFE7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFHeEI7QUFDQTtBQUZnQztBQUNBO0FBQ0k7QUFJcEM7QUFGb0M7QUFJcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUY0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSTVCO0FBRndCO0FBSXhCO0FBRHdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFHNUI7QUFDQTtBQUQ0QjtBQUNJO0FBR2hDO0FBQ0E7QUFEd0I7QUFHeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREk7QUFDRTtBQUNFO0FBR1I7QUFEUTtBQUNGO0FBQ0E7QUFHTjtBQURNO0FBQ0U7QUFDRTtBQUdWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNFO0FBRVI7QUFDQTtBQUFNO0FBRU47QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVk7QUFFWjtBQUFRO0FBRVI7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUNJO0FBRVo7QUFBWTtBQUVaO0FBQVE7QUFFUjtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNBO0FBQ0k7QUFFWjtBQUFZO0FBRVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDSTtBQUVaO0FBQ0E7QUFBUTtBQUNJO0FBRVo7QUFDQTtBQUFRO0FBQ0E7QUFDQTtBQUNBO0FBRVI7QUFBUTtBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUTtBQUNBO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQVE7QUFDSTtBQUNBO0FBQ0E7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFZO0FBRVo7QUFBUTtBQUNBO0FBRVI7QUFBWTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFFUjtBQUNBO0FBQ0E7QUFBSTtBQUVKO0FBQVE7QUFDSTtBQUNJO0FBQ0E7QUFFaEI7QUFDZ0I7QUFDQTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNnQjtBQUNoQjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ1E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNZO0FBQ0E7QUFDWjtBQUNBO0FBQ0E7QUFDWTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDSTtBQUNaO0FBQ1k7QUFDWjtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNRO0FBQ1I7QUFDTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDRTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDVTtBQUNFO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDTTtBQUNJO0FBQ0k7QUFDQTtBQUNkO0FBQ1U7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDQTtBQURRO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFHTjtBQURNO0FBQ0E7QUFHTjtBQURNO0FBQ0E7QUFDRTtBQUdSO0FBQ0E7QUFEVTtBQUNJO0FBR2Q7QUFDQTtBQUNBO0FBQ0E7QUFETTtBQUNFO0FBR1I7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNFO0FBR047QUFESTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHTjtBQURRO0FBR1I7QUFEUTtBQUNGO0FBQ0E7QUFHTjtBQUNBO0FBREk7QUFDRTtBQUNFO0FBQ0E7QUFHUjtBQURNO0FBR047QUFEUTtBQUNBO0FBQ0k7QUFHWjtBQURRO0FBQ0Y7QUFHTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDTTtBQUNOO0FBQ007QUFDQTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ047QUFDTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNNO0FBQ0U7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUFnQjtBQUVoQjtBQUFnQjtBQUVoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFRO0FBQ0k7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBUTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFFaEI7QUFDQTtBQUFNO0FBQ0U7QUFFUjtBQUNRO0FBQ1I7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQUNNO0FBQ0U7QUFDQTtBQUNSO0FBQ0E7QUFDTTtBQUNBO0FBQ0E7QUFDTjtBQUNNO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNFO0FBQ0E7QUFDTjtBQUNNO0FBQ0U7QUFDUjtBQUNBO0FBQ007QUFDTjtBQUNNO0FBQ0U7QUFDUjtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0U7QUFDRTtBQUNSO0FBQ0E7QUFDTTtBQUNBO0FBQ0E7QUFDTjtBQUNNO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNFO0FBQ0E7QUFDUjtBQUNBO0FBRU07QUFBTjtBQUNBO0FBRVE7QUFDQTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBRUk7QUFDRTtBQUNBO0FBQU47QUFFTTtBQUNFO0FBQVI7QUFDQTtBQUVNO0FBQ0E7QUFBTjtBQUNBO0FBRUk7QUFBSjtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0Y7QUFDRTtBQUFSO0FBQ0E7QUFFTTtBQUNFO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBRUk7QUFDRTtBQUNBO0FBQ0U7QUFBUjtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0U7QUFBTjtBQUNBO0FBRU07QUFDRTtBQUNBO0FBQVI7QUFDQTtBQUVRO0FBQ0E7QUFDSTtBQUFaO0FBQ0E7QUFFTTtBQUFOO0FBQ0E7QUFFTTtBQUNFO0FBQ0E7QUFBUjtBQUNBO0FBR007QUFETjtBQUdVO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRjtBQUNFO0FBRFY7QUFDQTtBQUdVO0FBRFY7QUFHUTtBQURSO0FBQ0E7QUFHTTtBQUNBO0FBQ0E7QUFETjtBQUdNO0FBRE47QUFHTTtBQUNBO0FBQ0E7QUFETjtBQUdNO0FBQ0U7QUFDRTtBQURWO0FBQ0E7QUFHUTtBQURSO0FBQ0E7QUFDQTtBQUlJO0FBQ0U7QUFGTjtBQUlNO0FBQ0E7QUFDRTtBQUZSO0FBQ0E7QUFJTTtBQUNBO0FBQ0U7QUFDQTtBQUZSO0FBQ0E7QUFDQTtBQUtJO0FBQ0k7QUFDSTtBQUhaO0FBQ0E7QUFLUTtBQUhSO0FBS1k7QUFIWjtBQUNBO0FBS1E7QUFIUjtBQUNBO0FBQ0E7QUFLSTtBQUNFO0FBQ0U7QUFIUjtBQUNBO0FBS007QUFDQTtBQUNFO0FBQ0U7QUFIVjtBQUNBO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFITjtBQUNBO0FBS0k7QUFDRTtBQUhOO0FBS007QUFDRTtBQUhSO0FBQ0E7QUFDQTtBQUNBO0FBS0k7QUFDSTtBQUNBO0FBQ0E7QUFIUjtBQUtRO0FBQ0E7QUFIUjtBQUtRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUhaO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDRTtBQUhSO0FBQ0E7QUFLTTtBQUNBO0FBQ0U7QUFDQTtBQUhSO0FBQ0E7QUFDQTtBQUtJO0FBQ0U7QUFDQTtBQUhOO0FBQ0E7QUFLVTtBQUhWO0FBS1E7QUFIUjtBQUNBO0FBS007QUFITjtBQUNBO0FBS0k7QUFDRTtBQUNFO0FBSFI7QUFDQTtBQUNBO0FBTUk7QUFDRTtBQUNFO0FBSlI7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNFO0FBSk47QUFNTTtBQUpOO0FBQ0E7QUFNSTtBQUNFO0FBQ0U7QUFKUjtBQUNBO0FBTU07QUFKTjtBQUNBO0FBTUk7QUFDRTtBQUNFO0FBSlI7QUFDQTtBQU1NO0FBSk47QUFDQTtBQU1JO0FBQ0U7QUFKTjtBQUNBO0FBTUk7QUFKSjtBQU1NO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFKUjtBQU1NO0FBQ0U7QUFKUjtBQUNBO0FBTVE7QUFDRTtBQUpWO0FBTVE7QUFDQTtBQUNBO0FBSlI7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNFO0FBQ0U7QUFDQTtBQUpSO0FBQ0E7QUFNTTtBQUNFO0FBQ0E7QUFKUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNUTtBQUNBO0FBSlI7QUFDQTtBQUNBO0FBQ0E7QUFNSTtBQUNFO0FBQ0U7QUFKUjtBQUNBO0FBTU07QUFKTjtBQUNBO0FBQ0E7QUFNSTtBQUNFO0FBQ0U7QUFKUjtBQUNBO0FBTU07QUFDRTtBQUpSO0FBQ0E7QUFNTTtBQUpOO0FBQ0E7QUFDQTtBQU1JO0FBQ0U7QUFDRTtBQUpSO0FBQ0E7QUFNTTtBQUpOO0FBQ0E7QUFDQTtBQUNBO0FBTUk7QUFDSTtBQUNBO0FBSlI7QUFNUTtBQUNBO0FBSlI7QUFNUTtBQUNGO0FBQ0E7QUFKTjtBQU1NO0FBQ0E7QUFDRTtBQUNBO0FBSlI7QUFDQTtBQUNBO0FBTUk7QUFKSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTVE7QUFDSTtBQUpaO0FBQ0E7QUFNUTtBQUNJO0FBSlo7QUFNUTtBQUNBO0FBQ0E7QUFDSTtBQUpaO0FBQ0E7QUFNUTtBQUNJO0FBSlo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1RO0FBQ0E7QUFDSTtBQUNBO0FBQ0k7QUFKaEI7QUFDQTtBQUNBO0FBTVE7QUFDQTtBQUpSO0FBTVE7QUFKUjtBQU1RO0FBSlI7QUFNUTtBQUpSO0FBTVE7QUFDQTtBQUNJO0FBQ0k7QUFKaEI7QUFNWTtBQUNBO0FBSlo7QUFNUTtBQUNJO0FBQ0k7QUFDSTtBQUpwQjtBQU1nQjtBQUpoQjtBQUNBO0FBQ0E7QUFNUTtBQUpSO0FBTVE7QUFDSTtBQUNJO0FBSmhCO0FBTVk7QUFKWjtBQUNBO0FBTVE7QUFDSTtBQUpaO0FBQ0E7QUFDQTtBQU9RO0FBQ0k7QUFMWjtBQUNBO0FBQ0E7QUFPSTtBQUxKO0FBQ0E7QUFDQTtBQUlRO0FBQ0E7QUFDQTtBQUZSO0FBSVE7QUFDSTtBQUZaO0FBQ0E7QUFJUTtBQUNBO0FBQ0k7QUFDQTtBQUNJO0FBRmhCO0FBQ0E7QUFJUTtBQUNJO0FBQ0k7QUFGaEI7QUFJWTtBQUZaO0FBQ0E7QUFJUTtBQUZSO0FBQ0E7QUFJSTtBQUZKO0FBQ0E7QUFNSTtBQUNFO0FBSk47QUFNUTtBQUpSO0FBQ0E7QUFDQTtBQUNBO0FBTUk7QUFKSjtBQUNBO0FBSU07QUFDRTtBQUZSO0FBQ0E7QUFJUTtBQUNJO0FBQ0E7QUFDQTtBQUZaO0FBSVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBRlo7QUFJUTtBQUNBO0FBRlI7QUFDQTtBQUlJO0FBQ0k7QUFDSTtBQUZaO0FBQ0E7QUFDQTtBQUlJO0FBQ0U7QUFDQTtBQUNFO0FBRlI7QUFDQTtBQUlNO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFGVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUk7QUFGSjtBQUNBO0FBRVE7QUFDSTtBQUNBO0FBQ0E7QUFBWjtBQUVRO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUFaO0FBRVE7QUFDQTtBQUFSO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBQ0E7QUFDQTtBQUVJO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDTTtBQUNJO0FBQ0E7QUFBaEI7QUFFZ0I7QUFDQTtBQUFoQjtBQUVnQjtBQUFoQjtBQUNBO0FBRU07QUFDRTtBQUNFO0FBQVY7QUFFUTtBQUFSO0FBRVk7QUFDQTtBQUFaO0FBRVk7QUFDQTtBQUFaO0FBRU07QUFDRTtBQUNFO0FBQVY7QUFFUTtBQUFSO0FBRVk7QUFDQTtBQUFaO0FBRVk7QUFDQTtBQUFaO0FBRU07QUFDTTtBQUNBO0FBQ0Y7QUFBVjtBQUNBO0FBQ0E7QUFFSTtBQUNJO0FBQ0k7QUFBWjtBQUNBO0FBQ1k7QUFDQTtBQUNaO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDSTtBQUNaO0FBQ0E7QUFBWTtBQUNBO0FBRVo7QUFDQTtBQUNBO0FBQUk7QUFDSTtBQUNJO0FBRVo7QUFDQTtBQURZO0FBR1o7QUFDQTtBQUNBO0FBQ0E7QUFESTtBQUNFO0FBQ0U7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHUjtBQUNBO0FBRE07QUFDQTtBQUNFO0FBR1I7QUFDQTtBQURNO0FBQ0E7QUFHTjtBQURRO0FBR1I7QUFEUTtBQUNBO0FBQ0U7QUFDRTtBQUdaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUNJO0FBQ0E7QUFFWjtBQUNBO0FBQVk7QUFDQTtBQUVaO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBRU47QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBRU47QUFBTTtBQUNBO0FBQ0E7QUFFTjtBQUFNO0FBRU47QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0E7QUFFTjtBQUFNO0FBRU47QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUVOO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDRTtBQUVSO0FBQ0E7QUFBTTtBQUNBO0FBRU47QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0U7QUFFUjtBQUNBO0FBQU07QUFFTjtBQUFNO0FBQ0U7QUFDQTtBQUVSO0FBQ0E7QUFDQTtBQUNBO0FBQUk7QUFDRTtBQUNBO0FBQ0U7QUFFUjtBQUNBO0FBQU07QUFDRTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0U7QUFDRTtBQUVSO0FBQ0E7QUFDQTtBQUFJO0FBQ0k7QUFDQTtBQUNJO0FBRVo7QUFBUTtBQUVSO0FBQ0E7QUFBSTtBQUNJO0FBQ0E7QUFDSTtBQUVaO0FBQVE7QUFFUjtBQUNBO0FBQUk7QUFDRTtBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFDSTtBQUVWO0FBQU07QUFDQTtBQUVOO0FBQ0E7QUFBSTtBQUNFO0FBQ0E7QUFFTjtBQUNBO0FBQ0E7QUFBTTtBQUNJO0FBRVY7QUFDVTtBQUNWO0FBRVU7QUFBVjtBQUdVO0FBRFY7QUFHTTtBQUROO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDQTtBQUROO0FBQ0E7QUFHSTtBQUNFO0FBQ0E7QUFDSTtBQURWO0FBR007QUFDSTtBQURWO0FBR007QUFDQTtBQUROO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDSTtBQURaO0FBSVk7QUFGWjtBQUtZO0FBSFo7QUFLUTtBQUNBO0FBSFI7QUFDQTtBQUNBO0FBS0k7QUFISjtBQUNBO0FBQ0E7QUFLSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBSFI7QUFDQTtBQUtNO0FBQ0U7QUFDQTtBQUNBO0FBSFI7QUFDQTtBQUtNO0FBQ0E7QUFDRTtBQUNBO0FBSFI7QUFDQTtBQUtNO0FBQ0U7QUFIUjtBQUNBO0FBS007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhOO0FBS007QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUhSO0FBQ0E7QUFLTTtBQUNBO0FBQ0U7QUFIUjtBQUNBO0FBS007QUFDQTtBQUNFO0FBSFI7QUFDQTtBQUtNO0FBQ0E7QUFITjtBQUNBO0FBQ0E7QUFLSTtBQUNFO0FBQ0U7QUFIUjtBQUNBO0FBS007QUFDRTtBQUNBO0FBSFI7QUFLUTtBQUNBO0FBSFI7QUFDQTtBQUtNO0FBQ0E7QUFDRTtBQUNBO0FBQ0U7QUFDQTtBQUhWO0FBQ0E7QUFDQTtBQUtNO0FBQ0U7QUFIUjtBQUNBO0FBS007QUFITjtBQUNBO0FBS0k7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBSFI7QUFLTTtBQUhOO0FBS007QUFDQTtBQUNFO0FBSFI7QUFDQTtBQUtNO0FBQ0E7QUFITjtBQUNBO0FBQ0E7QUFLQTtBQUNJO0FBSEo7QUFLQTtBQUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2NkRBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUdJO0FBREo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQ0o7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDUTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNFO0FBQ1I7QUFDQTtBQUNNO0FBQ047QUFDQTtBQUNJO0FBQ0o7QUFDUTtBQUNBO0FBQ1I7QUFDUTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ0E7QUFDUjtBQUNRO0FBQ0k7QUFDWjtBQUNZO0FBQ1o7QUFDQTtBQUNBO0FBQ0k7QUFDSjtBQUNNO0FBQ0E7QUFDTjtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFFSTtBQUNFO0FBQU47QUFDQTtBQUVJO0FBQ0k7QUFBUjtBQUNBO0FBRUk7QUFDRTtBQUNBO0FBQU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVNO0FBQU47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFSTtBQUNFO0FBQU47QUFFTTtBQUFOO0FBQ0E7QUFFSTtBQUNJO0FBQ0E7QUFBUjtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDQTtBQUFSO0FBQ0E7QUFFSztBQUNHO0FBQVI7QUFFUTtBQUNJO0FBQ0E7QUFDQTtBQUFaO0FBRVE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNJO0FBQVo7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUVJO0FBQ0k7QUFDSTtBQUFaO0FBQ0E7QUFDQTtBQUVJO0FBQ0k7QUFDSTtBQUNBO0FBQVo7QUFDQTtBQUVRO0FBQ0k7QUFDQTtBQUFaO0FBQ0E7QUFFUTtBQUNBO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4S0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBRFI7QUFDQTtBQUdNO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFEUjtBQUNBO0FBQ0E7QUFHSTtBQUNFO0FBQ0U7QUFDQTtBQUNBO0FBRFI7QUFDQTtBQUdRO0FBRFI7QUFDQTtBQUdJO0FBQ0U7QUFDQTtBQUROO0FBQ0E7QUFHSTtBQUNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRTtBQURWO0FBQ0E7QUFHUTtBQUNBO0FBQ0k7QUFDQTtBQURaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdFQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ1E7QUFDUjtBQUNRO0FBQ0U7QUFDVjtBQUNVO0FBQ0E7QUFDQTtBQUNBO0FBQ1Y7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ0E7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNaO0FBRVk7QUFBWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUVBO0FBQ0k7QUFDSjtBQUNJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBR0k7QUFDRTtBQUROO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUJBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBR0k7QUFDSTtBQURSO0FBR1k7QUFDQTtBQURaO0FBR1k7QUFDSTtBQURoQjtBQUNBO0FBQ0E7QUFHWTtBQUNJO0FBRGhCO0FBQ0E7QUFDQTtBQUlZO0FBQ0E7QUFGWjtBQUlZO0FBQ0k7QUFDQTtBQUZoQjtBQUlZO0FBRlo7QUFJUTtBQUZSO0FBQ0E7QUFDQTtBQUlJO0FBQ0k7QUFGUjtBQUlZO0FBQ0E7QUFGWjtBQUNBO0FBSVk7QUFDSTtBQUZoQjtBQUlnQjtBQUZoQjtBQUNBO0FBQ0E7QUFDQTtBQUtZO0FBQ0E7QUFDQTtBQUhaO0FBS1k7QUFDSTtBQUNBO0FBQ0E7QUFIaEI7QUFDQTtBQUtRO0FBSFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5RUE7QUFDSTtBQUNKO0FBQ0k7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNRO0FBQ0E7QUFDSTtBQUNBO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNJO0FBQ1o7QUFDQTtBQUNRO0FBQ0k7QUFDQTtBQUNaO0FBQ1k7QUFDWjtBQUNZO0FBQ1o7QUFDUTtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ2hCO0FBRWdCO0FBQWhCO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBRGhCO0FBSWdCO0FBQ0E7QUFGaEI7QUFLZ0I7QUFDQTtBQUhoQjtBQUtZO0FBQ0k7QUFIaEI7QUFLWTtBQUhaO0FBS1E7QUFIUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBRUk7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFBWjtBQUVZO0FBQVo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBQ0k7QUFDQTtBQUNaO0FBQ1E7QUFDSTtBQUNBO0FBQ0E7QUFDSTtBQUNJO0FBQ0E7QUFDcEI7QUFDZ0I7QUFDQTtBQUNBO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDUjtBQUNRO0FBQ1I7QUFDQTtBQUNBO0FBQ0k7QUFDSTtBQUNBO0FBR0E7QUFDSTtBQUNBO0FBRFo7QUFHUTtBQUNJO0FBQ0E7QUFEWjtBQUdRO0FBQ0k7QUFDQTtBQURaO0FBQ0E7QUFDQTtBQUdRO0FBQ0E7QUFEUjtBQUNBO0FBR0k7QUFDSTtBQUNBO0FBQ0k7QUFEWjtBQUNBO0FBR1E7QUFDSTtBQURaO0FBR1E7QUFDQTtBQURSO0FBQ0E7QUFDQTtBQUdJO0FBQ0k7QUFDQTtBQUNJO0FBRFo7QUFHUTtBQUNJO0FBRFo7QUFDQTtBQUdRO0FBQ0E7QUFDQTtBQURSO0FBQ0E7QUFHSTtBQUNJO0FBRFI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0Y7QUFDRTtBQUNFO0FBQ0E7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBQ0U7QUFDSjtBQUNJO0FBQ0o7QUFDSTtBQUNBO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNJO0FBQ0E7QUFDQTtBQUNKO0FBQ0k7QUFDRTtBQUNOO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFDRTtBQUNGO0FBQ0k7QUFDSjtBQUNBO0FBQ0U7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDTjtBQUNJO0FBQ0o7QUFDSTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0k7QUFDSjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBQ007QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDQTtBQUNOO0FBQ007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0k7QUFDRTtBQUNOO0FBQ007QUFDQTtBQUNBO0FBQ0U7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ007QUFDTjtBQUNNO0FBQ0E7QUFDTjtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0E7QUFFTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQU47QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQVI7QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUNFO0FBQ0E7QUFDRTtBQUNFO0FBQ0E7QUFDRTtBQUFWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFRTtBQUFGO0FBSUU7QUFGRjtBQU1FO0FBSkY7QUFRRTtBQU5GO0FBVUU7QUFSRjtBQVlFO0FBVkY7QUFjRTtBQVpGO0FBY0k7QUFDQTtBQUNBO0FBQ0U7QUFaTjtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBWkY7QUFjSTtBQUNBO0FBWko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNFO0FBQ0U7QUFDQTtBQUNFO0FBWk47QUFjSTtBQVpKO0FBQ0E7QUFjSTtBQUNBO0FBQ0E7QUFaSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFDRTtBQUNBO0FBQ0U7QUFaTjtBQWNJO0FBWko7QUFDQTtBQWNJO0FBQ0E7QUFDQTtBQVpKO0FBY0k7QUFDRTtBQVpOO0FBQ0E7QUFDQTtBQUNBO0FBY0U7QUFDRTtBQVpKO0FBQ0E7QUFDQTtBQWNFO0FBWkY7QUFjSTtBQUNBO0FBWko7QUFDQTtBQWNFO0FBQ0U7QUFaSjtBQWNJO0FBQ0U7QUFDQTtBQUNBO0FBWk47QUFDQTtBQWNJO0FBQ0U7QUFDRTtBQVpSO0FBQ0E7QUFjTTtBQVpOO0FBQ0E7QUFDQTtBQWNFO0FBWkY7QUFDQTtBQVlJO0FBQ0U7QUFWTjtBQUNBO0FBWUk7QUFDRTtBQVZOO0FBQ0E7QUFZSTtBQUNFO0FBQ0U7QUFWUjtBQUNBO0FBYUk7QUFYSjtBQUNBO0FBYUU7QUFYRjtBQUNBO0FBV0k7QUFDQTtBQUNBO0FBVEo7QUFXSTtBQVRKO0FBQ0E7QUFDQTtBQVdFO0FBQ0U7QUFDRTtBQVROO0FBQ0E7QUFXSTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFUVjtBQUNBO0FBQ0E7QUFXTTtBQVROO0FBQ0E7QUFDQTtBQUNBO0FBV0U7QUFDRTtBQVRKO0FBQ0E7QUFXRTtBQUNFO0FBVEo7QUFDQTtBQVdFO0FBQ0U7QUFDRTtBQUNBO0FBVE47QUFDQTtBQUNBO0FBQ0E7QUFXRTtBQUNFO0FBVEo7QUFDQTtBQUNBO0FBV0U7QUFDRTtBQUNBO0FBVEo7QUFXSTtBQVRKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFURjtBQVdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEY7QUFXRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEY7QUFXRTtBQVRGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNFO0FBVEY7QUFDQTtBQVdBO0FBQ0U7QUFDQTtBQVRGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVlBO0FBQ0U7QUFDQTtBQVZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNFO0FBQ0E7QUFWRjtBQUNBO0FBQ0E7QUFZQTtBQUNFO0FBQ0E7QUFWRjtBQVlFO0FBQ0E7QUFWRjtBQUNBO0FBQ0E7QUFZQTtBQUNFO0FBQ0E7QUFWRjtBQVlFO0FBQ0U7QUFDQTtBQVZKO0FBWUU7QUFWRjtBQUNBO0FBQ0E7QUFZQTtBQUNFO0FBQ0U7QUFDQTtBQVZKO0FBWUU7QUFWRjtBQUNBO0FBQ0E7QUFZQTtBQUNFO0FBQ0E7QUFDRTtBQVZKO0FBQ0E7QUFZRTtBQVZGO0FBQ0E7QUFZQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFWSjtBQVlFO0FBVkY7QUFDQTtBQVlBO0FBVkE7QUFDQTtBQVVFO0FBQ0E7QUFSRjtBQVVFO0FBQ0U7QUFSSjtBQUNBO0FBVUU7QUFDRTtBQUNBO0FBUko7QUFVRTtBQVJGO0FBQ0E7QUFVQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFSSjtBQVVFO0FBUkY7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNFO0FBUko7QUFDQTtBQVVFO0FBUkY7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNFO0FBUko7QUFVRTtBQVJGO0FBQ0E7QUFVQTtBQUNFO0FBQ0E7QUFDQTtBQUNFO0FBQ0E7QUFSSjtBQUNBO0FBVUU7QUFSRjtBQUNBO0FBVUE7QUFDSTtBQUNBO0FBQ0U7QUFSTjtBQUNBO0FBVUk7QUFSSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVUE7QUFSQTtBQUNBO0FBUUU7QUFDQTtBQUNFO0FBQ0E7QUFOSjtBQUNBO0FBUUU7QUFORjtBQVVJO0FBQ0E7QUFDRTtBQVJOO0FBQ0E7QUFVSTtBQVJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBQ0k7QUFDQTtBQUNFO0FBQ0E7QUFSTjtBQUNBO0FBVUk7QUFSSjtBQUNBO0FBVUE7QUFDRTtBQUNBO0FBQ0U7QUFSSjtBQUNBO0FBVUU7QUFSRjtBQUNBO0FBVUE7QUFDRTtBQUNBO0FBQ0E7QUFDRTtBQUNBO0FBUko7QUFDQTtBQVVFO0FBUkY7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNFO0FBUko7QUFVRTtBQVJGO0FBQ0E7QUFVQTtBQUNFO0FBQ0E7QUFDRTtBQVJKO0FBQ0E7QUFVRTtBQVJGO0FBQ0E7QUFDQTtBQVVBO0FBQ0U7QUFDQTtBQUNFO0FBUko7QUFDQTtBQVVFO0FBUkY7QUFDQTtBQUNBO0FBVUE7QUFDSTtBQUNBO0FBQ0U7QUFSTjtBQUNBO0FBVUk7QUFSSjtBQUNBO0FBQ0E7QUFVQTtBQUNJO0FBQ0U7QUFSTjtBQUNBO0FBVUk7QUFSSjtBQUNBO0FBQ0E7QUFVQTtBQUNJO0FBQ0U7QUFDQTtBQVJOO0FBQ0E7QUFVSTtBQVJKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDSTtBQUNKO0FBQ0k7QUFDSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNSO0FBQ0E7QUFDQTtBQUNJO0FBQ0U7QUFDTjtBQUNBO0FBQ0k7QUFDSjtBQUNBO0FBRE07QUFHTjtBQUNBO0FBREk7QUFHSjtBQUNBO0FBSFE7QUFLUjtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBTFE7QUFPUjtBQUNBO0FBTEk7QUFPSjtBQUNBO0FBUE07QUFTTjtBQUNBO0FBUEk7QUFDRTtBQUtFO0FBS1I7QUFDQTtBQUhNO0FBQ0U7QUFDRTtBQUtWO0FBQ0E7QUFIUTtBQUNBO0FBS1I7QUFDQTtBQUNBO0FBSEk7QUFLSjtBQUNBO0FBTE07QUFPTjtBQUxRO0FBT1I7QUFDQTtBQUxNO0FBT047QUFDQTtBQUxJO0FBT0o7QUFDQTtBQVBNO0FBU047QUFDQTtBQVBJO0FBU0o7QUFDQTtBQVRNO0FBQ0E7QUFDQTtBQUNBO0FBQ0U7QUFXUjtBQUNBO0FBVE07QUFXTjtBQUNBO0FBVEk7QUFDRTtBQUNBO0FBQ0E7QUFDQTtBQUNFO0FBV1I7QUFDQTtBQUNBO0FBVEk7QUFDRTtBQUNBO0FBQ0U7QUFXUjtBQUNBO0FBQ0E7QUFDQTtBQVRJO0FBQ0U7QUFDQTtBQUNBO0FBQ0U7QUFXUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0hBO0FBQ0k7QUFDSjtBQUNJO0FBQ0k7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0k7QUFDSTtBQUNSO0FBQ0E7QUFDSTtBQUNJO0FBQ1I7QUFDQTtBQUNJO0FBQ0k7QUFDUjtBQUNBO0FBQ0s7QUFDRztBQUNBO0FBQ0E7QUFDUjtBQUNTO0FBQ0E7QUFDSTtBQUNiO0FBRWE7QUFBYjtBQUdhO0FBRGI7QUFJYTtBQUZiO0FBSVM7QUFDQTtBQUNJO0FBRmI7QUFLYTtBQUhiO0FBTWE7QUFKYjtBQU9hO0FBTGI7QUFDQTtBQU9TO0FBQ0k7QUFMYjtBQU9TO0FBTFQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8g57uZIEFycmF5IOa3u+WKoOaWueazlVxuLy8gYXJyLmZpbmQoLi4uKVxuLy8gYXJyLmZpbmRJbmRleCguLi4pXG4vLyBhcnIuaW5jbHVkZXMoZSlcbi8vIGFyci51bmlxdWUoZXF1YWxGdW5jdGlvbiwgaXNOZXdBcnJheSlcbi8vIEFycmF5LmZyb21cbi8vIEFycmF5LmVxdWFsXG4vLyBhcnIuaXNFcXVhbChvdGhlckFycmF5LCBpc1N0cmljdClcbi8vIEFycmF5LnNvcnRCeU51bWJlclxuLy8gYXJyLmZpbmRTdWJBcnJheUluZGV4cyhbXSkgICDnlKjkuo7mn6Xmib7mlbDnu4TlhoXnmoTpg6jliIblhYPntKDnmoTntKLlvJVcbi8vIGFyci50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KHN0YXJ0SW5kZXgpIOWwhuaVsOe7hOWGheeahOWFg+e0oOW5s+enu1xuLy8g5aaC77yaWzEsIDIsIDMsIDQsIDVdLnRyYW5zbGF0aW9uV2l0aFN0YXJ0SW5kZXgoMykgPT4gWzQsNSwxLDIsM11cbi8vIGFyci5rcV9pbnNlcnQoaW5kZXgsIGUpICAg5o+S5YWl5LiA5Liq5YWD57SgXG4vLyBhcnIua3FfZXhjbHVkZXMoYXJyYXkpICAgLy8g6Zmk5LqGYXJyYXnmlbDnu4TkuK3nmoTlhYPntKBcblxuXG5tb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5maW5kKSB7XG4gIEFycmF5LnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGlmICh0aGlzID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FycmF5LnByb3RvdHlwZS5maW5kIGNhbGxlZCBvbiBudWxsIG9yIHVuZGVmaW5lZCcpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHByZWRpY2F0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cbiAgICB2YXIgbGlzdCA9IE9iamVjdCh0aGlzKTtcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XG4gICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMV07XG4gICAgdmFyIHZhbHVlO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgdmFsdWUgPSBsaXN0W2ldO1xuICAgICAgaWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpLCBsaXN0KSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH07XG59XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleCkge1xuICBBcnJheS5wcm90b3R5cGUuZmluZEluZGV4ID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XG4gICAgaWYgKHRoaXMgPT09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FycmF5LnByb3RvdHlwZS5maW5kSW5kZXggY2FsbGVkIG9uIG51bGwgb3IgdW5kZWZpbmVkJyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgcHJlZGljYXRlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdwcmVkaWNhdGUgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuICAgIHZhciBsaXN0ID0gT2JqZWN0KHRoaXMpO1xuICAgIHZhciBsZW5ndGggPSBsaXN0Lmxlbmd0aCA+Pj4gMDtcbiAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcbiAgICB2YXIgdmFsdWU7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZSA9IGxpc3RbaV07XG4gICAgICBpZiAocHJlZGljYXRlLmNhbGwodGhpc0FyZywgdmFsdWUsIGksIGxpc3QpKSB7XG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH07XG59XG5cblxuLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtYXJyYXkucHJvdG90eXBlLmluY2x1ZGVzXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pbmNsdWRlcykge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnaW5jbHVkZXMnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkge1xuXG4gICAgICAvLyAxLiBMZXQgTyBiZSA/IFRvT2JqZWN0KHRoaXMgdmFsdWUpLlxuICAgICAgaWYgKHRoaXMgPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcInRoaXNcIiBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBvID0gT2JqZWN0KHRoaXMpO1xuXG4gICAgICAvLyAyLiBMZXQgbGVuIGJlID8gVG9MZW5ndGgoPyBHZXQoTywgXCJsZW5ndGhcIikpLlxuICAgICAgdmFyIGxlbiA9IG8ubGVuZ3RoID4+PiAwO1xuXG4gICAgICAvLyAzLiBJZiBsZW4gaXMgMCwgcmV0dXJuIGZhbHNlLlxuICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIDQuIExldCBuIGJlID8gVG9JbnRlZ2VyKGZyb21JbmRleCkuXG4gICAgICAvLyAgICAoSWYgZnJvbUluZGV4IGlzIHVuZGVmaW5lZCwgdGhpcyBzdGVwIHByb2R1Y2VzIHRoZSB2YWx1ZSAwLilcbiAgICAgIHZhciBuID0gZnJvbUluZGV4IHwgMDtcblxuICAgICAgLy8gNS4gSWYgbiDiiaUgMCwgdGhlblxuICAgICAgLy8gIGEuIExldCBrIGJlIG4uXG4gICAgICAvLyA2LiBFbHNlIG4gPCAwLFxuICAgICAgLy8gIGEuIExldCBrIGJlIGxlbiArIG4uXG4gICAgICAvLyAgYi4gSWYgayA8IDAsIGxldCBrIGJlIDAuXG4gICAgICB2YXIgayA9IE1hdGgubWF4KG4gPj0gMCA/IG4gOiBsZW4gLSBNYXRoLmFicyhuKSwgMCk7XG5cbiAgICAgIC8vIDcuIFJlcGVhdCwgd2hpbGUgayA8IGxlblxuICAgICAgd2hpbGUgKGsgPCBsZW4pIHtcbiAgICAgICAgLy8gYS4gTGV0IGVsZW1lbnRLIGJlIHRoZSByZXN1bHQgb2YgPyBHZXQoTywgISBUb1N0cmluZyhrKSkuXG4gICAgICAgIC8vIGIuIElmIFNhbWVWYWx1ZVplcm8oc2VhcmNoRWxlbWVudCwgZWxlbWVudEspIGlzIHRydWUsIHJldHVybiB0cnVlLlxuICAgICAgICAvLyBjLiBJbmNyZWFzZSBrIGJ5IDEuXG4gICAgICAgIC8vIE5PVEU6ID09PSBwcm92aWRlcyB0aGUgY29ycmVjdCBcIlNhbWVWYWx1ZVplcm9cIiBjb21wYXJpc29uIG5lZWRlZCBoZXJlLlxuICAgICAgICBpZiAob1trXSA9PT0gc2VhcmNoRWxlbWVudCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGsrKztcbiAgICAgIH1cblxuICAgICAgLy8gOC4gUmV0dXJuIGZhbHNlXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gdW5pcXVlXG5pZiAoIUFycmF5LnByb3RvdHlwZS51bmlxdWUpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ3VuaXF1ZScsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24oZXF1YWxGdW5jdGlvbiwgbmV3QXJyYXkgPSB0cnVlKSB7XG4gICAgICBpZiAobmV3QXJyYXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VucWl1ZV9uZXcoZXF1YWxGdW5jdGlvbik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLl91bnFpdWUoZXF1YWxGdW5jdGlvbik7XG4gICAgfSxcbiAgfSk7XG5cbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ191bnFpdWVfbmV3Jywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihlcXVhbEZ1bmN0aW9uKSB7XG4gICAgICBsZXQgYXJyYXkgPSBBcnJheS5mcm9tKHRoaXMpO1xuXG4gICAgICByZXR1cm4gYXJyYXkuX3VucWl1ZShlcXVhbEZ1bmN0aW9uKTtcbiAgICB9XG4gIH0pO1xuXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdfdW5xaXVlJywge1xuICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgIHZhbHVlOiBmdW5jdGlvbihlcXVhbEZ1bmN0aW9uKSB7XG4gICAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGg7XG4gICAgICB2YXIgaSA9IC0xO1xuXG4gICAgICB3aGlsZSAoaSsrIDwgbGVuKSB7XG4gICAgICAgIHZhciBqID0gaSArIDE7XG5cbiAgICAgICAgZm9yICg7IGogPCB0aGlzLmxlbmd0aDsgKytqKSB7XG4gICAgICAgICAgdmFyIGlzRXF1YWwgPSBmYWxzZTtcbiAgICAgICAgICBpZiAoZXF1YWxGdW5jdGlvbikge1xuICAgICAgICAgICAgaXNFcXVhbCA9IGVxdWFsRnVuY3Rpb24odGhpc1tpXSwgdGhpc1tqXSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlzRXF1YWwgPSB0aGlzW2ldID09PSB0aGlzW2pdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChpc0VxdWFsKSB7XG4gICAgICAgICAgICB0aGlzLnNwbGljZShqLS0sIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgfSk7XG59XG5cblxuLy8gUHJvZHVjdGlvbiBzdGVwcyBvZiBFQ01BLTI2MiwgRWRpdGlvbiA2LCAyMi4xLjIuMVxuLy8gUmVmZXJlbmNlOiBodHRwczovL3Blb3BsZS5tb3ppbGxhLm9yZy9+am9yZW5kb3JmZi9lczYtZHJhZnQuaHRtbCNzZWMtYXJyYXkuZnJvbVxuaWYgKCFBcnJheS5mcm9tKSB7XG4gIEFycmF5LmZyb20gPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbiAgICB2YXIgaXNDYWxsYWJsZSA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIGZuID09PSAnZnVuY3Rpb24nIHx8IHRvU3RyLmNhbGwoZm4pID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuICAgIH07XG4gICAgdmFyIHRvSW50ZWdlciA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbnVtYmVyID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgIGlmIChpc05hTihudW1iZXIpKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuICAgICAgaWYgKG51bWJlciA9PT0gMCB8fCAhaXNGaW5pdGUobnVtYmVyKSkge1xuICAgICAgICByZXR1cm4gbnVtYmVyO1xuICAgICAgfVxuICAgICAgcmV0dXJuIChudW1iZXIgPiAwID8gMSA6IC0xKSAqIE1hdGguZmxvb3IoTWF0aC5hYnMobnVtYmVyKSk7XG4gICAgfTtcbiAgICB2YXIgbWF4U2FmZUludGVnZXIgPSBNYXRoLnBvdygyLCA1MykgLSAxO1xuICAgIHZhciB0b0xlbmd0aCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB2YXIgbGVuID0gdG9JbnRlZ2VyKHZhbHVlKTtcbiAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChsZW4sIDApLCBtYXhTYWZlSW50ZWdlcik7XG4gICAgfTtcblxuICAgIC8vIFRoZSBsZW5ndGggcHJvcGVydHkgb2YgdGhlIGZyb20gbWV0aG9kIGlzIDEuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGZyb20oYXJyYXlMaWtlIC8qLCBtYXBGbiwgdGhpc0FyZyAqLyApIHtcbiAgICAgIC8vIDEuIExldCBDIGJlIHRoZSB0aGlzIHZhbHVlLlxuICAgICAgdmFyIEMgPSB0aGlzO1xuXG4gICAgICAvLyAyLiBMZXQgaXRlbXMgYmUgVG9PYmplY3QoYXJyYXlMaWtlKS5cbiAgICAgIHZhciBpdGVtcyA9IE9iamVjdChhcnJheUxpa2UpO1xuXG4gICAgICAvLyAzLiBSZXR1cm5JZkFicnVwdChpdGVtcykuXG4gICAgICBpZiAoYXJyYXlMaWtlID09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkFycmF5LmZyb20gcmVxdWlyZXMgYW4gYXJyYXktbGlrZSBvYmplY3QgLSBub3QgbnVsbCBvciB1bmRlZmluZWRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIDQuIElmIG1hcGZuIGlzIHVuZGVmaW5lZCwgdGhlbiBsZXQgbWFwcGluZyBiZSBmYWxzZS5cbiAgICAgIHZhciBtYXBGbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdm9pZCB1bmRlZmluZWQ7XG4gICAgICB2YXIgVDtcbiAgICAgIGlmICh0eXBlb2YgbWFwRm4gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIC8vIDUuIGVsc2VcbiAgICAgICAgLy8gNS4gYSBJZiBJc0NhbGxhYmxlKG1hcGZuKSBpcyBmYWxzZSwgdGhyb3cgYSBUeXBlRXJyb3IgZXhjZXB0aW9uLlxuICAgICAgICBpZiAoIWlzQ2FsbGFibGUobWFwRm4pKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJyYXkuZnJvbTogd2hlbiBwcm92aWRlZCwgdGhlIHNlY29uZCBhcmd1bWVudCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDUuIGIuIElmIHRoaXNBcmcgd2FzIHN1cHBsaWVkLCBsZXQgVCBiZSB0aGlzQXJnOyBlbHNlIGxldCBUIGJlIHVuZGVmaW5lZC5cbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgVCA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyAxMC4gTGV0IGxlblZhbHVlIGJlIEdldChpdGVtcywgXCJsZW5ndGhcIikuXG4gICAgICAvLyAxMS4gTGV0IGxlbiBiZSBUb0xlbmd0aChsZW5WYWx1ZSkuXG4gICAgICB2YXIgbGVuID0gdG9MZW5ndGgoaXRlbXMubGVuZ3RoKTtcblxuICAgICAgLy8gMTMuIElmIElzQ29uc3RydWN0b3IoQykgaXMgdHJ1ZSwgdGhlblxuICAgICAgLy8gMTMuIGEuIExldCBBIGJlIHRoZSByZXN1bHQgb2YgY2FsbGluZyB0aGUgW1tDb25zdHJ1Y3RdXSBpbnRlcm5hbCBtZXRob2Qgb2YgQyB3aXRoIGFuIGFyZ3VtZW50IGxpc3QgY29udGFpbmluZyB0aGUgc2luZ2xlIGl0ZW0gbGVuLlxuICAgICAgLy8gMTQuIGEuIEVsc2UsIExldCBBIGJlIEFycmF5Q3JlYXRlKGxlbikuXG4gICAgICB2YXIgQSA9IGlzQ2FsbGFibGUoQykgPyBPYmplY3QobmV3IEMobGVuKSkgOiBuZXcgQXJyYXkobGVuKTtcblxuICAgICAgLy8gMTYuIExldCBrIGJlIDAuXG4gICAgICB2YXIgayA9IDA7XG4gICAgICAvLyAxNy4gUmVwZWF0LCB3aGlsZSBrIDwgbGVu4oCmIChhbHNvIHN0ZXBzIGEgLSBoKVxuICAgICAgdmFyIGtWYWx1ZTtcbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XG4gICAgICAgIGtWYWx1ZSA9IGl0ZW1zW2tdO1xuICAgICAgICBpZiAobWFwRm4pIHtcbiAgICAgICAgICBBW2tdID0gdHlwZW9mIFQgPT09ICd1bmRlZmluZWQnID8gbWFwRm4oa1ZhbHVlLCBrKSA6IG1hcEZuLmNhbGwoVCwga1ZhbHVlLCBrKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBBW2tdID0ga1ZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGsgKz0gMTtcbiAgICAgIH1cbiAgICAgIC8vIDE4LiBMZXQgcHV0U3RhdHVzIGJlIFB1dChBLCBcImxlbmd0aFwiLCBsZW4sIHRydWUpLlxuICAgICAgQS5sZW5ndGggPSBsZW47XG4gICAgICAvLyAyMC4gUmV0dXJuIEEuXG4gICAgICByZXR1cm4gQTtcbiAgICB9O1xuICB9KCkpO1xufVxuXG5pZiAoIUFycmF5LmVxdWFsKSB7XG4gIEFycmF5LmVxdWFsID0gZnVuY3Rpb24oYXJyMSwgYXJyMiwgc3RyaWN0ID0gdHJ1ZSkge1xuICAgIGlmIChhcnIxID09PSB1bmRlZmluZWQgfHwgYXJyMiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGxlbmd0aCA9IGFycjEubGVuZ3RoXG4gICAgaWYgKGxlbmd0aCAhPT0gYXJyMi5sZW5ndGgpIHJldHVybiBmYWxzZVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzdHJpY3QpIHtcbiAgICAgICAgaWYgKGFycjFbaV0gIT09IGFycjJbaV0pIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHZhbHVlMSA9IGFycjFbaV07XG4gICAgICAgIHZhciB2YWx1ZTIgPSBhcnIyW2ldO1xuICAgICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUxKSAmJiBBcnJheS5pc0FycmF5KHZhbHVlMikpIHtcbiAgICAgICAgICByZXN1bHQgPSBBcnJheS5lcXVhbCh2YWx1ZTEsIHZhbHVlMiwgc3RyaWN0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXN1bHQgPSAodmFsdWUxID09IHZhbHVlMik7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIH1cblxuICAgIHJldHVybiB0cnVlXG4gIH07XG59XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmlzRXF1YWwpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2lzRXF1YWwnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKG90aGVyQXJyYXksIHN0cmljdCA9IHRydWUpIHtcbiAgICAgIHJldHVybiBBcnJheS5lcXVhbCh0aGlzLCBvdGhlckFycmF5LCBzdHJpY3QpO1xuICAgIH0sXG4gIH0pO1xufVxuXG5pZiAoIUFycmF5LnNvcnRCeU51bWJlcikge1xuICBBcnJheS5zb3J0QnlOdW1iZXIgPSBmdW5jdGlvbiAobjEsIG4yLCBhc2MgPSB0cnVlKSB7XG4gICAgcmV0dXJuIChuMSAtIG4yKSAqIChhc2MgPyAxIDogLTEpO1xuICB9O1xufVxuXG5pZiAoIUFycmF5LnByb3RvdHlwZS5maW5kU3ViQXJyYXlJbmRleHMpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2ZpbmRTdWJBcnJheUluZGV4cycsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24gKHN1YkFycmF5LCBmKSB7XG4gICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICBmb3IgKHZhciBpIGluIHN1YkFycmF5KSB7XG4gICAgICAgIGxldCBzdWJWYWx1ZSA9IHN1YkFycmF5W2ldO1xuICAgICAgICBsZXQgZmluZEZ1bmMgPSBmIHx8IGZ1bmN0aW9uICh0aGlzVmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gc3ViVmFsdWUgPT09IHRoaXNWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgaW5kZXggPSB0aGlzLmZpbmRJbmRleChmaW5kRnVuYyk7XG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgICAgaW5kZXhzLnB1c2goaW5kZXgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGluZGV4cyA9IFtdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBpbmRleHMubGVuZ3RoID4gMCA/IGluZGV4cyA6IG51bGw7XG4gICAgfSxcbiAgfSk7XG59XG5cbmlmICghQXJyYXkucHJvdG90eXBlLnRyYW5zbGF0aW9uV2l0aFN0YXJ0SW5kZXgpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ3RyYW5zbGF0aW9uV2l0aFN0YXJ0SW5kZXgnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIChzdGFydEluZGV4KSB7XG4gICAgICBpZiAoc3RhcnRJbmRleCA9PSAwKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICBpZiAoc3RhcnRJbmRleCA+PSB0aGlzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgbGV0IHByZSA9IHRoaXMuc2xpY2Uoc3RhcnRJbmRleCk7XG4gICAgICBsZXQgbGFzdCA9IHRoaXMuc2xpY2UoMCwgc3RhcnRJbmRleCk7XG4gICAgICBsZXQgcmVzdWx0ID0gcHJlLmNvbmNhdChsYXN0KTtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuICB9KTtcbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUua3FfaW5zZXJ0KSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdrcV9pbnNlcnQnLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKGluZGV4LCBlKSB7XG4gICAgICBpZiAoZSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICBpZiAoaW5kZXggPj0gdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5wdXNoKGUpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc3BsaWNlKGluZGV4LCAwLCBlKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgfSk7XG59XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmtxX2V4Y2x1ZGVzKSB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdrcV9leGNsdWRlcycsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICB2YWx1ZTogZnVuY3Rpb24ob3RoZXJBcnJheSkge1xuICAgICAgaWYgKG90aGVyQXJyYXkgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCFvdGhlckFycmF5LmluY2x1ZGVzKGVsZW1lbnQpKSB7XG4gICAgICAgICAgcmVzdWx0LnB1c2goZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG4gIH0pO1xufSIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuXG5sZXQgQXVkaW9NYW5hZ2VyID0gY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgaGFsbF9iZ206IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIGdhbWVfYmdtOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgICAgICBjb21wYXJlX2JnbToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8g5omT5p6qXG4gICAgICAgIGRhUWlhbmc6IHtcbiAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG5cbiAgICAgICAgYnV0dG9uQ2xpY2tTdXJlOiB7XG4gICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuXG4gICAgICAgIGZhcGFpOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcblxuICAgICAgICBjbGlja19wdWJsaWM6IHtcbiAgICAgICAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuICAgICAgICBjbGlja19jYW5jZWw6IHtcbiAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcbiAgICAgICAgY2xpY2tfY3JlYXRlUm9vbToge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHVybDogY2MuQXVkaW9DbGlwXG4gICAgICAgIH0sXG4gICAgICAgIHdpbmRvdzoge1xuICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuICAgICAgICBjbGlja193ZWl4aW5fbG9naW46e1xuICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICB1cmw6IGNjLkF1ZGlvQ2xpcFxuICAgICAgICB9LFxuICAgICAgICBmYW5nUGFpOntcbiAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgdXJsOiBjYy5BdWRpb0NsaXBcbiAgICAgICAgfSxcbiAgICB9LFxuXG4gICAgc3RhdGljczoge1xuICAgICAgaW5zdGFuY2U6IG51bGwsXG4gICAgfSxcblxuICAgIG9uTG9hZDpmdW5jdGlvbigpIHtcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZSA9IHRoaXM7XG4gICAgICB0aGlzLl9yZWdpc3RlckFwcEFjdGl2ZUNoYW5nZSgpO1xuXG4gICAgICAgIHRoaXMuc291bmRPbiA9IHRydWU7XG4gICAgICAgIGNjLmdhbWUuYWRkUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSk7XG4gICAgICAgIGlmIChjYy5nYW1lLmlzUGVyc2lzdFJvb3ROb2RlKHRoaXMubm9kZSkpIHtcbiAgICAgICAgICAgIGNjLmxvZygn5re75Yqg5YWo5bGA6IqC54K55oiQ5YqfJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tVmFsdWUgPSBtYW5hZ2VyLmdldE11c2ljVmFsdWUoKTtcbiAgICAgICAgdGhpcy5tRVZhbHVlID0gbWFuYWdlci5nZXRNdXNpY0VmZmVjdFZhbHVlKCk7XG4gICAgICAgIHRoaXMuYmdBdWRpb0lkID0gLTE7XG4gICAgfSxcblxuICAgIHN0b3BIYWxsTXVzaWM6IGZ1bmN0aW9uKCl7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnN0b3AodGhpcy5iZ0F1ZGlvSWQpO1xuICAgIH0sXG5cbiAgICBwbGF5TXVzaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJnQXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXlNdXNpYyggdGhpcy5oYWxsX2JnbSwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xuICAgICAgICAgICAgY2MubG9nKCdwbGF5Jyk7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRWb2x1bWUodGhpcy5iZ0F1ZGlvSWQsdGhpcy5tVmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIC8vY2MuYXVkaW9FbmdpbmUucGxheU11c2ljKCB1cmwsIHRydWUgKVxuICAgIH0sXG5cbiAgICAvKnBsYXlEZXNrTXVzaWM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmJnQXVkaW9JZCA9IGNjLmF1ZGlvRW5naW5lLnBsYXlNdXNpYyggdGhpcy5nYW1lX2JnbSwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKHRoaXMuYmdBdWRpb0lkLHRoaXMubVZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sKi9cblxuICAgIHBsYXlDb21wYXJlQ2FyZHNNdXNpYzogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5iZ0F1ZGlvSWQgPSBjYy5hdWRpb0VuZ2luZS5wbGF5TXVzaWMoIHRoaXMuY29tcGFyZV9iZ20sIHRydWUpO1xuICAgICAgaWYgKHRoaXMuYmdBdWRpb0lkICE9IC0xKSB7XG4gICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZSh0aGlzLmJnQXVkaW9JZCx0aGlzLm1WYWx1ZSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHBsYXlEYVFpYW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBzdGFydCA9IDA7IHN0YXJ0IDw9IDEuNjsgc3RhcnQgPSBzdGFydCArIDAuNSkge1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmRhUWlhbmcpO1xuICAgICAgICB9LmJpbmQodGhpcyksIHN0YXJ0KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8g4oCc5omT5p6q4oCdXG4gICAgcGxheUh1bWFuRGFRaWFuZzogZnVuY3Rpb24gKHNleCA9IDEpIHtcbiAgICAgIHZhciBwYXRoID0gXCJyZXNvdXJjZXMvc291bmRzL1wiICsgKHNleCA9PSAxID8gXCJtYW5cIiA6IFwid29tYW5cIik7XG4gICAgICBwYXRoID0gcGF0aCArIFwiL2RhcWlhbmcxLndhdlwiO1xuXG4gICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgcGxheVBva2VyQ2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL3B1YmxpYy9wb2tlcl9jbGljay53YXYnKTtcbiAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT6Z+z5pWIXG4gICAgcGxheUhvbWVSdW46IGZ1bmN0aW9uIChzZXggPSAxKSB7XG4gICAgICBsZXQgcGF0aCA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aChzZXgpICsgXCJzcGVjaWFsMS53YXZcIjtcbiAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7lj5HniYzpn7PmlYhcbiAgICBwbGF5RmFQYWk6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuZmFwYWkpO1xuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgNjsgaW5kZXgrKykge1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmZhcGFpKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgaW5kZXggKiAwLjEpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHBsYXlDYXJkVHlwZTogZnVuY3Rpb24gKHNleCA9IDEsIHR5cGUgPSAtMSkge1xuICAgICAgLy8g5Y+q5pKt5pS+5pmu6YCa57G75Z6L55qE6K+t6Z+zXG4gICAgICBpZiAoKHR5cGUgPj0gMTApIHx8ICh0eXBlIDwgMCkpIHtcbiAgICAgICAgLy8gMTAg5Y+K5Lul5LiK5piv54m55q6K54mMXG4gICAgICAgICAgbGV0IHBhdGggPSB0aGlzLl9zb3VuZHNIdW1hblBhdGgoc2V4KSArICh0eXBlKSArIFwiLndhdlwiO1xuICAgICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgcGF0aCA9IHRoaXMuX3NvdW5kc0h1bWFuUGF0aChzZXgpICsgXCJjb21tb25cIiArICh0eXBlICsgMSkgKyBcIi53YXZcIjtcbiAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL4g5byA5aeL5q+U54mMXG4gICAgcGxheVN0YXJ0Q29tcGFyZTogZnVuY3Rpb24gKHNleCA9IDEpIHtcbiAgICAgIGxldCBwYXRoID0gdGhpcy5fc291bmRzSHVtYW5QYXRoKHNleCkgKyBcInN0YXJ0X2NvbXBhcmUud2F2XCI7XG4gICAgICBsZXQgdXJsID0gY2MudXJsLnJhdyhwYXRoKTtcbiAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgcGxheVdpbjogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcoJ3Jlc291cmNlcy9zb3VuZHMvb3BlbmZhY2Uvd2luLm1wMycpO1xuICAgICAgdGhpcy5fcGxheVNGWCh1cmwpO1xuICAgIH0sXG5cbiAgICBwbGF5TG9zZTogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHVybCA9IGNjLnVybC5yYXcoJ3Jlc291cmNlcy9zb3VuZHMvb3BlbmZhY2UvbG9zZS5tcDMnKTtcbiAgICAgIHRoaXMuX3BsYXlTRlgodXJsKTtcbiAgICB9LFxuXG4gICAgX3NvdW5kc0h1bWFuUGF0aDogZnVuY3Rpb24gKHNleCkge1xuICAgICAgbGV0IHBhdGggPSBcInJlc291cmNlcy9zb3VuZHMvXCIgKyAoc2V4ID09IDEgPyBcIm1hblwiIDogXCJ3b21hblwiKSArIFwiL1wiO1xuICAgICAgcmV0dXJuIHBhdGg7XG4gICAgfSxcblxuICAgIHNldEJnTXVzaWNWb2x1bW46IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubVZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmICh0aGlzLmJnQXVkaW9JZCAhPSAtMSkge1xuICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnNldFZvbHVtZSh0aGlzLmJnQXVkaW9JZCx2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0RWZmZWN0TXVzaWNWb2x1bTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdGhpcy5tRVZhbHVlID0gdmFsdWU7XG4gICAgfSxcblxuICAgIC8q6IGK5aSpKi9cbiAgICBwbGF5Q2hhdEF1ZGlvOmZ1bmN0aW9uKHNleCwgc3RyKSB7XG4gICAgICBsZXQgaW5kZXggPSB0aGlzLmNoYXRUZXh0cygpLmluZGV4T2Yoc3RyKTtcbiAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAgIGxldCBudW1iZXIgPSAoKHNleCA9PSAxKSA/IDEwMDAgOiAyMDAwKSArIGluZGV4O1xuICAgICAgICBsZXQgcGF0aCA9IFwicmVzb3VyY2VzL3NvdW5kcy9jaGF0L1wiICsgbnVtYmVyICsgXCIud2F2XCI7XG4gICAgICAgIGxldCB1cmwgPSBjYy51cmwucmF3KHBhdGgpO1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHVybCk7XG4gICAgfSxcblxuICAgIC8qJ+W+iOmrmOWFtOWSjOS9oOS7rOS4gOi1t+aJk+eJjO+8gScsXG4gICAgICAgICflv6vngrnlhL/lkKfvvIzmiJHnrYnlvpfoirHlhL/pg73osKLkuoZ+77yBJyxcbiAgICAgICAgJ+aApeS7gOS5iO+8jOiuqeaIkeaDs+aDs+aAjuS5iOaJk++8gScsXG4gICAgICAgICfov5nniYznnJ/lpb3vvIzlhajlnpLmiZPmnInluIzmnJvllYrvvIEnLFxuICAgICAgICAn5oiR5piv5LiA5Liq56We5p6q5omL77yM5omT5oqi5pys6aKG5aSn77yBJyxcbiAgICAgICAgJ+i/meaKiueJjOaVouS4jeaVouWGjeawtOS4gOeCueWViu+8gScsXG4gICAgICAgICflj4jovpPllabvvIHlpKfniLfnu5nmnaHmtLvot6/lkKfvvIEnLFxuICAgICAgICAn5L2g5piv5aa55aa5IOi/mOaYr+WTpeWTpeWViicsXG4gICAgICAgICfkuqTkuKrmnIvlj4vlkKfjgILjgIInLFxuICAgICAgICAn5oiR5pyJ5LqL5YWI6LWw5LqG77yM5LiL5qyh5YaN546p5ZCn77yBJyxcbiAgICAgICAgJ+WGjeingeS6hiDmiJHkvJrmg7Plv7XlpKflrrbnmoTvvIzvvIwnLFxuICAgICAgICAn5oCO5LmI5Y+I5pat57q/5LqGICDnvZHnu5zmgI7kuYjov5nkuYjlt67llYrvvIzvvIwnXG4gICAgKi9cbiAgICBjaGF0VGV4dHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgICfkuI3opoHlkLXkuobvvIzkuJPlv4PnjqnmuLjmiI/lkKfvvIEnLFxuICAgICAgICAn5aSn5a625LiN6KaB6LWw77yM5Yaz5oiY5Yiw5aSp5Lqufu+8gScsXG4gICAgICAgICflpKflrrblpb3vvIzlvojpq5jlhbTop4HliLDlkITkvY3vvIEnLFxuICAgICAgICAn5ZCE5L2N5LiN5aW95oSP5oCd77yM5oiR56a75byA5LiA5Lya77yBJyxcbiAgICAgICAgJ+WSjOS9oOWQiOS9nOecn+aYr+WkquaEieW/q+S6hu+8gScsXG4gICAgICAgICflv6vngrnlhL/llYrvvIzpg73nrYnlvpfmiJHoirHpg73osKLkuobvvIEnLFxuICAgICAgICAn5L2g55qE54mM5omT5b6X5aSq5aW95LqG77yBJyxcbiAgICAgICAgJ+S9oOaYr+WmueWmuSDov5jmmK/lk6Xlk6XllYonLFxuICAgICAgICAn5Lqk5Liq5pyL5Y+L5ZCn44CC44CCJyxcbiAgICAgICAgJ+aIkeacieS6i+WFiOi1sOS6hu+8jOS4i+asoeWGjeeOqeWQp++8gScsXG4gICAgICAgICflho3op4HkuoYg5oiR5Lya5oOz5b+15aSn5a6255qE77yM77yMJyxcbiAgICAgICAgJ+aAjuS5iOWPiOaWree6v+S6hiAg572R57uc5oCO5LmI6L+Z5LmI5beu5ZWK77yM77yMJ1xuICAgICAgXTtcbiAgICB9LFxuXG4gICAgcGF1c2VNdXNpYzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc291bmRPbiA9IGZhbHNlO1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5wYXVzZU11c2ljKCk7XG4gICAgfSxcblxuICAgIHJlc3VtZU11c2ljOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zb3VuZE9uID0gdHJ1ZTtcbiAgICAgICAgY2MuYXVkaW9FbmdpbmUucmVzdW1lTXVzaWMoKTtcbiAgICB9LFxuXG4gICAgX3BsYXlTRlg6IGZ1bmN0aW9uKGNsaXApIHtcbiAgICAgICAgaWYgKHRoaXMuc291bmRPbikge1xuICAgICAgICAgICAgdmFyIGF1ZGlvSWQgPSBjYy5hdWRpb0VuZ2luZS5wbGF5RWZmZWN0KCBjbGlwLCBmYWxzZSApO1xuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc2V0Vm9sdW1lKGF1ZGlvSWQsdGhpcy5tRVZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBhdWRpb0lkO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgICAvLyBNQVJLOiDliY3lkI7lj7Dmk43kvZxcbiAgICBfcmVnaXN0ZXJBcHBBY3RpdmVDaGFuZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2MuZ2FtZS5vbihjYy5nYW1lLkVWRU5UX0hJREUsIHRoaXMuX2FwcEVudGVyQmFja2dyb3VuZCwgdGhpcyk7XG4gICAgICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9TSE9XLCB0aGlzLl9hcHBCZWNvbUFjdGl2ZSwgdGhpcyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAgKiDov5vlhaXlkI7lj7BcbiAgICAgICovXG4gICAgX2FwcEVudGVyQmFja2dyb3VuZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xuICAgICAgICBpZiAobm93IC0gdGhpcy5fbGFzdEFwcEVudGVyQmFja2dyb3VuZFRpbWUgPCAxMDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sYXN0QXBwRW50ZXJCYWNrZ3JvdW5kVGltZSA9IG5vdztcblxuICAgICAgICB0aGlzLnBhdXNlTXVzaWMoKTtcbiAgICB9LFxuXG4gIC8qKlxuICAgKiDov5vlhaXliY3lj7AgXG4gICAqL1xuICBfYXBwQmVjb21BY3RpdmU6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lIDwgMTAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2xhc3RBcHBCZWNvbUFjdGl2ZVRpbWUgPSBub3c7XG5cbiAgICB0aGlzLnJlc3VtZU11c2ljKCk7XG4gIH0sXG5cbiAgLyrnoa7lrprmjInpkq7pn7PmlYgqL1xuICAgIHBsYXlCdG5DbGlja1NGWDpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmJ1dHRvbkNsaWNrU3VyZSk7XG4gICAgfSxcbiAgLyrlhazlhbHmjInpkq7vvIzmjInplK7miJbogIXlhbPpl63mjInpkq7kuYvnsbvnmoTpn7PmlYgqL1xuICAgIHBhbHlCdG5QdWJsaWNTRlg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfcHVibGljKTtcbiAgICB9LFxuXG4gICAgLyrlj5bmtojmjInpkq7pn7PmlYgqL1xuICAgIHBhbHlCdG5DYW5jZWxDbGlja1NGWDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5jbGlja19jYW5jZWwpO1xuICAgIH0sXG4gICAgcGFseUJ0bkNyZWF0ZVJvb21TRlg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9wbGF5U0ZYKHRoaXMuY2xpY2tfY3JlYXRlUm9vbSk7XG4gICAgfSxcbiAgICBwYWx5V2luZG93U0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy53aW5kb3cpO1xuICAgIH0sXG4gICAgcGFseVdlaVhpbkxvZ2luU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3BsYXlTRlgodGhpcy5jbGlja193ZWl4aW5fbG9naW4pO1xuICAgIH0sXG4gICAgcGFseUZhbmdQYWlTRlg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcGxheVNGWCh0aGlzLmZhbmdQYWkpO1xuICAgIH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBdWRpb01hbmFnZXI7XG4iLCIndXNlIHN0cmljdCdcblxuZXhwb3J0cy5ieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aFxuZXhwb3J0cy50b0J5dGVBcnJheSA9IHRvQnl0ZUFycmF5XG5leHBvcnRzLmZyb21CeXRlQXJyYXkgPSBmcm9tQnl0ZUFycmF5XG5cbnZhciBsb29rdXAgPSBbXVxudmFyIHJldkxvb2t1cCA9IFtdXG52YXIgQXJyID0gdHlwZW9mIFVpbnQ4QXJyYXkgIT09ICd1bmRlZmluZWQnID8gVWludDhBcnJheSA6IEFycmF5XG5cbnZhciBjb2RlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nXG5mb3IgKHZhciBpID0gMCwgbGVuID0gY29kZS5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICBsb29rdXBbaV0gPSBjb2RlW2ldXG4gIHJldkxvb2t1cFtjb2RlLmNoYXJDb2RlQXQoaSldID0gaVxufVxuXG5yZXZMb29rdXBbJy0nLmNoYXJDb2RlQXQoMCldID0gNjJcbnJldkxvb2t1cFsnXycuY2hhckNvZGVBdCgwKV0gPSA2M1xuXG5mdW5jdGlvbiBwbGFjZUhvbGRlcnNDb3VudCAoYjY0KSB7XG4gIHZhciBsZW4gPSBiNjQubGVuZ3RoXG4gIGlmIChsZW4gJSA0ID4gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdHJpbmcuIExlbmd0aCBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgNCcpXG4gIH1cblxuICAvLyB0aGUgbnVtYmVyIG9mIGVxdWFsIHNpZ25zIChwbGFjZSBob2xkZXJzKVxuICAvLyBpZiB0aGVyZSBhcmUgdHdvIHBsYWNlaG9sZGVycywgdGhhbiB0aGUgdHdvIGNoYXJhY3RlcnMgYmVmb3JlIGl0XG4gIC8vIHJlcHJlc2VudCBvbmUgYnl0ZVxuICAvLyBpZiB0aGVyZSBpcyBvbmx5IG9uZSwgdGhlbiB0aGUgdGhyZWUgY2hhcmFjdGVycyBiZWZvcmUgaXQgcmVwcmVzZW50IDIgYnl0ZXNcbiAgLy8gdGhpcyBpcyBqdXN0IGEgY2hlYXAgaGFjayB0byBub3QgZG8gaW5kZXhPZiB0d2ljZVxuICByZXR1cm4gYjY0W2xlbiAtIDJdID09PSAnPScgPyAyIDogYjY0W2xlbiAtIDFdID09PSAnPScgPyAxIDogMFxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChiNjQpIHtcbiAgLy8gYmFzZTY0IGlzIDQvMyArIHVwIHRvIHR3byBjaGFyYWN0ZXJzIG9mIHRoZSBvcmlnaW5hbCBkYXRhXG4gIHJldHVybiBiNjQubGVuZ3RoICogMyAvIDQgLSBwbGFjZUhvbGRlcnNDb3VudChiNjQpXG59XG5cbmZ1bmN0aW9uIHRvQnl0ZUFycmF5IChiNjQpIHtcbiAgdmFyIGksIGosIGwsIHRtcCwgcGxhY2VIb2xkZXJzLCBhcnJcbiAgdmFyIGxlbiA9IGI2NC5sZW5ndGhcbiAgcGxhY2VIb2xkZXJzID0gcGxhY2VIb2xkZXJzQ291bnQoYjY0KVxuXG4gIGFyciA9IG5ldyBBcnIobGVuICogMyAvIDQgLSBwbGFjZUhvbGRlcnMpXG5cbiAgLy8gaWYgdGhlcmUgYXJlIHBsYWNlaG9sZGVycywgb25seSBnZXQgdXAgdG8gdGhlIGxhc3QgY29tcGxldGUgNCBjaGFyc1xuICBsID0gcGxhY2VIb2xkZXJzID4gMCA/IGxlbiAtIDQgOiBsZW5cblxuICB2YXIgTCA9IDBcblxuICBmb3IgKGkgPSAwLCBqID0gMDsgaSA8IGw7IGkgKz0gNCwgaiArPSAzKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMTgpIHwgKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMSldIDw8IDEyKSB8IChyZXZMb29rdXBbYjY0LmNoYXJDb2RlQXQoaSArIDIpXSA8PCA2KSB8IHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpICsgMyldXG4gICAgYXJyW0wrK10gPSAodG1wID4+IDE2KSAmIDB4RkZcbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICBpZiAocGxhY2VIb2xkZXJzID09PSAyKSB7XG4gICAgdG1wID0gKHJldkxvb2t1cFtiNjQuY2hhckNvZGVBdChpKV0gPDwgMikgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPj4gNClcbiAgICBhcnJbTCsrXSA9IHRtcCAmIDB4RkZcbiAgfSBlbHNlIGlmIChwbGFjZUhvbGRlcnMgPT09IDEpIHtcbiAgICB0bXAgPSAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkpXSA8PCAxMCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAxKV0gPDwgNCkgfCAocmV2TG9va3VwW2I2NC5jaGFyQ29kZUF0KGkgKyAyKV0gPj4gMilcbiAgICBhcnJbTCsrXSA9ICh0bXAgPj4gOCkgJiAweEZGXG4gICAgYXJyW0wrK10gPSB0bXAgJiAweEZGXG4gIH1cblxuICByZXR1cm4gYXJyXG59XG5cbmZ1bmN0aW9uIHRyaXBsZXRUb0Jhc2U2NCAobnVtKSB7XG4gIHJldHVybiBsb29rdXBbbnVtID4+IDE4ICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDEyICYgMHgzRl0gKyBsb29rdXBbbnVtID4+IDYgJiAweDNGXSArIGxvb2t1cFtudW0gJiAweDNGXVxufVxuXG5mdW5jdGlvbiBlbmNvZGVDaHVuayAodWludDgsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIHRtcFxuICB2YXIgb3V0cHV0ID0gW11cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpICs9IDMpIHtcbiAgICB0bXAgPSAodWludDhbaV0gPDwgMTYpICsgKHVpbnQ4W2kgKyAxXSA8PCA4KSArICh1aW50OFtpICsgMl0pXG4gICAgb3V0cHV0LnB1c2godHJpcGxldFRvQmFzZTY0KHRtcCkpXG4gIH1cbiAgcmV0dXJuIG91dHB1dC5qb2luKCcnKVxufVxuXG5mdW5jdGlvbiBmcm9tQnl0ZUFycmF5ICh1aW50OCkge1xuICB2YXIgdG1wXG4gIHZhciBsZW4gPSB1aW50OC5sZW5ndGhcbiAgdmFyIGV4dHJhQnl0ZXMgPSBsZW4gJSAzIC8vIGlmIHdlIGhhdmUgMSBieXRlIGxlZnQsIHBhZCAyIGJ5dGVzXG4gIHZhciBvdXRwdXQgPSAnJ1xuICB2YXIgcGFydHMgPSBbXVxuICB2YXIgbWF4Q2h1bmtMZW5ndGggPSAxNjM4MyAvLyBtdXN0IGJlIG11bHRpcGxlIG9mIDNcblxuICAvLyBnbyB0aHJvdWdoIHRoZSBhcnJheSBldmVyeSB0aHJlZSBieXRlcywgd2UnbGwgZGVhbCB3aXRoIHRyYWlsaW5nIHN0dWZmIGxhdGVyXG4gIGZvciAodmFyIGkgPSAwLCBsZW4yID0gbGVuIC0gZXh0cmFCeXRlczsgaSA8IGxlbjI7IGkgKz0gbWF4Q2h1bmtMZW5ndGgpIHtcbiAgICBwYXJ0cy5wdXNoKGVuY29kZUNodW5rKHVpbnQ4LCBpLCAoaSArIG1heENodW5rTGVuZ3RoKSA+IGxlbjIgPyBsZW4yIDogKGkgKyBtYXhDaHVua0xlbmd0aCkpKVxuICB9XG5cbiAgLy8gcGFkIHRoZSBlbmQgd2l0aCB6ZXJvcywgYnV0IG1ha2Ugc3VyZSB0byBub3QgZm9yZ2V0IHRoZSBleHRyYSBieXRlc1xuICBpZiAoZXh0cmFCeXRlcyA9PT0gMSkge1xuICAgIHRtcCA9IHVpbnQ4W2xlbiAtIDFdXG4gICAgb3V0cHV0ICs9IGxvb2t1cFt0bXAgPj4gMl1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPDwgNCkgJiAweDNGXVxuICAgIG91dHB1dCArPSAnPT0nXG4gIH0gZWxzZSBpZiAoZXh0cmFCeXRlcyA9PT0gMikge1xuICAgIHRtcCA9ICh1aW50OFtsZW4gLSAyXSA8PCA4KSArICh1aW50OFtsZW4gLSAxXSlcbiAgICBvdXRwdXQgKz0gbG9va3VwW3RtcCA+PiAxMF1cbiAgICBvdXRwdXQgKz0gbG9va3VwWyh0bXAgPj4gNCkgJiAweDNGXVxuICAgIG91dHB1dCArPSBsb29rdXBbKHRtcCA8PCAyKSAmIDB4M0ZdXG4gICAgb3V0cHV0ICs9ICc9J1xuICB9XG5cbiAgcGFydHMucHVzaChvdXRwdXQpXG5cbiAgcmV0dXJuIHBhcnRzLmpvaW4oJycpXG59XG4iLCIvKiFcbiAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLlxuICpcbiAqIEBhdXRob3IgICBGZXJvc3MgQWJvdWtoYWRpamVoIDxmZXJvc3NAZmVyb3NzLm9yZz4gPGh0dHA6Ly9mZXJvc3Mub3JnPlxuICogQGxpY2Vuc2UgIE1JVFxuICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wcm90byAqL1xuXG4ndXNlIHN0cmljdCdcblxudmFyIGJhc2U2NCA9IHJlcXVpcmUoJ2Jhc2U2NC1qcycpXG52YXIgaWVlZTc1NCA9IHJlcXVpcmUoJ2llZWU3NTQnKVxudmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5JylcblxuZXhwb3J0cy5CdWZmZXIgPSBCdWZmZXJcbmV4cG9ydHMuU2xvd0J1ZmZlciA9IFNsb3dCdWZmZXJcbmV4cG9ydHMuSU5TUEVDVF9NQVhfQllURVMgPSA1MFxuXG4vKipcbiAqIElmIGBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVGA6XG4gKiAgID09PSB0cnVlICAgIFVzZSBVaW50OEFycmF5IGltcGxlbWVudGF0aW9uIChmYXN0ZXN0KVxuICogICA9PT0gZmFsc2UgICBVc2UgT2JqZWN0IGltcGxlbWVudGF0aW9uIChtb3N0IGNvbXBhdGlibGUsIGV2ZW4gSUU2KVxuICpcbiAqIEJyb3dzZXJzIHRoYXQgc3VwcG9ydCB0eXBlZCBhcnJheXMgYXJlIElFIDEwKywgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBTYWZhcmkgNS4xKyxcbiAqIE9wZXJhIDExLjYrLCBpT1MgNC4yKy5cbiAqXG4gKiBEdWUgdG8gdmFyaW91cyBicm93c2VyIGJ1Z3MsIHNvbWV0aW1lcyB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uIHdpbGwgYmUgdXNlZCBldmVuXG4gKiB3aGVuIHRoZSBicm93c2VyIHN1cHBvcnRzIHR5cGVkIGFycmF5cy5cbiAqXG4gKiBOb3RlOlxuICpcbiAqICAgLSBGaXJlZm94IDQtMjkgbGFja3Mgc3VwcG9ydCBmb3IgYWRkaW5nIG5ldyBwcm9wZXJ0aWVzIHRvIGBVaW50OEFycmF5YCBpbnN0YW5jZXMsXG4gKiAgICAgU2VlOiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02OTU0MzguXG4gKlxuICogICAtIENocm9tZSA5LTEwIGlzIG1pc3NpbmcgdGhlIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24uXG4gKlxuICogICAtIElFMTAgaGFzIGEgYnJva2VuIGBUeXBlZEFycmF5LnByb3RvdHlwZS5zdWJhcnJheWAgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhcnJheXMgb2ZcbiAqICAgICBpbmNvcnJlY3QgbGVuZ3RoIGluIHNvbWUgc2l0dWF0aW9ucy5cblxuICogV2UgZGV0ZWN0IHRoZXNlIGJ1Z2d5IGJyb3dzZXJzIGFuZCBzZXQgYEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUYCB0byBgZmFsc2VgIHNvIHRoZXlcbiAqIGdldCB0aGUgT2JqZWN0IGltcGxlbWVudGF0aW9uLCB3aGljaCBpcyBzbG93ZXIgYnV0IGJlaGF2ZXMgY29ycmVjdGx5LlxuICovXG5CdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCA9IGdsb2JhbC5UWVBFRF9BUlJBWV9TVVBQT1JUICE9PSB1bmRlZmluZWRcbiAgPyBnbG9iYWwuVFlQRURfQVJSQVlfU1VQUE9SVFxuICA6IHR5cGVkQXJyYXlTdXBwb3J0KClcblxuLypcbiAqIEV4cG9ydCBrTWF4TGVuZ3RoIGFmdGVyIHR5cGVkIGFycmF5IHN1cHBvcnQgaXMgZGV0ZXJtaW5lZC5cbiAqL1xuZXhwb3J0cy5rTWF4TGVuZ3RoID0ga01heExlbmd0aCgpXG5cbmZ1bmN0aW9uIHR5cGVkQXJyYXlTdXBwb3J0ICgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMSlcbiAgICBhcnIuX19wcm90b19fID0ge19fcHJvdG9fXzogVWludDhBcnJheS5wcm90b3R5cGUsIGZvbzogZnVuY3Rpb24gKCkgeyByZXR1cm4gNDIgfX1cbiAgICByZXR1cm4gYXJyLmZvbygpID09PSA0MiAmJiAvLyB0eXBlZCBhcnJheSBpbnN0YW5jZXMgY2FuIGJlIGF1Z21lbnRlZFxuICAgICAgICB0eXBlb2YgYXJyLnN1YmFycmF5ID09PSAnZnVuY3Rpb24nICYmIC8vIGNocm9tZSA5LTEwIGxhY2sgYHN1YmFycmF5YFxuICAgICAgICBhcnIuc3ViYXJyYXkoMSwgMSkuYnl0ZUxlbmd0aCA9PT0gMCAvLyBpZTEwIGhhcyBicm9rZW4gYHN1YmFycmF5YFxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZnVuY3Rpb24ga01heExlbmd0aCAoKSB7XG4gIHJldHVybiBCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVFxuICAgID8gMHg3ZmZmZmZmZlxuICAgIDogMHgzZmZmZmZmZlxufVxuXG5mdW5jdGlvbiBjcmVhdGVCdWZmZXIgKHRoYXQsIGxlbmd0aCkge1xuICBpZiAoa01heExlbmd0aCgpIDwgbGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdHlwZWQgYXJyYXkgbGVuZ3RoJylcbiAgfVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKVxuICAgIHRoYXQuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIC8vIEZhbGxiYWNrOiBSZXR1cm4gYW4gb2JqZWN0IGluc3RhbmNlIG9mIHRoZSBCdWZmZXIgY2xhc3NcbiAgICBpZiAodGhhdCA9PT0gbnVsbCkge1xuICAgICAgdGhhdCA9IG5ldyBCdWZmZXIobGVuZ3RoKVxuICAgIH1cbiAgICB0aGF0Lmxlbmd0aCA9IGxlbmd0aFxuICB9XG5cbiAgcmV0dXJuIHRoYXRcbn1cblxuLyoqXG4gKiBUaGUgQnVmZmVyIGNvbnN0cnVjdG9yIHJldHVybnMgaW5zdGFuY2VzIG9mIGBVaW50OEFycmF5YCB0aGF0IGhhdmUgdGhlaXJcbiAqIHByb3RvdHlwZSBjaGFuZ2VkIHRvIGBCdWZmZXIucHJvdG90eXBlYC4gRnVydGhlcm1vcmUsIGBCdWZmZXJgIGlzIGEgc3ViY2xhc3Mgb2ZcbiAqIGBVaW50OEFycmF5YCwgc28gdGhlIHJldHVybmVkIGluc3RhbmNlcyB3aWxsIGhhdmUgYWxsIHRoZSBub2RlIGBCdWZmZXJgIG1ldGhvZHNcbiAqIGFuZCB0aGUgYFVpbnQ4QXJyYXlgIG1ldGhvZHMuIFNxdWFyZSBicmFja2V0IG5vdGF0aW9uIHdvcmtzIGFzIGV4cGVjdGVkIC0tIGl0XG4gKiByZXR1cm5zIGEgc2luZ2xlIG9jdGV0LlxuICpcbiAqIFRoZSBgVWludDhBcnJheWAgcHJvdG90eXBlIHJlbWFpbnMgdW5tb2RpZmllZC5cbiAqL1xuXG5mdW5jdGlvbiBCdWZmZXIgKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIGlmICghQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQgJiYgISh0aGlzIGluc3RhbmNlb2YgQnVmZmVyKSkge1xuICAgIHJldHVybiBuZXcgQnVmZmVyKGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgLy8gQ29tbW9uIGNhc2UuXG4gIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykge1xuICAgIGlmICh0eXBlb2YgZW5jb2RpbmdPck9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0lmIGVuY29kaW5nIGlzIHNwZWNpZmllZCB0aGVuIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgc3RyaW5nJ1xuICAgICAgKVxuICAgIH1cbiAgICByZXR1cm4gYWxsb2NVbnNhZmUodGhpcywgYXJnKVxuICB9XG4gIHJldHVybiBmcm9tKHRoaXMsIGFyZywgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxufVxuXG5CdWZmZXIucG9vbFNpemUgPSA4MTkyIC8vIG5vdCB1c2VkIGJ5IHRoaXMgaW1wbGVtZW50YXRpb25cblxuLy8gVE9ETzogTGVnYWN5LCBub3QgbmVlZGVkIGFueW1vcmUuIFJlbW92ZSBpbiBuZXh0IG1ham9yIHZlcnNpb24uXG5CdWZmZXIuX2F1Z21lbnQgPSBmdW5jdGlvbiAoYXJyKSB7XG4gIGFyci5fX3Byb3RvX18gPSBCdWZmZXIucHJvdG90eXBlXG4gIHJldHVybiBhcnJcbn1cblxuZnVuY3Rpb24gZnJvbSAodGhhdCwgdmFsdWUsIGVuY29kaW5nT3JPZmZzZXQsIGxlbmd0aCkge1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1widmFsdWVcIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpXG4gIH1cblxuICBpZiAodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgcmV0dXJuIGZyb21BcnJheUJ1ZmZlcih0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKVxuICB9XG5cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZnJvbVN0cmluZyh0aGF0LCB2YWx1ZSwgZW5jb2RpbmdPck9mZnNldClcbiAgfVxuXG4gIHJldHVybiBmcm9tT2JqZWN0KHRoYXQsIHZhbHVlKVxufVxuXG4vKipcbiAqIEZ1bmN0aW9uYWxseSBlcXVpdmFsZW50IHRvIEJ1ZmZlcihhcmcsIGVuY29kaW5nKSBidXQgdGhyb3dzIGEgVHlwZUVycm9yXG4gKiBpZiB2YWx1ZSBpcyBhIG51bWJlci5cbiAqIEJ1ZmZlci5mcm9tKHN0clssIGVuY29kaW5nXSlcbiAqIEJ1ZmZlci5mcm9tKGFycmF5KVxuICogQnVmZmVyLmZyb20oYnVmZmVyKVxuICogQnVmZmVyLmZyb20oYXJyYXlCdWZmZXJbLCBieXRlT2Zmc2V0WywgbGVuZ3RoXV0pXG4gKiovXG5CdWZmZXIuZnJvbSA9IGZ1bmN0aW9uICh2YWx1ZSwgZW5jb2RpbmdPck9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBmcm9tKG51bGwsIHZhbHVlLCBlbmNvZGluZ09yT2Zmc2V0LCBsZW5ndGgpXG59XG5cbmlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICBCdWZmZXIucHJvdG90eXBlLl9fcHJvdG9fXyA9IFVpbnQ4QXJyYXkucHJvdG90eXBlXG4gIEJ1ZmZlci5fX3Byb3RvX18gPSBVaW50OEFycmF5XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wuc3BlY2llcyAmJlxuICAgICAgQnVmZmVyW1N5bWJvbC5zcGVjaWVzXSA9PT0gQnVmZmVyKSB7XG4gICAgLy8gRml4IHN1YmFycmF5KCkgaW4gRVMyMDE2LiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvYnVmZmVyL3B1bGwvOTdcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVmZmVyLCBTeW1ib2wuc3BlY2llcywge1xuICAgICAgdmFsdWU6IG51bGwsXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KVxuICB9XG59XG5cbmZ1bmN0aW9uIGFzc2VydFNpemUgKHNpemUpIHtcbiAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3QgYmUgYSBudW1iZXInKVxuICB9IGVsc2UgaWYgKHNpemUgPCAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1wic2l6ZVwiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJylcbiAgfVxufVxuXG5mdW5jdGlvbiBhbGxvYyAodGhhdCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpIHtcbiAgYXNzZXJ0U2l6ZShzaXplKVxuICBpZiAoc2l6ZSA8PSAwKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxuICB9XG4gIGlmIChmaWxsICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBPbmx5IHBheSBhdHRlbnRpb24gdG8gZW5jb2RpbmcgaWYgaXQncyBhIHN0cmluZy4gVGhpc1xuICAgIC8vIHByZXZlbnRzIGFjY2lkZW50YWxseSBzZW5kaW5nIGluIGEgbnVtYmVyIHRoYXQgd291bGRcbiAgICAvLyBiZSBpbnRlcnByZXR0ZWQgYXMgYSBzdGFydCBvZmZzZXQuXG4gICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZydcbiAgICAgID8gY3JlYXRlQnVmZmVyKHRoYXQsIHNpemUpLmZpbGwoZmlsbCwgZW5jb2RpbmcpXG4gICAgICA6IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKS5maWxsKGZpbGwpXG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplKVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgZmlsbGVkIEJ1ZmZlciBpbnN0YW5jZS5cbiAqIGFsbG9jKHNpemVbLCBmaWxsWywgZW5jb2RpbmddXSlcbiAqKi9cbkJ1ZmZlci5hbGxvYyA9IGZ1bmN0aW9uIChzaXplLCBmaWxsLCBlbmNvZGluZykge1xuICByZXR1cm4gYWxsb2MobnVsbCwgc2l6ZSwgZmlsbCwgZW5jb2RpbmcpXG59XG5cbmZ1bmN0aW9uIGFsbG9jVW5zYWZlICh0aGF0LCBzaXplKSB7XG4gIGFzc2VydFNpemUoc2l6ZSlcbiAgdGhhdCA9IGNyZWF0ZUJ1ZmZlcih0aGF0LCBzaXplIDwgMCA/IDAgOiBjaGVja2VkKHNpemUpIHwgMClcbiAgaWYgKCFCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKSB7XG4gICAgICB0aGF0W2ldID0gMFxuICAgIH1cbiAgfVxuICByZXR1cm4gdGhhdFxufVxuXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gQnVmZmVyKG51bSksIGJ5IGRlZmF1bHQgY3JlYXRlcyBhIG5vbi16ZXJvLWZpbGxlZCBCdWZmZXIgaW5zdGFuY2UuXG4gKiAqL1xuQnVmZmVyLmFsbG9jVW5zYWZlID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gU2xvd0J1ZmZlcihudW0pLCBieSBkZWZhdWx0IGNyZWF0ZXMgYSBub24temVyby1maWxsZWQgQnVmZmVyIGluc3RhbmNlLlxuICovXG5CdWZmZXIuYWxsb2NVbnNhZmVTbG93ID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgcmV0dXJuIGFsbG9jVW5zYWZlKG51bGwsIHNpemUpXG59XG5cbmZ1bmN0aW9uIGZyb21TdHJpbmcgKHRoYXQsIHN0cmluZywgZW5jb2RpbmcpIHtcbiAgaWYgKHR5cGVvZiBlbmNvZGluZyAhPT0gJ3N0cmluZycgfHwgZW5jb2RpbmcgPT09ICcnKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgfVxuXG4gIGlmICghQnVmZmVyLmlzRW5jb2RpbmcoZW5jb2RpbmcpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJlbmNvZGluZ1wiIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKVxuICB9XG5cbiAgdmFyIGxlbmd0aCA9IGJ5dGVMZW5ndGgoc3RyaW5nLCBlbmNvZGluZykgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuXG4gIHZhciBhY3R1YWwgPSB0aGF0LndyaXRlKHN0cmluZywgZW5jb2RpbmcpXG5cbiAgaWYgKGFjdHVhbCAhPT0gbGVuZ3RoKSB7XG4gICAgLy8gV3JpdGluZyBhIGhleCBzdHJpbmcsIGZvciBleGFtcGxlLCB0aGF0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyB3aWxsXG4gICAgLy8gY2F1c2UgZXZlcnl0aGluZyBhZnRlciB0aGUgZmlyc3QgaW52YWxpZCBjaGFyYWN0ZXIgdG8gYmUgaWdub3JlZC4gKGUuZy5cbiAgICAvLyAnYWJ4eGNkJyB3aWxsIGJlIHRyZWF0ZWQgYXMgJ2FiJylcbiAgICB0aGF0ID0gdGhhdC5zbGljZSgwLCBhY3R1YWwpXG4gIH1cblxuICByZXR1cm4gdGhhdFxufVxuXG5mdW5jdGlvbiBmcm9tQXJyYXlMaWtlICh0aGF0LCBhcnJheSkge1xuICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoIDwgMCA/IDAgOiBjaGVja2VkKGFycmF5Lmxlbmd0aCkgfCAwXG4gIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuZ3RoKVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgdGhhdFtpXSA9IGFycmF5W2ldICYgMjU1XG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbUFycmF5QnVmZmVyICh0aGF0LCBhcnJheSwgYnl0ZU9mZnNldCwgbGVuZ3RoKSB7XG4gIGFycmF5LmJ5dGVMZW5ndGggLy8gdGhpcyB0aHJvd3MgaWYgYGFycmF5YCBpcyBub3QgYSB2YWxpZCBBcnJheUJ1ZmZlclxuXG4gIGlmIChieXRlT2Zmc2V0IDwgMCB8fCBhcnJheS5ieXRlTGVuZ3RoIDwgYnl0ZU9mZnNldCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdcXCdvZmZzZXRcXCcgaXMgb3V0IG9mIGJvdW5kcycpXG4gIH1cblxuICBpZiAoYXJyYXkuYnl0ZUxlbmd0aCA8IGJ5dGVPZmZzZXQgKyAobGVuZ3RoIHx8IDApKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ1xcJ2xlbmd0aFxcJyBpcyBvdXQgb2YgYm91bmRzJylcbiAgfVxuXG4gIGlmIChieXRlT2Zmc2V0ID09PSB1bmRlZmluZWQgJiYgbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5KVxuICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheSwgYnl0ZU9mZnNldClcbiAgfSBlbHNlIHtcbiAgICBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5LCBieXRlT2Zmc2V0LCBsZW5ndGgpXG4gIH1cblxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBSZXR1cm4gYW4gYXVnbWVudGVkIGBVaW50OEFycmF5YCBpbnN0YW5jZSwgZm9yIGJlc3QgcGVyZm9ybWFuY2VcbiAgICB0aGF0ID0gYXJyYXlcbiAgICB0aGF0Ll9fcHJvdG9fXyA9IEJ1ZmZlci5wcm90b3R5cGVcbiAgfSBlbHNlIHtcbiAgICAvLyBGYWxsYmFjazogUmV0dXJuIGFuIG9iamVjdCBpbnN0YW5jZSBvZiB0aGUgQnVmZmVyIGNsYXNzXG4gICAgdGhhdCA9IGZyb21BcnJheUxpa2UodGhhdCwgYXJyYXkpXG4gIH1cbiAgcmV0dXJuIHRoYXRcbn1cblxuZnVuY3Rpb24gZnJvbU9iamVjdCAodGhhdCwgb2JqKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIob2JqKSkge1xuICAgIHZhciBsZW4gPSBjaGVja2VkKG9iai5sZW5ndGgpIHwgMFxuICAgIHRoYXQgPSBjcmVhdGVCdWZmZXIodGhhdCwgbGVuKVxuXG4gICAgaWYgKHRoYXQubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gdGhhdFxuICAgIH1cblxuICAgIG9iai5jb3B5KHRoYXQsIDAsIDAsIGxlbilcbiAgICByZXR1cm4gdGhhdFxuICB9XG5cbiAgaWYgKG9iaikge1xuICAgIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBvYmouYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHx8ICdsZW5ndGgnIGluIG9iaikge1xuICAgICAgaWYgKHR5cGVvZiBvYmoubGVuZ3RoICE9PSAnbnVtYmVyJyB8fCBpc25hbihvYmoubGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gY3JlYXRlQnVmZmVyKHRoYXQsIDApXG4gICAgICB9XG4gICAgICByZXR1cm4gZnJvbUFycmF5TGlrZSh0aGF0LCBvYmopXG4gICAgfVxuXG4gICAgaWYgKG9iai50eXBlID09PSAnQnVmZmVyJyAmJiBpc0FycmF5KG9iai5kYXRhKSkge1xuICAgICAgcmV0dXJuIGZyb21BcnJheUxpa2UodGhhdCwgb2JqLmRhdGEpXG4gICAgfVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZywgQnVmZmVyLCBBcnJheUJ1ZmZlciwgQXJyYXksIG9yIGFycmF5LWxpa2Ugb2JqZWN0LicpXG59XG5cbmZ1bmN0aW9uIGNoZWNrZWQgKGxlbmd0aCkge1xuICAvLyBOb3RlOiBjYW5ub3QgdXNlIGBsZW5ndGggPCBrTWF4TGVuZ3RoKClgIGhlcmUgYmVjYXVzZSB0aGF0IGZhaWxzIHdoZW5cbiAgLy8gbGVuZ3RoIGlzIE5hTiAod2hpY2ggaXMgb3RoZXJ3aXNlIGNvZXJjZWQgdG8gemVyby4pXG4gIGlmIChsZW5ndGggPj0ga01heExlbmd0aCgpKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0F0dGVtcHQgdG8gYWxsb2NhdGUgQnVmZmVyIGxhcmdlciB0aGFuIG1heGltdW0gJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgJ3NpemU6IDB4JyArIGtNYXhMZW5ndGgoKS50b1N0cmluZygxNikgKyAnIGJ5dGVzJylcbiAgfVxuICByZXR1cm4gbGVuZ3RoIHwgMFxufVxuXG5mdW5jdGlvbiBTbG93QnVmZmVyIChsZW5ndGgpIHtcbiAgaWYgKCtsZW5ndGggIT0gbGVuZ3RoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZXFlcWVxXG4gICAgbGVuZ3RoID0gMFxuICB9XG4gIHJldHVybiBCdWZmZXIuYWxsb2MoK2xlbmd0aClcbn1cblxuQnVmZmVyLmlzQnVmZmVyID0gZnVuY3Rpb24gaXNCdWZmZXIgKGIpIHtcbiAgcmV0dXJuICEhKGIgIT0gbnVsbCAmJiBiLl9pc0J1ZmZlcilcbn1cblxuQnVmZmVyLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlIChhLCBiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGEpIHx8ICFCdWZmZXIuaXNCdWZmZXIoYikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzJylcbiAgfVxuXG4gIGlmIChhID09PSBiKSByZXR1cm4gMFxuXG4gIHZhciB4ID0gYS5sZW5ndGhcbiAgdmFyIHkgPSBiLmxlbmd0aFxuXG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBNYXRoLm1pbih4LCB5KTsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKGFbaV0gIT09IGJbaV0pIHtcbiAgICAgIHggPSBhW2ldXG4gICAgICB5ID0gYltpXVxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBpZiAoeCA8IHkpIHJldHVybiAtMVxuICBpZiAoeSA8IHgpIHJldHVybiAxXG4gIHJldHVybiAwXG59XG5cbkJ1ZmZlci5pc0VuY29kaW5nID0gZnVuY3Rpb24gaXNFbmNvZGluZyAoZW5jb2RpbmcpIHtcbiAgc3dpdGNoIChTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKCkpIHtcbiAgICBjYXNlICdoZXgnOlxuICAgIGNhc2UgJ3V0ZjgnOlxuICAgIGNhc2UgJ3V0Zi04JzpcbiAgICBjYXNlICdhc2NpaSc6XG4gICAgY2FzZSAnbGF0aW4xJzpcbiAgICBjYXNlICdiaW5hcnknOlxuICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgY2FzZSAndWNzMic6XG4gICAgY2FzZSAndWNzLTInOlxuICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgIHJldHVybiB0cnVlXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbkJ1ZmZlci5jb25jYXQgPSBmdW5jdGlvbiBjb25jYXQgKGxpc3QsIGxlbmd0aCkge1xuICBpZiAoIWlzQXJyYXkobGlzdCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImxpc3RcIiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKVxuICB9XG5cbiAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5hbGxvYygwKVxuICB9XG5cbiAgdmFyIGlcbiAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbGVuZ3RoID0gMFxuICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpKSB7XG4gICAgICBsZW5ndGggKz0gbGlzdFtpXS5sZW5ndGhcbiAgICB9XG4gIH1cblxuICB2YXIgYnVmZmVyID0gQnVmZmVyLmFsbG9jVW5zYWZlKGxlbmd0aClcbiAgdmFyIHBvcyA9IDBcbiAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyArK2kpIHtcbiAgICB2YXIgYnVmID0gbGlzdFtpXVxuICAgIGlmICghQnVmZmVyLmlzQnVmZmVyKGJ1ZikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wibGlzdFwiIGFyZ3VtZW50IG11c3QgYmUgYW4gQXJyYXkgb2YgQnVmZmVycycpXG4gICAgfVxuICAgIGJ1Zi5jb3B5KGJ1ZmZlciwgcG9zKVxuICAgIHBvcyArPSBidWYubGVuZ3RoXG4gIH1cbiAgcmV0dXJuIGJ1ZmZlclxufVxuXG5mdW5jdGlvbiBieXRlTGVuZ3RoIChzdHJpbmcsIGVuY29kaW5nKSB7XG4gIGlmIChCdWZmZXIuaXNCdWZmZXIoc3RyaW5nKSkge1xuICAgIHJldHVybiBzdHJpbmcubGVuZ3RoXG4gIH1cbiAgaWYgKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEFycmF5QnVmZmVyLmlzVmlldyA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgKEFycmF5QnVmZmVyLmlzVmlldyhzdHJpbmcpIHx8IHN0cmluZyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSkge1xuICAgIHJldHVybiBzdHJpbmcuYnl0ZUxlbmd0aFxuICB9XG4gIGlmICh0eXBlb2Ygc3RyaW5nICE9PSAnc3RyaW5nJykge1xuICAgIHN0cmluZyA9ICcnICsgc3RyaW5nXG4gIH1cblxuICB2YXIgbGVuID0gc3RyaW5nLmxlbmd0aFxuICBpZiAobGVuID09PSAwKSByZXR1cm4gMFxuXG4gIC8vIFVzZSBhIGZvciBsb29wIHRvIGF2b2lkIHJlY3Vyc2lvblxuICB2YXIgbG93ZXJlZENhc2UgPSBmYWxzZVxuICBmb3IgKDs7KSB7XG4gICAgc3dpdGNoIChlbmNvZGluZykge1xuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgY2FzZSAnbGF0aW4xJzpcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICAgIHJldHVybiBsZW5cbiAgICAgIGNhc2UgJ3V0ZjgnOlxuICAgICAgY2FzZSAndXRmLTgnOlxuICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aFxuICAgICAgY2FzZSAndWNzMic6XG4gICAgICBjYXNlICd1Y3MtMic6XG4gICAgICBjYXNlICd1dGYxNmxlJzpcbiAgICAgIGNhc2UgJ3V0Zi0xNmxlJzpcbiAgICAgICAgcmV0dXJuIGxlbiAqIDJcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBsZW4gPj4+IDFcbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIHJldHVybiBiYXNlNjRUb0J5dGVzKHN0cmluZykubGVuZ3RoXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAobG93ZXJlZENhc2UpIHJldHVybiB1dGY4VG9CeXRlcyhzdHJpbmcpLmxlbmd0aCAvLyBhc3N1bWUgdXRmOFxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuQnVmZmVyLmJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoXG5cbmZ1bmN0aW9uIHNsb3dUb1N0cmluZyAoZW5jb2RpbmcsIHN0YXJ0LCBlbmQpIHtcbiAgdmFyIGxvd2VyZWRDYXNlID0gZmFsc2VcblxuICAvLyBObyBuZWVkIHRvIHZlcmlmeSB0aGF0IFwidGhpcy5sZW5ndGggPD0gTUFYX1VJTlQzMlwiIHNpbmNlIGl0J3MgYSByZWFkLW9ubHlcbiAgLy8gcHJvcGVydHkgb2YgYSB0eXBlZCBhcnJheS5cblxuICAvLyBUaGlzIGJlaGF2ZXMgbmVpdGhlciBsaWtlIFN0cmluZyBub3IgVWludDhBcnJheSBpbiB0aGF0IHdlIHNldCBzdGFydC9lbmRcbiAgLy8gdG8gdGhlaXIgdXBwZXIvbG93ZXIgYm91bmRzIGlmIHRoZSB2YWx1ZSBwYXNzZWQgaXMgb3V0IG9mIHJhbmdlLlxuICAvLyB1bmRlZmluZWQgaXMgaGFuZGxlZCBzcGVjaWFsbHkgYXMgcGVyIEVDTUEtMjYyIDZ0aCBFZGl0aW9uLFxuICAvLyBTZWN0aW9uIDEzLjMuMy43IFJ1bnRpbWUgU2VtYW50aWNzOiBLZXllZEJpbmRpbmdJbml0aWFsaXphdGlvbi5cbiAgaWYgKHN0YXJ0ID09PSB1bmRlZmluZWQgfHwgc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgPSAwXG4gIH1cbiAgLy8gUmV0dXJuIGVhcmx5IGlmIHN0YXJ0ID4gdGhpcy5sZW5ndGguIERvbmUgaGVyZSB0byBwcmV2ZW50IHBvdGVudGlhbCB1aW50MzJcbiAgLy8gY29lcmNpb24gZmFpbCBiZWxvdy5cbiAgaWYgKHN0YXJ0ID4gdGhpcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIGVuZCA9IHRoaXMubGVuZ3RoXG4gIH1cblxuICBpZiAoZW5kIDw9IDApIHtcbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIC8vIEZvcmNlIGNvZXJzaW9uIHRvIHVpbnQzMi4gVGhpcyB3aWxsIGFsc28gY29lcmNlIGZhbHNleS9OYU4gdmFsdWVzIHRvIDAuXG4gIGVuZCA+Pj49IDBcbiAgc3RhcnQgPj4+PSAwXG5cbiAgaWYgKGVuZCA8PSBzdGFydCkge1xuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgaWYgKCFlbmNvZGluZykgZW5jb2RpbmcgPSAndXRmOCdcblxuICB3aGlsZSAodHJ1ZSkge1xuICAgIHN3aXRjaCAoZW5jb2RpbmcpIHtcbiAgICAgIGNhc2UgJ2hleCc6XG4gICAgICAgIHJldHVybiBoZXhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICd1dGY4JzpcbiAgICAgIGNhc2UgJ3V0Zi04JzpcbiAgICAgICAgcmV0dXJuIHV0ZjhTbGljZSh0aGlzLCBzdGFydCwgZW5kKVxuXG4gICAgICBjYXNlICdhc2NpaSc6XG4gICAgICAgIHJldHVybiBhc2NpaVNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ2xhdGluMSc6XG4gICAgICBjYXNlICdiaW5hcnknOlxuICAgICAgICByZXR1cm4gbGF0aW4xU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgY2FzZSAnYmFzZTY0JzpcbiAgICAgICAgcmV0dXJuIGJhc2U2NFNsaWNlKHRoaXMsIHN0YXJ0LCBlbmQpXG5cbiAgICAgIGNhc2UgJ3VjczInOlxuICAgICAgY2FzZSAndWNzLTInOlxuICAgICAgY2FzZSAndXRmMTZsZSc6XG4gICAgICBjYXNlICd1dGYtMTZsZSc6XG4gICAgICAgIHJldHVybiB1dGYxNmxlU2xpY2UodGhpcywgc3RhcnQsIGVuZClcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGxvd2VyZWRDYXNlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdVbmtub3duIGVuY29kaW5nOiAnICsgZW5jb2RpbmcpXG4gICAgICAgIGVuY29kaW5nID0gKGVuY29kaW5nICsgJycpLnRvTG93ZXJDYXNlKClcbiAgICAgICAgbG93ZXJlZENhc2UgPSB0cnVlXG4gICAgfVxuICB9XG59XG5cbi8vIFRoZSBwcm9wZXJ0eSBpcyB1c2VkIGJ5IGBCdWZmZXIuaXNCdWZmZXJgIGFuZCBgaXMtYnVmZmVyYCAoaW4gU2FmYXJpIDUtNykgdG8gZGV0ZWN0XG4vLyBCdWZmZXIgaW5zdGFuY2VzLlxuQnVmZmVyLnByb3RvdHlwZS5faXNCdWZmZXIgPSB0cnVlXG5cbmZ1bmN0aW9uIHN3YXAgKGIsIG4sIG0pIHtcbiAgdmFyIGkgPSBiW25dXG4gIGJbbl0gPSBiW21dXG4gIGJbbV0gPSBpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc3dhcDE2ID0gZnVuY3Rpb24gc3dhcDE2ICgpIHtcbiAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoXG4gIGlmIChsZW4gJSAyICE9PSAwKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0J1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxNi1iaXRzJylcbiAgfVxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgc3dhcCh0aGlzLCBpLCBpICsgMSlcbiAgfVxuICByZXR1cm4gdGhpc1xufVxuXG5CdWZmZXIucHJvdG90eXBlLnN3YXAzMiA9IGZ1bmN0aW9uIHN3YXAzMiAoKSB7XG4gIHZhciBsZW4gPSB0aGlzLmxlbmd0aFxuICBpZiAobGVuICUgNCAhPT0gMCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdCdWZmZXIgc2l6ZSBtdXN0IGJlIGEgbXVsdGlwbGUgb2YgMzItYml0cycpXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xuICAgIHN3YXAodGhpcywgaSwgaSArIDMpXG4gICAgc3dhcCh0aGlzLCBpICsgMSwgaSArIDIpXG4gIH1cbiAgcmV0dXJuIHRoaXNcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5zd2FwNjQgPSBmdW5jdGlvbiBzd2FwNjQgKCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgaWYgKGxlbiAlIDggIT09IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMnKVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDgpIHtcbiAgICBzd2FwKHRoaXMsIGksIGkgKyA3KVxuICAgIHN3YXAodGhpcywgaSArIDEsIGkgKyA2KVxuICAgIHN3YXAodGhpcywgaSArIDIsIGkgKyA1KVxuICAgIHN3YXAodGhpcywgaSArIDMsIGkgKyA0KVxuICB9XG4gIHJldHVybiB0aGlzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZyAoKSB7XG4gIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCB8IDBcbiAgaWYgKGxlbmd0aCA9PT0gMCkgcmV0dXJuICcnXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSByZXR1cm4gdXRmOFNsaWNlKHRoaXMsIDAsIGxlbmd0aClcbiAgcmV0dXJuIHNsb3dUb1N0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gZXF1YWxzIChiKSB7XG4gIGlmICghQnVmZmVyLmlzQnVmZmVyKGIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBtdXN0IGJlIGEgQnVmZmVyJylcbiAgaWYgKHRoaXMgPT09IGIpIHJldHVybiB0cnVlXG4gIHJldHVybiBCdWZmZXIuY29tcGFyZSh0aGlzLCBiKSA9PT0gMFxufVxuXG5CdWZmZXIucHJvdG90eXBlLmluc3BlY3QgPSBmdW5jdGlvbiBpbnNwZWN0ICgpIHtcbiAgdmFyIHN0ciA9ICcnXG4gIHZhciBtYXggPSBleHBvcnRzLklOU1BFQ1RfTUFYX0JZVEVTXG4gIGlmICh0aGlzLmxlbmd0aCA+IDApIHtcbiAgICBzdHIgPSB0aGlzLnRvU3RyaW5nKCdoZXgnLCAwLCBtYXgpLm1hdGNoKC8uezJ9L2cpLmpvaW4oJyAnKVxuICAgIGlmICh0aGlzLmxlbmd0aCA+IG1heCkgc3RyICs9ICcgLi4uICdcbiAgfVxuICByZXR1cm4gJzxCdWZmZXIgJyArIHN0ciArICc+J1xufVxuXG5CdWZmZXIucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiBjb21wYXJlICh0YXJnZXQsIHN0YXJ0LCBlbmQsIHRoaXNTdGFydCwgdGhpc0VuZCkge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcih0YXJnZXQpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlcicpXG4gIH1cblxuICBpZiAoc3RhcnQgPT09IHVuZGVmaW5lZCkge1xuICAgIHN0YXJ0ID0gMFxuICB9XG4gIGlmIChlbmQgPT09IHVuZGVmaW5lZCkge1xuICAgIGVuZCA9IHRhcmdldCA/IHRhcmdldC5sZW5ndGggOiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhpc1N0YXJ0ID0gMFxuICB9XG4gIGlmICh0aGlzRW5kID09PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzRW5kID0gdGhpcy5sZW5ndGhcbiAgfVxuXG4gIGlmIChzdGFydCA8IDAgfHwgZW5kID4gdGFyZ2V0Lmxlbmd0aCB8fCB0aGlzU3RhcnQgPCAwIHx8IHRoaXNFbmQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdvdXQgb2YgcmFuZ2UgaW5kZXgnKVxuICB9XG5cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kICYmIHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAwXG4gIH1cbiAgaWYgKHRoaXNTdGFydCA+PSB0aGlzRW5kKSB7XG4gICAgcmV0dXJuIC0xXG4gIH1cbiAgaWYgKHN0YXJ0ID49IGVuZCkge1xuICAgIHJldHVybiAxXG4gIH1cblxuICBzdGFydCA+Pj49IDBcbiAgZW5kID4+Pj0gMFxuICB0aGlzU3RhcnQgPj4+PSAwXG4gIHRoaXNFbmQgPj4+PSAwXG5cbiAgaWYgKHRoaXMgPT09IHRhcmdldCkgcmV0dXJuIDBcblxuICB2YXIgeCA9IHRoaXNFbmQgLSB0aGlzU3RhcnRcbiAgdmFyIHkgPSBlbmQgLSBzdGFydFxuICB2YXIgbGVuID0gTWF0aC5taW4oeCwgeSlcblxuICB2YXIgdGhpc0NvcHkgPSB0aGlzLnNsaWNlKHRoaXNTdGFydCwgdGhpc0VuZClcbiAgdmFyIHRhcmdldENvcHkgPSB0YXJnZXQuc2xpY2Uoc3RhcnQsIGVuZClcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgaWYgKHRoaXNDb3B5W2ldICE9PSB0YXJnZXRDb3B5W2ldKSB7XG4gICAgICB4ID0gdGhpc0NvcHlbaV1cbiAgICAgIHkgPSB0YXJnZXRDb3B5W2ldXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIGlmICh4IDwgeSkgcmV0dXJuIC0xXG4gIGlmICh5IDwgeCkgcmV0dXJuIDFcbiAgcmV0dXJuIDBcbn1cblxuLy8gRmluZHMgZWl0aGVyIHRoZSBmaXJzdCBpbmRleCBvZiBgdmFsYCBpbiBgYnVmZmVyYCBhdCBvZmZzZXQgPj0gYGJ5dGVPZmZzZXRgLFxuLy8gT1IgdGhlIGxhc3QgaW5kZXggb2YgYHZhbGAgaW4gYGJ1ZmZlcmAgYXQgb2Zmc2V0IDw9IGBieXRlT2Zmc2V0YC5cbi8vXG4vLyBBcmd1bWVudHM6XG4vLyAtIGJ1ZmZlciAtIGEgQnVmZmVyIHRvIHNlYXJjaFxuLy8gLSB2YWwgLSBhIHN0cmluZywgQnVmZmVyLCBvciBudW1iZXJcbi8vIC0gYnl0ZU9mZnNldCAtIGFuIGluZGV4IGludG8gYGJ1ZmZlcmA7IHdpbGwgYmUgY2xhbXBlZCB0byBhbiBpbnQzMlxuLy8gLSBlbmNvZGluZyAtIGFuIG9wdGlvbmFsIGVuY29kaW5nLCByZWxldmFudCBpcyB2YWwgaXMgYSBzdHJpbmdcbi8vIC0gZGlyIC0gdHJ1ZSBmb3IgaW5kZXhPZiwgZmFsc2UgZm9yIGxhc3RJbmRleE9mXG5mdW5jdGlvbiBiaWRpcmVjdGlvbmFsSW5kZXhPZiAoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nLCBkaXIpIHtcbiAgLy8gRW1wdHkgYnVmZmVyIG1lYW5zIG5vIG1hdGNoXG4gIGlmIChidWZmZXIubGVuZ3RoID09PSAwKSByZXR1cm4gLTFcblxuICAvLyBOb3JtYWxpemUgYnl0ZU9mZnNldFxuICBpZiAodHlwZW9mIGJ5dGVPZmZzZXQgPT09ICdzdHJpbmcnKSB7XG4gICAgZW5jb2RpbmcgPSBieXRlT2Zmc2V0XG4gICAgYnl0ZU9mZnNldCA9IDBcbiAgfSBlbHNlIGlmIChieXRlT2Zmc2V0ID4gMHg3ZmZmZmZmZikge1xuICAgIGJ5dGVPZmZzZXQgPSAweDdmZmZmZmZmXG4gIH0gZWxzZSBpZiAoYnl0ZU9mZnNldCA8IC0weDgwMDAwMDAwKSB7XG4gICAgYnl0ZU9mZnNldCA9IC0weDgwMDAwMDAwXG4gIH1cbiAgYnl0ZU9mZnNldCA9ICtieXRlT2Zmc2V0ICAvLyBDb2VyY2UgdG8gTnVtYmVyLlxuICBpZiAoaXNOYU4oYnl0ZU9mZnNldCkpIHtcbiAgICAvLyBieXRlT2Zmc2V0OiBpdCBpdCdzIHVuZGVmaW5lZCwgbnVsbCwgTmFOLCBcImZvb1wiLCBldGMsIHNlYXJjaCB3aG9sZSBidWZmZXJcbiAgICBieXRlT2Zmc2V0ID0gZGlyID8gMCA6IChidWZmZXIubGVuZ3RoIC0gMSlcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSBieXRlT2Zmc2V0OiBuZWdhdGl2ZSBvZmZzZXRzIHN0YXJ0IGZyb20gdGhlIGVuZCBvZiB0aGUgYnVmZmVyXG4gIGlmIChieXRlT2Zmc2V0IDwgMCkgYnl0ZU9mZnNldCA9IGJ1ZmZlci5sZW5ndGggKyBieXRlT2Zmc2V0XG4gIGlmIChieXRlT2Zmc2V0ID49IGJ1ZmZlci5sZW5ndGgpIHtcbiAgICBpZiAoZGlyKSByZXR1cm4gLTFcbiAgICBlbHNlIGJ5dGVPZmZzZXQgPSBidWZmZXIubGVuZ3RoIC0gMVxuICB9IGVsc2UgaWYgKGJ5dGVPZmZzZXQgPCAwKSB7XG4gICAgaWYgKGRpcikgYnl0ZU9mZnNldCA9IDBcbiAgICBlbHNlIHJldHVybiAtMVxuICB9XG5cbiAgLy8gTm9ybWFsaXplIHZhbFxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ3N0cmluZycpIHtcbiAgICB2YWwgPSBCdWZmZXIuZnJvbSh2YWwsIGVuY29kaW5nKVxuICB9XG5cbiAgLy8gRmluYWxseSwgc2VhcmNoIGVpdGhlciBpbmRleE9mIChpZiBkaXIgaXMgdHJ1ZSkgb3IgbGFzdEluZGV4T2ZcbiAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWwpKSB7XG4gICAgLy8gU3BlY2lhbCBjYXNlOiBsb29raW5nIGZvciBlbXB0eSBzdHJpbmcvYnVmZmVyIGFsd2F5cyBmYWlsc1xuICAgIGlmICh2YWwubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gLTFcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5SW5kZXhPZihidWZmZXIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcilcbiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykge1xuICAgIHZhbCA9IHZhbCAmIDB4RkYgLy8gU2VhcmNoIGZvciBhIGJ5dGUgdmFsdWUgWzAtMjU1XVxuICAgIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCAmJlxuICAgICAgICB0eXBlb2YgVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgaWYgKGRpcikge1xuICAgICAgICByZXR1cm4gVWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGJ1ZmZlciwgdmFsLCBieXRlT2Zmc2V0KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFVpbnQ4QXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYnVmZmVyLCB2YWwsIGJ5dGVPZmZzZXQpXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheUluZGV4T2YoYnVmZmVyLCBbIHZhbCBdLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZGlyKVxuICB9XG5cbiAgdGhyb3cgbmV3IFR5cGVFcnJvcigndmFsIG11c3QgYmUgc3RyaW5nLCBudW1iZXIgb3IgQnVmZmVyJylcbn1cblxuZnVuY3Rpb24gYXJyYXlJbmRleE9mIChhcnIsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIGRpcikge1xuICB2YXIgaW5kZXhTaXplID0gMVxuICB2YXIgYXJyTGVuZ3RoID0gYXJyLmxlbmd0aFxuICB2YXIgdmFsTGVuZ3RoID0gdmFsLmxlbmd0aFxuXG4gIGlmIChlbmNvZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSBTdHJpbmcoZW5jb2RpbmcpLnRvTG93ZXJDYXNlKClcbiAgICBpZiAoZW5jb2RpbmcgPT09ICd1Y3MyJyB8fCBlbmNvZGluZyA9PT0gJ3Vjcy0yJyB8fFxuICAgICAgICBlbmNvZGluZyA9PT0gJ3V0ZjE2bGUnIHx8IGVuY29kaW5nID09PSAndXRmLTE2bGUnKSB7XG4gICAgICBpZiAoYXJyLmxlbmd0aCA8IDIgfHwgdmFsLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIC0xXG4gICAgICB9XG4gICAgICBpbmRleFNpemUgPSAyXG4gICAgICBhcnJMZW5ndGggLz0gMlxuICAgICAgdmFsTGVuZ3RoIC89IDJcbiAgICAgIGJ5dGVPZmZzZXQgLz0gMlxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWQgKGJ1ZiwgaSkge1xuICAgIGlmIChpbmRleFNpemUgPT09IDEpIHtcbiAgICAgIHJldHVybiBidWZbaV1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGJ1Zi5yZWFkVUludDE2QkUoaSAqIGluZGV4U2l6ZSlcbiAgICB9XG4gIH1cblxuICB2YXIgaVxuICBpZiAoZGlyKSB7XG4gICAgdmFyIGZvdW5kSW5kZXggPSAtMVxuICAgIGZvciAoaSA9IGJ5dGVPZmZzZXQ7IGkgPCBhcnJMZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHJlYWQoYXJyLCBpKSA9PT0gcmVhZCh2YWwsIGZvdW5kSW5kZXggPT09IC0xID8gMCA6IGkgLSBmb3VuZEluZGV4KSkge1xuICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIGZvdW5kSW5kZXggPSBpXG4gICAgICAgIGlmIChpIC0gZm91bmRJbmRleCArIDEgPT09IHZhbExlbmd0aCkgcmV0dXJuIGZvdW5kSW5kZXggKiBpbmRleFNpemVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChmb3VuZEluZGV4ICE9PSAtMSkgaSAtPSBpIC0gZm91bmRJbmRleFxuICAgICAgICBmb3VuZEluZGV4ID0gLTFcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGJ5dGVPZmZzZXQgKyB2YWxMZW5ndGggPiBhcnJMZW5ndGgpIGJ5dGVPZmZzZXQgPSBhcnJMZW5ndGggLSB2YWxMZW5ndGhcbiAgICBmb3IgKGkgPSBieXRlT2Zmc2V0OyBpID49IDA7IGktLSkge1xuICAgICAgdmFyIGZvdW5kID0gdHJ1ZVxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB2YWxMZW5ndGg7IGorKykge1xuICAgICAgICBpZiAocmVhZChhcnIsIGkgKyBqKSAhPT0gcmVhZCh2YWwsIGopKSB7XG4gICAgICAgICAgZm91bmQgPSBmYWxzZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gLTFcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5pbmNsdWRlcyA9IGZ1bmN0aW9uIGluY2x1ZGVzICh2YWwsIGJ5dGVPZmZzZXQsIGVuY29kaW5nKSB7XG4gIHJldHVybiB0aGlzLmluZGV4T2YodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykgIT09IC0xXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIGluZGV4T2YgKHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcpIHtcbiAgcmV0dXJuIGJpZGlyZWN0aW9uYWxJbmRleE9mKHRoaXMsIHZhbCwgYnl0ZU9mZnNldCwgZW5jb2RpbmcsIHRydWUpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiBsYXN0SW5kZXhPZiAodmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZykge1xuICByZXR1cm4gYmlkaXJlY3Rpb25hbEluZGV4T2YodGhpcywgdmFsLCBieXRlT2Zmc2V0LCBlbmNvZGluZywgZmFsc2UpXG59XG5cbmZ1bmN0aW9uIGhleFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgb2Zmc2V0ID0gTnVtYmVyKG9mZnNldCkgfHwgMFxuICB2YXIgcmVtYWluaW5nID0gYnVmLmxlbmd0aCAtIG9mZnNldFxuICBpZiAoIWxlbmd0aCkge1xuICAgIGxlbmd0aCA9IHJlbWFpbmluZ1xuICB9IGVsc2Uge1xuICAgIGxlbmd0aCA9IE51bWJlcihsZW5ndGgpXG4gICAgaWYgKGxlbmd0aCA+IHJlbWFpbmluZykge1xuICAgICAgbGVuZ3RoID0gcmVtYWluaW5nXG4gICAgfVxuICB9XG5cbiAgLy8gbXVzdCBiZSBhbiBldmVuIG51bWJlciBvZiBkaWdpdHNcbiAgdmFyIHN0ckxlbiA9IHN0cmluZy5sZW5ndGhcbiAgaWYgKHN0ckxlbiAlIDIgIT09IDApIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgaGV4IHN0cmluZycpXG5cbiAgaWYgKGxlbmd0aCA+IHN0ckxlbiAvIDIpIHtcbiAgICBsZW5ndGggPSBzdHJMZW4gLyAyXG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkge1xuICAgIHZhciBwYXJzZWQgPSBwYXJzZUludChzdHJpbmcuc3Vic3RyKGkgKiAyLCAyKSwgMTYpXG4gICAgaWYgKGlzTmFOKHBhcnNlZCkpIHJldHVybiBpXG4gICAgYnVmW29mZnNldCArIGldID0gcGFyc2VkXG4gIH1cbiAgcmV0dXJuIGlcbn1cblxuZnVuY3Rpb24gdXRmOFdyaXRlIChidWYsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpIHtcbiAgcmV0dXJuIGJsaXRCdWZmZXIodXRmOFRvQnl0ZXMoc3RyaW5nLCBidWYubGVuZ3RoIC0gb2Zmc2V0KSwgYnVmLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYXNjaWlXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKGFzY2lpVG9CeXRlcyhzdHJpbmcpLCBidWYsIG9mZnNldCwgbGVuZ3RoKVxufVxuXG5mdW5jdGlvbiBsYXRpbjFXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBhc2NpaVdyaXRlKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcbn1cblxuZnVuY3Rpb24gYmFzZTY0V3JpdGUgKGJ1Ziwgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCkge1xuICByZXR1cm4gYmxpdEJ1ZmZlcihiYXNlNjRUb0J5dGVzKHN0cmluZyksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbmZ1bmN0aW9uIHVjczJXcml0ZSAoYnVmLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKSB7XG4gIHJldHVybiBibGl0QnVmZmVyKHV0ZjE2bGVUb0J5dGVzKHN0cmluZywgYnVmLmxlbmd0aCAtIG9mZnNldCksIGJ1Ziwgb2Zmc2V0LCBsZW5ndGgpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiB3cml0ZSAoc3RyaW5nLCBvZmZzZXQsIGxlbmd0aCwgZW5jb2RpbmcpIHtcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZylcbiAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZW5jb2RpbmcgPSAndXRmOCdcbiAgICBsZW5ndGggPSB0aGlzLmxlbmd0aFxuICAgIG9mZnNldCA9IDBcbiAgLy8gQnVmZmVyI3dyaXRlKHN0cmluZywgZW5jb2RpbmcpXG4gIH0gZWxzZSBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICBlbmNvZGluZyA9IG9mZnNldFxuICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoXG4gICAgb2Zmc2V0ID0gMFxuICAvLyBCdWZmZXIjd3JpdGUoc3RyaW5nLCBvZmZzZXRbLCBsZW5ndGhdWywgZW5jb2RpbmddKVxuICB9IGVsc2UgaWYgKGlzRmluaXRlKG9mZnNldCkpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gICAgaWYgKGlzRmluaXRlKGxlbmd0aCkpIHtcbiAgICAgIGxlbmd0aCA9IGxlbmd0aCB8IDBcbiAgICAgIGlmIChlbmNvZGluZyA9PT0gdW5kZWZpbmVkKSBlbmNvZGluZyA9ICd1dGY4J1xuICAgIH0gZWxzZSB7XG4gICAgICBlbmNvZGluZyA9IGxlbmd0aFxuICAgICAgbGVuZ3RoID0gdW5kZWZpbmVkXG4gICAgfVxuICAvLyBsZWdhY3kgd3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0LCBsZW5ndGgpIC0gcmVtb3ZlIGluIHYwLjEzXG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgJ0J1ZmZlci53cml0ZShzdHJpbmcsIGVuY29kaW5nLCBvZmZzZXRbLCBsZW5ndGhdKSBpcyBubyBsb25nZXIgc3VwcG9ydGVkJ1xuICAgIClcbiAgfVxuXG4gIHZhciByZW1haW5pbmcgPSB0aGlzLmxlbmd0aCAtIG9mZnNldFxuICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQgfHwgbGVuZ3RoID4gcmVtYWluaW5nKSBsZW5ndGggPSByZW1haW5pbmdcblxuICBpZiAoKHN0cmluZy5sZW5ndGggPiAwICYmIChsZW5ndGggPCAwIHx8IG9mZnNldCA8IDApKSB8fCBvZmZzZXQgPiB0aGlzLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdBdHRlbXB0IHRvIHdyaXRlIG91dHNpZGUgYnVmZmVyIGJvdW5kcycpXG4gIH1cblxuICBpZiAoIWVuY29kaW5nKSBlbmNvZGluZyA9ICd1dGY4J1xuXG4gIHZhciBsb3dlcmVkQ2FzZSA9IGZhbHNlXG4gIGZvciAoOzspIHtcbiAgICBzd2l0Y2ggKGVuY29kaW5nKSB7XG4gICAgICBjYXNlICdoZXgnOlxuICAgICAgICByZXR1cm4gaGV4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAndXRmOCc6XG4gICAgICBjYXNlICd1dGYtOCc6XG4gICAgICAgIHJldHVybiB1dGY4V3JpdGUodGhpcywgc3RyaW5nLCBvZmZzZXQsIGxlbmd0aClcblxuICAgICAgY2FzZSAnYXNjaWknOlxuICAgICAgICByZXR1cm4gYXNjaWlXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICdsYXRpbjEnOlxuICAgICAgY2FzZSAnYmluYXJ5JzpcbiAgICAgICAgcmV0dXJuIGxhdGluMVdyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGNhc2UgJ2Jhc2U2NCc6XG4gICAgICAgIC8vIFdhcm5pbmc6IG1heExlbmd0aCBub3QgdGFrZW4gaW50byBhY2NvdW50IGluIGJhc2U2NFdyaXRlXG4gICAgICAgIHJldHVybiBiYXNlNjRXcml0ZSh0aGlzLCBzdHJpbmcsIG9mZnNldCwgbGVuZ3RoKVxuXG4gICAgICBjYXNlICd1Y3MyJzpcbiAgICAgIGNhc2UgJ3Vjcy0yJzpcbiAgICAgIGNhc2UgJ3V0ZjE2bGUnOlxuICAgICAgY2FzZSAndXRmLTE2bGUnOlxuICAgICAgICByZXR1cm4gdWNzMldyaXRlKHRoaXMsIHN0cmluZywgb2Zmc2V0LCBsZW5ndGgpXG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChsb3dlcmVkQ2FzZSkgdGhyb3cgbmV3IFR5cGVFcnJvcignVW5rbm93biBlbmNvZGluZzogJyArIGVuY29kaW5nKVxuICAgICAgICBlbmNvZGluZyA9ICgnJyArIGVuY29kaW5nKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGxvd2VyZWRDYXNlID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uIHRvSlNPTiAoKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0J1ZmZlcicsXG4gICAgZGF0YTogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5fYXJyIHx8IHRoaXMsIDApXG4gIH1cbn1cblxuZnVuY3Rpb24gYmFzZTY0U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICBpZiAoc3RhcnQgPT09IDAgJiYgZW5kID09PSBidWYubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGJhc2U2NC5mcm9tQnl0ZUFycmF5KGJ1ZilcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYmFzZTY0LmZyb21CeXRlQXJyYXkoYnVmLnNsaWNlKHN0YXJ0LCBlbmQpKVxuICB9XG59XG5cbmZ1bmN0aW9uIHV0ZjhTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIGVuZCA9IE1hdGgubWluKGJ1Zi5sZW5ndGgsIGVuZClcbiAgdmFyIHJlcyA9IFtdXG5cbiAgdmFyIGkgPSBzdGFydFxuICB3aGlsZSAoaSA8IGVuZCkge1xuICAgIHZhciBmaXJzdEJ5dGUgPSBidWZbaV1cbiAgICB2YXIgY29kZVBvaW50ID0gbnVsbFxuICAgIHZhciBieXRlc1BlclNlcXVlbmNlID0gKGZpcnN0Qnl0ZSA+IDB4RUYpID8gNFxuICAgICAgOiAoZmlyc3RCeXRlID4gMHhERikgPyAzXG4gICAgICA6IChmaXJzdEJ5dGUgPiAweEJGKSA/IDJcbiAgICAgIDogMVxuXG4gICAgaWYgKGkgKyBieXRlc1BlclNlcXVlbmNlIDw9IGVuZCkge1xuICAgICAgdmFyIHNlY29uZEJ5dGUsIHRoaXJkQnl0ZSwgZm91cnRoQnl0ZSwgdGVtcENvZGVQb2ludFxuXG4gICAgICBzd2l0Y2ggKGJ5dGVzUGVyU2VxdWVuY2UpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGlmIChmaXJzdEJ5dGUgPCAweDgwKSB7XG4gICAgICAgICAgICBjb2RlUG9pbnQgPSBmaXJzdEJ5dGVcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHgxRikgPDwgMHg2IHwgKHNlY29uZEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweDdGKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGlmICgoc2Vjb25kQnl0ZSAmIDB4QzApID09PSAweDgwICYmICh0aGlyZEJ5dGUgJiAweEMwKSA9PT0gMHg4MCkge1xuICAgICAgICAgICAgdGVtcENvZGVQb2ludCA9IChmaXJzdEJ5dGUgJiAweEYpIDw8IDB4QyB8IChzZWNvbmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKHRoaXJkQnl0ZSAmIDB4M0YpXG4gICAgICAgICAgICBpZiAodGVtcENvZGVQb2ludCA+IDB4N0ZGICYmICh0ZW1wQ29kZVBvaW50IDwgMHhEODAwIHx8IHRlbXBDb2RlUG9pbnQgPiAweERGRkYpKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIHNlY29uZEJ5dGUgPSBidWZbaSArIDFdXG4gICAgICAgICAgdGhpcmRCeXRlID0gYnVmW2kgKyAyXVxuICAgICAgICAgIGZvdXJ0aEJ5dGUgPSBidWZbaSArIDNdXG4gICAgICAgICAgaWYgKChzZWNvbmRCeXRlICYgMHhDMCkgPT09IDB4ODAgJiYgKHRoaXJkQnl0ZSAmIDB4QzApID09PSAweDgwICYmIChmb3VydGhCeXRlICYgMHhDMCkgPT09IDB4ODApIHtcbiAgICAgICAgICAgIHRlbXBDb2RlUG9pbnQgPSAoZmlyc3RCeXRlICYgMHhGKSA8PCAweDEyIHwgKHNlY29uZEJ5dGUgJiAweDNGKSA8PCAweEMgfCAodGhpcmRCeXRlICYgMHgzRikgPDwgMHg2IHwgKGZvdXJ0aEJ5dGUgJiAweDNGKVxuICAgICAgICAgICAgaWYgKHRlbXBDb2RlUG9pbnQgPiAweEZGRkYgJiYgdGVtcENvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICAgICAgICAgIGNvZGVQb2ludCA9IHRlbXBDb2RlUG9pbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvZGVQb2ludCA9PT0gbnVsbCkge1xuICAgICAgLy8gd2UgZGlkIG5vdCBnZW5lcmF0ZSBhIHZhbGlkIGNvZGVQb2ludCBzbyBpbnNlcnQgYVxuICAgICAgLy8gcmVwbGFjZW1lbnQgY2hhciAoVStGRkZEKSBhbmQgYWR2YW5jZSBvbmx5IDEgYnl0ZVxuICAgICAgY29kZVBvaW50ID0gMHhGRkZEXG4gICAgICBieXRlc1BlclNlcXVlbmNlID0gMVxuICAgIH0gZWxzZSBpZiAoY29kZVBvaW50ID4gMHhGRkZGKSB7XG4gICAgICAvLyBlbmNvZGUgdG8gdXRmMTYgKHN1cnJvZ2F0ZSBwYWlyIGRhbmNlKVxuICAgICAgY29kZVBvaW50IC09IDB4MTAwMDBcbiAgICAgIHJlcy5wdXNoKGNvZGVQb2ludCA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMClcbiAgICAgIGNvZGVQb2ludCA9IDB4REMwMCB8IGNvZGVQb2ludCAmIDB4M0ZGXG4gICAgfVxuXG4gICAgcmVzLnB1c2goY29kZVBvaW50KVxuICAgIGkgKz0gYnl0ZXNQZXJTZXF1ZW5jZVxuICB9XG5cbiAgcmV0dXJuIGRlY29kZUNvZGVQb2ludHNBcnJheShyZXMpXG59XG5cbi8vIEJhc2VkIG9uIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyNzQ3MjcyLzY4MDc0MiwgdGhlIGJyb3dzZXIgd2l0aFxuLy8gdGhlIGxvd2VzdCBsaW1pdCBpcyBDaHJvbWUsIHdpdGggMHgxMDAwMCBhcmdzLlxuLy8gV2UgZ28gMSBtYWduaXR1ZGUgbGVzcywgZm9yIHNhZmV0eVxudmFyIE1BWF9BUkdVTUVOVFNfTEVOR1RIID0gMHgxMDAwXG5cbmZ1bmN0aW9uIGRlY29kZUNvZGVQb2ludHNBcnJheSAoY29kZVBvaW50cykge1xuICB2YXIgbGVuID0gY29kZVBvaW50cy5sZW5ndGhcbiAgaWYgKGxlbiA8PSBNQVhfQVJHVU1FTlRTX0xFTkdUSCkge1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZywgY29kZVBvaW50cykgLy8gYXZvaWQgZXh0cmEgc2xpY2UoKVxuICB9XG5cbiAgLy8gRGVjb2RlIGluIGNodW5rcyB0byBhdm9pZCBcImNhbGwgc3RhY2sgc2l6ZSBleGNlZWRlZFwiLlxuICB2YXIgcmVzID0gJydcbiAgdmFyIGkgPSAwXG4gIHdoaWxlIChpIDwgbGVuKSB7XG4gICAgcmVzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoXG4gICAgICBTdHJpbmcsXG4gICAgICBjb2RlUG9pbnRzLnNsaWNlKGksIGkgKz0gTUFYX0FSR1VNRU5UU19MRU5HVEgpXG4gICAgKVxuICB9XG4gIHJldHVybiByZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlTbGljZSAoYnVmLCBzdGFydCwgZW5kKSB7XG4gIHZhciByZXQgPSAnJ1xuICBlbmQgPSBNYXRoLm1pbihidWYubGVuZ3RoLCBlbmQpXG5cbiAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyArK2kpIHtcbiAgICByZXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShidWZbaV0gJiAweDdGKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gbGF0aW4xU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgcmV0ID0gJydcbiAgZW5kID0gTWF0aC5taW4oYnVmLmxlbmd0aCwgZW5kKVxuXG4gIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgcmV0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmW2ldKVxuICB9XG4gIHJldHVybiByZXRcbn1cblxuZnVuY3Rpb24gaGV4U2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gYnVmLmxlbmd0aFxuXG4gIGlmICghc3RhcnQgfHwgc3RhcnQgPCAwKSBzdGFydCA9IDBcbiAgaWYgKCFlbmQgfHwgZW5kIDwgMCB8fCBlbmQgPiBsZW4pIGVuZCA9IGxlblxuXG4gIHZhciBvdXQgPSAnJ1xuICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7ICsraSkge1xuICAgIG91dCArPSB0b0hleChidWZbaV0pXG4gIH1cbiAgcmV0dXJuIG91dFxufVxuXG5mdW5jdGlvbiB1dGYxNmxlU2xpY2UgKGJ1Ziwgc3RhcnQsIGVuZCkge1xuICB2YXIgYnl0ZXMgPSBidWYuc2xpY2Uoc3RhcnQsIGVuZClcbiAgdmFyIHJlcyA9ICcnXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICByZXMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlc1tpXSArIGJ5dGVzW2kgKyAxXSAqIDI1NilcbiAgfVxuICByZXR1cm4gcmVzXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgPSBmdW5jdGlvbiBzbGljZSAoc3RhcnQsIGVuZCkge1xuICB2YXIgbGVuID0gdGhpcy5sZW5ndGhcbiAgc3RhcnQgPSB+fnN0YXJ0XG4gIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogfn5lbmRcblxuICBpZiAoc3RhcnQgPCAwKSB7XG4gICAgc3RhcnQgKz0gbGVuXG4gICAgaWYgKHN0YXJ0IDwgMCkgc3RhcnQgPSAwXG4gIH0gZWxzZSBpZiAoc3RhcnQgPiBsZW4pIHtcbiAgICBzdGFydCA9IGxlblxuICB9XG5cbiAgaWYgKGVuZCA8IDApIHtcbiAgICBlbmQgKz0gbGVuXG4gICAgaWYgKGVuZCA8IDApIGVuZCA9IDBcbiAgfSBlbHNlIGlmIChlbmQgPiBsZW4pIHtcbiAgICBlbmQgPSBsZW5cbiAgfVxuXG4gIGlmIChlbmQgPCBzdGFydCkgZW5kID0gc3RhcnRcblxuICB2YXIgbmV3QnVmXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIG5ld0J1ZiA9IHRoaXMuc3ViYXJyYXkoc3RhcnQsIGVuZClcbiAgICBuZXdCdWYuX19wcm90b19fID0gQnVmZmVyLnByb3RvdHlwZVxuICB9IGVsc2Uge1xuICAgIHZhciBzbGljZUxlbiA9IGVuZCAtIHN0YXJ0XG4gICAgbmV3QnVmID0gbmV3IEJ1ZmZlcihzbGljZUxlbiwgdW5kZWZpbmVkKVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2xpY2VMZW47ICsraSkge1xuICAgICAgbmV3QnVmW2ldID0gdGhpc1tpICsgc3RhcnRdXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG5ld0J1ZlxufVxuXG4vKlxuICogTmVlZCB0byBtYWtlIHN1cmUgdGhhdCBidWZmZXIgaXNuJ3QgdHJ5aW5nIHRvIHdyaXRlIG91dCBvZiBib3VuZHMuXG4gKi9cbmZ1bmN0aW9uIGNoZWNrT2Zmc2V0IChvZmZzZXQsIGV4dCwgbGVuZ3RoKSB7XG4gIGlmICgob2Zmc2V0ICUgMSkgIT09IDAgfHwgb2Zmc2V0IDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ29mZnNldCBpcyBub3QgdWludCcpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBsZW5ndGgpIHRocm93IG5ldyBSYW5nZUVycm9yKCdUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludExFID0gZnVuY3Rpb24gcmVhZFVJbnRMRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIGJ5dGVMZW5ndGgsIHRoaXMubGVuZ3RoKVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldF1cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHdoaWxlICgrK2kgPCBieXRlTGVuZ3RoICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgaV0gKiBtdWxcbiAgfVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludEJFID0gZnVuY3Rpb24gcmVhZFVJbnRCRSAob2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcbiAgfVxuXG4gIHZhciB2YWwgPSB0aGlzW29mZnNldCArIC0tYnl0ZUxlbmd0aF1cbiAgdmFyIG11bCA9IDFcbiAgd2hpbGUgKGJ5dGVMZW5ndGggPiAwICYmIChtdWwgKj0gMHgxMDApKSB7XG4gICAgdmFsICs9IHRoaXNbb2Zmc2V0ICsgLS1ieXRlTGVuZ3RoXSAqIG11bFxuICB9XG5cbiAgcmV0dXJuIHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50OCA9IGZ1bmN0aW9uIHJlYWRVSW50OCAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDEsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gdGhpc1tvZmZzZXRdXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQxNkxFID0gZnVuY3Rpb24gcmVhZFVJbnQxNkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMiwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiB0aGlzW29mZnNldF0gfCAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRVSW50MTZCRSA9IGZ1bmN0aW9uIHJlYWRVSW50MTZCRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICByZXR1cm4gKHRoaXNbb2Zmc2V0XSA8PCA4KSB8IHRoaXNbb2Zmc2V0ICsgMV1cbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkVUludDMyTEUgPSBmdW5jdGlvbiByZWFkVUludDMyTEUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA0LCB0aGlzLmxlbmd0aClcblxuICByZXR1cm4gKCh0aGlzW29mZnNldF0pIHxcbiAgICAgICh0aGlzW29mZnNldCArIDFdIDw8IDgpIHxcbiAgICAgICh0aGlzW29mZnNldCArIDJdIDw8IDE2KSkgK1xuICAgICAgKHRoaXNbb2Zmc2V0ICsgM10gKiAweDEwMDAwMDApXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZFVJbnQzMkJFID0gZnVuY3Rpb24gcmVhZFVJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gKiAweDEwMDAwMDApICtcbiAgICAoKHRoaXNbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgdGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50TEUgPSBmdW5jdGlvbiByZWFkSW50TEUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdXG4gIHZhciBtdWwgPSAxXG4gIHZhciBpID0gMFxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHZhbCArPSB0aGlzW29mZnNldCArIGldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50QkUgPSBmdW5jdGlvbiByZWFkSW50QkUgKG9mZnNldCwgYnl0ZUxlbmd0aCwgbm9Bc3NlcnQpIHtcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBieXRlTGVuZ3RoID0gYnl0ZUxlbmd0aCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCBieXRlTGVuZ3RoLCB0aGlzLmxlbmd0aClcblxuICB2YXIgaSA9IGJ5dGVMZW5ndGhcbiAgdmFyIG11bCA9IDFcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgLS1pXVxuICB3aGlsZSAoaSA+IDAgJiYgKG11bCAqPSAweDEwMCkpIHtcbiAgICB2YWwgKz0gdGhpc1tvZmZzZXQgKyAtLWldICogbXVsXG4gIH1cbiAgbXVsICo9IDB4ODBcblxuICBpZiAodmFsID49IG11bCkgdmFsIC09IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoKVxuXG4gIHJldHVybiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50OCA9IGZ1bmN0aW9uIHJlYWRJbnQ4IChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgMSwgdGhpcy5sZW5ndGgpXG4gIGlmICghKHRoaXNbb2Zmc2V0XSAmIDB4ODApKSByZXR1cm4gKHRoaXNbb2Zmc2V0XSlcbiAgcmV0dXJuICgoMHhmZiAtIHRoaXNbb2Zmc2V0XSArIDEpICogLTEpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZEludDE2TEUgPSBmdW5jdGlvbiByZWFkSW50MTZMRSAob2Zmc2V0LCBub0Fzc2VydCkge1xuICBpZiAoIW5vQXNzZXJ0KSBjaGVja09mZnNldChvZmZzZXQsIDIsIHRoaXMubGVuZ3RoKVxuICB2YXIgdmFsID0gdGhpc1tvZmZzZXRdIHwgKHRoaXNbb2Zmc2V0ICsgMV0gPDwgOClcbiAgcmV0dXJuICh2YWwgJiAweDgwMDApID8gdmFsIHwgMHhGRkZGMDAwMCA6IHZhbFxufVxuXG5CdWZmZXIucHJvdG90eXBlLnJlYWRJbnQxNkJFID0gZnVuY3Rpb24gcmVhZEludDE2QkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCAyLCB0aGlzLmxlbmd0aClcbiAgdmFyIHZhbCA9IHRoaXNbb2Zmc2V0ICsgMV0gfCAodGhpc1tvZmZzZXRdIDw8IDgpXG4gIHJldHVybiAodmFsICYgMHg4MDAwKSA/IHZhbCB8IDB4RkZGRjAwMDAgOiB2YWxcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJMRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0pIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCA4KSB8XG4gICAgKHRoaXNbb2Zmc2V0ICsgMl0gPDwgMTYpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSA8PCAyNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkSW50MzJCRSA9IGZ1bmN0aW9uIHJlYWRJbnQzMkJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG5cbiAgcmV0dXJuICh0aGlzW29mZnNldF0gPDwgMjQpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAxXSA8PCAxNikgfFxuICAgICh0aGlzW29mZnNldCArIDJdIDw8IDgpIHxcbiAgICAodGhpc1tvZmZzZXQgKyAzXSlcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRMRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdExFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCAyMywgNClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRmxvYXRCRSA9IGZ1bmN0aW9uIHJlYWRGbG9hdEJFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgNCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCBmYWxzZSwgMjMsIDQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUucmVhZERvdWJsZUxFID0gZnVuY3Rpb24gcmVhZERvdWJsZUxFIChvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrT2Zmc2V0KG9mZnNldCwgOCwgdGhpcy5sZW5ndGgpXG4gIHJldHVybiBpZWVlNzU0LnJlYWQodGhpcywgb2Zmc2V0LCB0cnVlLCA1MiwgOClcbn1cblxuQnVmZmVyLnByb3RvdHlwZS5yZWFkRG91YmxlQkUgPSBmdW5jdGlvbiByZWFkRG91YmxlQkUgKG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tPZmZzZXQob2Zmc2V0LCA4LCB0aGlzLmxlbmd0aClcbiAgcmV0dXJuIGllZWU3NTQucmVhZCh0aGlzLCBvZmZzZXQsIGZhbHNlLCA1MiwgOClcbn1cblxuZnVuY3Rpb24gY2hlY2tJbnQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAoIUJ1ZmZlci5pc0J1ZmZlcihidWYpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImJ1ZmZlclwiIGFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIgaW5zdGFuY2UnKVxuICBpZiAodmFsdWUgPiBtYXggfHwgdmFsdWUgPCBtaW4pIHRocm93IG5ldyBSYW5nZUVycm9yKCdcInZhbHVlXCIgYXJndW1lbnQgaXMgb3V0IG9mIGJvdW5kcycpXG4gIGlmIChvZmZzZXQgKyBleHQgPiBidWYubGVuZ3RoKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlVUludExFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIG11bCA9IDFcbiAgdmFyIGkgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlVUludEJFICh2YWx1ZSwgb2Zmc2V0LCBieXRlTGVuZ3RoLCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGJ5dGVMZW5ndGggPSBieXRlTGVuZ3RoIHwgMFxuICBpZiAoIW5vQXNzZXJ0KSB7XG4gICAgdmFyIG1heEJ5dGVzID0gTWF0aC5wb3coMiwgOCAqIGJ5dGVMZW5ndGgpIC0gMVxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG1heEJ5dGVzLCAwKVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAodmFsdWUgLyBtdWwpICYgMHhGRlxuICB9XG5cbiAgcmV0dXJuIG9mZnNldCArIGJ5dGVMZW5ndGhcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVVSW50OCAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAxLCAweGZmLCAwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gIHJldHVybiBvZmZzZXQgKyAxXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDE2IChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZiArIHZhbHVlICsgMVxuICBmb3IgKHZhciBpID0gMCwgaiA9IE1hdGgubWluKGJ1Zi5sZW5ndGggLSBvZmZzZXQsIDIpOyBpIDwgajsgKytpKSB7XG4gICAgYnVmW29mZnNldCArIGldID0gKHZhbHVlICYgKDB4ZmYgPDwgKDggKiAobGl0dGxlRW5kaWFuID8gaSA6IDEgLSBpKSkpKSA+Pj5cbiAgICAgIChsaXR0bGVFbmRpYW4gPyBpIDogMSAtIGkpICogOFxuICB9XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlVUludDE2TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgMiwgMHhmZmZmLCAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MTYodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgMlxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDE2QkUgPSBmdW5jdGlvbiB3cml0ZVVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4ZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbmZ1bmN0aW9uIG9iamVjdFdyaXRlVUludDMyIChidWYsIHZhbHVlLCBvZmZzZXQsIGxpdHRsZUVuZGlhbikge1xuICBpZiAodmFsdWUgPCAwKSB2YWx1ZSA9IDB4ZmZmZmZmZmYgKyB2YWx1ZSArIDFcbiAgZm9yICh2YXIgaSA9IDAsIGogPSBNYXRoLm1pbihidWYubGVuZ3RoIC0gb2Zmc2V0LCA0KTsgaSA8IGo7ICsraSkge1xuICAgIGJ1ZltvZmZzZXQgKyBpXSA9ICh2YWx1ZSA+Pj4gKGxpdHRsZUVuZGlhbiA/IGkgOiAzIC0gaSkgKiA4KSAmIDB4ZmZcbiAgfVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlVUludDMyTEUgPSBmdW5jdGlvbiB3cml0ZVVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4ZmZmZmZmZmYsIDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgPj4+IDI0KVxuICAgIHRoaXNbb2Zmc2V0ICsgMl0gPSAodmFsdWUgPj4+IDE2KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVVSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlVUludDMyQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkgY2hlY2tJbnQodGhpcywgdmFsdWUsIG9mZnNldCwgNCwgMHhmZmZmZmZmZiwgMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiAyNClcbiAgICB0aGlzW29mZnNldCArIDFdID0gKHZhbHVlID4+PiAxNilcbiAgICB0aGlzW29mZnNldCArIDJdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgM10gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDMyKHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyA0XG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRMRSA9IGZ1bmN0aW9uIHdyaXRlSW50TEUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSAwXG4gIHZhciBtdWwgPSAxXG4gIHZhciBzdWIgPSAwXG4gIHRoaXNbb2Zmc2V0XSA9IHZhbHVlICYgMHhGRlxuICB3aGlsZSAoKytpIDwgYnl0ZUxlbmd0aCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSAtIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnRCRSA9IGZ1bmN0aW9uIHdyaXRlSW50QkUgKHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIG5vQXNzZXJ0KSB7XG4gIHZhbHVlID0gK3ZhbHVlXG4gIG9mZnNldCA9IG9mZnNldCB8IDBcbiAgaWYgKCFub0Fzc2VydCkge1xuICAgIHZhciBsaW1pdCA9IE1hdGgucG93KDIsIDggKiBieXRlTGVuZ3RoIC0gMSlcblxuICAgIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGJ5dGVMZW5ndGgsIGxpbWl0IC0gMSwgLWxpbWl0KVxuICB9XG5cbiAgdmFyIGkgPSBieXRlTGVuZ3RoIC0gMVxuICB2YXIgbXVsID0gMVxuICB2YXIgc3ViID0gMFxuICB0aGlzW29mZnNldCArIGldID0gdmFsdWUgJiAweEZGXG4gIHdoaWxlICgtLWkgPj0gMCAmJiAobXVsICo9IDB4MTAwKSkge1xuICAgIGlmICh2YWx1ZSA8IDAgJiYgc3ViID09PSAwICYmIHRoaXNbb2Zmc2V0ICsgaSArIDFdICE9PSAwKSB7XG4gICAgICBzdWIgPSAxXG4gICAgfVxuICAgIHRoaXNbb2Zmc2V0ICsgaV0gPSAoKHZhbHVlIC8gbXVsKSA+PiAwKSAtIHN1YiAmIDB4RkZcbiAgfVxuXG4gIHJldHVybiBvZmZzZXQgKyBieXRlTGVuZ3RoXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQ4ID0gZnVuY3Rpb24gd3JpdGVJbnQ4ICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDEsIDB4N2YsIC0weDgwKVxuICBpZiAoIUJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB2YWx1ZSA9IE1hdGguZmxvb3IodmFsdWUpXG4gIGlmICh2YWx1ZSA8IDApIHZhbHVlID0gMHhmZiArIHZhbHVlICsgMVxuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICByZXR1cm4gb2Zmc2V0ICsgMVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MTZMRSA9IGZ1bmN0aW9uIHdyaXRlSW50MTZMRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCAyLCAweDdmZmYsIC0weDgwMDApXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gOClcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQxNih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCB0cnVlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQxNkJFID0gZnVuY3Rpb24gd3JpdGVJbnQxNkJFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDIsIDB4N2ZmZiwgLTB4ODAwMClcbiAgaWYgKEJ1ZmZlci5UWVBFRF9BUlJBWV9TVVBQT1JUKSB7XG4gICAgdGhpc1tvZmZzZXRdID0gKHZhbHVlID4+PiA4KVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgJiAweGZmKVxuICB9IGVsc2Uge1xuICAgIG9iamVjdFdyaXRlVUludDE2KHRoaXMsIHZhbHVlLCBvZmZzZXQsIGZhbHNlKVxuICB9XG4gIHJldHVybiBvZmZzZXQgKyAyXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVJbnQzMkxFID0gZnVuY3Rpb24gd3JpdGVJbnQzMkxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICB2YWx1ZSA9ICt2YWx1ZVxuICBvZmZzZXQgPSBvZmZzZXQgfCAwXG4gIGlmICghbm9Bc3NlcnQpIGNoZWNrSW50KHRoaXMsIHZhbHVlLCBvZmZzZXQsIDQsIDB4N2ZmZmZmZmYsIC0weDgwMDAwMDAwKVxuICBpZiAoQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmKVxuICAgIHRoaXNbb2Zmc2V0ICsgMV0gPSAodmFsdWUgPj4+IDgpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAzXSA9ICh2YWx1ZSA+Pj4gMjQpXG4gIH0gZWxzZSB7XG4gICAgb2JqZWN0V3JpdGVVSW50MzIodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlSW50MzJCRSA9IGZ1bmN0aW9uIHdyaXRlSW50MzJCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgdmFsdWUgPSArdmFsdWVcbiAgb2Zmc2V0ID0gb2Zmc2V0IHwgMFxuICBpZiAoIW5vQXNzZXJ0KSBjaGVja0ludCh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCA0LCAweDdmZmZmZmZmLCAtMHg4MDAwMDAwMClcbiAgaWYgKHZhbHVlIDwgMCkgdmFsdWUgPSAweGZmZmZmZmZmICsgdmFsdWUgKyAxXG4gIGlmIChCdWZmZXIuVFlQRURfQVJSQVlfU1VQUE9SVCkge1xuICAgIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSA+Pj4gMjQpXG4gICAgdGhpc1tvZmZzZXQgKyAxXSA9ICh2YWx1ZSA+Pj4gMTYpXG4gICAgdGhpc1tvZmZzZXQgKyAyXSA9ICh2YWx1ZSA+Pj4gOClcbiAgICB0aGlzW29mZnNldCArIDNdID0gKHZhbHVlICYgMHhmZilcbiAgfSBlbHNlIHtcbiAgICBvYmplY3RXcml0ZVVJbnQzMih0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSlcbiAgfVxuICByZXR1cm4gb2Zmc2V0ICsgNFxufVxuXG5mdW5jdGlvbiBjaGVja0lFRUU3NTQgKGJ1ZiwgdmFsdWUsIG9mZnNldCwgZXh0LCBtYXgsIG1pbikge1xuICBpZiAob2Zmc2V0ICsgZXh0ID4gYnVmLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0luZGV4IG91dCBvZiByYW5nZScpXG4gIGlmIChvZmZzZXQgPCAwKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignSW5kZXggb3V0IG9mIHJhbmdlJylcbn1cblxuZnVuY3Rpb24gd3JpdGVGbG9hdCAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA0LCAzLjQwMjgyMzQ2NjM4NTI4ODZlKzM4LCAtMy40MDI4MjM0NjYzODUyODg2ZSszOClcbiAgfVxuICBpZWVlNzU0LndyaXRlKGJ1ZiwgdmFsdWUsIG9mZnNldCwgbGl0dGxlRW5kaWFuLCAyMywgNClcbiAgcmV0dXJuIG9mZnNldCArIDRcbn1cblxuQnVmZmVyLnByb3RvdHlwZS53cml0ZUZsb2F0TEUgPSBmdW5jdGlvbiB3cml0ZUZsb2F0TEUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZUZsb2F0KHRoaXMsIHZhbHVlLCBvZmZzZXQsIHRydWUsIG5vQXNzZXJ0KVxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRmxvYXRCRSA9IGZ1bmN0aW9uIHdyaXRlRmxvYXRCRSAodmFsdWUsIG9mZnNldCwgbm9Bc3NlcnQpIHtcbiAgcmV0dXJuIHdyaXRlRmxvYXQodGhpcywgdmFsdWUsIG9mZnNldCwgZmFsc2UsIG5vQXNzZXJ0KVxufVxuXG5mdW5jdGlvbiB3cml0ZURvdWJsZSAoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIG5vQXNzZXJ0KSB7XG4gIGlmICghbm9Bc3NlcnQpIHtcbiAgICBjaGVja0lFRUU3NTQoYnVmLCB2YWx1ZSwgb2Zmc2V0LCA4LCAxLjc5NzY5MzEzNDg2MjMxNTdFKzMwOCwgLTEuNzk3NjkzMTM0ODYyMzE1N0UrMzA4KVxuICB9XG4gIGllZWU3NTQud3JpdGUoYnVmLCB2YWx1ZSwgb2Zmc2V0LCBsaXR0bGVFbmRpYW4sIDUyLCA4KVxuICByZXR1cm4gb2Zmc2V0ICsgOFxufVxuXG5CdWZmZXIucHJvdG90eXBlLndyaXRlRG91YmxlTEUgPSBmdW5jdGlvbiB3cml0ZURvdWJsZUxFICh2YWx1ZSwgb2Zmc2V0LCBub0Fzc2VydCkge1xuICByZXR1cm4gd3JpdGVEb3VibGUodGhpcywgdmFsdWUsIG9mZnNldCwgdHJ1ZSwgbm9Bc3NlcnQpXG59XG5cbkJ1ZmZlci5wcm90b3R5cGUud3JpdGVEb3VibGVCRSA9IGZ1bmN0aW9uIHdyaXRlRG91YmxlQkUgKHZhbHVlLCBvZmZzZXQsIG5vQXNzZXJ0KSB7XG4gIHJldHVybiB3cml0ZURvdWJsZSh0aGlzLCB2YWx1ZSwgb2Zmc2V0LCBmYWxzZSwgbm9Bc3NlcnQpXG59XG5cbi8vIGNvcHkodGFyZ2V0QnVmZmVyLCB0YXJnZXRTdGFydD0wLCBzb3VyY2VTdGFydD0wLCBzb3VyY2VFbmQ9YnVmZmVyLmxlbmd0aClcbkJ1ZmZlci5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIGNvcHkgKHRhcmdldCwgdGFyZ2V0U3RhcnQsIHN0YXJ0LCBlbmQpIHtcbiAgaWYgKCFzdGFydCkgc3RhcnQgPSAwXG4gIGlmICghZW5kICYmIGVuZCAhPT0gMCkgZW5kID0gdGhpcy5sZW5ndGhcbiAgaWYgKHRhcmdldFN0YXJ0ID49IHRhcmdldC5sZW5ndGgpIHRhcmdldFN0YXJ0ID0gdGFyZ2V0Lmxlbmd0aFxuICBpZiAoIXRhcmdldFN0YXJ0KSB0YXJnZXRTdGFydCA9IDBcbiAgaWYgKGVuZCA+IDAgJiYgZW5kIDwgc3RhcnQpIGVuZCA9IHN0YXJ0XG5cbiAgLy8gQ29weSAwIGJ5dGVzOyB3ZSdyZSBkb25lXG4gIGlmIChlbmQgPT09IHN0YXJ0KSByZXR1cm4gMFxuICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcblxuICAvLyBGYXRhbCBlcnJvciBjb25kaXRpb25zXG4gIGlmICh0YXJnZXRTdGFydCA8IDApIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcigndGFyZ2V0U3RhcnQgb3V0IG9mIGJvdW5kcycpXG4gIH1cbiAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCA+PSB0aGlzLmxlbmd0aCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZVN0YXJ0IG91dCBvZiBib3VuZHMnKVxuICBpZiAoZW5kIDwgMCkgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3NvdXJjZUVuZCBvdXQgb2YgYm91bmRzJylcblxuICAvLyBBcmUgd2Ugb29iP1xuICBpZiAoZW5kID4gdGhpcy5sZW5ndGgpIGVuZCA9IHRoaXMubGVuZ3RoXG4gIGlmICh0YXJnZXQubGVuZ3RoIC0gdGFyZ2V0U3RhcnQgPCBlbmQgLSBzdGFydCkge1xuICAgIGVuZCA9IHRhcmdldC5sZW5ndGggLSB0YXJnZXRTdGFydCArIHN0YXJ0XG4gIH1cblxuICB2YXIgbGVuID0gZW5kIC0gc3RhcnRcbiAgdmFyIGlcblxuICBpZiAodGhpcyA9PT0gdGFyZ2V0ICYmIHN0YXJ0IDwgdGFyZ2V0U3RhcnQgJiYgdGFyZ2V0U3RhcnQgPCBlbmQpIHtcbiAgICAvLyBkZXNjZW5kaW5nIGNvcHkgZnJvbSBlbmRcbiAgICBmb3IgKGkgPSBsZW4gLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgdGFyZ2V0W2kgKyB0YXJnZXRTdGFydF0gPSB0aGlzW2kgKyBzdGFydF1cbiAgICB9XG4gIH0gZWxzZSBpZiAobGVuIDwgMTAwMCB8fCAhQnVmZmVyLlRZUEVEX0FSUkFZX1NVUFBPUlQpIHtcbiAgICAvLyBhc2NlbmRpbmcgY29weSBmcm9tIHN0YXJ0XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICB0YXJnZXRbaSArIHRhcmdldFN0YXJ0XSA9IHRoaXNbaSArIHN0YXJ0XVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBVaW50OEFycmF5LnByb3RvdHlwZS5zZXQuY2FsbChcbiAgICAgIHRhcmdldCxcbiAgICAgIHRoaXMuc3ViYXJyYXkoc3RhcnQsIHN0YXJ0ICsgbGVuKSxcbiAgICAgIHRhcmdldFN0YXJ0XG4gICAgKVxuICB9XG5cbiAgcmV0dXJuIGxlblxufVxuXG4vLyBVc2FnZTpcbi8vICAgIGJ1ZmZlci5maWxsKG51bWJlclssIG9mZnNldFssIGVuZF1dKVxuLy8gICAgYnVmZmVyLmZpbGwoYnVmZmVyWywgb2Zmc2V0WywgZW5kXV0pXG4vLyAgICBidWZmZXIuZmlsbChzdHJpbmdbLCBvZmZzZXRbLCBlbmRdXVssIGVuY29kaW5nXSlcbkJ1ZmZlci5wcm90b3R5cGUuZmlsbCA9IGZ1bmN0aW9uIGZpbGwgKHZhbCwgc3RhcnQsIGVuZCwgZW5jb2RpbmcpIHtcbiAgLy8gSGFuZGxlIHN0cmluZyBjYXNlczpcbiAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKHR5cGVvZiBzdGFydCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVuY29kaW5nID0gc3RhcnRcbiAgICAgIHN0YXJ0ID0gMFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbmQgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbmNvZGluZyA9IGVuZFxuICAgICAgZW5kID0gdGhpcy5sZW5ndGhcbiAgICB9XG4gICAgaWYgKHZhbC5sZW5ndGggPT09IDEpIHtcbiAgICAgIHZhciBjb2RlID0gdmFsLmNoYXJDb2RlQXQoMClcbiAgICAgIGlmIChjb2RlIDwgMjU2KSB7XG4gICAgICAgIHZhbCA9IGNvZGVcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVuY29kaW5nICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGVuY29kaW5nICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZycpXG4gICAgfVxuICAgIGlmICh0eXBlb2YgZW5jb2RpbmcgPT09ICdzdHJpbmcnICYmICFCdWZmZXIuaXNFbmNvZGluZyhlbmNvZGluZykpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Vua25vd24gZW5jb2Rpbmc6ICcgKyBlbmNvZGluZylcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICB2YWwgPSB2YWwgJiAyNTVcbiAgfVxuXG4gIC8vIEludmFsaWQgcmFuZ2VzIGFyZSBub3Qgc2V0IHRvIGEgZGVmYXVsdCwgc28gY2FuIHJhbmdlIGNoZWNrIGVhcmx5LlxuICBpZiAoc3RhcnQgPCAwIHx8IHRoaXMubGVuZ3RoIDwgc3RhcnQgfHwgdGhpcy5sZW5ndGggPCBlbmQpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcignT3V0IG9mIHJhbmdlIGluZGV4JylcbiAgfVxuXG4gIGlmIChlbmQgPD0gc3RhcnQpIHtcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgc3RhcnQgPSBzdGFydCA+Pj4gMFxuICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IHRoaXMubGVuZ3RoIDogZW5kID4+PiAwXG5cbiAgaWYgKCF2YWwpIHZhbCA9IDBcblxuICB2YXIgaVxuICBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHtcbiAgICBmb3IgKGkgPSBzdGFydDsgaSA8IGVuZDsgKytpKSB7XG4gICAgICB0aGlzW2ldID0gdmFsXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBieXRlcyA9IEJ1ZmZlci5pc0J1ZmZlcih2YWwpXG4gICAgICA/IHZhbFxuICAgICAgOiB1dGY4VG9CeXRlcyhuZXcgQnVmZmVyKHZhbCwgZW5jb2RpbmcpLnRvU3RyaW5nKCkpXG4gICAgdmFyIGxlbiA9IGJ5dGVzLmxlbmd0aFxuICAgIGZvciAoaSA9IDA7IGkgPCBlbmQgLSBzdGFydDsgKytpKSB7XG4gICAgICB0aGlzW2kgKyBzdGFydF0gPSBieXRlc1tpICUgbGVuXVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8vIEhFTFBFUiBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT1cblxudmFyIElOVkFMSURfQkFTRTY0X1JFID0gL1teK1xcLzAtOUEtWmEtei1fXS9nXG5cbmZ1bmN0aW9uIGJhc2U2NGNsZWFuIChzdHIpIHtcbiAgLy8gTm9kZSBzdHJpcHMgb3V0IGludmFsaWQgY2hhcmFjdGVycyBsaWtlIFxcbiBhbmQgXFx0IGZyb20gdGhlIHN0cmluZywgYmFzZTY0LWpzIGRvZXMgbm90XG4gIHN0ciA9IHN0cmluZ3RyaW0oc3RyKS5yZXBsYWNlKElOVkFMSURfQkFTRTY0X1JFLCAnJylcbiAgLy8gTm9kZSBjb252ZXJ0cyBzdHJpbmdzIHdpdGggbGVuZ3RoIDwgMiB0byAnJ1xuICBpZiAoc3RyLmxlbmd0aCA8IDIpIHJldHVybiAnJ1xuICAvLyBOb2RlIGFsbG93cyBmb3Igbm9uLXBhZGRlZCBiYXNlNjQgc3RyaW5ncyAobWlzc2luZyB0cmFpbGluZyA9PT0pLCBiYXNlNjQtanMgZG9lcyBub3RcbiAgd2hpbGUgKHN0ci5sZW5ndGggJSA0ICE9PSAwKSB7XG4gICAgc3RyID0gc3RyICsgJz0nXG4gIH1cbiAgcmV0dXJuIHN0clxufVxuXG5mdW5jdGlvbiBzdHJpbmd0cmltIChzdHIpIHtcbiAgaWYgKHN0ci50cmltKSByZXR1cm4gc3RyLnRyaW0oKVxuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKVxufVxuXG5mdW5jdGlvbiB0b0hleCAobikge1xuICBpZiAobiA8IDE2KSByZXR1cm4gJzAnICsgbi50b1N0cmluZygxNilcbiAgcmV0dXJuIG4udG9TdHJpbmcoMTYpXG59XG5cbmZ1bmN0aW9uIHV0ZjhUb0J5dGVzIChzdHJpbmcsIHVuaXRzKSB7XG4gIHVuaXRzID0gdW5pdHMgfHwgSW5maW5pdHlcbiAgdmFyIGNvZGVQb2ludFxuICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aFxuICB2YXIgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcbiAgdmFyIGJ5dGVzID0gW11cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgY29kZVBvaW50ID0gc3RyaW5nLmNoYXJDb2RlQXQoaSlcblxuICAgIC8vIGlzIHN1cnJvZ2F0ZSBjb21wb25lbnRcbiAgICBpZiAoY29kZVBvaW50ID4gMHhEN0ZGICYmIGNvZGVQb2ludCA8IDB4RTAwMCkge1xuICAgICAgLy8gbGFzdCBjaGFyIHdhcyBhIGxlYWRcbiAgICAgIGlmICghbGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgICAvLyBubyBsZWFkIHlldFxuICAgICAgICBpZiAoY29kZVBvaW50ID4gMHhEQkZGKSB7XG4gICAgICAgICAgLy8gdW5leHBlY3RlZCB0cmFpbFxuICAgICAgICAgIGlmICgodW5pdHMgLT0gMykgPiAtMSkgYnl0ZXMucHVzaCgweEVGLCAweEJGLCAweEJEKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH0gZWxzZSBpZiAoaSArIDEgPT09IGxlbmd0aCkge1xuICAgICAgICAgIC8vIHVucGFpcmVkIGxlYWRcbiAgICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gdmFsaWQgbGVhZFxuICAgICAgICBsZWFkU3Vycm9nYXRlID0gY29kZVBvaW50XG5cbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gMiBsZWFkcyBpbiBhIHJvd1xuICAgICAgaWYgKGNvZGVQb2ludCA8IDB4REMwMCkge1xuICAgICAgICBpZiAoKHVuaXRzIC09IDMpID4gLTEpIGJ5dGVzLnB1c2goMHhFRiwgMHhCRiwgMHhCRClcbiAgICAgICAgbGVhZFN1cnJvZ2F0ZSA9IGNvZGVQb2ludFxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICAvLyB2YWxpZCBzdXJyb2dhdGUgcGFpclxuICAgICAgY29kZVBvaW50ID0gKGxlYWRTdXJyb2dhdGUgLSAweEQ4MDAgPDwgMTAgfCBjb2RlUG9pbnQgLSAweERDMDApICsgMHgxMDAwMFxuICAgIH0gZWxzZSBpZiAobGVhZFN1cnJvZ2F0ZSkge1xuICAgICAgLy8gdmFsaWQgYm1wIGNoYXIsIGJ1dCBsYXN0IGNoYXIgd2FzIGEgbGVhZFxuICAgICAgaWYgKCh1bml0cyAtPSAzKSA+IC0xKSBieXRlcy5wdXNoKDB4RUYsIDB4QkYsIDB4QkQpXG4gICAgfVxuXG4gICAgbGVhZFN1cnJvZ2F0ZSA9IG51bGxcblxuICAgIC8vIGVuY29kZSB1dGY4XG4gICAgaWYgKGNvZGVQb2ludCA8IDB4ODApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMSkgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChjb2RlUG9pbnQpXG4gICAgfSBlbHNlIGlmIChjb2RlUG9pbnQgPCAweDgwMCkge1xuICAgICAgaWYgKCh1bml0cyAtPSAyKSA8IDApIGJyZWFrXG4gICAgICBieXRlcy5wdXNoKFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2IHwgMHhDMCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTAwMDApIHtcbiAgICAgIGlmICgodW5pdHMgLT0gMykgPCAwKSBicmVha1xuICAgICAgYnl0ZXMucHVzaChcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyB8IDB4RTAsXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDYgJiAweDNGIHwgMHg4MCxcbiAgICAgICAgY29kZVBvaW50ICYgMHgzRiB8IDB4ODBcbiAgICAgIClcbiAgICB9IGVsc2UgaWYgKGNvZGVQb2ludCA8IDB4MTEwMDAwKSB7XG4gICAgICBpZiAoKHVuaXRzIC09IDQpIDwgMCkgYnJlYWtcbiAgICAgIGJ5dGVzLnB1c2goXG4gICAgICAgIGNvZGVQb2ludCA+PiAweDEyIHwgMHhGMCxcbiAgICAgICAgY29kZVBvaW50ID4+IDB4QyAmIDB4M0YgfCAweDgwLFxuICAgICAgICBjb2RlUG9pbnQgPj4gMHg2ICYgMHgzRiB8IDB4ODAsXG4gICAgICAgIGNvZGVQb2ludCAmIDB4M0YgfCAweDgwXG4gICAgICApXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjb2RlIHBvaW50JylcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYnl0ZXNcbn1cblxuZnVuY3Rpb24gYXNjaWlUb0J5dGVzIChzdHIpIHtcbiAgdmFyIGJ5dGVBcnJheSA9IFtdXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgLy8gTm9kZSdzIGNvZGUgc2VlbXMgdG8gYmUgZG9pbmcgdGhpcyBhbmQgbm90ICYgMHg3Ri4uXG4gICAgYnl0ZUFycmF5LnB1c2goc3RyLmNoYXJDb2RlQXQoaSkgJiAweEZGKVxuICB9XG4gIHJldHVybiBieXRlQXJyYXlcbn1cblxuZnVuY3Rpb24gdXRmMTZsZVRvQnl0ZXMgKHN0ciwgdW5pdHMpIHtcbiAgdmFyIGMsIGhpLCBsb1xuICB2YXIgYnl0ZUFycmF5ID0gW11cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAoKHVuaXRzIC09IDIpIDwgMCkgYnJlYWtcblxuICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKVxuICAgIGhpID0gYyA+PiA4XG4gICAgbG8gPSBjICUgMjU2XG4gICAgYnl0ZUFycmF5LnB1c2gobG8pXG4gICAgYnl0ZUFycmF5LnB1c2goaGkpXG4gIH1cblxuICByZXR1cm4gYnl0ZUFycmF5XG59XG5cbmZ1bmN0aW9uIGJhc2U2NFRvQnl0ZXMgKHN0cikge1xuICByZXR1cm4gYmFzZTY0LnRvQnl0ZUFycmF5KGJhc2U2NGNsZWFuKHN0cikpXG59XG5cbmZ1bmN0aW9uIGJsaXRCdWZmZXIgKHNyYywgZHN0LCBvZmZzZXQsIGxlbmd0aCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKSB7XG4gICAgaWYgKChpICsgb2Zmc2V0ID49IGRzdC5sZW5ndGgpIHx8IChpID49IHNyYy5sZW5ndGgpKSBicmVha1xuICAgIGRzdFtpICsgb2Zmc2V0XSA9IHNyY1tpXVxuICB9XG4gIHJldHVybiBpXG59XG5cbmZ1bmN0aW9uIGlzbmFuICh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gdmFsIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1jb21wYXJlXG59XG4iLCJleHBvcnRzLnJlYWQgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGlzTEUsIG1MZW4sIG5CeXRlcykge1xuICB2YXIgZSwgbVxuICB2YXIgZUxlbiA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMVxuICB2YXIgZU1heCA9ICgxIDw8IGVMZW4pIC0gMVxuICB2YXIgZUJpYXMgPSBlTWF4ID4+IDFcbiAgdmFyIG5CaXRzID0gLTdcbiAgdmFyIGkgPSBpc0xFID8gKG5CeXRlcyAtIDEpIDogMFxuICB2YXIgZCA9IGlzTEUgPyAtMSA6IDFcbiAgdmFyIHMgPSBidWZmZXJbb2Zmc2V0ICsgaV1cblxuICBpICs9IGRcblxuICBlID0gcyAmICgoMSA8PCAoLW5CaXRzKSkgLSAxKVxuICBzID4+PSAoLW5CaXRzKVxuICBuQml0cyArPSBlTGVuXG4gIGZvciAoOyBuQml0cyA+IDA7IGUgPSBlICogMjU2ICsgYnVmZmVyW29mZnNldCArIGldLCBpICs9IGQsIG5CaXRzIC09IDgpIHt9XG5cbiAgbSA9IGUgJiAoKDEgPDwgKC1uQml0cykpIC0gMSlcbiAgZSA+Pj0gKC1uQml0cylcbiAgbkJpdHMgKz0gbUxlblxuICBmb3IgKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltvZmZzZXQgKyBpXSwgaSArPSBkLCBuQml0cyAtPSA4KSB7fVxuXG4gIGlmIChlID09PSAwKSB7XG4gICAgZSA9IDEgLSBlQmlhc1xuICB9IGVsc2UgaWYgKGUgPT09IGVNYXgpIHtcbiAgICByZXR1cm4gbSA/IE5hTiA6ICgocyA/IC0xIDogMSkgKiBJbmZpbml0eSlcbiAgfSBlbHNlIHtcbiAgICBtID0gbSArIE1hdGgucG93KDIsIG1MZW4pXG4gICAgZSA9IGUgLSBlQmlhc1xuICB9XG4gIHJldHVybiAocyA/IC0xIDogMSkgKiBtICogTWF0aC5wb3coMiwgZSAtIG1MZW4pXG59XG5cbmV4cG9ydHMud3JpdGUgPSBmdW5jdGlvbiAoYnVmZmVyLCB2YWx1ZSwgb2Zmc2V0LCBpc0xFLCBtTGVuLCBuQnl0ZXMpIHtcbiAgdmFyIGUsIG0sIGNcbiAgdmFyIGVMZW4gPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDFcbiAgdmFyIGVNYXggPSAoMSA8PCBlTGVuKSAtIDFcbiAgdmFyIGVCaWFzID0gZU1heCA+PiAxXG4gIHZhciBydCA9IChtTGVuID09PSAyMyA/IE1hdGgucG93KDIsIC0yNCkgLSBNYXRoLnBvdygyLCAtNzcpIDogMClcbiAgdmFyIGkgPSBpc0xFID8gMCA6IChuQnl0ZXMgLSAxKVxuICB2YXIgZCA9IGlzTEUgPyAxIDogLTFcbiAgdmFyIHMgPSB2YWx1ZSA8IDAgfHwgKHZhbHVlID09PSAwICYmIDEgLyB2YWx1ZSA8IDApID8gMSA6IDBcblxuICB2YWx1ZSA9IE1hdGguYWJzKHZhbHVlKVxuXG4gIGlmIChpc05hTih2YWx1ZSkgfHwgdmFsdWUgPT09IEluZmluaXR5KSB7XG4gICAgbSA9IGlzTmFOKHZhbHVlKSA/IDEgOiAwXG4gICAgZSA9IGVNYXhcbiAgfSBlbHNlIHtcbiAgICBlID0gTWF0aC5mbG9vcihNYXRoLmxvZyh2YWx1ZSkgLyBNYXRoLkxOMilcbiAgICBpZiAodmFsdWUgKiAoYyA9IE1hdGgucG93KDIsIC1lKSkgPCAxKSB7XG4gICAgICBlLS1cbiAgICAgIGMgKj0gMlxuICAgIH1cbiAgICBpZiAoZSArIGVCaWFzID49IDEpIHtcbiAgICAgIHZhbHVlICs9IHJ0IC8gY1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWx1ZSArPSBydCAqIE1hdGgucG93KDIsIDEgLSBlQmlhcylcbiAgICB9XG4gICAgaWYgKHZhbHVlICogYyA+PSAyKSB7XG4gICAgICBlKytcbiAgICAgIGMgLz0gMlxuICAgIH1cblxuICAgIGlmIChlICsgZUJpYXMgPj0gZU1heCkge1xuICAgICAgbSA9IDBcbiAgICAgIGUgPSBlTWF4XG4gICAgfSBlbHNlIGlmIChlICsgZUJpYXMgPj0gMSkge1xuICAgICAgbSA9ICh2YWx1ZSAqIGMgLSAxKSAqIE1hdGgucG93KDIsIG1MZW4pXG4gICAgICBlID0gZSArIGVCaWFzXG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSB2YWx1ZSAqIE1hdGgucG93KDIsIGVCaWFzIC0gMSkgKiBNYXRoLnBvdygyLCBtTGVuKVxuICAgICAgZSA9IDBcbiAgICB9XG4gIH1cblxuICBmb3IgKDsgbUxlbiA+PSA4OyBidWZmZXJbb2Zmc2V0ICsgaV0gPSBtICYgMHhmZiwgaSArPSBkLCBtIC89IDI1NiwgbUxlbiAtPSA4KSB7fVxuXG4gIGUgPSAoZSA8PCBtTGVuKSB8IG1cbiAgZUxlbiArPSBtTGVuXG4gIGZvciAoOyBlTGVuID4gMDsgYnVmZmVyW29mZnNldCArIGldID0gZSAmIDB4ZmYsIGkgKz0gZCwgZSAvPSAyNTYsIGVMZW4gLT0gOCkge31cblxuICBidWZmZXJbb2Zmc2V0ICsgaSAtIGRdIHw9IHMgKiAxMjhcbn1cbiIsInZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGFycikge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChhcnIpID09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGdyYXlTcHJpdGU6IGNjLlNwcml0ZSxcblxuICAgICAgICBfY2FyZE5hbWU6IG51bGwsXG4gICAgICAgIF9rcUNhcmRNb2RlOiBudWxsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5ncmF5U3ByaXRlLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIC8vIOmAmui/h+eJjOWQjeiuvue9rueJjFxuICAgIHNldENhcmQ6IGZ1bmN0aW9uIChjYXJkTmFtZSkge1xuICAgICAgdGhpcy5fc2V0Q2FyZE5hbWUoY2FyZE5hbWUpO1xuXG4gICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJykuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNhcmROYW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2FyZE5hbWU7XG4gICAgfSxcblxuICAgIGNhcmRNb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fa3FDYXJkTW9kZTtcbiAgICB9LFxuXG4gICAgX3NldENhcmROYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUpIHtcbiAgICAgIHRoaXMuX2NhcmROYW1lID0gY2FyZE5hbWU7XG4gICAgICB0aGlzLl9rcUNhcmRNb2RlID0gbmV3IEtRQ2FyZChjYXJkTmFtZSk7XG4gICAgfSxcblxuICAgIC8vIOiuvue9rumAieaLqeeKtuaAgVxuICAgIHNldFNlbGVjdGVkOiBmdW5jdGlvbiAoc2VsZWN0ZWQgPSBmYWxzZSkge1xuICAgICAgdGhpcy5ncmF5U3ByaXRlLm5vZGUuYWN0aXZlID0gc2VsZWN0ZWQ7XG4gICAgfSxcblxuICAgIGlzU2VsZWN0ZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmdyYXlTcHJpdGUubm9kZS5hY3RpdmU7XG4gICAgfSxcblxuICAgIF9jYXJkRnVsbE5hbWU6IGZ1bmN0aW9uIChjYXJkU2hvcnROYW1lKSB7XG4gICAgICB2YXIgY2FyZE5hbWUgPSBjYXJkU2hvcnROYW1lO1xuICAgICAgaWYgKCFjYXJkTmFtZS5zdGFydHNXaXRoKFwicHVibGljLXBpYy1jYXJkLXBva2VyXCIpKSB7XG4gICAgICAgIGNhcmROYW1lID0gXCJwdWJsaWMtcGljLWNhcmQtcG9rZXItXCIgKyBjYXJkTmFtZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNhcmROYW1lO1xuICAgIH0sXG5cbiAgICBfbG9hZENhcmRGcmFtZTogZnVuY3Rpb24gKGNhcmROYW1lLCBjYWxsYmFjaykge1xuICAgICAgY2MuYXNzZXJ0KGNhbGxiYWNrKTtcblxuICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJpbWFnZXMvcG9rZXJMaXN0L3BvY2tMaXN0XCIsIGNjLlNwcml0ZUF0bGFzLCBmdW5jdGlvbiAoZXJyLCBhdGxhcykge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY2MuZXJyb3IoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjYXJkTmFtZSA9IHRoaXMuX2NhcmRGdWxsTmFtZShjYXJkTmFtZSk7XG4gICAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcbiAgICAgICAgY2FsbGJhY2soZnJhbWUpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxufSk7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcbmNvbnN0IEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY29uc3QgcGxheSA9IHJlcXVpcmUoJ3BsYXknKTtcbmNvbnN0IEtRQ2FyZFNjb3JldHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRTY29yZXRzSGVscGVyJyk7XG4vLyDniYznsbvlnosgY29tcG9uZW50XG4vL1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcbiAgICBzdGF0aWNzOiB7XG4gICAgICAgIGluc3RhbmNlczogbnVsbCxcbiAgICB9LFxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgY2FyZHNMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgYnRuRHVpWmk6IGNjLkJ1dHRvbixcbiAgICAgICAgYnRuTGlhbmdEdWk6IGNjLkJ1dHRvbixcbiAgICAgICAgYnRuU2FuVGlhbzogY2MuQnV0dG9uLFxuICAgICAgICBidG5TaHVuWmk6IGNjLkJ1dHRvbixcbiAgICAgICAgYnRuVG9uZ0h1YTogY2MuQnV0dG9uLFxuICAgICAgICBidG5IdUx1OiBjYy5CdXR0b24sXG4gICAgICAgIGJ0blRpZVpoaTogY2MuQnV0dG9uLFxuICAgICAgICBidG5Ub25nSHVhU2h1bjogY2MuQnV0dG9uLFxuICAgICAgICBidG5XdVRvbmc6IGNjLkJ1dHRvbixcbiAgICAgICAgdHlwZUJ1dHRvbnNOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBidG5EZWxldGVUb3VEYW86IGNjLkJ1dHRvbiwgICAvLyDlpLTpgZNcbiAgICAgICAgYnRuRGVsZXRlWmhvbmdEYW86IGNjLkJ1dHRvbiwgLy8g5Lit6YGTXG4gICAgICAgIGJ0bkRlbGV0ZVdlaURhbzogY2MuQnV0dG9uLCAgIC8vIOWwvumBk1xuICAgICAgICBidG5DYW5jZWxBbGw6IGNjLkJ1dHRvbiwgICAgICAvLyDlhajpg6jlj5bmtohcbiAgICAgICAgYnRuRG9uZTogY2MuQnV0dG9uLCAgICAgICAgICAgLy8g56Gu5a6a5Ye654mMXG4gICAgICAgIHRpbWVOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBsYWJlbFRpbWU6IGNjLkxhYmVsLFxuICAgICAgICBsYXlvdXRUb3VEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0WmhvbmdEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0V2VpRGFvOiBjYy5MYXlvdXQsXG5cbiAgICAgICAgY2FyZFByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBjYXJkVHlwZVByZWZhYjogY2MuUHJlZmFiLFxuICAgICAgICBnb25nWGlOaTpjYy5Ob2RlLFxuICAgICAgICB0ZVNodVBhaTpjYy5Ob2RlLFxuICAgICAgICAvKiMjIyMjKi9cbiAgICAgICAgd3VUb25nX2ltZzpjYy5TcHJpdGVGcmFtZSxcbiAgICAgICAgdG9uZ0h1YVNodW5faW1nOmNjLlNwcml0ZUZyYW1lLFxuICAgICAgICBCdG5DbGlja0dvbmdYaU5pQ29tZmlybTpmYWxzZSwgIC8v55So5LqO5qOA5p+l55So5oi35piv5ZCm54K55Ye75LqG5oGt5Zac5L2g6aG16Z2i55qE56Gu5a6a5oyJ6ZKuXG4gICAgICAgIGNhcmRzTGF5b3V0U29ydENvbG9yOiBmYWxzZSxcbiAgICAgICAgLyojIyMjIyovXG5cbiAgICAgICAgX2NhcmRPZmZzZXRZOiBudWxsLFxuXG4gICAgICAgIF9rcUNhcmRNb2RlczogW10sXG4gICAgICAgIF9hbGxDYXJkTW9kZXM6IFtdLFxuICAgICAgICBfZmluZENhcmRUeXBlT2JqZWN0OiBudWxsLCAgLy8g55So5p2l6K6w5b2V5om+5Yiw55qE54mM5Z6L5a+56LGhXG5cbiAgICAgICAgX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2s6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY2FyZE9mZnNldFkgPSAwO1xuICAgICAgICB0aGlzLl9yZWdpc3RlclRvdWNoRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRGFvc0xheW91dENsaWNrRXZlbnQoKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj54K55Ye756m655m95Zyw5pa55bCG54mM5pS25Zue5Y67Ki9cbiAgICBvbkNsaWNrQ2FyZFR5cGVDb21iaW5lTm9kZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XG4gICAgfSxcblxuICAgIF9oaWRlRGVsZXRlQnV0dG9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmJ0bkRlbGV0ZVRvdURhby5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJ0bkRlbGV0ZVpob25nRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnRuRGVsZXRlV2VpRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIC8vIOmHjee9ru+8jOWbnuWIsOacgOWIneWni+acieeKtuaAgVxuICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2hpZGVEZWxldGVCdXR0b25zKCk7XG4gICAgICAgIHRoaXMuY2xlYXJDYXJkcygpO1xuICAgICAgICB0aGlzLnRpbWVTdG9wKCk7XG4gICAgICAgIHRoaXMuX3R5cGVCdXR0b25zKCkuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgICAgICBidXR0b24uaW50ZXJhY3RhYmxlID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMgPSBbXTtcbiAgICB9LFxuXG4gICAgY2FyZHNMYXlvdXRTb3J0OiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBjYy5sb2coY2MubWFQYWkpO1xuICAgICAgICB2YXIgbm9kZUF5eSA9IGUudGFyZ2V0LmNoaWxkcmVuO1xuICAgICAgICBpZihub2RlQXl5WzBdLmFjdGl2ZSA9PSB0cnVlKXsvL+aMieWkp+Wwj1xuICAgICAgICAgICAgdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9IHRydWU7XG4gICAgICAgICAgICBub2RlQXl5WzBdLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgbm9kZUF5eVsxXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYobm9kZUF5eVsxXS5hY3RpdmUgPT0gdHJ1ZSl7Ly/mjInoirHoibJcbiAgICAgICAgICAgIHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIG5vZGVBeXlbMF0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIG5vZGVBeXlbMV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0U29ydENvbG9yID0gbm9kZUF5eVsxXS5hY3RpdmUgPT0gZmFsc2U7XG4gICAgICAgIC8vdGhpcy5jYXJkc0xheW91dFNvcnRDb2xvciA9PSB0cnVlXG4gICAgfSxcblxuICAgIGFkZENhcmRzOiBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XG4gICAgICAgIGNjLmFzc2VydChjYXJkTmFtZXMpO1xuICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25ZKCk7XG4gICAgICAgIC8vY2FyZE5hbWVzLnNvcnQoZnVuY3Rpb24oYTEsYTIpe1xuICAgICAgICAvLyAgICByZXR1cm4gYTEuc3BsaXQoJ18nKVswXSAtIGEyLnNwbGl0KCdfJylbMF07XG4gICAgICAgIC8vfSlcbiAgICAgICAgY2FyZE5hbWVzLmZvckVhY2goZnVuY3Rpb24oY2FyZCxpbmRleCl7XG4gICAgICAgICAgICB0aGlzLmFkZENhcmQoY2FyZCxmYWxzZSxpbmRleClcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy90aGlzLmNhcmRzTGF5b3V0U29ydCgpO1xuICAgICAgICB0aGlzLl9yZXNldENhcmRzUG9zaXRpb25YKCk7XG4gICAgICAgIHRoaXMuX3JlbG9hZEtRQ2FyZE1vZGVzSW5uZXIoKTtcbiAgICAgICAgdGhpcy5fcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHModGhpcy5fa3FDYXJkTW9kZXMpO1xuICAgIH0sXG5cbiAgICBhZGRDYXJkOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGF1dG9DaGFuZ2VQb3NpdGlvblggPSBmYWxzZSxpbmRleCA9IG51bGwpIHtcbiAgICAgICAgY2MuYXNzZXJ0KGNhcmROYW1lLmxlbmd0aCA+IDApO1xuXG4gICAgICAgIGxldCBjYXJkUHJlZmFiID0gY2MuaW5zdGFudGlhdGUodGhpcy5jYXJkUHJlZmFiKTtcbiAgICAgICAgY2FyZFByZWZhYi5uYW1lID0gY2FyZE5hbWU7XG4gICAgICAgIGlmKGNjLm1hUGFpKXtcbiAgICAgICAgICAgIHZhciBjYXJkTWFQYWkgPSAnM18nICsgY2MubWFQYWk7XG4gICAgICAgICAgICBpZihjYXJkTmFtZSA9PSBjYXJkTWFQYWkpe1xuICAgICAgICAgICAgICAgIGNhcmRQcmVmYWIuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjI2LCAxNDUsIDE0NSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2FyZFByZWZhYi5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKS5zZXRDYXJkKGNhcmROYW1lLGluZGV4KTtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLmFkZENoaWxkKGNhcmRQcmVmYWIpO1xuICAgICAgICBjYXJkUHJlZmFiLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XG5cbiAgICAgICAgaWYgKGF1dG9DaGFuZ2VQb3NpdGlvblgpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblgoKTtcbiAgICAgICAgfVxuICAgICAgICAvL2xldCBuZXdDYXJkID0gbmV3IEtRQ2FyZChjYXJkTmFtZSxudWxsLGluZGV4KTtcbiAgICAgICAgLy9sZXQgb3JpZ2luQ2FyZCA9IHRoaXMuX2FsbENhcmRNb2Rlcy5maW5kKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgLy8gICAgcmV0dXJuIGNhcmQuaXNFcXVhbChuZXdDYXJkKTtcbiAgICAgICAgLy99KTtcbiAgICAgICAgLy9pZiAob3JpZ2luQ2FyZCA9PSBudWxsICYmICFhdXRvQ2hhbmdlUG9zaXRpb25YKSB7XG4gICAgICAgIC8vICAgIHRoaXMuX2FsbENhcmRNb2Rlcy5wdXNoKG5ld0NhcmQpO1xuICAgICAgICAvL31cbiAgICB9LFxuXG4gICAgYWRkQ2FyZE1vZGVzOiBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XG4gICAgICAgIGNjLmFzc2VydChjYXJkTmFtZXMubGVuZ3RoID4gMCk7XG4gICAgICAgIHRoaXMuX2FsbENhcmRNb2RlcyA9IFtdO1xuICAgICAgICBjYXJkTmFtZXMuZm9yRWFjaChmdW5jdGlvbihjYXJkTmFtZSxpbmRleCl7XG4gICAgICAgICAgICBsZXQgbmV3Q2FyZCA9IG5ldyBLUUNhcmQoY2FyZE5hbWUsbnVsbCxpbmRleCk7XG4gICAgICAgICAgICB0aGlzLl9hbGxDYXJkTW9kZXMucHVzaChuZXdDYXJkKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgcmVsb2FkQ2FyZHM6IGZ1bmN0aW9uIChjYXJkTmFtZXMpIHtcbiAgICAgICAgLy9jYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMTEnLCAnMV8xMicsICcyXzInLCAnM18yJywgJzRfMTEnLCAnNF8xMicsICczXzEzJywgJzJfNScsICcxXzEzJywgJzRfMycsICcxXzMnXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMV8xJywgJzJfMScsICczXzExJywgJzFfMTInLCAnMl8yJywgJzNfMicsICc0XzExJywgJzRfMTInLCAnM18xMycsICcyXzUnLCAnMV8xMycsICc0XzMnLCAnMV8zJ107XG4gICAgICAgIC8v5LiJ5bqm5ZCM6IqxXG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzJfMTMnLCAnMl81JywgJzJfNycsICczXzEnLCAnM18yJywgJzNfNCcsICczXzMnLCAnM18xMycsICcxXzEyJywgJzFfNicsICcxXzEnLCAnMV80JywgJzFfNSddO1xuICAgICAgICAvL+S4ieWQjOiKsemhulxuICAgICAgICAvLyAgY2FyZE5hbWVzPVsnMl8xJywgJzJfMicsICcyXzMnLCAnMl80JywgJzJfNScsICczXzYnLCAnM183JywgJzNfOCcsICczXzknLCAnM18xMCcsICc0XzEnLCAnNF8yJywgJzRfMyddO1xuICAgICAgICAvL+S4gOadoem+mVxuICAgICAgICAvLyBjYXJkTmFtZXM9WycyXzEnLCAnMl8yJywgJzJfMycsICcyXzQnLCAnMl81JywgJzNfNicsICczXzcnLCAnM184JywgJzNfOScsICczXzEwJywgJzFfMTEnLCAnMV8xMicsICcxXzEzJ107XG4gICAgICAgIC8v5LiJ6aG65a2QXG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8xJywgJzNfMicsICc0XzMnLCAnMV83JywgJzRfNScsICc0XzYnLCAnM185JywgJzRfOCcsICczXzEnLCAnMV8xMycsICc0XzEyJywgJzRfMTEnLCAnMl8xMCddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9WyczXzUnLCAnM180JywgJzRfMycsICcxXzInLCAnM18xJywgJzRfOScsICczXzknLCAnNF84JywgJzNfMTAnLCAnMV8xMycsICc0XzEyJywgJzRfMTEnLCAnMl8xMCddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9WyczXzUnLCAnM180JywgJzRfMycsICcxXzInLCAnM18xJywgJzRfNScsICczXzYnLCAnNF84JywgJzNfNicsICcxXzEzJywgJzRfMTInLCAnNF8xMScsICcyXzcnXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9WyczXzQnLCAnM180JywgJzRfNicsICcyXzIwJywgJzFfMjAnLCAnMV8yMCcsICczXzYnLCAnNF84JywgJzNfNicsICcxXzgnLCAnNF8xMicsICc0XzExJywgJzJfMjAnXTtcbiAgICAgICAgLy/kuInkuLDlpKnkuItcbiAgICAgICAgLy9jYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMScsICcxXzInLCAnMl8yJywgJzNfMicsICc0XzEnLCAnNF8yJywgJzNfMycsICcyXzMnLCAnMV8zJywgJzRfMycsICcxXzEzJ107XG4gICAgICAgIC8vNOS4sOWkqeS4i1xuICAgICAgICAvLyBjYXJkTmFtZXM9WycxXzEnLCAnMl8xJywgJzNfMScsICcxXzQnLCAnMl80JywgJzNfMicsICc0XzInLCAnMV8yJywgJzNfNCcsICcyXzMnLCAnMV8zJywgJzRfMycsICcxXzInXTtcbiAgICAgICAgLy/lha3lsoHljYpcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnMV8xJywgJzJfMScsICczXzExJywgJzFfMTInLCAnMl8yJywgJzNfMicsICc0XzExJywgJzRfMTInLCAnM18xMycsICcyXzUnLCAnMV8xMycsICc0XzMnLCAnMV8zJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnMV85JywgJzJfMTEnLCAnM184JywgJzFfMTInLCAnMl8yJywgJzNfMicsICcxXzEzJywgJzJfNScsICczXzUnLCcxXzQnLCAnMl80JywgJzNfNCcsICczXzEwJ107XG4gICAgICAgIC8vIGNhcmROYW1lcz1bJzRfOScsICcyXzMnLCAnM180JywgJzNfNicsICcyXzEnLCAnMl80JywgJzJfMicsICcyXzUnLCAnMl8xMycsJzJfOCcsICcyXzEwJywgJzJfMTEnLCAnMl8xMiddO1xuICAgICAgICAvLyAgIGNhcmROYW1lcz1bJzRfMicsICcyXzMnLCAnM180JywgJzNfNScsICcyXzEnLCAnMl80JywgJzJfMicsICcyXzUnLCAnMl8xMycsJzJfOCcsICcyXzEwJywgJzJfMTEnLCAnMl8xMiddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMScsICcyXzEnLCAnMV80JywgJzNfNCcsICcxXzYnLCAnMl82JywgJzFfOCcsICczXzgnLCAnMl84JywnMl8xMicsICcxXzEyJywgJzJfMTMnLCAnM18xMyddO1xuICAgICAgICAvLyBjYXJkTmFtZXM9Wyc0XzknLCAnMl8zJywgJzNfNCcsICczXzYnLCAnMl84JywgJzJfOScsICcyXzEwJywgJzJfMTEnLCAnMl8xMycsJzNfMTMnLCAnM18xMicsICcyXzEyJywgJzFfMTInXTtcbiAgICAgICAgLy8gY2FyZE5hbWVzPVsnNF85JywgJzJfOScsICczXzQnLCAnM182JywgJzFfOCcsICcyXzEnLCAnMl81JywgJzJfNCcsICcyXzMnLCczXzEzJywgJzNfMTInLCAnMl8yJywgJzFfMTInXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9WyczXzInLCAnNF8yJywgJzJfNCcsICczXzUnLCAnMV81JywgJzNfNycsICcyXzcnLCAnM18xMCcsICcyXzEnLCcyXzEzJywgJzJfMTAnLCAnMl8xMicsICcyXzExJ107XG4gICAgICAgIC8vY2FyZE5hbWVzPVsnNF8yJywgJzRfMycsICc0XzQnLCAnNF81JywgJzRfNScsICc0XzYnLCAnNF8xMicsICc0XzEzJywgJzJfMTInLCczXzEyJywgJzJfOCcsICczXzgnLCAnMl8xMSddO1xuICAgICAgICAvL2NhcmROYW1lcz1bJzRfMycsICcxXzMnLCAnNF81JywgJzRfNScsICczXzUnLCAnMl81JywgJzFfMjAnLCAnNF8xMScsICczXzEyJywnNF8xMicsICc0XzgnLCAnNF8xJywgJzFfMTInXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzMnLCAnMV8zJywgJzRfNScsICc0XzUnLCAnMl8yMCcsICcxXzIwJywgJzFfMjAnLCAnNF8xMScsICczXzEyJywnNF8xMicsICc0XzgnLCAnNF8xJywgJzFfMTInXTtcbiAgICAgICAgLy9jYXJkTmFtZXM9Wyc0XzEwJywgJzRfMTEnLCAnNF8xMycsICc0XzUnLCAnMl8yMCcsICcxXzIwJywgJzFfMjAnLCAnNF8xMicsICczXzEyJywnNF8xMicsICc0XzgnLCAnMl8xMicsICcxXzEyJ107XG4gICAgICAgIHRoaXMuY2xlYXJDYXJkcygpO1xuICAgICAgICB0aGlzLl9rcUNhcmRNb2RlcyA9IFtdO1xuICAgICAgICB0aGlzLmFkZENhcmRzKGNhcmROYW1lcyk7XG4gICAgfSxcblxuICAgIGNsZWFyQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMubGF5b3V0VG91RGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLnJlbW92ZUFsbENoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMubGF5b3V0V2VpRGFvLm5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICB9LFxuXG4gICAgcmVtb3ZlQ2FyZDogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICAgIGlmICghY2FyZE5hbWUubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuZ2V0Q2hpbGRCeU5hbWUoY2FyZE5hbWUpLnJlbW92ZUZyb21QYXJlbnQoKTtcbiAgICB9LFxuXG4gICAgc2V0RmluaXNoU2VsZWN0Q2FyZHNDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBfcmVsb2FkS1FDYXJkTW9kZXNJbm5lcjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9rcUNhcmRNb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNhcmRQcmVmYWJOb2RlKSB7XG4gICAgICAgICAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmRQcmVmYWJOb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgcmV0dXJuIGNhcmRQcmVmYWIuY2FyZE1vZGUoKTtcbiAgICAgICAgfSkuc29ydChLUUNhcmQuc29ydCk7XG4gICAgICAgIHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdCA9IG51bGw7XG4gICAgfSxcblxuICAgIF90eXBlQnV0dG9uczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgdGhpcy5idG5EdWlaaSxcbiAgICAgICAgICAgIHRoaXMuYnRuTGlhbmdEdWksXG4gICAgICAgICAgICB0aGlzLmJ0blNhblRpYW8sXG4gICAgICAgICAgICB0aGlzLmJ0blNodW5aaSxcbiAgICAgICAgICAgIHRoaXMuYnRuVG9uZ0h1YSxcbiAgICAgICAgICAgIHRoaXMuYnRuSHVMdSxcbiAgICAgICAgICAgIHRoaXMuYnRuVGllWmhpLFxuICAgICAgICAgICAgdGhpcy5idG5Ub25nSHVhU2h1bixcbiAgICAgICAgICAgIC8qIyMjIyMqL1xuICAgICAgICAgICAgLy90aGlzLmJ0bld1VG9uZyxcbiAgICAgICAgICAgIC8qIyMjIyMqL1xuICAgICAgICBdO1xuICAgIH0sXG5cbiAgICBfcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHM6IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgICAgICAgLypjYXJkTW9kZXMubGVuZ3RoID09IDEzKi9cbiAgICAgICAgY2FyZE1vZGVzID0gY2FyZE1vZGVzIHx8IHRoaXMuX2txQ2FyZE1vZGVzO1xuXG4gICAgICAgIC8qIyMjIyPliJ3lp4vljJbniYwqL1xuICAgICAgICB2YXIgQnV0dG9uc0xheW91dENoaWxkcyA9IHRoaXMudHlwZUJ1dHRvbnNOb2RlLmNoaWxkcmVuO1xuICAgICAgICBmb3IodmFyIGk9MDtpPEJ1dHRvbnNMYXlvdXRDaGlsZHMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICBCdXR0b25zTGF5b3V0Q2hpbGRzW2ldLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5idG5EdWlaaS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbkR1aVppKGNhcmRNb2Rlcyk7XG4gICAgICAgIHRoaXMuYnRuTGlhbmdEdWkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZE1vZGVzKTtcbiAgICAgICAgdGhpcy5idG5TYW5UaWFvLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkTW9kZXMpO1xuICAgICAgICB0aGlzLmJ0blNodW5aaS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblNodW5aaShjYXJkTW9kZXMpO1xuICAgICAgICB0aGlzLmJ0blRvbmdIdWEuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5Ub25nSHVhKGNhcmRNb2Rlcyk7XG4gICAgICAgIHRoaXMuYnRuSHVMdS5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpbkh1THUoY2FyZE1vZGVzKTtcbiAgICAgICAgdGhpcy5idG5UaWVaaGkuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZE1vZGVzKTtcbiAgICAgICAgdGhpcy5idG5Ub25nSHVhU2h1bi5pbnRlcmFjdGFibGUgPSBLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vdGhpcy5idG5XdVRvbmcuaW50ZXJhY3RhYmxlID0gS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZE1vZGVzKTtcbiAgICAgICAgLy9LUUNhcmQuaXNUZVNodVBhaShjYXJkTW9kZXMpXG4gICAgICAgIC8vbGV0IHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoY2FyZE1vZGVzKTtcbiAgICAgICAgLy9LUUNhcmQuaXNMaXVEdWlCYW4oY2FyZE1vZGVzKTtcbiAgICAgICAgLy9jYy5sb2codHlwZU5hbWUpOyBjYy5sb2coJ+eJueauiueJjG5hbWUnKTtcbiAgICAgICAgLy9hbGVydCh0aGlzLmJ0blNodW5aaS5pbnRlcmFjdGFibGUpXG4gICAgICAgIC8qIyMjIyPlpoLmnpzmnInlpJrkuIDoibLvvIzlsLHmmK/orr7nva7ml6DlkIzmjInpkq7nmoTlj6/kuqTkupLmgKcqL1xuICAgICAgICAvL2lmKGNjLmR1b1lpU2UgPT0gMCkge1xuICAgICAgICAvLyAgICB0aGlzLnd1VG9uZ05vZGUgPSB0aGlzLnR5cGVCdXR0b25zTm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bld1VG9uZ1wiKTtcbiAgICAgICAgLy8gICAgdGhpcy5idG5XdVRvbmcgPSB0aGlzLnd1VG9uZ05vZGUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XG4gICAgICAgIC8vICAgIHRoaXMuYnRuV3VUb25nLmludGVyYWN0YWJsZSA9IEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRNb2Rlcyk7XG4gICAgICAgIC8vfVxuICAgICAgICAvKiMjIyMjKi9cblxuICAgICAgICB0aGlzLl9hdXRvQWN0aXZlVHlwZUJ1dHRvbnMoKTtcblxuICAgICAgICAvKiMjIyMj6K6+572u5oyJ6ZKu5Y+v5Lqk5LqS5ZKM5LiN5Y+v5Lqk5LqS5pe255qE6YCP5piO5bqmKi9cbiAgICAgICAgZm9yKHZhciBpPTA7aTxCdXR0b25zTGF5b3V0Q2hpbGRzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYoQnV0dG9uc0xheW91dENoaWxkc1tpXS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUpe1xuICAgICAgICAgICAgICAgIEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0ub3BhY2l0eSA9IDI1NTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIEJ1dHRvbnNMYXlvdXRDaGlsZHNbaV0ub3BhY2l0eSA9IDEyNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDlsIbmib7liLDkuobniYznsbvlnovnmoTniYznqoHlh7rlh7rmnaVcbiAgICBfc3RpY2tPdXRGaW5kQ2FyZFR5cGU6IGZ1bmN0aW9uICh0aXRsZSwgZmluZE1ldGhvZHMpIHtcblxuICAgICAgICAvLyDlhYjmoLnmja7niYznsbvlnovmib7lh7rmiYDmnInnmoTntKLlvJXpm4blkIhcbiAgICAgICAgdmFyIGZpbmRlZEluZGV4c0FycmF5ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0ID0gdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0IHx8IHt9O1xuICAgICAgICBpZiAodGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LnRpdGxlICE9IHRpdGxlKSB7XG4gICAgICAgICAgICBmaW5kZWRJbmRleHNBcnJheSA9IChmaW5kTWV0aG9kcygpIHx8IFtdKS5yZXZlcnNlKCk7XG5cbiAgICAgICAgICAgIGZvcih2YXIgaSA9MDtpPGZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aC0xO2krKyl7Ly/liKDpmaTlkIznsbvlnovniYxcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBmaW5kZWRJbmRleHNBcnJheVtpXTtcbiAgICAgICAgICAgICAgICAvKmlmKHRpdGxlID09ICdsaWFuZ0R1aScpe1xuICAgICAgICAgICAgICAgICBsZXQgalN0cmluZ3Nwb2ludCA9IGluZGV4Lm1hcChmdW5jdGlvbihpbmRleHMpe1xuICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fa3FDYXJkTW9kZXNbaW5kZXhzXS5wb2ludDtcbiAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgdmFyIGlzQnJlYWsgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgdmFyIHJlcE51bSA9IGpTdHJpbmdzcG9pbnQucmVkdWNlKGZ1bmN0aW9uKHAsbil7XG4gICAgICAgICAgICAgICAgIGlmKCFwW25dKXtcbiAgICAgICAgICAgICAgICAgcFtuXSA9IDE7XG4gICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICBwW25dICs9IDFcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICByZXR1cm4gcFxuICAgICAgICAgICAgICAgICB9LHt9KTtcbiAgICAgICAgICAgICAgICAgZm9yKHZhciB5IGluIHJlcE51bSl7XG4gICAgICAgICAgICAgICAgIGlmKHJlcE51bVt5XSA+PSAzKXtcbiAgICAgICAgICAgICAgICAgaXNCcmVhayA9IHRydWU7XG4gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICBpZihpc0JyZWFrKXtcbiAgICAgICAgICAgICAgICAgY2MubG9nKHJlcE51bSlcbiAgICAgICAgICAgICAgICAgY2MubG9nKGZpbmRlZEluZGV4c0FycmF5KVxuICAgICAgICAgICAgICAgICBjYy5sb2coaSlcbiAgICAgICAgICAgICAgICAgY2MubG9nKCctLS0tLS0tLTI5MScpXG4gICAgICAgICAgICAgICAgIGZpbmRlZEluZGV4c0FycmF5LnNwbGljZShpLDEpO1xuICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICB9Ki9cbiAgICAgICAgICAgICAgICB2YXIgaVN0cmluZyA9ICcnO1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaiA9aSsxO2o8ZmluZGVkSW5kZXhzQXJyYXkubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gZmluZGVkSW5kZXhzQXJyYXlbal07XG4gICAgICAgICAgICAgICAgICAgIHZhciBqU3RyaW5nID0gJyc7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGlTdHJpbmdzID0gcy5tYXAoZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZWwuY2FyZE5hbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgalN0cmluZ3MgPSBpbmRleC5tYXAoZnVuY3Rpb24oaW5kZXhzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjYXJkTW9kZWwgPSB0aGlzLl9rcUNhcmRNb2Rlc1tpbmRleHNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhcmRNb2RlbC5jYXJkTmFtZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciByID0gMDtyIDwgaW5kZXgubGVuZ3RoO3IrKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBqU3RyaW5nID0galN0cmluZyArIGlTdHJpbmdzW3JdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaVN0cmluZyA9IGlTdHJpbmcgKyBqU3RyaW5nc1tyXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmKGpTdHJpbmcgPT0gaVN0cmluZyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5kZWRJbmRleHNBcnJheS5zcGxpY2UoaSwxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9maW5kQ2FyZFR5cGVPYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICAgICAgICAgIGluZGV4c0FycmF5OiBmaW5kZWRJbmRleHNBcnJheSxcbiAgICAgICAgICAgICAgICAvL2luZGV4OiB0aXRsZT09XCJkdWlaaVwiP2ZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aC0xOjBcbiAgICAgICAgICAgICAgICBpbmRleDogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZpbmRlZEluZGV4c0FycmF5ID0gdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LmluZGV4c0FycmF5O1xuICAgICAgICBpZiAoIWZpbmRlZEluZGV4c0FycmF5IHx8IGZpbmRlZEluZGV4c0FycmF5Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8g5bCG5bey5pyJ55qE56qB5Ye655qE54mM55qE5L2N572u6YeN572u5Zue5Yid5aeL5L2N572uXG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcblxuICAgICAgICAvLyDorqHnrpflh7ropoHnqoHlh7rnmoTniYzmlbDnu4RcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fZmluZENhcmRUeXBlT2JqZWN0LmluZGV4O1xuICAgICAgICBsZXQgaW5kZXhzID0gZmluZGVkSW5kZXhzQXJyYXlbaW5kZXhdO1xuXG4gICAgICAgIGxldCBzZWxlY3RlZENhcmROYW1lcyA9IGluZGV4cy5tYXAoZnVuY3Rpb24oaW5kZXgpe1xuICAgICAgICAgICAgbGV0IGNhcmRNb2RlbCA9IHRoaXMuX2txQ2FyZE1vZGVzW2luZGV4XTtcbiAgICAgICAgICAgIHJldHVybiBjYXJkTW9kZWwuY2FyZE5hbWUoKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgICAvL2NjLmxvZyhzZWxlY3RlZENhcmROYW1lcylcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgICAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmROb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgaWYoc2VsZWN0ZWRDYXJkTmFtZXMuaW5jbHVkZXMoY2FyZFByZWZhYi5jYXJkTmFtZSgpKSkge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lSW5kZXggPSBzZWxlY3RlZENhcmROYW1lcy5pbmRleE9mKGNhcmRQcmVmYWIuY2FyZE5hbWUoKSk7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRDYXJkTmFtZXMuc3BsaWNlKG5hbWVJbmRleCwxKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vY2MubG9nKGNhcmROb2RlcylcbiAgICAgICAgLy9jYy5sb2coaW5kZXgpXG4gICAgICAgIC8vY2MubG9nKGZpbmRlZEluZGV4c0FycmF5KVxuICAgICAgICAvL2NjLmxvZygnLS0tLS0tLS0tLTI0OCcpXG4gICAgICAgIC8vIOeqgeWHuuiuoeeul+WHuuadpeeahOeJjOaVsOe7hFxuICAgICAgICB0aGlzLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgLy8g5L+d5a2Y5aW977yM55So5LqO5YaN5qyh54K55Ye75LqG56qB5Ye65LiL5LiA57uE54mMXG4gICAgICAgIGluZGV4ID0gKGluZGV4ICsgMSkgJSBmaW5kZWRJbmRleHNBcnJheS5sZW5ndGg7XG4gICAgICAgIHRoaXMuX2ZpbmRDYXJkVHlwZU9iamVjdC5pbmRleCA9IGluZGV4O1xuICAgIH0sXG5cbiAgICBjbGlja0R1aVppOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwiZHVpWmlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kRHVpWmkodGhpcy5fa3FDYXJkTW9kZXMpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBjbGlja0xpYW5nRHVpOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwibGlhbmdEdWlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kTGlhRHVpKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTYW5UaWFvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwic2FuVGlhb1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRTYW5UaWFvKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTaHVuWmk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJzaHVuWmlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kU2h1blppKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tUb25nSHVhOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwidG9uZ0h1YVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tIdUx1OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N0aWNrT3V0RmluZENhcmRUeXBlKFwiaHVMdVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmZpbmRIdUx1KHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tUaWVaaGk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ0aWVaaGlcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kVGllWmhpKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgLyojIyMjIyovXG4gICAgY2xpY2tXdVRvbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcIueCueWHu+S6huS6lOWQjOaMiemSrlwiKTtcbiAgICAgICAgdGhpcy5fc3RpY2tPdXRGaW5kQ2FyZFR5cGUoXCJ3dVRvbmdcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5maW5kV3VUb25nKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuICAgIC8qIyMjIyMqL1xuXG4gICAgY2xpY2tUb25nSHVhU2h1bjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9zdGlja091dEZpbmRDYXJkVHlwZShcInRvbmdIdWFTaHVuXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuZmluZFRvbmdIdWFTaHVuKHRoaXMuX2txQ2FyZE1vZGVzKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgY2xpY2tDYW5jZWxBbGw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVRvdURhbygpO1xuICAgICAgICB0aGlzLmNsaWNrRGVsZXRlWmhvbmdEYW8oKTtcbiAgICAgICAgdGhpcy5jbGlja0RlbGV0ZVdlaURhbygpO1xuICAgIH0sXG5cbiAgICAvKueCueWHu+WujOaIkOaMiemSriovXG4gICAgY2xpY2tEb25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB0b3VDYXJkTW9kZWxzID0gdGhpcy5fdGFvRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIGxldCB6aG9uZ0NhcmRNb2RlcyA9IHRoaXMuX3pob25nRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIGxldCB3ZWlDYXJkTW9kZXMgPSB0aGlzLl93ZWlEYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgdGhpcy5fZGlkU2VsZWN0ZWRDYXJkcyh0b3VDYXJkTW9kZWxzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzKTtcbiAgICB9LFxuXG4gICAgLyrngrnlh7vmga3llpzkvaDpobXpnaLnmoTnoa7lrprmjInpkq4qL1xuICAgIG9uQnRuR29uZ1hpTmlDb21maXJtQ2xpY2s6ZnVuY3Rpb24gKCkge1xuICAgICAgICAvL+iusOW9leeOqeWutueCueWHu+S6huehruWumuaMiemSru+8mlxuICAgICAgICB0aGlzLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtID0gdHJ1ZTtcbiAgICAgICAgLy/lhYjopoHlvpfliLDnjqnlrrbnmoQxM+W8oOeJjCB0ZVNodVBhaUNhcmRzW3snbnVtYmVyJzoxLCdzdWl0Jzoncyd9LHsuLi59LHsuLi59XVxuICAgICAgICB2YXIgdGVTaHVQYWlDYXJkcyA9IGNjLnRlU2h1UGFpQ2FyZHM7XG4gICAgICAgIGNvbnNvbGUubG9nKHRlU2h1UGFpQ2FyZHMpO1xuICAgICAgICB2YXIgdGVTaHVQYWlDYXJkc1NlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsMih0ZVNodVBhaUNhcmRzKTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFt0ZVNodVBhaUNhcmRzU2VydmVySW5mb107XG4gICAgICAgIGNvbnNvbGUubG9nKFwi54K55Ye75LqG5oGt5Zac5L2g6aG16Z2i55qE56Gu5a6a5oyJ6ZKuXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyh0ZVNodVBhaUNhcmRzU2VydmVySW5mbyk7XG4gICAgICAgIGlmICh0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9maW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX2RpZFNlbGVjdGVkQ2FyZHM6IGZ1bmN0aW9uICh0b3VDYXJkcywgemhvbmdDYXJkcywgd2VpQ2FyZHMpIHtcbiAgICAgICAgdG91Q2FyZHMgPSB0b3VDYXJkcyB8fCBbXTtcbiAgICAgICAgemhvbmdDYXJkcyA9IHpob25nQ2FyZHMgfHwgW107XG4gICAgICAgIHdlaUNhcmRzID0gd2VpQ2FyZHMgfHwgW107XG4gICAgICAgIGxldCB0b3VTZXJ2ZXJJbmZvID0gdGhpcy5fY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbCh0b3VDYXJkcyk7XG4gICAgICAgIGxldCB6aG9uZ1NlcnZlckluZm8gPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsKHpob25nQ2FyZHMpO1xuICAgICAgICBsZXQgd2VpU2VydmVySW5mbyA9IHRoaXMuX2NvbnZlcnRDYXJkc1RvU2VydmVyTW9kZWwod2VpQ2FyZHMpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gW3RvdVNlcnZlckluZm8sIHpob25nU2VydmVySW5mbywgd2VpU2VydmVySW5mb107XG5cbiAgICAgICAgaWYgKHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpbmlzaFNlbGVjdENhcmRzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjbGlja0RlbGV0ZVRvdURhbzogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkc09mTGF5b3V0KHRoaXMubGF5b3V0VG91RGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBjbGlja0RlbGV0ZVpob25nRGFvOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGV0ZURhb0NhcmRzT2ZMYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgY2xpY2tEZWxldGVXZWlEYW86IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlRGFvQ2FyZHNPZkxheW91dCh0aGlzLmxheW91dFdlaURhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgLy8g6K6h5pe25Zmo5LqL5Lu2XG4gICAgdGltZVN0YXJ0OiBmdW5jdGlvbiAoZHVyYXRpb24pIHtcbiAgICAgICAgY2MuYXNzZXJ0KGR1cmF0aW9uID4gMCk7XG4gICAgICAgIHRoaXMudGltZVN0b3AoKTtcbiAgICAgICAgdGhpcy50aW1lTm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuX3RpbWVSZW1haW5EdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBTdHJpbmcoZHVyYXRpb24pO1xuICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuX3RpbWVNZXRob2QsIDEsIGR1cmF0aW9uKTtcbiAgICB9LFxuXG4gICAgdGltZVN0b3A6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuX3RpbWVNZXRob2QpO1xuICAgICAgICB0aGlzLnRpbWVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBfdGltZU1ldGhvZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gPSB0aGlzLl90aW1lUmVtYWluRHVyYXRpb24gLSAxO1xuXG4gICAgICAgIHZhciByZW1haW4gPSBNYXRoLm1heCh0aGlzLl90aW1lUmVtYWluRHVyYXRpb24sIDApO1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSAocmVtYWluIDwgMTAgJiYgcmVtYWluID4gMCkgPyAoJzAnICsgcmVtYWluKSA6IHJlbWFpbjtcblxuICAgICAgICBpZiAodGhpcy5fdGltZVJlbWFpbkR1cmF0aW9uIDw9IDApIHtcbiAgICAgICAgICAgIHRoaXMudGltZVN0b3AoKTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRBdXRvU2VsZWN0Q2FyZHMoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDotoXml7blkI7vvIzoh6rliqjpgInniYxcbiAgICBfdGltZU91dEF1dG9TZWxlY3RDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICog6ZqQ6JeP5oGt5Zac5L2gXG4gICAgICAgICAqL1xuICAgICAgICBwbGF5LmdvbmdYaU5pU2hvdyhmYWxzZSk7XG4gICAgICAgIGlmICh0eXBlb2YoY2MudGVTaHVQYWlDYXJkcykgIT0gXCJ1bmRlZmluZWRcIiAmJiBjYy50ZVNodVBhaUNhcmRzICE9IG51bGwgJiYgY2MudGVTaHVQYWlDYXJkcyAhPSAnJykge1xuICAgICAgICAgICAgdGhpcy5vbkJ0bkdvbmdYaU5pQ29tZmlybUNsaWNrKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgW3RvdUNhcmRNb2RlbHMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXNdID0gdGhpcy5fY2FjbGVBdXRvU2VsZWN0ZWRDYXJkcygpO1xuXG4gICAgICAgIGlmICh0b3VDYXJkTW9kZWxzID09IG51bGwgfHwgemhvbmdDYXJkTW9kZXMgPT0gbnVsbCB8fCB3ZWlDYXJkTW9kZXMgPT0gbnVsbCkge1xuICAgICAgICAgICAgdG91Q2FyZE1vZGVscyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSgtMyk7XG4gICAgICAgICAgICB6aG9uZ0NhcmRNb2RlcyA9IHRoaXMuX2FsbENhcmRNb2Rlcy5zbGljZSg1LCAxMCk7XG4gICAgICAgICAgICB3ZWlDYXJkTW9kZXMgPSB0aGlzLl9hbGxDYXJkTW9kZXMuc2xpY2UoMCwgNSk7XG4gICAgICAgIH1cblxuICAgICAgICBjYy5sb2codG91Q2FyZE1vZGVscylcbiAgICAgICAgY2MubG9nKHpob25nQ2FyZE1vZGVzKVxuICAgICAgICBjYy5sb2cod2VpQ2FyZE1vZGVzKVxuICAgICAgICBjYy5sb2codGhpcy5fYWxsQ2FyZE1vZGVzKVxuICAgICAgICBjYy5sb2coXCLoh6rliqjpgInniYwgdG91Q2FyZE1vZGVscyB6aG9uZ0NhcmRNb2RlcyB3ZWlDYXJkTW9kZXPvvJpcIik7XG4gICAgICAgIHRoaXMuX2RpZFNlbGVjdGVkQ2FyZHModG91Q2FyZE1vZGVscywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlcyk7XG4gICAgfSxcblxuICAgIF9jYWNsZUF1dG9TZWxlY3RlZENhcmRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgbGV0IGNhcmRzID0gdGhpcy5fYWxsQ2FyZE1vZGVzLmZpbHRlcihmdW5jdGlvbihpKXtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHJlc3VsdENhcmRzID0gW107XG4gICAgICAgIGZvcih2YXIgaSA9IDE7aSA8IDM7IGkrKyl7XG4gICAgICAgICAgICBsZXQgY2FyZHNzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkcywgNSk7XG4gICAgICAgICAgICBjYXJkcyA9IGNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmRzcyk7XG4gICAgICAgICAgICByZXN1bHRDYXJkcy5wdXNoKGNhcmRzcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0Q2FyZHMucHVzaChjYXJkcyk7XG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMl0pO1xuICAgICAgICBsZXQgemhvbmdTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHMocmVzdWx0Q2FyZHNbMV0pO1xuICAgICAgICBsZXQgd2VpU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHJlc3VsdENhcmRzWzBdKTtcbiAgICAgICAgY2MubG9nKHJlc3VsdENhcmRzKVxuICAgICAgICBjYy5sb2codGhpcy5fYWxsQ2FyZE1vZGVzKVxuICAgICAgICBjYy5sb2coXCLniYzliIbmlbDoh6rliqjpgInniYzvvJpcIiwgdG91U2NvcmUsIHpob25nU2NvcmUsIHdlaVNjb3JlKTtcbiAgICAgICAgLy9sZXQgd2VpQ2FyZE1vZGVzID0gS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyhjYXJkcywgNSk7XG4gICAgICAgIC8vY2FyZHMgPSBjYXJkcy5rcV9leGNsdWRlcyh3ZWlDYXJkTW9kZXMpO1xuICAgICAgICAvL1xuICAgICAgICAvL2xldCB6aG9uZ0NhcmRNb2RlcyA9IEtRQ2FyZC5hdXRvU2VsZWN0Q2FyZHMoY2FyZHMsIDUpO1xuICAgICAgICAvL1xuICAgICAgICAvL2xldCB0b3VDYXJkTW9kZXMgPSBjYXJkcy5rcV9leGNsdWRlcyh6aG9uZ0NhcmRNb2Rlcyk7XG4gICAgICAgIC8vaWYgKHRvdUNhcmRNb2Rlcy5sZW5ndGggPT0gMyAmJiB6aG9uZ0NhcmRNb2Rlcy5sZW5ndGggPT0gNSAmJiB3ZWlDYXJkTW9kZXMubGVuZ3RoID09IDUpIHtcbiAgICAgICAgLy8gICAgcmV0dXJuIFt0b3VDYXJkTW9kZXMsIHpob25nQ2FyZE1vZGVzLCB3ZWlDYXJkTW9kZXNdO1xuICAgICAgICAvL31cbiAgICAgICAgaWYgKHJlc3VsdENhcmRzWzJdLmxlbmd0aCA9PSAzICYmIHJlc3VsdENhcmRzWzFdLmxlbmd0aCA9PSA1ICYmIHJlc3VsdENhcmRzWzBdLmxlbmd0aCA9PSA1KSB7XG4gICAgICAgICAgICByZXR1cm4gW3Jlc3VsdENhcmRzWzJdLCByZXN1bHRDYXJkc1sxXSwgcmVzdWx0Q2FyZHNbMF1dO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH0sXG5cbiAgICBfY29udmVydENhcmRzVG9TZXJ2ZXJNb2RlbDogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcbiAgICAgICAgcmVzdWx0LnR5cGUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyhjYXJkcyk7XG4gICAgICAgIGlmIChyZXN1bHQudHlwZSA+PSBLUUNhcmQuVFlQRS5TYW5UYW9IdWEgJiYgY2MubW9zaGkgIT0gMSkge1xuICAgICAgICAgICAgLy8g54m55q6K54mMXG4gICAgICAgICAgICByZXN1bHQuaXNDb250YWluRXh0cmEgPSB0aGlzLl9pc0NvbnRhaW5FeHRyYUNhcmRzVHlwZShyZXN1bHQudHlwZSwgY2FyZHMpO1xuICAgICAgICAgICAgLy9yZXN1bHQuaXNDb250YWluRXh0cmEgPSB0cnVlO1xuICAgICAgICAgICAgcmVzdWx0LmNhcmRzID0gY2FyZHM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQuY2FyZHMgPSBLUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMoY2FyZHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSxcblxuICAgIC8qIyMjIyMqL1xuICAgIF9jb252ZXJ0Q2FyZHNUb1NlcnZlck1vZGVsMjogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB7fTtcbiAgICAgICAgcmVzdWx0LnR5cGUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKTtcbiAgICAgICAgcmVzdWx0LnZhbHVlID0gS1FDYXJkLnNjb3JlT2ZDYXJkczIoY2FyZHMpO1xuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPj0gS1FDYXJkLlRZUEUuU2FuVGFvSHVhICYmIGNjLm1vc2hpICE9IDEpIHtcbiAgICAgICAgICAgIC8vIOeJueauiueJjFxuICAgICAgICAgICAgcmVzdWx0LmlzQ29udGFpbkV4dHJhID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlc3VsdC5jYXJkcyA9IGNhcmRzO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LFxuICAgIC8qIyMjIyMqL1xuICAgIC8vIOeJueauiueJjOmHjOaYr+WQpui/mOWQq+acieeJueauiueJjFxuICAgIC8vIOWMheWQq+eahOaDheWGteacie+8mlxuICAgIC8vIOS4ieahg+iKsSDlj6/og73lkKvmnInlkIzoirHpobpcbiAgICAvLyDkuInpobrlrZAg5Y+v6IO95ZCr5pyJ5ZCM6Iqx6aG6XG4gICAgLy8g5YWt5a+55Y2KIOWPr+iDveWQq+aciemTgeaUr1xuICAgIF9pc0NvbnRhaW5FeHRyYUNhcmRzVHlwZTogZnVuY3Rpb24gKHR5cGUsIGNhcmRzKSB7XG4gICAgICAgIGlmICh0eXBlID09IEtRQ2FyZC5UWVBFLlNhblRhb0h1YSkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gS1FDYXJkLlRZUEUuU2FuU2h1blppKSB7XG4gICAgICAgICAgICByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bihjYXJkcyk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBLUUNhcmQuVFlQRS5MaXVEdWlCYW4pIHtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuY29udGFpblRpZVpoaShjYXJkcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG5cbiAgICAvLyDop6bmkbjkuovku7ZcbiAgICBfcmVnaXN0ZXJUb3VjaEV2ZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMuX3RvdWNoQ2FyZExheW91dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX01PVkUsIHRoaXMuX3RvdWNoQ2FyZExheW91dC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5jYXJkc0xheW91dC5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgdGhpcy5fdG91Y2hDYXJkTGF5b3V0RW5kLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLCB0aGlzLl90b3VjaENhcmRMYXlvdXRFbmQuYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIF90b3VjaENhcmRMYXlvdXQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5idWJibGVzID0gdHJ1ZTtcbiAgICAgICAgbGV0IGxvY2F0aW9uID0gZXZlbnQuZ2V0TG9jYXRpb24oKTtcbiAgICAgICAgbGV0IGNhcmRQcmVmYWIgPSB0aGlzLl9jYXJkUHJlZmFiSW5DYXJkTGF5b3V0V2l0aExvY2F0aW9uKGxvY2F0aW9uKTtcbiAgICAgICAgaWYgKGNhcmRQcmVmYWIpIHtcbiAgICAgICAgICAgIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuc2V0U2VsZWN0ZWQodHJ1ZSk7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfdG91Y2hDYXJkTGF5b3V0RW5kOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5fY2hhbmdlU2VsZWN0ZWRDYXJkUHJlZmFic1koKTtcbiAgICAgICAgdGhpcy5fZGlzZWNsZWN0Q2FyZFByZWZhYnMoKTtcbiAgICB9LFxuXG4gICAgX2NhcmRQcmVmYWJJbkNhcmRMYXlvdXRXaXRoTG9jYXRpb246IGZ1bmN0aW9uIChsb2NhdGlvbikge1xuICAgICAgICBsb2NhdGlvbiA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihsb2NhdGlvbik7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAoY2FyZE5vZGUxLCBjYXJkTm9kZTIpIHtcbiAgICAgICAgICAgIGxldCByZWN0MSA9IGNhcmROb2RlMS5nZXRCb3VuZGluZ0JveCgpO1xuICAgICAgICAgICAgbGV0IHJlY3QyID0gY2FyZE5vZGUyLmdldEJvdW5kaW5nQm94KCk7XG4gICAgICAgICAgICByZXR1cm4gcmVjdDIueCAtIHJlY3QxLng7XG4gICAgICAgIH0pO1xuICAgICAgICBmb3IgKGxldCBpbmRleCBpbiBjYXJkTm9kZXMpIHtcbiAgICAgICAgICAgIGxldCBjYXJkTm9kZSA9IGNhcmROb2Rlc1tpbmRleF07XG5cbiAgICAgICAgICAgIGxldCByZWN0ID0gY2FyZE5vZGUuZ2V0Qm91bmRpbmdCb3goKTtcblxuICAgICAgICAgICAgaWYgKGNjLnJlY3RDb250YWluc1BvaW50KHJlY3QsIGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYXJkTm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICBfY2hhbmdlU2VsZWN0ZWRDYXJkUHJlZmFic1k6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuX3NlbGVjdGVkQ2FyZFByZWZhYnMoKTtcbiAgICAgICAgdGhpcy5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG5cbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlQb2tlckNsaWNrKCk7XG4gICAgfSxcblxuICAgIF9jaGFuZ2VDYXJkUHJlZmFic1k6IGZ1bmN0aW9uIChjYXJkTm9kZXMpIHtcbiAgICAgICAgY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgICAgICBsZXQgeSA9IGNhcmROb2RlLmdldFBvc2l0aW9uWSgpO1xuICAgICAgICAgICAgaWYgKHkgPT0gdGhpcy5fY2FyZE9mZnNldFkpIHtcbiAgICAgICAgICAgICAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblkodGhpcy5fY2FyZE9mZnNldFkgKyA1NSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhcmROb2RlLnNldFBvc2l0aW9uWSh0aGlzLl9jYXJkT2Zmc2V0WSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIF9zZWxlY3RlZENhcmRQcmVmYWJzOiBmdW5jdGlvbiAoaW5jbHVkZVN0aWNrT3V0ID0gZmFsc2UpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgcmV0dXJuIGNhcmROb2Rlcy5maWx0ZXIoZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgICAgICBsZXQgY2FyZFByZWZhYiA9IGNhcmROb2RlLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgbGV0IGlzU2VsZWN0ZWQgPSBjYXJkUHJlZmFiLmlzU2VsZWN0ZWQoKTtcbiAgICAgICAgICAgIGlmICghaXNTZWxlY3RlZCAmJiBpbmNsdWRlU3RpY2tPdXQpIHtcbiAgICAgICAgICAgICAgICBpc1NlbGVjdGVkID0gY2FyZE5vZGUuZ2V0UG9zaXRpb25ZKCkgPiAxMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGlzU2VsZWN0ZWQ7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfZGlzZWNsZWN0Q2FyZFByZWZhYnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIG5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuc2V0U2VsZWN0ZWQoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLy8g6YeN572uIGNhcmRzIOeahCBYXG4gICAgX3Jlc2V0Q2FyZHNQb3NpdGlvblg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9sZXQgaW50ZXJ2YWwgPSA5ODtcbiAgICAgICAgbGV0IGludGVydmFsID0gNzg7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4gfHwgW107XG4gICAgICAgIGxldCBsZW5ndGggPSBjYXJkTm9kZXMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBtaWRkbGVJbmRleCA9IGxlbmd0aCAvIDI7XG4gICAgICAgIGxldCBjYXJkV2lkdGggPSAxNTQ7XG5cblxuICAgICAgICAvL3RoaXMuY2FyZHNMYXlvdXRTb3J0KCk7XG4gICAgICAgIGlmKHRoaXMuY2FyZHNMYXlvdXRTb3J0Q29sb3IgPT0gdHJ1ZSl7XG4gICAgICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudDEgPSBuMS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgICAgICAgICBsZXQgY29tcG9uZW50MiA9IG4yLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQyLmNhcmRNb2RlKCkuY29sb3IgLSBjb21wb25lbnQxLmNhcmRNb2RlKCkuY29sb3I7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW4uc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudDEgPSBuMS5nZXRDb21wb25lbnQoJ0NhcmRQcmVmYWInKTtcbiAgICAgICAgICAgICAgICBsZXQgY29tcG9uZW50MiA9IG4yLmdldENvbXBvbmVudCgnQ2FyZFByZWZhYicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnQxLmNhcmRNb2RlKCkuc29ydChjb21wb25lbnQyLmNhcmRNb2RlKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9jYXJkTm9kZXMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIC8vICAgIGxldCBjb21wb25lbnQxID0gbjEuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vICAgIGxldCBjb21wb25lbnQyID0gbjIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJyk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgIHJldHVybiBjb21wb25lbnQxLmNhcmRNb2RlKCkuc29ydChjb21wb25lbnQyLmNhcmRNb2RlKCkpO1xuICAgICAgICAvL30pO1xuXG4gICAgICAgIGNhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGNhcmROb2RlLnpJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgbGV0IHggPSAoaW5kZXggLSBtaWRkbGVJbmRleCkgKiBpbnRlcnZhbCArIGNhcmRXaWR0aCAvIDM7XG4gICAgICAgICAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblgoeCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyDph43nva4gY2FyZHMg55qEIFjkuLowXG4gICAgcmVzZXRDYXJkc1Bvc2l0aW9uWDE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgbGV0IGxlbmd0aCA9IGNhcmROb2Rlcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNhcmROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTm9kZSkge1xuICAgICAgICAgICAgY2FyZE5vZGUuc2V0UG9zaXRpb25ZKDApO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX3Jlc2V0Q2FyZHNQb3NpdGlvblk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROb2RlKSB7XG4gICAgICAgICAgICBjYXJkTm9kZS5zZXRQb3NpdGlvblkodGhpcy5fY2FyZE9mZnNldFkpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICAvLyDlpLTjgIHkuK3jgIHlsL7pgZMgbGF5b3V0IOeahOeCueWHu+S6i+S7tlxuICAgIF9yZWdpc3RlckRhb3NMYXlvdXRDbGlja0V2ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsYXlvdXRUb3VEYW8gPSB0aGlzLmxheW91dFRvdURhbztcbiAgICAgICAgdmFyIGxheW91dFpob25nRGFvID0gdGhpcy5sYXlvdXRaaG9uZ0RhbztcbiAgICAgICAgdmFyIGxheW91dFdlaURhbyA9IHRoaXMubGF5b3V0V2VpRGFvO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIC8v5aS06YGT54K55Ye7XG4gICAgICAgIHRoaXMubGF5b3V0VG91RGFvLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX2NsaWNrVG91RGFvTGF5b3V0KGV2ZW50KTtcbiAgICAgICAgICAgIC8qIyMjIyPngrnlh7vnrKzkuozpgZPliankuIvnmoTniYzoh6rliqjpgInkuIrljrsjIyMjIyBiZWdpbiovXG4gICAgICAgICAgICAvL+WmguaenOWJqeS4i+eahOeJjOWwj+S6jjXlvKBcbiAgICAgICAgICAgIGlmKHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbi5sZW5ndGggPD0gNSl7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzlsL7pgZPloavmu6HvvIzmiorlroPmlL7lhaXkuK3pgZNcbiAgICAgICAgICAgICAgICBpZihsYXlvdXRaaG9uZ0Rhby5ub2RlLmNoaWxkcmVuLmxlbmd0aCA8IDUgJiYgbGF5b3V0V2VpRGFvLm5vZGUuY2hpbGRyZW4ubGVuZ3RoID09IDUpe1xuICAgICAgICAgICAgICAgICAgICAvLyDnqoHlh7rorqHnrpflh7rmnaXnmoTniYzmlbDnu4RcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZERhb0NhcmRUb0xheW91dChsYXlvdXRaaG9uZ0Rhby5ub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzkuK3pgZPloavmu6HvvIzmiorlroPmlL7lhaXlsL7pgZNcbiAgICAgICAgICAgICAgICBlbHNlIGlmKGxheW91dFdlaURhby5ub2RlLmNoaWxkcmVuLmxlbmd0aCA8IDUgJiYgbGF5b3V0WmhvbmdEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gNSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkRGFvQ2FyZFRvTGF5b3V0KGxheW91dFdlaURhby5ub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiMjIyMjZW5kKi9cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy/kuK3pgZPngrnlh7tcbiAgICAgICAgdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9jbGlja1pob25nRGFvTGF5b3V0KGV2ZW50KTtcbiAgICAgICAgICAgIC8qIyMjIyNiZWdpbiovXG4gICAgICAgICAgICAvL+S4remBk+W/hemhu+Whq+a7oeaJjeadpeaJp+ihjFxuICAgICAgICAgICAgaWYobGF5b3V0WmhvbmdEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gNSl7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzliankuIvnmoTniYzlsI/kuo7nrYnkuo415bygXG4gICAgICAgICAgICAgICAgaWYodGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLmxlbmd0aCA8PSA1KXtcbiAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzlsL7pgZPloavmu6HvvIzmiorlroPmlL7lhaXlpLTpgZNcbiAgICAgICAgICAgICAgICAgICAgaWYobGF5b3V0VG91RGFvLm5vZGUuY2hpbGRyZW4ubGVuZ3RoIDwgMyAmJiBsYXlvdXRXZWlEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gNSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDnqoHlh7rorqHnrpflh7rmnaXnmoTniYzmlbDnu4RcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYXJkTm9kZXMgPSB0aGlzLmNhcmRzTGF5b3V0Lm5vZGUuY2hpbGRyZW47XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jaGFuZ2VDYXJkUHJlZmFic1koY2FyZE5vZGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2FkZERhb0NhcmRUb0xheW91dChsYXlvdXRUb3VEYW8ubm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzlpLTpgZPloavmu6HvvIzmiorlroPmlL7lhaXlsL7pgZNcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihsYXlvdXRXZWlEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPCA1ICYmIGxheW91dFRvdURhby5ub2RlLmNoaWxkcmVuLmxlbmd0aCA9PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZE5vZGVzID0gdGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fY2hhbmdlQ2FyZFByZWZhYnNZKGNhcmROb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9hZGREYW9DYXJkVG9MYXlvdXQobGF5b3V0V2VpRGFvLm5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiMjIyMjZW5kKi9cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgLy/lsL7pgZPngrnlh7tcbiAgICAgICAgdGhpcy5sYXlvdXRXZWlEYW8ubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdGhpcy5fY2xpY2tXZWlEYW9MYXlvdXQoZXZlbnQpO1xuICAgICAgICAgICAgLyojIyMjI2JlZ2luKi9cbiAgICAgICAgICAgIC8v5bC+6YGT5b+F6aG75aGr5ruh5omN5p2l5omn6KGMXG4gICAgICAgICAgICBpZihsYXlvdXRXZWlEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gNSl7XG4gICAgICAgICAgICAgICAgLy/lpoLmnpzliankuIvnmoTniYzlsI/kuo7nrYnkuo415bygXG4gICAgICAgICAgICAgICAgaWYodGhpcy5jYXJkc0xheW91dC5ub2RlLmNoaWxkcmVuLmxlbmd0aCA8PSA1KXtcbiAgICAgICAgICAgICAgICAgICAgLy/lpoLmnpzkuK3pgZPloavmu6HvvIzmiorlroPmlL7lhaXlpLTpgZNcbiAgICAgICAgICAgICAgICAgICAgaWYobGF5b3V0VG91RGFvLm5vZGUuY2hpbGRyZW4ubGVuZ3RoIDwgMyAmJiBsYXlvdXRaaG9uZ0Rhby5ub2RlLmNoaWxkcmVuLmxlbmd0aCA9PSA1KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOeqgeWHuuiuoeeul+WHuuadpeeahOeJjOaVsOe7hFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NoYW5nZUNhcmRQcmVmYWJzWShjYXJkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkRGFvQ2FyZFRvTGF5b3V0KGxheW91dFRvdURhby5ub2RlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL+WmguaenOWktOmBk+Whq+a7oe+8jOaKiuWug+aUvuWFpeS4remBk1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGxheW91dFpob25nRGFvLm5vZGUuY2hpbGRyZW4ubGVuZ3RoIDwgNSAmJiBsYXlvdXRUb3VEYW8ubm9kZS5jaGlsZHJlbi5sZW5ndGggPT0gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NoYW5nZUNhcmRQcmVmYWJzWShjYXJkTm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkRGFvQ2FyZFRvTGF5b3V0KGxheW91dFpob25nRGFvLm5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiMjIyMjZW5kKi9cbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgX2NsaWNrVG91RGFvTGF5b3V0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgbGV0IGNsaWNrQ2FyZCA9IHRoaXMuX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQodGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgZXZlbnQpO1xuICAgICAgICBpZiAoY2xpY2tDYXJkKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkKGNsaWNrQ2FyZCwgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYWRkRGFvQ2FyZFRvTGF5b3V0KHRoaXMubGF5b3V0VG91RGFvLm5vZGUsIDMpO1xuICAgIH0sXG5cbiAgICBfY2xpY2taaG9uZ0Rhb0xheW91dDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGxldCBjbGlja0NhcmQgPSB0aGlzLl9kYW9DYXJkTm9kZUluTGF5b3V0V2l0aEV2ZW50KHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZSwgZXZlbnQpO1xuICAgICAgICBpZiAoY2xpY2tDYXJkKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkKGNsaWNrQ2FyZCwgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9hZGREYW9DYXJkVG9MYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKTtcbiAgICB9LFxuXG4gICAgX2NsaWNrV2VpRGFvTGF5b3V0OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgbGV0IGNsaWNrQ2FyZCA9IHRoaXMuX2Rhb0NhcmROb2RlSW5MYXlvdXRXaXRoRXZlbnQodGhpcy5sYXlvdXRXZWlEYW8ubm9kZSwgZXZlbnQpO1xuICAgICAgICBpZiAoY2xpY2tDYXJkKSB7XG4gICAgICAgICAgICB0aGlzLl9kZWxldGVEYW9DYXJkKGNsaWNrQ2FyZCwgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYWRkRGFvQ2FyZFRvTGF5b3V0KHRoaXMubGF5b3V0V2VpRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBfZGFvQ2FyZE5vZGVJbkxheW91dFdpdGhFdmVudDogZnVuY3Rpb24gKG5vZGUsIGV2ZW50KSB7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSBub2RlLmNoaWxkcmVuIHx8IFtdO1xuICAgICAgICB2YXIgbG9jYXRpb24gPSBldmVudC5nZXRMb2NhdGlvbigpO1xuICAgICAgICBsb2NhdGlvbiA9IG5vZGUuY29udmVydFRvTm9kZVNwYWNlQVIobG9jYXRpb24pO1xuICAgICAgICBmb3IgKGxldCBpbmRleCBpbiBjYXJkTm9kZXMpIHtcbiAgICAgICAgICAgIGxldCBjYXJkTm9kZSA9IGNhcmROb2Rlc1tpbmRleF07XG4gICAgICAgICAgICBsZXQgcmVjdCA9IGNhcmROb2RlLmdldEJvdW5kaW5nQm94KCk7XG4gICAgICAgICAgICBpZiAoY2MucmVjdENvbnRhaW5zUG9pbnQocmVjdCwgbG9jYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmROb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9hZGREYW9DYXJkVG9MYXlvdXQ6IGZ1bmN0aW9uIChub2RlLCBtYXhOdW1iZXJDYXJkID0gNSkge1xuICAgICAgICBsZXQgY2FyZE5vZGVzID0gbm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgaWYgKGNhcmROb2Rlcy5sZW5ndGggPj0gNSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHJlbWFpbkNvdW50ID0gbWF4TnVtYmVyQ2FyZCAtIGNhcmROb2Rlcy5sZW5ndGg7XG4gICAgICAgIHZhciBzZWxlY3RlZENhcmRzID0gdGhpcy5fc2VsZWN0ZWRDYXJkUHJlZmFicyh0cnVlKSB8fCBbXTtcbiAgICAgICAgaWYgKHNlbGVjdGVkQ2FyZHMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZWxlY3RlZENhcmRzLmxlbmd0aCA+IHJlbWFpbkNvdW50KSB7XG4gICAgICAgICAgICBzZWxlY3RlZENhcmRzID0gc2VsZWN0ZWRDYXJkcy5zbGljZSgwLCByZW1haW5Db3VudCk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc2VsZWN0ZWRDYXJkTmFtZXMgPSBzZWxlY3RlZENhcmRzLm1hcChmdW5jdGlvbiAoY2FyZFByZWZhYikge1xuICAgICAgICAgICAgcmV0dXJuIGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KCdDYXJkUHJlZmFiJykuY2FyZE5hbWUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2FyZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmRUeXBlTm9kZSkge1xuICAgICAgICAgICAgc2VsZWN0ZWRDYXJkTmFtZXMucHVzaChjYXJkVHlwZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLmNhcmROYW1lKCkpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgY2FyZE1vZGVzID0gc2VsZWN0ZWRDYXJkTmFtZXMubWFwKGZ1bmN0aW9uIChjYXJkTmFtZSxpbmRleCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBLUUNhcmQoY2FyZE5hbWUsbnVsbCxpbmRleCk7XG4gICAgICAgIH0pLnNvcnQoZnVuY3Rpb24gKGMxLCBjMikge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5zb3J0KGMxLCBjMiwgZmFsc2UpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgdG91Q2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRUb3VEYW8ubm9kZSkgPyBjYXJkTW9kZXMgOiB0aGlzLl90YW9EYW9DYXJkTW9kZXMoKTtcbiAgICAgICAgbGV0IHpob25nQ2FyZE1vZGVzID0gKG5vZGUgPT0gdGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlKSA/IGNhcmRNb2RlcyA6IHRoaXMuX3pob25nRGFvQ2FyZE1vZGVzKCk7XG4gICAgICAgIGxldCB3ZWlDYXJkTW9kZXMgPSAobm9kZSA9PSB0aGlzLmxheW91dFdlaURhby5ub2RlKSA/IGNhcmRNb2RlcyA6IHRoaXMuX3dlaURhb0NhcmRNb2RlcygpO1xuICAgICAgICBpZiAoIXRoaXMuX2lzVmFsaWRDYXJkTW9kZXModG91Q2FyZE1vZGVzLCB6aG9uZ0NhcmRNb2Rlcywgd2VpQ2FyZE1vZGVzKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIGNhcmRNb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkTW9kZSkge1xuICAgICAgICAgICAgbGV0IGNhcmROYW1lID0gY2FyZE1vZGUuY2FyZE5hbWUoKTtcbiAgICAgICAgICAgIGxldCBjYXJkVHlwZVNwcml0ZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2FyZFR5cGVQcmVmYWIpO1xuICAgICAgICAgICAgaWYoY2MubWFQYWkpe1xuICAgICAgICAgICAgICAgIHZhciBjYXJkTWFQYWkgPSAnM18nICsgY2MubWFQYWk7XG4gICAgICAgICAgICAgICAgaWYoY2FyZE5hbWUgPT0gY2FyZE1hUGFpKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjI2LCAxNDUsIDE0NSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLnNldENhcmQoY2FyZE5hbWUpO1xuICAgICAgICAgICAgbm9kZS5hZGRDaGlsZChjYXJkVHlwZVNwcml0ZSk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgICAgc2VsZWN0ZWRDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICBub2RlLnJlbW92ZUZyb21QYXJlbnQoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3Jlc2V0Q2FyZHNQb3NpdGlvblkoKTtcbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWCgpO1xuXG4gICAgICAgIHRoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b25zKCk7XG5cbiAgICAgICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICB0aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuXG4gICAgfSxcblxuICAgIC8vIOWIoOmZpCDlpLTjgIHkuK3miJblsL7pgZPkuK3nmoTmn5DkuK3niYxcbiAgICBfZGVsZXRlRGFvQ2FyZDogZnVuY3Rpb24gKGNhcmRUeXBlTm9kZSwgcmVsb2FkVHlwZUJ1dHRvbkVuYWJsZXMgPSBmYWxzZSkge1xuICAgICAgICBsZXQgY2FyZE5hbWUgPSBjYXJkVHlwZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLmNhcmROYW1lKCk7XG4gICAgICAgIHRoaXMuYWRkQ2FyZChjYXJkTmFtZSwgdHJ1ZSk7XG5cbiAgICAgICAgdGhpcy5fcmVzZXRDYXJkc1Bvc2l0aW9uWSgpO1xuXG4gICAgICAgIGNhcmRUeXBlTm9kZS5yZW1vdmVGcm9tUGFyZW50KHRydWUpO1xuICAgICAgICB0aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9ucygpO1xuXG4gICAgICAgIGlmIChyZWxvYWRUeXBlQnV0dG9uRW5hYmxlcykge1xuICAgICAgICAgICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRUeXBlQnV0dG9uRW5hYmxlc1dpdGhNb2RlbHMoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDliKDpmaQg5aS06YGT5oiW5Lit6YGT5oiW5bC+6YGT5LiK5omA5pyJ55qEIOeJjFxuICAgIF9kZWxldGVEYW9DYXJkc09mTGF5b3V0OiBmdW5jdGlvbiAoZGFvTGF5b3V0KSB7XG4gICAgICAgIGxldCBjYXJkTm9kZXMgPSBBcnJheS5mcm9tKGRhb0xheW91dC5jaGlsZHJlbik7XG4gICAgICAgIGNhcmROb2Rlcy5mb3JFYWNoKHRoaXMuX2RlbGV0ZURhb0NhcmQuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5fcmVsb2FkS1FDYXJkTW9kZXNJbm5lcigpO1xuICAgICAgICB0aGlzLl9yZXNldFR5cGVCdXR0b25FbmFibGVzV2l0aE1vZGVscygpO1xuICAgIH0sXG5cbiAgICAvLyDliKTmlq3og73lkKbkvb/nlKjpgInmi6nkuK3nmoTniYxcbiAgICAvLyDljbPvvJrlpLTpgZPopoHlsI/kuo7kuK3pgZPjgIHkuK3pgZPopoHlsI/kuo7lsL7pgZNcbiAgICBfaXNWYWxpZENhcmRNb2RlczogZnVuY3Rpb24gKHRvdUNhcmRNb2RlcywgemhvbmdDYXJkTW9kZXMsIHdlaUNhcmRNb2Rlcykge1xuICAgICAgICB0b3VDYXJkTW9kZXMgPSB0b3VDYXJkTW9kZXMgfHwgW107XG4gICAgICAgIHpob25nQ2FyZE1vZGVzID0gemhvbmdDYXJkTW9kZXMgfHwgW107XG4gICAgICAgIHdlaUNhcmRNb2RlcyA9IHdlaUNhcmRNb2RlcyB8fCBbXTtcbiAgICAgICAgY2MubG9nKHRvdUNhcmRNb2Rlcy5sZW5ndGgsIHpob25nQ2FyZE1vZGVzLmxlbmd0aCwgd2VpQ2FyZE1vZGVzLmxlbmd0aCk7XG4gICAgICAgIGlmICh0b3VDYXJkTW9kZXMubGVuZ3RoIDwgMyB8fCB6aG9uZ0NhcmRNb2Rlcy5sZW5ndGggPCA1IHx8IHdlaUNhcmRNb2Rlcy5sZW5ndGggPCA1KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCB0b3VTY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHModG91Q2FyZE1vZGVzKTtcbiAgICAgICAgbGV0IHpob25nU2NvcmUgPSBLUUNhcmQuc2NvcmVPZkNhcmRzKHpob25nQ2FyZE1vZGVzKTtcbiAgICAgICAgbGV0IHdlaVNjb3JlID0gS1FDYXJkLnNjb3JlT2ZDYXJkcyh3ZWlDYXJkTW9kZXMpO1xuICAgICAgICBjYy5sb2coXCLniYzliIbmlbDvvJpcIiwgdG91U2NvcmUsIHpob25nU2NvcmUsIHdlaVNjb3JlKTtcbiAgICAgICAgcmV0dXJuICh0b3VTY29yZSA8IHpob25nU2NvcmUpICYmICh6aG9uZ1Njb3JlIDw9IHdlaVNjb3JlKTtcbiAgICB9LFxuXG4gICAgLy8g5aS06YGT5LiK5bey5pyJ55qE54mMXG4gICAgX3Rhb0Rhb0NhcmRNb2RlczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZE1vZGVzT2ZDYXJkUHJlZmFicyh0aGlzLmxheW91dFRvdURhby5ub2RlLmNoaWxkcmVuKTtcbiAgICB9LFxuXG4gICAgLy8g5Lit6YGT5LiK5bey5pyJ55qE54mMXG4gICAgX3pob25nRGFvQ2FyZE1vZGVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzKHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZS5jaGlsZHJlbik7XG4gICAgfSxcblxuICAgIC8vIOWwvumBk+S4iuW3suacieeahOeJjFxuICAgIF93ZWlEYW9DYXJkTW9kZXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRNb2Rlc09mQ2FyZFByZWZhYnModGhpcy5sYXlvdXRXZWlEYW8ubm9kZS5jaGlsZHJlbik7XG4gICAgfSxcblxuICAgIF9jYXJkTW9kZXNPZkNhcmRQcmVmYWJzOiBmdW5jdGlvbiAoY2FyZFR5cGVOb2Rlcykge1xuICAgICAgICBpZiAoIWNhcmRUeXBlTm9kZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjYXJkTW9kZXMgPSBjYXJkVHlwZU5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgbGV0IGNvbXBvbmVudCA9IG5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudC5jYXJkTW9kZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY2FyZE1vZGVzIHx8IFtdO1xuICAgIH0sXG5cbiAgICAvLyDoh6rliqjorr7nva4g5aS044CB5Lit44CB5bC+6YGT55qE5Yig6Zmk5oyJ6ZKu55qE5Y+v6KeB5oCnXG4gICAgX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b25zOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b24odGhpcy5sYXlvdXRUb3VEYW8ubm9kZSwgdGhpcy5idG5EZWxldGVUb3VEYW8ubm9kZSk7XG4gICAgICAgIHRoaXMuX2F1dG9BY3RpdmVEZWxldGVEYW9CdXR0b24odGhpcy5sYXlvdXRaaG9uZ0Rhby5ub2RlLCB0aGlzLmJ0bkRlbGV0ZVpob25nRGFvLm5vZGUpO1xuICAgICAgICB0aGlzLl9hdXRvQWN0aXZlRGVsZXRlRGFvQnV0dG9uKHRoaXMubGF5b3V0V2VpRGFvLm5vZGUsIHRoaXMuYnRuRGVsZXRlV2VpRGFvLm5vZGUpO1xuICAgIH0sXG5cbiAgICBfYXV0b0FjdGl2ZURlbGV0ZURhb0J1dHRvbjogZnVuY3Rpb24gKGxheW91dCwgYnV0dG9uKSB7XG4gICAgICAgIGJ1dHRvbi5hY3RpdmUgPSBsYXlvdXQuY2hpbGRyZW4ubGVuZ3RoID4gMDtcbiAgICB9LFxuXG4gICAgLy8g6Ieq5Yqo6K6+572uIOKAnOWFqOmDqOWPlua2iOKAneOAgeKAnOehruWumuWHuueJjOKAneOAgeKAnOexu+Wei+mAieaLqeKAneaMiemSrueahOWPr+ingeaAp1xuICAgIF9hdXRvQWN0aXZlVHlwZUJ1dHRvbnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IGNhcmROb2RlcyA9IHRoaXMuY2FyZHNMYXlvdXQubm9kZS5jaGlsZHJlbiB8fCBbXTtcbiAgICAgICAgbGV0IGhhc0NhcmRVblNlbGVjdGVkID0gY2FyZE5vZGVzLmxlbmd0aCA+IDA7XG4gICAgICAgIHRoaXMuYnRuRG9uZS5ub2RlLmFjdGl2ZSA9ICFoYXNDYXJkVW5TZWxlY3RlZDtcbiAgICAgICAgdGhpcy5idG5DYW5jZWxBbGwubm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkRvbmUubm9kZS5hY3RpdmU7XG4gICAgICAgIHRoaXMudHlwZUJ1dHRvbnNOb2RlLmFjdGl2ZSA9IGhhc0NhcmRVblNlbGVjdGVkO1xuICAgIH0sXG5cbn0pO1xuIiwiY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgX2NhcmROYW1lOiBudWxsLFxuICAgICAgX2NhcmRNb2RlbDogbnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0Q2FyZDogZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICB0aGlzLl9jYXJkTmFtZSA9IGNhcmROYW1lO1xuICAgICAgdGhpcy5fY2FyZE1vZGVsID0gbmV3IEtRQ2FyZChjYXJkTmFtZSk7XG4gICAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBmdW5jdGlvbiAoc3ByaXRlRnJhbWUpIHtcbiAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJykuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNhcmROYW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2FyZE5hbWU7XG4gICAgfSxcblxuICAgIGNhcmRNb2RlOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2FyZE1vZGVsO1xuICAgIH0sXG5cbiAgICBfY2FyZEZ1bGxOYW1lOiBmdW5jdGlvbiAoY2FyZFNob3J0TmFtZSkge1xuICAgICAgdmFyIGNhcmROYW1lID0gY2FyZFNob3J0TmFtZTtcbiAgICAgIGlmICghY2FyZE5hbWUuc3RhcnRzV2l0aChcInB1YmxpYy1waWMtY2FyZC1wb2tlclwiKSkge1xuICAgICAgICBjYXJkTmFtZSA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjYXJkTmFtZTtcbiAgICB9LFxuXG4gICAgX2xvYWRDYXJkRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcbiAgICAgIGNjLmFzc2VydChjYWxsYmFjayk7XG5cbiAgICAgIGNjLmxvYWRlci5sb2FkUmVzKFwiaW1hZ2VzL3Bva2VyTGlzdC9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGNjLmVycm9yKGVycik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FyZE5hbWUgPSB0aGlzLl9jYXJkRnVsbE5hbWUoY2FyZE5hbWUpO1xuICAgICAgICB2YXIgZnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShjYXJkTmFtZSk7XG4gICAgICAgIGNhbGxiYWNrKGZyYW1lKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcbn0pO1xuIiwiLy8g55So5LqO5Zyo5ri45oiP6L+H56iL5Lit77yM5bGV56S655So5oi355qE6IGK5aSp5raI5oGvXG5cbmxldCBDaGF0TWVzc2FnZSA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICByaWNoVGV4dDogY2MuUmljaFRleHQsXG4gICAgICBzcHJpdGVCYWNrZ3JvdW5kOiBjYy5TcHJpdGUsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFN0cmluZzogZnVuY3Rpb24gKHN0cmluZyA9IFwiXCIsIGF1dG9IaWRlID0gdHJ1ZSkge1xuICAgICAgaWYgKHN0cmluZy5sZW5ndGggPT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICBsZXQgbWF4V2lkdGggPSAzMDA7XG4gICAgICBsZXQgcmVhbFN0ciA9IENoYXRNZXNzYWdlLnBhcnNlU3RyaW5nKHN0cmluZyk7XG5cbiAgICAgIC8vIOeUseS6jiBjYy5SaWNoVGV4dCDlnKjmjIflrpogbWF4V2lkdGgg5ZCO77yM6K+l57uT54K555qEIHdpZHRoIOS8muS4gOebtFxuICAgICAgLy8g5pivIG1heFdpZHRoIOWAvOOAguiAjOWcqOWwhiBtYXhXaWR0aCDmjIflrprkuLow5pe277yM5YW2IGNvbnRlbnRTaXplLndpZHRoIOS8mlxuICAgICAgLy8g5piv5YaF5a6555qE55yf5q2j5omA6ZyA55qE5a695bqmXG4gICAgICAvL1xuICAgICAgLy8g5omA5Lul6L+Z6YeM5YWI5bCGIG1heFdpZHRoIOiuvuS4uiAw77yM6I635Y+W5YW25a6e6ZmF5YaF5a65IHdpZHRoIOWQjuWGjeiwg+aVtFxuICAgICAgdGhpcy5yaWNoVGV4dC5tYXhXaWR0aCA9IDA7XG4gICAgICB0aGlzLnJpY2hUZXh0LnN0cmluZyA9IHJlYWxTdHI7XG5cbiAgICAgIGxldCBjb250ZW50V2lkdGggPSB0aGlzLnJpY2hUZXh0Lm5vZGUuZ2V0Q29udGVudFNpemUoKS53aWR0aDtcbiAgICAgIGlmIChjb250ZW50V2lkdGggPiBtYXhXaWR0aCkge1xuICAgICAgICB0aGlzLnJpY2hUZXh0Lm1heFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICAgIHRoaXMucmljaFRleHQuc3RyaW5nID0gcmVhbFN0cjtcbiAgICAgICAgY29udGVudFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubm9kZS53aWR0aCA9IGNvbnRlbnRXaWR0aCArIDI4O1xuICAgICAgdGhpcy5ub2RlLmhlaWdodCA9IHRoaXMucmljaFRleHQubm9kZS5nZXRDb250ZW50U2l6ZSgpLmhlaWdodCArIDIwO1xuXG4gICAgICB0aGlzLnNwcml0ZUJhY2tncm91bmQubm9kZS53aWR0aCA9IHRoaXMubm9kZS53aWR0aDtcbiAgICAgIHRoaXMuc3ByaXRlQmFja2dyb3VuZC5ub2RlLmhlaWdodCA9IHRoaXMubm9kZS5oZWlnaHQ7XG5cbiAgICAgIGlmIChhdXRvSGlkZSkge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UodGhpcy5faGlkZU5vZGUuYmluZCh0aGlzKSwgMyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIF9oaWRlTm9kZTogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbn0pO1xuXG4vLyDlsIYgPGJxMTA+IOaUueS4uu+8miA8aW1nIHNyYz0nYmcxMCcvPlxuQ2hhdE1lc3NhZ2UucGFyc2VTdHJpbmcgPSBmdW5jdGlvbiAoc3RyKSB7XG4gIGxldCByZXN1bHQgPSBzdHIucmVwbGFjZSgvPGJxXFxkezEsMn0+L2csIGZ1bmN0aW9uKG1hdGNoKXtcbiAgICB2YXIgYnEgPSBtYXRjaC5yZXBsYWNlKFwiPFwiLCBcIiA8aW1nIHNyYz0nXCIpLnJlcGxhY2UoXCI+XCIsIFwiJy8+IFwiKTtcbiAgICByZXR1cm4gYnE7XG4gIH0pO1xuXG4gIHJldHVybiByZXN1bHQ7XG59LFxuXG5tb2R1bGUuZXhwb3J0cyA9IENoYXRNZXNzYWdlO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0U3RyaW5nOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICB0aGlzLl9yaWNoVGV4dCgpLnN0cmluZyA9IHN0cjtcbiAgICB9LFxuXG4gICAgX3JpY2hUZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5ub2RlLmdldENvbXBvbmVudCgnY2MuUmljaFRleHQnKTtcbiAgICB9LFxuXG5cbn0pO1xuIiwiY29uc3QgS1FDYXJkUmVzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUmVzSGVscGVyJyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcbmNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0b3VMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgemhvbmdMYXlvdXQ6IGNjLkxheW91dCxcbiAgICAgICAgd2VpTGF5b3V0OiBjYy5MYXlvdXQsXG4gICAgICAgIGxhYmVsVG91U2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFRvdVNjb3JlUmlnaHQ6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFpob25nU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFpob25nU2NvcmVSaWdodDogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsV2VpU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFdlaVNjb3JlUmlnaHQ6IGNjLkxhYmVsLFxuXG4gICAgICAgIHRvdVNjcm9lVGl0bGU6IGNjLk5vZGUsICAvL+WktOmBk+Wtl1xuICAgICAgICB6aG9uZ1Njcm9lVGl0bGU6IGNjLk5vZGUsIC8v5Lit6YGT5a2XXG4gICAgICAgIHdlaVNjcm9lVGl0bGU6IGNjLk5vZGUsICAvL+WwvumBk+Wtl1xuXG4gICAgICAgIHNjb3JlU3R5bGU6IDAsICAvLyAwIOihqOekuuWIhuaVsOWcqOW3pui+uSAgMSDooajnpLrliIbmlbDlnKjlj7PovrkgMuS4jeaYvuekuuWIhuaVsFxuICAgICAgICBfZGFvTGF5b3V0czogbnVsbCwgLy8g5aS044CB5Lit44CB5bC+6ZuG5ZCIXG4gICAgICAgIF9sYWJlbFNjb3JlczogbnVsbCxcbiAgICAgICAgX3Njb3JlczogbnVsbCxcblxuXG4gICAgICAgIHRlU2h1TGF5b3V0OiBjYy5MYXlvdXQsXG4gICAgICAgIGxhYmVsVGVTaHVQYWlUaXRsZTogY2MuTGFiZWwsXG4gICAgICAgIHBOdW06MCwvL+eOqeWutuS6uuaVsFxuICAgICAgICB0ZVNodVRpbWU6MCwvL+eJueauiueJjOWHuueJjOmhuuW6j1xuICAgICAgICB0ZVNodU51bTowLC8v54m55q6K54mM5Lq65pWwXG4gICAgICAgIC8vIFt7XG4gICAgICAgIC8vICAgICAnY2FyZHMnOlt7J3N1aXQnOnN1aXQsJ251bWJlcic6bnVtYmVyfSx7fV0sLy/nibnmrorniYzkuI3nlKjkvKBcbiAgICAgICAgLy8gICAgICd0eXBlJzowLFxuICAgICAgICAvLyAgICAgJ3ZhbHVlJzo0LFxuICAgICAgICAvLyAgICAgJ2lzQ29udGFpbkV4dHJhJzp0cnVlLC8vaXMgU3BlY2lhbCDnibnmrorniYzkvKBcbiAgICAgICAgLy8gICAgfSxcbiAgICAgICAgLy8gICAge1xuICAgICAgICAvLyAgICAgJ2NhcmRzJzpbeydzdWl0JzpzdWl0LCdudW1iZXInOm51bWJlcn0se31dLFxuICAgICAgICAvLyAgICAgJ3R5cGUnOjAsXG4gICAgICAgIC8vICAgICAndmFsdWUnOjRcbiAgICAgICAgLy8gICB9XVxuICAgICAgICBfdXNlcjogbnVsbCwgICAgICAgLy8g55So5LqO5q+U54mM55qE5pWw5o2uXG4gICAgICAgIF9jYXJkc0luZm86IG51bGwsXG4gICAgICAgIF9jb21wYXJlSW5kZXg6IDAsICAvLyDlsIbopoHmr5TovoPnmoQg57Si5byVICAwfjJcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2Rhb0xheW91dHMgPSBbdGhpcy50b3VMYXlvdXQsIHRoaXMuemhvbmdMYXlvdXQsIHRoaXMud2VpTGF5b3V0XTtcbiAgICAgICAgdGhpcy5fbGFiZWxTY29yZXMgPSBbW3RoaXMubGFiZWxUb3VTY29yZSwgdGhpcy5sYWJlbFRvdVNjb3JlUmlnaHRdLCBbdGhpcy5sYWJlbFpob25nU2NvcmUsIHRoaXMubGFiZWxaaG9uZ1Njb3JlUmlnaHRdLCBbdGhpcy5sYWJlbFdlaVNjb3JlLHRoaXMubGFiZWxXZWlTY29yZVJpZ2h0XV07XG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICBpZiAodGhpcy5fc2NvcmVzKSB7XG4gICAgICAgICAgICB0aGlzLnNldFNjb3Jlcyh0aGlzLl9zY29yZXMpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NvbXBhcmVJbmRleCA9IDA7XG4gICAgICAgIHRoaXMudGVTaHVMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gJyc7XG4gICAgICAgIHRoaXMubm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICBub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX3NldENhcmRzVG9MYXlvdXQ6IGZ1bmN0aW9uIChsYXlvdXQsIGNhcmRzKSB7XG4gICAgICAgIGxldCBub2RlID0gbGF5b3V0Lm5vZGU7XG4gICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoc3ByaXRlTm9kZSwgaW5kZXgpIHtcbiAgICAgICAgICAgIGxldCBzcHJpdGUgPSBzcHJpdGVOb2RlLmdldENvbXBvbmVudCgnY2MuU3ByaXRlJyk7XG4gICAgICAgICAgICBsZXQgY2FyZCA9IGNhcmRzW2luZGV4XTtcbiAgICAgICAgICAgIGlmICghY2FyZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEtRQ2FyZFJlc0hlbHBlci5zZXRDYXJkU3ByaXRlRnJhbWUoc3ByaXRlLCBjYXJkLmNhcmROYW1lKCkpO1xuICAgICAgICAgICAgc3ByaXRlTm9kZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcbiAgICAgICAgICAgIGlmKGNjLm1hUGFpKXtcbiAgICAgICAgICAgICAgICB2YXIgY2FyZE1hUGFpID0gJzNfJyArIGNjLm1hUGFpO1xuICAgICAgICAgICAgICAgIGlmKGNhcmQuY2FyZE5hbWUoKSA9PSBjYXJkTWFQYWkpe1xuICAgICAgICAgICAgICAgICAgICBzcHJpdGVOb2RlLmNvbG9yID0gbmV3IGNjLkNvbG9yKDIyNiwgMTQ1LCAxNDUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHNldENvbXBhcmVEYXRhOiBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICB0aGlzLl91c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy5fY2FyZHNJbmZvID0gdXNlci5jYXJkSW5mbztcbiAgICAgICAgbGV0IGNhcmRzSW5mbyA9IHVzZXIuY2FyZEluZm87XG4gICAgICAgIGxldCBjYXJkcyA9IGNhcmRzSW5mby5tYXAoZnVuY3Rpb24gKGNhcmRJbmZvSXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkSW5mb0l0ZW0uY2FyZHMpO1xuICAgICAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XG4gICAgICAgIH0sIFtdKTtcblxuXG4gICAgICAgIC8v54m55q6K54mMXG4gICAgICAgIHRoaXMudGVTaHVMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gJyc7XG4gICAgICAgIHRoaXMucE51bSA9IHVzZXIucGxheWVyTnVtOy8v546p5a625Lq65pWwXG4gICAgICAgIHRoaXMudGVTaHVUaW1lID0gdXNlci50ZVNodVRpbWU7Ly/nibnmrorniYzlh7rniYzpobrluo/kurrmlbBcbiAgICAgICAgdGhpcy50ZVNodU51bSA9IHVzZXIuVGVTaHVOdW07Ly/nibnmrorniYzkurrmlbBcbiAgICAgICAgbGV0IHNjb3JlcyA9IFt1c2VyLnNjb3JlMSB8fCAwLCB1c2VyLnNjb3JlMiB8fCAwLCB1c2VyLnNjb3JlMyB8fCAwXTtcbiAgICAgICAgdGhpcy5zZXRDYXJkcyhjYXJkcyk7XG4gICAgICAgIHRoaXMuc2V0U2NvcmVzKHNjb3Jlcyk7XG5cbiAgICB9LFxuXG4gICAgLy8g5LiL5LiA5Liq6KaB5q+U6L6D55qE5YiG5pWwXG4gICAgLy8g5aaC5p6c5rKh5pyJ6KaB5q+U6L6D55qE5LqG77yM5YiZ6L+U5ZueIDBcbiAgICBuZXh0Q29tcGFyZVNjb3JlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLl91c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF07XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGF0YS52YWx1ZTtcbiAgICB9LFxuXG4gICAgc2V0VGVTaHVDYXJkczogZnVuY3Rpb24gKGNhcmRzLGNhcmRzTmFtZXMpIHtcbiAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAgICAgICAgICAgIGlmKGNhcmQucG9pbnQgPT0gMTQpe1xuICAgICAgICAgICAgICAgIGNhcmQucG9pbnQgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICB2YXIgdGltZSA9ICgodGhpcy5wTnVtKSAtICh0aGlzLnRlU2h1TnVtKSkgKiAzICsgKHRoaXMudGVTaHVUaW1lKTsvLzMg5pivM+mBk+eJjOeahOaXtumXtFxuICAgICAgICBsZXQgdHlwZU5hbWUgPSBLUUNhcmQuY2FyZHNUeXBlTmFtZShjYXJkc05hbWVzKTtcbiAgICAgICAgaWYodHlwZU5hbWUgPT0gXCLkuInlkIzoirFcIiApe1xuICAgICAgICAgICAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnRlU2h1TGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy50ZVNodUxheW91dCwgY2FyZHMpO1xuICAgICAgICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gdHlwZU5hbWU7XG4gICAgICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0aGlzLl9jYXJkc0luZm9bMF0udHlwZSk7XG4gICAgICAgIH0sdGltZSk7XG5cbiAgICB9LFxuICAgIF9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lczogZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgICAgIC8vIFt7XCJzdWl0XCI6XCJzXCIsXCJudW1iZXJcIjoxMH1dXG4gICAgICAgIGxldCBzdWl0Q29sb3JNYXAgPVsnJywnZCcsJ2MnLCdoJywncyddO1xuICAgICAgICByZXR1cm4gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICB2YXIgY2FyZE51bWJlciA9IGNhcmQucG9pbnQ7XG4gICAgICAgICAgICBsZXQgY29sb3IgPSBzdWl0Q29sb3JNYXBbY2FyZC5jb2xvcl07XG4gICAgICAgICAgICBsZXQgbnVtYmVyID0gTWF0aC5tYXgoTWF0aC5taW4oY2FyZE51bWJlciwgMTMpLCAxKTtcbiAgICAgICAgICAgIHJldHVybiB7bnVtYmVyOm51bWJlcixzdWl0OmNvbG9yfTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBzZXRDYXJkczogZnVuY3Rpb24gKGNhcmRzKSB7XG5cbiAgICAgICAgLy8g5LiN5Lya5YaN5pyJ54m55q6K54mM5LqGXG4gICAgICAgIHRoaXMudGVTaHVMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcblxuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhID09IHRydWUpe1xuICAgICAgICAgICAgdmFyIGNhcmRzTmFtZXMgPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XG4gICAgICAgICAgICBpZiAoS1FDYXJkLmlzVGVTaHVQYWkoY2FyZHNOYW1lcykgJiYgY2MubW9zaGkgIT0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVTaHVDYXJkcyhjYXJkcyxjYXJkc05hbWVzKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIGxldCBjYXJkU3ByaXRlcyA9IHRoaXMuX2FsbENhcmRTcHJpdGVzKCk7XG4gICAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24gKGtxQ2FyZCwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmIChpbmRleCA+PSBjYXJkU3ByaXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBjYXJkU3ByaXRlID0gY2FyZFNwcml0ZXNbaW5kZXhdO1xuXG4gICAgICAgICAgICBLUUNhcmRSZXNIZWxwZXIubG9hZENhcmRTcHJpdGVGcmFtZShrcUNhcmQuY2FyZE5hbWUoKSwgZnVuY3Rpb24gKHNwcml0ZUZyYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FyZFNwcml0ZS5zcHJpdGVGcmFtZSA9IHNwcml0ZUZyYW1lO1xuICAgICAgICAgICAgICAgIGNhcmRTcHJpdGUubm9kZS5jb2xvciA9IG5ldyBjYy5Db2xvcigyNTUsIDI1NSwgMjU1KTtcbiAgICAgICAgICAgICAgICBpZihjYy5tYVBhaSl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYXJkTWFQYWkgPSAncHVibGljLXBpYy1jYXJkLXBva2VyLTNfJyArIGNjLm1hUGFpO1xuICAgICAgICAgICAgICAgICAgICBpZihzcHJpdGVGcmFtZS5uYW1lID09IGNhcmRNYVBhaSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJkU3ByaXRlLm5vZGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjI2LCAxNDUsIDE0NSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBzZXRTY29yZXM6IGZ1bmN0aW9uIChzY29yZXMpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xhYmVsU2NvcmVzID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX3Njb3JlcyA9IHNjb3JlcztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBzY29yZVN0cmluZ3MgPSBzY29yZXMubWFwIChmdW5jdGlvbiAoc2NvcmUpIHtcbiAgICAgICAgICAgIHNjb3JlID0gTnVtYmVyKHNjb3JlKTtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSAoc2NvcmUgPiAwKSA/IChcIisgXCIgKyBzY29yZSkgOiAoXCItIFwiICsgc2NvcmUgKiAtMSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcblxuICAgICAgICBzY29yZVN0cmluZ3MuZm9yRWFjaChmdW5jdGlvbiAoc3RyaW5nLCBpbmRleCkge1xuICAgICAgICAgICAgbGV0IGxhYmVscyA9IHRoaXMuX2xhYmVsU2NvcmVzW2luZGV4XTtcbiAgICAgICAgICAgIGxhYmVscy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICAgICAgICAgIGxhYmVsLnN0cmluZyA9IHN0cmluZztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBzaG93VG91Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy5fdXNlci5pc0NvbnRhaW5FeHRyYT09dHJ1ZSl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50b3VMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5zY29yZVN0eWxlID09IDEpIHtcbiAgICAgICAgICAgIHRoaXMubGFiZWxUb3VTY29yZVJpZ2h0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnNjb3JlU3R5bGUgPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5sYWJlbFRvdVNjb3JlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRvdVNjcm9lVGl0bGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvdVNjcm9lVGl0bGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdHlwZXMgPSB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlID09IDMgPyAzMzM6dGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZTtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlDYXJkVHlwZSh0aGlzLl91c2VyLnNleCwgdHlwZXMpO1xuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggKz0gMTtcblxuICAgIH0sXG5cbiAgICBzaG93WmhvbmdDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZih0aGlzLl91c2VyLmlzQ29udGFpbkV4dHJhPT10cnVlKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnpob25nTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuc2NvcmVTdHlsZSA9PSAxKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsWmhvbmdTY29yZVJpZ2h0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNjb3JlU3R5bGUgPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5sYWJlbFpob25nU2NvcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuemhvbmdTY3JvZVRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy56aG9uZ1Njcm9lVGl0bGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdHlwZXMgPSB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlID09IDYgPyA1NTU6dGhpcy5fY2FyZHNJbmZvW3RoaXMuX2NvbXBhcmVJbmRleF0udHlwZTtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlDYXJkVHlwZSh0aGlzLl91c2VyLnNleCwgdHlwZXMpO1xuICAgICAgICB0aGlzLl9jb21wYXJlSW5kZXggKz0gMTtcbiAgICB9LFxuXG4gICAgc2hvd1dlaUNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuX3VzZXIuaXNDb250YWluRXh0cmE9PXRydWUpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMud2VpTGF5b3V0Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuc2NvcmVTdHlsZSA9PSAxKSB7XG4gICAgICAgICAgICB0aGlzLmxhYmVsV2VpU2NvcmVSaWdodC5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zY29yZVN0eWxlID09IDApIHtcbiAgICAgICAgICAgIHRoaXMubGFiZWxXZWlTY29yZS5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy53ZWlTY3JvZVRpdGxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53ZWlTY3JvZVRpdGxlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUNhcmRUeXBlKHRoaXMuX3VzZXIuc2V4LCB0aGlzLl9jYXJkc0luZm9bdGhpcy5fY29tcGFyZUluZGV4XS50eXBlKTtcbiAgICAgICAgdGhpcy5fY29tcGFyZUluZGV4ICs9IDE7XG4gICAgfSxcblxuICAgIHNob3dOZXh0Q2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGFvTGF5b3V0cyA9IFt0aGlzLnRvdUxheW91dCwgdGhpcy56aG9uZ0xheW91dCwgdGhpcy53ZWlMYXlvdXRdO1xuICAgICAgICBsZXQgbGF5b3V0ID0gdGhpcy5fZGFvTGF5b3V0cy5maW5kKGZ1bmN0aW9uIChsYXlvdXQpIHtcbiAgICAgICAgICAgIHJldHVybiAhbGF5b3V0Lm5vZGUuYWN0aXZlO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAobGF5b3V0ID09IHRoaXMudG91TGF5b3V0KSB7XG4gICAgICAgICAgICB0aGlzLnNob3dUb3VDYXJkcygpO1xuICAgICAgICB9IGVsc2UgaWYgKGxheW91dCA9PSB0aGlzLnpob25nTGF5b3V0KSB7XG4gICAgICAgICAgICB0aGlzLnNob3daaG9uZ0NhcmRzKCk7XG4gICAgICAgIH0gZWxzZSBpZiAobGF5b3V0ID09IHRoaXMud2VpTGF5b3V0KSB7XG4gICAgICAgICAgICB0aGlzLnNob3dXZWlDYXJkcygpO1xuICAgICAgICB9XG5cbiAgICB9LFxuXG4gICAgX2NsZWFyQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY2xlYXJMYXlvdXRDYXJkcyh0aGlzLnRvdUxheW91dCk7XG4gICAgICAgIHRoaXMuX2NsZWFyTGF5b3V0Q2FyZHModGhpcy56aG9uZ0xheW91dCk7XG4gICAgICAgIHRoaXMuX2NsZWFyTGF5b3V0Q2FyZHModGhpcy53ZWlMYXlvdXQpO1xuICAgIH0sXG5cbiAgICBfY2xlYXJMYXlvdXRDYXJkczogZnVuY3Rpb24gKGxheW91dCkge1xuICAgICAgICB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQobGF5b3V0KS5mb3JFYWNoKGZ1bmN0aW9uIChzcHJpdGUpIHtcbiAgICAgICAgICAgIHNwcml0ZS5zcHJpdGVGcmFtZSA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfY2FyZFNwcml0ZXNXaXRoTGF5b3V0OiBmdW5jdGlvbiAobGF5b3V0KSB7XG4gICAgICAgIGxldCBub2RlID0gbGF5b3V0Lm5vZGU7XG4gICAgICAgIHJldHVybiBub2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdjYy5TcHJpdGUnKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9hbGxDYXJkU3ByaXRlczogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgdG91Q2FyZFNwcml0ZXMgPSB0aGlzLl9jYXJkU3ByaXRlc1dpdGhMYXlvdXQodGhpcy50b3VMYXlvdXQpO1xuICAgICAgICBsZXQgemhvbmdDYXJkU3ByaXRlcyA9IHRoaXMuX2NhcmRTcHJpdGVzV2l0aExheW91dCh0aGlzLnpob25nTGF5b3V0KTtcbiAgICAgICAgbGV0IHdlaUNhcmRTcHJpdGVzID0gdGhpcy5fY2FyZFNwcml0ZXNXaXRoTGF5b3V0KHRoaXMud2VpTGF5b3V0KTtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHRvdUNhcmRTcHJpdGVzLmNvbmNhdCh6aG9uZ0NhcmRTcHJpdGVzKS5jb25jYXQod2VpQ2FyZFNwcml0ZXMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sXG5cbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGFiZWxUaW1lOiBjYy5MYWJlbCxcblxuICAgICAgICBfY2FsbGJhY2s6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBcIjBcIjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog5byA5aeL5YCS6K6h5pe2XG4gICAgICogXG4gICAgICogQHBhcmFtICB7TnVtYmVyfSB0aW1lIOaXtumVv1xuICAgICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYWxsYmFjayDlgJLorqHml7bnmoTlm57osINcbiAgICAgKi9cbiAgICBzdGFydENvdW50ZG93bjogZnVuY3Rpb24odGltZSwgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG5cbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMubGFiZWxUaW1lLnN0cmluZyA9IFwiXCIgKyB0aW1lO1xuICAgICAgICB0aGlzLnNjaGVkdWxlKHRoaXMuX2NvdW50RG93biwgMSwgdGltZSk7XG4gICAgfSxcblxuICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5fY291bnREb3duKTtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIGlmICh0aGlzLl9jYWxsYmFjaykge1xuICAgICAgICAgICAgbGV0IGlzVGltZW91dCA9IE51bWJlcih0aGlzLmxhYmVsVGltZS5zdHJpbmcpIDw9IDA7XG4gICAgICAgICAgICBsZXQgY2FsbGJhY2sgPSB0aGlzLl9jYWxsYmFjaztcbiAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgICAgIGNhbGxiYWNrKGlzVGltZW91dCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IG51bGw7XG4gICAgfSxcblxuICAgIF9jb3VudERvd246IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdGltZSA9IE51bWJlcih0aGlzLmxhYmVsVGltZS5zdHJpbmcgfHwgXCIwXCIpO1xuICAgICAgICB0aW1lID0gdGltZSAtIDE7XG5cbiAgICAgICAgaWYgKHRpbWUgPD0gMCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmxhYmVsVGltZS5zdHJpbmcgPSBTdHJpbmcodGltZSk7XG4gICAgfSxcblxuXG59KTtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5cbmxldCBSZXN1bHRTdGF0dXMgPSB7XG4gIFdJTjogMixcbiAgRFJBVzogMSxcbiAgTE9TRTogMCxcbn07XG5cblxubGV0IEdhbWVSZXN1bHQgPSBjYy5DbGFzcyh7XG4gIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICBwcm9wZXJ0aWVzOiB7XG4gICAgd2luTm9kZTogY2MuTm9kZSxcbiAgICBsb3NlTm9kZTogY2MuTm9kZSxcbiAgICBkcmF3Tm9kZTogY2MuTm9kZSxcbiAgICBjb250ZW50Tm9kZTogY2MuTm9kZSxcblxuICAgIHJlc3VsdEl0ZW1zOiBbY2MuTm9kZV0sXG5cbiAgICBfZGVza0luZm86IG51bGwsXG4gICAgX3VzZXJJZDogbnVsbCxcbiAgICBfY2xvc2VDYWxsYmFjazogbnVsbCxcbiAgfSxcblxuICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5faGlkZVJlc3VsdEl0ZW1zKCk7XG4gIH0sXG5cbiAgc2hvd1Jlc3VsdHM6IGZ1bmN0aW9uIChkZXNrSW5mbywgY3VycmVudFVzZXJJZCkge1xuICAgIHRoaXMuX2Rlc2tJbmZvID0gZGVza0luZm87XG4gICAgdGhpcy5fdXNlcklkID0gY3VycmVudFVzZXJJZDtcblxuICAgIGxldCByZXN1bHRTdGF0dXMgPSB0aGlzLl9yZXN1bHRTdGF0dXMoKTtcbiAgICB0aGlzLmNvbnRlbnROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgdGhpcy53aW5Ob2RlLmFjdGl2ZSA9ICAocmVzdWx0U3RhdHVzID09IFJlc3VsdFN0YXR1cy5XSU4pO1xuICAgIHRoaXMuZHJhd05vZGUuYWN0aXZlID0gKHJlc3VsdFN0YXR1cyA9PSBSZXN1bHRTdGF0dXMuRFJBVyk7XG4gICAgdGhpcy5sb3NlTm9kZS5hY3RpdmUgPSAocmVzdWx0U3RhdHVzID09IFJlc3VsdFN0YXR1cy5MT1NFKTtcblxuICAgIGlmICh0aGlzLndpbk5vZGUuYWN0aXZlKSB7XG4gICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheVdpbigpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5sb3NlTm9kZS5hY3RpdmUpIHtcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5TG9zZSgpO1xuICAgIH1cblxuICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnNldERpc21pc3NDYWxsYmFjayhmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9jbG9zZUNhbGxiYWNrXG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIGxldCBwbGF5ZXJJbmZvcyA9IGRlc2tJbmZvLnBsYXllcnMuc29ydChmdW5jdGlvbiAocDEsIHAyKSB7XG4gICAgICByZXR1cm4gcDIuY1Njb3JlIC0gcDEuY1Njb3JlO1xuICAgIH0pO1xuICAgIGxldCBpdGVtQ29tcHMgPSB0aGlzLnJlc3VsdEl0ZW1zLm1hcChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgcmV0dXJuIG5vZGUuZ2V0Q29tcG9uZW50KCdSZXN1bHRJdGVtJyk7XG4gICAgfSk7XG4gICAgaXRlbUNvbXBzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW1Db21wLCBpbmRleCkge1xuICAgICAgaXRlbUNvbXAubm9kZS5hY3RpdmUgPSBpbmRleCA8IHBsYXllckluZm9zLmxlbmd0aDtcbiAgICAgIGlmICghaXRlbUNvbXAubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlciA9IHBsYXllckluZm9zW2luZGV4XTtcbiAgICAgIGl0ZW1Db21wLnVwZGF0ZVdpdGhQbGF5ZXJJbmZvKHVzZXIsIGRlc2tJbmZvLmlzUmFuZG9tRGVzayk7XG4gICAgICBsZXQgY2FyZHMgPSB0aGlzLl9jYXJkc0Zyb21Vc2VyKHVzZXIpO1xuICAgICAgaXRlbUNvbXAuc2V0Q2FyZHMoY2FyZHMpO1xuICAgIH0uYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgc2V0Q2xvc2VDYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5fY2xvc2VDYWxsYmFjayA9IGNhbGxiYWNrO1xuICB9LFxuXG4gIF9jYXJkc0Zyb21Vc2VyOiBmdW5jdGlvbiAodXNlcikge1xuICAgIGxldCBjYXJkcyA9IHVzZXIuY2FyZEluZm8ubWFwKGZ1bmN0aW9uIChjYXJkSW5mb0l0ZW0pIHtcbiAgICAgIHJldHVybiBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZEluZm9JdGVtLmNhcmRzKTtcbiAgICB9KS5yZWR1Y2UoZnVuY3Rpb24gKGFycmF5LCBzdWJDYXJkcykge1xuICAgICAgcmV0dXJuIGFycmF5LmNvbmNhdChzdWJDYXJkcyk7XG4gICAgfSwgW10pO1xuXG4gICAgcmV0dXJuIGNhcmRzO1xuICB9LFxuXG4gIF9oaWRlUmVzdWx0SXRlbXM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJlc3VsdEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgIG5vZGUuYWNpdHZlID0gZmFsc2U7XG4gICAgfSk7XG4gIH0sXG5cbiAgX3Jlc3VsdFN0YXR1czogZnVuY3Rpb24oKSB7XG4gICAgbGV0IHBsYXllckluZm9zID0gdGhpcy5fZGVza0luZm8ucGxheWVycztcbiAgICBsZXQgdXNlciA9IHBsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgIHJldHVybiB1c2VyLmlkID09IHRoaXMuX3VzZXJJZDtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgbGV0IHNjb3JlID0gdXNlci5jU2NvcmU7XG4gICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzUmFuZG9tRGVzaykge1xuICAgICAgLy8g5aaC5p6c5piv6ZqP5py65Zy655qE6K+d77yM5bqU6K+l55So6ZK755+z5p2l5Yik5pat6L6T6LWiXG4gICAgICBzY29yZSA9IHVzZXIuZGlhbW9uZDtcbiAgICB9XG5cbiAgICBpZiAoc2NvcmUgPiAwKSB7XG4gICAgICByZXR1cm4gUmVzdWx0U3RhdHVzLldJTjtcbiAgICB9IGVsc2UgaWYgKHNjb3JlIDwgMCkge1xuICAgICAgcmV0dXJuIFJlc3VsdFN0YXR1cy5MT1NFO1xuICAgIH1cblxuICAgIHJldHVybiBSZXN1bHRTdGF0dXMuRFJBVztcbiAgfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVSZXN1bHQ7XG4iLCIvKiMjIyMjKi9cclxuLy/vv73vv73vv73vv73vv73vv73vv73vv73Su++/ve+/ve+/ve+/ve+/ve+/ve+/ve+/ve+/vdq177+977+977+9zazvv73vv73vv73vv73vv73vv73vv73Gte+/ve+/ve+/ve+/ve+/vVxyXG4gdmFyIEdldENhcmRQb2ludHNTYW1lQ291bnQgPSBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgIHRoaXMuY2FyZE51bWJlcnMgPSB7fTtcclxuICAgIGZvcih2YXIgaSBpbiBjYXJkcyl7XHJcbiAgICAgICAgdmFyIHM7XHJcbiAgICAgICAgaWYodHlwZW9mKGNhcmRzW2ldLm51bWJlcikgPT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICAgICBzID0gY2FyZHNbaV0ucG9pbnQ7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHMgPSBjYXJkc1tpXS5udW1iZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuY2FyZE51bWJlcnNbc10pe1xyXG4gICAgICAgICAgICB0aGlzLmNhcmROdW1iZXJzW3NdICsrO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLmNhcmROdW1iZXJzW3NdID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9jYy5sb2codGhpcy5jYXJkTnVtYmVyc1tjYXJkc1tpXS5udW1iZXJdKVxyXG4gICAgICAgIC8vY2MubG9nKGNhcmRzKVxyXG4gICAgICAgIC8vY2MubG9nKGNhcmRzW2ldLm51bWJlcilcclxuICAgICAgICAvL2NjLmxvZygnLS0tNycpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5jYXJkTnVtYmVycztcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR2V0Q2FyZFBvaW50c1NhbWVDb3VudDtcclxuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbE51bWJlcnM6IFtjYy5MYWJlbF0sXG4gICAgICAgIGNhbGxiYWNrSm9pblJvb206IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jbGlja0NsZWFyKCk7XG4gICAgfSxcblxuICAgIGNsaWNrTnVtYmVyOiBmdW5jdGlvbiAoZXZlbnQsIG51bWJlcikge1xuICAgICAgdmFyIGxhYmVsID0gdGhpcy5fbGFzdEVtcHR5TGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBudW1iZXI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBsZXQgaXNDb21wbGV0ZSA9ICh0aGlzLl9sYXN0RW1wdHlMYWJlbCgpID09IG51bGwpO1xuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuX3Jvb21OdW1iZXIoKTtcbiAgICAgIGlmIChpbnZpdGVOdW1iZXIubGVuZ3RoID09IDYpIHtcbiAgICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gaW52aXRlTnVtYmVyO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBzZW5kQ29kZSA6ZnVuY3Rpb24oKXsgIC8v5Y+R6YCB6YKA6K+356CBXG4gICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgbGV0IGludml0ZU51bWJlciA9IHRoaXMuY2FsbGJhY2tKb2luUm9vbTtcbiAgICAgIGNvbnNvbGUubG9nKGludml0ZU51bWJlciAsXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cIik7XG4gICAgICBpZiggaW52aXRlTnVtYmVyLmxlbmd0aD09Nil7ICBcbiAgICAgICAgU29ja2V0LnNlbmRJbnZpdGVDb2RlKGludml0ZU51bWJlciwgdXNlcklkKTtcbiAgICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gJyc7ICAgLy/muIXnqbrpgoDor7fnoIFcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tDbGVhcjogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYWxsYmFja0pvaW5Sb29tID0gJyc7XG4gICAgICB0aGlzLmxhYmVsTnVtYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIGNsaWNrRGVsZXRlT25lOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgbGFiZWwgPSB0aGlzLl9sYXN0TnVtYmVyTGFiZWwoKTtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5zdHJpbmcgPSBcIlwiO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBfbGFzdEVtcHR5TGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4IGluIHRoaXMubGFiZWxOdW1iZXJzKSB7XG4gICAgICAgIHZhciBsYWJlbCA9IHRoaXMubGFiZWxOdW1iZXJzW2luZGV4XTtcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyA9PSBudWxsXG4gICAgICAgIHx8IGxhYmVsLnN0cmluZy5sZW5ndGggPD0gMCkge1xuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9sYXN0TnVtYmVyTGFiZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGluZGV4ID0gdGhpcy5sYWJlbE51bWJlcnMubGVuZ3RoIC0gMTsgaW5kZXggPj0gMDsgLS1pbmRleCkge1xuICAgICAgICBsZXQgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgJiYgbGFiZWwuc3RyaW5nLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSxcblxuICAgIF9yb29tTnVtYmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYWJlbE51bWJlcnMucmVkdWNlKGZ1bmN0aW9uIChyb29tTnVtYmVyLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gcm9vbU51bWJlciArIChsYWJlbC5zdHJpbmcgfHwgXCJcIik7XG4gICAgICB9LCBcIlwiKTtcbiAgICB9LFxufSk7XG4iLCIvLyDniYzoirHoibLluK7liqnnsbtcbi8vIOeUqOS6juiuoeeul+S4gOS4queJjOaVsOe7hOeahOiKseiJsuebuOWQjOeahOeJjOeahOW8oOaVsFxudmFyIEtRQ2FyZENvbG9yc0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xuICB0aGlzLmNvbG9yTnVtYmVyID0ge307XG5cbiAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xuICAgIGxldCBjb2xvciA9IGNhcmQuY29sb3I7XG4gICAgdmFyIG51bWJlciA9IHRoaXMuY29sb3JOdW1iZXJbY29sb3JdIHx8IDA7XG4gICAgdGhpcy5jb2xvck51bWJlcltjb2xvcl0gPSBudW1iZXIgKyAxO1xuICB9LmJpbmQodGhpcykpO1xufTtcblxuLy8g55u45ZCM6Iqx6Imy55qE54mM55qE5pyA5aSn5pWw6YePXG5LUUNhcmRDb2xvcnNIZWxwZXIucHJvdG90eXBlLm1heE51bWJlciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJlc3VsdCA9IDA7XG4gIGZvciAobGV0IHByb3AgaW4gdGhpcy5jb2xvck51bWJlcikge1xuICAgIGxldCBudW1iZXIgPSB0aGlzLmNvbG9yTnVtYmVyW3Byb3BdO1xuICAgIHJlc3VsdCA9IE1hdGgubWF4KG51bWJlciwgcmVzdWx0KTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZENvbG9yc0hlbHBlcjtcbiIsImNvbnN0IEtRQ2FyZCA9IHJlcXVpcmUoJ0tRQ2FyZCcpO1xuY29uc3QgQXJyYXlFeHRlbnNpb24gPSByZXF1aXJlKCdBcnJheUV4dGVuc2lvbicpO1xuY29uc3QgS1FDYXJkUG9pbnRzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkUG9pbnRzSGVscGVyJyk7XG5cbm1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIOWvu+aJviBjYXJkTW9kZXMg5Lit55qEIOWvueWtkFxuLy8g6L+Z5Lya6L+U5ZueIOWvueWtkCDnmoTntKLlvJXmlbDnu4Rcbi8vIOWmgu+8mltbMSwgM10sIFs0LCA1XV1cbktRQ2FyZC5maW5kRHVpWmkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIGxldCBzRHVpWmlJbmRleHMgPSBLUUNhcmQuZmluZFNhblRpYW8oY2FyZE1vZGVzKSB8fCBbXTtcbiAgbGV0IHJlc3VsdCA9IEtRQ2FyZC5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgMikgfHwgW107XG4gIGlmKHJlc3VsdC5sZW5ndGggPCAyICl7XG4gICAgaWYoc0R1aVppSW5kZXhzLmxlbmd0aCA+IDApe1xuICAgICAgc0R1aVppSW5kZXhzLmZvckVhY2goZnVuY3Rpb24oaW5kZXhzKSB7XG4gICAgICAgIHZhciBzMSA9IFtpbmRleHNbMF0saW5kZXhzWzFdXTtcbiAgICAgICAgLy92YXIgczIgPSBbaW5kZXhzWzFdLGluZGV4c1syXV07XG4gICAgICAgIC8vcmVzdWx0LnB1c2goczIpO1xuICAgICAgICByZXN1bHQucHVzaChzMSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdmFyIHRyZXN1bHQgPSBLUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMik7XG4gICAgZm9yKHZhciBpID0gMDtpIDwgdHJlc3VsdC5sZW5ndGg7aSsrKXtcbiAgICAgIHJlc3VsdC5wdXNoKHRyZXN1bHRbaV0pO1xuICAgIH1cbiAgfVxuXG4gIHJlc3VsdCA9IEtRQ2FyZC5yZXBlYXQocmVzdWx0KTtcblxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbktRQ2FyZC5fZmluZFBvaW50TGVuZ3RoID0gZnVuY3Rpb24gKGNhcmRNb2RlcywgbGVuZ3RoKSB7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgbGV0IG9iaiA9IGNhcmRNb2Rlcy5yZWR1Y2UoZnVuY3Rpb24ob2JqLCBjYXJkLCBpbmRleCkge1xuICAgIGxldCBwb2ludEluZGV4cyA9IG9ialtjYXJkLnBvaW50XSB8fCBbXTtcbiAgICBvYmpbY2FyZC5wb2ludF0gPSBwb2ludEluZGV4cztcbiAgICBwb2ludEluZGV4cy5wdXNoKGluZGV4KTtcbiAgICByZXR1cm4gb2JqO1xuICB9LCB7fSk7XG5cbiAgbGV0IHJlc3VsdCA9IFtdO1xuICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgIGxldCBwb2ludEluZGV4cyA9IG9ialtwcm9wXTtcbiAgICBpZiAocG9pbnRJbmRleHMubGVuZ3RoID09IGxlbmd0aCkge1xuICAgICAgcG9pbnRJbmRleHMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgICAgfSk7XG4gICAgICByZXN1bHQucHVzaChwb2ludEluZGV4cyk7XG4gICAgfVxuICB9XG5cbiAgcmVzdWx0LnNvcnQoZnVuY3Rpb24gKGFycjEsIGFycjIpIHtcbiAgICBsZXQgbjEgPSBhcnIxWzBdO1xuICAgIGxldCBuMiA9IGFycjJbMF07XG4gICAgcmV0dXJuIG4yIC0gbjE7XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBbXTtcbn07XG5cbi8vIOaJviDkuKTlr7kg55qE57Si5byV5pWw57uEXG4vLyDlpoLvvJpbWzEsIDIsIDMsIDRdLCBbNSwgNiwgNywgOF1dXG5LUUNhcmQuZmluZExpYUR1aSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgbGV0IGR1aVppSW5kZXhzID0gS1FDYXJkLmZpbmREdWlaaShjYXJkTW9kZXMpIHx8IFtdO1xuICBsZXQgZHVpWmlJbmRleCA9IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2RlcywyKSB8fCBbXTtcblxuICBpZihkdWlaaUluZGV4cy5sZW5ndGggPCAxICYmIGR1aVppSW5kZXgubGVuZ3RoID4gMCl7XG4gICAgZHVpWmlJbmRleC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICBkdWlaaUluZGV4cy51bnNoaWZ0KGluZGV4cyk7XG4gICAgfSk7XG4gIH1cbiAgaWYgKGR1aVppSW5kZXhzLmxlbmd0aCA8IDIpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgcmVzdWx0ID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZHVpWmlJbmRleHMubGVuZ3RoOyArK2kpIHtcbiAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBkdWlaaUluZGV4cy5sZW5ndGg7ICsraikge1xuICAgICAgaWYocmVzdWx0Lmxlbmd0aCA8IDEwKXtcbiAgICAgICAgbGV0IHByZSA9IGR1aVppSW5kZXhzW2ldO1xuICAgICAgICBsZXQgbmV4dCA9IGR1aVppSW5kZXhzW2pdO1xuICAgICAgICB2YXIgcyA9IHByZS5jb25jYXQobmV4dCk7XG4gICAgICAgIHZhciBuZXdTID0gW107XG4gICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IHMubGVuZ3RoIDtxKyspe1xuICAgICAgICAgIGlmKG5ld1MuaW5kZXhPZihzW3FdKSA9PSAtMSl7XG4gICAgICAgICAgICBuZXdTLnB1c2goc1txXSk7XG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYobmV3Uy5sZW5ndGggPT0gNCl7XG4gICAgICAgICAgbmV3Uy5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJlc3VsdC51bnNoaWZ0KG5ld1MpO1xuICAgICAgICB9XG4gICAgICB9ZWxzZXtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cblxuICAgIH1cbiAgfVxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XG4gIGlmKHJlc3VsdC5sZW5ndGggPiA2KXtcbiAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCw2KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuLy8g5om+5LiJ5p2hXG4vLyDlpoLvvJpbWzEsIDIsIDNdXTtcbktRQ2FyZC5maW5kU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgaWYoY2FyZE1vZGVzLmxlbmd0aCA8IDMpe1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBsZXQgcmVzdWx0ID0gS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCAzKSB8fCBbXTtcbiAgLy9mb3IodmFyIHEgPTA7cTxyZXN1bHQubGVuZ3RoO3ErKyl7XG4gIC8vICB2YXIgaW5kZXhzID0gcmVzdWx0W3FdWzBdO1xuICAvLyAgaWYoY2FyZE1vZGVzW2luZGV4c10ucG9pbnQgPj0gMjApe1xuICAvLyAgICByZXN1bHQuc3BsaWNlKHEsMSk7XG4gIC8vICB9XG4gIC8vfVxuICBpZihyZXN1bHQubGVuZ3RoIDwgMiApe1xuICAgIGxldCB0aWVaaGlJbmRleHNBcnJheSA9IEtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2Rlcyk7XG4gICAgaWYodGllWmhpSW5kZXhzQXJyYXkubGVuZ3RoID4gMCl7XG4gICAgICB0aWVaaGlJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czIgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMzID0gW2luZGV4c1swXSwgaW5kZXhzWzJdLCBpbmRleHNbM11dO1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICAgIHJlc3VsdC5wdXNoKHNhblRpYW9JbmRleHMwKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMSk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czIpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMzKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICB2YXIgdHJlc3VsdCA9IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2RlcywzKTtcbiAgICBmb3IodmFyIGkgPSAwO2kgPCB0cmVzdWx0Lmxlbmd0aDtpKyspe1xuICAgICAgcmVzdWx0LnB1c2godHJlc3VsdFtpXSk7XG4gICAgfVxuICB9XG4gIC8qaWYocmVzdWx0Lmxlbmd0aCA8IDEpe1xuICAgIC8vIOmTgeaUr+aYr+WMheWQq+S4ieadoeeahFxuICAgIGxldCB0aWVaaGlJbmRleHNBcnJheSA9IEtRQ2FyZC5maW5kVGllWmhpKGNhcmRNb2Rlcyk7XG4gICAgaWYgKHRpZVpoaUluZGV4c0FycmF5KSB7XG4gICAgICB0aWVaaGlJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czIgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1szXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMzID0gW2luZGV4c1swXSwgaW5kZXhzWzJdLCBpbmRleHNbM11dO1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICAgIHJlc3VsdC5wdXNoKHNhblRpYW9JbmRleHMwKTtcbiAgICAgICAgLy9yZXN1bHQudW5zaGlmdChzYW5UaWFvSW5kZXhzMSk7XG4gICAgICAgIC8vcmVzdWx0LnVuc2hpZnQoc2FuVGlhb0luZGV4czIpO1xuICAgICAgICAvL3Jlc3VsdC51bnNoaWZ0KHNhblRpYW9JbmRleHMzKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSovXG5cbiAgLy9pZihyZXN1bHQubGVuZ3RoID4gMTApe1xuICAvLyAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsMTApO1xuICAvL31cblxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7XG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuLy8g5om+5ZCM6Iqx6aG6XG5LUUNhcmQuZmluZFRvbmdIdWFTaHVuID0gZnVuY3Rpb24gKGNhcmRNb2RlcywgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBsZXQgcmVzdWx0ID0gW107XG4gIHZhciBzYW5TaHVuWmkgPSBLUUNhcmQuc2FuU2h1blppMShjYXJkTW9kZXMsbGVuZ3RoKTtcbiAgaWYoc2FuU2h1blppWzBdID09IG51bGwpe1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBmb3IodmFyIGk9MDtpPHNhblNodW5aaVswXS5sZW5ndGg7aSsrKSB7XG4gICAgdmFyIHMgPSBzYW5TaHVuWmlbMF1baV07XG4gICAgaWYgKEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHMsIGxlbmd0aCkpIHtcbiAgICAgIHJlc3VsdC5wdXNoKHNhblNodW5aaVsxXVtpXSk7XG5cbiAgICB9XG4gIH1cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHRcbiAgfWVsc2V7XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4xKGNhcmRNb2Rlcyk7XG4gIH1cbn07XG5LUUNhcmQuZmluZFRvbmdIdWFTaHVuMSA9IGZ1bmN0aW9uIChjYXJkcywgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gIHZhciBjb2xvclMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gIHZhciBjb2xvckQgPSBbXTsgLy/mlrnlnZdcbiAgdmFyIHBvaW50UyA9IFtdOyAvL+m7keahg1xuICB2YXIgcG9pbnRIID0gW107IC8v57qi5b+DXG4gIHZhciBwb2ludEMgPSBbXTsgLy/mooXoirFcbiAgdmFyIHBvaW50RCA9IFtdOyAvL+aWueWdl1xuICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xuICAgIGlmKGNhcmRzW2ldLmNvbG9yID09ICc0Jyl7XG4gICAgICBpZihwb2ludFMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludFMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yUy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cblxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICczJyl7XG4gICAgICBpZihwb2ludEguaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEgucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9ySC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMicpe1xuICAgICAgaWYocG9pbnRDLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRDLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzEnKXtcbiAgICAgIGlmKHBvaW50RC5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50RC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBjb2xvciA9IFtjb2xvclMsY29sb3JILGNvbG9yQyxjb2xvckRdO1xuICB2YXIgY29sb3JTdW0gPSBbXTsgICAgLy/mgLvlhbHmnInlh6Dnp43oirHoibIgWzUsMywwLi4uLl1cbiAgZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcbiAgICBpZihjb2xvcltpXS5sZW5ndGggPj0gNSl7XG4gICAgICBjb2xvcltpXS5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgICAgcmV0dXJuIGExLnBvaW50IC0gYTIucG9pbnQ7XG4gICAgICB9KVxuICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgfVxuICB9XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBpPTA7aTxjb2xvclN1bS5sZW5ndGg7aSsrKSB7XG4gICAgdmFyIHMgPSBjb2xvclN1bVtpXVxuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgNSkgPD0gcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgIHZhciBzdWJDYXJkcyA9IHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgNSk7XG4gICAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YVNodW4oc3ViQ2FyZHMpKSB7XG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgc3ViQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYSkge1xuICAgICAgICAgIGZvcih2YXIgcSA9IDA7cSA8IGNhcmRzLmxlbmd0aDsgcSsrKXtcbiAgICAgICAgICAgIHZhciByID0gY2FyZHNbcV07XG4gICAgICAgICAgICBpZihyID09PSBjYSl7XG4gICAgICAgICAgICAgIGluZGV4cy5wdXNoKHEpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlQb2ludCk7XG4gICAgICAgIHJlc3VsdC51bnNoaWZ0KGluZGV4cyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1lbHNle1xuICAgIGxldCBjb252ZXJ0ZWRDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQTEoY2FyZHMpO1xuICAgIGlmIChjYXJkcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgIGNhcmRzLmZvckVhY2goZnVuY3Rpb24oYWRmcyl7XG4gICAgICAgIGlmKGFkZnMucG9pbnQgPT0gMTQpe1xuICAgICAgICAgIGFkZnMucG9pbnQgPSAxO1xuICAgICAgICAgIGFkZnMuc2NvcmVzID0gMTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHJldHVybiBLUUNhcmQuZmluZFRvbmdIdWFTaHVuMjAoY2FyZHMpO1xuICAgIH1cbiAgICByZXR1cm4gS1FDYXJkLmZpbmRUb25nSHVhU2h1bjEoY29udmVydGVkQ2FyZHMpO1xuICB9XG4gIC8vcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogbnVsbDtcbn07XG5LUUNhcmQuZmluZFRvbmdIdWFTaHVuMjAgPSBmdW5jdGlvbiAoY2FyZCwgbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZC5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZCkgfHwgW107XG4gIHZhciBjYXJkcyA9IGNhcmQua3FfZXhjbHVkZXMoY2FyZDIwKTtcblxuICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgdmFyIGNvbG9yQyA9IFtdOyAvL+aiheiKsVxuICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gIHZhciBwb2ludFMgPSBbXTsgLy/pu5HmoYNcbiAgdmFyIHBvaW50SCA9IFtdOyAvL+e6ouW/g1xuICB2YXIgcG9pbnRDID0gW107IC8v5qKF6IqxXG4gIHZhciBwb2ludEQgPSBbXTsgLy/mlrnlnZdcbiAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xuICAgICAgaWYocG9pbnRTLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRTLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG5cbiAgICB9ZWxzZSBpZihjYXJkc1tpXS5jb2xvciA9PSAnMycpe1xuICAgICAgaWYocG9pbnRILmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgcG9pbnRILnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICB9XG4gICAgfWVsc2UgaWYoY2FyZHNbaV0uY29sb3IgPT0gJzInKXtcbiAgICAgIGlmKHBvaW50Qy5pbmRleE9mKGNhcmRzW2ldLnBvaW50KSA9PSAtMSl7XG4gICAgICAgIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgY29sb3JDLnB1c2goY2FyZHNbaV0pO1xuICAgICAgfVxuICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XG4gICAgICBpZihwb2ludEQuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICBwb2ludEQucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgIGNvbG9yRC5wdXNoKGNhcmRzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gIGZvcih2YXIgaT0wO2k8Y29sb3IubGVuZ3RoO2krKyl7XG4gICAgaWYoY29sb3JbaV0ubGVuZ3RoID49IHBhcnNlSW50KDUgLSBjYXJkMjAubGVuZ3RoKSl7XG4gICAgICBjb2xvcltpXS5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgICAgcmV0dXJuIGExLnBvaW50IC0gYTIucG9pbnQ7XG4gICAgICB9KVxuICAgICAgY29sb3JTdW0ucHVzaChjb2xvcltpXSk7XG4gICAgfVxuICB9XG4gIGNjLmxvZyhjb2xvclN1bSlcblxuICB2YXIgcmVzdWx0ID0gW107XG4gIGZvcih2YXIgaT0wO2k8Y29sb3JTdW0ubGVuZ3RoO2krKykge1xuICAgIHZhciBzID0gY29sb3JTdW1baV1cbiAgICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuICAgICAgdmFyIG51bSA9IDUgLSBqO1xuICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICAgIHZhciBzdWJDYXJkcyA9IHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiAgICAgICAgdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3Njb3JlcyddKSAtIHBhcnNlSW50KHN1YkNhcmRzWzBdWydzY29yZXMnXSkgPCA1O1xuICAgICAgICBpZihib29sKXtcbiAgICAgICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICAgICAgdmFyIG5ld0NhcmQyMCA9IGNhcmQyMC5zbGljZSgwLGopO1xuICAgICAgICAgIHN1YkNhcmRzID0gc3ViQ2FyZHMuY29uY2F0KG5ld0NhcmQyMCk7XG4gICAgICAgICAgc3ViQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYSkge1xuICAgICAgICAgICAgZm9yKHZhciBxID0gMDtxIDwgY2FyZC5sZW5ndGg7IHErKyl7XG4gICAgICAgICAgICAgIHZhciByID0gY2FyZFtxXTtcbiAgICAgICAgICAgICAgaWYociA9PT0gY2Epe1xuICAgICAgICAgICAgICAgIGluZGV4cy5wdXNoKHEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuXG4gICAgICAgICAgcmVzdWx0LnVuc2hpZnQoaW5kZXhzKTtcblxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGNjLmxvZyhyZXN1bHQpXG4gIGNjLmxvZygnLS0tLS0tLS0zNTcnKVxuICBpZihyZXN1bHQubGVuZ3RoID4gMCl7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfWVsc2V7XG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkKTtcbiAgICBpZiAoY2FyZCA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4yMChjb252ZXJ0ZWRDYXJkcyk7XG4gIH1cbiAgLy9yZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBudWxsO1xufTtcblxuLy8g5om+6ZOB5pSvXG4vLyDlpoLvvJpbWzEsMiwzLDRdXVxuS1FDYXJkLmZpbmRUaWVaaGkgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIHZhciByZXN1bHQgPSAgS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCA0KTtcbiAgaWYocmVzdWx0Lmxlbmd0aCA+IDApe1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgcmVzdWx0ID0gW107XG4gIC8vIOS6lOWQjOaYr+WMheWQq+mTgeaUr+eahFxuICBsZXQgd3VUb25nSW5kZXhzQXJyYXkgPSBLUUNhcmQuZmluZFd1VG9uZyhjYXJkTW9kZXMpO1xuICBpZiAod3VUb25nSW5kZXhzQXJyYXkpIHtcbiAgICB3dVRvbmdJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgbGV0IHRpZVpoaUluZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV0sIGluZGV4c1syXSwgaW5kZXhzWzNdXTtcbiAgICAgIGxldCB0aWVaaGlJbmRleHMxID0gW2luZGV4c1swXSwgaW5kZXhzWzFdLCBpbmRleHNbMl0sIGluZGV4c1s0XV07XG4gICAgICBsZXQgdGllWmhpSW5kZXhzMiA9IFtpbmRleHNbMF0sIGluZGV4c1sxXSwgaW5kZXhzWzNdLCBpbmRleHNbNF1dO1xuICAgICAgbGV0IHRpZVpoaUluZGV4czMgPSBbaW5kZXhzWzBdLCBpbmRleHNbMl0sIGluZGV4c1szXSwgaW5kZXhzWzRdXTtcbiAgICAgIGxldCB0aWVaaGlJbmRleHM0ID0gW2luZGV4c1sxXSwgaW5kZXhzWzJdLCBpbmRleHNbM10sIGluZGV4c1s0XV07XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMwKTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czEpO1xuICAgICAgcmVzdWx0LnB1c2godGllWmhpSW5kZXhzMik7XG4gICAgICByZXN1bHQucHVzaCh0aWVaaGlJbmRleHMzKTtcbiAgICAgIHJlc3VsdC5wdXNoKHRpZVpoaUluZGV4czQpO1xuICAgIH0pO1xuICB9XG4gIGlmKHJlc3VsdC5sZW5ndGggPiAxMCl7XG4gICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsMTApO1xuICB9XG4gIHJlc3VsdCA9IEtRQ2FyZC5yZXBlYXQocmVzdWx0KTtcbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDQpO1xufTtcbi8v5om+5LqU5ZCMXG5LUUNhcmQuZmluZFd1VG9uZyA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgaWYoY2FyZE1vZGVzLmxlbmd0aCA8IDUpe1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB2YXIgcmVzdWx0ID0gdGhpcy5fZmluZFBvaW50TGVuZ3RoKGNhcmRNb2RlcywgNSkgfHwgW107XG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IEtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2Rlcyw1KTtcbn07XG4vLyDmib7pobrlrZBcbi8vIOWmgu+8mltbMSwgMiwgMywgNCwgNV1dXG5LUUNhcmQuZmluZFNodW5aaSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsbGVuZ3RoID0gNSkge1xuICBpZiAoY2FyZE1vZGVzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBpZih0eXBlb2YoY2FyZE1vZGVzWzBdWydwb2ludCddKT09XCJ1bmRlZmluZWRcIil7XG4gICAgY2FyZE1vZGVzID0gS1FDYXJkLmNhcmRzRnJvbUFycmF5KGNhcmRNb2Rlcyk7XG4gIH1cbiAgLy8g5YWI5qC55o2u54K55pWw5Y676YeNXG4gIGxldCB1bmlxdWVDYXJkcyA9IGNhcmRNb2Rlcy51bmlxdWUoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgcmV0dXJuIGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50O1xuICB9KTtcbiAgdW5pcXVlQ2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpO1xuXG4gIC8vIOWmguaenOaciSBB77yM5YiZ5Zyo5pyA5ZCO5re75YqgIDE0XG4gIGxldCBjYXJkQSA9IGNhcmRNb2Rlcy5maW5kKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgcmV0dXJuIGNhcmQucG9pbnQgPT0gMTtcbiAgfSk7XG4gIGlmIChjYXJkQSkge1xuICAgIGxldCBjYXJkQVBsdXMgPSBuZXcgS1FDYXJkKGNhcmRBKTtcbiAgICBjYXJkQVBsdXMucG9pbnQgPSAxNDtcbiAgICB1bmlxdWVDYXJkcy5wdXNoKGNhcmRBUGx1cyk7XG4gIH1cblxuICBsZXQgcmVzdWx0ID0gW107XG5cbiAgLy8g55Sx5LqO54K55pWw5piv5ZSv5LiA5LiU5Y2H5bqP77yM5Y+q6ZyA6KaB5L6d5qyh6YGN5Y6G5Yik5pat5piv5ZCm5piv6aG65a2Q5Y2z5Y+vXG4gIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbGVuZ3RoKSA8PSB1bmlxdWVDYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICBsZXQgc3ViQ2FyZHMgPSB1bmlxdWVDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xuICAgIGlmIChLUUNhcmQuaXNTaHVuWmkoc3ViQ2FyZHMsIGxlbmd0aCkpIHtcbiAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgIHN1YkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgICAgICBsZXQgaW5kZXggPSBjYXJkTW9kZXMuZmluZEluZGV4KGZ1bmN0aW9uIChvcmlnaW5DYXJkKSB7XG5cbiAgICAgICAgICBpZiAoY2FyZC5wb2ludCA9PSAxNCkge1xuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbkNhcmQucG9pbnQgPT0gMTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gY2FyZCA9PT0gb3JpZ2luQ2FyZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGluZGV4cy5wdXNoKGluZGV4KTtcbiAgICAgIH0pO1xuXG4gICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgcmVzdWx0LnB1c2goaW5kZXhzKTtcbiAgICB9XG4gIH1cblxuICAvLyDlpITnkIbngrnmlbDph43lpI3nmoTmg4XlhrVcbiAgLy8g5q+U5aaCIEEgQSBLIFEgSiAxMCDov5nnp40gXG4gIGxldCByZXBlYXRJbmRleHNBcnJheSA9IEtRQ2FyZC5fZmluZFJlcGVhdFBvaW50SW5kZXhzQXJyYXkocmVzdWx0LCBjYXJkTW9kZXMpO1xuICByZXBlYXRJbmRleHNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgIHJlc3VsdC5wdXNoKGluZGV4cyk7XG4gIH0pO1xuXG4gIHJlc3VsdC5zb3J0KGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7XG4gICAgcmV0dXJuIGFycjFbMF0gLSBhcnIyWzBdO1xuICB9KTtcblxuICByZXR1cm4gcmVzdWx0Lmxlbmd0aCA+IDAgPyByZXN1bHQgOiBLUUNhcmQuZmluZFNodW5aaTIwKGNhcmRNb2Rlcyk7XG59O1xuS1FDYXJkLmZpbmRTaHVuWmkyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMgLGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZE1vZGVzKTtcbiAgdmFyIGNhcmRzID0gY2FyZE1vZGVzLmtxX2V4Y2x1ZGVzKGNhcmQyMCk7XG4gIC8vIOWFiOagueaNrueCueaVsOWOu+mHjVxuICB2YXIgbmV3QXJyID0gW107XG4gIHZhciBuZXdBcnJzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAobmV3QXJycy5pbmRleE9mKGNhcmRzW2ldWydwb2ludCddKSA9PSAtMSkge1xuICAgICAgbmV3QXJyLnB1c2goY2FyZHNbaV0pO1xuICAgICAgbmV3QXJycy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICB9XG4gIH1cblxuICBuZXdBcnIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgcmV0dXJuIG4xLnBvaW50IC0gbjIucG9pbnQ7XG4gIH0pO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgdmFyIG51bSA9IGxlbmd0aCAtIGo7XG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IG5ld0Fyci5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgIHZhciBzdWJDYXJkcyA9IG5ld0Fyci5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3BvaW50J10pIC0gcGFyc2VJbnQoc3ViQ2FyZHNbMF1bJ3BvaW50J10pIDwgbGVuZ3RoO1xuICAgICAgaWYoYm9vbCl7XG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgdmFyIG5ld0NhcmQyMCA9IGNhcmQyMC5zbGljZSgwLGopO1xuICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xuICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkTW9kZXMubGVuZ3RoOyBxKyspe1xuICAgICAgICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XG4gICAgICAgICAgICBpZihyID09PSBjYXJkKXtcbiAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmKHJlc3VsdC5sZW5ndGggPiAwKXtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9ZWxzZXtcbiAgICBsZXQgY29udmVydGVkQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0ExKGNhcmRNb2Rlcyk7XG4gICAgaWYgKGNhcmRNb2RlcyA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5maW5kU2h1blppMjAoY29udmVydGVkQ2FyZHMpO1xuICB9XG59O1xuS1FDYXJkLl9maW5kUmVwZWF0UG9pbnRJbmRleHNBcnJheSA9IGZ1bmN0aW9uKGluZGV4c0FycmF5LCBvcmlnaW5DYXJkcykge1xuICBsZXQgcmVwZWF0SW5kZXhzQXJyYXkgPSBbXTtcbiAgaW5kZXhzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICBsZXQgY2FyZHMgPSBpbmRleHMubWFwKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICByZXR1cm4gb3JpZ2luQ2FyZHNbaW5kZXhdO1xuICAgIH0pO1xuXG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkLCBpbmRleCkge1xuICAgICAgbGV0IG9yaWdpbkluZGV4ID0gb3JpZ2luQ2FyZHMuZmluZEluZGV4KGZ1bmN0aW9uKG9yaWdpbkNhcmQpIHtcbiAgICAgICAgaWYodHlwZW9mKGNhcmQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yaWdpbkNhcmQgIT09IGNhcmQgJiYgb3JpZ2luQ2FyZC5wb2ludCA9PSBjYXJkLnBvaW50KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChvcmlnaW5JbmRleCA8IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgcmVwZWF0SW5kZXhzID0gaW5kZXhzLnNsaWNlKCk7XG4gICAgICByZXBlYXRJbmRleHNbaW5kZXhdID0gb3JpZ2luSW5kZXg7XG4gICAgICByZXBlYXRJbmRleHNBcnJheS5wdXNoKHJlcGVhdEluZGV4cyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiByZXBlYXRJbmRleHNBcnJheTtcbn07XG5cbi8vIOaJvuWQjOiKsVxuLy8g5aaC77yaW1sxLCAyLCAzLCA0LCA1XV1cbktRQ2FyZC5maW5kVG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkTW9kZXMsIGxlbmd0aCA9IDUpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgY2FyZHMgPSBBcnJheS5mcm9tKGNhcmRNb2Rlcyk7XG4gIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeUNvbG9yKTtcblxuICBsZXQgcmVzdWx0ID0gW107XG4gIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbGVuZ3RoKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICBsZXQgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBsZW5ndGgpO1xuICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBsZW5ndGgpKSB7XG4gICAgICBsZXQgaW5kZXhzID0gW107XG4gICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gY2FyZE1vZGVzLmZpbmRJbmRleChmdW5jdGlvbiAob3JpZ2luQ2FyZCkge1xuICAgICAgICAgIHJldHVybiBjYXJkID09PSBvcmlnaW5DYXJkO1xuICAgICAgICB9KTtcbiAgICAgICAgICBpbmRleHMucHVzaChpbmRleCk7XG4gICAgICB9KTtcbiAgICAgIC8vaW5kZXhzID0gaW5kZXhzLmxlbmd0aCA+IDUgPyBpbmRleHMuc3BsaWNlKDEsMSkgOiBpbmRleHM7XG4gICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgcmVzdWx0LnB1c2goaW5kZXhzKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogS1FDYXJkLmZpbmRUb25nSHVhMjAoY2FyZE1vZGVzKTtcbn07XG5LUUNhcmQuZmluZFRvbmdIdWEyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCA1KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2Rlcyk7XG4gIHZhciBjYXJkcyA9IGNhcmRNb2Rlcy5rcV9leGNsdWRlcyhjYXJkMjApO1xuICAvLyDlhYjmoLnmja7ngrnmlbDljrvph41cbiAgY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuXG4gIHZhciByZXN1bHQgPSBbXTtcbiAgZm9yKHZhciBqID0gMTtqIDw9IGNhcmQyMC5sZW5ndGg7KytqKXtcbiAgICB2YXIgbnVtID0gNSAtIGo7XG4gICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IGNhcmRzLmxlbmd0aDsgKytzdGFydCkge1xuICAgICAgdmFyIHN1YkNhcmRzID0gY2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbnVtKTtcbiAgICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBudW0pKSB7XG4gICAgICAgIGxldCBpbmRleHMgPSBbXTtcbiAgICAgICAgdmFyIG5ld0NhcmQyMCA9IGNhcmQyMC5zbGljZSgwLGopO1xuICAgICAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLmNvbmNhdChuZXdDYXJkMjApO1xuICAgICAgICBzdWJDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgICBmb3IodmFyIHEgPSAwO3EgPCBjYXJkTW9kZXMubGVuZ3RoOyBxKyspe1xuICAgICAgICAgICAgdmFyIHIgPSBjYXJkTW9kZXNbcV07XG4gICAgICAgICAgICBpZihyID09PSBjYXJkKXtcbiAgICAgICAgICAgICAgaW5kZXhzLnB1c2gocSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcblxuICAgICAgICBpbmRleHMuc29ydChBcnJheS5zb3J0QnlOdW1iZXIpO1xuICAgICAgICByZXN1bHQudW5zaGlmdChpbmRleHMpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXN1bHQubGVuZ3RoID4gMCA/IHJlc3VsdCA6IFtdO1xufTtcblxuS1FDYXJkLmZpbmRIdUx1ID0gZnVuY3Rpb24gKGNhcmRNb2Rlcykge1xuICBsZXQgbGVuZ3RoID0gNTtcbiAgaWYgKGNhcmRNb2Rlcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuXG4gIHZhciBwXzM9S1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRNb2Rlcyk7XG4gIHZhciBwXzQ9S1FDYXJkLmZpbmRUaWVaaGkoY2FyZE1vZGVzKTtcbiAgdmFyIHAyPUtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgLy92YXIgcF8zID0gIHRoaXMuX2ZpbmRQb2ludExlbmd0aChjYXJkTW9kZXMsIDMpIHx8IFtdO1xuICAvL3ZhciBwXzQgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCA0KSB8fCBbXTtcbiAgLy92YXIgcDIgPSB0aGlzLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCAyKSB8fCBbXTtcbiAgaWYocDIubGVuZ3RoIDw9IDApe1xuICAgIGlmIChwXzMpIHtcbiAgICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMF0sIGluZGV4c1syXV07XG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzMyA9IFtpbmRleHNbMV0sIGluZGV4c1syXV07XG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czApO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHMzKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChwXzQpIHtcbiAgICAgIHBfNC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgICBsZXQgc2FuVGlhb0luZGV4czAgPSBbaW5kZXhzWzBdLCBpbmRleHNbMV1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzMSA9IFtpbmRleHNbMF0sIGluZGV4c1syXV07XG4gICAgICAgIC8vbGV0IHNhblRpYW9JbmRleHMyID0gW2luZGV4c1swXSwgaW5kZXhzWzNdXTtcbiAgICAgICAgLy9sZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgICAvL2xldCBzYW5UaWFvSW5kZXhzNCA9IFtpbmRleHNbMV0sIGluZGV4c1szXV07XG4gICAgICAgIGxldCBzYW5UaWFvSW5kZXhzNiA9IFtpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICAgIHAyLnB1c2goc2FuVGlhb0luZGV4czApO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czEpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czIpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czMpO1xuICAgICAgICAvL3AyLnVuc2hpZnQoc2FuVGlhb0luZGV4czQpO1xuICAgICAgICBwMi5wdXNoKHNhblRpYW9JbmRleHM2KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG5cblxuICBpZiAoKHAyID09IG51bGwpIHx8IChwXzMgPT0gbnVsbCkpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIHRyZXN1bHQ9W11cbiAgcDIuZm9yRWFjaChmdW5jdGlvbiAoaV8zKSB7XG4gICAgdmFyIHM9aV8zO1xuICAgIHBfMy5mb3JFYWNoKGZ1bmN0aW9uIChpXzIpIHtcbiAgICAgIHMgPSBpXzMuY29uY2F0KGlfMik7XG4gICAgICBmb3IodmFyIGkgPTA7aTxzLmxlbmd0aC0xO2krKyl7XG4gICAgICAgIHZhciBpbmRleCA9IHNbaV07XG4gICAgICAgIGZvcih2YXIgaiA9aSsxO2o8cy5sZW5ndGg7aisrKXtcbiAgICAgICAgICBpZihpbmRleCA9PSBzW2pdKSB7XG4gICAgICAgICAgICBzID0gbnVsbDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZihzID09IG51bGwpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYocyAhPT0gbnVsbCl7XG4gICAgICAgIHRyZXN1bHQucHVzaChzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIGlmKHRyZXN1bHQubGVuZ3RoID4gMTApe1xuICAgIHRyZXN1bHQgPSB0cmVzdWx0LnNsaWNlKDAsMTApO1xuICB9XG4gIHJldHVybiB0cmVzdWx0Lmxlbmd0aCA+IDAgPyB0cmVzdWx0IDogS1FDYXJkLmZpbmRIdUx1MjAoY2FyZE1vZGVzKTtcbn07XG5LUUNhcmQuZmluZEh1THUyMCA9IGZ1bmN0aW9uIChjYXJkTW9kZXMpIHtcbiAgbGV0IGxlbmd0aCA9IDU7XG4gIGlmIChjYXJkTW9kZXMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBwXzM9S1FDYXJkLmZpbmRHdWlQYWkoY2FyZE1vZGVzLDMpO1xuICB2YXIgcF80PUtRQ2FyZC5maW5kR3VpUGFpKGNhcmRNb2Rlcyw0KTtcbiAgdmFyIHBfMj1LUUNhcmQuZmluZEd1aVBhaShjYXJkTW9kZXMsMik7XG4gIGlmKHBfMj09bnVsbCl7XG4gICAgcF8yPVtdO1xuICB9XG4gIGlmIChwXzMpIHtcbiAgICBwXzMuZm9yRWFjaChmdW5jdGlvbihpbmRleHMpIHtcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzMCA9IFtpbmRleHNbMF0sIGluZGV4c1sxXV07XG4gICAgICBsZXQgc2FuVGlhb0luZGV4czMgPSBbaW5kZXhzWzFdLCBpbmRleHNbMl1dO1xuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czApO1xuICAgICAgcF8yLnVuc2hpZnQoc2FuVGlhb0luZGV4czMpO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKHBfNCkge1xuICAgIHBfNC5mb3JFYWNoKGZ1bmN0aW9uKGluZGV4cykge1xuICAgICAgbGV0IHNhblRpYW9JbmRleHMwID0gW2luZGV4c1swXSwgaW5kZXhzWzFdXTtcbiAgICAgIGxldCBzYW5UaWFvSW5kZXhzNiA9IFtpbmRleHNbMl0sIGluZGV4c1szXV07XG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzMCk7XG4gICAgICBwXzIudW5zaGlmdChzYW5UaWFvSW5kZXhzNik7XG4gICAgfSk7XG4gIH1cblxuICBpZiAoKHBfMiA9PSBudWxsKSB8fCAocF8zID09IG51bGwpKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciB0cmVzdWx0PVtdXG4gIHBfMi5mb3JFYWNoKGZ1bmN0aW9uIChpXzMpIHtcbiAgICB2YXIgcz1pXzM7XG4gICAgcF8zLmZvckVhY2goZnVuY3Rpb24gKGlfMikge1xuICAgICAgcyA9IGlfMy5jb25jYXQoaV8yKTtcbiAgICAgIGZvcih2YXIgaSA9MDtpPHMubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgdmFyIGluZGV4ID0gc1tpXTtcbiAgICAgICAgZm9yKHZhciBqID1pKzE7ajxzLmxlbmd0aDtqKyspe1xuICAgICAgICAgIGlmKGluZGV4ID09IHNbal0pIHtcbiAgICAgICAgICAgIHMgPSBudWxsO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKHMgPT0gbnVsbCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZihzICE9PSBudWxsKXtcbiAgICAgICAgdHJlc3VsdC51bnNoaWZ0KHMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgaWYodHJlc3VsdC5sZW5ndGggPiAxMCl7XG4gICAgdHJlc3VsdCA9IHRyZXN1bHQuc2xpY2UoMCwxMCk7XG4gIH1cbiAgcmV0dXJuIHRyZXN1bHQubGVuZ3RoID4gMCA/IHRyZXN1bHQgOiBbXTtcbn07XG5cbktRQ2FyZC5maW5kR3VpUGFpID0gZnVuY3Rpb24gKGNhcmRNb2RlcyxudW1CZXIgPSAxKSB7XG4gIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRNb2RlcykubWFwKGZ1bmN0aW9uKGNhcmQpey8v5b6X5Yiw6ay854mM55qE57Si5byVXG4gICAgZm9yKHZhciBxID0gMDtxIDwgY2FyZE1vZGVzLmxlbmd0aDsgcSsrKXtcbiAgICAgIHZhciByID0gY2FyZE1vZGVzW3FdO1xuICAgICAgaWYociA9PT0gY2FyZCl7XG4gICAgICAgIHJldHVybiBxO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgdmFyIGNhcmRzID0gY2FyZE1vZGVzLmtxX2V4Y2x1ZGVzKEtRQ2FyZC5jb250YWluMjAoY2FyZE1vZGVzKSk7Ly/liKDpmaTmiYDmnInniYznmoTprLzniYxcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuICAgIHZhciBudW0gPSBudW1CZXItajsvL+mZpOmsvOeJjOWkliDmiJHlupTor6Xmib7lpJrlsJHlvKDniYzljLnphY1cbiAgICB2YXIgaW5kZXhzID0gS1FDYXJkLl9maW5kUG9pbnRMZW5ndGgoY2FyZE1vZGVzLCBudW0pIHx8IFtdO1xuICAgIGZvcih2YXIgdCA9IDA7dCA8IGluZGV4cy5sZW5ndGg7IHQrKykge1xuICAgICAgaWYobnVtQmVyID09IDIpey8v5piv5a+55a2Q55qE5pe25YCZ5oqK6ay854mM5ZKM5Y2V5byg5Yy56YWN6YO95b6q546v5LiA6YGNXG4gICAgICAgIGZvcih2YXIgbyA9IDA7byA8IGNhcmQyMC5sZW5ndGg7KytvKXtcbiAgICAgICAgICB2YXIgcyA9IGluZGV4c1t0XS5jb25jYXQoY2FyZDIwW29dKTtcbiAgICAgICAgICBpZihzLmxlbmd0aCA9PSBudW1CZXIpe1xuICAgICAgICAgICAgcmVzdWx0LnB1c2gocyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHMgPSBpbmRleHNbdF0uY29uY2F0KGNhcmQyMC5zbGljZSgwLGopKTsvL+S+neasoeebuOWKoOmsvOeJjOesrOS4gOasoeWKoOS4gOW8oCDpgJLlop5cbiAgICAgICAgaWYocy5sZW5ndGggPT0gbnVtQmVyKXtcbiAgICAgICAgICByZXN1bHQucHVzaChzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZihyZXN1bHQubGVuZ3RoID4gMTApe1xuICAgIHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLDEwKTtcbiAgfVxuICByZXN1bHQgPSBLUUNhcmQucmVwZWF0KHJlc3VsdCk7Ly/ljrvph41cbiAgcmV0dXJuIHJlc3VsdC5sZW5ndGggPiAwID8gcmVzdWx0IDogW107XG59O1xuXG5LUUNhcmQucmVwZWF0ID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICBmb3IodmFyIGkgPTA7aTxyZXN1bHQubGVuZ3RoO2krKyl7XG4gICAgdmFyIGluZGV4ID0gcmVzdWx0W2ldO1xuXG4gICAgdmFyIG5ld0F5eSA9IFtdO1xuICAgIGZvcih2YXIgbyA9IDA7byA8IGluZGV4Lmxlbmd0aDtvKyspey8v5pyJ6YeN5aSN5bmy5o6J5L2gXG4gICAgICBpZihuZXdBeXkuaW5kZXhPZihpbmRleFtvXSkgPT0gLTEpe1xuICAgICAgICBuZXdBeXkucHVzaChpbmRleFtvXSk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgcmVzdWx0LnNwbGljZShpLDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IodmFyIGogPWkrMTtqPHJlc3VsdC5sZW5ndGgtMTtqKyspe1xuICAgICAgICB2YXIgcyA9IHJlc3VsdFtqXTtcbiAgICAgICAgdmFyIGpTdHJpbmcgPSAnJztcbiAgICAgICAgdmFyIGlTdHJpbmcgPSAnJztcbiAgICAgIGZvcih2YXIgciA9IDA7ciA8IHMubGVuZ3RoO3IrKyl7XG4gICAgICAgICAgalN0cmluZyA9IGpTdHJpbmcgKyBzW3JdO1xuICAgICAgICAgIGlTdHJpbmcgPSBpU3RyaW5nICsgaW5kZXhbcl07XG4gICAgICAgIH1cbiAgICAgIGlmKGpTdHJpbmcgPT0gaVN0cmluZyl7Ly/mnInph43lpI3lubLmjonkvaBcbiAgICAgICAgcmVzdWx0LnNwbGljZShpLDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuXG5LUUNhcmQudGVzdEZpbmQgPSBmdW5jdGlvbiAoY2FyZE1vZGVzKSB7XG4gIHZhciBXdVRvbmcgPSBLUUNhcmQuZmluZFd1VG9uZyhjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgVG9uZ0h1YVNodW4gPSBLUUNhcmQuZmluZFRvbmdIdWFTaHVuKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBUaWVaaGkgPSBLUUNhcmQuZmluZFRpZVpoaShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgSHVMdSA9IEtRQ2FyZC5maW5kSHVMdShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgVG9uZ0h1YSA9IEtRQ2FyZC5maW5kVG9uZ0h1YShjYXJkTW9kZXMpIHx8IFtdO1xuICB2YXIgU2h1blppID0gS1FDYXJkLmZpbmRTaHVuWmkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIFNhblRpYW8gPSBLUUNhcmQuZmluZFNhblRpYW8oY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIExpYUR1aSA9IEtRQ2FyZC5maW5kTGlhRHVpKGNhcmRNb2RlcykgfHwgW107XG4gIHZhciBEdWlaaSA9IEtRQ2FyZC5maW5kRHVpWmkoY2FyZE1vZGVzKSB8fCBbXTtcbiAgdmFyIHJlc3VsdCA9IFtcbiAgICBXdVRvbmcsXG4gICAgVG9uZ0h1YVNodW4sXG4gICAgVGllWmhpLFxuICAgIEh1THUsXG4gICAgVG9uZ0h1YSxcbiAgICBTaHVuWmksXG4gICAgU2FuVGlhbyxcbiAgICBMaWFEdWksXG4gICAgRHVpWmksXG4gIF1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG4iLCIvLyDniYzngrnmlbDluK7liqnnsbtcbi8vIOeUqOadpeiuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxudmFyIEtRQ2FyZFBvaW50c0hlbHBlciA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHRoaXMucG9pbnROdW1iZXJzID0ge307XG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICBsZXQgcG9pbnQgPSBjYXJkLnBvaW50O1xuICAgICAgICB2YXIgbnVtYmVyID0gdGhpcy5wb2ludE51bWJlcnNbcG9pbnRdIHx8IDA7XG4gICAgICAgIHRoaXMucG9pbnROdW1iZXJzW3BvaW50XSA9IG51bWJlciArIDE7XG4gICAgfS5iaW5kKHRoaXMpKTtcbn07XG5cbi8vIOebuOWQjOeCueaVsOeJjOeahOacgOWkp+aVsOmHj1xuS1FDYXJkUG9pbnRzSGVscGVyLnByb3RvdHlwZS5tYXhOdW1iZXIgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciByZXN1bHQgPSAwO1xuICBmb3IgKGxldCBwcm9wIGluIHRoaXMucG9pbnROdW1iZXJzKSB7XG4gICAgbGV0IG51bWJlciA9IHRoaXMucG9pbnROdW1iZXJzW3Byb3BdO1xuICAgICAgLy9pZihudW1iZXIgPCAyMCl7XG4gICAgICAgICAgcmVzdWx0ID0gTWF0aC5tYXgobnVtYmVyLCByZXN1bHQpO1xuICAgICAgLy99XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gS1FDYXJkUG9pbnRzSGVscGVyO1xuXG4vKnZhciBjYXJkcyA9IFtcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6Mn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjJ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo0fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6NH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjZ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo2fSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6OH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjh9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMH0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEwfSxcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTJ9LFxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjE0fVxuXTtcbnZhciB0ZXN0ID0gbmV3IEtRQ2FyZFBvaW50c1NhbWUoY2FyZHMpO1xuY29uc29sZS5sb2codGVzdCk7Ki9cbiIsImxldCBIZWxwZXIgPSB7XG4gIGxvYWRDYXJkU3ByaXRlRnJhbWU6IGZ1bmN0aW9uIChjYXJkTmFtZSwgY2FsbGJhY2spIHtcbiAgICB0aGlzLl9sb2FkQ2FyZEZyYW1lKGNhcmROYW1lLCBjYWxsYmFjayk7XG4gIH0sXG5cbiAgc2V0Q2FyZFNwcml0ZUZyYW1lOiBmdW5jdGlvbiAoc3ByaXRlLCBjYXJkTmFtZSkge1xuICAgIHRoaXMubG9hZENhcmRTcHJpdGVGcmFtZShjYXJkTmFtZSwgZnVuY3Rpb24gKHNwcml0ZUZyYW1lKSB7XG4gICAgICBzcHJpdGUuc3ByaXRlRnJhbWUgPSBzcHJpdGVGcmFtZTtcbiAgICB9KTtcbiAgfSxcblxuICBfY2FyZEZ1bGxOYW1lOiBmdW5jdGlvbiAoY2FyZFNob3J0TmFtZSkge1xuICAgIHZhciBjYXJkTmFtZSA9IGNhcmRTaG9ydE5hbWU7XG4gICAgaWYgKCFjYXJkTmFtZS5zdGFydHNXaXRoKFwicHVibGljLXBpYy1jYXJkLXBva2VyXCIpKSB7XG4gICAgICBjYXJkTmFtZSA9IFwicHVibGljLXBpYy1jYXJkLXBva2VyLVwiICsgY2FyZE5hbWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNhcmROYW1lO1xuICB9LFxuXG4gIF9sb2FkQ2FyZEZyYW1lOiBmdW5jdGlvbiAoY2FyZE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgY2MuYXNzZXJ0KGNhbGxiYWNrKTtcblxuICAgIGNjLmxvYWRlci5sb2FkUmVzKFwiaW1hZ2VzL3Bva2VyTGlzdC9wb2NrTGlzdFwiLCBjYy5TcHJpdGVBdGxhcywgZnVuY3Rpb24gKGVyciwgYXRsYXMpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgZXJyKVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNhcmROYW1lID0gdGhpcy5fY2FyZEZ1bGxOYW1lKGNhcmROYW1lKTtcbiAgICAgIHZhciBmcmFtZSA9IGF0bGFzLmdldFNwcml0ZUZyYW1lKGNhcmROYW1lKTtcbiAgICAgIGNhbGxiYWNrKGZyYW1lKTtcbiAgICB9LmJpbmQodGhpcykpO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBIZWxwZXI7XG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcbmNvbnN0IEtRQ2FyZENvbG9yc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZENvbG9yc0hlbHBlcicpO1xuY29uc3QgS1FDYXJkU2NvcmV0c0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFNjb3JldHNIZWxwZXInKTtcblxuS1FDYXJkLnNjb3JlT2ZDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICBpZihjYXJkcyA9PSBudWxsIHx8IGNhcmRzLmxlbmd0aCA9PSBudWxsKSB7XG4gICAgY2FyZHMgPSBbXTtcbiAgfVxuXG4gIHZhciBpc1RvdSA9IGNhcmRzLmxlbmd0aCA9PSAzO1xuICBsZXQgdHlwZVNjb3JlID0gS1FDYXJkLl90eXBlU2NvcmVPZkNhcmRzKGNhcmRzKTtcbiAgdmFyIGNhbGVDYXJkcyA9IEtRQ2FyZC5fY29udmVydE9uZVRvQShjYXJkcy5zbGljZSgpKTtcbiAgY2FsZUNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgaWYoY2FyZC5zY29yZXMgPT0gMSl7XG4gICAgICBjYXJkLnNjb3JlcyA9IDE0O1xuICAgIH1cbiAgfSlcbiAgLy9jYWxlQ2FyZHMgPSBLUUNhcmQuU29ydChjYWxlQ2FyZHMpO1xuICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYWxlQ2FyZHMpO1xuICB2YXIgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkU2NvcmV0c0hlbHBlcihjYWxlQ2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKSk7XG4gIHZhciBtYXhOdW0gPSBwb2ludEhlbHBlci5tYXhOdW1iZXIoKS8qLWNhcmQyMC5sZW5ndGggPT0gMCA/IDE6IHBvaW50SGVscGVyLm1heE51bWJlcigpLWNhcmQyMC5sZW5ndGgqLztcblxuICB2YXIgbWF4U2NvcmUgPSAwOy8v6I635Y+W6Zmk6ay854mM5aSW5pyA5aSn55qE55qE54K55pWwXG4gIGZvcih2YXIgaSBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICBpZiAocGFyc2VJbnQoaSkgPiBtYXhTY29yZSAmJiBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbaV0gPT0gbWF4TnVtKSB7XG4gICAgICBtYXhTY29yZSA9IHBhcnNlSW50KGkpO1xuICAgIH1cbiAgfVxuICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKXtcbiAgICBpZihjYXJkLnNjb3JlcyA+PSAyMCl7XG4gICAgICBjYXJkLnNjb3JlcyA9IG1heFNjb3JlO1xuICAgIH1cbiAgfSlcbiAgY2FyZDIwLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgY2FyZC5zY29yZXMgPSBtYXhTY29yZTtcbiAgfSlcbiAgLy9jYy5sb2cobWF4TnVtKVxuICAvL2NjLmxvZyhtYXhTY29yZSlcbiAgLy9jYy5sb2coY2FsZUNhcmRzLmtxX2V4Y2x1ZGVzKGNhcmQyMCkpXG4gIC8vY2MubG9nKCctLS0tMzUnKVxuICBjYWxlQ2FyZHMuc29ydChLUUNhcmQuc29ydCk7XG4gIGlmKHR5cGVTY29yZSA9PSA5MDAwMDAwMDAwMDAwMDAwKXtcbiAgICAvL+S6lOWQjFxuICAgIGNhbGVDYXJkcy5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgIHJldHVybiBhMi5zY29yZXMgLSBhMS5zY29yZXM7XG4gICAgfSk7XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIC8vdmFyIHRvdGFsQ29sb3IgPSBcIlwiO1xuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIC8vdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7XG4gICAgICB0b3RhbFZhbHVlID0gKHBhcnNlSW50KHMpID49IDEwID8gcyA6IFwiMFwiK3MpK3RvdGFsVmFsdWU7XG4gICAgICAvL3RvdGFsQ29sb3IgPSBjK3RvdGFsQ29sb3I7XG4gICAgfVxuICAgIC8vdG90YWxWYWx1ZSA9IHRvdGFsVmFsdWUrdG90YWxDb2xvcjtcbiAgICAvL2NjLmxvZyh0b3RhbFZhbHVlKVxuICAgIC8vY2MubG9nKHBhcnNlSW50KHRvdGFsVmFsdWUpKVxuICAgIC8vY2MubG9nKHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlKSlcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDgwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+WQjOiKsemhuuavlOacgOWkp+eahOmCo+W8oO+8jOWmguaenOS4pOW8oOebuOWQjOmCo+WwseaYr+ebuOWQjFxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXsvL+aciemsvOeJjOeahOaXtuWAmeimgeaUueWPmOmsvOeJjOeahOWIhuaVsFxuICAgICAgY2FsZUNhcmRzID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FsZUNhcmRzKTtcbiAgICB9XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIHRvdGFsVmFsdWUgPSAocGFyc2VJbnQocykgPj0gMTAgPyBzIDogXCIwXCIrcykrdG90YWxWYWx1ZTtcbiAgICAgIHZhciBjID0gY2FsZUNhcmRzW2ldLmNvbG9yOy8v54mM6ImyXG4gICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFZhbHVlICsgdmFsdWVDb2xvcik7XG4gIH1cbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gNzAwMDAwMDAwMDAwMDAwMCkge1xuICAgIC8v6ZOB5pSvLOaJvuWHuumCo+Wbm+W8oOaYr+S7gOS5iOeJjFxuXG4gICAgdmFyIHN0ciA9IFwiXCI7XG4gICAgdmFyIG9uZVZhbHVlID0gXCJcIjtcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICB2YXIgb25lVmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7XG4gICAgICBpZihtYXhTY29yZSA9PSBjYWxlQ2FyZHNbd10uc2NvcmVzKXsvL+S4ieadoVxuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XG4gICAgICAgIHN0ciA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIHN0cjtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICB2YWx1ZUNvbG9yID0gYyArIHZhbHVlQ29sb3I7Ly/niYzoibJcbiAgICAgIH1lbHNle1xuICAgICAgICB2YXIgcyA9IGNhbGVDYXJkc1t3XS5zY29yZXM7XG4gICAgICAgIG9uZVZhbHVlID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgb25lVmFsdWU7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgb25lVmFsdWVDb2xvciA9IGMgKyBvbmVWYWx1ZUNvbG9yOy8v54mM6ImyXG5cbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIHF3ZSA9ICcnO1xuICAgIHF3ZSA9IG9uZVZhbHVlQ29sb3Iuc3Vic3RyKDAsb25lVmFsdWVDb2xvci5sZW5ndGggLTEpO1xuICAgIG9uZVZhbHVlQ29sb3IgPSBvbmVWYWx1ZUNvbG9yLnN1YnN0cihvbmVWYWx1ZUNvbG9yLmxlbmd0aCAtMSk7XG4gICAgc3RyID0gc3RyK29uZVZhbHVlICsgb25lVmFsdWVDb2xvciArIHZhbHVlQ29sb3IgKyBxd2U7XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDYwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+iRq+iKplxuICAgIHZhciBzdHIgPSBcIlwiO1xuICAgIHZhciBvbmVWYWx1ZSA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgdmFyIG9uZVZhbHVlQ29sb3IgPSBcIlwiOy8v54mM6ImyXG4gICAgZm9yKHZhciB3IGluIGNhbGVDYXJkcykge1xuICAgICAgaWYobWF4U2NvcmUgPT0gY2FsZUNhcmRzW3ddLnNjb3Jlcyl7Ly/kuInmnaFcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG5cbiAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yOy8v54mM6ImyXG4gICAgICB9ZWxzZXtcbiAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICBvbmVWYWx1ZSA9IChwYXJzZUludChzKT49MTAgPyBzIDpcIjBcIitzKSArIG9uZVZhbHVlO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjICsgb25lVmFsdWVDb2xvcjsvL+eJjOiJslxuXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYoaXNUb3Upe1xuICAgICAgb25lVmFsdWUgPSBvbmVWYWx1ZSsnMDAwMCc7XG4gICAgICBvbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvcisnMDAnO1xuICAgIH1cblxuICAgIHN0ciA9IHN0citvbmVWYWx1ZSArIHZhbHVlQ29sb3IgKyBvbmVWYWx1ZUNvbG9yO1xuICAgIHJldHVybiB0eXBlU2NvcmUrcGFyc2VJbnQoc3RyKTtcblxuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDUwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+WQjOiKsSzmnInlj6/og73pnIDopoHmr5Q15byg54mMXG4gICAgdmFyIHRvdGFsU2NvcmUgPSBcIlwiO1xuICAgIHZhciB0b3RhbENvbG9yID0gXCJcIjtcbiAgICAvL3ZhciBjb2xvcnMgPSAwOy8v6I635Y+W54mM55qE57G75Z6L6aKc6ImyXG4gICAgLy9mb3IodmFyIGkgaW4gY2FsZUNhcmRzKSB7XG4gICAgLy8gIGlmKHBhcnNlSW50KGNhbGVDYXJkc1tpXS5wb2ludCkgPCAyMCl7XG4gICAgLy8gICAgY29sb3JzID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLmNvbG9yKTtcbiAgICAvLyAgICBicmVhaztcbiAgICAvLyAgfVxuICAgIC8vfVxuXG4gICAgZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgICAgdmFyIHBhaVBvaW50ID0gcGFyc2VJbnQoY2FsZUNhcmRzW2ldLnBvaW50KTtcbiAgICAgIHZhciBjb2xvcnMgPSBwYXJzZUludChjYWxlQ2FyZHNbaV0ucG9pbnQpIDwgMjAgPyBjYWxlQ2FyZHNbaV0uY29sb3I6IDU7XG4gICAgICB0b3RhbENvbG9yID0gY29sb3JzICsgdG90YWxDb2xvcjtcbiAgICAgIHRvdGFsU2NvcmUgPSAocGFpUG9pbnQ+PTEwID8gcGFpUG9pbnQgOiBcIjBcIitwYWlQb2ludCkrdG90YWxTY29yZTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh0b3RhbFNjb3JlK3RvdGFsQ29sb3IpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDQwMDAwMDAwMDAwMDAwMDApIHtcbiAgICAvL+mhuuWtkFxuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKXsvL+aciemsvOeJjOeahOaXtuWAmeimgeaUueWPmOmsvOeJjOeahOWIhuaVsFxuICAgICAgY2FsZUNhcmRzID0gS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMoY2FsZUNhcmRzKTtcbiAgICB9XG4gICAgdmFyIHRvdGFsVmFsdWUgPSBcIlwiO1xuICAgIHZhciB2YWx1ZUNvbG9yID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgaSBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIHZhciBzID0gY2FsZUNhcmRzW2ldLnNjb3JlcztcbiAgICAgIHRvdGFsVmFsdWUgPSAocGFyc2VJbnQocykgPj0gMTAgPyBzIDogXCIwXCIrcykrdG90YWxWYWx1ZTtcblxuICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbaV0uY29sb3I7Ly/niYzoibJcbiAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgIH1cbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHRvdGFsVmFsdWUgKyB2YWx1ZUNvbG9yKTtcbiAgfVxuICBlbHNlIGlmKHR5cGVTY29yZSA9PSAzMDAwMDAwMDAwMDAwMDAwKSB7XG4gICAgLy/kuInmnaHvvIzmib7lh7rmmK/lk6rlvKDniYzmnIkz5bygXG4gICAgLy9jYWxlQ2FyZHMuc29ydChLUUNhcmQuc29ydCk7XG4gICAgdmFyIHN0ciA9IFwiXCI7XG4gICAgdmFyIG9uZVZhbHVlID0gXCJcIjtcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICB2YXIgb25lVmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICB2YXIgb25lVmFsdWVDb2xvcjIwID0gXCJcIjsvL+eJjOiJslxuICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgIGlmKG1heFNjb3JlID09IGNhbGVDYXJkc1t3XS5zY29yZXMpey8v5LiJ5p2hXG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuXG4gICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3ddLmNvbG9yOy8v54mM6ImyXG4gICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuICAgICAgfWVsc2V7XG4gICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3ddLnNjb3JlcztcbiAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcblxuICAgICAgICB2YXIgYyA9IGNhbGVDYXJkc1t3XS5jb2xvcjsvL+eJjOiJslxuICAgICAgICBpZihwYXJzZUludChzKSA8IDIwKXtcbiAgICAgICAgICBvbmVWYWx1ZUNvbG9yID0gYyArIG9uZVZhbHVlQ29sb3I7Ly/niYzoibJcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgb25lVmFsdWVDb2xvcjIwID0gYyArIG9uZVZhbHVlQ29sb3IyMDsvL+eJjOiJslxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmKGlzVG91KXtcbiAgICAgIG9uZVZhbHVlID0gb25lVmFsdWUrJzAwMDAnO1xuICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICB9XG4gICAgc3RyID0gc3RyK29uZVZhbHVlICsgb25lVmFsdWVDb2xvciArIHZhbHVlQ29sb3IgKyBvbmVWYWx1ZUNvbG9yMjA7XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuXG4gIH1cbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gMjAwMDAwMDAwMDAwMDAwMCkge1xuICAgIC8vY2FsZUNhcmRzLnNvcnQoS1FDYXJkLnNvcnQpO1xuICAgIC8v5Lik5a+5LOacieWPr+iDvemcgOimgeavlDXlvKDniYxcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWUgPSAnJztcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICB2YXIgb25lVmFsdWVDb2xvciA9IFwiXCI7Ly/niYzoibJcbiAgICBmb3IodmFyIGkgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICBpZihwb2ludEhlbHBlci5wb2ludE51bWJlcnNbaV0gPT0gMikgey8v5Lik5a+5XG4gICAgICAgIGZvcih2YXIgdyBpbiBjYWxlQ2FyZHMpIHtcbiAgICAgICAgICBpZihpID09IGNhbGVDYXJkc1t3XS5zY29yZXMpe1xuICAgICAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICAgICAgc3RyID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgc3RyO1xuICAgICAgICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbd10uY29sb3I7Ly/niYzoibJcbiAgICAgICAgICAgIHZhbHVlQ29sb3IgPSBjICsgdmFsdWVDb2xvcjsvL+eJjOiJslxuXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgZm9yKHZhciBxIGluIGNhbGVDYXJkcykgey8v5Y2V5byg5Yqg6Iqx6ImyXG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbcV0uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcbiAgICAgICAgICAgIG9uZVZhbHVlID0gKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpICsgb25lVmFsdWU7XG5cbiAgICAgICAgICAgIHZhciBjID0gY2FsZUNhcmRzW3FdLmNvbG9yOy8v54mM6ImyXG4gICAgICAgICAgICBvbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvciArIGM7Ly/niYzoibJcblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9XG5cbiAgICB9XG4gICAgY2MubG9nKHN0cilcbiAgICBjYy5sb2cob25lVmFsdWUpXG4gICAgc3RyID0gc3RyK29uZVZhbHVlICtvbmVWYWx1ZUNvbG9yICsgdmFsdWVDb2xvcjtcbiAgICByZXR1cm4gdHlwZVNjb3JlK3BhcnNlSW50KHN0cik7XG4gIH1cbiAgZWxzZSBpZih0eXBlU2NvcmUgPT0gMTAwMDAwMDAwMDAwMDAwMCkge1xuICAgIC8v5a+55a2QXG4gICAgLy9jYWxlQ2FyZHMuc29ydChLUUNhcmQuc29ydCk7XG4gICAgdmFyIHN0ciA9IFwiXCI7XG4gICAgdmFyIG9uZVZhbHVlID0gXCJcIjtcbiAgICB2YXIgb25lVmFsdWVDb2xvciA9IFwiXCI7XG4gICAgdmFyIHZhbHVlQ29sb3IgPSBcIlwiO1xuXG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApe1xuICAgICAgY2FsZUNhcmRzLnNvcnQoZnVuY3Rpb24oY2FyZDEsY2FyZDIpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQyLnBvaW50LWNhcmQxLnBvaW50O1xuICAgICAgfSk7XG4gICAgICBjYWxlQ2FyZHMgPSBjYWxlQ2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICAgIGNhbGVDYXJkcy5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQsaW5kZXgpIHtcbiAgICAgICAgdmFyIHMgPSBjYXJkLnNjb3JlcztcbiAgICAgICAgdmFyIGMgPSBjYXJkLmNvbG9yO1xuICAgICAgICBzdHIgPSBzdHIrKHBhcnNlSW50KHMpPj0xMCA/IHMgOlwiMFwiK3MpO1xuICAgICAgICBpZihpbmRleCA9PSAwKXtcbiAgICAgICAgICB2YXIgczIwID0gY2FyZDIwWzBdLnNjb3JlcztcbiAgICAgICAgICBzdHIgPSBzdHIrKHBhcnNlSW50KHMyMCk+PTEwID8gczIwIDpcIjBcIitzMjApO1xuICAgICAgICAgIHZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yK2M7XG4gICAgICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrY2FyZDIwWzBdLmNvbG9yO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICBvbmVWYWx1ZUNvbG9yID0gb25lVmFsdWVDb2xvcitjO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGNjLmxvZyhzdHIpXG4gICAgICBjYy5sb2coJy0tLS0tLS0tMjc0JylcbiAgICAgIGlmKGlzVG91KXtcbiAgICAgICAgc3RyID0gc3RyKycwMDAwJztcbiAgICAgICAgdmFsdWVDb2xvciA9IHZhbHVlQ29sb3IrJzAwJztcbiAgICAgIH1cbiAgICAgIHN0ciA9IHN0ciArIG9uZVZhbHVlQ29sb3IgKyB2YWx1ZUNvbG9yO1xuICAgICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICAgIH1cblxuICAgIGZvcih2YXIgaSBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgIGlmKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tpXSA9PSBtYXhOdW0pIHsvL+WvueWtkFxuICAgICAgICBmb3IodmFyIHcgaW4gY2FsZUNhcmRzKSB7Ly/lr7nlrZDliqDoirHoibJcbiAgICAgICAgICBpZihpID09IGNhbGVDYXJkc1t3XS5zY29yZXMpe1xuICAgICAgICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbd10uc2NvcmVzO1xuICAgICAgICAgICAgdmFsdWVDb2xvciA9IGNhbGVDYXJkc1t3XS5jb2xvciArIHZhbHVlQ29sb3I7XG4gICAgICAgICAgICBzdHIgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBzdHI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgZm9yKHZhciBxIGluIGNhbGVDYXJkcykgey8v5Y2V5byg5Yqg6Iqx6ImyXG4gICAgICAgICAgaWYoaSA9PSBjYWxlQ2FyZHNbcV0uc2NvcmVzKXtcbiAgICAgICAgICAgIHZhciBzID0gY2FsZUNhcmRzW3FdLnNjb3JlcztcbiAgICAgICAgICAgIG9uZVZhbHVlQ29sb3IgPSBjYWxlQ2FyZHNbcV0uY29sb3IgKyBvbmVWYWx1ZUNvbG9yO1xuICAgICAgICAgICAgb25lVmFsdWUgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyBvbmVWYWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuXG4gICAgfVxuICAgIC8vY2MubG9nKG9uZVZhbHVlQ29sb3IpXG4gICAgLy9jYy5sb2codmFsdWVDb2xvcilcbiAgICBpZihpc1RvdSl7XG4gICAgICBvbmVWYWx1ZSA9IG9uZVZhbHVlKycwMDAwJztcbiAgICAgIHZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yKycwMCc7XG4gICAgfVxuICAgIHN0ciA9IHN0citvbmVWYWx1ZStvbmVWYWx1ZUNvbG9yK3ZhbHVlQ29sb3I7XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludChzdHIpO1xuICB9XG4gIGVsc2UgaWYodHlwZVNjb3JlID09IDApIHtcbiAgICAvL+S5jOm+mVxuICAgIHZhciB2YWx1ZVBvaW50ID0gXCJcIjtcbiAgICB2YXIgdmFsdWVDb2xvciA9IFwiXCI7XG4gICAgZm9yKHZhciBxIGluIGNhbGVDYXJkcykge1xuICAgICAgdmFyIHMgPSBjYWxlQ2FyZHNbcV0uc2NvcmVzO1xuICAgICAgdmFyIGMgPSBjYWxlQ2FyZHNbcV0uY29sb3I7Ly/ljZXlvKDliqDoirHoibJcbiAgICAgIHZhbHVlUG9pbnQgPSAocGFyc2VJbnQocyk+PTEwID8gcyA6XCIwXCIrcykgKyB2YWx1ZVBvaW50O1xuICAgICAgdmFsdWVDb2xvciA9IGMgKyB2YWx1ZUNvbG9yO1xuICAgIH1cbiAgICBpZihpc1RvdSl7XG4gICAgICB2YWx1ZVBvaW50ID0gdmFsdWVQb2ludCsnMDAwMCc7XG4gICAgICB2YWx1ZUNvbG9yID0gdmFsdWVDb2xvcisnMDAnO1xuICAgIH1cbiAgICB2YWx1ZVBvaW50ID0gdmFsdWVQb2ludCArIHZhbHVlQ29sb3I7XG4gICAgcmV0dXJuIHR5cGVTY29yZStwYXJzZUludCh2YWx1ZVBvaW50KTtcbiAgfVxuXG5cbiAgdmFyIGNhcmRzVG90YWxQb2ludD0wO1xuICBjYWxlQ2FyZHMuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgY2FyZHNUb3RhbFBvaW50ICs9IGNhcmQucG9pbnQ7XG4gIH0pO1xuXG4gIGxldCByZXN1bHQgPSB0eXBlU2NvcmUgKyBjYXJkc1RvdGFsUG9pbnQ7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuS1FDYXJkLl9jaGFuZ2VDYXJkU2NvcnMgPSBmdW5jdGlvbihjYXJkTW9kZWwpIHtcbiAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGNhcmQuc2NvcmVzID0gY2FyZC5wb2ludDtcbiAgICBpZiAoY2FyZC5zY29yZXMgPT0gMTQpIHtcbiAgICAgIGNhcmQuc2NvcmVzID0gMTtcbiAgICB9XG4gIH0pO1xuICB2YXIgaXMxNCA9IGZhbHNlOy8v5pivIGsgcSBqIDEwIEE7XG4gIHZhciBpczEgPSBmYWxzZTsvL+S4jeaYrzEgMiAzIDQgNVxuICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7XG4gICAgaWYgKGNhcmQuc2NvcmVzIDwgOSkge1xuICAgICAgaXMxNCA9IHRydWU7IC8v5LiN5pivIGsgcSBqIDEwIEE7XG4gICAgICBpZiAoY2FyZC5zY29yZXMgPCA2ICYmIGNhcmQuc2NvcmVzID4gMSApIHtcbiAgICAgICAgaXMxID0gdHJ1ZTsvL+aYrzEgMiAzIDQgNVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cblxuICBpZiAoaXMxNCkgeyAvL+S4jeaYryBrIHEgaiAxMCBBO1xuICAgIGNhcmRNb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgIGlmIChjYXJkLnNjb3JlcyA9PSAxNCkge1xuICAgICAgICBjYXJkLnNjb3JlcyA9IDE7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgaWYgKGlzMTQgJiYgIWlzMSkgeyAvL+S4jeaYryBrIHEgaiAxMCBBO1xuICAgIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge1xuICAgICAgcmV0dXJuIGExLnNjb3JlcyAtIGEyLnNjb3JlcztcbiAgICB9KTtcblxuICAgIHZhciBzY29yZXNBeXkgPSBbXTsgLy/kuIDlia/niYznmoTliIbmlbBcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xuICAgICAgdmFyIHMgPSBwYXJzZUludChjYXJkTW9kZWxbMF0uc2NvcmVzKSArIGk7IC8v5pyA5bCP55qE54mM55qE5YiG5pWwXG4gICAgICBzY29yZXNBeXkucHVzaChzKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBzY29yZXNBeXkubGVuZ3RoOyBqKyspIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZE1vZGVsLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjYXJkU2NvcmVzID0gY2FyZE1vZGVsW2ldLnNjb3JlcztcbiAgICAgICAgaWYgKGNhcmRTY29yZXMgPT0gc2NvcmVzQXl5W2pdICYmIGNhcmRTY29yZXMgPCAxNSkge1xuICAgICAgICAgIHNjb3Jlc0F5eS5zcGxpY2UoaiwgMSk7IC8v5Yig6Zmk5LiN5piv6ay854mM55qE5YiGXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkgeyAvL+aUueWPmOeJjOeahOWIhuaVsFxuICAgICAgaWYgKGNhcmQucG9pbnQgPj0gMjApIHtcbiAgICAgICAgY2FyZC5zY29yZXMgPSBzY29yZXNBeXkuc3BsaWNlKDAsMSlbMF07XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfSBlbHNlIHsgLy/mmK8gayBxIGogMTAgQTtcbiAgICBjYXJkTW9kZWwuc29ydChmdW5jdGlvbihhMSwgYTIpIHtcbiAgICAgIHJldHVybiBhMi5zY29yZXMgLSBhMS5zY29yZXM7XG4gICAgfSk7XG4gICAgdmFyIG51bSA9IDE0O1xuICAgIGlmKGlzMSl7Ly/mmK8xIDIgMyA0IDVcbiAgICAgIG51bSA9IDU7XG4gICAgfVxuICAgIHZhciBzY29yZXNBeXkgPSBbXTsgLy/kuIDlia/niYznmoTliIbmlbBcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xuICAgICAgc2NvcmVzQXl5LnB1c2gobnVtKTtcbiAgICAgIG51bSAtPSAxO1xuICAgIH1cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNjb3Jlc0F5eS5sZW5ndGg7IGorKykge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkTW9kZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGNhcmRTY29yZXMgPSBjYXJkTW9kZWxbaV0uc2NvcmVzO1xuICAgICAgICBpZiAoY2FyZFNjb3JlcyA9PSBzY29yZXNBeXlbal0gJiYgY2FyZFNjb3JlcyA8IDE1KSB7XG4gICAgICAgICAgc2NvcmVzQXl5LnNwbGljZShqLCAxKTsgLy/liKDpmaTkuI3mmK/prLzniYznmoTliIZcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBjYy5sb2coc2NvcmVzQXl5KVxuICAgIGNjLmxvZyhjYXJkTW9kZWwpXG4gICAgY2MubG9nKCctLS0tLS0tLS0tNDEyJylcbiAgICBjYXJkTW9kZWwuZm9yRWFjaChmdW5jdGlvbihjYXJkKSB7IC8v5om+5Ye66YCJ5Lit55qE54mMXG4gICAgICBpZiAoY2FyZC5wb2ludCA+PSAyMCkge1xuICAgICAgICBjYXJkLnNjb3JlcyA9IHNjb3Jlc0F5eS5zcGxpY2UoMCwgMSlbMF07XG4gICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgICBjYy5sb2coY2FyZE1vZGVsKVxuICB9XG5cbiAgY2FyZE1vZGVsLmZvckVhY2goZnVuY3Rpb24oY2FyZCkge1xuICAgIGlmIChjYXJkLnNjb3JlcyA9PSAxKSB7XG4gICAgICBjYXJkLnNjb3JlcyA9IDE0O1xuICAgIH1cbiAgfSk7XG4gIGNhcmRNb2RlbC5zb3J0KGZ1bmN0aW9uKGExLCBhMikge1xuICAgIHJldHVybiBhMS5zY29yZXMgLSBhMi5zY29yZXM7XG4gIH0pO1xuICByZXR1cm4gY2FyZE1vZGVsO1xufTtcbi8qIyMjIyMqL1xuS1FDYXJkLnNjb3JlT2ZDYXJkczIgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgaWYoY2FyZHMgPT0gbnVsbCB8fCBjYXJkcy5sZW5ndGggPT0gbnVsbCkge1xuICAgIGNhcmRzID0gW107XG4gIH1cbiAgaWYodHlwZW9mKGNhcmRzWzBdLnBvaW50KSA9PSAndW5kZWZpbmVkJyl7XG4gICAgY2FyZHMgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZHMpO1xuICB9XG4gIHZhciBjYWxlQ2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRPbmVUb0EoY2FyZHMuc2xpY2UoKSk7XG4gIGNhbGVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0KVxuICAvL3ZhciBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FsZUNhcmRzKTtcbiAgdmFyIHZhbHVlU3RyID0gXCJcIjtcbiAgZm9yKHZhciBpIGluIGNhbGVDYXJkcykge1xuICAgIGxldCBzID0gY2FsZUNhcmRzW2ldLnBvaW50O1xuICAgIHZhbHVlU3RyID0gKHBhcnNlSW50KHMpPj0xMD9zOlwiMFwiK3MpK3ZhbHVlU3RyO1xuICAgIGlmKGkgPT0gNCl7XG4gICAgICB2YWx1ZVN0ciA9ICcuJyt2YWx1ZVN0cjtcbiAgICB9XG4gIH1cbiAgLy9jYy5sb2coTnVtYmVyKHZhbHVlU3RyKSlcbiAgLy9jYy5sb2codmFsdWVTdHIpXG4gIC8vY2MubG9nKCctLS0tLS0tLS3nibnmrorniYznrpfliIYnKVxuICByZXR1cm4gdmFsdWVTdHI7XG59O1xuXG5LUUNhcmQuX3R5cGVTY29yZU9mQ2FyZHMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgdmFyIHR5cGVTY29yZSA9IDA7XG4gIGlmKEtRQ2FyZC5jb250YWluV3VUb25nKGNhcmRzKSl7XG4gICAgdHlwZVNjb3JlID0gOTAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDgwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gNzAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkh1THUoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gNjAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWEoY2FyZHMpKSB7XG4gICAgdHlwZVNjb3JlID0gNTAwMDAwMDAwMDAwMDAwMDtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblNodW5aaShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSA0MDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSAzMDAwMDAwMDAwMDAwMDAwO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluTGlhRHVpKGNhcmRzKSkge1xuICAgIHR5cGVTY29yZSA9IDIwMDAwMDAwMDAwMDAwMDA7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkcykpIHtcbiAgICB0eXBlU2NvcmUgPSAxMDAwMDAwMDAwMDAwMDAwO1xuICB9XG5cbiAgcmV0dXJuIHR5cGVTY29yZTtcbn07XG5cbi8vIOagueaNrueJjOWei+i/m+ihjOaOkuW6j1xuS1FDYXJkLl90eXBlQ2FyZHNTb3J0ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gIGlmICgoY2FyZHMgPT0gbnVsbCkgfHwgKGNhcmRzLmxlbmd0aCA9PSAwKSkge1xuICAgIHJldHVybiBjYXJkcztcbiAgfVxuICBpZihLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpe1xuICAgIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRXdXRvbmcoY2FyZHMpO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4oY2FyZHMpKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFNodW5aaShjYXJkcyk7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5UaWVaaGkoY2FyZHMpKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFRpZVpoaShjYXJkcyk7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5IdUx1KGNhcmRzKSkge1xuICAgIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRIdUx1KGNhcmRzKTtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWEoY2FyZHMpKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydFRvbmdIdWEoY2FyZHMpO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2h1blppKGNhcmRzKSkge1xuICAgIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnRTaHVuWmkoY2FyZHMpO1xuICB9IGVsc2UgaWYgKEtRQ2FyZC5jb250YWluU2FuVGlhbyhjYXJkcykpIHtcbiAgICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0U2FuVGlhbyhjYXJkcyk7XG4gIH0gZWxzZSBpZiAoS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZHMpKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydExpYW5nRHVpKGNhcmRzKTtcbiAgfSBlbHNlIGlmIChLUUNhcmQuY29udGFpbkR1aVppKGNhcmRzKSkge1xuICAgIHJldHVybiBLUUNhcmQuX3R5cGVDYXJkc1NvcnREdWlaaShjYXJkcyk7XG4gIH1cblxuICByZXR1cm4gY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpLnJldmVyc2UoKTtcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydFNodW5aaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICByZXR1cm4gY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpLnJldmVyc2UoKTtcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydFRpZVpoaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkcyk7XG59O1xuXG4vKiMjIyMjKi9cbktRQ2FyZC5fdHlwZUNhcmRzU29ydFd1dG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICByZXR1cm4gS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyhjYXJkcyk7XG59O1xuLyojIyMjIyovXG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydEh1THUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xufTtcblxuS1FDYXJkLl90eXBlQ2FyZHNTb3J0VG9uZ0h1YSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICByZXR1cm4gY2FyZHMuc29ydChLUUNhcmQuc29ydEJ5UG9pbnQpLnJldmVyc2UoKTtcbn07XG5cbktRQ2FyZC5fdHlwZUNhcmRzU29ydFNhblRpYW8gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xufTtcblxuS1FDYXJkLl90eXBlQ2FyZHNTb3J0TGlhbmdEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xufTtcblxuS1FDYXJkLl90eXBlQ2FyZHNTb3J0RHVpWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgcmV0dXJuIEtRQ2FyZC5fdHlwZUNhcmRzU29ydEJ5TnVtYmVyT2ZQb2ludHMoY2FyZHMpO1xufTtcblxuS1FDYXJkLl90eXBlQ2FyZHNTb3J0QnlOdW1iZXJPZlBvaW50cyA9IGZ1bmN0aW9uKGNhcmRzKSB7XG4gIGxldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRTY29yZXRzSGVscGVyKGNhcmRzKTtcbiAgbGV0IG5ld0NhcmRzID0gY2FyZHMuc2xpY2UoKS5zb3J0KGZ1bmN0aW9uKGNhcmQxLCBjYXJkMikge1xuICAgIGxldCBudW1iZXJPZkNhcmQxID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW2NhcmQxLnBvaW50XTtcbiAgICBsZXQgbnVtYmVyT2ZDYXJkMiA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1tjYXJkMi5wb2ludF07XG5cbiAgICBpZiAobnVtYmVyT2ZDYXJkMiAhPSBudW1iZXJPZkNhcmQxKSB7XG4gICAgICByZXR1cm4gbnVtYmVyT2ZDYXJkMiAtIG51bWJlck9mQ2FyZDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNhcmQyLnBvaW50IC0gY2FyZDEucG9pbnQ7XG4gIH0pO1xuXG4gIHJldHVybiBuZXdDYXJkcztcbn07XG5cbktRQ2FyZC50ZXN0U2NvcmUgPSBmdW5jdGlvbigpIHtcblxufTsiLCIvLyDniYzngrnmlbDluK7liqnnsbtcclxuLy8g55So5p2l6K6h566X5LiA5Liq54mM5pWw57uE5YaF55qE55u45ZCM54K55pWw55qE54mM55qE5byg5pWwXHJcbnZhciBLUUNhcmRTY29yZXRzSGVscGVyID0gZnVuY3Rpb24gKGNhcmRzKSB7XHJcbiAgICB0aGlzLnBvaW50TnVtYmVycyA9IHt9O1xyXG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgIGxldCBwb2ludCA9IGNhcmQuc2NvcmVzO1xyXG4gICAgICAgIHZhciBudW1iZXIgPSB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gfHwgMDtcclxuICAgICAgICB0aGlzLnBvaW50TnVtYmVyc1twb2ludF0gPSBudW1iZXIgKyAxO1xyXG4gICAgfS5iaW5kKHRoaXMpKTtcclxufTtcclxuXHJcbi8vIOebuOWQjOeCueaVsOeJjOeahOacgOWkp+aVsOmHj1xyXG5LUUNhcmRTY29yZXRzSGVscGVyLnByb3RvdHlwZS5tYXhOdW1iZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIHJlc3VsdCA9IDA7XHJcbiAgZm9yIChsZXQgcHJvcCBpbiB0aGlzLnBvaW50TnVtYmVycykge1xyXG4gICAgbGV0IG51bWJlciA9IHRoaXMucG9pbnROdW1iZXJzW3Byb3BdO1xyXG4gICAgICAvL2lmKG51bWJlciA8IDIwKXtcclxuICAgICAgICAgIHJlc3VsdCA9IE1hdGgubWF4KG51bWJlciwgcmVzdWx0KTtcclxuICAgICAgLy99XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzdWx0O1xyXG59O1xyXG5cclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEtRQ2FyZFNjb3JldHNIZWxwZXI7XHJcblxyXG4vKnZhciBjYXJkcyA9IFtcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoyfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoyfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo0fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo0fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo2fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo2fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo4fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjo4fSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMH0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTB9LFxyXG4gICAgeydzdWl0JzoncycsbnVtYmVyOjEyfSxcclxuICAgIHsnc3VpdCc6J3MnLG51bWJlcjoxMn0sXHJcbiAgICB7J3N1aXQnOidzJyxudW1iZXI6MTR9XHJcbl07XHJcbnZhciB0ZXN0ID0gbmV3IEtRQ2FyZFBvaW50c1NhbWUoY2FyZHMpO1xyXG5jb25zb2xlLmxvZyh0ZXN0KTsqL1xyXG4iLCJjb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcblxuLy8g54mM6Ieq5Yqo6YCJ5oup55qE5omp5bGVXG5cbi8qKlxuICog6Ieq5Yqo6YCJ5oup54mM77yM55Sx5aSn5Yiw5bCPXG4gKlxuICogQHBhcmFtICB7W0tRQ2FyZF19IG9yaWdpbkNhcmRzICDooqvpgInmi6nnmoTljp/lp4vniYzmlbDnu4RcbiAqXG4gKiBAcmV0dXJuIHtbS1FDYXJkXX1cbiAqL1xuS1FDYXJkLmF1dG9TZWxlY3RDYXJkcyA9IGZ1bmN0aW9uKG9yaWdpbkNhcmRzLCBtYXhMZW5ndGgpIHtcbiAgICBpZiAob3JpZ2luQ2FyZHMubGVuZ3RoIDw9IG1heExlbmd0aCkge1xuICAgICAgICByZXR1cm4gb3JpZ2luQ2FyZHM7XG4gICAgfVxuICAgIG9yaWdpbkNhcmRzLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgICAgIGlmKGNhcmQuc2NvcmVzID09IDEpe1xuICAgICAgICAgICAgY2FyZC5zY29yZXMgPSAxNDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGxldCBjYXJkcyA9IG9yaWdpbkNhcmRzLnNsaWNlKCkuc29ydChmdW5jdGlvbihhLGIpe1xuICAgICAgICByZXR1cm4gYS5zY29yZXMgLSBiLnNjb3JlcztcbiAgICB9KTtcbiAgICAvL2NjLmxvZyhjYXJkcylcbiAgICAvL2NjLmxvZyhvcmlnaW5DYXJkcylcbiAgICAvL2NjLmxvZygnLS0tLS0tLS0yNScpXG4gICAgLy9jYXJkcy5zb3J0KGZ1bmN0aW9uKGEsYil7XG4gICAgLy8gICAgcmV0dXJuIGEuc2NvcmVzIC0gYi5zY29yZXM7XG4gICAgLy99KTtcbiAgICAvL29yaWdpbkNhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BKG9yaWdpbkNhcmRzKTtcblxuICAgIGxldCBmaW5kRnVuY3MgPSBbXG4gICAgICAgIEtRQ2FyZC5maW5kV3VUb25nLFxuICAgICAgICBLUUNhcmQuZmluZFRvbmdIdWFTaHVuLFxuICAgICAgICBLUUNhcmQuZmluZFRpZVpoaSxcbiAgICAgICAgS1FDYXJkLmZpbmRIdUx1LFxuICAgICAgICBLUUNhcmQuZmluZFRvbmdIdWEsXG4gICAgICAgIEtRQ2FyZC5maW5kU2h1blppLFxuICAgICAgICBLUUNhcmQuZmluZFNhblRpYW8sXG4gICAgICAgIEtRQ2FyZC5maW5kTGlhRHVpLFxuICAgICAgICBLUUNhcmQuZmluZER1aVppXG4gICAgXTtcblxuICAgIGxldCBpbmRleEFycmF5cyA9IG51bGw7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaW5kRnVuY3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgbGV0IGZ1bmMgPSBmaW5kRnVuY3NbaV07XG4gICAgICAgIGluZGV4QXJyYXlzID0gKGZ1bmMuYmluZChLUUNhcmQpKShjYXJkcyk7XG4gICAgICAgIGlmIChpbmRleEFycmF5cyAmJiBpbmRleEFycmF5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBpbmRleHMgPSBbXTtcbiAgICBpZiAoaW5kZXhBcnJheXMgJiYgaW5kZXhBcnJheXMubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyDmib7lh7rlkIznsbvlnovnmoTniYzph4znmoTliIbmlbDmnIDlpKfnmoTniYxcbiAgICAgICAgdmFyIG1heFNjb3JlID0gMDtcbiAgICAgICAgaW5kZXhBcnJheXMuZm9yRWFjaCh0ZW1wSW5kZXhzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBDYXJkcyA9IHRlbXBJbmRleHMubWFwKGluZGV4ID0+IGNhcmRzW2luZGV4XSk7XG4gICAgICAgICAgICBjb25zdCBzY29yZSA9IEtRQ2FyZC5zY29yZU9mQ2FyZHModGVtcENhcmRzKTtcbiAgICAgICAgICAgIGlmIChzY29yZSA+IG1heFNjb3JlKSB7XG4gICAgICAgICAgICAgICAgbWF4U2NvcmUgPSBzY29yZTtcbiAgICAgICAgICAgICAgICBpbmRleHMgPSB0ZW1wSW5kZXhzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBsZXQgdGFyZ2V0Q2FyZHMgPSBpbmRleHMubWFwKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIHJldHVybiBjYXJkc1tpbmRleF07XG4gICAgfSk7XG5cbiAgICBpZiAodGFyZ2V0Q2FyZHMubGVuZ3RoIDwgbWF4TGVuZ3RoKSB7XG4gICAgICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXModGFyZ2V0Q2FyZHMpO1xuICAgICAgICB3aGlsZSh0YXJnZXRDYXJkcy5sZW5ndGggPCBtYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHRhcmdldENhcmRzLnB1c2goY2FyZHMucG9wKCkpO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICh0YXJnZXRDYXJkcy5sZW5ndGggPiBtYXhMZW5ndGgpIHtcbiAgICAgICAgdGFyZ2V0Q2FyZHMgPSB0YXJnZXRDYXJkcy5zbGljZShvLCBtYXhMZW5ndGgpO1xuICAgIH1cblxuICAgIHJldHVybiB0YXJnZXRDYXJkcztcbn07XG5cbktRQ2FyZC50ZXN0QXV0b1NlbGVjdCA9IGZ1bmN0aW9uKGNhcmRzKSB7XG5cbn07IiwiY29uc3QgS1FDYXJkQ29sb3JzSGVscGVyID0gcmVxdWlyZSgnS1FDYXJkQ29sb3JzSGVscGVyJyk7XG5jb25zdCBLUUNhcmRQb2ludHNIZWxwZXIgPSByZXF1aXJlKCdLUUNhcmRQb2ludHNIZWxwZXInKTtcbmNvbnN0IE51bWJlckV4dGVuc2lvbiA9IHJlcXVpcmUoJ051bWJlckV4dGVuc2lvbicpO1xuY29uc3QgR2V0Q2FyZFBvaW50c1NhbWVDb3VudCA9IHJlcXVpcmUoJ0dldENhcmRQb2ludHNTYW1lQ291bnQnKTtcblxuY2MgPSBjYyB8fCB7fTtcbmNjLmFzc2VydCA9IGNjLmFzc2VydCB8fCBjb25zb2xlLmFzc2VydCB8fCBmdW5jdGlvbiAoKSB7fTtcbmNjLmxvZyA9IGNjLmxvZyB8fCBjb25zb2xlLmxvZyB8fCBmdW5jdGlvbiAoKSB7fTtcbmNjLmVycm9yID0gY2MuZXJyb3IgfHwgY29uc29sZS5lcnJvciB8fCBmdW5jdGlvbiAoKSB7fTtcblxuLy8g54mMIE1vZGVsIOexu++8jOWwgeijheS6huiKseiJsuWSjOeCueaVsFxuLy8g5L2/55So77yaXG4vLyBuZXcgS1FDYXJkKDIyKTtcbnZhciBLUUNhcmQgPSBmdW5jdGlvbiAocG9pbnQsIGNvbG9yICxpbmRleCkge1xuICAgIHRoaXMuY29sb3IgPSBudWxsO1xuICAgIHRoaXMucG9pbnQgPSBudWxsO1xuICAgIHRoaXMuc2luZGV4ID0gaW5kZXg7XG4gICAgdGhpcy5faW5pdFdpdGhDb2xvckFuZFBvaW50ID0gZnVuY3Rpb24gKGNvbG9yLCBwb2ludCkge1xuICAgICAgICBpZiAoY29sb3IgPT0gJ3MnKSB7IGNvbG9yID0gNDt9XG4gICAgICAgIGlmIChjb2xvciA9PSAnaCcpIHsgY29sb3IgPSAzO31cbiAgICAgICAgaWYgKGNvbG9yID09ICdjJykgeyBjb2xvciA9IDI7fVxuICAgICAgICBpZiAoY29sb3IgPT0gJ2QnKSB7IGNvbG9yID0gMTt9XG5cbiAgICAgICAgdGhpcy5wb2ludCA9IE51bWJlcihwb2ludCk7XG4gICAgICAgIHRoaXMuc2NvcmVzID0gTnVtYmVyKHBvaW50KTtcbiAgICAgICAgdGhpcy5jb2xvciA9IE51bWJlcihjb2xvcik7XG4gICAgICAgIHRoaXMuY29sb3JTY29yZXMgPSBOdW1iZXIoY29sb3IpO1xuXG4gICAgICAgIGNjLmFzc2VydCh0aGlzLnBvaW50ID4gMCk7XG4gICAgICAgIGNjLmFzc2VydCh0aGlzLmNvbG9yID4gMCk7XG4gICAgfTtcblxuICAgIHRoaXMuX2luaXRXaXRoTnVtYmVyID0gZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICB0aGlzLnBvaW50ID0gTWF0aC5mbG9vcihudW1iZXIgLyAxMCk7XG4gICAgICAgIHRoaXMuY29sb3IgPSBudW1iZXIgJSAxMDtcbiAgICAgICAgY2MuYXNzZXJ0KHRoaXMucG9pbnQgPiAwKTtcbiAgICAgICAgY2MuYXNzZXJ0KHRoaXMuY29sb3IgPiAwKTtcbiAgICB9O1xuXG4gICAgdGhpcy5faW5pdFdpdGhPYmplY3QgPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgICAgIGlmIChvYmplY3QucG9pbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludChvYmplY3QuY29sb3IsIG9iamVjdC5wb2ludCk7XG4gICAgICAgIH0gZWxzZSBpZiAob2JqZWN0LnN1aXQpIHtcbiAgICAgICAgICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludChvYmplY3Quc3VpdCwgb2JqZWN0Lm51bWJlcik7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FyZE5hbWUoKTtcbiAgICB9O1xuXG4gICAgdGhpcy5jYXJkTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sb3IgKyBcIl9cIiArIHRoaXMucG9pbnQ7XG4gICAgfTtcblxuICAgIHRoaXMuc29ydCA9IGZ1bmN0aW9uIChvdGhlckNhcmQsIGFzYyA9IGZhbHNlLCBBaXNNYXggPSB0cnVlKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuc29ydCh0aGlzLCBvdGhlckNhcmQsIGFzYywgQWlzTWF4KTtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyQ2FyZCkge1xuICAgICAgICBpZiAoIW90aGVyQ2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAodGhpcy5wb2ludCA9PSBvdGhlckNhcmQucG9pbnQpICYmICh0aGlzLmNvbG9yID09IG90aGVyQ2FyZC5jb2xvcilcbiAgICAgICAgICAgICYmICh0aGlzLnNpbmRleCA9PSBvdGhlckNhcmQuc2luZGV4KTtcbiAgICB9O1xuXG4gICAgaWYgKHBvaW50ICYmIGNvbG9yKSB7XG4gICAgICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludChjb2xvciwgcG9pbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG51bWJlciA9IE51bWJlcihwb2ludCk7XG4gICAgaWYgKCFOdW1iZXIuaXNOYU4obnVtYmVyKSkge1xuICAgICAgICB0aGlzLl9pbml0V2l0aE51bWJlcihudW1iZXIpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZihwb2ludCkgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgLy8g6Kej5p6QIHh4eHhkX2Qg5b2i5byPXG4gICAgICAgIGxldCBmb3VuZCA9IHBvaW50Lm1hdGNoKC8oXFwuKSpcXGRfXFxkKy8pO1xuICAgICAgICBpZiAoKGZvdW5kIGluc3RhbmNlb2YgQXJyYXkpICYmIGZvdW5kLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBmb3VuZFswXTtcbiAgICAgICAgICAgIGxldCBudW1iZXJzID0gcmVzdWx0LnNwbGl0KCdfJyk7XG5cbiAgICAgICAgICAgIGxldCBjb2xvciA9IE51bWJlcihudW1iZXJzWzBdKTtcbiAgICAgICAgICAgIGxldCBwb2ludCA9IE51bWJlcihudW1iZXJzWzFdKTtcbiAgICAgICAgICAgIHRoaXMuX2luaXRXaXRoQ29sb3JBbmRQb2ludChjb2xvciwgcG9pbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YocG9pbnQpID09ICdvYmplY3QnKSB7XG4gICAgICAgIHRoaXMuX2luaXRXaXRoT2JqZWN0KHBvaW50KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNjLmVycm9yKFwi5Yid5aeL5YyW6ZSZ6K+v77yaXCIgKyBwb2ludCArIFwiIFwiICsgY29sb3IpO1xufTtcblxuLy8g6L2s5o2i5oiQ5pyN5Yqh5Zmo55qE54mMIG1vZGVsXG5LUUNhcmQucHJvdG90eXBlLnRvU2VydmVyQ2FyZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICAnc3VpdCc6IHRoaXMuY29sb3IsXG4gICAgICAgICdudW1iZXInOiB0aGlzLnBvaW50LFxuICAgIH07XG59O1xuXG5LUUNhcmQuQ09MT1JfU1BBREUgICA9IDQ7XG5LUUNhcmQuQ09MT1JfSEVBUlQgICA9IDM7XG5LUUNhcmQuQ09MT1JfQ0xVQiAgICA9IDI7XG5LUUNhcmQuQ09MT1JfRElBTU9ORCA9IDE7XG5cbm1vZHVsZS5leHBvcnRzID0gS1FDYXJkO1xuXG5LUUNhcmQuY2FyZHNGcm9tQXJyYXkgPSBmdW5jdGlvbiAoY2FyZE5hbWVzKSB7XG4gICAgcmV0dXJuIGNhcmROYW1lcy5tYXAoZnVuY3Rpb24gKGNhcmROYW1lLGluZGV4KSB7XG4gICAgICAgIHJldHVybiBuZXcgS1FDYXJkKGNhcmROYW1lLG51bGwsaW5kZXgpO1xuICAgIH0pO1xufTtcblxuLy8g5bCG5aSa5byg54mM6L2s5o2i5oiQ5pyN5Yqh5Zmo55qE5b2i5byPXG5LUUNhcmQuY29udmVydFRvU2VydmVyQ2FyZHMgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICByZXR1cm4gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLnRvU2VydmVyQ2FyZCgpO1xuICAgIH0pO1xufTtcblxuS1FDYXJkLlRZUEUgPSB7XG4gICAgV3VMb25nOiAwLFxuICAgIER1aVppOiAxLFxuICAgIExpYW5nRHVpOiAyLFxuICAgIFNhblRpYW86IDMsXG4gICAgU2h1blppOiA0LFxuICAgIFRvbmdIdWE6IDUsXG4gICAgSHVMdTogNixcbiAgICBUaWVaaGk6IDcsXG4gICAgVG9uZ0h1YVNodW46IDgsXG4gICAgLyojIyMjIyovXG4gICAgV3VUb25nOjksXG4gICAgLyojIyMjIyovXG4gICAgU2FuVGFvSHVhOiAxMCwgIC8vIOeJueauiueJjFxuICAgIFNhblNodW5aaTogMTEsXG4gICAgTGl1RHVpQmFuOiAxMixcblxuICAgIFd1RHVpU2FuVGlhbzoxMyxcbiAgICBTaVRhb1NhblRpYW86IDE0LFxuXG4gICAgQ291WWlTZTogMTUsXG4gICAgU2FuRmVuVGlhblhpYTogMTYsXG4gICAgU2FuVG9uZ0h1YVNodW46IDE3LFxuICAgIFlpVGlhb0xvbmc6IDE4LFxuICAgIFFpbmdMb25nOiAxOSxcbn07XG5cbi8vIOeJjOexu+Wei+WQjVxuS1FDYXJkLmNhcmRzVHlwZU5hbWUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbmFtZXMgPSBbJ+S5jOm+mScsICflr7nlrZAnLCAn5Lik5a+5JywgJ+S4ieadoScsICfpobrlrZAnLCAn5ZCM6IqxJywgJ+iRq+iKpicsICfpk4HmlK8nLCAn5ZCM6Iqx6aG6JywgJ+S6lOWQjCcsXG4gICAgICAgICfkuInlkIzoirEnLCAn5LiJ6aG65a2QJywn5YWt5a+55Y2KJywgJ+S6lOWvueS4ieadoScsICflm5vlpZfkuInmnaEnLFxuICAgICAgICAn5YeR5LiA6ImyJywn5LiJ5YiG5aSp5LiLJywgJ+S4ieWQjOiKsemhuicsICfkuIDmnaHpvpknLCAn5riF6b6ZJ107XG4gICAgbGV0IHR5cGUgPSBLUUNhcmQuY2FyZHNUeXBlKGNhcmRzKTtcbiAgICByZXR1cm4gbmFtZXNbdHlwZV07XG59O1xuXG4vLyDmib7lh7rniYznmoTnsbvlnotcbktRQ2FyZC5jYXJkc1R5cGUgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoS1FDYXJkLmlzUWluZ0xvbmcoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5RaW5nTG9uZztcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLllpVGlhb0xvbmc7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuVG9uZ0h1YVNodW47XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1NhbkZlblRpYW5YaWEoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5GZW5UaWFuWGlhO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5MaXVEdWlCYW47XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1NhblRvbmdIdWEoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5TYW5UYW9IdWE7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1NhblNodW5aaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhblNodW5aaTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmlzU2FuU2h1blppMShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNhblNodW5aaTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmlzQ291WWlTZShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkNvdVlpU2U7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5pc1d1RHVpU2FuVGlhbyhjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1RHVpU2FuVGlhbztcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmlzU2lUYW9TYW5UaWFvKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2lUYW9TYW5UaWFvO1xuICAgIH1cblxuICAgIC8qIyMjIyMqL1xuICAgIGlmIChLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcywgNSkpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcbiAgICB9XG5cbiAgICAvL2lmIChLUUNhcmQuY29udGFpbld1VG9uZyhjYXJkcykpIHtcbiAgICAvLyAgICByZXR1cm4gS1FDYXJkLlRZUEUuV3VUb25nO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9pZiAoS1FDYXJkLmNvbnRhaW5XdVRvbmcoY2FyZHMpKSB7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5UWVBFLld1VG9uZztcbiAgICAvL31cbiAgICAvKiMjIyMjKi9cblxuICAgIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuKGNhcmRzLCA1KSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVG9uZ0h1YVNodW47XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5jb250YWluVGllWmhpKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuVGllWmhpO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpbkh1THUoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5IdUx1O1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpblRvbmdIdWEoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5Ub25nSHVhO1xuICAgIH1cblxuICAgIGlmIChLUUNhcmQuY29udGFpblNodW5aaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLlNodW5aaTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5TYW5UaWFvKGNhcmRzKSkge1xuICAgICAgICByZXR1cm4gS1FDYXJkLlRZUEUuU2FuVGlhbztcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5MaWFEdWkoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiBLUUNhcmQuVFlQRS5MaWFuZ0R1aTtcbiAgICB9XG5cbiAgICBpZiAoS1FDYXJkLmNvbnRhaW5EdWlaaShjYXJkcykpIHtcbiAgICAgICAgcmV0dXJuIEtRQ2FyZC5UWVBFLkR1aVppO1xuICAgIH1cblxuICAgIHJldHVybiBLUUNhcmQuVFlQRS5XdUxvbmc7XG59O1xuXG4vLyDliKTmlq3mmK/lkKbmmK/lkIzoirFcbktRQ2FyZC5pc1RvbmdIdWEgPSBmdW5jdGlvbihjYXJkcywgbWluTGVuZ3RoID0gMykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBjb2xvcnMgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQuY29sb3I7XG4gICAgfSk7XG5cbiAgICBsZXQgY29sb3IgPSBjb2xvcnNbMF07XG4gICAgZm9yIChsZXQgaW5kZXggaW4gY29sb3JzKSB7XG4gICAgICAgIGxldCBlID0gY29sb3JzW2luZGV4XTtcbiAgICAgICAgaWYgKGUgIT0gY29sb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8vIOaYr+WQpuWMheWQq+WQjOiKsVxuS1FDYXJkLmNvbnRhaW5Ub25nSHVhID0gZnVuY3Rpb24gKGNhcmRzLCBtaW5MZW5ndGggPSA1KSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZFRvbmdIdWEoY2FyZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgICAvL2NhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gICAgLy9jYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlDb2xvcik7XG4gICAgLy9cbiAgICAvL2ZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbWluTGVuZ3RoKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAvLyAgICBsZXQgc3ViQ2FyZHMgPSBjYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBtaW5MZW5ndGgpO1xuICAgIC8vICAgIGlmIChLUUNhcmQuaXNUb25nSHVhKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cblxuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YTIwKGNhcmRzKTtcbn07XG5LUUNhcmQuY29udGFpblRvbmdIdWEyMCA9IGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgaWYgKGNhcmQubGVuZ3RoIDwgNSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmQpO1xuICAgIHZhciBjYXJkcyA9IGNhcmQua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICBjYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlDb2xvcik7XG5cbiAgICBmb3IodmFyIGogPSAxO2ogPD0gY2FyZDIwLmxlbmd0aDsrK2ope1xuICAgICAgICB2YXIgbnVtID0gNSAtIGo7XG4gICAgICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbnVtKSA8PSBjYXJkcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgICAgICAgIHZhciBzdWJDYXJkcyA9IGNhcmRzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XG4gICAgICAgICAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YShzdWJDYXJkcywgbnVtKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG4vLyDliKTmlq3mmK/lkKbmmK/pobrlrZBcbktRQ2FyZC5pc1NodW5aaSA9IGZ1bmN0aW9uKGNhcmRzLCBtaW5MZW5ndGggPSAzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKEtRQ2FyZC5faXNTaHVuWmlBS1EoY2FyZHMpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGxldCBwb2ludHMgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQucG9pbnQ7XG4gICAgfSkuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuXG4gICAgdmFyIHBvaW50ID0gcG9pbnRzWzBdO1xuICAgIGZvciAodmFyIGluZGV4IGluIHBvaW50cykge1xuICAgICAgICB2YXIgZSA9IHBvaW50c1tpbmRleF07XG4gICAgICAgIGlmIChlICE9IHBvaW50KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBwb2ludCA9IHBvaW50ICsgMTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8vIOWIpOaWreaYr+WQpuaYryBBIEsgUSBKIDEwIOi/meS4qumhuuWtkFxuS1FDYXJkLl9pc1NodW5aaUFLUSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSBjYXJkcy5sZW5ndGg7XG4gICAgaWYgKGxlbmd0aC5sZW5ndGggPCAzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcG9pbnQxcyA9IFsxXTtcbiAgICBsZXQgcG9pbnQxNHMgPSBbMTRdO1xuICAgIGxldCBwb2ludEsgPSAxMztcblxuICAgIE51bWJlcihsZW5ndGggLSAxKS5rcV90aW1lcyhmdW5jdGlvbih0aW1lcykge1xuICAgICAgICBwb2ludDFzLnB1c2gocG9pbnRLIC0gdGltZXMpO1xuICAgICAgICBwb2ludDE0cy5wdXNoKHBvaW50SyAtIHRpbWVzKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBLUUNhcmQuX2lzQ2FyZHNDb250YWluUG9pbnRzKGNhcmRzLCBwb2ludDFzKSB8fCBLUUNhcmQuX2lzQ2FyZHNDb250YWluUG9pbnRzKGNhcmRzLCBwb2ludDE0cyk7XG59O1xuXG4vLyBjYXJkcyDkuK3mmK/lkKbljIXlkKsgcG9pbnRzIOi/meS6m+eCueaVsFxuXG5LUUNhcmQuX2lzQ2FyZHNDb250YWluUG9pbnRzID0gZnVuY3Rpb24oY2FyZHMsIHBvaW50cykge1xuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBwb2ludHMubGVuZ3RoOyArK2luZGV4KSB7XG4gICAgICAgIGxldCBwb2ludCA9IHBvaW50c1tpbmRleF07XG4gICAgICAgIGxldCBwb2ludENhcmRJbmRleCA9IGNhcmRzLmZpbmRJbmRleChmdW5jdGlvbihjYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZC5wb2ludCA9PSBwb2ludDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHBvaW50Q2FyZEluZGV4IDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59O1xuS1FDYXJkLmNvbnRhaW4yMCA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmKHR5cGVvZihjYXJkc1swXS5wb2ludCkgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5jYXJkc0Zyb21BcnJheShjYXJkcyk7XG4gICAgfVxuICAgIHZhciBuZXdDYXJkID0gY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGNhcmQpey8v6YeN5paw6LWL5YC8Y2FyZHNcbiAgICAgICAgaWYoY2FyZC5wb2ludCA+PSAyMCl7XG4gICAgICAgICAgICByZXR1cm4gY2FyZDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBuZXdDYXJkIHx8IFtdO1xufTtcbi8vIOaYr+WQpuWMheWQq+mhuuWtkFxuS1FDYXJkLmNvbnRhaW5TaHVuWmkgPSBmdW5jdGlvbiAoY2FyZHMsIG1pbkxlbmd0aCA9IDUpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEtRQ2FyZC5maW5kU2h1blppKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy9sZXQgdW5pcXVlQ2FyZHMgPSBjYXJkcy51bmlxdWUoZnVuY3Rpb24oY2FyZDEsIGNhcmQyKSB7XG4gICAgLy8gICAgcmV0dXJuIGNhcmQxLnBvaW50ID09IGNhcmQyLnBvaW50O1xuICAgIC8vfSk7XG4gICAgLy91bmlxdWVDYXJkcy5zb3J0KEtRQ2FyZC5zb3J0QnlQb2ludCk7XG4gICAgLy9cbiAgICAvL2xldCBtaW5Qb2ludENhcmQgPSB1bmlxdWVDYXJkc1swXTtcbiAgICAvL2lmIChtaW5Qb2ludENhcmQucG9pbnQgPT0gMSkge1xuICAgIC8vICAgIGxldCBBUGx1c0NhcmQgPSBuZXcgS1FDYXJkKG1pblBvaW50Q2FyZCk7XG4gICAgLy8gICAgQVBsdXNDYXJkLnBvaW50ID0gMTQ7XG4gICAgLy8gICAgdW5pcXVlQ2FyZHMucHVzaChBUGx1c0NhcmQpO1xuICAgIC8vfVxuICAgIC8vXG4gICAgLy9mb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG1pbkxlbmd0aCkgPD0gdW5pcXVlQ2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgLy8gICAgbGV0IHN1YkNhcmRzID0gdW5pcXVlQ2FyZHMuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgbWluTGVuZ3RoKTtcbiAgICAvLyAgICBpZiAoS1FDYXJkLmlzU2h1blppKHN1YkNhcmRzLCBtaW5MZW5ndGgpKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICAvL1xuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluU2h1blppMjAoY2FyZHMpO1xufTtcbi8qS1FDYXJkLmNvbnRhaW5TaHVuWmkyMCA9IGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgaWYgKGNhcmQubGVuZ3RoIDwgNSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmQpO1xuICAgIHZhciBjYXJkcyA9IGNhcmQua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICAvLyDlhYjmoLnmja7ngrnmlbDljrvph41cbiAgICB2YXIgbmV3QXJyID0gW107XG4gICAgdmFyIG5ld0FycnMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChuZXdBcnJzLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKSB7XG4gICAgICAgICAgICBuZXdBcnIucHVzaChjYXJkc1tpXSk7XG4gICAgICAgICAgICBuZXdBcnJzLnB1c2goY2FyZHNbaV0ucG9pbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vbmV3QXJyLmZvckVhY2goZnVuY3Rpb24oY2FyZCl7XG4gICAgLy8gICAgaWYoY2FyZC5zY29yZXMgPT0gMTQpe1xuICAgIC8vICAgICAgICBjYXJkLnNjb3JlcyA9IDE7XG4gICAgLy8gICAgfVxuICAgIC8vfSlcbiAgICBuZXdBcnIuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMS5wb2ludCAtIG4yLnBvaW50O1xuICAgIH0pO1xuICAgIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgICAgIHZhciBudW0gPSA1IC0gajtcbiAgICAgICAgZm9yICh2YXIgc3RhcnQgPSAwOyAoc3RhcnQgKyBudW0pIDw9IG5ld0Fyci5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgICAgICAgIHZhciBzdWJDYXJkcyA9IG5ld0Fyci5zbGljZShzdGFydCwgc3RhcnQgKyBudW0pO1xuICAgICAgICAgICAgdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3Njb3JlcyddKSAtIHBhcnNlSW50KHN1YkNhcmRzWzBdWydzY29yZXMnXSkgPCA1O1xuICAgICAgICAgICAgaWYoYm9vbCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8g55Sx5LqO54K55pWw5piv5ZSv5LiA5LiU5Y2H5bqP77yM5Y+q6ZyA6KaB5L6d5qyh6YGN5Y6G5Yik5pat5piv5ZCm5piv6aG65a2Q5Y2z5Y+vXG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkKTtcbiAgICBpZiAoY2FyZCA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gS1FDYXJkLmNvbnRhaW5TaHVuWmkyMChjb252ZXJ0ZWRDYXJkcyk7XG59OyovXG4vLyDmmK/lkKbmmK/lkIzoirHpobpcbktRQ2FyZC5pc1RvbmdIdWFTaHVuID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5pc1RvbmdIdWEoY2FyZHMpICYmIEtRQ2FyZC5pc1NodW5aaShjYXJkcyk7XG59O1xuXG4vLyDmmK/lkKbljIXlkKvmnInlkIzoirHpobpcbktRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAoY2FyZHMsIG1pbkxlbmd0aCA9IDUpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbWluTGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKEtRQ2FyZC5maW5kVG9uZ0h1YVNodW4oY2FyZHMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgICAvL3ZhciBzYW5TaHVuWmkgPSBLUUNhcmQuc2FuU2h1blppMShjYXJkcyxtaW5MZW5ndGgpWzBdO1xuICAgIC8vaWYoc2FuU2h1blppID09IG51bGwpe1xuICAgIC8vICAgIHJldHVybiBmYWxzZTtcbiAgICAvL31cbiAgICAvL3ZhciByZXN1bHQgPSBmYWxzZTtcbiAgICAvL2Zvcih2YXIgaT0wO2k8c2FuU2h1blppLmxlbmd0aDtpKyspIHtcbiAgICAvLyAgICB2YXIgcyA9IHNhblNodW5aaVtpXTtcbiAgICAvLyAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YVNodW4ocywgbWluTGVuZ3RoKSkge1xuICAgIC8vICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAvLyAgICB9XG4gICAgLy99XG4gICAgLy9yZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjEoY2FyZHMpO1xuXG59O1xuLypLUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMSA9IGZ1bmN0aW9uIChjYXJkcywgbWluTGVuZ3RoID0gNSkge1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBtaW5MZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBsZXQgdGVtcENhcmRzID0gQXJyYXkuZnJvbShjYXJkcykuc29ydChLUUNhcmQuc29ydEJ5Q29sb3IpO1xuICAgIGZvciAodmFyIHN0YXJ0ID0gMDsgKHN0YXJ0ICsgbWluTGVuZ3RoKSA8PSB0ZW1wQ2FyZHMubGVuZ3RoOyArK3N0YXJ0KSB7XG4gICAgICAgIGxldCBzdWJDYXJkcyA9IHRlbXBDYXJkcy5zbGljZShzdGFydCwgc3RhcnQgKyBtaW5MZW5ndGgpO1xuICAgICAgICBpZiAoS1FDYXJkLmlzVG9uZ0h1YVNodW4oc3ViQ2FyZHMsIG1pbkxlbmd0aCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkcyk7XG4gICAgaWYgKGNhcmRzID09PSBjb252ZXJ0ZWRDYXJkcykge1xuICAgICAgICByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjIwKGNhcmRzKTtcbiAgICB9XG4gICAgcmV0dXJuIEtRQ2FyZC5jb250YWluVG9uZ0h1YVNodW4xKGNvbnZlcnRlZENhcmRzKTtcbiAgICAvL3JldHVybiBmYWxzZTtcbn07XG5LUUNhcmQuY29udGFpblRvbmdIdWFTaHVuMjAgPSBmdW5jdGlvbiAoY2FyZCwgbWluTGVuZ3RoID0gNSkge1xuICAgIGlmIChjYXJkLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmQpIHx8IFtdO1xuICAgIHZhciBjYXJkcyA9IGNhcmQua3FfZXhjbHVkZXMoY2FyZDIwKTtcblxuICAgIGNhcmRzID0gQXJyYXkuZnJvbShjYXJkcyk7XG4gICAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgICB2YXIgY29sb3JDID0gW107IC8v5qKF6IqxXG4gICAgdmFyIGNvbG9yRCA9IFtdOyAvL+aWueWdl1xuICAgIHZhciBwb2ludFMgPSBbXTsgLy/pu5HmoYNcbiAgICB2YXIgcG9pbnRIID0gW107IC8v57qi5b+DXG4gICAgdmFyIHBvaW50QyA9IFtdOyAvL+aiheiKsVxuICAgIHZhciBwb2ludEQgPSBbXTsgLy/mlrnlnZdcbiAgICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihjYXJkc1tpXS5jb2xvciA9PSAnNCcpe1xuICAgICAgICAgICAgaWYocG9pbnRTLmluZGV4T2YoY2FyZHNbaV0ucG9pbnQpID09IC0xKXtcbiAgICAgICAgICAgICAgICBwb2ludFMucHVzaChjYXJkc1tpXS5wb2ludCk7XG4gICAgICAgICAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICczJyl7XG4gICAgICAgICAgICBpZihwb2ludEguaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICAgICAgICAgIHBvaW50SC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcyJyl7XG4gICAgICAgICAgICBpZihwb2ludEMuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICAgICAgICAgIHBvaW50Qy5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgICAgICAgICBjb2xvckMucHVzaChjYXJkc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLmNvbG9yID09ICcxJyl7XG4gICAgICAgICAgICBpZihwb2ludEQuaW5kZXhPZihjYXJkc1tpXS5wb2ludCkgPT0gLTEpe1xuICAgICAgICAgICAgICAgIHBvaW50RC5wdXNoKGNhcmRzW2ldLnBvaW50KTtcbiAgICAgICAgICAgICAgICBjb2xvckQucHVzaChjYXJkc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgY29sb3IgPSBbY29sb3JTLGNvbG9ySCxjb2xvckMsY29sb3JEXTtcbiAgICB2YXIgY29sb3JTdW0gPSBbXTsgICAgLy/mgLvlhbHmnInlh6Dnp43oirHoibIgWzUsMywwLi4uLl1cbiAgICBmb3IodmFyIGk9MDtpPGNvbG9yLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihjb2xvcltpXS5sZW5ndGggPj0gcGFyc2VJbnQoNSAtIGNhcmQyMC5sZW5ndGgpKXtcbiAgICAgICAgICAgIC8vY29sb3JbaV0uZm9yRWFjaChmdW5jdGlvbihjYSl7XG4gICAgICAgICAgICAvLyAgICBpZihjYS5zY29yZXMgPT0gMTQpe1xuICAgICAgICAgICAgLy8gICAgICAgIGNhLnNjb3JlcyA9IDE7XG4gICAgICAgICAgICAvLyAgICB9XG4gICAgICAgICAgICAvL30pXG4gICAgICAgICAgICBjb2xvcltpXS5zb3J0KGZ1bmN0aW9uKGExLGEyKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTEgLSBhMjtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvcih2YXIgaT0wO2k8Y29sb3JTdW0ubGVuZ3RoO2krKykge1xuICAgICAgICB2YXIgcyA9IGNvbG9yU3VtW2ldXG4gICAgICAgIGZvcih2YXIgaiA9IDE7aiA8PSBjYXJkMjAubGVuZ3RoOysrail7XG4gICAgICAgICAgICB2YXIgbnVtID0gNSAtIGo7XG4gICAgICAgICAgICBmb3IgKHZhciBzdGFydCA9IDA7IChzdGFydCArIG51bSkgPD0gcy5sZW5ndGg7ICsrc3RhcnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ViQ2FyZHMgPSBzLnNsaWNlKHN0YXJ0LCBzdGFydCArIG51bSk7XG4gICAgICAgICAgICAgICAgdmFyIGJvb2wgPSBwYXJzZUludChzdWJDYXJkc1tudW0tMV1bJ3Njb3JlcyddKSAtIHBhcnNlSW50KHN1YkNhcmRzWzBdWydzY29yZXMnXSkgPCA1O1xuICAgICAgICAgICAgICAgIGlmKGJvb2wpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkKTtcbiAgICBpZiAoY2FyZCA9PT0gY29udmVydGVkQ2FyZHMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gS1FDYXJkLmNvbnRhaW5Ub25nSHVhU2h1bjIwKGNvbnZlcnRlZENhcmRzKTtcbn07Ki9cblxuXG4vLyDmmK/lkKbmmK/muIXpvplcbktRQ2FyZC5pc1FpbmdMb25nID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEzO1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gICAgdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xuICAgIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcbiAgICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY2FyZHNbaV0uc3VpdCA9PSAncycpe1xuICAgICAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdoJyl7XG4gICAgICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2MnKXtcbiAgICAgICAgICAgIGNvbG9yQy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnZCcpe1xuICAgICAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBscyA9IGNvbG9yUy5sZW5ndGg7ICAvL+m7keahg+S4quaVsFxuICAgIHZhciBsaCA9IGNvbG9ySC5sZW5ndGg7ICAvL+e6ouahg+S4quaVsFxuICAgIHZhciBsYyA9IGNvbG9yQy5sZW5ndGg7ICAvL+aiheiKseS4quaVsFxuICAgIHZhciBsZCA9IGNvbG9yRC5sZW5ndGg7ICAvL+aWueWdl+S4quaVsFxuICAgIHZhciBjb2xvciA9IFtscyxsaCxsYyxsZF07XG4gICAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gICAgZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY29sb3JbaV0gIT0gMCl7XG4gICAgICAgICAgICBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZihjb2xvclN1bS5sZW5ndGggPT0gMSl7XG4gICAgICAgIGlmKGNvbG9yU3VtWzBdID09IDEzKXtcbiAgICAgICAgICAgIHJldHVybiBLUUNhcmQuaXNZaVRpYW9Mb25nKGNhcmRzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvL3JldHVybiBLUUNhcmQuaXNUb25nSHVhU2h1bihjYXJkcyk7XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuLy8g5piv5ZCm5piv5LiA5p2h6b6ZXG5LUUNhcmQuaXNMb25nID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEzO1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gS1FDYXJkLmlzU2h1blppKGNhcmRzKTtcbn07XG5cbi8qIyMjIyMqL1xuLyrmmK/lkKbkuIDmnaHpvpkqL1xuS1FDYXJkLmlzWWlUaWFvTG9uZyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIC8vY2FyZHM6e251bWJlcjoxfjEzICwnc3VpdCc6J2gnLi4ufVxuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYodHlwZW9mKGNhcmRzWzBdLm51bWJlcikgPT0gJ3VuZGVmaW5lZCcpe1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5jb252ZXJ0VG9TZXJ2ZXJDYXJkcyhjYXJkcyk7XG4gICAgfVxuICAgIHZhciBudW1iZXIgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQubnVtYmVyO1xuICAgIH0pLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICByZXR1cm4gbjEgLSBuMjtcbiAgICB9KTtcbiAgICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aC0xO2krKykge1xuICAgICAgICBpZihudW1iZXJbaV0gIT0gbnVtYmVyW2krMV0gLSAxKXtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG4vKiMjIyMjKi9cbi8q5piv5ZCm5LiJ5ZCM6IqxKi9cbktRQ2FyZC5pc1NhblRvbmdIdWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gMTM7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICh0eXBlb2YoY2FyZHNbMF0uc3VpdCkgPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICBjYXJkcyA9IEtRQ2FyZC5fY29udmVydENhcmRzVG9DYXJkTmFtZXMoY2FyZHMpO1xuICAgIH1cbiAgICB2YXIgY29sb3JTID0gW107IC8v6buR5qGDXG4gICAgdmFyIGNvbG9ySCA9IFtdOyAvL+e6ouW/g1xuICAgIHZhciBjb2xvckMgPSBbXTsgLy/mooXoirFcbiAgICB2YXIgY29sb3JEID0gW107IC8v5pa55Z2XXG4gICAgZm9yKHZhciBpPTA7aTxjYXJkcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY2FyZHNbaV0uc3VpdCA9PSAncycpe1xuICAgICAgICAgICAgY29sb3JTLnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9ZWxzZSBpZihjYXJkc1tpXS5zdWl0ID09ICdoJyl7XG4gICAgICAgICAgICBjb2xvckgucHVzaChjYXJkc1tpXSk7XG4gICAgICAgIH1lbHNlIGlmKGNhcmRzW2ldLnN1aXQgPT0gJ2MnKXtcbiAgICAgICAgICAgIGNvbG9yQy5wdXNoKGNhcmRzW2ldKTtcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnZCcpe1xuICAgICAgICAgICAgY29sb3JELnB1c2goY2FyZHNbaV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBscyA9IGNvbG9yUy5sZW5ndGg7ICAvL+m7keahg+S4quaVsFxuICAgIHZhciBsaCA9IGNvbG9ySC5sZW5ndGg7ICAvL+e6ouahg+S4quaVsFxuICAgIHZhciBsYyA9IGNvbG9yQy5sZW5ndGg7ICAvL+aiheiKseS4quaVsFxuICAgIHZhciBsZCA9IGNvbG9yRC5sZW5ndGg7ICAvL+aWueWdl+S4quaVsFxuICAgIHZhciBjb2xvciA9IFtscyxsaCxsYyxsZF07XG4gICAgdmFyIGNvbG9yU3VtID0gW107ICAgIC8v5oC75YWx5pyJ5Yeg56eN6Iqx6ImyIFs1LDMsMC4uLi5dXG4gICAgZm9yKHZhciBpPTA7aTxjb2xvci5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoY29sb3JbaV0gIT0gMCl7XG4gICAgICAgICAgICBjb2xvclN1bS5wdXNoKGNvbG9yW2ldKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8v5aaC5p6c54mM5Lit5YyF5ZCr5Zub56eN6Iqx6Imy5bCx5LiN5Y+v6IO95piv5LiJ5ZCM6IqxXG4gICAgaWYoY29sb3JTdW0ubGVuZ3RoID09IDQpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy/kuInnp43oirHoibJcbiAgICBpZihjb2xvclN1bS5sZW5ndGggPT0gMyl7XG4gICAgICAgIGZvcih2YXIgaT0wO2k8Y29sb3JTdW0ubGVuZ3RoO2krKykge1xuICAgICAgICAgICAgaWYgKGNvbG9yU3VtW2ldICE9IDUgJiYgY29sb3JTdW1baV0gIT0gMyl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvL+S4pOenjeiKseiJslxuICAgIGVsc2UgaWYoY29sb3JTdW0ubGVuZ3RoID09IDIpe1xuICAgICAgICBmb3IodmFyIGk9MDtpPGNvbG9yU3VtLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgIGlmICgoY29sb3JTdW1baV0gIT0gMTAgJiYgY29sb3JTdW1baV0gIT0gMykgJiYgKGNvbG9yU3VtW2ldICE9IDggJiYgY29sb3JTdW1baV0gIT0gNSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy/kuIDnp43oirHoibJcbiAgICBlbHNlIGlmKGNvbG9yU3VtLmxlbmd0aCA9PSAxKXtcbiAgICAgICAgaWYoY29sb3JTdW1bMF0gPT0gMTMpe1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG59O1xuLyrmmK/lkKblh5HkuIDoibIqL1xuS1FDYXJkLmlzQ291WWlTZSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYodHlwZW9mKGNhcmRzWzBdLnN1aXQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzKGNhcmRzKTtcbiAgICB9XG4gICAgdmFyIGNvbG9yUyA9IFtdOyAvL+m7keahg1xuICAgIHZhciBjb2xvckggPSBbXTsgLy/nuqLlv4NcbiAgICBmb3IodmFyIGk9MDtpPGNhcmRzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihjYXJkc1tpXS5zdWl0ID09ICdzJyB8fCBjYXJkc1tpXS5zdWl0ID09ICdjJyl7XG4gICAgICAgICAgICBjb2xvclMucHVzaChjYXJkc1tpXSk7Ly/lhajpu5FcbiAgICAgICAgfWVsc2UgaWYoY2FyZHNbaV0uc3VpdCA9PSAnaCcgfHwgY2FyZHNbaV0uc3VpdCA9PSAnZCcpe1xuICAgICAgICAgICAgY29sb3JILnB1c2goY2FyZHNbaV0pOy8v5YWo57qiXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL+WmguaenOeJjOS4reWMheWQq+Wbm+enjeiKseiJsuWwseS4jeWPr+iDveaYr+S4ieWQjOiKsVxuICAgIGlmKGNvbG9yUy5sZW5ndGggPT0gMTMgfHwgY29sb3JILmxlbmd0aCA9PSAxMyl7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvL2Vsc2UgaWYoY29sb3JILmxlbmd0aCA9PSAxMyl7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcbi8qIyMjIyMqL1xuLy8g5piv5ZCm5piv5YWt5a+55Y2KXG5LUUNhcmQuaXNMaXVEdWlCYW4gPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTI7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGR1aVppTGVuZ3RoID0gMjtcbiAgICAvL+iuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxuICAgIGxldCBjYXJkTnVtYmVycyA9IG5ldyBHZXRDYXJkUG9pbnRzU2FtZUNvdW50KGNhcmRzKTtcbiAgICBsZXQgbnVtYmVyT2ZEdWlaaSA9IDA7XG4gICAgbGV0IG51bWJlck9mWWkgPSAwO1xuICAgIGZvciAobGV0IHByb3AgaW4gY2FyZE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gY2FyZE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSBkdWlaaUxlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZEdWlaaSA9IG51bWJlck9mRHVpWmkgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID49IDQpIHtcbiAgICAgICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSA9PSAxKSB7XG4gICAgICAgICAgICBudW1iZXJPZllpICs9IDE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bWJlck9mRHVpWmkgPT0gNjtcbn07XG5cbktRQ2FyZC5pc1d1RHVpU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSAxMztcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgZHVpWmlMZW5ndGggPSAyO1xuICAgIGxldCBzYW5UaWFvTGVuZ3RoID0gMztcbiAgICAvL+iuoeeul+S4gOS4queJjOaVsOe7hOWGheeahOebuOWQjOeCueaVsOeahOeJjOeahOW8oOaVsFxuICAgIGxldCBjYXJkTnVtYmVycyA9IG5ldyBHZXRDYXJkUG9pbnRzU2FtZUNvdW50KGNhcmRzKTtcbiAgICBsZXQgbnVtYmVyT2ZEdWlaaSA9IDA7XG4gICAgbGV0IG51bWJlck9mU2FuVGlhbyA9IDA7XG4gICAgZm9yIChsZXQgcHJvcCBpbiBjYXJkTnVtYmVycykge1xuICAgICAgICBsZXQgdmFsdWUgPSBjYXJkTnVtYmVyc1twcm9wXTtcbiAgICAgICAgaWYgKHZhbHVlID09IGR1aVppTGVuZ3RoKSB7XG4gICAgICAgICAgICBudW1iZXJPZkR1aVppID0gbnVtYmVyT2ZEdWlaaSArIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT0gc2FuVGlhb0xlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZTYW5UaWFvID0gbnVtYmVyT2ZTYW5UaWFvICsgMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSA+PSA0KSB7XG4gICAgICAgICAgICBudW1iZXJPZkR1aVppID0gbnVtYmVyT2ZEdWlaaSArIDI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bWJlck9mRHVpWmkgPT0gNSAmJiBudW1iZXJPZlNhblRpYW8gPT0gMTtcbn07XG4vKiMjIyMjKi9cbktRQ2FyZC5pc1NhblNodW5aaTEgPSBmdW5jdGlvbihjYXJkcyl7XG4gICAgaWYoY2FyZHMubGVuZ3RoICE9IDEzKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8v5Y+W5Ye654mM55qE54K55pWwXG4gICAgaWYodHlwZW9mKGNhcmRzWzBdLnN1aXQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzKGNhcmRzKTtcbiAgICB9XG4gICAgLy92YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgLy9pZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgIC8vICAgIHJldHVybiBmYWxzZTtcbiAgICAvL31cbiAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICB9KTtcbiAgICAvL+aOkuW6j1xuICAgIG51bWJlci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgcmV0dXJuIG4xIC0gbjI7XG4gICAgfSk7XG4gICAgaWYoS1FDYXJkLmZlblpodShudW1iZXIsNSw1KSA9PSBmYWxzZSl7XG4gICAgICAgIHZhciBudW1iZXIgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJkLm51bWJlcjtcbiAgICAgICAgfSk7XG4gICAgICAgIC8v5o6S5bqPXG4gICAgICAgIG51bWJlci5zb3J0KGZ1bmN0aW9uIChuMSwgbjIpIHtcbiAgICAgICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYoS1FDYXJkLmZlblpodShudW1iZXIsNSwzKSA9PSBmYWxzZSl7XG4gICAgICAgICAgICB2YXIgbnVtYmVyID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhcmQubnVtYmVyO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL+aOkuW6j1xuICAgICAgICAgICAgbnVtYmVyLnNvcnQoZnVuY3Rpb24gKG4xLCBuMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZihLUUNhcmQuZmVuWmh1KG51bWJlciwzLDUpID09IGZhbHNlKXtcbiAgICAgICAgICAgICAgICB2YXIgQUlzRXhpc3QgPSBmYWxzZTsgIC8v5piv5ZCm5a2Y5ZyoQVxuICAgICAgICAgICAgICAgIGZvcih2YXIgaSBpbiBjYXJkcykge1xuICAgICAgICAgICAgICAgICAgICBpZihjYXJkc1tpXS5udW1iZXIgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgQUlzRXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoIUFJc0V4aXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IodmFyIGkgaW4gY2FyZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoY2FyZHNbaV0ubnVtYmVyID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRzW2ldLm51bWJlciA9IDE0O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtRQ2FyZC5pc1NhblNodW5aaTEoY2FyZHMpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9ZWxzZXtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufTtcblxuLy/liKTmlq015byg5oiW6ICFM+W8oOaYr+WQpumhuuWtkFxuS1FDYXJkLmlzU2h1blppMSA9IGZ1bmN0aW9uKGFycil7XG4gICAgZm9yKHZhciBpPTA7aTxhcnIubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgaWYoYXJyW2krMV0gLSBhcnJbaV0gIT0gMSl7XG4gICAgICAgICAgICAvL+S4jeaYr+mhuuWtkFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuS1FDYXJkLmZlblpodSA9IGZ1bmN0aW9uIChudW1iZXIsbnVtMSxudW0yKSB7XG4gICAgdmFyIGFycjEgPSBbXTtcbiAgICB2YXIgYXJyMiA9IFtdO1xuICAgIGZvcih2YXIgaT0wO2k8bnVtYmVyLmxlbmd0aC0xO2krKyl7XG4gICAgICAgIGlmKGkgPT0gMCl7XG4gICAgICAgICAgICBhcnIxLnB1c2gobnVtYmVyWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBpZihudW1iZXJbaSsxXSAtIG51bWJlcltpXSA9PSAwKXtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGFycjEucHVzaChudW1iZXJbaSsxXSk7XG4gICAgICAgIGlmKGFycjEubGVuZ3RoID09IG51bTEpe1xuICAgICAgICAgICAgLy/lj5bnrKzkuIDnu4TmmK/pobrlrZBcbiAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1NodW5aaTEoYXJyMSkpe1xuICAgICAgICAgICAgICAgIC8v6L+ZNeS4quaYr+mhuuWtkCzku47mlbDnu4TkuK3np7vpmaRcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDtpPGFycjEubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaj0wO2o8bnVtYmVyLmxlbmd0aC0xO2orKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbal0gPT0gYXJyMVtpXSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/kuKTkuKrmlbDkuIDmoLfnmoTlj6rliKDpmaTkuIDkuKpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXJbal0gPT0gbnVtYmVyW2orMV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyLnNwbGljZShqLDEpOyAgICAvL+S7jm51bWJlcuS4reenu+mZpFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8v5o6l5LiL5p2l5Y+W56ys5LqM57uEXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxudW1iZXIubGVuZ3RoLTE7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoaSA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFycjIucHVzaChudW1iZXJbMF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmKG51bWJlcltpKzFdIC0gbnVtYmVyW2ldID09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXJyMi5wdXNoKG51bWJlcltpKzFdKTtcbiAgICAgICAgICAgICAgICAgICAgaWYoYXJyMi5sZW5ndGggPT0gbnVtMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy/lj5bnrKzkuoznu4TmmK/pobrlrZBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChLUUNhcmQuaXNTaHVuWmkxKGFycjIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxhcnIyLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGo9MDtqPG51bWJlci5sZW5ndGgtMTtqKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IGFycjJbaV0pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v5Lik5Liq5pWw5LiA5qC355qE5Y+q5Yig6Zmk5LiA5LiqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyW2pdID09IG51bWJlcltqKzFdKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlci5zcGxpY2UoaiwxKTsgICAgLy/ku45udW1iZXLkuK3np7vpmaRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aOpeS4i+adpeWwseaYr+WJqeS4i+eahOS6hlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKEtRQ2FyZC5pc1NodW5aaTEobnVtYmVyKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v56ys5LiJ57uE5Lmf5piv6aG65a2QXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+esrOS4iee7hOS4jeaYr+mhuuWtkFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8v56ys5LqM57uE5LiN5piv6aG65a2QXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL+esrOS4gOe7hOS4jeaYr+mhuuWtkFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxufTtcbi8vIGlzU2FuU2h1blppMuaYr+aIkeWGmeeahFxuS1FDYXJkLmlzU2FuU2h1blppID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgdmFyIGxlbmd0aCA9IDEzO1xuICAgIGlmKGNhcmRzLmxlbmd0aCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZih0eXBlb2YoY2FyZHNbMF0ucG9pbnQpID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgY2FyZHMgPSBLUUNhcmQuY2FyZHNGcm9tQXJyYXkoY2FyZHMpO1xuICAgIH1cbiAgICB2YXIgY2FyZDIwID0gS1FDYXJkLmNvbnRhaW4yMChjYXJkcyk7XG4gICAgaWYoY2FyZDIwLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjYXJkcyA9IEFycmF5LmZyb20oY2FyZHMpO1xuICAgIGNhcmRzLnNvcnQoS1FDYXJkLnNvcnRCeVBvaW50KTtcbiAgICB2YXIgd2VpID0gW107XG4gICAgdmFyIHpob25nID0gW107XG4gICAgdmFyIHRvdSA9IFtdO1xuICAgIHZhciBzYW5TaHVuWmkgPSBLUUNhcmQuc2FuU2h1blppMShjYXJkcylbMF07Ly/ojrflj5bmiYDmnInnu4TlkIjnmoTlpLTpgZNcbiAgICBpZighc2FuU2h1blppKXsgLy/kvaDov57lpLTpgZPpg73msqHmnIkg5oCO5LmI5pu05oiR5re3XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgbmV3Q2FyZCA9IGNhcmRzLmZpbHRlcihmdW5jdGlvbihpKXsvL+mHjeaWsOi1i+WAvGNhcmRzXG4gICAgICAgIHJldHVybiBpO1xuICAgIH0pO1xuICAgIGNvbnN0IG5ld0NhcmRzMSA9IFtdO1xuICAgIHZhciBuZXdQb2ludCA9IFtdOy8v5Yik5patcG9pbnTmmK/lkKbnm7jlkIxcbiAgICB2YXIgZHVpWmkgPSBbXTsvL+WPluWHuuacieWvueWtkOW9k+S4reeahOS4gOW8oOeJjFxuICAgIGZvcih2YXIgcyBpbiBjYXJkcyl7XG4gICAgICAgIGlmKG5ld1BvaW50LmluZGV4T2YoY2FyZHNbc10ucG9pbnQpPDApe1xuICAgICAgICAgICAgbmV3Q2FyZHMxLnB1c2goY2FyZHNbc10pO1xuICAgICAgICAgICAgbmV3UG9pbnQucHVzaChjYXJkc1tzXS5wb2ludCk7XG4gICAgICAgIH1lbHNley8v5Y+W5Ye65pyJ5a+55a2Q5b2T5Lit55qE5LiA5byg54mMXG4gICAgICAgICAgICBkdWlaaS5wdXNoKGNhcmRzW3NdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgc2FuU2h1blppLmxlbmd0aDsgKytqKSB7Ly/lvqrnjq/miYDmnInlpLTpgZNcbiAgICAgICAgdmFyIG51bWJlcjMgPSBzYW5TaHVuWmlbal07XG4gICAgICAgIGlmKHR5cGVvZihudW1iZXIzKSA9PSAndW5kZWZpbmVkJyl7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgKGkpIDwgY2FyZHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgICAgIHZhciBuZXdDYXJkcyA9IG5ld0NhcmRzMS5maWx0ZXIoZnVuY3Rpb24oaSl7Ly/ph43mlrDotYvlgLxjYXJkc1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG5ld0NhcmRzID0gbmV3Q2FyZHMua3FfZXhjbHVkZXMobnVtYmVyMyk7Ly/liKDpmaTniYzph4znmoTlpLTpgZNcbiAgICAgICAgICAgIGlmICh3ZWkubGVuZ3RoICE9IDUpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3ViQ2FyZHMgPSBuZXdDYXJkcy5zbGljZShpLCBpICsgNSk7XG4gICAgICAgICAgICAgICAgaWYgKEtRQ2FyZC5pc1NodW5aaShzdWJDYXJkcykpIHsvL+W+l+WIsOWwvumBkyDliKDpmaTniYzph4znmoTlsL7pgZNcbiAgICAgICAgICAgICAgICAgICAgd2VpID0gc3ViQ2FyZHM7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NhcmRzID0gbmV3Q2FyZHMua3FfZXhjbHVkZXMoc3ViQ2FyZHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHdlaS5sZW5ndGggPT0gNSl7Ly/miorliankvZnnmoTniYzlkozlr7nlrZDnmoTljZXlvKDlkIjlubZcbiAgICAgICAgICAgICAgICBsZXQgdGFza3MgPSBkdWlaaS5maWx0ZXIoZnVuY3Rpb24oaSl7Ly/ph43mlrDotYvlgLzlr7nlrZBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGFza3MgPSB0YXNrcy5rcV9leGNsdWRlcyhudW1iZXIzKTsvL+WIpOaWreWktOmBk+WSjOWvueWtkOeahOWNleW8oOaYr+WQpuacieebuOWQjCDmnInnmoTor53lsLHliKDpmaRcbiAgICAgICAgICAgICAgICBuZXdDYXJkcyA9IG5ld0NhcmRzLmNvbmNhdCh0YXNrcyk7Ly/miorliankvZnnmoTniYzlkozlr7nlrZDnmoTljZXlvKDlkIjlubZcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh6aG9uZy5sZW5ndGggIT0gNSAmJiBuZXdDYXJkcy5sZW5ndGggPT0gNSkge1xuICAgICAgICAgICAgICAgIGlmIChLUUNhcmQuaXNTaHVuWmkobmV3Q2FyZHMpKSB7Ly/mmK/kuInpobrlrZBcbiAgICAgICAgICAgICAgICAgICAgemhvbmcgPSBuZXdDYXJkcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZih3ZWkubGVuZ3RoID09IDUgJiYgemhvbmcubGVuZ3RoID09IDUgKXsvL+aYr+S4iemhuuWtkOe7iOatouW+queOr1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZXsvL+adpeWQpyDnu6fnu63lkKdcbiAgICAgICAgICAgICAgICB6aG9uZyA9IFtdO3dlaSA9IFtdO3RvdSA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKHdlaS5sZW5ndGggPT0gNSAmJiB6aG9uZy5sZW5ndGggPT0gNSApey8v5piv5LiJ6aG65a2Q57uI5q2i5b6q546vXG4gICAgICAgICAgICB0b3UgPSBudW1iZXIzO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXsvL+adpeWQpyDnu6fnu63lkKdcbiAgICAgICAgICAgIHpob25nID0gW107d2VpID0gW107dG91ID0gW107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjYXJkcyA9IG5ld0NhcmQ7XG4gICAgaWYgKEtRQ2FyZC5faXNTYW5TaHVuWmkodG91LHpob25nLHdlaSkpIHsvL+aYr+S4iemhuuWtkFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgbGV0IGNvbnZlcnRlZENhcmRzID0gS1FDYXJkLl9jb252ZXJ0T25lVG9BMShjYXJkcyk7XG4gICAgaWYgKGNhcmRzID09PSBjb252ZXJ0ZWRDYXJkcykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBLUUNhcmQuaXNTYW5TaHVuWmkoY29udmVydGVkQ2FyZHMpO1xufTtcblxuS1FDYXJkLnNhblNodW5aaTEgPSBmdW5jdGlvbiAoY2FyZHMsbGVuZ3RoID0gMykge1xuICAgIHZhciBzaHVuemkgPSBLUUNhcmQuZmluZFNodW5aaShjYXJkcyxsZW5ndGgpO1xuICAgIHZhciBjYXJkc1QgPSBbXTtcbiAgICB2YXIgY2FyZHNJbmRleCA9IFtdO1xuICAgIGlmKHNodW56aSA9PSBudWxsKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgc2h1bnppLmxlbmd0aDtpKyspe1xuICAgICAgICB2YXIgYSA9IHNodW56aVtpXTtcbiAgICAgICAgdmFyIGNhcmRzU2h1bnppID0gW107XG4gICAgICAgIC8vIHZhciBjYXJkc0luZGV4ID0gW107XG4gICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBhLmxlbmd0aDtqKyspe1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gYVtqXTtcbiAgICAgICAgICAgIGlmKHR5cGVvZihjYXJkc1tpbmRleF0pID09ICd1bmRlZmluZWQnKXtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhcmRzU2h1bnppLnB1c2goY2FyZHNbaW5kZXhdKTtcblxuICAgICAgICB9XG4gICAgICAgIGNhcmRzSW5kZXgucHVzaChhKTtcbiAgICAgICAgY2FyZHNULnB1c2goY2FyZHNTaHVuemkpO1xuICAgIH1cbiAgICByZXR1cm4gW2NhcmRzVCxjYXJkc0luZGV4XTtcbn07XG5cbktRQ2FyZC5faXNTYW5TaHVuWmkgPSBmdW5jdGlvbiAodG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5pc1NodW5aaSh0b3VDYXJkcykgJiYgS1FDYXJkLmlzU2h1blppKHpob25nQ2FyZHMpXG4gICAgICAgICYmIEtRQ2FyZC5pc1NodW5aaSh3ZWlDYXJkcyk7XG59O1xuLy8g5piv5ZCm5piv5LiJ5ZCM6Iqx6aG6XG5LUUNhcmQuaXNTYW5Ub25nSHVhU2h1biA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSAxMztcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGlmKGNhcmQyMC5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGV0IGNvbG9yQ2FyZHNPYmplY3QgPSBLUUNhcmQuX2NvbG9yQ2xhc3NDYXJkcyhjYXJkcyk7XG5cbiAgICB2YXIgc3ViQ2FyZHMgPSBbXTtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNvbG9yQ2FyZHNPYmplY3QpIHtcbiAgICAgICAgbGV0IGNhcmRzID0gY29sb3JDYXJkc09iamVjdFtwcm9wXTtcbiAgICAgICAgc3ViQ2FyZHMucHVzaChjYXJkcyk7XG4gICAgfVxuXG4gICAgaWYgKHN1YkNhcmRzLmxlbmd0aCAhPSAzKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBzdWJDYXJkcyA9IHN1YkNhcmRzLnNvcnQoZnVuY3Rpb24gKHMxLCBzMikge1xuICAgICAgICByZXR1cm4gczEubGVuZ3RoID4gczIubGVuZ3RoO1xuICAgIH0pO1xuXG4gICAgbGV0IHRvdUNhcmRzID0gc3ViQ2FyZHNbMF07XG4gICAgbGV0IHpob25nQ2FyZHMgPSBzdWJDYXJkc1sxXTtcbiAgICBsZXQgd2VpQ2FyZHMgPSBzdWJDYXJkc1syXTtcblxuICAgIGlmICgodG91Q2FyZHMubGVuZ3RoICE9IDMpIHx8ICh6aG9uZ0NhcmRzLmxlbmd0aCAhPSA1KSB8fCAod2VpQ2FyZHMubGVuZ3RoICE9IDUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gS1FDYXJkLl9pc1NhblRvbmdIdWFTaHVuKHRvdUNhcmRzLCB6aG9uZ0NhcmRzLCB3ZWlDYXJkcyk7XG59O1xuXG4vLyDlsIbniYzmoLnmja4gY29sb3Ig6L+b6KGM5YiG57G7XG5LUUNhcmQuX2NvbG9yQ2xhc3NDYXJkcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBjb2xvckNhcmRzT2JqZWN0ID0ge307XG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICBsZXQgY29sb3IgPSBjYXJkLmNvbG9yO1xuICAgICAgICB2YXIgc3ViQ2FyZHMgPSBjb2xvckNhcmRzT2JqZWN0W2NvbG9yXTtcbiAgICAgICAgaWYgKCFzdWJDYXJkcykge1xuICAgICAgICAgICAgc3ViQ2FyZHMgPSBbXTtcbiAgICAgICAgICAgIGNvbG9yQ2FyZHNPYmplY3RbY29sb3JdID0gc3ViQ2FyZHM7XG4gICAgICAgIH1cbiAgICAgICAgc3ViQ2FyZHMucHVzaChjYXJkKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBjb2xvckNhcmRzT2JqZWN0O1xufTtcblxuLy8g5piv5ZCm5piv5LiJ5ZCM6Iqx6aG6XG5LUUNhcmQuX2lzU2FuVG9uZ0h1YVNodW4gPSBmdW5jdGlvbiAodG91Q2FyZHMsIHpob25nQ2FyZHMsIHdlaUNhcmRzKSB7XG4gICAgcmV0dXJuIEtRQ2FyZC5pc1RvbmdIdWFTaHVuKHRvdUNhcmRzKSAmJiBLUUNhcmQuaXNUb25nSHVhU2h1bih6aG9uZ0NhcmRzKVxuICAgICAgICAmJiBLUUNhcmQuaXNUb25nSHVhU2h1bih3ZWlDYXJkcyk7XG59O1xuXG5cbi8vIOaYr+WQpuaYryDigJzkuInliIblpKnkuIvigJ1cbktRQ2FyZC5pc1NhbkZlblRpYW5YaWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHRpZVpoaUxlbmd0aCA9IDQ7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mVGllWmhpID0gMDtcbiAgICBmb3IgKGxldCBwcm9wIGluIHBvaW50SGVscGVyLnBvaW50TnVtYmVycykge1xuICAgICAgICBsZXQgdmFsdWUgPSBwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF07XG4gICAgICAgIGlmICh2YWx1ZSA9PSB0aWVaaGlMZW5ndGgpIHtcbiAgICAgICAgICAgIG51bWJlck9mVGllWmhpID0gbnVtYmVyT2ZUaWVaaGkgKyAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudW1iZXJPZlRpZVpoaSA9PT0gMztcbn07XG5cblxuLy8g5piv5ZCm5pivIOKAnOWbm+Wll+S4ieadoeKAnVxuS1FDYXJkLmlzU2lUYW9TYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgbGV0IGxlbmd0aCA9IDEzO1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBsZXQgc2FuVGlhb0xlbmd0aCA9IDM7XG4gICAgbGV0IHBvaW50SGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgbGV0IG51bWJlck9mU2FuVGlhbyA9IDA7XG4gICAgZm9yIChsZXQgcHJvcCBpbiBwb2ludEhlbHBlci5wb2ludE51bWJlcnMpIHtcbiAgICAgICAgbGV0IHZhbHVlID0gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzW3Byb3BdO1xuICAgICAgICBpZiAodmFsdWUgPT0gc2FuVGlhb0xlbmd0aCkge1xuICAgICAgICAgICAgbnVtYmVyT2ZTYW5UaWFvID0gbnVtYmVyT2ZTYW5UaWFvICsgMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudW1iZXJPZlNhblRpYW8gPT0gNDtcbn07XG5cblxuLy8g5piv5ZCm5pivIOKAnOS4ieahg+iKseKAnVxuLy8g5aS044CB5Lit44CB5bC+6YGT5Li655u45ZCM6Iqx6Imy55qE54mMXG5LUUNhcmQuaXNTYW5UYW9IdWEgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBsZXQgbGVuZ3RoID0gMTM7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBjYXJkMjAgPSBLUUNhcmQuY29udGFpbjIwKGNhcmRzKTtcbiAgICBpZihjYXJkMjAubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGxldCBjb2xvckhlbHBlciA9IG5ldyBLUUNhcmRDb2xvcnNIZWxwZXIoY2FyZHMpO1xuICAgIHZhciBjb2xvck51bWJlcnMgPSBbXTtcbiAgICBmb3IgKGxldCBwcm9wIGluIGNvbG9ySGVscGVyLmNvbG9yTnVtYmVyKSB7XG4gICAgICAgIGNvbG9yTnVtYmVycy5wdXNoKGNvbG9ySGVscGVyLmNvbG9yTnVtYmVyW3Byb3BdKTtcbiAgICB9XG5cbiAgICBjb2xvck51bWJlcnMuc29ydChmdW5jdGlvbiAobjEsIG4yKSB7XG4gICAgICAgIHJldHVybiBuMSAtIG4yO1xuICAgIH0pO1xuXG4gICAgaWYgKGNvbG9yTnVtYmVycy5sZW5ndGggIT0gMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKGNvbG9yTnVtYmVyc1swXSA9PSAzXG4gICAgICAgICYmIChjb2xvck51bWJlcnNbMV0gPT0gNSlcbiAgICAgICAgJiYgKGNvbG9yTnVtYmVyc1syXSA9PSA1KSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbi8vIOWIpOaWreaYr+WQpuWMheWQq+mTgeaUr1xuLy8g5Zub5byg5ZCM5qC354K55pWw55qE54mMXG5LUUNhcmQuY29udGFpblRpZVpoaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSA0O1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvL2xldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2lmKGhlbHBlci5tYXhOdW1iZXIoKSA+PSBsZW5ndGgpe1xuICAgIC8vICAgIHJldHVybiBoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoO1xuICAgIC8vfWVsc2V7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5jb250YWluR3VpUGFpKGNhcmRzLDQpO1xuICAgIC8vfVxuICAgIGlmIChLUUNhcmQuZmluZFRpZVpoaShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuXG4vLyDliKTmlq3mmK/lkKbmmK/pk4HmlK9cbktRQ2FyZC5pc1RpZVpoaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSA0O1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgY2FyZCkge1xuICAgICAgICBpZiAocG9pbnQgPT0gY2FyZC5wb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9LCBjYXJkc1swXS5wb2ludCk7XG5cbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xufTtcblxuLyojIyMjI+aYr+WQpuWMheWQq+S6lOWQjCovXG4vL+S6lOW8oOWQjOagt+eCueaVsOeahOeJjFxuS1FDYXJkLmNvbnRhaW5XdVRvbmcgPSBmdW5jdGlvbihjYXJkcykge1xuICAgIHZhciBsZW5ndGggPSA1O1xuICAgIGlmKGNhcmRzLmxlbmd0aCA8IGxlbmd0aCl7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy/kupTlvKDniYznm7jlkIznmoRcbiAgICAvL2xldCBoZWxwZXIgPSBuZXcgS1FDYXJkUG9jb250YWluMjBpbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2lmKGhlbHBlci5tYXhOdW1iZXIoKSA+PSBsZW5ndGgpe1xuICAgIC8vICAgIHJldHVybiBoZWxwZXIubWF4TnVtYmVyKCkgPj0gbGVuZ3RoO1xuICAgIC8vfWVsc2V7XG4gICAgLy8gICAgcmV0dXJuIEtRQ2FyZC5jb250YWluR3VpUGFpKGNhcmRzLDUpO1xuICAgIC8vfVxuICAgIGlmIChLUUNhcmQuZmluZFd1VG9uZyhjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuLyrliKTmlq3mmK/lkKbkupTlkIwqL1xuS1FDYXJkLmlzV3VUb25nID0gZnVuY3Rpb24oY2FyZHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gNTtcbiAgICBpZihjYXJkcy5sZW5ndGggIT0gbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMucmVkdWNlKGZ1bmN0aW9uIChwb2ludCwgY2FyZCkge1xuICAgICAgICBpZiAocG9pbnQgPT0gY2FyZC5wb2ludCkge1xuICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9LCBjYXJkc1swXS5wb2ludCk7XG5cbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xufTtcbi8qIyMjIyMqL1xuXG4vLyDmmK/lkKbmmK8g4oCc6JGr6Iqm4oCdXG4vLyDkuInlvKDnm7jlkIwgKyDkuIDlr7lcbktRQ2FyZC5jb250YWluSHVMdSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGxldCBsZW5ndGggPSA1O1xuICAgIGlmIChjYXJkcy5sZW5ndGggPCBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRIdUx1KGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvL2xldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIC8vdmFyIHBvaW50TnVtYmVycyA9IFtdO1xuICAgIC8vdmFyIGluZGV4ID0gMDtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgcG9pbnROdW1iZXJzW2luZGV4XSA9IHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXTtcbiAgICAvLyAgICBpbmRleCA9IGluZGV4ICsgMTtcbiAgICAvL31cbiAgICAvL3ZhciBoPVtdO1xuICAgIC8vdmFyIGgxPVtdO1xuICAgIC8vZm9yKHZhciBpIGluIHBvaW50TnVtYmVycyl7XG4gICAgLy8gICAgdmFyIHM9cG9pbnROdW1iZXJzW2ldO1xuICAgIC8vICAgIGlmKHMgPT0gMyl7XG4gICAgLy8gICAgICAgIGgucHVzaChzKVxuICAgIC8vICAgIH1cbiAgICAvLyAgICBlbHNlIGlmKHM9PTQpe1xuICAgIC8vICAgICAgICBoMS5wdXNoKHMpXG4gICAgLy8gICAgfVxuICAgIC8vXG4gICAgLy99XG4gICAgLy9cbiAgICAvL2lmICgocG9pbnROdW1iZXJzLmluZGV4T2YoMykgIT0gLTEpICYmIChwb2ludE51bWJlcnMuaW5kZXhPZigyKSAhPSAtMSlcbiAgICAvLyB8fCBoLmxlbmd0aCA+IDEgfHwgaDEubGVuZ3RoID4gMSB8fChwb2ludE51bWJlcnMuaW5kZXhPZig0KSAhPSAtMSlcbiAgICAvLyAmJiAocG9pbnROdW1iZXJzLmluZGV4T2YoMikgIT0gLTEpKSB7XG4gICAgLy8gICAgcmV0dXJuIHRydWU7XG4gICAgLy99XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vLyDliKTmlq3mmK/lkKbmmK8g6JGr6IqmXG5LUUNhcmQuaXNIdUx1ID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCAhPSA1KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgcG9pbnRzID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIHJldHVybiBjYXJkLnBvaW50O1xuICAgIH0pLnNvcnQoZnVuY3Rpb24gKHAxLCBwMikge1xuICAgICAgICByZXR1cm4gcDEgLSBwMjtcbiAgICB9KTtcblxuICAgIHZhciBwMSA9IHBvaW50c1swXTtcbiAgICB2YXIgcDIgPSBwMTtcbiAgICB2YXIgbnVtYmVyUDEgPSAwO1xuICAgIHZhciBudW1iZXJQMiA9IDA7XG5cbiAgICBwb2ludHMuZm9yRWFjaChmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgaWYgKHBvaW50ICE9IHAxICYmIHBvaW50ICE9IHAyKSB7XG4gICAgICAgICAgICBwMiA9IHBvaW50O1xuICAgICAgICAgICAgbnVtYmVyUDIgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgbnVtYmVyUDEgPSBudW1iZXJQMSArICgocG9pbnQgPT0gcDEpID8gMSA6IDApO1xuICAgICAgICBudW1iZXJQMiA9IG51bWJlclAyICsgKChwb2ludCA9PSBwMikgPyAxIDogMCk7XG4gICAgfSk7XG5cbiAgICBsZXQgbWF4TnVtYmVyID0gTWF0aC5tYXgobnVtYmVyUDEpO1xuICAgIGxldCBtaW5OdW1iZXIgPSBNYXRoLm1pbihudW1iZXJQMik7XG5cbiAgICByZXR1cm4gKG1pbk51bWJlciA9PSAyKSAmJiAobWF4TnVtYmVyID09IDMpO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5pyJIOKAnOS4ieadoeKAnVxuS1FDYXJkLmNvbnRhaW5TYW5UaWFvID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoS1FDYXJkLmZpbmRTYW5UaWFvKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy9sZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgaWYgKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXSA+PSAzKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICAvL1xuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluR3VpUGFpKGNhcmRzLDMpO1xufTtcblxuLy8g5piv5ZCm5pivIOKAnOS4ieadoeKAnVxuS1FDYXJkLmlzU2FuVGlhbyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gMykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IHJlc3VsdCA9IGNhcmRzLnJlZHVjZShmdW5jdGlvbiAocG9pbnQsIGNhcmQpIHtcbiAgICAgICAgaWYgKGNhcmQucG9pbnQgPT0gcG9pbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwb2ludDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9LCBjYXJkc1swXS5wb2ludCk7XG5cbiAgICByZXR1cm4gcmVzdWx0ICE9IC0xO1xufTtcblxuLy8g5piv5ZCm5YyF5ZCr5pyJIO+8muS4pOWvuVxuS1FDYXJkLmNvbnRhaW5MaWFEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgNCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZExpYUR1aShjYXJkcykubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy92YXIgbnVtYmVyT2ZEdWlaaSA9IDA7XG4gICAgLy9sZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgaWYgKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXSA9PSAyKSB7XG4gICAgLy8gICAgICAgIG51bWJlck9mRHVpWmkgPSBudW1iZXJPZkR1aVppICsgMTtcbiAgICAvLyAgICAgICAgaWYgKG51bWJlck9mRHVpWmkgPT0gMikge1xuICAgIC8vICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgLy8gICAgICAgIH1cbiAgICAvLyAgICB9XG4gICAgLy99XG5cbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG4vLyDmmK/lkKbmmK8g5Lik5a+5XG5LUUNhcmQuaXNMaWFEdWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoICE9IDQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGxldCBwb2ludEhlbHBlciA9IG5ldyBLUUNhcmRQb2ludHNIZWxwZXIoY2FyZHMpO1xuICAgIGZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgICAgIGlmIChwb2ludEhlbHBlci5wb2ludE51bWJlcnNbcHJvcF0gIT0gMikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcblxuLy8g5piv5LiN5piv5a+55a2QXG5LUUNhcmQuaXNEdWlaaSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5sZW5ndGggIT0gMikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGNhcmQxID0gY2FyZHNbMF07XG4gICAgbGV0IGNhcmQyID0gY2FyZHNbMV07XG5cbiAgICByZXR1cm4gY2FyZDEucG9pbnQgPT0gY2FyZDIucG9pbnQ7XG59O1xuXG4vLyDmmK/lkKbljIXlkKvlr7nlrZBcbktRQ2FyZC5jb250YWluRHVpWmkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgMikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChLUUNhcmQuZmluZER1aVppKGNhcmRzKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gICAgLy9sZXQgcG9pbnRIZWxwZXIgPSBuZXcgS1FDYXJkUG9pbnRzSGVscGVyKGNhcmRzKTtcbiAgICAvL2ZvciAobGV0IHByb3AgaW4gcG9pbnRIZWxwZXIucG9pbnROdW1iZXJzKSB7XG4gICAgLy8gICAgaWYgKHBvaW50SGVscGVyLnBvaW50TnVtYmVyc1twcm9wXSA9PSAyKSB7XG4gICAgLy8gICAgICAgIHJldHVybiB0cnVlO1xuICAgIC8vICAgIH1cbiAgICAvL31cbiAgICAvL1xuICAgIC8vcmV0dXJuIEtRQ2FyZC5jb250YWluR3VpUGFpKGNhcmRzLDIpO1xufTtcblxuS1FDYXJkLmNvbnRhaW5HdWlQYWkgPSBmdW5jdGlvbiAoY2FyZHMgLCBsZW5ndGgpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNhcmQyMCA9IEtRQ2FyZC5jb250YWluMjAoY2FyZHMpO1xuICAgIGNhcmRzID0gY2FyZHMua3FfZXhjbHVkZXMoY2FyZDIwKTtcbiAgICBsZXQgaGVscGVyID0gbmV3IEtRQ2FyZFBvaW50c0hlbHBlcihjYXJkcyk7XG4gICAgdmFyIG1heE51bWJlciA9IChoZWxwZXIubWF4TnVtYmVyKCkgKyBjYXJkMjAubGVuZ3RoKTtcbiAgICByZXR1cm4gbWF4TnVtYmVyID49IGxlbmd0aDtcbn07XG4vKiMjIyMjKi9cbi8vIOaYr+WQpuaYr+eJueauiueJjFxuS1FDYXJkLmlzVGVTaHVQYWkgPSBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICBpZiAoY2FyZHMubGVuZ3RoIDwgMTMpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiBLUUNhcmQuaXNRaW5nTG9uZyhjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcylcbiAgICAgICAgLyp8fCBLUUNhcmQuaXNTYW5Ub25nSHVhU2h1bihjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzU2FuRmVuVGlhblhpYShjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzU2lUYW9TYW5UaWFvKGNhcmRzKVxuICAgICAgICB8fCBLUUNhcmQuaXNMaXVEdWlCYW4oY2FyZHMpXG4gICAgICAgIHx8IEtRQ2FyZC5pc1NhblNodW5aaShjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzU2FuU2h1blppMShjYXJkcylcbiAgICAgICAgfHwgS1FDYXJkLmlzU2FuVG9uZ0h1YShjYXJkcylcblxuICAgIHx8IEtRQ2FyZC5pc1d1RHVpU2FuVGlhbyhjYXJkcylcbiAgICB8fCBLUUNhcmQuaXNDb3VZaVNlKGNhcmRzKSovO1xufTtcblxuLy8g5bCG54mM5Lit55qEIDEg5Y+Y5YyW5Li6IEHvvIgxNClcbktRQ2FyZC5fY29udmVydE9uZVRvQSA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIGlmIChjYXJkcy5maW5kKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FyZC5wb2ludCA9PSAxO1xuICAgICAgICB9KSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGNhcmRzO1xuICAgIH1cbiAgICBsZXQgcmVzdWx0ID0gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICAgIGlmIChjYXJkLnBvaW50ID09IDEpIHtcbiAgICAgICAgICAgIGxldCBuZXdDYXJkID0gbmV3IEtRQ2FyZCgxNCwgY2FyZC5jb2xvcik7XG4gICAgICAgICAgICByZXR1cm4gbmV3Q2FyZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FyZDtcbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5LUUNhcmQuX2NvbnZlcnRPbmVUb0ExID0gZnVuY3Rpb24gKGNhcmRzKSB7XG4gICAgaWYgKGNhcmRzLmZpbmQoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYXJkLnBvaW50ID09IDE7XG4gICAgICAgIH0pID09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gY2FyZHM7XG4gICAgfVxuICAgIHZhciBudW0gPSAwO1xuICAgIGxldCByZXN1bHQgPSBjYXJkcy5tYXAoZnVuY3Rpb24gKGNhcmQpIHtcbiAgICAgICAgaWYgKGNhcmQucG9pbnQgPT0gMSAmJiBudW0gPT0gMCkge1xuICAgICAgICAgICAgbnVtKys7XG4gICAgICAgICAgICBsZXQgbmV3Q2FyZCA9IG5ldyBLUUNhcmQoMTQsIGNhcmQuY29sb3IpO1xuICAgICAgICAgICAgcmV0dXJuIG5ld0NhcmQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuLy8gS1FDYXJkIOeahOaOkuW6j+aWueazlVxuS1FDYXJkLnNvcnRCeVBvaW50ID0gZnVuY3Rpb24gKGNhcmQxLCBjYXJkMikge1xuICAgIGxldCByZXN1bHQgPSBOdW1iZXIoY2FyZDEucG9pbnQpIC0gTnVtYmVyKGNhcmQyLnBvaW50KVxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5LUUNhcmQuc29ydEJ5Q29sb3IgPSBmdW5jdGlvbiAoY2FyZDEsIGNhcmQyLCBwb2ludEFzYyA9IHRydWUpIHtcbiAgICBpZiAoY2FyZDIuY29sb3IgPT0gY2FyZDEuY29sb3IpIHtcbiAgICAgICAgcmV0dXJuIChjYXJkMS5wb2ludCAtIGNhcmQyLnBvaW50KSAqIChwb2ludEFzYyA/IDEgOiAtMSk7XG4gICAgfVxuICAgIHJldHVybiBjYXJkMi5jb2xvciAtIGNhcmQxLmNvbG9yO1xufVxuXG5LUUNhcmQuc29ydCA9IGZ1bmN0aW9uIChjYXJkMSwgY2FyZDIsIGFzYyA9IHRydWUsIEFpc01heCA9IHRydWUpIHtcbiAgICBsZXQgcmVzdWx0ID0gMTtcbiAgICBpZiAoY2FyZDEucG9pbnQgPT0gY2FyZDIucG9pbnQpIHtcbiAgICAgICAgcmVzdWx0ID0gY2FyZDEuY29sb3IgLSBjYXJkMi5jb2xvcjtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcG9pbnQxID0gY2FyZDEucG9pbnQ7XG4gICAgICAgIHZhciBwb2ludDIgPSBjYXJkMi5wb2ludDtcbiAgICAgICAgaWYgKEFpc01heCAmJiBwb2ludDEgPT0gMSkge1xuICAgICAgICAgICAgcG9pbnQxID0gMTQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoQWlzTWF4ICYmIHBvaW50MiA9PSAxKSB7XG4gICAgICAgICAgICBwb2ludDIgPSAxNDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlc3VsdCA9IHBvaW50MSAtIHBvaW50MjtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0ICogKGFzYyA/IDEgOiAtMSk7XG59O1xuXG4vL+i9rOS4uuWuouaIt+err+eahOeJjFxuS1FDYXJkLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyA9IGZ1bmN0aW9uIChjYXJkcykge1xuICAgIC8vIFt7XCJzdWl0XCI6XCJzXCIsXCJudW1iZXJcIjoxMH1dXG4gICAgbGV0IHN1aXRDb2xvck1hcCA9WycnLCdkJywnYycsJ2gnLCdzJ107XG4gICAgcmV0dXJuIGNhcmRzLm1hcChmdW5jdGlvbiAoY2FyZCkge1xuICAgICAgICB2YXIgY2FyZE51bWJlciA9IGNhcmQucG9pbnQ7XG4gICAgICAgIGxldCBjb2xvciA9IHN1aXRDb2xvck1hcFtjYXJkLmNvbG9yXTtcbiAgICAgICAgbGV0IG51bWJlciA9IE1hdGgubWF4KE1hdGgubWluKGNhcmROdW1iZXIsIDEzKSwgMSk7XG4gICAgICAgIHJldHVybiB7bnVtYmVyOm51bWJlcixzdWl0OmNvbG9yfTtcbiAgICB9KTtcbn07IiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuXG5sZXQgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlciA9IHtcbiAgICBzdGFydDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9kaWRTdGFydCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2RpZFN0YXJ0ID0gdHJ1ZTtcblxuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlRm9yY2VFeGl0LCB0aGlzLl9mb3JjZUV4aXRBcHAsIHRoaXMpO1xuICAgIH0sXG5cbiAgICBfZm9yY2VFeGl0QXBwOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBLUU5hdGl2ZUludm9rZS5mb3JjZUV4aXRBcHAoKTtcbiAgICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyOyIsImxldCBLUUdsb2JhbEV2ZW50ID0ge1xuICAgIF9oYW5kbGVzOiB7fSxcbiAgICAvL+WPkemAgeS6i+S7tlxuICAgIGVtaXQ6IGZ1bmN0aW9uIChldmVudE5hbWUsIGRhdGEgPSB7fSkge1xuICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGRhdGEgPSB7J2RhdGEnOiBkYXRhfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciByZXR1cm5zID0gW10gLy/ov5Tlm57lgLxcbiAgICAgICAgZGF0YS5ldmVudE5hbWUgPSBldmVudE5hbWUvL+S/neWtmOS4gOS4i+S6i+S7tuWQjeWtl1xuXG4gICAgICAgIGZvciAoIHZhciBmaW5kRXZlbk5hbWUgaW4gdGhpcy5faGFuZGxlcyl7XG4gICAgICAgICAgICBpZiAoZmluZEV2ZW5OYW1lID09IGV2ZW50TmFtZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5faGFuZGxlc1tmaW5kRXZlbk5hbWVdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHRoaXMuX2hhbmRsZXNbZmluZEV2ZW5OYW1lXVtpXShkYXRhKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5zLnB1c2gocmV0dXJuVmFsdWUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJldHVybnNcbiAgICB9LFxuICAgIC8v5re75Yqg5pmu6YCa5LqL5Lu2XG4gICAgb246IGZ1bmN0aW9uIChldmVudE5hbWUsIGNhbGxiYWNrLCB0YXJnZXQpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ+aUtuWIsOS6i+S7ticsIGV2ZW50TmFtZSk7XG4gICAgICAgIHRoaXMuX2hhbmRsZXNbZXZlbnROYW1lXSA9IHRoaXMuX2hhbmRsZXNbZXZlbnROYW1lXSB8fCBbXVxuXG4gICAgICAgIHRoaXMuX2hhbmRsZXNbZXZlbnROYW1lXS5wdXNoKGNhbGxiYWNrLmJpbmQodGFyZ2V0KSlcbiAgICAgICAgY2FsbGJhY2suX2NhbGxlciA9IHRhcmdldDtcbiAgICB9LFxuXG4gICAgLy/pgJrov4fkuovku7blkI3np7vpmaTkuIDkuKrnm5HlkKzlmahcbiAgICBvZmY6IGZ1bmN0aW9uIChldmVudE5hbWUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9oYW5kbGVzW2V2ZW50TmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZXNbZXZlbnROYW1lXVtpXSA9IG51bGxcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyDnp7vliqjkuIDkuKogdGFyZ2V0IOS4iuaJgOacieeahOebkeWQrFxuICAgIG9mZlRhcmdldDogZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzLl9oYW5kbGVzKSB7XG4gICAgICAgIHZhciBldmVudEhhbmRsZXJzID0gdGhpcy5faGFuZGxlc1tuYW1lXTtcbiAgICAgICAgdmFyIGluZGV4cyA9IGV2ZW50SGFuZGxlcnMuZmlsdGVyKGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjay5fY2FsbGVyID0gdGFyZ2V0O1xuICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKGNhbGxiYWNrLCBpbmRleCkge1xuICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIGluZGV4T2Zmc2V0ID0gMDtcbiAgICAgICAgaW5kZXhzLmZvckVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgZXZlbnRIYW5kbGVycy5zcGxpY2UoaW5kZXggKyBpbmRleE9mZnNldCwgMSk7XG4gICAgICAgICAgaW5kZXhPZmZzZXQgPSBpbmRleE9mZnNldCArIDE7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEtRR2xvYmFsRXZlbnQ7XG4iLCJsZXQgS1FOYXRpdmVJbnZva2UgPSB7XG4gIElPU0NsYXNzTmFtZTogXCJBcHBDb250cm9sbGVyXCIsXG4gIEFORFJJT0RDbGFzc05hbWU6IFwiY29tL2xsaW5nL3Nzei9BcHBBY3Rpdml0eVwiLFxuXG4gIGlzTmF0aXZlSU9TOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHBsYXRmb3JtID0gY2Muc3lzLnBsYXRmb3JtO1xuICAgIGlmICgocGxhdGZvcm0gPT0gY2Muc3lzLklQSE9ORSkgfHwgKHBsYXRmb3JtID09IGNjLnN5cy5JUEFEKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICBpc05hdGl2ZUFuZHJvaWQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgcGxhdGZvcm0gPSBjYy5zeXMucGxhdGZvcm07XG4gICAgaWYgKHBsYXRmb3JtID09IGNjLnN5cy5BTkRST0lEKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIGlzTmF0aXZlOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNjLnN5cy5pc05hdGl2ZSA9PSB0cnVlO1xuICB9XG59O1xuXG4vLyBNQVJLOiDlj6/osIPnlKjnmoTmnKzlnLDmlrnms5Vcbi8qKlxuICog5b6u5L+h55m75b2VXG4gKi9cbktRTmF0aXZlSW52b2tlLnd4TG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hMb2dpblwiKTsgLy9JT1NcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hMb2dpblwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+Wkp+WOheS/oeaBr+WIsOW+ruS/oeWlveWPi1xuICogXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlSGFsbFRvV2VDaGF0RnJpZW5kID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsRnJpZW5kXCIsICk7XG4gIH0gZWxzZSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlSGFsbEZyaWVuZFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+Wkp+WOheS/oeaBr+WIsOaci+WPi+WciFxuICogXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlSGFsbFRvV2VDaGF0VGltZWxpbmUgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuLyoqXG4gKiDlvLrliLbpgIDlh7ogQVBQXG4gKiBcbiAqL1xuS1FOYXRpdmVJbnZva2UuZm9yY2VFeGl0QXBwID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cblxuLyoqXG4gKiDkuIvovb3mlrDniYjmnKxcbiAqIFxuICogQHBhcmFtIHtTdHJpbmd9IGlvc1VybCAgICAgIGlPUyDniYjmnKzlnLDlnYBcbiAqIEBwYXJhbSB7U3RyaW5nfSBhbmRyb2lkVXJsICDlronljZPniYjmnKzlnLDlnYBcbiAqL1xuS1FOYXRpdmVJbnZva2UuZG93bmxvYWROZXdWZXJzaW9uID0gZnVuY3Rpb24gKGlvc1VybCwgYW5kcm9pZFVybCkge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvbjpcIiwgaW9zVXJsKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvblwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCBhbmRyb2lkVXJsKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIOWIhuS6q+aIv+mXtOe7meW+ruS/oeWlveWPi1xuICogXG4gKiBAcGFyYW0ge1N0cmluZ30gcm9vbUlkICAgICAgICAg5oi/6Ze0IGlkIOS/oeaBr1xuICogQHBhcmFtIHtTdHJpbmd9IGRlc2NyaXB0aW9uICAgIOaWh+acrOaPj+i/sFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZVJvb21Ub1dlQ2hhdEZyaWVuZCA9IGZ1bmN0aW9uIChyb29tSWQsIGRlc2NyaXB0aW9uKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZDpkZXNjcmlwdGlvbjpcIiwgaWQsIGRlc2NyaXB0aW9uKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUZyaWVuZFwiLCBcIihMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVlwiLCBpZCwgZGVzY3JpcHRpb24pO1xuICB9XG59O1xuXG4vKipcbiAqIOWIhuS6q+aIv+mXtOWIsOW+ruS/oeaci+WPi+WciFxuICogXG4gKiBAcGFyYW0ge1N0cmluZ30gcm9vbUlkICAgICAgICAg5oi/6Ze0IGlkIOS/oeaBr1xuICogQHBhcmFtIHtTdHJpbmd9IGRlc2NyaXB0aW9uICAgIOaWh+acrOaPj+i/sFxuICovXG5LUU5hdGl2ZUludm9rZS5zaGFyZVJvb21Ub1dlQ2hhdFRpbWVsaW5lID0gZnVuY3Rpb24gKHJvb21JZCwgZGVzY3JpcHRpb24pIHtcbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJ3eFNoYXJlOmRlc2NyaXB0aW9uOlwiLCBpZCwgZGVzY3JpcHRpb24pO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGlkLCBkZXNjcmlwdGlvbik7XG4gIH1cbn07XG5cbi8qKlxuICog5YiG5Lqr5bGP5bmV5oiq5Zu+5Yiw5b6u5L+h5aW95Y+LXG4gKi9cbktRTmF0aXZlSW52b2tlLnNoYXJlU2NyZWVuVG9XZUNoYXRGcmllbmQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCApO1xuICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCBcIigpVlwiKTtcbiAgfVxufTtcblxuLyoqXG4gKiDliIbkuqvlsY/luZXmiKrlm77liLDlvq7kv6HmnIvlj4vlnIhcbiAqL1xuS1FOYXRpdmVJbnZva2Uuc2hhcmVTY3JlZW5Ub1dlQ2hhdFRpbWVsaW5lID0gZnVuY3Rpb24gKCkge1xuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgKTtcbiAgfSBlbHNlIHsgLy9BbmRyb2lkXG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2NyZWVuU2hhcmVcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbi8qKlxuICog5byA5aeL5b2V6Z+zXG4gKi9cbktRTmF0aXZlSW52b2tlLnN0YXJ0UmVjb3JkID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIUtRTmF0aXZlSW52b2tlLmlzTmF0aXZlKCkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcInJlY29yZFwiKTtcbiAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkge1xuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJyZWNvcmRcIiwgXCIoKVZcIik7XG4gIH1cbn07XG5cbi8qKlxuICog57uT5p2f5b2V6Z+zXG4gKi9cbktRTmF0aXZlSW52b2tlLmVuZFJlY29yZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCFLUU5hdGl2ZUludm9rZS5pc05hdGl2ZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSwgXCJlbmRSZWNvcmRcIik7XG4gIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHtcbiAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZW5kUmVjb3JkXCIsIFwiKClWXCIpO1xuICB9XG59O1xuXG5LUU5hdGl2ZUludm9rZS5zY3JlZW5zaG90U2hhcmUgPSBmdW5jdGlvbihzdHJpbmdzID0gJ3NoYXJlSU1HJykge1xuICAgICAgICBpZih0aGlzLl9pc0NhcHR1cmluZyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faXNDYXB0dXJpbmcgPSB0cnVlO1xuICAgICAgICB2YXIgc2l6ZSA9IGNjLmRpcmVjdG9yLmdldFdpblNpemUoKTtcbiAgICAgICAgdmFyIGZpbGVOYW1lID0gXCJyZXN1bHRfc2hhcmUuanBnXCI7XG4gICAgICAgIHZhciBmdWxsUGF0aCA9IGpzYi5maWxlVXRpbHMuZ2V0V3JpdGFibGVQYXRoKCkgKyBmaWxlTmFtZTtcbiAgICAgICAgaWYoanNiLmZpbGVVdGlscy5pc0ZpbGVFeGlzdChmdWxsUGF0aCkpe1xuICAgICAgICAgICAganNiLmZpbGVVdGlscy5yZW1vdmVGaWxlKGZ1bGxQYXRoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGV4dHVyZSA9IG5ldyBjYy5SZW5kZXJUZXh0dXJlKE1hdGguZmxvb3Ioc2l6ZS53aWR0aCksIE1hdGguZmxvb3Ioc2l6ZS5oZWlnaHQpLGNjLklNQUdFX0ZPUk1BVF9QTkcsZ2wuREVQVEgyNF9TVEVOQ0lMOF9PRVMpO1xuICAgICAgICB0ZXh0dXJlLnNldFBvc2l0aW9uKGNjLnAoc2l6ZS53aWR0aC8yLCBzaXplLmhlaWdodC8yKSk7XG4gICAgICAgIHRleHR1cmUuYmVnaW4oKTtcbiAgICAgICAgY2MuZGlyZWN0b3IuZ2V0UnVubmluZ1NjZW5lKCkudmlzaXQoKTtcbiAgICAgICAgdGV4dHVyZS5lbmQoKTtcbiAgICAgICAgdGV4dHVyZS5zYXZlVG9GaWxlKGZpbGVOYW1lLCBjYy5JTUFHRV9GT1JNQVRfUE5HKTtcblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciB0cnlUaW1lcyA9IDA7XG4gICAgICAgIHZhciBmbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZihqc2IuZmlsZVV0aWxzLmlzRmlsZUV4aXN0KGZ1bGxQYXRoKSl7XG5cbiAgICAgICAgICAgICAgICBpZihjYy5zeXMub3MgPT0gY2Muc3lzLk9TX0FORFJPSUQpe1xuICAgICAgICAgICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKHNlbGYuQU5EUklPRENsYXNzTmFtZSwgc3RyaW5ncywgXCIoTGphdmEvbGFuZy9TdHJpbmc7KVZcIixmdWxsUGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYuX2lzQ2FwdHVyaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHRyeVRpbWVzKys7XG4gICAgICAgICAgICAgICAgaWYodHJ5VGltZXMgPiAxMCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGltZSBvdXQuLi5cIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmbiw1MCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0VGltZW91dChmbiw1MCk7XG59XG5cblxuLyoqXG4gKiDmkq3mlL7nvZHnu5zor63pn7NcbiAqIFxuICogQHBhcmFtIHtTdHJpbmd9IGF1ZGlvVXJsIOivremfs+WcsOWdgFxuICovXG5LUU5hdGl2ZUludm9rZS5wbGF5QXVkaW9XaXRoVXJsID0gZnVuY3Rpb24gKGF1ZGlvVXJsKSB7XG4gIGlmICghS1FOYXRpdmVJbnZva2UuaXNOYXRpdmUoKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsIFwicGxheVVybDpcIiwgYXVkaW9VcmwpO1xuICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7IC8vQW5kcm9pZFxuICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJwbGF5VXJsXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIGF1ZGlvVXJsKTtcbiAgfVxufTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gS1FOYXRpdmVJbnZva2U7IiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBDaGF0TWVzc2FnZSA9IHJlcXVpcmUoJ0NoYXRNZXNzYWdlJyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcblxuLy8g55So5p2l5Y+R6YCB5raI5oGv55qEIGNvbXBvbmVudFxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYnFOb2RlOmNjLk5vZGUsXG4gICAgICAgIGJxTm9kZTE6Y2MuTm9kZSxcbiAgICAgICAgYnRuTGFuZ3VhZ2VOb2RlOmNjLk5vZGUsXG4gICAgICAgIGJ0bkxhbmd1YWdlTm9kZTE6Y2MuTm9kZSxcbiAgICAgICAgYnRuQ2hhcnROb2RlOmNjLk5vZGUsXG4gICAgICAgIGJ0bkNoYXJ0Tm9kZTE6Y2MuTm9kZSxcbiAgICAgICAgdGV4dFNjcm9sbFZpZXc6Y2MuTm9kZSxcbiAgICAgICAgaW1hZ2VDb250ZW50Tm9kZTpjYy5Ob2RlLFxuXG4gICAgICAgIGVkaXRCb3g6IGNjLkVkaXRCb3gsXG5cbiAgICAgICAgdGV4dFJlY29yZFNjcm9sbFZpZXc6IGNjLlNjcm9sbFZpZXcsXG4gICAgICAgIHRleHRSZWNvcmRMYXlvdXQ6IGNjLkxheW91dCxcblxuICAgICAgICB0ZXh0UHJlZmFiOmNjLlByZWZhYixcbiAgICAgICAgY2hhdFRleHRSZWNvcmRQcmVmYWI6IGNjLlByZWZhYixcbiAgICAgICAgLy8gaW1hZ2VQcmVmYWI6Y2MuUHJlZmFiLFxuXG4gICAgICAgIGlucHV0Tm9kZTpjYy5Ob2RlLFxuXG4gICAgICAgIF91c2VySWQ6IG51bGwsXG5cbiAgICAgICAgX3BsYXllckluZm9zOiBudWxsLCAgICAgICAgLy8g6K6w5b2V55So5oi35L+h5oGvXG4gICAgICAgIF9jaGF0VGV4dE1lc3NhZ2VSZWNvcmRzOiBudWxsLCAvLyDogYrlpKnmlofmnKzmtojmga/orrDlvZVcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSBbXTtcbiAgICAgICAgdGhpcy50ZXh0Q29udGVudCA9IHRoaXMudGV4dFNjcm9sbFZpZXcuZ2V0Q29tcG9uZW50KGNjLlNjcm9sbFZpZXcpLmNvbnRlbnQ7XG4gICAgICAgIC8vIHRoaXMuaW1hZ2VDb250ZW50ID0gdGhpcy5pbWFnZVNjcm9sbFZpZXcuZ2V0Q29tcG9uZW50KGNjLlNjcm9sbFZpZXcpLmNvbnRlbnQ7XG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHZhciB0ZXh0RGF0YSA9IEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5jaGF0VGV4dHMoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0RGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBjYy5pbnN0YW50aWF0ZSh0aGlzLnRleHRQcmVmYWIpO1xuICAgICAgICAgICAgaXRlbS5nZXRDb21wb25lbnQoJ2NlbGxUZXh0Jykuc2V0VGV4dCh0ZXh0RGF0YVtpXSk7XG4gICAgICAgICAgICBpdGVtLmdldENvbXBvbmVudCgnY2VsbFRleHQnKS5vblNlbGVjdEFjdGlvbiA9IGZ1bmN0aW9uKHRleHQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm9uVGV4dENsaWNrQWN0aW9uKHRleHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudGV4dENvbnRlbnQuaCA9IDEwMDA7XG4gICAgICAgICAgICB0aGlzLnRleHRDb250ZW50LmFkZENoaWxkKGl0ZW0pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uVGV4dENsaWNrQWN0aW9uOmZ1bmN0aW9uKHRleHQgPSBcIlwiKSB7XG4gICAgICB0aGlzLmVkaXRCb3guc3RyaW5nID0gXCJcIjtcbiAgICAgIHRoaXMuc2VuZFRleHQodGV4dCk7XG4gICAgfSxcblxuICAgIGNsaWNrRW1vamk6IGZ1bmN0aW9uIChldmVudCwgZW1vamlOYW1lKSB7XG4gICAgICBsZXQgc3RyaW5nID0gdGhpcy5lZGl0Qm94LnN0cmluZztcbiAgICAgIHRoaXMuZWRpdEJveC5zdHJpbmcgPSBzdHJpbmcgKyBcIjxcIiArIGVtb2ppTmFtZSArIFwiPlwiO1xuICAgIH0sXG5cbiAgICBjbGlja1NlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBzdHJpbmcgPSB0aGlzLmVkaXRCb3guc3RyaW5nIHx8IFwiXCI7XG4gICAgICBpZiAoc3RyaW5nLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5lZGl0Qm94LnN0cmluZyA9IFwiXCI7XG4gICAgICB0aGlzLnNlbmRUZXh0KHN0cmluZyk7XG4gICAgfSxcblxuICAgIHNlbmRUZXh0OiBmdW5jdGlvbiAodGV4dCA9IFwiXCIpIHtcbiAgICAgIGlmICh0ZXh0Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgU29ja2V0LnNlbmRUZXh0KHRoaXMuX3VzZXJJZCwgdGV4dCk7XG4gICAgICB0aGlzLmRpc21pc3MoKTtcbiAgICB9LFxuXG4gICAgZGlzbWlzczogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBicUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5icU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlMS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmJxTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZTEuYWN0aXZlID0gdGhpcy5idG5DaGFydE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGV4dFNjcm9sbFZpZXcuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW1hZ2VDb250ZW50Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnRleHRSZWNvcmRTY3JvbGxWaWV3Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgfSxcblxuICAgIHRleHRBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYnFOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkxhbmd1YWdlTm9kZS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5icU5vZGUuYWN0aXZlID0gdGhpcy5idG5MYW5ndWFnZU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlMS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnRleHRTY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuaW1hZ2VDb250ZW50Tm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy50ZXh0UmVjb3JkU2Nyb2xsVmlldy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBjaGFydEFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5icU5vZGUxLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlMS5hY3RpdmUgPSB0aGlzLmJ0bkNoYXJ0Tm9kZTEuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnFOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuTGFuZ3VhZ2VOb2RlLmFjdGl2ZSA9IHRoaXMuYnRuQ2hhcnROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMudGV4dFNjcm9sbFZpZXcuYWN0aXZlID0gdGhpcy5pbWFnZUNvbnRlbnROb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRleHRSZWNvcmRTY3JvbGxWaWV3Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgYWRkUGxheWVySW5mb3M6IGZ1bmN0aW9uIChwbGF5ZXJJbmZvcykge1xuICAgICAgdGhpcy5fcGxheWVySW5mb3MgPSB0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXTtcblxuICAgICAgcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbiAodXNlckluZm8pIHtcbiAgICAgICAgbGV0IGhhdmVVc2VySW5mbyA9IHRoaXMuX3BsYXllckluZm9zLmZpbmQoZnVuY3Rpb24gKG93blVzZXJJbmZvKSB7XG4gICAgICAgICAgcmV0dXJuIG93blVzZXJJbmZvLmlkID09IHVzZXJJbmZvLmlkO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoaGF2ZVVzZXJJbmZvID09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLl9wbGF5ZXJJbmZvcy5wdXNoKHVzZXJJbmZvKTtcbiAgICAgICAgfVxuICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICB9LFxuXG4gICAgYWRkQ2hhdFRleHRNZXNzYWdlOiBmdW5jdGlvbiAodXNlcklkLCB0ZXh0KSB7XG4gICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHRoaXMuX3BsYXllckluZm9zIHx8IFtdO1xuXG4gICAgICB2YXIgbmlja25hbWUgPSBcIltJRDpcIiArIHVzZXJJZCArIFwi6K+0Xe+8mlwiO1xuICAgICAgbGV0IHVzZXJJbmZvID0gdGhpcy5fcGxheWVySW5mb3MuZmluZChmdW5jdGlvbiAodXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIHVzZXJJbmZvLmlkID09IHVzZXJJZDtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAodXNlckluZm8pIHtcbiAgICAgICAgbmlja25hbWUgPSBcIltcIiArIHVzZXJJbmZvLm5pY2tuYW1lICsgXCLor7Rd77yaXCI7XG4gICAgICB9XG5cbiAgICAgIHZhciBzdHIgPSBuaWNrbmFtZSArIHRleHQ7XG4gICAgICBzdHIgPSBDaGF0TWVzc2FnZS5wYXJzZVN0cmluZyhzdHIpO1xuICAgICAgdGhpcy5fYWRkQ2hhdFRleHRUb1JlY29yZChzdHIpO1xuICAgIH0sXG5cbiAgICBfYWRkQ2hhdFRleHRUb1JlY29yZDogZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgIHZhciBpdGVtID0gY2MuaW5zdGFudGlhdGUodGhpcy5jaGF0VGV4dFJlY29yZFByZWZhYik7XG4gICAgICBsZXQgY2hhdFRleHRSZWNvcmQgPSBpdGVtLmdldENvbXBvbmVudCgnQ2hhdFRleHRSZWNvcmQnKTtcbiAgICAgIGNoYXRUZXh0UmVjb3JkLnNldFN0cmluZyh0ZXh0KTtcblxuICAgICAgdGhpcy50ZXh0UmVjb3JkTGF5b3V0Lm5vZGUuYWRkQ2hpbGQoaXRlbSk7XG4gICAgICB0aGlzLnRleHRSZWNvcmRTY3JvbGxWaWV3LnNjcm9sbFRvQm90dG9tKCk7XG4gICAgfSxcbn0pO1xuIiwidmFyIG1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIC8vIGZvbzoge1xuICAgICAgICAvLyAgICBkZWZhdWx0OiBudWxsLCAgICAgIC8vIFRoZSBkZWZhdWx0IHZhbHVlIHdpbGwgYmUgdXNlZCBvbmx5IHdoZW4gdGhlIGNvbXBvbmVudCBhdHRhY2hpbmdcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcbiAgICAgICAgLy8gICAgc2VyaWFsaXphYmxlOiB0cnVlLCAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXG4gICAgICAgIC8vICAgIHJlYWRvbmx5OiBmYWxzZSwgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgZmFsc2VcbiAgICAgICAgLy8gfSxcbiAgICAgICAgLy8gLi4uXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIGV4aXRBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIGNjLmRpcmVjdG9yLmVuZCgpO1xuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5JT1NDbGFzc05hbWUsXCJleGl0QXBwXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgXCIoKVZcIik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiLy8gbnVtYmVyLmtxX3RpbWVzKGYpICAg6LCD55So5aSa5qyhXG5cblxuaWYgKCFOdW1iZXIucHJvdG90eXBlLmtxX3RpbWVzKSB7XG4gICAgXG4gICAgLyoqXG4gICAgICog6LCD55So5LiA5Liq5pa55rOVIHRoaXMg5qyhXG4gICAgICogXG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IGYg6KaB6LCD55So55qE5pa55rOVXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAgIHRoaXNBcmcgICDlj6/pgInvvJsgZiDnmoQgdGhpc+WAvFxuICAgICAqL1xuICAgIE51bWJlci5wcm90b3R5cGUua3FfdGltZXMgPSBmdW5jdGlvbihmLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICghZikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzOyArK2kpIHtcbiAgICAgICAgICAgIGlmICh0aGlzQXJnKSB7XG4gICAgICAgICAgICAgICAgZi5hcHBseSh0aGlzQXJnLCBpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZihpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcblxuLy8g55So5LqO5Zue5pS+55qE57uE5Lu2XG5jb25zdCBQbGF5YmFjayA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICBfcGxheWJhY2tEYXRhczogbnVsbCwgICAvLyDnlKjkuo7lm57mlL7nmoTmlbDmja5cbiAgICAgIF9pc1BsYXliYWNraW5nOiBmYWxzZSxcbiAgICB9LFxuXG4gICAgc3RhdGljczoge1xuICAgICAgaW5zdGFuY2U6IG51bGwsXG4gICAgfSxcblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgUGxheWJhY2suaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgY2MuZ2FtZS5hZGRQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKTtcbiAgICB9LFxuXG4gICAgLy8g6K6+572u5Zue5pS+5pWw5o2uXG4gICAgc2V0UGxheWJhY2tEYXRhczogZnVuY3Rpb24gKGRhdGFzKSB7XG4gICAgICB0aGlzLl9wbGF5YmFja0RhdGFzID0gZGF0YXM7XG4gICAgfSxcblxuICAgIC8vIOa4heepuuWbnuaUvuaVsOaNruOAguWQjOaXtuS8mua4heepuuWbnuaUvlxuICAgIHJlbW92ZVBsYXliYWNrRGF0YXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuc2V0UGxheWJhY2tEYXRhcyhudWxsKTtcbiAgICAgIHRoaXMuc3RvcFBsYXliYWNrKCk7XG4gICAgfSxcblxuICAgIC8vIOaYr+WQpuWMheWQq+WbnuaUvuaVsOaNrlxuICAgIGlzQ29udGFpblBsYXliYWNrRGF0YXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9wbGF5YmFja0RhdGFzICE9IG51bGw7XG4gICAgfSxcblxuICAgIC8vIOW8gOWni+WbnuaUvlxuICAgIHN0YXJ0UGxheWJhY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIOaooeaLnyBzb2NrZXQg5o6l5pS25Yiw5LqG5LqL5Lu25Y2z5Y+vXG4gICAgICBjYy5sb2coXCJQbGF5YmFjayDlvIDlp4vlm57mlL5cIik7XG5cbiAgICAgIHRoaXMuX2lzUGxheWJhY2tpbmcgPSB0cnVlO1xuXG4gICAgICBpZiAoIXRoaXMuX3BsYXliYWNrRGF0YXMpIHtcbiAgICAgICAgY2MuZXJyb3IoXCLmg7Plm57mlL7vvIzljbTmsqHmnInlm57mlL7mlbDmja5cIik7XG4gICAgICAgIHRoaXMuc3RvcFBsYXliYWNrKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fZXhlY3V0ZVBsYXliYWNrKCk7XG4gICAgfSxcblxuICAgIC8vIOWBnOatouWbnuaUvlxuICAgIHN0b3BQbGF5YmFjazogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5faXNQbGF5YmFja2luZyA9IGZhbHNlO1xuICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XG4gICAgfSxcblxuICAgIC8vIOaYr+WQpuato+WcqOWbnuaUvlxuICAgIGlzUGxheWJhY2tpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9pc1BsYXliYWNraW5nO1xuICAgIH0sXG5cbiAgICAvLyDmiafooYznnJ/mraPnmoTlm57mlL7mk43kvZxcbiAgICBfZXhlY3V0ZVBsYXliYWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgc3RhcnRUaW1lID0gMS4wO1xuICAgICAgbGV0IGludGVydmFsID0gMy4wO1xuICAgICAgY2MubG9nKHRoaXMuX3BsYXliYWNrRGF0YXMpO1xuXG4gICAgICAvLyDlnKjmn5Dkupvnibnmrormg4XlhrXkuItcbiAgICAgIC8vIOWbnuaUvuaVsOaNrumHjOS8muWMheWQq+S4pOWllyBnYW1lT3ZlciBhY3Rpb25cbiAgICAgIC8vIOaJgOS7pemcgOimgei/h+a7pOaOieWFtuS4reS4gOS4qlxuICAgICAgdGhpcy5fcGxheWJhY2tEYXRhcyA9IHRoaXMuX3BsYXliYWNrRGF0YXMuZmlsdGVyKGZ1bmN0aW9uKHN0cmluZywgaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4ID09IHRoaXMuX3BsYXliYWNrRGF0YXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChzdHJpbmcuaW5kZXhPZignXCJhY3Rpb25cIjpcImdhbWVPdmVyJykgPT0gLTEpO1xuICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICAgdGhpcy5fcGxheWJhY2tEYXRhcy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhLCBpbmRleCkge1xuICAgICAgICB2YXIgZGVsYXkgPSBzdGFydFRpbWUgKyBpbmRleCAqIGludGVydmFsO1xuICAgICAgICBpZiAoaW5kZXggPT0gdGhpcy5fcGxheWJhY2tEYXRhcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgLy8g5aaC5p6c5piv5pyA5ZCO5LiA5Liq77yM5YiZ5bqU6K+l5Y+q6Ze06ZqU5LiA56eSXG4gICAgICAgICAgZGVsYXkgPSBzdGFydFRpbWUgKyAoaW5kZXggLSAxKSAqIGludGVydmFsICsgMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjYy5sb2coXCLlm57mlL7lvIDlp4vmqKHmi58gU29ja2V0IOaOpeaUtuWIsOacjeWKoeWZqOa2iOaBrywgXCIsIGluZGV4KTtcbiAgICAgICAgICBTb2NrZXQuaW5zdGFuY2UuX2Rpc3BhdGNoUmVzcG9uc2UoZGF0YSk7XG4gICAgICAgIH0sIGRlbGF5KTtcblxuICAgICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIH0sXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXliYWNrO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuY29uc3QgQXJyYXlFeHRlbnNpb24gPSByZXF1aXJlKCdBcnJheUV4dGVuc2lvbicpO1xuY29uc3QgVXNlck1vZGVsSGVscGVyID0gcmVxdWlyZSgnVXNlck1vZGVsSGVscGVyJyk7XG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBmb2xkQ2FyZE5vZGU6IGNjLk5vZGUsICAgICAgLy8g54mM55uW552A5pe255qE5qC35a2QXG4gICAgICAgIGZvbGRDYXJkTm9kZTE6IGNjLk5vZGUsICAgICAgLy8g54mM55uW552A5pe255qE5qC35a2QXG4gICAgICBjYXJkc0JhY2tMYXlvdXQ6IGNjLkxheW91dCwgLy8gMTPlvKDniYzog4zlvbHvvIzlj6/nlKjmnaXlsZXnpLrlj5HniYzliqjnlLsg5ZCrIGNhcmRzQmFjayBDb21wb25lbnRcbiAgICAgIGNvbXBhcmVDYXJkc05vZGU6IGNjLk5vZGUsICAvLyBjb21wYXJlQ2FyZHMgICDlkKsgQ29tcGFyZUNhcmRzIENvbXBvbmVudFxuICAgICAgdXNlckluZm9Ob2RlOiBjYy5Ob2RlLCAgICAgICAgICAvLyDljIXlkKvnlKjmiLfkv6Hmga8g5ZCrIHVzZXJJbmZvIENvbXBvbmVudFxuICAgICAgY2hhdE1lc3NhZ2VOb2RlOiBjYy5Ob2RlLCAgICAgICAvLyDogYrlpKnmtojmga8g5YyF5ZCrIENoYXRNZXNzYWdlIENvbXBvbmVudFxuICAgICAgdXNlckF2YXRhck5vZGU6IGNjLk5vZGUsXG4gICAgICB1c2VyU2FtcGxlSW5mb05vZGU6IGNjLk5vZGUsXG4gICAgICB1c2VySWQ6IDAsXG4gICAgICAvKiMjIyMjKi9cbiAgICAgIHRlU2h1UGFpTGFiZWw6Y2MuTm9kZSxcbiAgICAgICAgY2FyZFR5cGVQcmVmYWI6IGNjLlByZWZhYixcbiAgICAgIC8vIOeUqOaIt+S/oeaBr1xuICAgICAgLy8gMeOAgSDlpoLmnpwg5YyF5ZCr77yaY2FyZEluZm86W13vvIzooajmmI7nlKjmiLflt7Lnu4/lh7rniYxcbiAgICAgIC8vXG4gICAgICBfdXNlckluZm86IG51bGwsXG4gICAgICBfZGVza0luZm86IG51bGwsXG4gICAgICAgIC8qKi9cbiAgICAgICAgcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzOiB7XG4gICAgICAgICAgICB2aXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIGRlZmF1bHQ6IHVuZGVmaW5lZCxcbiAgICAgICAgfVxuICAgICAgICAvKiovXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy51c2VyQXZhdGFyTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5fc2hvd1VzZXJJbmZvLCB0aGlzKTtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICB9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnVzZXJBdmF0YXJOb2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5fc2hvd1VzZXJJbmZvLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgX3Nob3dVc2VySW5mbzogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy51c2VyU2FtcGxlSW5mb05vZGUuZ2V0Q29tcG9uZW50KCdVc2VyU2FtcGxlSW5mbycpLnVwZGF0ZVdpdGhVc2VyKHRoaXMuX3VzZXJJbmZvKTtcbiAgICB9LFxuXG4gICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlMS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMudGVTaHVQYWlMYWJlbC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykucmVzZXQoKTtcbiAgICB9LFxuXG4gICAgLyojIyMjKi9cbiAgICByZXNldDI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZm9sZENhcmROb2RlMS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMudGVTaHVQYWlMYWJlbC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgLy90aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAvL3RoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLnJlc2V0KCk7XG4gICAgfSxcbiAgICAvKiMjIyMjKi9cblxuICAgIHVwZGF0ZVVzZXJJbmZvV2l0aFVzZXJzOiBmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgIGxldCB1c2VyID0gdXNlcnMuZmluZChmdW5jdGlvbiAoZSkge1xuICAgICAgICByZXR1cm4gdGhpcy51c2VySWQgPT0gZS5pZDtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICAgIHRoaXMudXBkYXRlVXNlckluZm8odXNlcik7XG4gICAgfSxcblxuICAgIHVwZGF0ZVVzZXJJbmZvOiBmdW5jdGlvbiAodXNlcikge1xuICAgICAgdGhpcy5fdXNlckluZm8gPSB1c2VyO1xuICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9ICh1c2VyICE9IG51bGwpO1xuICAgICAgdGhpcy51c2VySW5mb05vZGUuYWN0aXZlID0gdGhpcy5ub2RlLmFjdGl2ZTtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgIHVzZXJJbmZvLnVwZGF0ZUF2YXRhcih1c2VyLmF2YXRhclVybCk7XG4gICAgICB1c2VySW5mby51cGRhdGVOaWNrbmFtZSh1c2VyLm5pY2tuYW1lKTtcbiAgICAgIHVzZXJJbmZvLnNldE9mZmxpbmVWaXNpYmxlKCF1c2VyLm9ubGluZVN0YXR1cyk7XG5cbiAgICAgIC8vaWYgKHRoaXMuX2Rlc2tJbmZvICYmIHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA+IDApIHtcbiAgICAgIC8vICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModXNlcikpIHtcbiAgICAgIC8vICAgIHRoaXMucGxheUNhcmQodXNlci5pZCk7XG4gICAgICAvLyAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdDb21wYXJlQ2FyZHMnKS5zZXRDb21wYXJlRGF0YSh1c2VyKTtcbiAgICAgIC8vICB9XG4gICAgICAvL31cbiAgICAgICAgLyoqL1xuICAgICAgICBjb25zdCBjSW5kZXggPSB0aGlzLl9kZXNrSW5mby5jSW5kZXg7XG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyAmJiBjSW5kZXggPiAwICYmICh0aGlzLnBsYXllZENvbXBhcmVDYXJkc0luZGV4cy5pbmRleE9mKGNJbmRleCkgPT0gLTEpKSB7XG4gICAgICAgICAgICBpZiAoVXNlck1vZGVsSGVscGVyLmlzUGxheWVkQ2FyZHModXNlcikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXlDYXJkKHVzZXIuaWQsdXNlci5jYXJkSW5mbyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2V0Q29tcGFyZURhdGEodXNlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqL1xuICAgIH0sXG5cbiAgICAvLyDmm7TmlrDmiL/kuLvkv6Hmga9cbiAgICB1cGRhdGVCYW5rZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgbGV0IHVzZXJJbmZvQ29tcCA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgIGlmICghdGhpcy5fdXNlckluZm8pIHtcbiAgICAgICAgdXNlckluZm9Db21wLnNldElzQmFua2VyKGZhbHNlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgaXNCYW5rZXIgPSB0aGlzLl91c2VySW5mbyA/IHRoaXMuX3VzZXJJbmZvLmlzQmFua2VyIDogZmFsc2U7XG4gICAgICB1c2VySW5mb0NvbXAuc2V0SXNCYW5rZXIoaXNCYW5rZXIpOyAgICAgIFxuICAgIH0sXG5cbiAgICBzaG93RmFuZ1podVN0YXR1czogZnVuY3Rpb24gKGNyZWF0ZUlkLCB2aXNpYmxlID0gdHJ1ZSkge1xuICAgICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fdXNlckluZm8uaWQgPT0gY3JlYXRlSWQpIHtcbiAgICAgICAgICAgIHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRGYW5nWmh1Tm9kZVZpc2libGUodmlzaWJsZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICog5pu05paw5YiG5pWwIFxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzY29yZSDnlKjmiLfliIbmlbDjgIHlj6/pgIlcbiAgICAgKi9cbiAgICB1cGRhdGVTY29yZTogZnVuY3Rpb24oc2NvcmUpIHtcbiAgICAgIGlmICghc2NvcmUgJiYgdGhpcy5fdXNlckluZm8pIHtcbiAgICAgICAgc2NvcmUgPSB0aGlzLl91c2VySW5mby50b3RhbFNjb3JlO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICB1c2VySW5mby51cGRhdGVTY29yZShzY29yZSk7XG4gICAgfSxcblxuICAgIHNob3dSZWFkeVN0YXR1czogZnVuY3Rpb24gKHVzZXJJZCwgdmlzaWJsZSA9IHRydWUpIHtcbiAgICAgIGlmICghdGhpcy5ub2RlLmFjdGl2ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl91c2VySW5mby5pZCA9PSB1c2VySWQpIHtcbiAgICAgICAgdGhpcy51c2VySW5mb05vZGUuZ2V0Q29tcG9uZW50KCd1c2VySW5mbycpLnNldFJlYWR5Tm9kZVZpc2libGUodmlzaWJsZSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qc2V0RGVza0luZm86IGZ1bmN0aW9uIChkZXNrSW5mbykge1xuICAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xuICAgICB9LCovXG4gICAgdXBkYXRlRGVza0luZm86IGZ1bmN0aW9uIChkZXNrSW5mbykge1xuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xuXG4gICAgICAgIGlmIChkZXNrSW5mbyAmJiAhZGVza0luZm8uaXNDQmVnaW4pIHtcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLyoqL1xuXG4gICAgaGlkZVJlYWR5U3RhdHVzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZShmYWxzZSk7XG4gICAgfSxcblxuICAgIHBsYXlGYVBhaUFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgY2MubG9nKFwicGxheUZhUGFpQW5pbWF0aW9uXCIpO1xuICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHRoaXMuX3VzZXJJbmZvKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBjYXJkc0JhY2sgPSB0aGlzLmNhcmRzQmFja0xheW91dC5nZXRDb21wb25lbnQoJ2NhcmRzQmFjaycpO1xuICAgICAgY2FyZHNCYWNrLnNob3dQbGF5Q2FyZEJhY2tzKCk7XG4gICAgfSxcblxuICAgIHNob3VsZFNob3dGYVBhaUFuaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIFVzZXJNb2RlbEhlbHBlci5pc1BsYXllZENhcmRzKHRoaXMuX3VzZXJJbmZvKTtcbiAgICB9LFxuXG4gICAgc2V0VXNlck9ubGluZVN0YXR1czogZnVuY3Rpb24gKHVzZXJJZCwgc3RhdHVzID0gMSkge1xuICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgIHVzZXJJbmZvLnNldE9mZmxpbmVWaXNpYmxlKHN0YXR1cyAhPSAxKTtcbiAgICB9LFxuXG4gICAgc2hvd0NoYXRUZXh0OiBmdW5jdGlvbiAodXNlcklkLCBtZXNzYWdlKSB7XG4gICAgICBpZiAodXNlcklkICE9IHRoaXMudXNlcklkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IGNoYXRNZXNzYWdlID0gdGhpcy5jaGF0TWVzc2FnZU5vZGUuZ2V0Q29tcG9uZW50KCdDaGF0TWVzc2FnZScpO1xuICAgICAgY2hhdE1lc3NhZ2Uuc2V0U3RyaW5nKG1lc3NhZ2UpO1xuICAgIH0sXG5cbiAgICAvLyDnlKjmiLflt7Lnu4/lh7rniYzvvIzlpITkuo7kuInloIbnm5bnnYDniYznmoTnirbmgIFcbiAgICBwbGF5Q2FyZDogZnVuY3Rpb24gKHVzZXJJZCxjYXJkSW5mbykge1xuICAgICAgaWYgKHRoaXMudXNlcklkICE9IHVzZXJJZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY2FyZHNCYWNrTGF5b3V0Lm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLmNvbXBhcmVDYXJkc05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLnRlU2h1UGFpTGFiZWwuYWN0aXZlID0gZmFsc2U7XG4gICAgICAvKiMjIyMj5aaC5p6c5piv54m55q6K54mM5bCx5pi+56S654m55q6K54mM5Z6L6L+Z5Zub5Liq5a2X5Zyo55uW552A54mM55qE5LiK6Z2iKi9cbiAgICAgIHZhciBwbGF5ID0gY2MuZmluZChcIkNhbnZhc1wiKS5nZXRDb21wb25lbnQoXCJwbGF5XCIpOyAgLy9wbGF557uE5Lu2XG4gICAgICAvL+WmguaenOeCueWHu+S6huaBreWWnOS9oOmhtemdoueahOehruWumuaMiemSrlxuICAgICAgLy9pZih0aGlzLmNvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KFwiQ2FyZFR5cGVDb21iaW5lXCIpLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtKXtcbiAgICAgICAgICBpZihjYy5tb3NoaSAhPSAxKXtcbiAgICAgICAgICAgICAgaWYocGxheS5nZXRJc1RlU2h1UGFpKHRoaXMudXNlcklkKSl7XG4gICAgICAgICAgICAgICAgICB0aGlzLnRlU2h1UGFpTGFiZWwuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICB0aGlzLnRlU2h1UGFpTGFiZWwuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIGNjLmxvZyh0aGlzKVxuICAgICAgICBjYy5sb2coJy0tLS0tLTIyOScpXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHsvL1wi5Zue5pS+XCI7XG4gICAgICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZTEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZTEuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgaWYodGhpcy5mb2xkQ2FyZE5vZGUubmFtZSAhPSBcImZvbGRDYXJkTm9kZVNlbGZcIil7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IDM7aSsrKXtcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5mb2xkQ2FyZE5vZGUuY2hpbGRyZW5baV07XG5cbiAgICAgICAgICAgIG5vZGUucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgICAgIHZhciBjYXJkTW9kZXMgPSBbXTtcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBjYXJkSW5mb1tpXS5jYXJkcy5sZW5ndGg7aisrKXtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IGNhcmRJbmZvW2ldLmNhcmRzW2pdO1xuICAgICAgICAgICAgICAgIGNhcmRNb2Rlcy5wdXNoKHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FyZE1vZGVzID0gY2FyZE1vZGVzLm1hcChmdW5jdGlvbihzZXJDYXJkKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VyQ2FyZC5zdWl0KydfJytzZXJDYXJkLm51bWJlcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY2FyZE1vZGVzLmZvckVhY2goZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICAgICAgICAgICAgbGV0IGNhcmRUeXBlU3ByaXRlID0gY2MuaW5zdGFudGlhdGUodGhpcy5jYXJkVHlwZVByZWZhYik7XG4gICAgICAgICAgICAgICAgaWYoY2MubWFQYWkpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZE1hUGFpID0gJzNfJyArIGNjLm1hUGFpO1xuICAgICAgICAgICAgICAgICAgICBpZihjYXJkTmFtZSA9PSBjYXJkTWFQYWkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUuY29sb3IgPSBuZXcgY2MuQ29sb3IoMjI2LCAxNDUsIDE0NSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoaSA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUueSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYoaSA9PSAxKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUueSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYoaSA9PSAyKXtcbiAgICAgICAgICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUueSA9IDk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhcmRUeXBlU3ByaXRlLndpZHRoID0gNjY7XG4gICAgICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUuaGVpZ2h0ID0gOTI7XG4gICAgICAgICAgICAgICAgY2FyZFR5cGVTcHJpdGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZVNwcml0ZScpLnNldENhcmQoY2FyZE5hbWUpO1xuICAgICAgICAgICAgICAgIG5vZGUuYWRkQ2hpbGQoY2FyZFR5cGVTcHJpdGUpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGNjLmxvZyhub2RlKVxuICAgICAgICAgICAgY2MubG9nKHRoaXMuZm9sZENhcmROb2RlKVxuICAgICAgICAgICAgY2MubG9nKHRoaXMuZm9sZENhcmROb2RlMSlcbiAgICAgICAgICAgIGNjLmxvZygnLS0tLS0tLTIzOScpXG4gICAgICAgIH1cbiAgICAgICAgLy99XG5cbiAgICB9LFxuXG4gICAgLy8g5YeG5aSH5aW95byA5aeL5q+U54mMXG4gICAgcmVhZHlUb0NvbXBhcmVDYXJkczogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuY29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmZvbGRDYXJkTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5mb2xkQ2FyZE5vZGUxLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy50ZVNodVBhaUxhYmVsLmFjdGl2ZSA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7miZPmnqrliqjnlLtcbiAgICAvLyBAcGFyYW0gdXNlcklkICAg6KaB5Li75Yqo5omT5p6q55qE55So5oi3aWRcbiAgICAvLyBAcGFyYW0gdG9Vc2VySW5kZXggIOaMqOaequeahOeUqOaIt+eahCBpbmRleFxuICAgIHBsYXlTaG9vdEFuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCwgdG9Vc2VySW5kZXgpIHtcbiAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICB1c2VySW5mby5wbGF5U2hvb3RBbmltYXRpb24odG9Vc2VySW5kZXgpO1xuICAgIH0sXG5cbiAgICAvLyDmkq3mlL7kuK3mnqrliqjnlLtcbiAgICBwbGF5QnVsbGV0SG9sZUFuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgIHVzZXJJbmZvLnBsYXlCdWxsZXRIb2xlQW5pbWF0aW9uKCk7XG4gICAgfSxcblxuICAgIC8vIOaSreaUvuWFqOWekuaJk+WKqOeUu1xuICAgIHBsYXlIb21lUnVuQWltYXRpb246IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgIGlmICh1c2VySWQgIT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdXNlckluZm8gPSB0aGlzLnVzZXJJbmZvTm9kZS5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJyk7XG4gICAgICB1c2VySW5mby5wbGF5SG9tZVJ1bkFpbWF0aW9uKCk7XG4gICAgfSxcblxuICAgIHBsYXlTcGVha0FuaW1hdGlvbjogZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgaWYgKHVzZXJJZCAhPSB0aGlzLnVzZXJJZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCB1c2VySW5mbyA9IHRoaXMudXNlckluZm9Ob2RlLmdldENvbXBvbmVudCgndXNlckluZm8nKTtcbiAgICAgIHVzZXJJbmZvLnBsYXlTcGVha0FuaW1hdGlvbigpO1xuICAgIH0sXG5cbiAgICBuZXh0Q29tcGFyZVNjb3JlOiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIXRoaXMubm9kZS5hY3RpdmUpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG5cbiAgICAgIGxldCBzY29yZSA9IHRoaXMuY29tcGFyZUNhcmRzTm9kZS5nZXRDb21wb25lbnQoJ0NvbXBhcmVDYXJkcycpLm5leHRDb21wYXJlU2NvcmUoKTtcbiAgICAgIHJldHVybiBzY29yZTtcbiAgICB9LFxuXG4gICAgc2hvd05leHRDb21wYXJlQ2FyZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLm5leHRDb21wYXJlU2NvcmUoKSA8PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jb21wYXJlQ2FyZHNOb2RlLmdldENvbXBvbmVudCgnQ29tcGFyZUNhcmRzJykuc2hvd05leHRDYXJkcygpO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IEtRQ2FyZFJlc0hlbHBlciA9IHJlcXVpcmUoJ0tRQ2FyZFJlc0hlbHBlcicpO1xuY29uc3QgU3ByaXRlSGVscGVyID0gcmVxdWlyZSgnU3ByaXRlSGVscGVyJyk7XG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYXZhdGFyU3ByaXRlOiBjYy5TcHJpdGUsXG4gICAgICAgIGxhYmVsTmlja25hbWU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbFJlc3VsdE51bWJlcjogY2MuTGFiZWwsXG4gICAgICAgIGxheW91dFRvdURhbzogY2MuTGF5b3V0LFxuICAgICAgICBsYXlvdXRaaG9uZ0RhbzogY2MuTGF5b3V0LFxuICAgICAgICBsYXlvdXRXZWlEYW86IGNjLkxheW91dCxcbiAgICAgICAgbGF5b3V0VGVTaHU6IGNjLkxheW91dCxcblxuICAgICAgICBsYWJlbFRlU2h1UGFpVGl0bGU6IGNjLkxhYmVsLFxuXG4gICAgICAgIHNjb3JlVW5pdE5vZGU6IGNjLk5vZGUsICAgICAgLy8g56ev5YiGXG4gICAgICAgIGRpYW1vbmRVbml0Tm9kZTogY2MuTm9kZSwgICAgLy8g6ZK755+zXG4gICAgfSxcblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIH0sXG5cbiAgICAvL3tcImlkXCI6MTAwMDQ5LFwibmlja25hbWVcIjpcImlteWFcIixcIm9wZW5JZFwiOlwieHhcIixcImF2YXRhclVybFwiOlwieHhcIixcInNleFwiOjEsXG4gICAgLy8gXCJjYXJkTnVtYmVyXCI6MyxcIm9ubGluZVN0YXR1c1wiOjEsXCJpbnZpdGVDb2RlXCI6XCJcIixcImlwQWRkcmVzc1wiOlwiOjpmZmZmOjIyMi4yNDQuNjUuMjAxXCIsXG4gICAgLy8gXCJsYXN0TG9naW5UaW1lXCI6XCIyMDE3LTA0LTEzIDIyOjA5OjAxXCIsXCJjcmVhdGVBdFwiOlwiMjAxNy0wNC0xMSAyMjozOTozMFwiLFxuICAgIC8vIFwidXBkYXRlQXRcIjpcIjIwMTctMDQtMTMgMjI6MDk6MDFcIixcbiAgICAvLyBcImNhcmRzXCI6W10sXCJyb29tSWRcIjpcIjU5ODg4M1wiLFwicmVhZHlTdGF0dXNcIjp0cnVlLFwidG90YWxTY29yZVwiOjAsXG4gICAgLy8gXCJjU2NvcmVcIjowLFwiaXNCYW5rZXJcIjpmYWxzZX1cbiAgICB1cGRhdGVXaXRoUGxheWVySW5mbzogZnVuY3Rpb24gKHBsYXllckluZm8sIGlzUmFuZG9tUm9vbSA9IGZhbHNlKSB7XG4gICAgICBTcHJpdGVIZWxwZXIuc2V0SW1hZ2VVcmwodGhpcy5hdmF0YXJTcHJpdGUsIHBsYXllckluZm8uYXZhdGFyVXJsKTtcbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSBwbGF5ZXJJbmZvLm5pY2tuYW1lO1xuICAgICAgICAvL2NjLmxvZyh0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZylcbiAgICAgICAgLy9jYy5sb2cocGxheWVySW5mbylcbiAgICAgICAgLy9jYy5sb2cocGxheWVySW5mby5jU2NvcmUpXG4gICAgICAgIC8vY2MubG9nKCctLS0zNicpXG4gICAgICB0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZyA9IHBsYXllckluZm8uY1Njb3JlO1xuXG4gICAgICB0aGlzLnNjb3JlVW5pdE5vZGUuYWN0aXZlID0gIWlzUmFuZG9tUm9vbTtcbiAgICAgIHRoaXMuZGlhbW9uZFVuaXROb2RlLmFjdGl2ZSA9IGlzUmFuZG9tUm9vbTtcbiAgICAgIHZhciBOdW1iZXIgPSBwbGF5ZXJJbmZvLmNTY29yZTtcbiAgICAgIGlmIChpc1JhbmRvbVJvb20pIHtcbiAgICAgICAgLy8g5aaC5p6c5piv6ZqP5py65Zy655qE6K+d77yM5YiZ5pi+56S66ZK755+z5pWw6YePXG4gICAgICAgICAgTnVtYmVyID0gcGxheWVySW5mby5jU2NvcmUgKiA1O1xuICAgICAgfVxuICAgICAgICB0aGlzLmxhYmVsUmVzdWx0TnVtYmVyLnN0cmluZyA9IE51bWJlcjtcbiAgICB9LFxuXG4gICAgc2V0Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgY2MuYXNzZXJ0KGNhcmRzLmxlbmd0aCA9PSAxMyk7XG5cbiAgICAgIC8vIOS4jeS8muWGjeacieeJueauiueJjOS6hlxuICAgICAgIC8qaWYgKEtRQ2FyZC5pc1RlU2h1UGFpKGNhcmRzKSkge1xuICAgICAgICAgdGhpcy5zZXRUZVNodUNhcmRzKGNhcmRzKTtcbiAgICAgICAgIHJldHVybjtcbiAgICAgICAgIH1cbiAgICAgICovXG5cbiAgICAgIC8vbGV0IHRvdUNhcmRzID0gY2FyZHMuc2xpY2UoMCwgMyk7XG4gICAgICAvL2xldCB6aG9uZ0NhcmRzID0gY2FyZHMuc2xpY2UoMywgMyArIDUpO1xuICAgICAgLy9sZXQgd2VpQ2FyZHMgPSBjYXJkcy5zbGljZSg4KTtcbiAgICAgIC8vdGhpcy5zZXRUb3VDYXJkcyh0b3VDYXJkcyk7XG4gICAgICAvL3RoaXMuc2V0WmhvbmdDYXJkcyh6aG9uZ0NhcmRzKTtcbiAgICAgIC8vdGhpcy5zZXRXZWlDYXJkcyh3ZWlDYXJkcyk7XG4gICAgfSxcblxuICAgIC8qc2V0VG91Q2FyZHM6IGZ1bmN0aW9uIChjYXJkcykge1xuICAgICAgdGhpcy5fc2V0Q2FyZHNUb0xheW91dCh0aGlzLmxheW91dFRvdURhbywgY2FyZHMpO1xuICAgIH0sXG5cbiAgICBzZXRaaG9uZ0NhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRaaG9uZ0RhbywgY2FyZHMpO1xuICAgIH0sXG5cblxuICAgIHNldFdlaUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMuX3NldENhcmRzVG9MYXlvdXQodGhpcy5sYXlvdXRXZWlEYW8sIGNhcmRzKTtcbiAgICB9LCovXG5cbiAgICAvL+e7k+eulyAg5bCG54m55q6K54mM5pS+5YWlTGF5b3V0XG4gICAgLypzZXRUZVNodUNhcmRzOiBmdW5jdGlvbiAoY2FyZHMpIHtcbiAgICAgIHRoaXMubGF5b3V0VGVTaHUubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgdGhpcy5sYXlvdXRUb3VEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMubGF5b3V0WmhvbmdEYW8ubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMubGF5b3V0V2VpRGFvLm5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLl9zZXRDYXJkc1RvTGF5b3V0KHRoaXMubGF5b3V0VGVTaHUsIGNhcmRzKTtcblxuICAgICAgbGV0IHR5cGVOYW1lID0gS1FDYXJkLmNhcmRzVHlwZU5hbWUoY2FyZHMpO1xuICAgICAgdGhpcy5sYWJlbFRlU2h1UGFpVGl0bGUuc3RyaW5nID0gdHlwZU5hbWU7XG4gICAgfSwqL1xuXG4gICAvL+e7k+eul+WwhueJjOaUvuWIsExheW91dOmHjOmdolxuICAgIC8qX3NldENhcmRzVG9MYXlvdXQ6IGZ1bmN0aW9uIChsYXlvdXQsIGNhcmRzKSB7XG4gICAgICBsZXQgbm9kZSA9IGxheW91dC5ub2RlO1xuICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChzcHJpdGVOb2RlLCBpbmRleCkge1xuICAgICAgICBsZXQgc3ByaXRlID0gc3ByaXRlTm9kZS5nZXRDb21wb25lbnQoJ2NjLlNwcml0ZScpO1xuICAgICAgICBsZXQgY2FyZCA9IGNhcmRzW2luZGV4XTtcbiAgICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgS1FDYXJkUmVzSGVscGVyLnNldENhcmRTcHJpdGVGcmFtZShzcHJpdGUsIGNhcmQuY2FyZE5hbWUoKSk7XG4gICAgICB9KTtcbiAgICB9LCovXG59KTtcbiIsImNvbnN0IE1hbmFnZXIgPSByZXF1aXJlKCdtYW5hZ2VyJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICBtdXNpY1NsaWRlcjpjYy5Ob2RlLFxuICAgICAgZWZmZWN0U2xpZGVyOmNjLk5vZGUsXG4gICAgICBidG5Td2l0Y2hBY2NvdW50OiBjYy5CdXR0b24sXG5cbiAgICAgIF9hdWRpb01hbmFnZXI6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fYXVkaW9NYW5hZ2VyID0gY2MuZmluZCgnQXVkaW9NYW5hZ2VyJykgfHwge307XG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIgPSB0aGlzLl9hdWRpb01hbmFnZXIuZ2V0Q29tcG9uZW50KCdBdWRpb01hbmFnZXInKTtcblxuICAgICAgdGhpcy5faW5pdFNsaWRlcnMoKTtcbiAgICB9LFxuXG4gICAgX2luaXRTbGlkZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9pbml0U2xpZGVyRXZlbnRzKCk7XG5cbiAgICAgIGxldCBtdXNpY1ZhbCA9IE1hbmFnZXIuZ2V0TXVzaWNWYWx1ZSgpO1xuICAgICAgbGV0IGVmZmVjdFZhbCA9IE1hbmFnZXIuZ2V0TXVzaWNFZmZlY3RWYWx1ZSgpO1xuXG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0QmdNdXNpY1ZvbHVtbihtdXNpY1ZhbCk7XG4gICAgICB0aGlzLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bShlZmZlY3RWYWwpO1xuXG4gICAgICB0aGlzLm11c2ljU2xpZGVyLmdldENvbXBvbmVudCgnc2xpZGVyJykuc2V0VmFsdWUobXVzaWNWYWwpO1xuICAgICAgdGhpcy5lZmZlY3RTbGlkZXIuZ2V0Q29tcG9uZW50KCdzbGlkZXInKS5zZXRWYWx1ZShlZmZlY3RWYWwpO1xuICAgIH0sXG5cbiAgICBfaW5pdFNsaWRlckV2ZW50czogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5tdXNpY1NsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLm9uVmFsdWVDaGFuZ2UgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBNYW5hZ2VyLnNldE11c2ljVmFsdWUodmFsdWUpO1xuICAgICAgICBzZWxmLl9hdWRpb01hbmFnZXIuc2V0QmdNdXNpY1ZvbHVtbih2YWx1ZSk7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLmVmZmVjdFNsaWRlci5nZXRDb21wb25lbnQoJ3NsaWRlcicpLm9uVmFsdWVDaGFuZ2UgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBNYW5hZ2VyLnNldE11c2ljRWZmZWN0VmFsdWUodmFsdWUpO1xuICAgICAgICBzZWxmLl9hdWRpb01hbmFnZXIuc2V0RWZmZWN0TXVzaWNWb2x1bSh2YWx1ZSk7XG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjbGlja1N3aXRjaDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIGhpZGVTd2l0Y2g6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuYnRuU3dpdGNoQWNjb3VudCkge1xuICAgICAgICB0aGlzLmJ0blN3aXRjaEFjY291bnQubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxufSk7XG4iLCJsZXQgU3ByaXRlSGVscGVyID0ge1xuICBzZXRJbWFnZVVybDogZnVuY3Rpb24gKHNwcml0ZSwgdXJsKSB7XG4gICAgaWYgKHVybC5lbmRzV2l0aChcInBuZ1wiKSB8fCB1cmwuZW5kc1dpdGgoXCJqcGdcIikgfHwgdXJsLmVuZHNXaXRoKFwiZ2lmXCIpKSB7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgdXJsID0gdXJsICsgXCIucG5nXCI7XG4gICAgfVxuXG4gICAgY2MubG9hZGVyLmxvYWQodXJsLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKGRhdGEpO1xuICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gZnJhbWU7XG4gICAgfSk7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNwcml0ZUhlbHBlcjtcbiIsIi8vIOe7mSBTdHJpbmcg5re75Yqg5Yqf6IO9XG5cbi8vIHN0ci5zdGFydHNXaXRoKFwiXCIpO1xuLy8gc3RyLmVuZHNXaXRoKFwiXCIpO1xuXG5pZiAoIVN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aCkge1xuICAoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnOyAvLyBuZWVkZWQgdG8gc3VwcG9ydCBgYXBwbHlgL2BjYWxsYCB3aXRoIGB1bmRlZmluZWRgL2BudWxsYFxuICAgIHZhciBkZWZpbmVQcm9wZXJ0eSA9IChmdW5jdGlvbigpIHtcbiAgICAgIC8vIElFIDggb25seSBzdXBwb3J0cyBgT2JqZWN0LmRlZmluZVByb3BlcnR5YCBvbiBET00gZWxlbWVudHNcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciBvYmplY3QgPSB7fTtcbiAgICAgICAgdmFyICRkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbiAgICAgICAgdmFyIHJlc3VsdCA9ICRkZWZpbmVQcm9wZXJ0eShvYmplY3QsIG9iamVjdCwgb2JqZWN0KSAmJiAkZGVmaW5lUHJvcGVydHk7XG4gICAgICB9IGNhdGNoKGVycm9yKSB7fVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KCkpO1xuICAgIHZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuICAgIHZhciBzdGFydHNXaXRoID0gZnVuY3Rpb24oc2VhcmNoKSB7XG4gICAgICBpZiAodGhpcyA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IFR5cGVFcnJvcigpO1xuICAgICAgfVxuICAgICAgdmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTtcbiAgICAgIGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG4gICAgICAgIHRocm93IFR5cGVFcnJvcigpO1xuICAgICAgfVxuICAgICAgdmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7XG4gICAgICB2YXIgc2VhcmNoU3RyaW5nID0gU3RyaW5nKHNlYXJjaCk7XG4gICAgICB2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcbiAgICAgIHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xuICAgICAgLy8gYFRvSW50ZWdlcmBcbiAgICAgIHZhciBwb3MgPSBwb3NpdGlvbiA/IE51bWJlcihwb3NpdGlvbikgOiAwO1xuICAgICAgaWYgKHBvcyAhPSBwb3MpIHsgLy8gYmV0dGVyIGBpc05hTmBcbiAgICAgICAgcG9zID0gMDtcbiAgICAgIH1cbiAgICAgIHZhciBzdGFydCA9IE1hdGgubWluKE1hdGgubWF4KHBvcywgMCksIHN0cmluZ0xlbmd0aCk7XG4gICAgICAvLyBBdm9pZCB0aGUgYGluZGV4T2ZgIGNhbGwgaWYgbm8gbWF0Y2ggaXMgcG9zc2libGVcbiAgICAgIGlmIChzZWFyY2hMZW5ndGggKyBzdGFydCA+IHN0cmluZ0xlbmd0aCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgaW5kZXggPSAtMTtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgc2VhcmNoTGVuZ3RoKSB7XG4gICAgICAgIGlmIChzdHJpbmcuY2hhckNvZGVBdChzdGFydCArIGluZGV4KSAhPSBzZWFyY2hTdHJpbmcuY2hhckNvZGVBdChpbmRleCkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgaWYgKGRlZmluZVByb3BlcnR5KSB7XG4gICAgICBkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnc3RhcnRzV2l0aCcsIHtcbiAgICAgICAgJ3ZhbHVlJzogc3RhcnRzV2l0aCxcbiAgICAgICAgJ2NvbmZpZ3VyYWJsZSc6IHRydWUsXG4gICAgICAgICd3cml0YWJsZSc6IHRydWVcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGggPSBzdGFydHNXaXRoO1xuICAgIH1cbiAgfSgpKTtcbn1cblxuLy8gc3RyLmVuZHNXaXRoKFwiXCIpO1xuaWYgKCFTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoKSB7XG5cdChmdW5jdGlvbigpIHtcblx0XHQndXNlIHN0cmljdCc7IC8vIG5lZWRlZCB0byBzdXBwb3J0IGBhcHBseWAvYGNhbGxgIHdpdGggYHVuZGVmaW5lZGAvYG51bGxgXG5cdFx0dmFyIGRlZmluZVByb3BlcnR5ID0gKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gSUUgOCBvbmx5IHN1cHBvcnRzIGBPYmplY3QuZGVmaW5lUHJvcGVydHlgIG9uIERPTSBlbGVtZW50c1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dmFyIG9iamVjdCA9IHt9O1xuXHRcdFx0XHR2YXIgJGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXHRcdFx0XHR2YXIgcmVzdWx0ID0gJGRlZmluZVByb3BlcnR5KG9iamVjdCwgb2JqZWN0LCBvYmplY3QpICYmICRkZWZpbmVQcm9wZXJ0eTtcblx0XHRcdH0gY2F0Y2goZXJyb3IpIHt9XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH0oKSk7XG5cdFx0dmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cdFx0dmFyIGVuZHNXaXRoID0gZnVuY3Rpb24oc2VhcmNoKSB7XG5cdFx0XHRpZiAodGhpcyA9PSBudWxsKSB7XG5cdFx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTtcblx0XHRcdGlmIChzZWFyY2ggJiYgdG9TdHJpbmcuY2FsbChzZWFyY2gpID09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG5cdFx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHN0cmluZ0xlbmd0aCA9IHN0cmluZy5sZW5ndGg7XG5cdFx0XHR2YXIgc2VhcmNoU3RyaW5nID0gU3RyaW5nKHNlYXJjaCk7XG5cdFx0XHR2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyaW5nLmxlbmd0aDtcblx0XHRcdHZhciBwb3MgPSBzdHJpbmdMZW5ndGg7XG5cdFx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0dmFyIHBvc2l0aW9uID0gYXJndW1lbnRzWzFdO1xuXHRcdFx0XHRpZiAocG9zaXRpb24gIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdC8vIGBUb0ludGVnZXJgXG5cdFx0XHRcdFx0cG9zID0gcG9zaXRpb24gPyBOdW1iZXIocG9zaXRpb24pIDogMDtcblx0XHRcdFx0XHRpZiAocG9zICE9IHBvcykgeyAvLyBiZXR0ZXIgYGlzTmFOYFxuXHRcdFx0XHRcdFx0cG9zID0gMDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHZhciBlbmQgPSBNYXRoLm1pbihNYXRoLm1heChwb3MsIDApLCBzdHJpbmdMZW5ndGgpO1xuXHRcdFx0dmFyIHN0YXJ0ID0gZW5kIC0gc2VhcmNoTGVuZ3RoO1xuXHRcdFx0aWYgKHN0YXJ0IDwgMCkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR2YXIgaW5kZXggPSAtMTtcblx0XHRcdHdoaWxlICgrK2luZGV4IDwgc2VhcmNoTGVuZ3RoKSB7XG5cdFx0XHRcdGlmIChzdHJpbmcuY2hhckNvZGVBdChzdGFydCArIGluZGV4KSAhPSBzZWFyY2hTdHJpbmcuY2hhckNvZGVBdChpbmRleCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH07XG5cdFx0aWYgKGRlZmluZVByb3BlcnR5KSB7XG5cdFx0XHRkZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAnZW5kc1dpdGgnLCB7XG5cdFx0XHRcdCd2YWx1ZSc6IGVuZHNXaXRoLFxuXHRcdFx0XHQnY29uZmlndXJhYmxlJzogdHJ1ZSxcblx0XHRcdFx0J3dyaXRhYmxlJzogdHJ1ZVxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdFN0cmluZy5wcm90b3R5cGUuZW5kc1dpdGggPSBlbmRzV2l0aDtcblx0XHR9XG5cdH0oKSk7XG59XG4iLCJjb25zdCBTcHJpdGVIZWxwZXIgPSByZXF1aXJlKCdTcHJpdGVIZWxwZXInKTtcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICBsYWJlbFVzZXJJZDogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsU2NvcmU6IGNjLkxhYmVsLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcblxuICAgICAgICBfZGVza0luZm86IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldFVzZXJJbmZvOiBmdW5jdGlvbiAodXNlciwgZGVza0luZm8pIHtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciB0b3RhbFNjb3JlID0gdXNlci50b3RhbFNjb3JlO1xuICAgICAgaWYgKGRlc2tJbmZvICYmICgoZGVza0luZm8uc2V0dGluZzEgPT0gMCkgfHwgKGRlc2tJbmZvLnNldHRpbmcxID09IDEpKSkge1xuICAgICAgICBsZXQgYmFzZVNjb3JlID0gKGRlc2tJbmZvLnNldHRpbmcxID09IDApID8gMTAwIDogMjAwO1xuICAgICAgICB0b3RhbFNjb3JlID0gdG90YWxTY29yZSAtIGJhc2VTY29yZTtcbiAgICAgIH1cblxuICAgICAgU3ByaXRlSGVscGVyLnNldEltYWdlVXJsKHRoaXMuYXZhdGFyU3ByaXRlLCB1c2VyLmF2YXRhclVybCk7XG4gICAgICB0aGlzLmxhYmVsVXNlcklkLnN0cmluZyA9IFwiXCIgKyB1c2VyLmlkO1xuICAgICAgdGhpcy5sYWJlbFNjb3JlLnN0cmluZyA9ICh0b3RhbFNjb3JlID4gMCkgPyAoXCIrIFwiICsgdG90YWxTY29yZSkgOiAoXCItIFwiICsgdG90YWxTY29yZSAqIC0xKTtcbiAgICAgIGlmICh0b3RhbFNjb3JlID09IDApIHtcbiAgICAgICAgdGhpcy5sYWJlbFNjb3JlLnN0cmluZyA9IFwiMFwiO1xuICAgICAgfVxuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IHVzZXIubmlja25hbWU7XG4gICAgfSxcbn0pO1xuIiwiY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgaXRlbUxheW91dDogY2MuTGF5b3V0LFxuICAgICAgICBpdGVtUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIH0sXG5cbiAgICBzZXRQbGF5ZXJJbmZvczogZnVuY3Rpb24gKHBsYXllckluZm9zLCBkZXNrSW5mbykge1xuICAgICAgICB0aGlzLml0ZW1MYXlvdXQubm9kZS5yZW1vdmVBbGxDaGlsZHJlbigpO1xuICAgICAgcGxheWVySW5mb3MuZm9yRWFjaChmdW5jdGlvbiAodXNlcikge1xuICAgICAgICBsZXQgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuaXRlbVByZWZhYik7XG4gICAgICAgIGl0ZW0uZ2V0Q29tcG9uZW50KCdUb3RhbEdhbWVSZXN1bHRJdGVtJykuc2V0VXNlckluZm8odXNlciwgZGVza0luZm8pO1xuICAgICAgICAgIGlmKGRlc2tJbmZvLmNyZWF0ZUlkID09IHVzZXIuaWQpe1xuICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuWzZdLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgIGl0ZW0uY2hpbGRyZW5bNl0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB0aGlzLml0ZW1MYXlvdXQubm9kZS5hZGRDaGlsZChpdGVtKTtcbiAgICAgIH0uYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIGNsaWNrU2hhcmVXZWlDaGF0OiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTY3JlZW5TaGFyZUZyaWVuZFwiLCk7XG4gICAgICB9XG4gICAgICBlbHNlIHsvL0FuZHJvaWRcbiAgICAgICAgICBLUU5hdGl2ZUludm9rZS5zY3JlZW5zaG90U2hhcmUoKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tTaGFyZVBlbmdZb3VRdWFuOiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTY3JlZW5TaGFyZVwiLCk7XG4gICAgICB9XG4gICAgICBlbHNlIHsvL0FuZHJvaWRcbiAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTY3JlZW5TaGFyZVwiLCBcIigpVlwiKTtcbiAgICAgIH1cbiAgICB9LFxufSk7XG4iLCJjb25zdCBVc2VyTW9kZWxIZWxwZXIgPSB7XG4gIC8vIOeUqOaIt+aYr+WQpuW3suWHuueJjFxuICBpc1BsYXllZENhcmRzOiBmdW5jdGlvbiAodXNlcikge1xuICAgIGNjLmFzc2VydCh1c2VyKTtcblxuICAgIGlmICh1c2VyICYmIHVzZXIuY2FyZEluZm8gJiYgdXNlci5jYXJkSW5mby5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgLy8g55So5oi35piv5ZCm5bey5YeG5aSHXG4gIGlzVXNlclJlYWR5OiBmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiB1c2VyLnJlYWR5U3RhdHVzID09IHRydWU7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFVzZXJNb2RlbEhlbHBlcjtcbiIsImNvbnN0IFNwcml0ZUhlbHBlciA9IHJlcXVpcmUoJ1Nwcml0ZUhlbHBlcicpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYWJlbFVzZXJJZDogY2MuTGFiZWwsXG4gICAgICAgIGxhYmVsVXNlcklQOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxOaWNrbmFtZTogY2MuTGFiZWwsXG4gICAgICAgIGF2YXRhclNwcml0ZTogY2MuU3ByaXRlLFxuICAgICAgICBtYW5TcHJpdGU6IGNjLlNwcml0ZSxcbiAgICAgICAgd29tZW5TcHJpdGU6IGNjLlNwcml0ZSxcblxuICAgICAgICBfZGlkU2hvd1VzZXJJbmZvOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICB1cGRhdGVXaXRoVXNlcjogZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9kaWRTaG93VXNlckluZm8gPT0gdXNlcikge1xuICAgICAgICB0aGlzLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcbiAgICAgICAgdGhpcy5fZGlzYXBwZWFyVXNlckluZm8oKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9kaWRTaG93VXNlckluZm8gPSB1c2VyO1xuICAgICAgaWYgKCF0aGlzLm5vZGUuYWN0aXZlKSB7XG4gICAgICAgIHRoaXMubm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2Rpc2FwcGVhclVzZXJJbmZvKCk7XG4gICAgICB9LmJpbmQodGhpcyksIDUpO1xuXG4gICAgICB0aGlzLmxhYmVsVXNlcklkLnN0cmluZyA9XCJVSUQ6XFxuXCIrdXNlci5pZDtcbiAgICAgIHRoaXMubGFiZWxVc2VySVAuc3RyaW5nID1cIueUqOaIt0lQOlxcblwiK3VzZXIuaXBBZGRyZXNzLnJlcGxhY2UoXCI6OmZmZmY6XCIsIFwiXCIpO1xuICAgICAgdGhpcy5sYWJlbE5pY2tuYW1lLnN0cmluZyA9IHVzZXIubmlja25hbWU7XG4gICAgICB0aGlzLmF2YXRhclNwcml0ZS5zcHJpdGVGcmFtZSA9IG51bGw7XG4gICAgICBTcHJpdGVIZWxwZXIuc2V0SW1hZ2VVcmwodGhpcy5hdmF0YXJTcHJpdGUsIHVzZXIuYXZhdGFyVXJsKTtcblxuICAgICAgbGV0IHNleCA9IHVzZXIuc2V4OyAgLy8gc2V4OiAxIOeUtyAgMiDlpbNcbiAgICAgIHRoaXMubWFuU3ByaXRlLm5vZGUuYWN0aXZlID0gKHNleCA9PSAxKTtcbiAgICAgIHRoaXMud29tZW5TcHJpdGUubm9kZS5hY3RpdmUgPSAoc2V4ICE9IDEpO1xuICAgIH0sXG5cbiAgICBfZGlzYXBwZWFyVXNlckluZm86IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2RpZFNob3dVc2VySW5mbyA9IG51bGw7XG4gICAgfSxcbn0pO1xuIiwiY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XHJcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XHJcbmNvbnN0IEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIgPSByZXF1aXJlKCdLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyJyk7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgLy8gZm9vOiB7XHJcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICB0byBhIG5vZGUgZm9yIHRoZSBmaXJzdCB0aW1lXHJcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxyXG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIHZpc2libGU6IHRydWUsICAgICAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxyXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcclxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICAgICAgLy8gfSxcclxuICAgICAgICAvLyAuLi5cclxuICAgICAgICBhZ3JlZW1lbnQ6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTGFiZWxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVIYWxsSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZUhhbGxJbmZvLCB0aGlzKTtcclxuICAgICAgICBjYy5sb2coJy0tLS02MScpXHJcbiAgICAgICAgIGNjLmxvZyh0aGlzLmFncmVlbWVudClcclxuICAgIH0sXHJcbiAgICBfc29ja2V0UmVjZWl2ZUhhbGxJbmZvOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzID0gY2MuZmluZCgnQ2FudmFzL2FncmVlbWVudCcpO1xyXG4gICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAvL3RoaXMuX2luZm8xID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICBjYy5sb2codGhpcy5hZ3JlZW1lbnQpXHJcbiAgICAgICAgY2MubG9nKHMpXHJcbiAgICAgICAgY2MubG9nKCctLS0tNjEnKVxyXG4gICAgICAgIHRoaXMuYWdyZWVtZW50LnN0cmluZyA9IGRhdGEuaW5mbzEgfHwgXCJcIjtcclxuICAgIH0sXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwidmFyIEF1ZGlvTWFuYWdlciA9IHJlcXVpcmUoJ0F1ZGlvTWFuYWdlcicpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgcG9wTm9kZTpjYy5Ob2RlLFxuICAgICAgICBsYWJlbDpjYy5MYWJlbCxcblxuICAgICAgICBfYWxlcnRDYWxsYmFjazogbnVsbCxcbiAgICAgICAgX3dpbGxEaXNtaXNzQ2FsbGJhY2s6IG51bGwsXG4gICAgICAgIF9kaXNtaXNzQ2FsbGJhY2s6IG51bGwsXG4gICAgICAgIF9jb25maXJtQ2FsbGJhY2s6IG51bGwsICAgLy8g54K55Ye756Gu5a6a5ZCO55qE5Zue6LCDXG4gICAgICAgIF90aXNoaTpudWxsLFxuICAgICAgICBfY2FyZF9udW06bnVsbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICBcbiAgICB9LFxuXG4gICAgYWxlcnQ6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB2YXIgYW5pbSA9IHRoaXMucG9wTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgYW5pbS5wbGF5KCdwb3AnKTtcblxuICAgICAgICBpZiAodGhpcy5fYWxlcnRDYWxsYmFjaykge1xuICAgICAgICAgIHRoaXMuX2FsZXJ0Q2FsbGJhY2sodGhpcy5ub2RlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLyojIyMjI+W8ueWHuue7k+aenCovXG4gICAgYWxlcnRSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHZhciBhbmltID0gdGhpcy5wb3BOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICBhbmltLnBsYXkoJ3BvcCcpO1xuXG4gICAgICAgIGlmICh0aGlzLl9hbGVydENhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5fYWxlcnRDYWxsYmFjayh0aGlzLm5vZGUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vnoa7lrpoqL1xuICAgIHBsYXlCdG5DbGlja1NGWDpmdW5jdGlvbigpIHtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlCdG5DbGlja1NGWCgpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj54K55Ye75Y+W5raIKi9cbiAgICBwYWx5QnRuQ2FuY2VsQ2xpY2tTRlg6ZnVuY3Rpb24oKXtcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhbHlCdG5DYW5jZWxDbGlja1NGWCgpO1xuICAgIH0sXG5cbiAgICAvKiMjIyMj54K55Ye75YWz6Zet5oiW6ICF5oyJ6ZSu5LmL57G755qE5oyJ6ZKu77yM5pKt5pS+6Z+z5pWIKi9cbiAgICBwYWx5QnRuUHVibGljU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5QnRuUHVibGljU0ZYKCk7XG4gICAgfSxcblxuICAgIC8qIyMjIyPngrnlh7vliJvlu7rmiL/pl7TvvIzmkq3mlL7pn7PmlYgqL1xuICAgIHBhbHlCdG5DcmVhdGVSb29tU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5QnRuQ3JlYXRlUm9vbVNGWCgpO1xuICAgIH0sXG4gICAgLyojIyMjI+eCueWHu+WIm+W7uuaIv+mXtO+8jOaSreaUvumfs+aViCovXG4gICAgcGFseVdpbmRvd1NGWDogZnVuY3Rpb24gKCkge1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGFseVdpbmRvd1NGWCgpO1xuICAgIH0sXG5cbiAgICBwYWx5V2VpWGluTG9naW5TRlg6ZnVuY3Rpb24oKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5V2VpWGluTG9naW5TRlgoKTtcbiAgICB9LFxuICAgIHBhbHlGYW5nUGFpU0ZYOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wYWx5RmFuZ1BhaVNGWCgpO1xuICAgIH0sXG5cbiAgICBkaXNtaXNzQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgbGV0IHdpbGxEaXNtaXNzQ2FsbGJhY2sgPSB0aGlzLl93aWxsRGlzbWlzc0NhbGxiYWNrO1xuICAgICAgaWYgKHdpbGxEaXNtaXNzQ2FsbGJhY2spIHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IHdpbGxEaXNtaXNzQ2FsbGJhY2soKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIHRoaXMuZGlzbWlzc0NvbXBsZXRlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBvcE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICAgIHZhciBkaXNtaXNzQW5pbSA9IGFuaW0uZ2V0QW5pbWF0aW9uU3RhdGUoJ3BvcF9kaXNtaXNzJyk7XG4gICAgICAgIGRpc21pc3NBbmltLm9uKCdmaW5pc2hlZCcsdGhpcy5kaXNtaXNzQ29tcGxldGUsdGhpcyk7XG4gICAgICAgIGFuaW0ucGxheSgncG9wX2Rpc21pc3MnKTtcbiAgICB9LFxuXG4gICAgLyojIyMjI+makOiXj+e7k+aenOmhtemdoiovXG4gICAgZGlzbWlzc0FjdGlvblJlc3VsdDpmdW5jdGlvbigpIHtcbiAgICAgIGxldCB3aWxsRGlzbWlzc0NhbGxiYWNrID0gdGhpcy5fd2lsbERpc21pc3NDYWxsYmFjaztcbiAgICAgIGlmICh3aWxsRGlzbWlzc0NhbGxiYWNrKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSB3aWxsRGlzbWlzc0NhbGxiYWNrKCk7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICB0aGlzLmRpc21pc3NDb21wbGV0ZSgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAgIHZhciBhbmltID0gdGhpcy5wb3BOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICB2YXIgZGlzbWlzc0FuaW0gPSBhbmltLmdldEFuaW1hdGlvblN0YXRlKCdwb3BfZGlzbWlzcycpO1xuICAgICAgICBkaXNtaXNzQW5pbS5vbignZmluaXNoZWQnLHRoaXMuZGlzbWlzc0NvbXBsZXRlLHRoaXMpO1xuICAgICAgICBhbmltLnBsYXkoJ3BvcF9kaXNtaXNzJyk7XG4gICAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgZGlzbWlzc0NvbXBsZXRlOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHRoaXMub25EaXNtaXNzQ29tcGxldGUpIHtcbiAgICAgICAgICB0aGlzLm9uRGlzbWlzc0NvbXBsZXRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fZGlzbWlzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5fZGlzbWlzc0NhbGxiYWNrKHRoaXMubm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGRpc21pc3NQbGF5OmZ1bmN0aW9uKCkge1xuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiaGFsbFwiKTsgIFxuICAgIH0sXG5cbiAgICBvbkRpc21pc3NDb21wbGV0ZTpmdW5jdGlvbigpIHtcbiAgICAgIGNjLmxvZyhcIm9uRGlzbWlzc0NvbXBsZXRlXCIpO1xuICAgIH0sXG5cbiAgICBkb25lQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgdGhpcy5vbkRvbmVBY3Rpb24oKTtcblxuICAgICAgICBsZXQgY29uZmlybUNhbGxiYWNrID0gdGhpcy5fY29uZmlybUNhbGxiYWNrO1xuICAgICAgICBpZiAoY29uZmlybUNhbGxiYWNrKSB7XG4gICAgICAgICAgY29uZmlybUNhbGxiYWNrKHRoaXMubm9kZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25Eb25lQWN0aW9uOmZ1bmN0aW9uKCkge1xuXG4gICAgfSxcblxuICAgIHNldE1lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIHRoaXMubGFiZWwuc3RyaW5nID0gbXNnO1xuICAgIH0sXG5cbiAgICBnZXRNZXNzYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5sYWJlbC5zdHJpbmc7XG4gICAgfSxcblxuICAgIHNldEFsZXJ0Q2FsbGJjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICB0aGlzLl9hbGVydENhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfSxcblxuICAgIHNldFdpbGxEaXNtaXNzQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5fd2lsbERpc21pc3NDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH0sXG5cbiAgICBzZXREaXNtaXNzQ2FsbGJhY2s6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5fZGlzbWlzc0NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfSxcblxuICAgIHNldENvbmZpcm1DYWxsYmFjazogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICB0aGlzLl9jb25maXJtQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9LFxuXG4gICAgLypzZXRNZXNzYWdlOiBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgdGhpcy5sYWJlbC5nZXRDb21wb25lbnQoJ2NjLkxhYmVsJykuc3RyaW5nID0gbWVzc2FnZTtcbiAgICB9LCovXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCIvLyDniYzog4zlvbHliJfooaggY29tcG9uZW50XG4vLyDlj6/ku6XmmL7npLrjgIHpmpDol4/niYzog4zlvbHliJfooahcbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGNhcmRzQmFja0xheW91dDogY2MuTGF5b3V0LFxuICAgICAgICBjYXJkc0JhY2tMaXN0OiBbY2MuU3ByaXRlXSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgLy8g5Lul5Yqo55S755qE5pa55byP5pi+56S654mM6IOM5b2xXG4gICAgc2hvd1BsYXlDYXJkQmFja3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNjLmxvZyhcIuaYvuekuueJjOiDjOW9sVwiKTtcbiAgICAgIHRoaXMuaGlkZUNhcmRCYWNrcygpO1xuICAgICAgdGhpcy5jYXJkc0JhY2tMYXlvdXQubm9kZS5hY3RpdmUgPSB0cnVlO1xuXG4gICAgICBsZXQgaW50ZXJ2YWwgPSAwLjA1O1xuICAgICAgdmFyIHN0YXJ0VGltZSA9IDA7XG4gICAgICB0aGlzLmNhcmRzQmFja0xpc3QuZm9yRWFjaChmdW5jdGlvbihjYXJkQmFjayl7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNhcmRCYWNrLm5vZGUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfSwgc3RhcnRUaW1lKTtcbiAgICAgICAgc3RhcnRUaW1lID0gc3RhcnRUaW1lICsgaW50ZXJ2YWw7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICAvLyDpmpDol4/mmL7npLrniYzog4zlvbFcbiAgICBoaWRlQ2FyZEJhY2tzOiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNhcmRzQmFja0xheW91dC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5jYXJkc0JhY2tMaXN0LmZvckVhY2goZnVuY3Rpb24oY2FyZEJhY2spe1xuICAgICAgICBjYXJkQmFjay5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgLyrniYzoirHoibIqL1xuICAgICAgICBzcGFkZXNJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcbiAgICAgICAgaGVhcnRzSW1hZ2VzOltjYy5TcHJpdGVGcmFtZV0sXG4gICAgICAgIGNsdWJJbWFnZXM6W2NjLlNwcml0ZUZyYW1lXSxcbiAgICAgICAgZGlhbW9uZEltYWdlczpbY2MuU3ByaXRlRnJhbWVdLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgICAgICBsYWJlbE1zZzpjYy5MYWJlbCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9LFxuXG4gICAgc2V0VGV4dDpmdW5jdGlvbih0ZXh0KSB7XG4gICAgICAgIHRoaXMubGFiZWxNc2cuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0ZXh0O1xuICAgIH0sXG5cbiAgICBjbGlja0FjdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gdGhpcy5sYWJlbE1zZy5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZztcbiAgICAgICAgdGhpcy5vblNlbGVjdEFjdGlvbih0ZXh0KTtcbiAgICB9LFxuXG4gICAgb25TZWxlY3RBY3Rpb246ZnVuY3Rpb24obXNnKSB7XG5cbiAgICB9LFxuXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuXG4gICAgLy8gfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBzZWxlY3RlZEluZGV4IDogMCxcclxuICAgICAgICBzZWxlY3RlZE5vZGUgOiBjYy5Ob2RlICBcclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgY2xpY2tBY3Rpb246ZnVuY3Rpb24oZSxkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9ICF0aGlzLnNlbGVjdGVkO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gdGhpcy5zZWxlY3RlZD8wOm51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsInZhciBzb2NrZXQgPSByZXF1aXJlKFwic29ja2V0XCIpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIG9wdGlvbjp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6W10sXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgY2xpY2tCdG5jaG91amlhbmc6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLm9wdGlvbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdGhpcy5vcHRpb25baV0ub3BhY2l0eSA9IDI1NTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgICB0aGlzLl90aXNoaSA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImNob3VqaWFuZ19iZ1wiKS5nZXRDaGlsZEJ5TmFtZShcInRpc2hpXCIpO1xyXG4gICAgICAgIHRoaXMuX2NhcmRfbnVtID0gY2MuZmluZChcIkNhbnZhcy91c2VyL3Nob3BfYmcvY2FyZF9udW1cIik7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLl9jYXJkX251bS5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgaWYoaW5kZXggPT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25baW5kZXhdLm9wYWNpdHkgPSAxMjg7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcHRpb25bdGhpcy5vcHRpb24ubGVuZ3RoLTFdLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZihpbmRleCA9PSAxKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleF0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleCAtIDFdLm9wYWNpdHkgPSAyNTU7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleF0ub3BhY2l0eSA9IDEyODtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpbmRleC0xXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaW5kZXggKys7XHJcbiAgICAgICAgICAgICAgICBpZihpbmRleCA9PSB0aGlzLm9wdGlvbi5sZW5ndGgpe1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBpZihjb21wLnN0cmluZyA8IDIwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Rpc2hpLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8vY2hvdWppYW5nXHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy5jYWxsYmFjaywwLjA1KTtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLm9wdGlvbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpXS5vcGFjaXR5ID0gMjU1O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbltpXS5vcGFjaXR5ID0gMTI4O1xyXG4gICAgICAgICAgICB9LDMsMCwxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICAvLyoqKlxyXG4gICAgY2xpY2tCdG5Db21maXJtOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3Rpc2hpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vdGhpcy5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIC8vKioqKlxyXG5cclxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXHJcbiAgICAvLyB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xyXG5cclxuICAgIC8vIH0sXHJcbn0pO1xyXG4iLCIoZnVuY3Rpb24gKG1haW4pIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8qKlxuICAgKiBQYXJzZSBvciBmb3JtYXQgZGF0ZXNcbiAgICogQGNsYXNzIGZlY2hhXG4gICAqL1xuICB2YXIgZmVjaGEgPSB7fTtcbiAgdmFyIHRva2VuID0gL2R7MSw0fXxNezEsNH18WVkoPzpZWSk/fFN7MSwzfXxEb3xaWnwoW0hoTXNEbV0pXFwxP3xbYUFdfFwiW15cIl0qXCJ8J1teJ10qJy9nO1xuICB2YXIgdHdvRGlnaXRzID0gL1xcZFxcZD8vO1xuICB2YXIgdGhyZWVEaWdpdHMgPSAvXFxkezN9LztcbiAgdmFyIGZvdXJEaWdpdHMgPSAvXFxkezR9LztcbiAgdmFyIHdvcmQgPSAvWzAtOV0qWydhLXpcXHUwMEEwLVxcdTA1RkZcXHUwNzAwLVxcdUQ3RkZcXHVGOTAwLVxcdUZEQ0ZcXHVGREYwLVxcdUZGRUZdK3xbXFx1MDYwMC1cXHUwNkZGXFwvXSsoXFxzKj9bXFx1MDYwMC1cXHUwNkZGXSspezEsMn0vaTtcbiAgdmFyIGxpdGVyYWwgPSAvXFxbKFteXSo/KVxcXS9nbTtcbiAgdmFyIG5vb3AgPSBmdW5jdGlvbiAoKSB7XG4gIH07XG5cbiAgZnVuY3Rpb24gc2hvcnRlbihhcnIsIHNMZW4pIHtcbiAgICB2YXIgbmV3QXJyID0gW107XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFyci5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgbmV3QXJyLnB1c2goYXJyW2ldLnN1YnN0cigwLCBzTGVuKSk7XG4gICAgfVxuICAgIHJldHVybiBuZXdBcnI7XG4gIH1cblxuICBmdW5jdGlvbiBtb250aFVwZGF0ZShhcnJOYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCB2LCBpMThuKSB7XG4gICAgICB2YXIgaW5kZXggPSBpMThuW2Fyck5hbWVdLmluZGV4T2Yodi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHYuc3Vic3RyKDEpLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgaWYgKH5pbmRleCkge1xuICAgICAgICBkLm1vbnRoID0gaW5kZXg7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhZCh2YWwsIGxlbikge1xuICAgIHZhbCA9IFN0cmluZyh2YWwpO1xuICAgIGxlbiA9IGxlbiB8fCAyO1xuICAgIHdoaWxlICh2YWwubGVuZ3RoIDwgbGVuKSB7XG4gICAgICB2YWwgPSAnMCcgKyB2YWw7XG4gICAgfVxuICAgIHJldHVybiB2YWw7XG4gIH1cblxuICB2YXIgZGF5TmFtZXMgPSBbJ1N1bmRheScsICdNb25kYXknLCAnVHVlc2RheScsICdXZWRuZXNkYXknLCAnVGh1cnNkYXknLCAnRnJpZGF5JywgJ1NhdHVyZGF5J107XG4gIHZhciBtb250aE5hbWVzID0gWydKYW51YXJ5JywgJ0ZlYnJ1YXJ5JywgJ01hcmNoJywgJ0FwcmlsJywgJ01heScsICdKdW5lJywgJ0p1bHknLCAnQXVndXN0JywgJ1NlcHRlbWJlcicsICdPY3RvYmVyJywgJ05vdmVtYmVyJywgJ0RlY2VtYmVyJ107XG4gIHZhciBtb250aE5hbWVzU2hvcnQgPSBzaG9ydGVuKG1vbnRoTmFtZXMsIDMpO1xuICB2YXIgZGF5TmFtZXNTaG9ydCA9IHNob3J0ZW4oZGF5TmFtZXMsIDMpO1xuICBmZWNoYS5pMThuID0ge1xuICAgIGRheU5hbWVzU2hvcnQ6IGRheU5hbWVzU2hvcnQsXG4gICAgZGF5TmFtZXM6IGRheU5hbWVzLFxuICAgIG1vbnRoTmFtZXNTaG9ydDogbW9udGhOYW1lc1Nob3J0LFxuICAgIG1vbnRoTmFtZXM6IG1vbnRoTmFtZXMsXG4gICAgYW1QbTogWydhbScsICdwbSddLFxuICAgIERvRm46IGZ1bmN0aW9uIERvRm4oRCkge1xuICAgICAgcmV0dXJuIEQgKyBbJ3RoJywgJ3N0JywgJ25kJywgJ3JkJ11bRCAlIDEwID4gMyA/IDAgOiAoRCAtIEQgJSAxMCAhPT0gMTApICogRCAlIDEwXTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGZvcm1hdEZsYWdzID0ge1xuICAgIEQ6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldERhdGUoKTtcbiAgICB9LFxuICAgIEREOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0RGF0ZSgpKTtcbiAgICB9LFxuICAgIERvOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5Eb0ZuKGRhdGVPYmouZ2V0RGF0ZSgpKTtcbiAgICB9LFxuICAgIGQ6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldERheSgpO1xuICAgIH0sXG4gICAgZGQ6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXREYXkoKSk7XG4gICAgfSxcbiAgICBkZGQ6IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBpMThuLmRheU5hbWVzU2hvcnRbZGF0ZU9iai5nZXREYXkoKV07XG4gICAgfSxcbiAgICBkZGRkOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gaTE4bi5kYXlOYW1lc1tkYXRlT2JqLmdldERheSgpXTtcbiAgICB9LFxuICAgIE06IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBkYXRlT2JqLmdldE1vbnRoKCkgKyAxO1xuICAgIH0sXG4gICAgTU06IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRNb250aCgpICsgMSk7XG4gICAgfSxcbiAgICBNTU06IGZ1bmN0aW9uKGRhdGVPYmosIGkxOG4pIHtcbiAgICAgIHJldHVybiBpMThuLm1vbnRoTmFtZXNTaG9ydFtkYXRlT2JqLmdldE1vbnRoKCldO1xuICAgIH0sXG4gICAgTU1NTTogZnVuY3Rpb24oZGF0ZU9iaiwgaTE4bikge1xuICAgICAgcmV0dXJuIGkxOG4ubW9udGhOYW1lc1tkYXRlT2JqLmdldE1vbnRoKCldO1xuICAgIH0sXG4gICAgWVk6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBTdHJpbmcoZGF0ZU9iai5nZXRGdWxsWWVhcigpKS5zdWJzdHIoMik7XG4gICAgfSxcbiAgICBZWVlZOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRGdWxsWWVhcigpO1xuICAgIH0sXG4gICAgaDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKSAlIDEyIHx8IDEyO1xuICAgIH0sXG4gICAgaGg6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRIb3VycygpICUgMTIgfHwgMTIpO1xuICAgIH0sXG4gICAgSDogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIGRhdGVPYmouZ2V0SG91cnMoKTtcbiAgICB9LFxuICAgIEhIOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKGRhdGVPYmouZ2V0SG91cnMoKSk7XG4gICAgfSxcbiAgICBtOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRNaW51dGVzKCk7XG4gICAgfSxcbiAgICBtbTogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldE1pbnV0ZXMoKSk7XG4gICAgfSxcbiAgICBzOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRTZWNvbmRzKCk7XG4gICAgfSxcbiAgICBzczogZnVuY3Rpb24oZGF0ZU9iaikge1xuICAgICAgcmV0dXJuIHBhZChkYXRlT2JqLmdldFNlY29uZHMoKSk7XG4gICAgfSxcbiAgICBTOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gTWF0aC5yb3VuZChkYXRlT2JqLmdldE1pbGxpc2Vjb25kcygpIC8gMTAwKTtcbiAgICB9LFxuICAgIFNTOiBmdW5jdGlvbihkYXRlT2JqKSB7XG4gICAgICByZXR1cm4gcGFkKE1hdGgucm91bmQoZGF0ZU9iai5nZXRNaWxsaXNlY29uZHMoKSAvIDEwKSwgMik7XG4gICAgfSxcbiAgICBTU1M6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHJldHVybiBwYWQoZGF0ZU9iai5nZXRNaWxsaXNlY29uZHMoKSwgMyk7XG4gICAgfSxcbiAgICBhOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRIb3VycygpIDwgMTIgPyBpMThuLmFtUG1bMF0gOiBpMThuLmFtUG1bMV07XG4gICAgfSxcbiAgICBBOiBmdW5jdGlvbihkYXRlT2JqLCBpMThuKSB7XG4gICAgICByZXR1cm4gZGF0ZU9iai5nZXRIb3VycygpIDwgMTIgPyBpMThuLmFtUG1bMF0udG9VcHBlckNhc2UoKSA6IGkxOG4uYW1QbVsxXS50b1VwcGVyQ2FzZSgpO1xuICAgIH0sXG4gICAgWlo6IGZ1bmN0aW9uKGRhdGVPYmopIHtcbiAgICAgIHZhciBvID0gZGF0ZU9iai5nZXRUaW1lem9uZU9mZnNldCgpO1xuICAgICAgcmV0dXJuIChvID4gMCA/ICctJyA6ICcrJykgKyBwYWQoTWF0aC5mbG9vcihNYXRoLmFicyhvKSAvIDYwKSAqIDEwMCArIE1hdGguYWJzKG8pICUgNjAsIDQpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgcGFyc2VGbGFncyA9IHtcbiAgICBEOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5kYXkgPSB2O1xuICAgIH1dLFxuICAgIERvOiBbbmV3IFJlZ0V4cCh0d29EaWdpdHMuc291cmNlICsgd29yZC5zb3VyY2UpLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5kYXkgPSBwYXJzZUludCh2LCAxMCk7XG4gICAgfV0sXG4gICAgTTogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubW9udGggPSB2IC0gMTtcbiAgICB9XSxcbiAgICBZWTogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIHZhciBkYSA9IG5ldyBEYXRlKCksIGNlbnQgPSArKCcnICsgZGEuZ2V0RnVsbFllYXIoKSkuc3Vic3RyKDAsIDIpO1xuICAgICAgZC55ZWFyID0gJycgKyAodiA+IDY4ID8gY2VudCAtIDEgOiBjZW50KSArIHY7XG4gICAgfV0sXG4gICAgaDogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQuaG91ciA9IHY7XG4gICAgfV0sXG4gICAgbTogW3R3b0RpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubWludXRlID0gdjtcbiAgICB9XSxcbiAgICBzOiBbdHdvRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5zZWNvbmQgPSB2O1xuICAgIH1dLFxuICAgIFlZWVk6IFtmb3VyRGlnaXRzLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC55ZWFyID0gdjtcbiAgICB9XSxcbiAgICBTOiBbL1xcZC8sIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBkLm1pbGxpc2Vjb25kID0gdiAqIDEwMDtcbiAgICB9XSxcbiAgICBTUzogWy9cXGR7Mn0vLCBmdW5jdGlvbiAoZCwgdikge1xuICAgICAgZC5taWxsaXNlY29uZCA9IHYgKiAxMDtcbiAgICB9XSxcbiAgICBTU1M6IFt0aHJlZURpZ2l0cywgZnVuY3Rpb24gKGQsIHYpIHtcbiAgICAgIGQubWlsbGlzZWNvbmQgPSB2O1xuICAgIH1dLFxuICAgIGQ6IFt0d29EaWdpdHMsIG5vb3BdLFxuICAgIGRkZDogW3dvcmQsIG5vb3BdLFxuICAgIE1NTTogW3dvcmQsIG1vbnRoVXBkYXRlKCdtb250aE5hbWVzU2hvcnQnKV0sXG4gICAgTU1NTTogW3dvcmQsIG1vbnRoVXBkYXRlKCdtb250aE5hbWVzJyldLFxuICAgIGE6IFt3b3JkLCBmdW5jdGlvbiAoZCwgdiwgaTE4bikge1xuICAgICAgdmFyIHZhbCA9IHYudG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmICh2YWwgPT09IGkxOG4uYW1QbVswXSkge1xuICAgICAgICBkLmlzUG0gPSBmYWxzZTtcbiAgICAgIH0gZWxzZSBpZiAodmFsID09PSBpMThuLmFtUG1bMV0pIHtcbiAgICAgICAgZC5pc1BtID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XSxcbiAgICBaWjogWy8oW1xcK1xcLV1cXGRcXGQ6P1xcZFxcZHxaKS8sIGZ1bmN0aW9uIChkLCB2KSB7XG4gICAgICBpZiAodiA9PT0gJ1onKSB2ID0gJyswMDowMCc7XG4gICAgICB2YXIgcGFydHMgPSAodiArICcnKS5tYXRjaCgvKFtcXCtcXC1dfFxcZFxcZCkvZ2kpLCBtaW51dGVzO1xuXG4gICAgICBpZiAocGFydHMpIHtcbiAgICAgICAgbWludXRlcyA9ICsocGFydHNbMV0gKiA2MCkgKyBwYXJzZUludChwYXJ0c1syXSwgMTApO1xuICAgICAgICBkLnRpbWV6b25lT2Zmc2V0ID0gcGFydHNbMF0gPT09ICcrJyA/IG1pbnV0ZXMgOiAtbWludXRlcztcbiAgICAgIH1cbiAgICB9XVxuICB9O1xuICBwYXJzZUZsYWdzLmRkID0gcGFyc2VGbGFncy5kO1xuICBwYXJzZUZsYWdzLmRkZGQgPSBwYXJzZUZsYWdzLmRkZDtcbiAgcGFyc2VGbGFncy5ERCA9IHBhcnNlRmxhZ3MuRDtcbiAgcGFyc2VGbGFncy5tbSA9IHBhcnNlRmxhZ3MubTtcbiAgcGFyc2VGbGFncy5oaCA9IHBhcnNlRmxhZ3MuSCA9IHBhcnNlRmxhZ3MuSEggPSBwYXJzZUZsYWdzLmg7XG4gIHBhcnNlRmxhZ3MuTU0gPSBwYXJzZUZsYWdzLk07XG4gIHBhcnNlRmxhZ3Muc3MgPSBwYXJzZUZsYWdzLnM7XG4gIHBhcnNlRmxhZ3MuQSA9IHBhcnNlRmxhZ3MuYTtcblxuXG4gIC8vIFNvbWUgY29tbW9uIGZvcm1hdCBzdHJpbmdzXG4gIGZlY2hhLm1hc2tzID0ge1xuICAgIGRlZmF1bHQ6ICdkZGQgTU1NIEREIFlZWVkgSEg6bW06c3MnLFxuICAgIHNob3J0RGF0ZTogJ00vRC9ZWScsXG4gICAgbWVkaXVtRGF0ZTogJ01NTSBELCBZWVlZJyxcbiAgICBsb25nRGF0ZTogJ01NTU0gRCwgWVlZWScsXG4gICAgZnVsbERhdGU6ICdkZGRkLCBNTU1NIEQsIFlZWVknLFxuICAgIHNob3J0VGltZTogJ0hIOm1tJyxcbiAgICBtZWRpdW1UaW1lOiAnSEg6bW06c3MnLFxuICAgIGxvbmdUaW1lOiAnSEg6bW06c3MuU1NTJ1xuICB9O1xuXG4gIC8qKipcbiAgICogRm9ybWF0IGEgZGF0ZVxuICAgKiBAbWV0aG9kIGZvcm1hdFxuICAgKiBAcGFyYW0ge0RhdGV8bnVtYmVyfSBkYXRlT2JqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtYXNrIEZvcm1hdCBvZiB0aGUgZGF0ZSwgaS5lLiAnbW0tZGQteXknIG9yICdzaG9ydERhdGUnXG4gICAqL1xuICBmZWNoYS5mb3JtYXQgPSBmdW5jdGlvbiAoZGF0ZU9iaiwgbWFzaywgaTE4blNldHRpbmdzKSB7XG4gICAgdmFyIGkxOG4gPSBpMThuU2V0dGluZ3MgfHwgZmVjaGEuaTE4bjtcblxuICAgIGlmICh0eXBlb2YgZGF0ZU9iaiA9PT0gJ251bWJlcicpIHtcbiAgICAgIGRhdGVPYmogPSBuZXcgRGF0ZShkYXRlT2JqKTtcbiAgICB9XG5cbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGRhdGVPYmopICE9PSAnW29iamVjdCBEYXRlXScgfHwgaXNOYU4oZGF0ZU9iai5nZXRUaW1lKCkpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgRGF0ZSBpbiBmZWNoYS5mb3JtYXQnKTtcbiAgICB9XG5cbiAgICBtYXNrID0gZmVjaGEubWFza3NbbWFza10gfHwgbWFzayB8fCBmZWNoYS5tYXNrc1snZGVmYXVsdCddO1xuXG4gICAgdmFyIGxpdGVyYWxzID0gW107XG5cbiAgICAvLyBNYWtlIGxpdGVyYWxzIGluYWN0aXZlIGJ5IHJlcGxhY2luZyB0aGVtIHdpdGggPz9cbiAgICBtYXNrID0gbWFzay5yZXBsYWNlKGxpdGVyYWwsIGZ1bmN0aW9uKCQwLCAkMSkge1xuICAgICAgbGl0ZXJhbHMucHVzaCgkMSk7XG4gICAgICByZXR1cm4gJz8/JztcbiAgICB9KTtcbiAgICAvLyBBcHBseSBmb3JtYXR0aW5nIHJ1bGVzXG4gICAgbWFzayA9IG1hc2sucmVwbGFjZSh0b2tlbiwgZnVuY3Rpb24gKCQwKSB7XG4gICAgICByZXR1cm4gJDAgaW4gZm9ybWF0RmxhZ3MgPyBmb3JtYXRGbGFnc1skMF0oZGF0ZU9iaiwgaTE4bikgOiAkMC5zbGljZSgxLCAkMC5sZW5ndGggLSAxKTtcbiAgICB9KTtcbiAgICAvLyBJbmxpbmUgbGl0ZXJhbCB2YWx1ZXMgYmFjayBpbnRvIHRoZSBmb3JtYXR0ZWQgdmFsdWVcbiAgICByZXR1cm4gbWFzay5yZXBsYWNlKC9cXD9cXD8vZywgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbGl0ZXJhbHMuc2hpZnQoKTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2UgYSBkYXRlIHN0cmluZyBpbnRvIGFuIG9iamVjdCwgY2hhbmdlcyAtIGludG8gL1xuICAgKiBAbWV0aG9kIHBhcnNlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRlU3RyIERhdGUgc3RyaW5nXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmb3JtYXQgRGF0ZSBwYXJzZSBmb3JtYXRcbiAgICogQHJldHVybnMge0RhdGV8Ym9vbGVhbn1cbiAgICovXG4gIGZlY2hhLnBhcnNlID0gZnVuY3Rpb24gKGRhdGVTdHIsIGZvcm1hdCwgaTE4blNldHRpbmdzKSB7XG4gICAgdmFyIGkxOG4gPSBpMThuU2V0dGluZ3MgfHwgZmVjaGEuaTE4bjtcblxuICAgIGlmICh0eXBlb2YgZm9ybWF0ICE9PSAnc3RyaW5nJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGZvcm1hdCBpbiBmZWNoYS5wYXJzZScpO1xuICAgIH1cblxuICAgIGZvcm1hdCA9IGZlY2hhLm1hc2tzW2Zvcm1hdF0gfHwgZm9ybWF0O1xuXG4gICAgLy8gQXZvaWQgcmVndWxhciBleHByZXNzaW9uIGRlbmlhbCBvZiBzZXJ2aWNlLCBmYWlsIGVhcmx5IGZvciByZWFsbHkgbG9uZyBzdHJpbmdzXG4gICAgLy8gaHR0cHM6Ly93d3cub3dhc3Aub3JnL2luZGV4LnBocC9SZWd1bGFyX2V4cHJlc3Npb25fRGVuaWFsX29mX1NlcnZpY2VfLV9SZURvU1xuICAgIGlmIChkYXRlU3RyLmxlbmd0aCA+IDEwMDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgaXNWYWxpZCA9IHRydWU7XG4gICAgdmFyIGRhdGVJbmZvID0ge307XG4gICAgZm9ybWF0LnJlcGxhY2UodG9rZW4sIGZ1bmN0aW9uICgkMCkge1xuICAgICAgaWYgKHBhcnNlRmxhZ3NbJDBdKSB7XG4gICAgICAgIHZhciBpbmZvID0gcGFyc2VGbGFnc1skMF07XG4gICAgICAgIHZhciBpbmRleCA9IGRhdGVTdHIuc2VhcmNoKGluZm9bMF0pO1xuICAgICAgICBpZiAoIX5pbmRleCkge1xuICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkYXRlU3RyLnJlcGxhY2UoaW5mb1swXSwgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgaW5mb1sxXShkYXRlSW5mbywgcmVzdWx0LCBpMThuKTtcbiAgICAgICAgICAgIGRhdGVTdHIgPSBkYXRlU3RyLnN1YnN0cihpbmRleCArIHJlc3VsdC5sZW5ndGgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcGFyc2VGbGFnc1skMF0gPyAnJyA6ICQwLnNsaWNlKDEsICQwLmxlbmd0aCAtIDEpO1xuICAgIH0pO1xuXG4gICAgaWYgKCFpc1ZhbGlkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICBpZiAoZGF0ZUluZm8uaXNQbSA9PT0gdHJ1ZSAmJiBkYXRlSW5mby5ob3VyICE9IG51bGwgJiYgK2RhdGVJbmZvLmhvdXIgIT09IDEyKSB7XG4gICAgICBkYXRlSW5mby5ob3VyID0gK2RhdGVJbmZvLmhvdXIgKyAxMjtcbiAgICB9IGVsc2UgaWYgKGRhdGVJbmZvLmlzUG0gPT09IGZhbHNlICYmICtkYXRlSW5mby5ob3VyID09PSAxMikge1xuICAgICAgZGF0ZUluZm8uaG91ciA9IDA7XG4gICAgfVxuXG4gICAgdmFyIGRhdGU7XG4gICAgaWYgKGRhdGVJbmZvLnRpbWV6b25lT2Zmc2V0ICE9IG51bGwpIHtcbiAgICAgIGRhdGVJbmZvLm1pbnV0ZSA9ICsoZGF0ZUluZm8ubWludXRlIHx8IDApIC0gK2RhdGVJbmZvLnRpbWV6b25lT2Zmc2V0O1xuICAgICAgZGF0ZSA9IG5ldyBEYXRlKERhdGUuVVRDKGRhdGVJbmZvLnllYXIgfHwgdG9kYXkuZ2V0RnVsbFllYXIoKSwgZGF0ZUluZm8ubW9udGggfHwgMCwgZGF0ZUluZm8uZGF5IHx8IDEsXG4gICAgICAgIGRhdGVJbmZvLmhvdXIgfHwgMCwgZGF0ZUluZm8ubWludXRlIHx8IDAsIGRhdGVJbmZvLnNlY29uZCB8fCAwLCBkYXRlSW5mby5taWxsaXNlY29uZCB8fCAwKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRhdGUgPSBuZXcgRGF0ZShkYXRlSW5mby55ZWFyIHx8IHRvZGF5LmdldEZ1bGxZZWFyKCksIGRhdGVJbmZvLm1vbnRoIHx8IDAsIGRhdGVJbmZvLmRheSB8fCAxLFxuICAgICAgICBkYXRlSW5mby5ob3VyIHx8IDAsIGRhdGVJbmZvLm1pbnV0ZSB8fCAwLCBkYXRlSW5mby5zZWNvbmQgfHwgMCwgZGF0ZUluZm8ubWlsbGlzZWNvbmQgfHwgMCk7XG4gICAgfVxuICAgIHJldHVybiBkYXRlO1xuICB9O1xuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmVjaGE7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBmZWNoYTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBtYWluLmZlY2hhID0gZmVjaGE7XG4gIH1cbn0pKHRoaXMpO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgbWVzc2FnZU5vZGU6Y2MuTm9kZSxcbiAgICAgICAgcGxheU5vZGU6Y2MuTm9kZSxcblxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBzaG93TWVzc2FnZUFsZXJ0OmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm1lc3NhZ2VOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5tZXNzYWdlTm9kZS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgY29tcC5wbGF5KCdwb3AnKTtcbiAgICB9LFxuXG4gICAgZGlzbWlzc01lc3NhZ2VBbGVydDpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2VsZi5tZXNzYWdlTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfSwwLjMpO1xuICAgIH0sXG5cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuY29uc3QgU29ja2V0ID0gcmVxdWlyZSgnc29ja2V0Jyk7XG5jb25zdCBLUUdsb2JhbEV2ZW50ID0gcmVxdWlyZSgnS1FHbG9iYWxFdmVudCcpO1xuY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jb25zdCBLUU5hdGl2ZUludm9rZSA9IHJlcXVpcmUoJ0tRTmF0aXZlSW52b2tlJyk7XG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XG5cbmxldCBoYWxsID0gY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcblxuICAgICAgICBwcm9kdWN0Tm9kZXM6W2NjLk5vZGVdLFxuICAgICAgICBzaG9wQWxlcnROb2RlOmNjLk5vZGUsXG4gICAgICAgIGNyZWF0ZU5vZGU6Y2MuTm9kZSxcbiAgICAgICAgam9pbk5vZGU6Y2MuTm9kZSxcbiAgICAgICAgaW52aXROb2RlOmNjLk5vZGUsXG4gICAgICAgIGhhc0NvZGU6Y2MuTm9kZSxcbiAgICAgICAgZ2VuZ3hpbjpjYy5Ob2RlLFxuICAgICAgICBhbGVydFByZWZhYjpjYy5QcmVmYWIsXG4gICAgICAgIHRzU2luZ2xlU2VsZWN0OltjYy5Ob2RlXSwvL+WIm+W7uuaIv+mXtOS/oeaBr++8jOWNlemAiVxuICAgICAgICB0c0NoZWNrU2VjbGVjdDpbY2MuTm9kZV0sLy/liJvlu7rmiL/pl7Tkv6Hmga/vvIzlpI3pgIlcbiAgICAgICAgc2VsZWN0TW9TaGk6Y2MuTm9kZSwgICAgIC8v5Yib5bu65oi/6Ze05L+h5oGv77yM5qih5byP77yI5bqE5a625qih5byP5ZKM5peg54m55q6K54mM77yJXG4gICAgICAgIHNlbGVjdEd1aVBhaTpjYy5Ob2RlLCAgICAgLy/liJvlu7rmiL/pl7Tkv6Hmga/vvIzmqKHlvI/vvIjluoTlrrbmqKHlvI/lkozml6DnibnmrorniYzvvIlcbiAgICAgICAgbGFiZWxOb3RpY2U6IGNjLkxhYmVsLCAvL8Kg5YWs5ZGKXG4gICAgICAgIGxhYmVsQmFubmVyOiBjYy5MYWJlbCwgLy8gYmFubmVyIGxhYmVsXG4gICAgICAgIHNoYXJlQWxlcnROb2RlOiBjYy5Ob2RlLFxuICAgICAgICBzaGFyZUFsZXJ0Tm9kZTE6IGNjLk5vZGUsXG4gICAgICAgIHNoYXJlQWxlcnROb2RlQmc6IGNjLk5vZGUsXG4gICAgICAgIHNoYXJlQWxlcnRCdXR0b246IGNjLkJ1dHRvbixcbiAgICAgICAgcmVjb3JkTm9kZTpjYy5Ob2RlLFxuICAgICAgICB3YWl0aW5nUHJlZmFiOmNjLlByZWZhYixcbiAgICAgICAgLy/nlKjmiLfkv6Hmga9cbiAgICAgICAgYXZhdGFyTm9kZTpjYy5Ob2RlLFxuICAgICAgICBuaWNrTmFtZUxhYmVsOmNjLkxhYmVsLFxuICAgICAgICBjYXJkTnVtYmVyTGFiZWw6Y2MuTGFiZWwsXG4gICAgICAgIHVzZXJJZExhYmVsOmNjLkxhYmVsLFxuICAgICAgICBjb2RlTGFiZWw6Y2MuTGFiZWwsXG4gICAgICAgIC8vIHVzZXJJbmZvTXNnTm9kZTpjYy5Ob2RlLFxuICAgICAgICAvL+mAgOWHulxuICAgICAgICBleGl0Tm9kZTpjYy5Ob2RlLFxuICAgICAgICBsb2dvdXROb2RlOiBjYy5Ob2RlLFxuICAgICAgICAvL+aImOe7qVxuICAgICAgICByZWNvcmRNc2dOb2RlOmNjLk5vZGUsXG4gICAgICAgIGZlZWRiYWNrRWRpdEJveDpjYy5FZGl0Qm94LC8v5Y+N6aaIXG4gICAgICAgIGZlZWRiYWNrTm9kZTpjYy5Ob2RlLFxuXG4gICAgICAgIF91c2VySWQ6MCxcbiAgICAgICAgX29wZW5JZDpudWxsLFxuICAgICAgICBfaGVscDpudWxsLFxuICAgICAgICBfY2xvc2U6bnVsbCxcbiAgICAgICAgaW9zVXJsOm51bGwsXG4gICAgICAgIGFVcmw6bnVsbCxcblxuICAgIH0sXG5cbiAgICBzdGF0aWNzOiB7XG4gICAgICAgIGxhc3RIYWxsSW5mbzogbnVsbCwgICAvLyDkuIrkuIDmrKHmlLbliLDnmoTlpKfljoXkv6Hmga9cbiAgICAgICAgY2FjaGVJbWFnZUluZm86IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5mcm9tID0ge307XG4gICAgICAgIGNjLmZyb20uaXNVc2VNYSA9IHRydWU7XG4gICAgICAgIGNjLmZyb20ubWEgPSAwO1xuICAgICAgICBjYy5pc1Jvb21WaWV3U2hvdyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9idG4gPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidG5cIik7XG4gICAgICAgIHRoaXMuX2J1dHRvbnMgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJidXR0b25zXCIpO1xuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheU11c2ljKCk7XG4gICAgICAgIFBsYXliYWNrLmluc3RhbmNlLnJlbW92ZVBsYXliYWNrRGF0YXMoKTtcblxuICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvID0gaGFsbC5jYWNoZUltYWdlSW5mbyB8fCB7fTtcblxuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XG4gICAgICAgIHRoaXMuX3N0YXJ0QmFubmVyQW5pbWF0aW9uKCk7XG4gICAgICAgIHRoaXMuX2luaXRKb2luUm9vbSgpO1xuICAgICAgICB0aGlzLl9pbml0SW52aXQoKTtcblxuICAgICAgICB0aGlzLl91c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XG4gICAgICAgIHRoaXMuX29wZW5JZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5vcGVuSWQ7XG4gICAgICAgIHRoaXMuX2ludml0ZUNvZGUgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaW52aXRlQ29kZTsgIC8v6YKA6K+356CBXG4gICAgICAgIC8vY2MubG9nKHRoaXMuX2ludml0ZUNvZGUsXCLpgoDor7fnoIEtLS0tLS0tLS0tLS0tLS0tLS0tLS1cIik7XG4gICAgICAgIGlmKHRoaXMuX2ludml0ZUNvZGUpeyAgLy/pgoDor7fnoIHlpITnkIZcbiAgICAgICAgICAgIHRoaXMuY29kZUxhYmVsLnN0cmluZyA9IFwiQ09ERe+8mlwiKyB0aGlzLl9pbnZpdGVDb2RlO1xuICAgICAgICAgICAgdGhpcy5oYXNDb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmludml0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICB0aGlzLmhhc0NvZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmludml0Tm9kZS5hY3RpdmUgPSB0cnVlOyAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5jb2RlTGFiZWwuc3RyaW5nID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnByb2R1Y3ROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbXAgPSB0aGlzLnByb2R1Y3ROb2Rlc1tpXS5nZXRDb21wb25lbnQoJ3Byb2R1Y3QnKTtcbiAgICAgICAgICAgIGNvbXAub25DbGlja0FjdGlvbiA9IGZ1bmN0aW9uKHByb2R1Y3RJZCkge1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNvY2tldCA9IGNjLmZpbmQoJ0dhbWVTb2NrZXQnKS5nZXRDb21wb25lbnQoJ3NvY2tldCcpO1xuICAgICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnNvY2tldC5jb25uZWN0aW9uU3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5oaWRkZW5OZXR3b3JrTWVzc2FnZSgpO1xuICAgICAgICAgICAgc2VsZi5oaWRkZW5DaGVja01lc3NhZ2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zb2NrZXQuY29ubmVjdGlvbkRpc2Nvbm5lY3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuc2hvd05ldHdvcmtNZXNzYWdlKCfnvZHnu5zpk77mjqXmlq3lvIDvvIzph43mlrDov57mjqXkuK0uLi4nKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zb2NrZXQuY2hlY2tOZXR3b3JrTm93ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLnNob3dDaGVja01lc3NhZ2UoJ+ajgOafpee9kee7nOS4rS4uLicpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtFbmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuQ2hlY2tNZXNzYWdlKCk7XG4gICAgICAgICAgICBzZWxmLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gIC8q6K6+572u55So5oi35L+h5oGvKi9cbiAgICAgICAgdGhpcy51cGRhdGVVc2VySW5mbygpO1xuICAgICAgICAvKuWIt+aWsOeUqOaIt+S/oeaBryovXG4gICAgICAgIFNvY2tldC5zZW5kR2V0VXNlckluZm8odGhpcy5fdXNlcklkLHRoaXMuX29wZW5JZCk7XG4gICAgICAgIC8q5a6a5pe25Yi35paw55So5oi35L+h5oGvKi9cbiAgICAgICAgdGhpcy5zY2hlZHVsZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgU29ja2V0LnNlbmRHZXRVc2VySW5mbyh0aGlzLl91c2VySWQsdGhpcy5fb3BlbklkKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpLDEwKTsvLzEwc+S4gOasoVxuXG4gICAgICAgIFNvY2tldC5zZW5kR2V0SGFsbEluZm8odGhpcy5zb2NrZXQudXNlckluZm8uaWQpO1xuICAgICAgICAvL2hhbGwubGFzdEhhbGxJbmZvID0gY2MuX2xvZ2luSW5mbztcbiAgICAgICAgaWYgKGhhbGwubGFzdEhhbGxJbmZvKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUJhbm5lcihoYWxsLmxhc3RIYWxsSW5mby5pbmZvKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTm90aWNlKGhhbGwubGFzdEhhbGxJbmZvLmJyb2FkY2FzdCk7XG4gICAgICAgICAgICAvL3RoaXMubGFiZWxCYW5uZXIuc3RyaW5nID0gaGFsbC5sYXN0SGFsbEluZm8uaW5mbztcbiAgICAgICAgICAgIC8vdGhpcy5sYWJlbE5vdGljZS5zdHJpbmcgPSBoYWxsLmxhc3RIYWxsSW5mby5icm9hZGNhc3Q7XG4gICAgICAgIH1cbiAgICAgICAgY2Mub25TaGFyZVdYUmVzcCA9IHRoaXMuX3NoYXJlUmVzdWx0LmJpbmQodGhpcyk7XG5cbiAgICB9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc29ja2V0LnJlY2V2aWNlTWVzc2FnZSA9IGZ1bmN0aW9uKCkge307XG4gICAgICAgIHRoaXMuc29ja2V0LmNvbm5lY3Rpb25TdWNjZXNzID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgICAgdGhpcy5zb2NrZXQuY29ubmVjdGlvbkRpc2Nvbm5lY3QgPSBmdW5jdGlvbigpIHt9O1xuICAgICAgICB0aGlzLnNvY2tldC5jaGVja05ldHdvcmtOb3cgPSBmdW5jdGlvbigpe307XG4gICAgICAgIHRoaXMuc29ja2V0LmNoZWNrTmV0d29ya0VuZCA9IGZ1bmN0aW9uKCkge307XG4gICAgICAgIFxuICAgICAgS1FHbG9iYWxFdmVudC5vZmZUYXJnZXQodGhpcyk7XG4gICAgfSxcblxuICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LkpvaW5EZXNrLCB0aGlzLl9qaWluUm9vbVNvY2tldENhbGxiYWNrLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURlc2tJbmZvLCB0aGlzLl9qaWluUm9vbVNvY2tldENhbGxiYWNrLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUNyZWF0ZURlc2ssIHRoaXMuX2NyZWF0ZVJvb21Tb2NrZXRDYWxsYmFjaywgdGhpcyk7XG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVIYWxsSW5mbywgdGhpcy5fc29ja2V0UmVjZWl2ZUhhbGxJbmZvLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUdldFVzZXJJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlVXNlckluZm8sIHRoaXMpO1xuICAgICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXREaXNjb25uZWN0LCB0aGlzLl9zb2NrZXREaXNjb25uZWN0LCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUludml0ZUNvZGUsIHRoaXMuX3NvY2tldFJlY2VpdmVJbnZpdGVDb2RlLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcy5fc29ja2V0Q29ubmVjdGVkLCB0aGlzKTtcbiAgICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVNoYXJlUG5nLCB0aGlzLl9zb2NrZXRTaGFyZVBuZywgdGhpcyk7XG4gICAgfSxcbiAgICAgICAvL+aOpeWPl+mCgOivt+eggeaVsOaNrlxuICAgIF9zb2NrZXRSZWNlaXZlSW52aXRlQ29kZTpmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgIGxldCBpbnZpdGVDb2RlID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgLy9jYy5sb2coaW52aXRlQ29kZSxcIi0tLS0tLS0tLS0tLSDpgoDor7fnoIEgLS0tLS0tLS0tLS0tXCIpO1xuICAgICAgICBpZihpbnZpdGVDb2RlKXsgIC8v6YKA6K+356CB5aSE55CGXG4gICAgICAgICAgICB0aGlzLl9pbnZpdGVDb2RlID0gaW52aXRlQ29kZTtcbiAgICAgICAgICAgIHRoaXMuY29kZUxhYmVsLnN0cmluZyA9IFwiQ09ERe+8mlwiKyBpbnZpdGVDb2RlO1xuICAgICAgICAgICAgdGhpcy5oYXNDb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmludml0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShcIui+k+WFpeeahOmCgOivt+eggeS4jeWtmOWcqFwiKTtcbiAgICAgICAgICAgIHRoaXMuaGFzQ29kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaW52aXROb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmNvZGVMYWJlbC5zdHJpbmcgPSAnJztcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfc3RhcnRCYW5uZXJBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLmxhYmVsQmFubmVyLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICBhbmltLnBsYXkoJ2Jhbm5lcicpO1xuICAgIH0sXG5cblxuICAgIF9pbml0Sm9pblJvb206IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBsZXQgam9pblJvb20gPSB0aGlzLmpvaW5Ob2RlLmdldENvbXBvbmVudCgnam9pblJvb20nKTtcblxuICAgICAgICBqb2luUm9vbS5jYWxsYmFja0pvaW5Sb29tID0gZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICAgICAgc2VsZi5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICAgICAgc2VsZi5zaG93V2FpdGluZ01lc3NhZ2UoJ+WKoOWFpeS4rS4uLicpO1xuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuICAgICAgICAgICAgfSwgMi4wKTtcblxuICAgICAgICAgICAgLyrliqDlhaXmiL/pl7Tor7fmsYIqL1xuICAgICAgICAgICAgbGV0IHVzZXJJZCA9IFNvY2tldC5pbnN0YW5jZS51c2VySW5mby5pZDtcbiAgICAgICAgICAgIFNvY2tldC5zZW5kSm9pbkRlc2sobnVtYmVyLCB1c2VySWQpO1xuICAgICAgICB9O1xuICAgIH0sXG5cblxuICAgIF9pbml0SW52aXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy92YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIC8vbGV0IEludml0ID0gdGhpcy5pbnZpdE5vZGUuZ2V0Q29tcG9uZW50KCdJbnZpdCcpO1xuXG4gICAgICAgIC8vIEludml0LmNhbGxiYWNrSm9pblJvb20gPSBmdW5jdGlvbiAobnVtYmVyKSB7XG4gICAgICAgIC8vICAgICBzZWxmLmludml0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICAvLyAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vICAgICAgICAgc2VsZi5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuICAgICAgICAvLyAgICAgfSwgMi4wKTtcbiAgICAgICAgLy8gICAgIGNjLmxvZyhudW1iZXIpXG4gICAgICAgIC8vICAgICBjYy5sb2coJy0tLS0tLTE5MScpXG4gICAgICAgIC8vICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgICAvLyB9O1xuICAgIH0sXG5cbiAgICBfamlpblJvb21Tb2NrZXRDYWxsYmFjazogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmKGNjLmlzUm9vbVZpZXdTaG93KXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmhpZGRlbldhaXRpbmdNZXNzYWdlKCk7XG5cbiAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdCkge1xuICAgICAgICAgICAgaWYoY2MuZnJvbSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2MuZnJvbSA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGpvaW5Sb29tID0gdGhpcy5qb2luTm9kZS5nZXRDb21wb25lbnQoJ2pvaW5Sb29tJyk7XG5cbiAgICAgICAgICAgIHRoaXMuam9pbk5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnNldEFsZXJ0Q2FsbGJjayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgam9pblJvb20uY2xpY2tDbGVhcigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYy5mcm9tLm1hID0gcmVzcG9uc2UuZGF0YS5tYVBhaTtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHJlYXNvbkluZm8gPSB0aGlzLl9qb2luUmVhc29uTWFwKHJlc3BvbnNlLmRhdGEucmVhc29uKTtcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlKHJlYXNvbkluZm8pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9zb2NrZXRSZWNlaXZlSGFsbEluZm86IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZihjYy5pc1Jvb21WaWV3U2hvdyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIGhhbGwubGFzdEhhbGxJbmZvID0gZGF0YTtcblxuICAgICAgICBsZXQgaXNJT1MgPSBkYXRhLmlzSU9TO1xuICAgICAgICBsZXQgaXNBbmRyb2lkID0gZGF0YS5pc0E7XG4gICAgICAgIGxldCB2SU9TID0gZGF0YS52SU9TO1xuICAgICAgICBsZXQgdkEgPSBkYXRhLnZBO1xuICAgICAgICB0aGlzLmlvc1VybCA9IGRhdGEuaW9zVXJsO1xuICAgICAgICB0aGlzLmFVcmwgPSBkYXRhLmFVcmw7XG5cbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGlmKGlzSU9TPT0xKXtcbiAgICAgICAgICAgICAgICBpZih2SU9TICE9ICcxLjAuMScgKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZW5neGluLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAgaWYoaXNBbmRyb2lkPT0xKXtcbiAgICAgICAgICAgICAgICBpZih2QSAhPSAnMS4wLjEnICl7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZ3hpbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG5vdGljZSA9IGRhdGEuYnJvYWRjYXN0O1xuICAgICAgICBsZXQgYmFubmVyID0gZGF0YS5pbmZvO1xuICAgICAgICB0aGlzLnVwZGF0ZU5vdGljZShub3RpY2UpO1xuICAgICAgICB0aGlzLnVwZGF0ZUJhbm5lcihiYW5uZXIpO1xuICAgIH0sXG4gICAgZG93bmxvYWROZXdWZXJzaW9uOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuaW9zVXJsKTtcbiAgICAgICAgICAgIC8vIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLCBcImRvd25sb2FkTmV3VmVyc2lvbjpcIiwgdGhpcy5pb3NVcmwpO1xuICAgICAgICB9IGVsc2UgeyAvL0FuZHJvaWRcbiAgICAgICAgICAgIGNjLnN5cy5vcGVuVVJMKHRoaXMuYVVybCk7XG4gICAgICAgICAgICAvLyBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwiZG93bmxvYWROZXdWZXJzaW9uXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIHRoaXMuYVVybCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF9jcmVhdGVSb29tU29ja2V0Q2FsbGJhY2s6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZihjYy5pc1Jvb21WaWV3U2hvdyl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuXG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcbiAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgICAgICB9XG4gICAgICAgIC8q5aaC5p6c6ZK755+z5LiN6Laz77yM5YiZ5o+Q56S6Ki9cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZShcIuaCqOeahOmSu+efs+S4jei2s1wiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfam9pblJlYXNvbk1hcDogZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgbGV0IHJlYXNvbkluZm8gPSB7XG4gICAgICAgIG5vdEV4aXN0OiBcIuaIv+mXtOS4jeWtmOWcqCFcIixcbiAgICAgICAgY2FyZE51bWJlcjogXCLmgqjmiL/ljaHkuI3otrMhXCIsXG4gICAgICB9O1xuXG4gICAgICBsZXQgaW5mbyA9IHJlYXNvbkluZm9bcmVhc29uXSB8fCBcIuaIv+mXtOW3sua7oSFcIjtcbiAgICAgIHJldHVybiBpbmZvO1xuICAgIH0sXG5cbiAgICAvKnNob3AqL1xuICAgIHNob3BBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5zaG9wQWxlcnROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG4gICAgLyrmj5DnpLoqL1xuICAgIGFsZXJ0TWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmFsZXJ0UHJlZmFiKTtcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKG5vZGUpO1xuICAgICAgICB2YXIgY29tcCA9IG5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICB1cGRhdGVOb3RpY2U6IGZ1bmN0aW9uIChub3RpY2UpIHtcbiAgICAgICAgaWYodGhpcy5sYWJlbE5vdGljZSA9PSBudWxsKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgdGhpcy5sYWJlbE5vdGljZS5zdHJpbmcgPSBub3RpY2UgfHwgXCJcIjtcbiAgICB9LFxuXG4gICAgdXBkYXRlQmFubmVyOiBmdW5jdGlvbiAoYmFubmVyID0gXCJcIikge1xuICAgICAgICBpZih0aGlzLmxhYmVsQmFubmVyID09IG51bGwpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB0aGlzLmxhYmVsQmFubmVyLnN0cmluZyA9IGJhbm5lcjtcbiAgICB9LFxuXG4gICAgLypcbiAgICBjcmVhdGVEb25lQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaW5mbyA9IHt9O1xuICAgICAgICB2YXIga2V5ID0gWydzZXR0aW5nMScsJ3NldHRpbmcyJywnc2V0dGluZzMnLCdzZXR0aW5nNCddO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudHNTaW5nbGVTZWxlY3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0c0luZGV4ID0gIHRoaXMudHNTaW5nbGVTZWxlY3RbaV0uZ2V0Q29tcG9uZW50KCdzaW5nbGVTZWxlY3QnKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgaW5mb1trZXlbaV1dID0gdHNJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBpbmZvWyd1c2VySWQnXSA9IHRoaXMuc29ja2V0LnVzZXJJbmZvLmlkO1xuICAgICAgICB0aGlzLnNvY2tldC5zZW5kTWVzc2FnZSgnY3JlYXRlRGVzaycsaW5mbyk7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG5cbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLnNob3dXYWl0aW5nTWVzc2FnZSgn5Yib5bu65LitLi4uJyk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5oaWRkZW5XYWl0aW5nTWVzc2FnZSgpO1xuICAgICAgICB9LCAyLjApO1xuICAgIH0sXG4gICAgKi9cbiAgICAvKiMjIyMjXG4gICAgKiBzZXR0aW5nMSDlsYDmlbAgICgwIHwgMSB8IDIpXG4gICAgKiBzZXR0aW5nMiDkurrmlbAgICgwIHwgMSB8IDIgfDMpXG4gICAgKiBzZXR0aW5nMyDnjqnms5UgICgwIHwgMSlcbiAgICAqIHNldHRpbmc0IEFB5Yi25pS25Y+W5oi/6LS5ICAobnVsbCB8IDApXG4gICAgKiBzZXR0aW5nNSDpqazniYwgICDvvIhudWxsIHwgMCB8IDEgfCAy77yJXG4gICAgKiBzZXR0aW5nNiDmiZPmnqrorqHliIYgKDAgfCAxKVxuICAgICogc2V0dGluZzcg5aSa5LiA6ImyICAobnVsbCB8IDApXG4gICAgKiAqL1xuICAgIGNyZWF0ZURvbmVBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpbmZvID0ge307XG4gICAgICAgIC8v5Y2V6YCJXG4gICAgICAgIHZhciBrZXkgPSBbJ3NldHRpbmcxJywnc2V0dGluZzInLCdzZXR0aW5nNiddO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudHNTaW5nbGVTZWxlY3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0c0luZGV4ID0gIHRoaXMudHNTaW5nbGVTZWxlY3RbaV0uZ2V0Q29tcG9uZW50KCdzaW5nbGVTZWxlY3QnKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgaW5mb1trZXlbaV1dID0gdHNJbmRleDtcbiAgICAgICAgfVxuICAgICAgICAvL+WPr+mAieWPr+S4jemAiVxuICAgICAgICB2YXIga2V5MSA9IFsnc2V0dGluZzQnLCdzZXR0aW5nNyddO1xuICAgICAgICBmb3IodmFyIGkgPSAwO2kgPCB0aGlzLnRzQ2hlY2tTZWNsZWN0Lmxlbmd0aC0xOyBpKyspe1xuICAgICAgICAgICAgdmFyIHRzQ2hlY2tJbmRleCA9IHRoaXMudHNDaGVja1NlY2xlY3RbaV0uZ2V0Q29tcG9uZW50KCdjaGVja1NlbGVjdCcpLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgICAgICBpbmZvW2tleTFbaV1dID0gdHNDaGVja0luZGV4O1xuICAgICAgICB9XG4gICAgICAgIGlmKGNjLmZyb20uaXNVc2VNYSAmJiBjYy5mcm9tLm1hID09IG51bGwpe1xuICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYoY2MuZnJvbS5pc1VzZU1hKSB7XG4gICAgICAgICAgICBpbmZvWydzZXR0aW5nNSddID0gY2MuZnJvbS5tYTtcbiAgICAgICAgfVxuICAgICAgICAvL3NldHRpbmczIHNlbGVjdE1vU2hpSW5kZXjkuLog77yabnVsbCB8fCAwIHx8IDFcbiAgICAgICAgdmFyIHNlbGVjdE1vU2hpSW5kZXggPSB0aGlzLnNlbGVjdE1vU2hpLmdldENvbXBvbmVudCgnc2VsZWN0TW9TaGknKS5zZWxlY3RJbmRleDtcbiAgICAgICAgaW5mb1snc2V0dGluZzMnXSA9IHNlbGVjdE1vU2hpSW5kZXg7XG5cbiAgICAgICAgdmFyIHNlbGVjdE1vU2hpSW5kZXggPSB0aGlzLnNlbGVjdEd1aVBhaS5nZXRDb21wb25lbnQoJ3NlbGVjdE1vU2hpJykuc2VsZWN0SW5kZXg7XG4gICAgICAgIC8vaW5mb1snc2V0dGluZzgnXSA9IHNlbGVjdE1vU2hpSW5kZXg7XG4gICAgICAgIGluZm9bJ3NldHRpbmc4J10gPSBudWxsO1xuICAgICAgICAvL+eUqOaIt0lkXG4gICAgICAgIGluZm9bJ3VzZXJJZCddID0gdGhpcy5zb2NrZXQudXNlckluZm8uaWQ7XG5cbiAgICAgICAgaWYoaW5mb1snc2V0dGluZzYnXSA9PSAwKXtcbiAgICAgICAgICAgIGluZm9bJ3NldHRpbmc2J10gPSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBpbmZvWydzZXR0aW5nNiddID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZihpbmZvWydzZXR0aW5nMiddID09IDMpey8v5LqU5Lq65Zy65b+F6aG75aSa5LiA6ImyXG4gICAgICAgICAgICBpbmZvWydzZXR0aW5nNyddID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpbmZvWydzZXR0aW5nNyddID0gbnVsbDtcbiAgICAgICAgY29uc29sZS5sb2coXCLmiZPljbDlh7rliJvlu7rmiL/pl7Tkv6Hmga9cIik7XG4gICAgICAgIGNvbnNvbGUubG9nKGluZm8pO1xuICAgICAgICAvL3JldHVybjtcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2NyZWF0ZURlc2snLGluZm8pO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5zaG93V2FpdGluZ01lc3NhZ2UoJ+WIm+W7uuS4rS4uLicpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuaGlkZGVuV2FpdGluZ01lc3NhZ2UoKTtcbiAgICAgICAgfSwgMi4wKTtcbiAgICB9LFxuXG4gICAgLy8g6ZqP5py65Zy6XG4gICAgLypjbGlja1JhbmRSb29tOiBmdW5jdGlvbiAoKSB7XG4gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3JhbmRSb29tJyk7XG4gICAgfSwqL1xuXG4gICAgY2xpY2tTaGFyZTogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5zaGFyZUFsZXJ0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTaGFyZTE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zaGFyZUFsZXJ0Tm9kZTEuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGNsaWNrUmVjb3JkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5yZWNvcmROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgICAgICBTb2NrZXQuc2VuZEdldFJlY3JvZChTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQpO1xuXG4gICAgfSxcblxuICAgIGNsaWNrUGxheVJ1bGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9jYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ3J1bGUnKTtcbiAgICAgICAgdGhpcy5oZWxwID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiaGVscFwiKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLmhlbHAuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIC8qc2hhcmUqL1xuICAgIHNoYXJlVG9GcmllbmQ6ZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xuICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUhhbGxGcmllbmRcIiwpO1xuICAgICAgfVxuICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInd4U2hhcmVIYWxsRnJpZW5kXCIsIFwiKClWXCIpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBzaGFyZVRvVGltZWxpbmU6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2hhcmVBbGVydE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlSU9TKCkpIHtcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hTaGFyZUhhbGxUaW1lbGluZVwiLCBcIigpVlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy/ngrnlh7vliIbkuqtcbiAgICBzaGFyZVRvVGltZWxpbmVQbmc6ZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgdGhpcy5zaGFyZUFsZXJ0Tm9kZUJnLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4U2NyZWVuU2hhcmVcIiwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Ugey8vQW5kcm9pZFxuICAgICAgICAgICAgS1FOYXRpdmVJbnZva2Uuc2NyZWVuc2hvdFNoYXJlKFwic2hhcmVJTUdUaW1lbGluZVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xuICAgICAgICAgICAgdGhpcy5zaGFyZUFsZXJ0Tm9kZUJnLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9LmJpbmQodGhpcyksMC4wMSk7Ly8xMHPkuIDmrKFcblxuICAgIH0sXG4gICAgLy/ngrnlh7vliIbkuqvov5Tlm57lgLwgMe+8muaIkOWKnyAgMO+8muW3sue7j+mihuWPllxuICAgIF9zb2NrZXRTaGFyZVBuZzogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy5zaGFyZUFsZXJ0Tm9kZUJnLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBzdGluZztcbiAgICAgICAgaWYoZGF0YS5kYXRhID09IDEpe1xuICAgICAgICAgICAgU29ja2V0LnNlbmRHZXRVc2VySW5mbyh0aGlzLl91c2VySWQsdGhpcy5fb3BlbklkKTtcbiAgICAgICAgICAgIHN0aW5nID0gJ+WIhuS6q+aIkOWKn++8gSc7XG4gICAgICAgICAgICAvL3RoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi5zaG93Q2hlY2tNZXNzYWdlKHN0aW5nKTtcbiAgICAgICAgICAgIC8vfS5iaW5kKHRoaXMpLDAuNSk7Ly8xMHPkuIDmrKFcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgc2VsZi5oaWRkZW5DaGVja01lc3NhZ2UoKTtcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwyKTsvLzEwc+S4gOasoVxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHN0aW5nID0gJ+S7iuWkqeW3sue7j+WIhuS6q+S6hu+8gSc7XG4gICAgICAgICAgICBzZWxmLnNob3dDaGVja01lc3NhZ2Uoc3RpbmcpO1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBzZWxmLmhpZGRlbkNoZWNrTWVzc2FnZSgpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMpLDEuNSk7Ly8xMHPkuIDmrKFcbiAgICAgICAgfVxuXG4gICAgfSxcblxuICAgIF9zaGFyZVJlc3VsdDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZih0aGlzLnNoYXJlQWxlcnROb2RlMS5hY3RpdmUgPT0gZmFsc2Upe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFNvY2tldC5zZW5kU2hhcmVQbmcodGhpcy5fdXNlcklkKTtcbiAgICB9LFxuXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5leGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuICAgIC8q5YiH5o2i6LSm5Y+3Ki9cbiAgICBjbGlja0NhbmNlbExhdGlvbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubG9nb3V0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgbG9nb3V0QWN0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgbWFuYWdlci5zZXRVc2VySW5mbygnJyk7XG4gICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnbG9naW4nKTtcblxuICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvID0gbnVsbDtcbiAgICB9LFxuXG4gICAgZXhpdEFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oJycpO1xuICAgICAgaWYgKCFjYy5zeXMuaXNOYXRpdmUpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdsb2dpbicpO1xuICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvID0gbnVsbDtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcImV4aXRBcHBcIik7XG4gICAgICAgIH0gZWxzZSBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVBbmRyb2lkKCkpIHsvL0FuZHJvaWQgY29tLmxsaW5nLnFpYW5qaWFuZ2x6Z1xuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcImV4aXRBcHBcIiwgXCIoKVZcIik7XG4gICAgICAgIH1cbiAgICAgICAgY2MuZGlyZWN0b3IuZW5kKCk7XG5cbiAgICB9LFxuXG4gICAgLy/mjqXmlLblpITnkIbnlKjmiLfmlbDmja5cbiAgICBfc29ja2V0UmVjZWl2ZVVzZXJJbmZvOmZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmKGNjLmlzUm9vbVZpZXdTaG93KXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgaWYgKCF0aGlzLnNvY2tldC51c2VySW5mbykge1xuICAgICAgICBjYy5lcnJvcihcInRoaXMuc29ja2V0LnVzZXJJbmZvIOS4uuepuiEhIVwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5uaWNrTmFtZUxhYmVsLnN0cmluZyA9IHJlc3BvbnNlLmRhdGEubmlja25hbWU7XG4gICAgICB0aGlzLnVzZXJJZExhYmVsLnN0cmluZyA9ICdJRDogJyArIHJlc3BvbnNlLmRhdGEuaWQ7XG4gICAgICB0aGlzLmNhcmROdW1iZXJMYWJlbC5zdHJpbmcgPSByZXNwb25zZS5kYXRhLmNhcmROdW1iZXI7XG4gICAgICB2YXIgc3ByaXRlID0gdGhpcy5hdmF0YXJOb2RlLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xuICAgICAgY2MubG9hZGVyLmxvYWQocmVzcG9uc2UuZGF0YS5hdmF0YXJVcmwrXCIuanBnXCIsIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgIHZhciBmcmFtZSA9IG5ldyBjYy5TcHJpdGVGcmFtZSh0ZXgpO1xuICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWU9ZnJhbWU7XG4gICAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9zb2NrZXREaXNjb25uZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zaG93TmV0d29ya01lc3NhZ2UoXCLnvZHnu5zpk77mjqXmlq3lvIDvvIzph43mlrDov57mjqXkuK0uLi5cIik7XG4gICAgfSxcblxuICAgIF9zb2NrZXRDb25uZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmhpZGRlbk5ldHdvcmtNZXNzYWdlKCk7XG4gICAgfSxcblxuICAgIC8v5pu05paw55So5oi35L+h5oGvXG4gICAgdXBkYXRlVXNlckluZm86ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpbmZvID0gdGhpcy5zb2NrZXQudXNlckluZm87XG4gICAgICAgIGlmICghaW5mbykge1xuICAgICAgICAgIGNjLmVycm9yKFwidGhpcy5zb2NrZXQudXNlckluZm8g5Li656m6ISEhXCIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubmlja05hbWVMYWJlbC5zdHJpbmcgPSBpbmZvLm5pY2tuYW1lO1xuICAgICAgICB0aGlzLnVzZXJJZExhYmVsLnN0cmluZyA9ICdJRDogJyArIGluZm8uaWQ7XG4gICAgICAgIHRoaXMuY2FyZE51bWJlckxhYmVsLnN0cmluZyA9IGluZm8uY2FyZE51bWJlcjtcblxuICAgICAgICBsZXQgYXZhdGFyVXJsID0gaW5mby5hdmF0YXJVcmwgKyBcIi5qcGdcIjtcbiAgICAgICAgdmFyIHNwcml0ZSA9IHRoaXMuYXZhdGFyTm9kZS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcbiAgICAgICAgdmFyIHRleHR1cmUgPSBoYWxsLmNhY2hlSW1hZ2VJbmZvW2F2YXRhclVybF07XG4gICAgICAgIGlmICh0ZXh0dXJlKSB7XG4gICAgICAgICAgICBsZXQgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4dHVyZSk7XG4gICAgICAgICAgICBpZiAoZnJhbWUpIHtcbiAgICAgICAgICAgICAgICBjYy5sb2coXCLku47nvJPlrZjkuK3liqDovb3lpLTlg49cIik7XG4gICAgICAgICAgICAgICAgc3ByaXRlLnNwcml0ZUZyYW1lID0gZnJhbWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY2MubG9hZGVyLmxvYWQoaW5mby5hdmF0YXJVcmwrXCIuanBnXCIsIGZ1bmN0aW9uIChlcnIsIHRleCkge1xuICAgICAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4KTtcbiAgICAgICAgICAgICAgICBzcHJpdGUuc3ByaXRlRnJhbWU9ZnJhbWU7XG5cbiAgICAgICAgICAgICAgICBoYWxsLmNhY2hlSW1hZ2VJbmZvW2F2YXRhclVybF0gPSB0ZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKuaPkOS6pOaEj+ingSovXG4gICAgZmVlZGJhY2tBY2lvbjpmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdXNlcklkID0gdGhpcy5zb2NrZXQudXNlckluZm8uaWQ7XG4gICAgICB2YXIgdGV4dCA9IHRoaXMuZmVlZGJhY2tFZGl0Qm94LnN0cmluZztcbiAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5mZWVkYmFja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgU29ja2V0LnNlbmRGZWVkYmFjayh1c2VySWQsdGV4dCk7XG4gICAgICAgIHRoaXMuZmVlZGJhY2tFZGl0Qm94LnN0cmluZyA9ICcnO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBzaG93V2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICBpZiAodGhpcy53YWl0aW5nTm9kZSAhPSBudWxsICYmIGNjLnN5cy5pc05hdGl2ZSAmJiBjYy5zeXMuaXNPYmplY3RWYWxpZCh0aGlzLndhaXRpbmdOb2RlKSkge1xuICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUuZGVzdG9yeSgpO1xuICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUgPSBudWxsO1xuICAgICAgfVxuICAgICAgdGhpcy53YWl0aW5nTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICB0aGlzLm5vZGUuYWRkQ2hpbGQodGhpcy53YWl0aW5nTm9kZSk7XG4gICAgICB2YXIgY29tcCA9IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICBjb21wLmFsZXJ0KCk7XG4gICAgfSxcblxuICAgIGhpZGRlbldhaXRpbmdNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy9uZXR3b3JrXG4gICAgc2hvd05ldHdvcmtNZXNzYWdlOmZ1bmN0aW9uKG1zZykge1xuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAmJiB0aGlzLm5ldHdvcmtOb2RlLmFjdGl2ZSkge1xuICAgICAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICAgICAgICBpZiAoYWxlcnQuZ2V0TWVzc2FnZSgpID09IG1zZykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5ydW5BY3Rpb24ocmVtb3ZlU2VsZkFjdGlvbik7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5ldHdvcmtOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcbiAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMubmV0d29ya05vZGUpO1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGNvbXAub25EaXNtaXNzQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYubmV0d29ya05vZGUgPSBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBoaWRkZW5OZXR3b3JrTWVzc2FnZTpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vY2hlY2tOb2RlXG4gICAgc2hvd0NoZWNrTWVzc2FnZTpmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgaWYgKCEodGhpcy5jaGVja05vZGUgJiYgdGhpcy5jaGVja05vZGUuYWN0aXZlKSkge1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICAgICAgaWYgKGFsZXJ0LmdldE1lc3NhZ2UoKSA9PSBtc2cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLmNoZWNrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoZWNrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLmNoZWNrTm9kZSk7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGNvbXAub25EaXNtaXNzQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHNlbGYuY2hlY2tOb2RlID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgaGlkZGVuQ2hlY2tNZXNzYWdlOmZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5jaGVja05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jaGVja05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgb25CdG5DbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKHRoaXMuX2J1dHRvbnMuYWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLl9idXR0b25zLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbnMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gaGFsbDtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvKnNwcml0ZXM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlQXRsYXNcclxuICAgICAgICB9LCovXHJcbiAgICAgICAgcGxheV9tZXRob2RfYmVmb3JlOmNjLk5vZGUsICAvL+eOqeazleS7i+e7jVxyXG4gICAgICAgIHBsYXlfbWV0aG9kX2NvbnRlbnRfbGFiZWw6Y2MuTm9kZSwgIC8v546p5rOV5LuL57uN5YaF5a65XHJcbiAgICAgICAgaW50cm9kdWNlX3BhaV9iZWZvcmU6Y2MuTm9kZSwvL+eJjOWei+S7i+e7jVxyXG4gICAgICAgIGRldGFpbHM6Y2MuTm9kZSwgICAvL+eJjOWei+S7i+e7jeWGheWuuVxyXG4gICAgICAgIGNhb3p1b19iZWZvcmU6Y2MuTm9kZSwgICAgIC8v5pON5L2c5LuL57uNXHJcbiAgICAgICAgY2FvenVvX2NvbnRlbnQ6Y2MuTm9kZSwgIC8v5pON5L2c5LuL57uN5YaF5a65XHJcbiAgICAgICAgX2J0bjpudWxsLFxyXG4gICAgICAgIF9jb250ZW50Om51bGwsXHJcbiAgICAgICAgX2J1dHRvbkNvbTpudWxsLFxyXG4gICAgICAgIF9wbGF5X21ldGhvZF9idXR0b246bnVsbCxcclxuICAgICAgICBfaW50cm9kdWNlX3BhaV9idXR0b246bnVsbCxcclxuICAgICAgICBfY2FvenVvX2J1dHRvbjpudWxsXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fcGxheV9tZXRob2RfYnV0dG9uID0gdGhpcy5wbGF5X21ldGhvZF9iZWZvcmUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XHJcbiAgICAgICAgdGhpcy5faW50cm9kdWNlX3BhaV9idXR0b24gPSB0aGlzLmludHJvZHVjZV9wYWlfYmVmb3JlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xyXG4gICAgICAgIHRoaXMuX2Nhb3p1b19idXR0b24gPSB0aGlzLmNhb3p1b19iZWZvcmUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbik7XHJcbiAgICAgICAgdGhpcy5fYnRuID0gW3RoaXMucGxheV9tZXRob2RfYmVmb3JlLHRoaXMuaW50cm9kdWNlX3BhaV9iZWZvcmUsdGhpcy5jYW96dW9fYmVmb3JlXTtcclxuICAgICAgICB0aGlzLl9jb250ZW50ID0gW3RoaXMucGxheV9tZXRob2RfY29udGVudF9sYWJlbCx0aGlzLmRldGFpbHMsdGhpcy5jYW96dW9fY29udGVudF07XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uQ29tID0gW3RoaXMuX3BsYXlfbWV0aG9kX2J1dHRvbix0aGlzLl9pbnRyb2R1Y2VfcGFpX2J1dHRvbix0aGlzLl9jYW96dW9fYnV0dG9uXTtcclxuICAgICAgICAvL+WImuW8gOWni+eJjOWei+S7i+e7jeeahOaMiemSruS4jeWPr+eUqFxyXG4gICAgICAgIHRoaXMuX2J1dHRvbkNvbVsxXS5pbnRlcmFjdGFibGUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICAvLyDngrnlh7vnjqnms5Xku4vnu41cclxuICAgIG9uQnRuUGxheU1ldGhvZENsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IodmFyIGk9MDtpPDM7aSsrKXtcclxuICAgICAgICAgICAgLy/miYDmnInmjInpkq7orr7nva7kuLrlj6/nlKhcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8v5omA5pyJ55qE5YaF5a656YO96ZqQ6JeP5o6JXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5b2T5YmN54K55Ye755qE6K6+572u5Li65LiN5Y+v55SoXHJcbiAgICAgICAgdGhpcy5fYnV0dG9uQ29tWzBdLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIC8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgdGhpcy5fY29udGVudFswXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIC8v54K55Ye754mM5Z6L5LuL57uNXHJcbiAgICBvbkJ0bkludHJvZHVjZVBhaUNsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IodmFyIGk9MDtpPDM7aSsrKXtcclxuICAgICAgICAgICAgLy/miYDmnInmjInpkq7orr7nva7kuLrlj6/nlKhcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8v5omA5pyJ55qE5YaF5a656YO96ZqQ6JeP5o6JXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5b2T5YmN54K55Ye755qE6K6+572u5Li65LiN5Y+v55SoXHJcbiAgICAgICAgdGhpcy5fYnV0dG9uQ29tWzFdLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIC8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgdGhpcy5fY29udGVudFsxXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIC8v54K55Ye75pON5L2c5LuL57uNXHJcbiAgICBvbkJ0bkNhb3p1b0NsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IodmFyIGk9MDtpPDM7aSsrKXtcclxuICAgICAgICAgICAgLy/miYDmnInmjInpkq7orr7nva7kuLrlj6/nlKhcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uQ29tW2ldLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8v5omA5pyJ55qE5YaF5a656YO96ZqQ6JeP5o6JXHJcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8v5b2T5YmN54K55Ye755qE6K6+572u5Li65LiN5Y+v55SoXHJcbiAgICAgICAgdGhpcy5fYnV0dG9uQ29tWzJdLmludGVyYWN0YWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIC8v5b2T5YmN54K55Ye755qE5a+55bqU55qE5YaF5a655Y+v6KeBXHJcbiAgICAgICAgdGhpcy5fY29udGVudFsyXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgLy8gY2FsbGVkIGV2ZXJ5IGZyYW1lLCB1bmNvbW1lbnQgdGhpcyBmdW5jdGlvbiB0byBhY3RpdmF0ZSB1cGRhdGUgY2FsbGJhY2tcclxuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XHJcblxyXG4gICAgLy8gfSxcclxufSk7XHJcbiIsIi8qKlxyXG4gKiDpgoDor7fnoIFcclxuICogQGF1dGhvcnMg6buE5oiQKHlvdUBleGFtcGxlLm9yZylcclxuICogQGRhdGUgICAgMjAxNy0wNi0xNiAwOTo0NDoxMFxyXG4gKiBAdmVyc2lvbiAkSWQkXHJcbiAqL1xyXG5jb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBsYWJlbE51bWJlcnM6IFtjYy5MYWJlbF0sXHJcbiAgICAgICAgY2FsbGJhY2tJbnZpdGVDb2RlOiAnJyxcclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuY2xpY2tDbGVhcigpOyAvL+a4hemZpOaVsOWtl1xyXG4gICAgfSxcclxuXHJcbiAgICBjbGlja0NsZWFyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubGFiZWxOdW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XHJcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gXCJcIjtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNsaWNrTnVtYmVyOiBmdW5jdGlvbiAoZXZlbnQsIG51bWJlcikge1xyXG4gICAgICB2YXIgbGFiZWwgPSB0aGlzLl9sYXN0RW1wdHlMYWJlbCgpO1xyXG4gICAgICBpZiAobGFiZWwpIHtcclxuICAgICAgICBsYWJlbC5zdHJpbmcgPSBudW1iZXI7XHJcbiAgICAgICBcdGNjLmxvZyhsYWJlbC5zdHJpbmcgLFwiLS0tLS0tLS0tLS0tLS0tLVwiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgbGV0IGlzQ29tcGxldGUgPSAodGhpcy5fbGFzdEVtcHR5TGFiZWwoKSA9PSBudWxsKTtcclxuICAgICAgY2MubG9nKFwiaXNDb21wbGV0ZS0tLS0tLS0tLS0tLS1cIiwgdGhpcy5jYWxsYmFja0ludml0ZUNvZGUpO1xyXG4gICAgICBsZXQgaW52aXRlTnVtYmVyID0gdGhpcy5faW52aXRlTnVtYmVyKCk7XHJcblxyXG4gICAgICBpZiAoIGludml0ZU51bWJlci5sZW5ndGggPT0gNiApe1xyXG4gICAgICAgIGNjLmxvZyhpbnZpdGVOdW1iZXIsXCItLS0tLS0tLS0tLS0tLS0tLS0tLTM4XCIpOyAvL+mCgOivt+eggVxyXG4gICAgICAgIGxldCB1c2VySWQgPSBTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQ7XHJcbiAgICAgICAgLy9Tb2NrZXQuc2VuZEludml0ZUNvZGUoaW52aXRlTnVtYmVyLCB1c2VySWQpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tJbnZpdGVDb2RlID0gaW52aXRlTnVtYmVyO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2VuZENvZGUgOmZ1bmN0aW9uKCl7ICAvL+WPkemAgemCgOivt+eggVxyXG4gICAgICBsZXQgdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICBsZXQgaW52aXRlTnVtYmVyID0gdGhpcy5jYWxsYmFja0ludml0ZUNvZGU7XHJcbiAgICAgIC8vY2MubG9nKGludml0ZU51bWJlcixcIi0tLS0tLS0tLS0tLS0tLS0tLS0tMzhcIilcclxuICAgICAgaWYoIGludml0ZU51bWJlciAmJiBpbnZpdGVOdW1iZXIubGVuZ3RoPT02KXsgIFxyXG4gICAgICAgIFNvY2tldC5zZW5kSW52aXRlQ29kZShpbnZpdGVOdW1iZXIsIHVzZXJJZCk7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja0ludml0ZUNvZGUgPSAnJzsgICAvL+a4heepuumCgOivt+eggVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2xpY2tEZWxldGVPbmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IGxhYmVsID0gdGhpcy5fbGFzdE51bWJlckxhYmVsKCk7XHJcbiAgICAgIGlmIChsYWJlbCkge1xyXG4gICAgICAgIGxhYmVsLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgX2xhc3RFbXB0eUxhYmVsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGZvciAodmFyIGluZGV4IGluIHRoaXMubGFiZWxOdW1iZXJzKSB7XHJcbiAgICAgICAgdmFyIGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgPT0gbnVsbFxyXG4gICAgICAgIHx8IGxhYmVsLnN0cmluZy5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgX2xhc3ROdW1iZXJMYWJlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBmb3IgKHZhciBpbmRleCA9IHRoaXMubGFiZWxOdW1iZXJzLmxlbmd0aCAtIDE7IGluZGV4ID49IDA7IC0taW5kZXgpIHtcclxuICAgICAgICBsZXQgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XHJcbiAgICAgICAgaWYgKGxhYmVsLnN0cmluZyAmJiBsYWJlbC5zdHJpbmcubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIF9pbnZpdGVOdW1iZXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubGFiZWxOdW1iZXJzLnJlZHVjZShmdW5jdGlvbiAoaW52aXRlTnVtYmVyLCBsYWJlbCkge1xyXG4gICAgICAgIC8vY2MubG9nKGludml0ZU51bWJlcixcIi0tLS0tLS0tLS0tLS0tLS0tXCIpO1xyXG4gICAgICAgIHJldHVybiBpbnZpdGVOdW1iZXIgKyAobGFiZWwuc3RyaW5nIHx8IFwiXCIpO1xyXG4gICAgICB9LCBcIlwiKTtcclxuICAgIH0sXHJcbn0pIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGFiZWxOdW1iZXJzOiBbY2MuTGFiZWxdLFxuICAgICAgICBjYWxsYmFja0pvaW5Sb29tOiBudWxsLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY2xpY2tDbGVhcigpO1xuICAgIH0sXG5cbiAgICBjbGlja051bWJlcjogZnVuY3Rpb24gKGV2ZW50LCBudW1iZXIpIHtcbiAgICAgIHZhciBsYWJlbCA9IHRoaXMuX2xhc3RFbXB0eUxhYmVsKCk7XG4gICAgICBpZiAobGFiZWwpIHtcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gbnVtYmVyO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgaXNDb21wbGV0ZSA9ICh0aGlzLl9sYXN0RW1wdHlMYWJlbCgpID09IG51bGwpO1xuICAgICAgaWYgKGlzQ29tcGxldGUgJiYgdGhpcy5jYWxsYmFja0pvaW5Sb29tKSB7XG4gICAgICAgIGxldCByb29tTnVtYmVyID0gdGhpcy5fcm9vbU51bWJlcigpO1xuICAgICAgICAvLyBjYy5sb2coXCLopoHliqDlhaXnmoTmiL/pl7Tlj7fmmK/vvJpcIiwgcm9vbU51bWJlcik7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tKb2luUm9vbShyb29tTnVtYmVyKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tDbGVhcjogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5sYWJlbE51bWJlcnMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gXCJcIjtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBjbGlja0RlbGV0ZU9uZTogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGxhYmVsID0gdGhpcy5fbGFzdE51bWJlckxhYmVsKCk7XG4gICAgICBpZiAobGFiZWwpIHtcbiAgICAgICAgbGFiZWwuc3RyaW5nID0gXCJcIjtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgX2xhc3RFbXB0eUxhYmVsOiBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBpbmRleCBpbiB0aGlzLmxhYmVsTnVtYmVycykge1xuICAgICAgICB2YXIgbGFiZWwgPSB0aGlzLmxhYmVsTnVtYmVyc1tpbmRleF07XG4gICAgICAgIGlmIChsYWJlbC5zdHJpbmcgPT0gbnVsbFxuICAgICAgICB8fCBsYWJlbC5zdHJpbmcubGVuZ3RoIDw9IDApIHtcbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICBfbGFzdE51bWJlckxhYmVsOiBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBpbmRleCA9IHRoaXMubGFiZWxOdW1iZXJzLmxlbmd0aCAtIDE7IGluZGV4ID49IDA7IC0taW5kZXgpIHtcbiAgICAgICAgbGV0IGxhYmVsID0gdGhpcy5sYWJlbE51bWJlcnNbaW5kZXhdO1xuICAgICAgICBpZiAobGFiZWwuc3RyaW5nICYmIGxhYmVsLnN0cmluZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sXG5cbiAgICBfcm9vbU51bWJlcjogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubGFiZWxOdW1iZXJzLnJlZHVjZShmdW5jdGlvbiAocm9vbU51bWJlciwgbGFiZWwpIHtcbiAgICAgICAgcmV0dXJuIHJvb21OdW1iZXIgKyAobGFiZWwuc3RyaW5nIHx8IFwiXCIpO1xuICAgICAgfSwgXCJcIik7XG4gICAgfSxcbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2xvZ2luJyk7XG4gICAgICAgIH0sIDAuNSk7XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcblxuICAgIC8vIH0sXG59KTtcbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuY29uc3QgS1FDYXJkID0gcmVxdWlyZSgnS1FDYXJkJyk7XG5jb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IEtRQ2FyZEZpbmRUeXBlRXh0ZW5zaW9uID0gcmVxdWlyZSgnS1FDYXJkRmluZFR5cGVFeHRlbnNpb24nKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcbmNvbnN0IEtRR2xhYm9sU29ja2V0RXZlbnRIYW5kZXIgPSByZXF1aXJlKCdLUUdsYWJvbFNvY2tldEV2ZW50SGFuZGVyJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNlbGVjdE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgYWxlcnRQcmVmYWI6Y2MuUHJlZmFiLFxuICAgICAgICBjYW52YXNOb2RlOmNjLk5vZGUsXG4gICAgICAgIC8vYWdyZWVtZW50OiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgICAgIC8vICAgIHR5cGU6IGNjLkxhYmVsXG4gICAgICAgIC8vfSxcbiAgICAgICAgdkxhYmVsOmNjLkxhYmVsLFxuICAgICAgICBzY3JvbGxfVmlldzoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6Y2MuU2Nyb2xsVmlld1xuICAgICAgICB9LFxuICAgICAgICBhZ3JlZW1lbnRMYWJlbDpjYy5MYWJlbCxcbiAgICAgICAgYWdyZWVtZW50Tm9kZTpjYy5Ob2RlLFxuICAgICAgICB3YWl0aW5nUHJlZmFiOmNjLlByZWZhYixcbiAgICB9LFxuXG4gICAgZ29VcGRhdGVBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiQXBwQ29udHJvbGxlclwiLFwiZG93bmxvYWROZXdWZXJzaW9uOlwiLHRoaXMuaW9zVXJsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsvL0FuZHJvaWRcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoXCJjb20vbGxpbmcvc3N6L0FwcEFjdGl2aXR5XCIsIFwiZG93bmxvYWROZXdWZXJzaW9uXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nOylWXCIsIHRoaXMuYW5kcm9pZFVybCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2hlY2tWZXJzaW9uOmZ1bmN0aW9uKHZEYXRhKSB7XG4gICAgICAgIC8vdmFyIHZlcnNpb24gPSB2RGF0YS52ZXJzaW9uO1xuICAgICAgICBjYy5pbmZvMSA9IHZEYXRhLnZlcnNpb247XG4gICAgICAgIHRoaXMuaW9zVXJsID0gdkRhdGEuaW9zVXJsO1xuICAgICAgICB0aGlzLmFuZHJvaWRVcmwgPSB2RGF0YS5hbmRyb2lkVXJsO1xuICAgICAgICAvL2lmIChtYW5hZ2VyLnZlcnNpb24gIT0gdmVyc2lvbikgey8v5pu05paw54mI5pysXG4gICAgICAgIC8vICAgIHRoaXMudmVyc2lvbkVuYWJsZSA9IGZhbHNlO1xuICAgICAgICAvLyAgICB0aGlzLmdvVXBkYXRlQWN0aW9uKCk7XG4gICAgICAgIC8vICAgIC8vdGhpcy52ZXJzaW9uTGFiZWwuc3RyaW5nID0gJ+ivt+WIsOacjeWKoeWZqOabtOaWsOWIsOacgOaWsOeJiOacrCc7XG4gICAgICAgIC8vfVxuICAgICAgICAvL2Vsc2Uge1xuICAgICAgICAgICAgLy90aGlzLnZlcnNpb25MYWJlbC5zdHJpbmcgPSAn5b2T5YmN54mI5pysICcgKyBtYW5hZ2VyLnZlcnNpb247XG4gICAgICAgICAgICB0aGlzLnZlcnNpb25FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBtYW5hZ2VyLmdldFVzZXJJbmZvKCk7XG4gICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9naW5FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9naW5FbmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmxvZ2luQWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwwLjUpO1xuICAgICAgICAvL31cbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coY2Muc3lzLmxvY2FsU3RvcmFnZSxcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTM1XCIpO1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnVzZXJpbmZvID0gJyc7XG4gICAgICAgIHRoaXMuc2Nyb2xsX1ZpZXcuc2Nyb2xsVG9Ub3AoKTtcbiAgICAgICAgS1FHbGFib2xTb2NrZXRFdmVudEhhbmRlci5zdGFydCgpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMubG9naW5FbmFibGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zb2NrZXQgPSBjYy5maW5kKCdHYW1lU29ja2V0JykuZ2V0Q29tcG9uZW50KCdzb2NrZXQnKTtcbiAgICAgICAgdGhpcy5zb2NrZXQucmVjZXZpY2VNZXNzYWdlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgaWYgKGRhdGEuYWN0aW9uID09ICdjaGVja1ZlcnNpb24nKSB7XG4gICAgICAgICAgICAgICBzZWxmLmNoZWNrVmVyc2lvbihkYXRhLmRhdGEpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGVsc2UgaWYgKGRhdGEuYWN0aW9uID09ICdsb2dpbicpIHtcbiAgICAgICAgICAgICAgIGlmIChkYXRhLnJlc3VsdCkgey8v5oiQ5YqfXG4gICAgICAgICAgICAgICAgICAgc2VsZi5zb2NrZXQudXNlckluZm8gPSBkYXRhLmRhdGE7Ly/ov5DooYzml7bmgIHkv6Hmga9cbiAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLnJvb21JZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5wcmVsb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgncGxheScpO1xuICAgICAgICAgICAgICAgICAgICAgICB9LDEpO1xuICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLnByZWxvYWRTY2VuZSgncGxheScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgIH0sMSk7XG4gICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgc2VsZi5hbGVydE1lc3NhZ2UoJ+eZu+W9leWksei0pSEnKTtcbiAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgfVxuICAgICAgIH07XG5cbiAgICAgICAvL+S7juacrOWcsOiwg1xuICAgICAgIC8vIHRoaXMuc29ja2V0LmdldFd4SW5mbyA9IGZ1bmN0aW9uKGluZm8pIHtcbiAgICAgICAvLyAgICAvL2NvbnNvbGUubG9nKFwi6L+b5p2l6L+Z6YeM5LqG77yf77yf77yfXCIpO1xuICAgICAgIC8vICAgICBtYW5hZ2VyLnNldFVzZXJJbmZvKGluZm8pOy8v5L+d5a2Y5pys5ZywXG4gICAgICAgLy8gICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShpbmZvKTsvL3N0ciAtPiBqc29uKG9iailcbiAgICAgICAvLyAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXsvL+W7tui/n+aJp+ihjCAxc1xuICAgICAgIC8vICAgICAgICAgc2VsZi5zZW5kTG9naW5SZXF1ZXN0KGRhdGEpOy8v55m75b2V6K+35rGCXG4gICAgICAgLy8gICAgIH0sMSk7XG4gICAgICAgLy8gfTtcbiAgICAgICAvL2RlYnVnXG4gICAgICAgLy92YXIgdGVzdERhdGEgPSAne1wib3BlbmlkXCI6XCJvczA0QXdtUTFXMEpTbnlEdEg4OWpCdDl4SHVFXCIsXCJuaWNrbmFtZVwiOlwi5YWD6IqzXCIsXCJzZXhcIjoxLFwibGFuZ3VhZ2VcIjpcInpoX0NOXCIsXCJjaXR5XCI6XCJDaGFuZ3NoYVwiLFwicHJvdmluY2VcIjpcIkh1bmFuXCIsXCJjb3VudHJ5XCI6XCJDTlwiLFwiaGVhZGltZ3VybFwiOlwiaHR0cDpcXC9cXC93eC5xbG9nby5jblxcL21tb3BlblxcLzhEOGRPdEFjRGljNVNpY2h2M2x4dE1YWUpnbXVuVExPTHZUVDVBRk00emFxS0V0aFppYnY4eGRXa2dqTjlZYjRBUW53dlN1cnoyN1VCMjl4eDgxWE9Sd3g1NVhhbnhxY3RkRFxcLzBcIixcInByaXZpbGVnZVwiOltdfSc7XG4gICAgICAgICAgZnVuY3Rpb24gZ2V0UXVlcnlTdHJpbmcobmFtZSkgeyBcbiAgICAgICAgICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXnwmKVwiICsgbmFtZSArIFwiPShbXiZdKikoJnwkKVwiLCBcImlcIik7IFxuICAgICAgICAgICAgICB2YXIgciA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEpLm1hdGNoKHJlZyk7IFxuICAgICAgICAgICAgICBpZiAociAhPSBudWxsKSByZXR1cm4gdW5lc2NhcGUoclsyXSk7IHJldHVybiBudWxsOyBcbiAgICAgICAgICB9IFxuICAgICAgICAgIHZhciBjb2RlID0gZ2V0UXVlcnlTdHJpbmcoXCJjb2RlXCIpO1xuICAgICAgICAgIGlmKCBjb2RlICl7XG4gICAgICAgICAgICAgIHZhciBvYmogPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsgIC8vIFhNTEh0dHBSZXF1ZXN05a+56LGh55So5LqO5Zyo5ZCO5Y+w5LiO5pyN5Yqh5Zmo5Lqk5o2i5pWw5o2uICAgXG4gICAgICAgICAgICAgIC8vdmFyIHVybCA9IFwiLi9hY2Nlc3NfdG9rZW4ucGhwXCI7ICAgICAgIFxuICAgICAgICAgICAgICB2YXIgdXJsID0gXCJodHRwOlxcL1xcL2hvbmdnZWZlbmcuY25cXC9zc3pXZWJcXC9hY2Nlc3NfdG9rZW4ucGhwXCI7ICAgLy/mtYvor5UgICAgXG4gICAgICAgICAgICAgIG9iai5vcGVuKFwiUE9TVFwiLCB1cmwsIHRydWUpO1xuICAgICAgICAgICAgICBvYmouc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtdHlwZVwiLCBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKTsgIC8vIOa3u+WKoGh0dHDlpLTvvIzlj5HpgIHkv6Hmga/oh7PmnI3liqHlmajml7blhoXlrrnnvJbnoIHnsbvlnotcbiAgICAgICAgICAgICAgb2JqLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChvYmoucmVhZHlTdGF0ZSA9PSA0ICYmIChvYmouc3RhdHVzID09IDIwMCB8fCBvYmouc3RhdHVzID09IDMwNCkpIHsgIC8vIDMwNOacquS/ruaUuVxuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlckluZm8gPSBKU09OLnBhcnNlKCBvYmoucmVzcG9uc2VUZXh0ICk7XG4gICAgICAgICAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8oIHVzZXJJbmZvICk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCB1c2VySW5mbyApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgb2JqLnNlbmQoXCJjb2RlPVwiK2NvZGUpO1xuICAgICAgICAgIH1cbiAgICBcbiAgICAgICBcbiAgICAgICAgLy8gaWYgKCFjYy5zeXMuaXNOYXRpdmUgJiYgd2luZG93LmxvY2F0aW9uKSB7XG4gICAgICAgIC8vICAgICBsZXQgc2VhcmNoID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcbiAgICAgICAgLy8gICAgIGlmIChzZWFyY2gpIHtcbiAgICAgICAgLy8gICAgICAgICBsZXQgcXVlcnkgPSBzZWFyY2guc3Vic3RyaW5nKDEpO1xuICAgICAgICAvLyAgICAgICAgIGxldCBhdHRycyA9IHF1ZXJ5LnNwbGl0KCcmJyk7XG4gICAgICAgIC8vICAgICAgICAgbGV0IG9iaiA9IEpTT04ucGFyc2UodGVzdERhdGEpO1xuXG4gICAgICAgIC8vICAgICAgICAgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgIC8vICAgICAgICAgdmFyIGxvYyA9IHVybC5zdWJzdHJpbmcodXJsLmxhc3RJbmRleE9mKCc9JykrMSwgdXJsLmxlbmd0aCk7XG4gICAgICAgICAgICAgICBcblxuICAgICAgICAvLyAgICAgICAgIGF0dHJzLmZvckVhY2goZnVuY3Rpb24gKGF0dHIpIHtcbiAgICAgICAgLy8gICAgICAgICAgICAgbGV0IGtleVZhbHVlQXJyID0gYXR0ci5zcGxpdCgnPScpO1xuICAgICAgICAvLyAgICAgICAgICAgICBsZXQga2V5ID0ga2V5VmFsdWVBcnJbMF07XG4gICAgICAgIC8vICAgICAgICAgICAgIGxldCB2YWx1ZSA9IGtleVZhbHVlQXJyWzFdO1xuICAgICAgICAvLyAgICAgICAgICAgICBvYmpba2V5XSA9IHZhbHVlO1xuICAgICAgICAvLyAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vICAgICAgICAgdGVzdERhdGEgPSBKU09OLnN0cmluZ2lmeShvYmopO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9XG5cbiAgICAgICBpZiAoIWNjLnN5cy5pc05hdGl2ZSl7XG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhjYy5zeXMubG9jYWxTdG9yYWdlLFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xMzVcIik7XG4gICAgICAgICAgLy9tYW5hZ2VyLnNldFVzZXJJbmZvKHRlc3REYXRhKTtcbiAgICAgICB9XG4gICAgfSxcblxuXG5cbiAgICBhZ3JlZW1lbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYWdyZWVtZW50Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAvL3RoaXMuYWdyZWVtZW50TGFiZWwuc3RyaW5nID0gY2MuaW5mbzE7XG4gICAgICAgIHRoaXMuYWdyZWVtZW50TGFiZWwubm9kZS55ID0gMDtcbiAgICB9LFxuXG4gICAgb25EZXN0cm95OiBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnNvY2tldC5yZWNldmljZU1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICB9LFxuXG4gICAgc2VuZExvZ2luUmVxdWVzdDpmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHRoaXMuc2hvd1dhaXRpbmdNZXNzYWdlKCfnmbvlvZXkuK0uLi4nKTtcbiAgICAgICAgdGhpcy5zb2NrZXQuc2VuZE1lc3NhZ2UoJ2xvZ2luJyxkYXRhKTtcbiAgICB9LFxuXG4gICAgbG9naW5BY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5zZWxlY3ROb2RlLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgIGlmICghY29tcC5zZWxlY3RlZCkge1xuICAgICAgICAgIHRoaXMuc2hvd01zZyA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnRQcmVmYWIpO1xuICAgICAgICAgIHRoaXMuY2FudmFzTm9kZS5hZGRDaGlsZCh0aGlzLnNob3dNc2cpO1xuICAgICAgICAgIGxldCBjb21wID0gdGhpcy5zaG93TXNnLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgICAvL2NvbXAuc2V0TWVzc2FnZSgn6K+35ZCM5oSP55So5oi35Y2P6K6uJyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICBpZiAoaW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKGluZm8pO1xuICAgICAgICAgIHRoaXMuc2VuZExvZ2luUmVxdWVzdChkYXRhKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZyhjYy5zeXMuaXNOYXRpdmUsXCLvvJ/vvJ/vvJ9cIik7XG4gICAgICAgIGlmICghY2Muc3lzLmlzTmF0aXZlKXtcbiAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiaHR0cHM6Ly9vcGVuLndlaXhpbi5xcS5jb20vY29ubmVjdC9vYXV0aDIvYXV0aG9yaXplP2FwcGlkPXd4OTEyOGQxMmU2OTlhYjZhNyZyZWRpcmVjdF91cmk9aHR0cCUzQSUyRiUyRnd3dy5ob25nZ2VmZW5nLmNuJTJGc3N6V2ViJTJGaW5kZXguaHRtbCZyZXNwb25zZV90eXBlPWNvZGUmc2NvcGU9c25zYXBpX3VzZXJpbmZvJnN0YXRlPVNUQVRFI3dlY2hhdF9yZWRpcmVjdFwiO1xuICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcImh0dHBzOi8vb3Blbi53ZWl4aW4ucXEuY29tL2Nvbm5lY3Qvb2F1dGgyL2F1dGhvcml6ZT9hcHBpZD13eDkxMjhkMTJlNjk5YWI2YTcmcmVkaXJlY3RfdXJpPWh0dHAlM0ElMkYlMkZ3d3cucGhwdmlkZW8uY24lMkZtb2JpbGUlMkZpbmRleC5odG1sJnJlc3BvbnNlX3R5cGU9Y29kZSZzY29wZT1zbnNhcGlfdXNlcmluZm8mc3RhdGU9U1RBVEUjd2VjaGF0X3JlZGlyZWN0XCI7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInd4TG9naW5cIik7Ly9JT1NcbiAgICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwid3hMb2dpblwiLCBcIigpVlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSxcblxuICAgIGxvZ2luWWtBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5zZWxlY3ROb2RlLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgIGlmICghY29tcC5zZWxlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5zaG93TXNnID0gY2MuaW5zdGFudGlhdGUodGhpcy5hbGVydFByZWZhYik7XG4gICAgICAgICAgICB0aGlzLmNhbnZhc05vZGUuYWRkQ2hpbGQodGhpcy5zaG93TXNnKTtcbiAgICAgICAgICAgIGxldCBjb21wID0gdGhpcy5zaG93TXNnLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgICAgIGNvbXAuc2V0TWVzc2FnZSgn6K+35ZCM5oSP55So5oi35Y2P6K6uJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRlc3REYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgdmFyIHRpbWUgPSBcIidcIit0ZXN0RGF0ZS50b0xvY2FsZVN0cmluZygpK1wiJ1wiO1xuICAgICAgICB2YXIgb3BlbmlkID0gbmV3IEJ1ZmZlcih0aW1lKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgICAgIHZhciB0ZXN0RGF0YSA9ICd7XCJvcGVuaWRcIjpcIicrb3BlbmlkKydcIixcIm5pY2tuYW1lXCI6XCLmuLjlrqJcIixcInNleFwiOjEsXCJsYW5ndWFnZVwiOlwiemhfQ05cIixcImNpdHlcIjpcIkNoYW5nc2hhXCIsXCJwcm92aW5jZVwiOlwiSHVuYW5cIixcImNvdW50cnlcIjpcIkNOXCIsXCJoZWFkaW1ndXJsXCI6XCJodHRwOlxcL1xcL3d4LnFsb2dvLmNuXFwvbW1vcGVuXFwvQlZ5ejRSOHE2cHVKaWJFdjFocnNhVG1JS1Foa2FUUzlGeXZjZXZ2QzVobHhGbmZPdXNwRGppY0cwR3R6eUpYT2hOVDdnMVdaRGVDRFFoblJkRU9nejNRTW5QMEY5aWJvUUd5XFwvMFwiLFwicHJpdmlsZWdlXCI6W119JztcbiAgICAgICAgLy9pZiAoIWNjLnN5cy5pc05hdGl2ZSAmJiB3aW5kb3cubG9jYXRpb24pIHtcbiAgICAgICAgICAgIGxldCBzZWFyY2ggPSAnICAnO1xuICAgICAgICAgICAgaWYgKHNlYXJjaCkge1xuICAgICAgICAgICAgICAgIGxldCBxdWVyeSA9IHNlYXJjaC5zdWJzdHJpbmcoMSk7XG4gICAgICAgICAgICAgICAgbGV0IGF0dHJzID0gcXVlcnkuc3BsaXQoJyYnKTtcbiAgICAgICAgICAgICAgICBsZXQgb2JqID0gSlNPTi5wYXJzZSh0ZXN0RGF0YSk7XG4gICAgICAgICAgICAgICAgYXR0cnMuZm9yRWFjaChmdW5jdGlvbiAoYXR0cikge1xuICAgICAgICAgICAgICAgICAgICBsZXQga2V5VmFsdWVBcnIgPSBhdHRyLnNwbGl0KCc9Jyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBrZXkgPSBrZXlWYWx1ZUFyclswXTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0ga2V5VmFsdWVBcnJbMV07XG4gICAgICAgICAgICAgICAgICAgIG9ialtrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGVzdERhdGEgPSBKU09OLnN0cmluZ2lmeShvYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICAvL31cblxuICAgICAgICAvL3ZhciBpbmZvID0gbWFuYWdlci5nZXRVc2VySW5mbygpO1xuICAgICAgICAvL2lmIChpbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZSh0ZXN0RGF0YSk7XG4gICAgICAgICAgICB0aGlzLnNlbmRMb2dpblJlcXVlc3QoZGF0YSk7XG4gICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgLy99ZWxzZXtcbiAgICAgICAgICAgIG1hbmFnZXIuc2V0VXNlckluZm8odGVzdERhdGEpO1xuICAgICAgICAvL31cblxuICAgIH0sXG5cbiAgICBzaG93V2FpdGluZ01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIGlmICh0aGlzLndhaXRpbmdOb2RlICE9IG51bGwgJiYgY2Muc3lzLmlzTmF0aXZlICYmIGNjLmlzVmFsaWQodGhpcy53YWl0aW5nTm9kZSkpIHtcbiAgICAgICAgICBpZiAobXNnID09IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmdldE1lc3NhZ2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5yZW1vdmVGcm9tUGFyZW50KCk7XG4gICAgICAgICAgICB0aGlzLndhaXRpbmdOb2RlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndhaXRpbmdOb2RlID0gY2MuaW5zdGFudGlhdGUodGhpcy53YWl0aW5nUHJlZmFiKTtcbiAgICAgICAgdGhpcy5jYW52YXNOb2RlLmFkZENoaWxkKHRoaXMud2FpdGluZ05vZGUpO1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMud2FpdGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgY29tcC5hbGVydCgpO1xuICAgIH0sXG5cbiAgICBoaWRkZW5XYWl0aW5nTWVzc2FnZTpmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMud2FpdGluZ05vZGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy53YWl0aW5nTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHByb3RvY29sQWN0aW9uOmZ1bmN0aW9uKCkge1xuICAgICAgICBjYy5sb2coJ3Byb3RvY29sIGFjdGlvbicpO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgbWFQYWlTcHJpdGU6W2NjLlNwcml0ZUZyYW1lXSxcclxuICAgICAgICBzcHJpdGVOb2RlOmNjLlNwcml0ZSxcclxuICAgICAgICBsYWJlbE5vZGU6Y2MuTm9kZVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIFxyXG4gICAgfSxcclxuXHJcbiAgICBcclxufSk7XHJcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xuICAgIHZlcnNpb246J3YxLjAuMCcsXG5cbiAgICBzZXRVc2VySW5mbzpmdW5jdGlvbihzdHIpIHtcbiAgICAgICAgY2Muc3lzLmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyaW5mbycsIHN0cik7XG4gICAgfSxcblxuICAgIGdldFVzZXJJbmZvOmZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJpbmZvJyk7XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgc2V0TXVzaWNWYWx1ZTpmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ211c2ljVm9sdW1uJyx2YWx1ZSk7XG4gICAgfSxcblxuICAgIGdldE11c2ljVmFsdWU6ZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbXVzaWNWb2x1bW4nKTtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBzZXRNdXNpY0VmZmVjdFZhbHVlOmZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbXVzaWNFZmZlY3RWb2x1bW4nLHZhbHVlKTtcbiAgICB9LFxuXG4gICAgZ2V0TXVzaWNFZmZlY3RWYWx1ZTpmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtdXNpY0VmZmVjdFZvbHVtbicpO1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbn07XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcclxuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcclxuY29uc3QgQXJyYXlFeHRlbnNpb24gPSByZXF1aXJlKCdBcnJheUV4dGVuc2lvbicpO1xyXG5jb25zdCBNYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xyXG5jb25zdCBBdWRpb01hbmFnZXIgPSByZXF1aXJlKCdBdWRpb01hbmFnZXInKTtcclxuY29uc3QgS1FOYXRpdmVJbnZva2UgPSByZXF1aXJlKCdLUU5hdGl2ZUludm9rZScpO1xyXG5jb25zdCBVc2VyTW9kZWxIZWxwZXIgPSByZXF1aXJlKCdVc2VyTW9kZWxIZWxwZXInKTtcclxuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xyXG5jb25zdCBmZWNoYSA9IHJlcXVpcmUoJ2ZlY2hhJyk7XHJcbi8qIyMjIyMqL1xyXG5jb25zdCBLUUNhcmQgPSByZXF1aXJlKCdLUUNhcmQnKTtcclxuLyoqL1xyXG5jb25zdCBQbGF5ZXIgPSByZXF1aXJlKCdQbGF5ZXInKTtcclxuLyoqL1xyXG4vL2NvbnN0IGlzVGVTaHVQYWkgPSByZXF1aXJlKCdpc1RlU2h1UGFpJyk7XHJcbi8v54m55q6K54mM57G75Z6LXHJcbnZhciBURVNIVVBBSVRZUEUgPSB7XHJcbiAgICBpc1RlU2h1UGFpOmZhbHNlLFxyXG4gICAgaXNMaXVEdWlCYW46ZmFsc2UsXHJcbiAgICBpc1NhblNodW5aaTpmYWxzZSxcclxuICAgIGlzU2FuVGFvSHVhOmZhbHNlLFxyXG5cclxuICAgIGlzUWluZ0xvbmc6ZmFsc2UsXHJcbiAgICBpc1lpVGlhb0xvbmc6ZmFsc2UsXHJcbiAgICBpc1NhblRvbmdIdWFTaHVuOmZhbHNlLFxyXG4gICAgaXNTYW5GZW5UaWFuWGlhOmZhbHNlLFxyXG4gICAgaXNDb3VZaVNlOmZhbHNlLFxyXG4gICAgaXNTaVRhb1NhblRpYW86ZmFsc2UsXHJcbiAgICBpc1d1RHVpU2FuVGlhbzpmYWxzZVxyXG59O1xyXG5cclxubGV0IEdBTUVTVEFUVVMgPSB7XHJcbiAgV0FJVF9QRU9QTEU6IDAsICAgIC8vIOetieS6ulxyXG4gIFdBSVRfUkVBRFk6IDEsICAgICAvLyDnrYnlvoXku5bkurrlh4blpIdcclxuICBQTEFZSU5HOiAyLCAgICAgICAgLy8g5q2j5Zyo546p5ri45oiPXHJcbn07XHJcblxyXG5cclxuLy8g5biD5bGAXHJcbi8vICAgICAgICAgIDJcclxuLy8gICAzICAgICAgICAgICAgMVxyXG4vLyAgICAgc2VsZiAwXHJcbmxldCBQbGF5ID0gY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBwbGF5ZXJOb2RlczogW2NjLk5vZGVdLFxyXG4gICAgICAgIGNoYXROb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZU5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgLyojIyMjIyovXHJcbiAgICAgICAgdHlwZUJ1dHRvbnNOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIC8qIyMjIyMqL1xyXG5cclxuICAgICAgICBsYWJlbFJvb21OdW1iZXI6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsT3ZlcnZpZXc6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxhYmVsUmVtYWluVGltZTogY2MuTGFiZWwsXHJcbiAgICAgICAgYnRuU2hhcmU6IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5SZWFkeTogY2MuQnV0dG9uLCAgICAgIC8vIOWHhuWkh+W8gOWni+aMiemSrlxyXG4gICAgICAgIGZhcGFpTm9kZTogY2MuTm9kZSxcclxuICAgICAgICBidG5DaGF0Vm9pY2U6IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5DaGF0VGV4dDogY2MuQnV0dG9uLFxyXG4gICAgICAgIHN0YXJ0Q29tcGFyZUNhcmRzTm9kZTogY2MuTm9kZSxcclxuICAgICAgICB2b2ljZVJlY29yZEFuaW1hdGlvbk5vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgc2V0dGluZ05vZGU6IGNjLk5vZGUsXHJcbiAgICAgICAgcGxheWJhY2tOb2RlOiBjYy5Ob2RlLFxyXG5cclxuICAgICAgICBvbmVHYW1lUmVzdWx0OiBjYy5Ob2RlLCAgIC8vIOS4gOWxgOe7k+aenFxyXG4gICAgICAgIHRvdGFsR2FtZVJlc3VsdDogY2MuTm9kZSxcclxuXHJcbiAgICAgICAgYWxlcnRSZXF1ZXN0RXhpdE5vZGU6IGNjLk5vZGUsICAvLyDnlLPor7fpgIDlh7ogTm9kZVxyXG4gICAgICAgIGFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlOiBjYy5Ob2RlLCAgLy8g55Sz6K+36YCA5Ye65YCS6K6h5pe2IE5vZGVcclxuICAgICAgICBidG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbjogY2MuQnV0dG9uLFxyXG4gICAgICAgIGJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b246IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5CdXR0b25Ob2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIGJ0bkJ1dHRvbnM6IGNjLk5vZGUsXHJcblxyXG4gICAgICAgIGFsZXJ0QW5zb3dlckV4aXROb2RlOiBjYy5Ob2RlLCAvLyDlm57nrZTnlLPor7fpgIDlh7ogIE5vZGVcclxuICAgICAgICBhbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZTogY2MuTm9kZSwgIC8vIOWbnuetlOS7peS4iuivt+mAgOWHuueahOWAkuiuoeaXtlxyXG5cclxuICAgICAgICBhbGVydDogY2MuTm9kZSxcclxuXHJcbiAgICAgICAgYWxlcnRGb3JjZUV4aXROb2RlOiBjYy5Ob2RlLCAgLy8g5by65Yi26YCA5Ye6IE5vZGVcclxuXHJcbiAgICAgICAgd2FpdGluZ1ByZWZhYjogY2MuUHJlZmFiLFxyXG4gICAgICAgIC8qKi9cclxuICAgICAgICBwbGF5ZXJDb21wczogW1BsYXllcl0sXHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIC8qIyMjIyMqL1xyXG4gICAgICAgIHRlc2h1cGFpX21pbjpbY2MuTm9kZV0sXHJcbiAgICAgICAgdGVzaHVwYWlfbWF4OltjYy5Ob2RlXSxcclxuICAgICAgICBnb25nWGlOaTpjYy5Ob2RlLFxyXG4gICAgICAgIHRlU2h1UGFpOmNjLk5vZGUsXHJcbiAgICAgICAgX2xpdUR1aUJhbjpmYWxzZSxcclxuICAgICAgICBfc2FuU2h1blppOmZhbHNlLFxyXG4gICAgICAgIF9zYW5Ub25nSHVhOmZhbHNlLFxyXG4gICAgICAgIF95aVRpYW9Mb25nOmZhbHNlLFxyXG5cclxuICAgICAgICBfUWluZ0xvbmc6ZmFsc2UsXHJcbiAgICAgICAgX1NhblRvbmdIdWFTaHVuOmZhbHNlLFxyXG4gICAgICAgIF9TYW5GZW5UaWFuWGlhOmZhbHNlLFxyXG4gICAgICAgIF9Db3VZaVNlOmZhbHNlLFxyXG4gICAgICAgIF9TaVRhb1NhblRpYW86ZmFsc2UsXHJcbiAgICAgICAgX1d1RHVpU2FuVGlhbzpmYWxzZSxcclxuXHJcbiAgICAgICAgd3VUb25nX2ltZzpjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICB0b25nSHVhU2h1bl9pbWc6Y2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgLyojIyMjIyovXHJcblxyXG4gICAgICAgIF9wbGF5ZXJDb21wb25lbnRzOiBudWxsLFxyXG4gICAgICAgIF9tc2dDb250cm9sOiBudWxsLFxyXG5cclxuICAgICAgICBfc29ja2V0OiBudWxsLFxyXG4gICAgICAgIF91c2VySWQ6IDAsXHJcbiAgICAgICAgX3BsYXllckluZm9zOiBudWxsLFxyXG4gICAgICAgIF9kZXNrSW5mbzogbnVsbCwgICAvLyBjcmVhdGVUaW1lIOWIm+W7uuaXtumXtCAgaXNEaXNzb2x2aW5nIOihqOekuuaYr+WQpuato+WcqOino+aVoyBkaXNzb2x2ZUxlZnRUaW1lIOemu+ino+aVo+WJqeS9meWkmumVv+aXtumXtCBkaXNzb2x2ZUFuc3dlckluZm8gW+WkhOeQhui/h+eahOS6uueahOS/oeaBr11cclxuICAgICAgICBfZ2FtZVN0YXR1czogR0FNRVNUQVRVUy5XQUlUX1BFT1BMRSxcclxuICAgICAgICBfZW50ZXJUaW1lOiBudWxsLFxyXG4gICAgICAgIF9wbGF5ZXJzOm51bGwsXHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIF9pc0NvbXBhcmluZ0NhcmRzTm93OiBmYWxzZSwgLy8g5piv5ZCm5q2j5Zyo5q+U54mMXHJcbiAgICAgICAgX3BsYXllZENvbXBhcmVDYXJkc0luZGV4czogW10sIC8vIOW3sue7j+aSreaUvui/h+avlOeJjOeahOWxgOaVsFxyXG4gICAgICAgIC8qKi9cclxuICAgIH0sXHJcblxyXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXHJcbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLkJ0bkNsaWNrR29uZ1hpTmlDb21maXJtID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmdldENvbXBvbmVudChcIkNhcmRUeXBlQ29tYmluZVwiKS5CdG5DbGlja0dvbmdYaU5pQ29tZmlybTtcclxuICAgICAgICB0aGlzLl9lbnRlclRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICB0aGlzLnBsYXllckNvbXBzLmZvckVhY2gocGxheWVyQ29tcCA9PiB7XHJcbiAgICAgICAgICAgIHBsYXllckNvbXAucGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzID0gdGhpcy5fcGxheWVkQ29tcGFyZUNhcmRzSW5kZXhzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICAvKkF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5RGVza011c2ljKCk7Ki9cclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2Uuc3RvcEhhbGxNdXNpYygpO1xyXG4gICAgICAgIHRoaXMuX2luaXRQbGF5ZXJDb21wb25lbnRzKCk7XHJcbiAgICAgICAgdGhpcy5faW5pdFNlbGVjdENhcmROb2RlKCk7XHJcbiAgICAgICAgdGhpcy5faW5pdE9uZUdhbWVSZXN1bHQoKTtcclxuICAgICAgICB0aGlzLl9yZW1haW5UaW1lU3RhcnRVcGRhdGUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xyXG4gICAgICAgIHRoaXMuX21zZ0NvbnRyb2wgPSB0aGlzLmNoYXROb2RlLmdldENvbXBvbmVudCgnTXNnQ29udHJvbCcpO1xyXG5cclxuICAgICAgICB0aGlzLnNldHRpbmdOb2RlLmdldENvbXBvbmVudChcIlNldHRpbmdcIikuaGlkZVN3aXRjaCgpO1xyXG4gICAgICAgIHRoaXMubGFiZWxSb29tTnVtYmVyLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVnaXN0ZXJWb2ljZU5vZGVFdmVudHMoKTtcclxuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XHJcblxyXG4gICAgICAgIC8qIyMjIyMqL1xyXG4gICAgICAgIHRoaXMuX2luaXRNYVBhaSgpO1xyXG4gICAgICAgIFBsYXkuaW5zdGFuY2VzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9nb25nWGlOaVNob3coZmFsc2UpO1xyXG4gICAgICAgIC8qIyMjIyMqL1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc0NvbnRhaW5QbGF5YmFja0RhdGFzKCkpIHtcclxuICAgICAgICAgIFBsYXliYWNrLmluc3RhbmNlLnN0YXJ0UGxheWJhY2soKTtcclxuICAgICAgICAgIHRoaXMucGxheWJhY2tOb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICB0aGlzLmJ0bkNoYXRWb2ljZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgLy90aGlzLmNhcmRzRnJvbUFycmF5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX2xvYWREZXNrSW5mbygpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHRoaXMuX3NvY2tldCA9IFNvY2tldC5pbnN0YW5jZTtcclxuXHJcbiAgICAgICAgLy8gdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vICAgLy8gdGhpcy5fc2hvd09uZUdhbWVSZXN1bHQoKTtcclxuICAgICAgICAvLyAgIC8vIHRoaXMuX3N0YXJ0Q29tcGFyZUNhcmRzKCk7XHJcbiAgICAgICAgLy8gfS5iaW5kKHRoaXMpLCAyKTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8qIyMjIyMqL1xyXG4gICAgLyrmmL7npLrpqazniYwqL1xyXG4gICAgX2luaXRNYVBhaTpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy9cIm1hcGFpXCLohJrmnKzkuIrmjILnnYDpqazniYznsr7ngbVcclxuICAgICAgICB2YXIgbWFQYWlDb20gPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KFwibWFQYWlcIik7XHJcbiAgICAgICAgdmFyIHNwcml0ZU5vZGUgPSBtYVBhaUNvbS5zcHJpdGVOb2RlOyAvL+mprOeJjOeyvueBteiKgueCuVxyXG4gICAgICAgIHZhciBsYWJlbE5vZGUgPSBtYVBhaUNvbS5sYWJlbE5vZGU7ICAgLy/pqazniYzmloflrZfoioLngrlcclxuICAgICAgICBpZih0aGlzLm1hUGFpICE9IG51bGwpIHtcclxuICAgICAgICAgICAgbGFiZWxOb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMubWFQYWkgPT0gMSl7XHJcbiAgICAgICAgICAgIHNwcml0ZU5vZGUuc3ByaXRlRnJhbWUgPSBtYVBhaUNvbS5tYVBhaVNwcml0ZVswXTtcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLm1hUGFpID09IDUpe1xyXG4gICAgICAgICAgICBzcHJpdGVOb2RlLnNwcml0ZUZyYW1lID0gbWFQYWlDb20ubWFQYWlTcHJpdGVbMV07XHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5tYVBhaSA9PSAxMCl7XHJcbiAgICAgICAgICAgIHNwcml0ZU5vZGUuc3ByaXRlRnJhbWUgPSBtYVBhaUNvbS5tYVBhaVNwcml0ZVsyXTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgc3ByaXRlTm9kZS5zcHJpdGVGcmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGxhYmVsTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9pbml0UGxheWVyQ29tcG9uZW50czogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMgPSB0aGlzLnBsYXllck5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRDb21wb25lbnQoJ1BsYXllcicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfaW5pdFNlbGVjdENhcmROb2RlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgbGV0IGNhcmRUeXBlQ29tYmluZUNvbXAgPSB0aGlzLmNhcmRUeXBlQ29tYmluZU5vZGUuZ2V0Q29tcG9uZW50KCdDYXJkVHlwZUNvbWJpbmUnKTtcclxuICAgICAgY2FyZFR5cGVDb21iaW5lQ29tcC5zZXRGaW5pc2hTZWxlY3RDYXJkc0NhbGxiYWNrKGZ1bmN0aW9uIChzZXJ2ZXJDYXJkc0luZm8pIHtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmVDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgU29ja2V0LnNlbmRQbGF5Q2FyZChzZWxmLl91c2VySWQsIHNlcnZlckNhcmRzSW5mbyk7XHJcbiAgICAgICAgc2VsZi5jYXJkVHlwZUNvbWJpbmVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICBfaW5pdE9uZUdhbWVSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICB0aGlzLm9uZUdhbWVSZXN1bHQuc2V0Q2xvc2VDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHNlbGYuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9LFxyXG4gICAgLyoqL1xyXG4gICAgLy9faW5pdE9uZUdhbWVSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgIC8vICB0aGlzLm9uZUdhbWVSZXN1bHQuc2V0Q2xvc2VDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vICAgIGlmIChzZWxmLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgLy8gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgIC8vICAgIH1cclxuICAgIC8vICB9O1xyXG4gICAgLy99LFxyXG5cclxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9mZlRhcmdldCh0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgY2xpY2tFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvICYmIHRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmiL/pl7Tlt7Lnu5PmnZ/vvIzlubbkuJTkuI3mmK/mraPlnKjmkq3mlL7miZPniYzliqjnlLssIOWImeebtOaOpeemu+W8gOaIv+mXtFxyXG4gICAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgLy9pZiAodGhpcy5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAvLyAgICB0aGlzLmFsZXJ0Rm9yY2VFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuYWxlcnQoKTtcclxuICAgICAgICAvLyAgICByZXR1cm47XHJcbiAgICAgICAgLy99XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fZGVza0luZm8uY3JlYXRlSWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICBTb2NrZXQuc2VuZERpc3NvbHZlRGVzayh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgU29ja2V0LnNlbmRMZWF2ZURlc2sodGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b24ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b24ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBhbGVydC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgICAgYWxlcnQuc2V0TWVzc2FnZShcIuaCqOWcqOeUs+ivt+WNj+WVhumAgOWHuu+8jOWmguaenOaJgOacieeOqeWutuWQjOaEj++8jOaCqOWwhumAgOWHuua4uOaIj+OAglwiKTtcclxuICAgICAgICBhbGVydC5hbGVydCgpO1xyXG5cclxuICAgICAgICB0aGlzLmFsZXJ0UmVxdWVzdEV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvL+eCueWHu+WIhuS6q+aMiemSrlxyXG4gICAgY2xpY2tTaGFyZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICBsZXQgcm9vbUlkID0gU3RyaW5nKHRoaXMuX2Rlc2tJbmZvLnJvb21JZCk7XHJcbiAgICAgIHZhciBkZXNjcmlwdGlvbiA9IFwi6YeR6bqf5Y2B5LiJ6YGTIOeOqeazlTpcIlxyXG4gICAgICAgICAgLy8rIHRoaXMuX2Rlc2tJbmZvR2FtZVdheSgpO1xyXG4gICAgICBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uICsgXCIgXCIgKyB0aGlzLl9kZXNrSW5mb051bWJlck9mUGVvcGxlKCk7XHJcbiAgICAgIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIixcIiArIHRoaXMuX2Rlc2tJbmZvUGF5SW5mbygpO1xyXG4gICAgICAgIC8vZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbiArIFwiLFwiICsgdGhpcy5fZGVza0luZm9KaWFZaVNlSW5mbygpO1xyXG4gICAgICAgIC8vZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbiArIFwiLFwiICsgdGhpcy5fZGVza0luZm9HdWlQYWlJbmZvKCk7XHJcbiAgICAgIGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gKyBcIiBcIiArIHRoaXMuX2Rlc2tJbmZvTnVtYmVyT2ZHYW1lKCk7XHJcblxyXG4gICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwid3hTaGFyZUZyaWVuZDpkZXNjcmlwdGlvbjpcIixyb29tSWQsIGRlc2NyaXB0aW9uKTtcclxuICAgICAgfSBlbHNlIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxyXG4gICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJ3eFNoYXJlRnJpZW5kXCIsIFwiKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylWXCIsIHJvb21JZCwgZGVzY3JpcHRpb24pO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8v54K55Ye75YeG5aSH5oyJ6ZKuXHJcbiAgICBjbGlja1JlYWR5OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAvKiMjIyMj54K55Ye75YeG5aSH55qE5pe25YCZ77yM5LiK5LiA5bGA5q+U54mM55qE5pWw5o2u5raI5aSxKi9cclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICAvL3BsYXllckNvbXAucmVzZXQoKTtcclxuICAgICAgICAgIHBsYXllckNvbXAucmVzZXQoKTsgIC8vIyMjIyNcclxuICAgICAgfSk7XHJcbiAgICAgIGNjLmZpbmQoXCJDYW52YXMvc2hvd19yZXN1bHRcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIFNvY2tldC5zZW5kUmVhZHkodGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlUm9vbU51bWJlcjogZnVuY3Rpb24gKHJvb21OdW1iZXIpIHtcclxuICAgICAgICBsZXQgZ2FtZU51bWJlclN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxICE9IDAgJiYgdGhpcy5fZGVza0luZm8uc2V0dGluZzEgIT0gMSkge1xyXG4gICAgICAgICAgICBnYW1lTnVtYmVyU3RyaW5nID0gXCLlsYDmlbAgOiBcIiArIFwiXCIgKyB0aGlzLl9kZXNrSW5mby5jSW5kZXggKyBcIi9cIiArIHRoaXMuX2Rlc2tJbmZvLm1NYXg7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSA9PSAwKSB7XHJcbiAgICAgICAgICAgIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IDEw5bGAXCI7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSA9PSAxKSB7XHJcbiAgICAgICAgICAgIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IDIw5bGAXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICB0aGlzLmxhYmVsUm9vbU51bWJlci5zdHJpbmcgPSBcIuaIv+WPtyA6IFwiICsgXCJcIiArIHJvb21OdW1iZXIgKyBcIlxcblwiICsgZ2FtZU51bWJlclN0cmluZztcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlR2FtZVN0YXR1czogZnVuY3Rpb24gKHN0YXR1cyA9IEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUpIHtcclxuICAgICAgdGhpcy5fZ2FtZVN0YXR1cyA9IHN0YXR1cztcclxuXHJcbiAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSAoc3RhdHVzID09IEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUpO1xyXG4gICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gKHN0YXR1cyA9PSBHQU1FU1RBVFVTLldBSVRfUkVBRFkpO1xyXG4gICAgICAgIHRoaXMuaXNSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgIC8vaWYgKHN0YXR1cyA9PSBHQU1FU1RBVFVTLlBMQVlJTkcpIHtcclxuICAgICAgLy8gIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJDb21wKXtcclxuICAgICAgLy8gICAgLy9wbGF5ZXJDb21wLmhpZGVSZWFkeVN0YXR1cygpO1xyXG4gICAgICAvLyAgfSk7XHJcbiAgICAgIC8vfVxyXG4gICAgfSxcclxuXHJcbiAgICBnYW1lU3RhdHVzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9nYW1lU3RhdHVzO1xyXG4gICAgfSxcclxuICAgIGlzUmVhZHlTdGF0dXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuX3BsYXllckluZm9zKVxyXG4gICAgICAgIGlmKHRoaXMuX3BsYXllckluZm9zICYmIHRoaXMuX3BsYXllckluZm9zLmxlbmd0aD4wKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BsYXllckluZm9zLmZvckVhY2goZnVuY3Rpb24ocGxheWVySW5mbyl7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlckluZm9TZWxmPWNjLmZpbmQoJ0NhbnZhcy9wbGF5U2VsZi91c2VySW5mb1NlbGYnKTtcclxuICAgICAgICAgICAgICAgIGlmKHBsYXllckluZm8uaWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIXBsYXllckluZm8ucmVhZHlTdGF0dXMgJiYgIXRoaXMuX2lzQ29tcGFyaW5nQ2FyZHNOb3cgJiYgIVBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNDb250YWluUGxheWJhY2tEYXRhcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJbmZvU2VsZi5nZXRDb21wb25lbnQoJ3VzZXJJbmZvJykuc2V0UmVhZHlOb2RlVmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5jSW5kZXggPT0gMCkgey8v5LiA5bGA6L+Y5rKh5byA5aeLXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZUlkICE9IHRoaXMuX3VzZXJJZCl7Ly8vL+aYr+WQpuaYr+aIv+S4u1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5wbGF5ZXJzLmxlbmd0aCA8IHRoaXMuX2Rlc2tJbmZvLm1heE51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgb25lR2FtZVJlc3VsdCA9IHRoaXMub25lR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ0dhbWVSZXN1bHQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uZUdhbWVSZXN1bHQudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25lR2FtZVJlc3VsdC5zaG93UmVzdWx0cyh0aGlzLl9kZXNrSW5mbywgdGhpcy5fdXNlcklkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuacquabvuWHhuWkh1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idG5TaGFyZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYy5maW5kKFwiQ2FudmFzL3Nob3dfcmVzdWx0XCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZighdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlckluZm9TZWxmLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRSZWFkeU5vZGVWaXNpYmxlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXNlckluZm9TZWxmLmdldENvbXBvbmVudCgndXNlckluZm8nKS5zZXRSZWFkeU5vZGVWaXNpYmxlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbihwbGF5ZXJDb21wKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJDb21wLmhpZGVSZWFkeVN0YXR1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLlt7Llh4blpIdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvLy8g5ri45oiP5Yqo55S7XHJcbiAgICBfc3RhcnRHYW1lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlmICh0aGlzLmdhbWVTdGF0dXMoKSA9PSBHQU1FU1RBVFVTLlBMQVlJTkcpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgICB0aGlzLl9pc0NvbXBhcmluZ0NhcmRzTm93ID0gdHJ1ZTtcclxuICAgICAgdGhpcy51cGRhdGVHYW1lU3RhdHVzKEdBTUVTVEFUVVMuUExBWUlORyk7XHJcbiAgICAgIHRoaXMuX3BsYXlGYVBhaUFuaW1hdGlvbigpO1xyXG5cclxuICAgICAgaWYgKCFVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyh0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHRoaXMuX3VzZXJJZCkpKSB7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgdGhpcy5fc2hvd0NhcmRUeXBlQ29tYmluZSgpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSwgMS4wKTtcclxuXHJcbiAgICAgICAgLy9sZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgLy8gIC8vdGhpcy5mYXBhaU5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcbiAgICAgICAgLy8gIHNlbGYuZmFwYWlOb2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gIHZhciBhbmltID0gdGhpcy5mYXBhaU5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgLy8gIGFuaW0ucGxheSgnZmFwYWknKTtcclxuICAgICAgICAvL3RoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyAgc2VsZi5mYXBhaU5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy99LCAyLjApO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBfcGxheUZhUGFpQW5pbWF0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKXtcclxuICAgICAgICBwbGF5ZXIucGxheUZhUGFpQW5pbWF0aW9uKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlGYVBhaSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIC8v5piv5ZCm54m55q6K54mMXHJcbiAgICBpc1RlU2h1UGFpOiBmdW5jdGlvbihjYXJkcyl7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1RlU2h1UGFpKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNUZVNodVBhaSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1RlU2h1UGFpID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbkuIDmnaHpvplcclxuICAgIGlzWWlUaWFvTG9uZzogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzWWlUaWFvTG9uZyhjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzWWlUaWFvTG9uZyA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1lpVGlhb0xvbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuWFreWvueWNilxyXG4gICAgaXNMaXVEdWlCYW46IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc0xpdUR1aUJhbihjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzTGl1RHVpQmFuID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzTGl1RHVpQmFuID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5LiJ6aG65a2QXHJcbiAgICBpc1NhblNodW5aaTogZnVuY3Rpb24oY2FyZHMpe1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTYW5TaHVuWmkoY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblNodW5aaSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblNodW5aaSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuS4ieWQjOiKsVxyXG4gICAgaXNTYW5Ub25nSHVhOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNTYW5Ub25nSHVhKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5UYW9IdWEgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5UYW9IdWEgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbkuInlkIzoirHpobpcclxuICAgIGlzU2FuVG9uZ0h1YVNodW46IGZ1bmN0aW9uKGNhcmRzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IEtRQ2FyZC5pc1NhblRvbmdIdWFTaHVuKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTYW5Ub25nSHVhU2h1biA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhblRvbmdIdWFTaHVuID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIC8v5piv5ZCm5piv5riF6b6ZXHJcbiAgICBpc1FpbmdMb25nOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNRaW5nTG9uZyhjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzUWluZ0xvbmcgPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNRaW5nTG9uZyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYryDigJzkuInliIblpKnkuIvigJ1cclxuICAgIGlzU2FuRmVuVGlhblhpYTogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2FuRmVuVGlhblhpYShjYXJkcyk7XHJcbiAgICAgICAgaWYocmVzdWx0KXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzU2FuRmVuVGlhblhpYSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1NhbkZlblRpYW5YaWEgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK8g4oCc5Zub5aWX5LiJ5p2h4oCdXHJcbiAgICBpc1NpVGFvU2FuVGlhbzogZnVuY3Rpb24oY2FyZHMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gS1FDYXJkLmlzU2lUYW9TYW5UaWFvKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTaVRhb1NhblRpYW8gPSB0cnVlO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNTaVRhb1NhblRpYW8gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLy/mmK/lkKbmmK/kupTlr7nkuInmnaFcclxuICAgIGlzV3VEdWlTYW5UaWFvOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNXdUR1aVNhblRpYW8oY2FyZHMpO1xyXG4gICAgICAgIGlmKHJlc3VsdCl7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1d1RHVpU2FuVGlhbyA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIFRFU0hVUEFJVFlQRS5pc1d1RHVpU2FuVGlhbyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvL+aYr+WQpuaYr+WHkeS4gOiJslxyXG4gICAgaXNDb3VZaVNlOiBmdW5jdGlvbihjYXJkcykge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBLUUNhcmQuaXNDb3VZaVNlKGNhcmRzKTtcclxuICAgICAgICBpZihyZXN1bHQpe1xyXG4gICAgICAgICAgICBURVNIVVBBSVRZUEUuaXNDb3VZaVNlID0gdHJ1ZTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgVEVTSFVQQUlUWVBFLmlzQ291WWlTZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKiMjIyMjKi9cclxuXHJcbiAgICAvKuaYvuekuumFjeeJjOmhtemdoiovXHJcbiAgICBfc2hvd0NhcmRUeXBlQ29tYmluZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGNhcmRUeXBlQ29tYmluZSA9IHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5nZXRDb21wb25lbnQoJ0NhcmRUeXBlQ29tYmluZScpO1xyXG4gICAgICAgIGNhcmRUeXBlQ29tYmluZS5yZWxvYWRDYXJkcyhbXSk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBjYXJkVHlwZUNvbWJpbmUudGltZVN0YXJ0KDEyMCk7Ly9zZFxyXG5cclxuICAgICAgICBsZXQgY2FyZHMgPSB0aGlzLl9maW5kQ2FyZHNCeVVzZXJJZCh0aGlzLl91c2VySWQpO1xyXG4gICAgICAgIC8vY2FyZHMgPSBbe3N1aXQ6IFwiY1wiLCBudW1iZXI6MjB9LHtzdWl0OiBcImRcIiwgbnVtYmVyOjEyfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTJ9LC8v6Z2S6b6ZXHJcbiAgICAgICAgLy8gICAge3N1aXQ6IFwiY1wiLCBudW1iZXI6MTJ9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoxMH0sXHJcbiAgICAgICAgLy8gICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6MTB9LCB7c3VpdDogXCJoXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6Nn0sXHJcbiAgICAgICAgLy8gICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6Nn0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjV9LFxyXG4gICAgICAgIC8vICAgIHtzdWl0OiBcInNcIiwgbnVtYmVyOjJ9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6Mn0sXTtcclxuICAgICAgICAvKmlmKHRoaXMuX3VzZXJJZCA9PSAxKXtcclxuICAgICAgICAgICAgY2FyZHMgPSBbe3N1aXQ6IFwic1wiLCBudW1iZXI6M30se3N1aXQ6IFwic1wiLCBudW1iZXI6Nn0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjd9LC8v6Z2S6b6ZXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJzXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTN9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6MTB9LCB7c3VpdDogXCJoXCIsIG51bWJlcjoxMn0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjEzfSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjJ9LCB7c3VpdDogXCJkXCIsIG51bWJlcjo1fSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjN9LCB7c3VpdDogXCJkXCIsIG51bWJlcjo3fSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6OH0sXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl91c2VySWQgPT0gMil7XHJcbiAgICAgICAgICAgIGNhcmRzID0gW3tzdWl0OiBcInNcIiwgbnVtYmVyOjF9LHtzdWl0OiBcInNcIiwgbnVtYmVyOjJ9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoyfSwvL+mdkum+mVxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6NH0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjR9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiZFwiLCBudW1iZXI6Nn0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjZ9LCB7c3VpdDogXCJoXCIsIG51bWJlcjo5fSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImNcIiwgbnVtYmVyOjl9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoxMH0sXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJjXCIsIG51bWJlcjoxMH0sIHtzdWl0OiBcImNcIiwgbnVtYmVyOjEyfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6MTJ9LF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fdXNlcklkID09IDMpe1xyXG4gICAgICAgICAgICBjYXJkcyA9IFt7c3VpdDogXCJjXCIsIG51bWJlcjoxfSx7c3VpdDogXCJoXCIsIG51bWJlcjozfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTJ9LC8v6Z2S6b6ZXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJoXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6M30sXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjo0fSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6NX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjZ9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiaFwiLCBudW1iZXI6OH0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjh9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6MTF9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoxMX0sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjExfSxdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX3VzZXJJZCA9PSA0KXtcclxuICAgICAgICAgICAgY2FyZHMgPSBbe3N1aXQ6IFwiY1wiLCBudW1iZXI6MTF9LHtzdWl0OiBcImRcIiwgbnVtYmVyOjEzfSwge3N1aXQ6IFwiZFwiLCBudW1iZXI6MTF9LC8v6Z2S6b6ZXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJkXCIsIG51bWJlcjoxfSwge3N1aXQ6IFwiaFwiLCBudW1iZXI6MX0sXHJcbiAgICAgICAgICAgICAgICB7c3VpdDogXCJjXCIsIG51bWJlcjoyfSwge3N1aXQ6IFwic1wiLCBudW1iZXI6NH0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjl9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwiY1wiLCBudW1iZXI6N30sIHtzdWl0OiBcImhcIiwgbnVtYmVyOjd9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6NX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjV9LCB7c3VpdDogXCJjXCIsIG51bWJlcjo1fSxdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX3VzZXJJZCA9PSA1KXtcclxuICAgICAgICAgICAgY2FyZHMgPSBbe3N1aXQ6IFwiZFwiLCBudW1iZXI6NH0se3N1aXQ6IFwiZFwiLCBudW1iZXI6MTN9LCB7c3VpdDogXCJzXCIsIG51bWJlcjoxM30sLy/pnZLpvplcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjZ9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo3fSxcclxuICAgICAgICAgICAgICAgIHtzdWl0OiBcImRcIiwgbnVtYmVyOjh9LCB7c3VpdDogXCJjXCIsIG51bWJlcjo5fSwge3N1aXQ6IFwiY1wiLCBudW1iZXI6MTB9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6MX0sIHtzdWl0OiBcInNcIiwgbnVtYmVyOjN9LFxyXG4gICAgICAgICAgICAgICAge3N1aXQ6IFwic1wiLCBudW1iZXI6MTB9LCB7c3VpdDogXCJzXCIsIG51bWJlcjo4fSwge3N1aXQ6IFwic1wiLCBudW1iZXI6MTJ9LF07XHJcbiAgICAgICAgfSovXHJcblxyXG4gICAgICAgIGxldCBjYXJkTmFtZXMgPSB0aGlzLl9jb252ZXJ0Q2FyZHNUb0NhcmROYW1lcyhjYXJkcyk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLnJlbG9hZENhcmRzKGNhcmROYW1lcyk7XHJcbiAgICAgICAgY2FyZFR5cGVDb21iaW5lLmFkZENhcmRNb2RlcyhjYXJkTmFtZXMpO1xyXG5cclxuICAgICAgICAvKiMjIyMj5Y+R54mM5a6M5omn6KGMKi9cclxuXHJcbiAgICAgICAgLy9jYXJkczpbeydudW1iZXInOjF+MTMsJ3N1aXQnOidzJyB8ICdoJyB8ICdjJyB8ICdkJ31dXHJcbiAgICAgICAgLy9jYy5mcm9tLm1vc2hpID09IDDpgInmi6nkuobluoTlrrbmqKHlvI9cclxuICAgICAgICBpZihjYy5tb3NoaSAhPSAxKXtcclxuICAgICAgICAgICAgdGhpcy5pc1RlU2h1UGFpKGNhcmRzKTtcclxuICAgICAgICAgICAgdGhpcy5pc1lpVGlhb0xvbmcoY2FyZHMpO1xyXG4gICAgICAgICAgICB0aGlzLmlzUWluZ0xvbmcoY2FyZHMpO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXNMaXVEdWlCYW4oY2FyZHMpO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXNTYW5TaHVuWmkoY2FyZHMpO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXNTYW5Ub25nSHVhKGNhcmRzKTtcclxuICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgLy90aGlzLmlzU2FuVG9uZ0h1YVNodW4oY2FyZHMpO1xyXG4gICAgICAgICAgICAvL3RoaXMuaXNTYW5GZW5UaWFuWGlhKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzU2lUYW9TYW5UaWFvKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzV3VEdWlTYW5UaWFvKGNhcmRzKTtcclxuICAgICAgICAgICAgLy90aGlzLmlzQ291WWlTZShjYXJkcyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9zaG93R29uZ1hpTmlBbmRCdG5UZVNodVBhaSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYy50ZVNodVBhaUNhcmRzID0gJyc7XHJcbiAgICAgICAgaWYoVEVTSFVQQUlUWVBFLmlzVGVTaHVQYWkpe1xyXG4gICAgICAgICAgICAvL+WmguaenOaYr+eJueauiueJjOWwhueJjOWtmOi1t+adpVxyXG4gICAgICAgICAgICBjYy50ZVNodVBhaUNhcmRzID0gY2FyZHM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgLyojIyMjIyovXHJcbiAgICB9LFxyXG5cclxuICAgIGdldElzVGVTaHVQYWk6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICB2YXIgY2FyZHMgPSB0aGlzLl9maW5kQ2FyZHNCeVVzZXJJZCh1c2VySWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlzVGVTaHVQYWkoY2FyZHMpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMj5qOA5rWL54m55q6K54mM57G75Z6L77yM5pi+56S655u45a+55bqU55qE5oGt5Zac5L2g6aG16Z2i5ZKM54m55q6K54mM57K+54G1Ki9cclxuICAgIF9zaG93R29uZ1hpTmlBbmRCdG5UZVNodVBhaTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8q5aaC5p6c5pyJ54m55q6K54mMKi9cclxuICAgICAgICBpZihURVNIVVBBSVRZUEUuaXNUZVNodVBhaSl7XHJcbiAgICAgICAgICAgIGlmKFRFU0hVUEFJVFlQRS5pc1lpVGlhb0xvbmcpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5feWlUaWFvTG9uZyA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZihURVNIVVBBSVRZUEUuaXNRaW5nTG9uZyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zYW5Ub25nSHVhID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzTGl1RHVpQmFuKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9saXVEdWlCYW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NhblNodW5aaSl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fc2FuU2h1blppID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIC8vZWxzZSBpZihURVNIVVBBSVRZUEUuaXNTYW5UYW9IdWEpe1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9nb25nWGlOaVNob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX3NhblRvbmdIdWEgPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1NhblRvbmdIdWFTaHVuKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9TYW5Ub25nSHVhU2h1biA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2FuRmVuVGlhblhpYSl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fU2FuRmVuVGlhblhpYSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzQ291WWlTZSl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fQ291WWlTZSA9IHRydWU7XHJcbiAgICAgICAgICAgIC8vfVxyXG4gICAgICAgICAgICAvL2Vsc2UgaWYoVEVTSFVQQUlUWVBFLmlzU2lUYW9TYW5UaWFvKXtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fZ29uZ1hpTmlTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAvLyAgICB0aGlzLl9TaVRhb1NhblRpYW8gPSB0cnVlO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICAgICAgLy9lbHNlIGlmKFRFU0hVUEFJVFlQRS5pc1d1RHVpU2FuVGlhbyl7XHJcbiAgICAgICAgICAgIC8vICAgIHRoaXMuX2dvbmdYaU5pU2hvdyh0cnVlKTtcclxuICAgICAgICAgICAgLy8gICAgdGhpcy5fV3VEdWlTYW5UaWFvID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9nb25nWGlOaVNob3coZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2luaXRUZVNodVBhaVNwcml0ZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMj5o6n5Yi254m55q6K54mM57K+54G155qE5pi+56S6Ki9cclxuICAgIF9pbml0VGVTaHVQYWlTcHJpdGU6ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8q5oqK5omA5pyJ55qE54m55q6K54mM57K+54G16YO96ZqQ6JeP5o6JKi9cclxuICAgICAgICBmb3IodmFyIGk9MDtpPHRoaXMudGVzaHVwYWlfbWluLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21pbltpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9tYXhbaV0uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5LiA5p2h6b6Z77yM5bCx5pi+56S65LiA5p2h6b6Z55qE57K+54G1Ki9cclxuICAgICAgICBpZih0aGlzLl95aVRpYW9Mb25nKXtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9taW5bM10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9tYXhbM10uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyrlpoLmnpzmmK/lha3lr7nljYrlsLHmmL7npLrlha3lr7nljYrnmoTnsr7ngbUqL1xyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fbGl1RHVpQmFuKXtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9taW5bMF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9tYXhbMF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyrlpoLmnpzmmK/kuInpobrlrZDlsLHmmL7npLrkuInpobrlrZDnmoTnsr7ngbUqL1xyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fc2FuU2h1blppKXtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9taW5bMV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9tYXhbMV0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fc2FuVG9uZ0h1YSl7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzJdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzJdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX1FpbmdMb25nKXtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9taW5bNF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9tYXhbNF0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fU2FuVG9uZ0h1YVNodW4pe1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21pbls1XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnRlc2h1cGFpX21heFs1XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKuWmguaenOaYr+S4ieWQjOiKse+8jOWwseaYvuekuuS4ieWQjOiKseeahOeyvueBtSovXHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9TYW5GZW5UaWFuWGlhKXtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9taW5bNl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy50ZXNodXBhaV9tYXhbNl0uYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyrlpoLmnpzmmK/kuInlkIzoirHvvIzlsLHmmL7npLrkuInlkIzoirHnmoTnsr7ngbUqL1xyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fQ291WWlTZSl7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzddLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzddLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX1NpVGFvU2FuVGlhbyl7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzhdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzhdLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8q5aaC5p6c5piv5LiJ5ZCM6Iqx77yM5bCx5pi+56S65LiJ5ZCM6Iqx55qE57K+54G1Ki9cclxuICAgICAgICBlbHNlIGlmKHRoaXMuX1d1RHVpU2FuVGlhbyl7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWluWzldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMudGVzaHVwYWlfbWF4WzldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKiMjIyMjKi9cclxuICAgIC8v5pi+56S6Z29uZ1hpTmkg6aG16Z2i5ZKMdGVTaHVQYWlcclxuICAgIF9nb25nWGlOaVNob3c6ZnVuY3Rpb24gKHN0YXR1ZXMpIHtcclxuICAgICAgICB2YXIgYWx0ZXJDb20gPSB0aGlzLmdvbmdYaU5pLmdldENvbXBvbmVudChcImFsZXJ0XCIpO1xyXG4gICAgICAgIGlmKHN0YXR1ZXMpe1xyXG4gICAgICAgICAgICBhbHRlckNvbS5hbGVydCgpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBhbHRlckNvbS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnRlU2h1UGFpLmFjdGl2ZSA9IHN0YXR1ZXM7XHJcbiAgICB9LFxyXG4gICAgLyojIyMjIyovXHJcblxyXG4gICAgLy8gIOe7k+aenOebuOWFs1xyXG4gICAgLy8g5pi+56S65LiA5bGA57uT5p6cXHJcbiAgICBfc2hvd09uZUdhbWVSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyA9IGZhbHNlO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgdGhpcy51cGRhdGVHYW1lU3RhdHVzKEdBTUVTVEFUVVMuV0FJVF9QRU9QTEUpO1xyXG4gICAgICBsZXQgb25lR2FtZVJlc3VsdCA9IHRoaXMub25lR2FtZVJlc3VsdC5nZXRDb21wb25lbnQoJ0dhbWVSZXN1bHQnKTtcclxuICAgICAgb25lR2FtZVJlc3VsdC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgIG9uZUdhbWVSZXN1bHQuc2hvd1Jlc3VsdHModGhpcy5fZGVza0luZm8sIHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgIHRoaXMuX3VwZGF0ZVVzZXJTY29yZXMoKTtcclxuICAgICAgdGhpcy5fdXBkYXRlQmFua2VyKCk7XHJcblxyXG4gICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHNlbGYuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgLy9wbGF5ZXJDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgICAvL3BsYXllckNvbXAucmVzZXQyKCk7ICAvLyMjIyMjXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghc2VsZi5faXNSYW5kb21Sb29tKCkpIHtcclxuICAgICAgICAgICAgLy9pZiAoc2VsZi5fZGVza0luZm8uY0luZGV4ID09IDApIHsvL+S4gOWxgOi/mOayoeW8gOWni1xyXG4gICAgICAgICAgICAvLyAgICBzZWxmLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICBpZiAoc2VsZi5faXNUb3RhbEdhbWVPdmVyKCkpIHtcclxuICAgICAgICAgICAgc2VsZi5fc2hvd1RvdGFsR2FtZVJlc3VsdCgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSwgMC41KTtcclxuXHJcbiAgICAgIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSB8fCBQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICBvbmVHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdoYWxsJyk7XHJcbiAgICAgICAgICB9LCAyKTtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYvuekuuaAu+e7k+aenFxyXG4gICAgX3Nob3dUb3RhbEdhbWVSZXN1bHQ6IGZ1bmN0aW9uIChzaG93RGVsYXkgPSAyKSB7XHJcbiAgICAgICAgY2MuZmluZChcIkNhbnZhcy9zaG93X3Jlc3VsdFwiKS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdE5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICBsZXQgdG90YWxHYW1lUmVzdWx0Q29tcCA9IHRoaXMudG90YWxHYW1lUmVzdWx0LmdldENvbXBvbmVudCgnVG90YWxHYW1lUmVzdWx0Jyk7XHJcbiAgICAgIHRvdGFsR2FtZVJlc3VsdENvbXAuc2V0UGxheWVySW5mb3ModGhpcy5fZGVza0luZm8ucGxheWVycywgdGhpcy5fZGVza0luZm8pO1xyXG5cclxuICAgICAgbGV0IGFsZXJ0ID0gdGhpcy50b3RhbEdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5vbmVHYW1lUmVzdWx0LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vYWxlcnQuYWxlcnQoKTtcclxuICAgICAgICAgIC8qKi9cclxuICAgICAgICAgIGlmICghdGhpcy50b3RhbEdhbWVSZXN1bHQuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgICAgYWxlcnQuYWxlcnQoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8qKi9cclxuICAgICAgfS5iaW5kKHRoaXMpLCBzaG93RGVsYXkpO1xyXG5cclxuICAgICAgYWxlcnQuc2V0RGlzbWlzc0NhbGxiYWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIE1BUks6IFNvY2tldCDnm7jlhbNcclxuICAgIF9sb2FkRGVza0luZm86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgU29ja2V0LnNlbmRHZXREZXNja0luZm8odGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcbiAgICBfcmVnaXN0ZXJTb2NrZXRFdmVudDogZnVuY3Rpb24gKCkge1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlRGVza0luZm8sIHRoaXMuX3NvY2tldFJlY2VpdmVEZXNrSW5mbywgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVPbmxpbmVTdGF0dXMsIHRoaXMuX3NvY2tldFJlY2l2ZU9ubGluZVN0YXR1cywgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVDaGF0VGV4dCwgdGhpcy5fc29ja2V0UmVjaXZlQ2hhdFRleHRNZXNzYWdlLCB0aGlzKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVJlcXVlc3REaXNzb2x2ZSwgdGhpcy5fc29ja2V0UmVjZWl2ZVJlcXVlc3RFeGl0TWVzc2FnZSwgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVSZXF1ZXN0RGlzc29sdmVSZXN1bHQsIHRoaXMuX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdFJlc3VsdE1lc3NhZ2UsIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlQXVkaW9NZXNzYWdlLCB0aGlzLl9zb2NrZXRSZWNlaXZlQXVkaW9NZXNzYWdlLCB0aGlzKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZVBsYXlDYXJkLCB0aGlzLl9zb2NrZXRSZWNlaXZlUGxheUNhcmQsIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlR2FtZU92ZXIsIHRoaXMuX3NvY2tldFJlY2VpdmVHYW1lT3ZlciwgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVGYVBhaSwgdGhpcy5fc29ja2V0UmVjaXZlRmFQYWksIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5SZWNlaXZlUmVhZHksIHRoaXMuX3NvY2tldFJlY2l2ZVJlYWR5LCB0aGlzKTtcclxuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURpc3NvbHZlRGVzaywgdGhpcy5fc29ja2V0UmVjZWl2ZURpc3NvbHZlRGVzaywgdGhpcyk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVMZWF2ZURlc2ssIHRoaXMuX3NvY2tldExlYXZlRGVzaywgdGhpcyk7XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlNvY2tldERpc2Nvbm5lY3QsIHRoaXMuX3JlY2VpdmVTb2NrZXRDb25uZWN0RXJyb3IsIHRoaXMpO1xyXG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0U3VjY2Vzc2VkLCB0aGlzLl9yZWNlaXZlU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgdGhpcyk7XHJcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LlJlY2VpdmVQYXVzZSwgdGhpcy5fc29ja2V0UmVjZWl2ZVBhdXNlLCB0aGlzKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVEZXNrSW5mbzogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgY2MuZXJyb3IoXCLplJnor6/vvJpcIiwgcmVzcG9uc2UpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgIC8qIyMjIyPmt7vliqDkupTlkIzmjInpkq4qL1xyXG4gICAgICAgIGNjLm1vc2hpID0gcmVzcG9uc2UuZGF0YS5zZXR0aW5nMztcclxuICAgICAgICBpZihkYXRhLnNldHRpbmc4ICE9IG51bGwpe1xyXG4gICAgICAgICAgICBjYy5tb3NoaSA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLm1hUGFpID0gcmVzcG9uc2UuZGF0YS5tYVBhaTtcclxuICAgICAgY2MuZHVvWWlTZSA9IHJlc3BvbnNlLmRhdGEuc2V0dGluZzc7ICAgLy9zZXR0aW5nN+S4uiAgMCB8fCBudWxsICAw5bCx5piv6YCJ5oup5LqG5aSa5LiA6ImyXHJcbiAgICAgIC8qaWYoY2MuZHVvWWlTZSA9PSAwKXtcclxuICAgICAgICAgIHRoaXMuYnRuV3VUb25nID0gbmV3IGNjLk5vZGUoKTsgLy/liJvlu7rkuIDkuKroioLngrnlr7nosaFcclxuICAgICAgICAgIHRoaXMuYnRuV3VUb25nLmFkZENvbXBvbmVudChjYy5TcHJpdGUpOyAvL+a3u+WKoOeyvueBtee7hOS7tlxyXG4gICAgICAgICAgdGhpcy5idG5XdVRvbmcuYWRkQ29tcG9uZW50KGNjLkJ1dHRvbik7IC8v5re75YqgQnV0dG9u57uE5Lu2XHJcbiAgICAgICAgICB2YXIgYnRuU3ByaXRlID0gdGhpcy5idG5XdVRvbmcuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSk7XHJcbiAgICAgICAgICBidG5TcHJpdGUuc3ByaXRlRnJhbWUgPSB0aGlzLnd1VG9uZ19pbWc7XHJcbiAgICAgICAgICB0aGlzLmJ0bld1VG9uZy5uYW1lID0gXCJidG5XdVRvbmdcIjtcclxuICAgICAgICAgIGlmKCF0aGlzLnR5cGVCdXR0b25zTm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0bld1VG9uZ1wiKSl7XHJcbiAgICAgICAgICAgICAgdGhpcy50eXBlQnV0dG9uc05vZGUuYWRkQ2hpbGQodGhpcy5idG5XdVRvbmcpO1xyXG4gICAgICAgICAgICAgIHRoaXMuYnRuV3VUb25nLmludGVyYWN0YWJsZSA9IHRydWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2YXIgdG9uZ0h1YVNodW5TcHJpdGVDb20gPSB0aGlzLnR5cGVCdXR0b25zTm9kZS5nZXRDaGlsZEJ5TmFtZShcImJ0blRvbmdIdWFTaHVuXCIpLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgICAgdG9uZ0h1YVNodW5TcHJpdGVDb20uc3ByaXRlRnJhbWUgPSB0aGlzLnRvbmdIdWFTaHVuX2ltZzsgIC8v5pS55Y+Y5ZCM6Iqx6aG655qE57K+54G1XHJcblxyXG4gICAgICAgICAgLy/nu5nkupTlkIzmjInpkq7mt7vliqDkuovku7bvvJpcclxuICAgICAgICAgIHZhciBjbGlja0V2ZW50V3VUb25nID0gbmV3IGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXIoKTtcclxuICAgICAgICAgIGNsaWNrRXZlbnRXdVRvbmcudGFyZ2V0ID0gdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlO1xyXG4gICAgICAgICAgY2xpY2tFdmVudFd1VG9uZy5jb21wb25lbnQgPSBcIkNhcmRUeXBlQ29tYmluZVwiOyAvL+iEmuacrOWQjVxyXG4gICAgICAgICAgY2xpY2tFdmVudFd1VG9uZy5oYW5kbGVyID0gXCJjbGlja1d1VG9uZ1wiOyAgLy/miafooYznmoTlh73mlbBcclxuXHJcbiAgICAgICAgICB2YXIgQnV0dG9uc0NsaWNrRXZlbnRzID0gdGhpcy5idG5XdVRvbmcuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuY2xpY2tFdmVudHM7XHJcbiAgICAgICAgICBCdXR0b25zQ2xpY2tFdmVudHMucHVzaChjbGlja0V2ZW50V3VUb25nKTtcclxuICAgICAgfSovXHJcbiAgICAgIC8qIyMjIyMqL1xyXG4gICAgICB0aGlzLm1hUGFpID0gZGF0YS5tYVBhaTtcclxuICAgICAgLyojIyMjIyovXHJcbiAgICAgIHRoaXMuX2luaXRNYVBhaSgpO1xyXG4gICAgICAvKiMjIyMjKi9cclxuICAgICAgdGhpcy5fZGVza0luZm8gPSBkYXRhO1xyXG4gICAgICB0aGlzLl91cGRhdEdhbWVPdmVydmlldyh0aGlzLl9kZXNrSW5mbyk7XHJcbiAgICAgIHRoaXMudXBkYXRlUm9vbU51bWJlcihkYXRhLnJvb21JZCk7XHJcblxyXG4gICAgICBsZXQgcGxheWVySW5kZXhzID0gZGF0YS5wbGF5ZXJzSW5kZXg7IC8vIFsxMDAwNDldXHJcbiAgICAgIHRoaXMuX2luamVjdFVzZXJJZFRvUGxheWVyQ29tcG9uZW50cyhwbGF5ZXJJbmRleHMpO1xyXG5cclxuICAgICAgbGV0IHBsYXllcnMgPSBkYXRhLnBsYXllcnM7XHJcbiAgICAgIHRoaXMuX3BsYXllckluZm9zID0gcGxheWVycztcclxuICAgICAgdGhpcy5fdXBkYXRlVXNlckluZm9zKHBsYXllcnMpO1xyXG4gICAgICB0aGlzLl91cGRhdGVVc2VyU2NvcmVzKCk7XHJcbiAgICAgIHRoaXMuX3VwZGF0ZUJhbmtlcigpO1xyXG4gICAgICB0aGlzLl9tc2dDb250cm9sLmFkZFBsYXllckluZm9zKHRoaXMuX3BsYXllckluZm9zKTtcclxuXHJcbiAgICAgIGxldCBjdXJyZW50VXNlckluZm8gPSBwbGF5ZXJzLmZpbmQoZnVuY3Rpb24gKHBsYXllckluZm8pIHtcclxuICAgICAgICByZXR1cm4gcGxheWVySW5mby5pZCA9PSB0aGlzLl91c2VySWQ7XHJcbiAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgaWYoZGF0YS5jcmVhdGVJZCA9PSBwbGF5ZXIudXNlcklkKXsvL+aYvuekuuaIv+S4u1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNob3dGYW5nWmh1U3RhdHVzKGRhdGEuY3JlYXRlSWQsdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNob3dGYW5nWmh1U3RhdHVzKHBsYXllci51c2VySWQsZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIC8vaWYgKHRoaXMuX2Rlc2tJbmZvLmNJbmRleCA9PSAwKSB7XHJcbiAgICAgIC8vICByZXR1cm47XHJcbiAgICAgIC8vfVxyXG4gICAgICAgIC8qKi9cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbikge1xyXG4gICAgICAgICAgICB0aGlzLl9nYW1lU3RhdHVzID0gR0FNRVNUQVRVUy5XQUlUX1JFQURZO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8vL+ayoeacieWPkeeJjO+8jOS4jeaYr+maj+acuuWcuizkuI3mmK/lm57mlL7vvIzmmL7npLrlh4blpIfmjInpkq5cclxuICAgICAgICAvL2lmICghdGhpcy5fZGVza0luZm8uaXNDQmVnaW5cclxuICAgICAgICAvLyAgICAmJiAhdGhpcy5faXNSYW5kb21Sb29tKClcclxuICAgICAgICAvLyAgICAmJiAhUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpXHJcbiAgICAgICAgLy8gICAgJiYgIXRoaXMuX2dldFNlbGZSZWFkeVN0YXR1cygpXHJcbiAgICAgICAgLy8pIHtcclxuICAgICAgICAvLyAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAvLyAgICBpZih0aGlzLl9kZXNrSW5mby5jSW5kZXggIT0gMCkge1xyXG4gICAgICAgIC8vICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUueCA9IDA7XHJcbiAgICAgICAgLy8gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS55ID0gMDtcclxuICAgICAgICAvLyAgICB9XHJcbiAgICAgICAgLy8gICAgZWxzZSB7XHJcbiAgICAgICAgLy8gICAgICAgIHRoaXMuYnRuUmVhZHkubm9kZS54ID0gLTE1MDtcclxuICAgICAgICAvLyAgICAgICAgdGhpcy5idG5SZWFkeS5ub2RlLnkgPSAtMjQ7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vfVxyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8cGxheWVycy5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdmFyIHM9cGxheWVyc1tpXTtcclxuICAgICAgICAgICAgdmFyIGlzPXMucmVhZHlTdGF0dXM7Ly90cnVlL2ZhbHNlXHJcbiAgICAgICAgICAgIHZhciB1c2VySWQgPSBzLmlkO1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNob3dSZWFkeVN0YXR1cyh1c2VySWQsaXMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIGlmIChjdXJyZW50VXNlckluZm8gJiYgY3VycmVudFVzZXJJbmZvLmNhcmRzLmxlbmd0aCA+IDAgJiYgdGhpcy5fZGVza0luZm8uaXNDQmVnaW4pIHtcclxuICAgICAgICB0aGlzLl9zdGFydEdhbWUoKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmIChVc2VyTW9kZWxIZWxwZXIuaXNQbGF5ZWRDYXJkcyhjdXJyZW50VXNlckluZm8pICYmICF0aGlzLl9kZXNrSW5mby5pc0NCZWdpbikge1xyXG4gICAgICAgIHRoaXMuX3NvY2tldFJlY2VpdmVHYW1lT3ZlcihyZXNwb25zZSk7XHJcbiAgICAgIH1cclxuICAgICAgICB0aGlzLmlzUmVhZHlTdGF0dXMoKTtcclxuICAgICAgLy9pZiAoIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luICYmICF0aGlzLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAvLyAgdGhpcy5idG5SZWFkdXkubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAvL31cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgLy9pZiAoIXRoaXMuX2Rlc2tJbmZvLmlzQ0JlZ2luICYmICF0aGlzLl9pc1JhbmRvbVJvb20oKSAmJiAhdGhpcy5fZGVza0luZm8uaXNEZXNrT3Zlcikge1xyXG4gICAgICAgIC8vICAgIC8vdGhpcy5idG5SZWFkeS5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgLy8gICAgY2MubG9nKHRoaXMuX2Rlc2tJbmZvKVxyXG4gICAgICAgIC8vICAgIGNjLmxvZygn6YKj5bCx5piv5L2g5LqGLS0tLS0tJylcclxuICAgICAgICAvLyAgICBpZiAodGhpcy5faXNDb21wYXJpbmdDYXJkc05vdykge1xyXG4gICAgICAgIC8vICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vfSBlbHNlIHtcclxuICAgICAgICAvLyAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgLy99XHJcbiAgICAgICAgLyoqL1xyXG4gICAgICB0aGlzLl9oYW5kbGVVcGRhdGVEZXNrSW5mb0Fib3V0RXhpdFJvb20odGhpcy5fZGVza0luZm8pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjaXZlRmFQYWk6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIHRoaXMuX3NvY2tldFJlY2VpdmVEZXNrSW5mbyhyZXNwb25zZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNpdmVPbmxpbmVTdGF0dXM6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAvL3tcImFjdGlvblwiOlwic2VuZE9ubGluZVN0YXR1c1wiLFwicmVzdWx0XCI6dHJ1ZSxcImRhdGFcIjp7XCJ1c2VySWRcIjoxMDAwNDksXCJzdGF0dXNcIjoxfX1cclxuICAgICAgaWYgKCFyZXNwb25zZS5yZXN1bHQpIHtcclxuICAgICAgICBjYy5lcnJvcihcIumUmeivr++8mlwiLCByZXNwb25zZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgIGxldCB1c2VySWQgPSBkYXRhLnVzZXJJZDtcclxuICAgICAgbGV0IHN0YXR1cyA9IGRhdGEuc3RhdHVzO1xyXG5cclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICBwbGF5ZXIuc2V0VXNlck9ubGluZVN0YXR1cyh1c2VySWQsIHN0YXR1cyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc29ja2V0UmVjaXZlQ2hhdFRleHRNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICBsZXQgbWVzc2FnZSA9IHJlc3BvbnNlLmRhdGEubXNnO1xyXG5cclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICBwbGF5ZXIuc2hvd0NoYXRUZXh0KHVzZXJJZCwgbWVzc2FnZSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdGhpcy5fbXNnQ29udHJvbC5hZGRDaGF0VGV4dE1lc3NhZ2UodXNlcklkLCBtZXNzYWdlKTtcclxuXHJcbiAgICAgIGxldCBzZXggPSB0aGlzLl9wbGF5ZXJJbmZvcy5maW5kKGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIHVzZXIuaWQgPT0gdXNlcklkO1xyXG4gICAgICB9KS5zZXg7XHJcbiAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5wbGF5Q2hhdEF1ZGlvKHNleCwgbWVzc2FnZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlUmVxdWVzdEV4aXRNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgaWYgKHJlc3BvbnNlLmRhdGEudXNlcklkID09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGFsZXJ0Q29tcCA9IHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICBhbGVydENvbXAuYWxlcnQoKTtcclxuICAgICAgYWxlcnRDb21wLnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuXHJcbiAgICAgIGxldCBjb3VudGRvd24gPSB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJyk7XHJcbiAgICAgIGNvdW50ZG93bi5zdGFydENvdW50ZG93bigxMjAsIGZ1bmN0aW9uKGlzVGltZW91dCkge1xyXG4gICAgICAgIGlmIChpc1RpbWVvdXQpIHtcclxuICAgICAgICAgIHRoaXMuY2xpY2tBZ3JlZU90aGVyUGxheWVyRXhpdCgpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgfS5iaW5kKHRoaXMpKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVSZXF1ZXN0RXhpdFJlc3VsdE1lc3NhZ2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICB0aGlzLl9oaWRlUmVxZXN0RXhpdE5vZGUoKTtcclxuICAgICAgaWYgKHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdG9wKCk7XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgICBpZiAocmVzcG9uc2UuZGF0YS5yZXN1bHQpIHtcclxuICAgICAgICAvLyDop6PmlaPmiJDlip9cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgICAgbGV0IG5pY2tuYW1lID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZCh1c2VySWQpLm5pY2tuYW1lO1xyXG4gICAgICAgIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZSgn6Kej5pWj5aSx6LSl77yM5Zug5Li6JyArIG5pY2tuYW1lICsgJ+S4jeWQjOaEj+mAgOWHuicpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIF9zb2NrZXRSZWNlaXZlQXVkaW9NZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICB0aGlzLnBsYXlTcGVha0FuaW1hdGlvbih1c2VySWQpO1xyXG5cclxuICAgICAgaWYgKHVzZXJJZCA9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCB1cmwgPSByZXNwb25zZS5kYXRhLnVybDtcclxuICAgICAgdGhpcy5wbGF5QXVkaW9VcmwodXJsKTtcclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVQbGF5Q2FyZDogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgIC8vIOacieeUqOaIt+W3sue7j+WHhuWkh+WlveS6hueJjFxyXG4gICAgICAgIGNjLmxvZyhyZXNwb25zZSlcclxuICAgICAgICBjYy5sb2coJy0tLS0tLS0tOTcyJylcclxuICAgICAgICB2YXIgdXNlcklkID0gcmVzcG9uc2UuZGF0YVswXS51c2VySWQ7XHJcbiAgICAgICAgdmFyIGNhcmRJbmZvID0gcmVzcG9uc2UuZGF0YVsxXS5jYXJkO1xyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgIHBsYXllci5wbGF5Q2FyZCh1c2VySWQsY2FyZEluZm8pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmICh1c2VySWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgdGhpcy5jYXJkVHlwZUNvbWJpbmVOb2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgX2dldFNlbGZSZWFkeVN0YXR1czpmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgICAgICByZXR1cm4gc2VsZi5yZWFkeVN0YXR1cztcclxuICAgIH0sXHJcbiAgICBfc29ja2V0UmVjaXZlUmVhZHk6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICBsZXQgdXNlcklkID0gcmVzcG9uc2UuZGF0YS51c2VySWQ7XHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgcGxheWVyLnNob3dSZWFkeVN0YXR1cyh1c2VySWQpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy/mlLbliLDmuLjmiI/nu5PmnZ9cclxuICAgIF9zb2NrZXRSZWNlaXZlR2FtZU92ZXI6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICB0aGlzLl9oaWRlUmVxZXN0RXhpdE5vZGUoKTtcclxuXHJcbiAgICAgIC8vIOS4gOWxgOa4uOaIj+e7k+adn1xyXG4gICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgIGNjLmVycm9yKFwi6ZSZ6K+v77yaXCIsIHJlc3BvbnNlKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgICAvKiovXHJcbiAgICAgICAgY29uc3QgZGVza0luZm8gPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIGlmIChyZXNwb25zZS5hY3Rpb24gPT0gJ2dhbWVPdmVyJyAmJiBkZXNrSW5mby5pc0Rlc2tPdmVyKSB7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kRGlkUmVjZWl2ZUdhbWVPdmVyQWN0aW9uKHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qKi9cclxuICAgICAgdGhpcy5fZGVza0luZm8gPSByZXNwb25zZS5kYXRhO1xyXG5cclxuICAgICAgLy8g5aaC5p6c5piv5by65Yi26Kej5pWj5oi/6Ze077yM5YiZ55u05o6l5pi+56S65oC75oiQ57upXHJcbiAgICAgIGlmICh0aGlzLl9pc0Rpc3N2bGVkUm9vbSgpICYmICFQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICB0aGlzLl9zaG93VG90YWxHYW1lUmVzdWx0KDAuMSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG5cclxuICAgICAgaWYgKERhdGUubm93KCkgLSB0aGlzLl9lbnRlclRpbWUgPCAxMDAwICogNCkge1xyXG4gICAgICAgIC8vIOWImui/m+adpeeahOivne+8jOS4jeWxleekuuavlOeJjOWKqOeUu1xyXG4gICAgICAgICAgbGV0IG9uZUdhbWVSZXN1bHQgPSB0aGlzLm9uZUdhbWVSZXN1bHQuZ2V0Q29tcG9uZW50KCdHYW1lUmVzdWx0Jyk7XHJcbiAgICAgICAgICBvbmVHYW1lUmVzdWx0LnVuc2NoZWR1bGVBbGxDYWxsYmFja3MoKTtcclxuICAgICAgICAgIG9uZUdhbWVSZXN1bHQuc2hvd1Jlc3VsdHModGhpcy5fZGVza0luZm8sIHRoaXMuX3VzZXJJZCk7XHJcbiAgICAgICAgICB0aGlzLmJ0blNoYXJlLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICB0aGlzLmJ0blJlYWR5Lm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXJDb21wKSB7XHJcbiAgICAgICAgICBwbGF5ZXJDb21wLnJlc2V0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgICAvKiovXHJcbiAgICAgICAgICB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMucHVzaCh0aGlzLl9kZXNrSW5mby5jSW5kZXgpO1xyXG4gICAgICAgICAgLyoqL1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICB0aGlzLl9kZXNrSW5mbyA9IGRhdGE7XHJcbiAgICAgIHRoaXMuX3VwZGF0R2FtZU92ZXJ2aWV3KHRoaXMuX2Rlc2tJbmZvKTtcclxuXHJcbiAgICAgIGxldCBwbGF5ZXJJbmRleHMgPSBkYXRhLnBsYXllcnNJbmRleDsgLy8gWzEwMDA0OV1cclxuXHJcbiAgICAgIGxldCBwbGF5ZXJzID0gZGF0YS5wbGF5ZXJzO1xyXG4gICAgICB0aGlzLl9wbGF5ZXJJbmZvcyA9IHBsYXllcnM7XHJcbiAgICAgIHRoaXMuX3VwZGF0ZVVzZXJJbmZvcyhwbGF5ZXJzKTtcclxuXHJcbiAgICAgIGlmIChVc2VyTW9kZWxIZWxwZXIuaXNVc2VyUmVhZHkodGhpcy5fZmluZEN1cnJlbnRVc2VySW5mbygpKSkge1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgcGxheWVyQ29tcC5yZXNldCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuX3N0YXJ0Q29tcGFyZUNhcmRzKHJlc3BvbnNlKTtcclxuICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgX3NvY2tldFJlY2VpdmVEaXNzb2x2ZURlc2s6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgIHRoaXMuY2FyZFR5cGVDb21iaW5lTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgIGxldCBtZXNzYWdlID0gXCLmiL/kuLvlt7Lop6PmlaPmiL/pl7RcIjtcclxuICAgICAgaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpKSB7XHJcbiAgICAgICAgbWVzc2FnZSA9IFwi5pyJ546p5a625bey5by65Yi26YCA5Ye65oi/6Ze077yM5ri45oiP57uT5p2f44CC5pys5bGA5ri45oiP5LiN5Lya5omj6Zmk5oKo55qE6ZK755+z44CCXCI7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuc2hvd0FsZXJ0TWVzc2FnZShtZXNzYWdlLCBmYWxzZSk7XHJcbiAgICAgIHRoaXMuYWxlcnQuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnNldFdpbGxEaXNtaXNzQ2FsbGJhY2soZnVuY3Rpb24oKXtcclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSxcclxuICAgIC8qKi9cclxuICAgIF9zb2NrZXRMZWF2ZURlc2s6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9kZXNrSW5mby5pc0Rlc2tPdmVyKSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOaIv+mXtOW3sue7k+adn++8jOS5n+S4jeeUqOWGjeiHquWKqOmAgOWbnuWIsOWkp+WOheS6hlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICAvLyBzb2NrZXQg5pS25Yiw5pyJ5Lq65omL5py66L+b5YWl5ZCO5Y+w5raI5oGvXHJcbiAgICBfc29ja2V0UmVjZWl2ZVBhdXNlOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICBpZiAoIXJlc3BvbnNlLnJlc3VsdCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IHVzZXJJZCA9IHJlc3BvbnNlLmRhdGEudXNlcklkO1xyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyKSB7XHJcbiAgICAgICAgaWYgKHBsYXllci51c2VySWQgPT0gdXNlcklkKSB7XHJcbiAgICAgICAgICBwbGF5ZXIuc2V0VXNlck9ubGluZVN0YXR1cyh1c2VySWQsIDApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZWNlaXZlU29ja2V0Q29ubmVjdEVycm9yOiBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICB0aGlzLnNob3dOZXR3b3JrTWVzc2FnZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfcmVjZWl2ZVNvY2tldENvbm5lY3RTdWNjZXNzZWQ6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgIHRoaXMuaGlkZGVuTmV0d29ya01lc3NhZ2UoKTtcclxuXHJcbiAgICAgIGlmICghUGxheWJhY2suaW5zdGFuY2UuaXNQbGF5YmFja2luZygpKSB7XHJcbiAgICAgICAgdGhpcy5fbG9hZERlc2tJbmZvKCk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICAvLyBNQVJLOiDmm7TmlrDmiL/pl7Tkv6Hmga9cclxuICAgIHVwZGF0ZURlc2tJbmZvOiBmdW5jdGlvbiAoZGVza0luZm8pIHtcclxuICAgICAgICB0aGlzLl9kZXNrSW5mbyA9IGRlc2tJbmZvO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0R2FtZU92ZXJ2aWV3KHRoaXMuX2Rlc2tJbmZvKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVJvb21OdW1iZXIoZGVza0luZm8ucm9vbUlkKTtcclxuXHJcbiAgICAgICAgbGV0IHBsYXllckluZGV4cyA9IGRlc2tJbmZvLnBsYXllcnNJbmRleDsgLy8gWzEwMDA0OV1cclxuICAgICAgICB0aGlzLl9pbmplY3RVc2VySWRUb1BsYXllckNvbXBvbmVudHMocGxheWVySW5kZXhzKTtcclxuXHJcbiAgICAgICAgbGV0IHBsYXllcnMgPSBkZXNrSW5mby5wbGF5ZXJzO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckluZm9zID0gcGxheWVycztcclxuICAgICAgICB0aGlzLl91cGRhdGVVc2VySW5mb3MocGxheWVycyk7XHJcbiAgICAgICAgdGhpcy5fbXNnQ29udHJvbC5hZGRQbGF5ZXJJbmZvcyh0aGlzLl9wbGF5ZXJJbmZvcyk7XHJcbiAgICAgICAgaWYgKGRlc2tJbmZvLmNJbmRleCA9PSAwICYmIHRoaXMuX2Rlc2tJbmZvLnBsYXllcnMubGVuZ3RoIDwgdGhpcy5fZGVza0luZm8ubWF4TnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuU2hhcmUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAvKiovXHJcbiAgICBfaW5qZWN0VXNlcklkVG9QbGF5ZXJDb21wb25lbnRzOiBmdW5jdGlvbiAocGxheWVySW5kZXhzKSB7XHJcbiAgICAgIGxldCBjdXJyZW50VXNlcklkSW5kZXggPSBwbGF5ZXJJbmRleHMuZmluZEluZGV4KGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICByZXR1cm4gdXNlcklkID09IHRoaXMuX3VzZXJJZDtcclxuICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgIGxldCBmaXhlZFBsYXllckluZGV4cyA9IHBsYXllckluZGV4cy50cmFuc2xhdGlvbldpdGhTdGFydEluZGV4KGN1cnJlbnRVc2VySWRJbmRleCk7XHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcG9uZW50LCBpbmRleCkge1xyXG4gICAgICAgIGxldCB1c2VySWQgPSBmaXhlZFBsYXllckluZGV4cy5sZW5ndGggPiBpbmRleCA/IGZpeGVkUGxheWVySW5kZXhzW2luZGV4XSA6IG51bGw7XHJcbiAgICAgICAgcGxheWVyQ29tcG9uZW50LnVzZXJJZCA9IHVzZXJJZDtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIF91cGRhdGVVc2VySW5mb3M6IGZ1bmN0aW9uICh1c2VySW5mb3MpIHtcclxuICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllckNvbXBvbmVudCwgaW5kZXgpIHtcclxuICAgICAgICAvL3BsYXllckNvbXBvbmVudC5zZXREZXNrSW5mbyhzZWxmLl9kZXNrSW5mbyk7XHJcbiAgICAgICAgICAvKiovXHJcbiAgICAgICAgICBwbGF5ZXJDb21wb25lbnQudXBkYXRlRGVza0luZm8oc2VsZi5fZGVza0luZm8pO1xyXG4gICAgICAgICAgLyoqL1xyXG4gICAgICAgIHBsYXllckNvbXBvbmVudC51cGRhdGVVc2VySW5mb1dpdGhVc2Vycyh1c2VySW5mb3MpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMuX2hhbmRsZVRoZVNhbWVPZklQQWRyZXNzKHVzZXJJbmZvcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF91cGRhdGVVc2VyU2NvcmVzOiBmdW5jdGlvbih1c2VySW5mb3MpIHtcclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHBsYXllcikge1xyXG4gICAgICAgIHBsYXllci51cGRhdGVTY29yZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG5cclxuICAgIF91cGRhdGVCYW5rZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZvckVhY2goZnVuY3Rpb24ocGxheWVyKSB7XHJcbiAgICAgICAgcGxheWVyLnVwZGF0ZUJhbmtlcigpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g56eB5pyJ5pa55rOVXHJcbiAgICBfZmluZENhcmRzQnlVc2VySWQ6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgbGV0IHBsYXllciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodXNlcklkKTtcclxuXHJcbiAgICAgIHJldHVybiAocGxheWVyICE9IG51bGwpID8gcGxheWVyLmNhcmRzIDogbnVsbDtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQ6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgbGV0IHBsYXllciA9ICh0aGlzLl9wbGF5ZXJJbmZvcyB8fCBbXSkuZmluZChmdW5jdGlvbiAocGxheWVySW5mbykge1xyXG4gICAgICAgIHJldHVybiB1c2VySWQgPT0gcGxheWVySW5mby5pZDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gcGxheWVyO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZmluZFBsYXllckluZGV4QnlVc2VySWQ6IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgbGV0IGluZGV4ID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5maW5kSW5kZXgoZnVuY3Rpb24gKHBsYXllckNvbXApIHtcclxuICAgICAgICByZXR1cm4gcGxheWVyQ29tcC51c2VySWQgPT0gdXNlcklkO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiBpbmRleDtcclxuICAgIH0sXHJcblxyXG4gICAgX2ZpbmRDdXJyZW50VXNlckluZm86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgX2NvbnZlcnRDYXJkc1RvQ2FyZE5hbWVzOiBmdW5jdGlvbiAoY2FyZHMpIHtcclxuICAgICAgLy8gW3tcInN1aXRcIjpcInNcIixcIm51bWJlclwiOjEwfV1cclxuICAgICAgbGV0IHN1aXRDb2xvck1hcCA9IHtcclxuICAgICAgICBzOiA0LFxyXG4gICAgICAgIGg6IDMsXHJcbiAgICAgICAgYzogMixcclxuICAgICAgICBkOiAxLFxyXG4gICAgICB9O1xyXG4gICAgICByZXR1cm4gY2FyZHMubWFwKGZ1bmN0aW9uIChjYXJkKSB7XHJcbiAgICAgICAgdmFyIGNhcmROdW1iZXIgPSBjYXJkLm51bWJlcjtcclxuXHJcbiAgICAgICAgLy8g5pyN5Yqh5Zmo5Lit55qEIDE0IOaYryBBXHJcbiAgICAgICAgaWYgKGNhcmQubnVtYmVyID09IDE0KSB7XHJcbiAgICAgICAgICBjYXJkTnVtYmVyID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNvbG9yID0gc3VpdENvbG9yTWFwW2NhcmQuc3VpdF07XHJcbiAgICAgICAgbGV0IG51bWJlciA9IE1hdGgubWF4KE1hdGgubWluKGNhcmROdW1iZXIsIDIxKSwgMSk7XHJcbiAgICAgICAgcmV0dXJuIGNvbG9yICsgXCJfXCIgKyBudW1iZXI7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmm7TmlrDmuLjmiI/mgLvop4jkv6Hmga9cclxuICAgIF91cGRhdEdhbWVPdmVydmlldzogZnVuY3Rpb24gKGRlc2tJbmZvKSB7XHJcbiAgICAgIGlmIChQbGF5YmFjay5pbnN0YW5jZS5pc1BsYXliYWNraW5nKCkpIHtcclxuICAgICAgICB0aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gXCLlm57mlL5cIjtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLl9pc1JhbmRvbVJvb20oKSkge1xyXG4gICAgICAgIHRoaXMubGFiZWxPdmVydmlldy5zdHJpbmcgPSBcIlwiO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy9sZXQgZ2FtZU51bWJlclN0cmluZyA9IFwiXCI7XHJcbiAgICAgIC8vaWYgKGRlc2tJbmZvLnNldHRpbmcxICE9IDAgJiYgZGVza0luZm8uc2V0dGluZzEgIT0gMSkge1xyXG4gICAgICAvLyAgZ2FtZU51bWJlclN0cmluZyA9IFwi5bGA5pWwIDogXCIgKyBcIlwiICsgZGVza0luZm8uY0luZGV4ICsgXCIvXCIgKyBkZXNrSW5mby5tTWF4O1xyXG4gICAgICAvL30gZWxzZSBpZiAoZGVza0luZm8uc2V0dGluZzEgPT0gMCkge1xyXG4gICAgICAvLyAgZ2FtZU51bWJlclN0cmluZyA9IFwi5bGA5pWwIDogMTDlsYBcIjtcclxuICAgICAgLy99IGVsc2UgaWYgKGRlc2tJbmZvLnNldHRpbmcxID09IDEpIHtcclxuICAgICAgLy8gIGdhbWVOdW1iZXJTdHJpbmcgPSBcIuWxgOaVsCA6IDIw5bGAXCI7XHJcbiAgICAgIC8vfVxyXG5cclxuICAgICAgLy9sZXQgZ2FtZVdheU5hbWUgPSB0aGlzLl9kZXNrSW5mb0dhbWVXYXkoKTtcclxuICAgICAgICB0aGlzLmxhYmVsT3ZlcnZpZXcuc3RyaW5nID0gLyorIGdhbWVXYXlOYW1lIFwiIFwiICsgZ2FtZU51bWJlclN0cmluZyArXCJcXG5cIisqL1xyXG4gICAgICAgIFwi5qih5byPIDogXCIgKyBcIlwiICsgZGVza0luZm8ubWF4TnVtYmVyICsgXCLkurpcIiAvKisgXCJcXG4gXCIgKyB0aGlzLl9kZXNrSW5mb0ppYVlpU2VJbmZvKClcclxuICAgICAgICArIFwi77yMXCIgICsgdGhpcy5fZGVza0luZm9HdWlQYWlJbmZvKCkqLztcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5piv5ZCm5piv6ZqP5py65oi/XHJcbiAgICBfaXNSYW5kb21Sb29tOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyA9PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB0aGlzLl9kZXNrSW5mby5pc1JhbmRvbURlc2s7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaYr+WQpuaJgOacieWxgOaVsOmDveeUqOWujOS6hlxyXG4gICAgX2lzVG90YWxHYW1lT3ZlcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAodGhpcy5fZGVza0luZm8gPT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHRoaXMuX2Rlc2tJbmZvLmlzRGVza092ZXIpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHRoaXMuX2Rlc2tJbmZvLm1NYXggPD0gdGhpcy5fZGVza0luZm8uY0luZGV4O1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmmK/lkKblt7Lop6PmlaPmiL/pl7RcclxuICAgIF9pc0Rpc3N2bGVkUm9vbTogZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAodGhpcy5fZGVza0luZm8pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVza0luZm8uZGlzc29sdmVTdGF0dXM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8vLyDmr5TniYzpgLvovpFcclxuICAgIC8vIOW8gOWni+avlOeJjFxyXG4gICAgX3N0YXJ0Q29tcGFyZUNhcmRzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwi5omT5Y2wZGF0YeS/oeaBr1wiKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5faXNDb21wYXJpbmdDYXJkc05vdyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fZ29uZ1hpTmlTaG93KGZhbHNlKTtcclxuICAgICAgICAvKiovXHJcbiAgICAgICAgdGhpcy5fcGxheWVycyA9IGRhdGEuZGF0YS5wbGF5ZXJzO1xyXG4gICAgICBsZXQgdXNlciA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmZvQnlVc2VySWQodGhpcy5fdXNlcklkKTtcclxuICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlTdGFydENvbXBhcmUodXNlci5zZXgpO1xyXG5cclxuICAgICAgdGhpcy5zdGFydENvbXBhcmVDYXJkc05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmFsZXJ0KCk7XHJcbiAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnN0YXJ0Q29tcGFyZUNhcmRzTm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9zaG93Q29tcGFyZUNhcmREZXRhaWxzKGRhdGEpO1xyXG4gICAgICB9LmJpbmQodGhpcyksIDIuMCk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9zaG93Q29tcGFyZUNhcmREZXRhaWxzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIC8vdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvL3RoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgIC8vICAgIHBsYXllckNvbXAucmVhZHlUb0NvbXBhcmVDYXJkcygpO1xyXG4gICAgICAgIC8vfSk7XHJcbiAgICAgICAgLy9sZXQgY29tcGFyZVBsYXllcnMgPSB0aGlzLl9wbGF5ZXJDb21wb25lbnRzLmZpbHRlcihmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgLy8gICAgaWYocGxheWVyLnVzZXJJZCA9PSBudWxsKSB7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAvLyAgICB9XHJcbiAgICAgICAgLy8gICAgZm9yKHZhciBpIGluIF90aGlzLl9wbGF5ZXJzKSB7XHJcbiAgICAgICAgLy8gICAgICAgIGlmKF90aGlzLl9wbGF5ZXJzW2ldLmlkID09IHBsYXllci51c2VySWQpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgIGlmKF90aGlzLl9wbGF5ZXJzW2ldLmNhcmRJbmZvLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgLy/lsIbmmK/nibnmrorniYznmoTnjqnlrrblrZjotbfmnaVcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICBpZihfdGhpcy5fcGxheWVyc1tpXS5jYXJkSW5mby5sZW5ndGggPT0gMSl7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgIF90aGlzLnRlU2h1UGxheUlkID0gX3RoaXMuX3BsYXllcnNbaV0uaWQ7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAvLyAgICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgICAgIGVsc2UgaWYoX3RoaXMuX3BsYXllcnNbaV0uY2FyZEluZm8ubGVuZ3RoID09IDMpIHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAvLyAgICAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgICAgfVxyXG4gICAgICAgIC8vICAgIH1cclxuICAgICAgICAvL30pO1xyXG4gICAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyQ29tcCkge1xyXG4gICAgICAgICAgICBwbGF5ZXJDb21wLnJlYWR5VG9Db21wYXJlQ2FyZHMoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGNvbXBhcmVQbGF5ZXJzID0gdGhpcy5fcGxheWVyQ29tcG9uZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYXllcikge1xyXG4gICAgICAgICAgICByZXR1cm4gcGxheWVyLm5vZGUuYWN0aXZlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgICB2YXIgZHVyYXRpb24gPSB0aGlzLl9zaG93Q29tcGFyZUNhcmRTdGVwKDAsIGNvbXBhcmVQbGF5ZXJzKTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX3Nob3dDb21wYXJlQ2FyZFN0ZXAoMCwgY29tcGFyZVBsYXllcnMpO1xyXG4gICAgICAgIH0sIGR1cmF0aW9uKTtcclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLl9zaG93Q29tcGFyZUNhcmRTdGVwKDAsIGNvbXBhcmVQbGF5ZXJzKTtcclxuICAgICAgICB9LCBkdXJhdGlvbiAqIDIpO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlpoLmnpzmnInnibnmrorniYznmoTor53lsLHmlLnlj5jml7bpl7QgZHVyYXRpb25cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgcGxheWVycz1kYXRhLmRhdGEucGxheWVycztcclxuICAgICAgICBmb3IodmFyIGk9MDtpIDwgcGxheWVycy5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgdmFyIHM9cGxheWVyc1tpXTtcclxuICAgICAgICAgICAgaWYocy5jYXJkSW5mby5sZW5ndGggPT0gMSl7XHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiArPSAxLjU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKiAzICsgMC41O1xyXG4gICAgICAgIGxldCBzaG9vdER1cmF0aW9uID0gMS41O1xyXG5cclxuICAgICAgICBsZXQgc2hvb3REYXRhcyA9IHRoaXMuX3Nob290RGF0YXMoKSB8fCBbXTtcclxuXHJcbiAgICAgICAgbGV0IHNob3REYXRhID0gdGhpcy5fc2hvdERhdGEoKSB8fCBbXTtcclxuXHJcbiAgICAgICAgbGV0IGhvbWVSdW5Vc2VySWQgPSB0aGlzLl9ob21lUnVuVXNlcklkKCk7XHJcblxyXG4gICAgICAgIHZhciBzaG90RGF0YVRpbWVzID0gMDtcclxuICAgICAgICBzaG90RGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhLCBpbmRleCkge1xyXG4gICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnBsYXlTaG9vdChkYXRhLmZyb21Vc2VySWQsIGRhdGEudG9Vc2VySWQpO1xyXG4gICAgICAgICAgICB9LCBkdXJhdGlvbiArIGluZGV4ICogc2hvb3REdXJhdGlvbik7XHJcbiAgICAgICAgICAgIHNob3REYXRhVGltZXMrPTE7XHJcbiAgICAgICAgICAgIGR1cmF0aW9uKz0xO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmKGhvbWVSdW5Vc2VySWQubGVuZ3RoID49IDEpe1xyXG4gICAgICAgICAgICBzaG9vdERhdGFzLmZvckVhY2goZnVuY3Rpb24gKGRhdGEsIGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wbGF5U2hvb3QoZGF0YS5mcm9tVXNlcklkLCBkYXRhLnRvVXNlcklkKTtcclxuICAgICAgICAgICAgICAgIH0sIGR1cmF0aW9uICsgKGluZGV4ICsgc2hvdERhdGFUaW1lcykgKiBzaG9vdER1cmF0aW9uKTtcclxuICAgICAgICAgICAgICAgIGR1cmF0aW9uKz0xO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyBzaG9vdERhdGFzLmxlbmd0aCAqIHNob290RHVyYXRpb24gKyBzaG90RGF0YS5sZW5ndGggKiBzaG9vdER1cmF0aW9uO1xyXG5cclxuICAgICAgICBpZiAoaG9tZVJ1blVzZXJJZCA+IDApIHtcclxuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5wbGF5SG9tZVJ1bihob21lUnVuVXNlcklkKTtcclxuICAgICAgICAgICAgfSwgZHVyYXRpb24pO1xyXG4gICAgICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICsgMS4wO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhvbWVSdW5Vc2VySWQpIHtcclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiArIDE7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgLy/mmL7npLrnu5PmnpxcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX3Nob3dDb21wYXJlQ2FyZEZpbmlzaGVkKCk7XHJcbiAgICAgICAgfSwgZHVyYXRpb24pO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2hvd0NvbXBhcmVDYXJkU3RlcDogZnVuY3Rpb24gKHN0YXJ0VGltZSA9IDAsIGNvbXBhcmVQbGF5ZXJzID0gW10pIHtcclxuICAgICAgICB2YXIgZHVyYXRpb24gPSBzdGFydFRpbWU7XHJcbiAgICAgICAgbGV0IGludGVydmFsID0gMTtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIGNvbXBhcmVQbGF5ZXJzID0gY29tcGFyZVBsYXllcnMuc29ydChmdW5jdGlvbiAocGxheWVyMSwgcGxheWVyMikge1xyXG4gICAgICAgICAgICByZXR1cm4gcGxheWVyMS5uZXh0Q29tcGFyZVNjb3JlKCkgLSBwbGF5ZXIyLm5leHRDb21wYXJlU2NvcmUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDlubLmjonnibnmrorniYznmoTml7bpl7RcclxuICAgICAgICB2YXIgY289Y29tcGFyZVBsYXllcnM7XHJcbiAgICAgICAgZm9yKHZhciBpPTA7aSA8IGNvLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICB2YXIgcz1jb1tpXS5fdXNlckluZm87XHJcbiAgICAgICAgICAgIGlmKHMuaXNDb250YWluRXh0cmEpe1xyXG4gICAgICAgICAgICAgICAgY28uc3BsaWNlKGksMSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjby5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcGxheWVyLnNob3dOZXh0Q29tcGFyZUNhcmRzKCk7XHJcbiAgICAgICAgICAgIH0sIGR1cmF0aW9uKTtcclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbiArIGludGVydmFsO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gZHVyYXRpb247XHJcbiAgICB9LFxyXG5cclxuICAgIF9pc0dhbWVPdmVyOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDmr5TniYzlrozmiJDlkI7kvJrosIPnlKjnmoTmlrnms5VcclxuICAgIF9zaG93Q29tcGFyZUNhcmRGaW5pc2hlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9zaG93T25lR2FtZVJlc3VsdCgpO1xyXG4gICAgICAgIC8qKi9cclxuICAgICAgICB0aGlzLl9wbGF5ZWRDb21wYXJlQ2FyZHNJbmRleHMucHVzaCh0aGlzLl9kZXNrSW5mby5jSW5kZXgpO1xyXG4gICAgICAgIC8qKi9cclxuICAgIH0sXHJcblxyXG4gICAgLy9uZXR3b3JrXHJcbiAgICBzaG93TmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24obXNnID0gXCLnvZHnu5zpk77mjqXmlq3lvIDvvIzph43mlrDov57mjqXkuK0uLi5cIikge1xyXG4gICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAmJiB0aGlzLm5ldHdvcmtOb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtOb2RlLnJ1bkFjdGlvbihyZW1vdmVTZWxmQWN0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubmV0d29ya05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLm5ldHdvcmtOb2RlKTtcclxuICAgICAgICB2YXIgY29tcCA9IHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNlbGYubmV0d29ya05vZGUgPSBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBoaWRkZW5OZXR3b3JrTWVzc2FnZTpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHNob3dBbGVydE1lc3NhZ2U6IGZ1bmN0aW9uKG1zZywgYXV0b0Rpc21pc3MpIHtcclxuICAgICAgbGV0IGFsZXJ0Q29tcCA9IHRoaXMuYWxlcnQuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xyXG4gICAgICBpZiAoIXRoaXMuYWxlcnQuYWN0aXZlKSB7XHJcbiAgICAgICAgYWxlcnRDb21wLmFsZXJ0KCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFsZXJ0Q29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgIGFsZXJ0Q29tcC51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgIGlmIChhdXRvRGlzbWlzcykge1xyXG4gICAgICAgIGFsZXJ0Q29tcC5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgYWxlcnRDb21wLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgICB9LCA1KTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvL2NoZWNrTm9kZVxyXG4gICAgc2hvd0NoZWNrTWVzc2FnZTpmdW5jdGlvbihtc2cgPSAn5qOA5p+l572R57uc5LitLi4uJykge1xyXG4gICAgICAgIGlmICh0aGlzLmNoZWNrTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVTZWxmQWN0aW9uID0gY2MucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrTm9kZS5ydW5BY3Rpb24ocmVtb3ZlU2VsZkFjdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGVja05vZGUgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLndhaXRpbmdQcmVmYWIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLmNoZWNrTm9kZSk7XHJcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLmNoZWNrTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGNvbXAub25EaXNtaXNzQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgc2VsZi5jaGVja05vZGUgPSBudWxsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XHJcbiAgICAgICAgY29tcC5hbGVydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBoaWRkZW5DaGVja01lc3NhZ2U6ZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tOb2RlICE9IG51bGwgJiYgdGhpcy5jaGVja05vZGUuYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLy8vLyAg6IGK5aSp6K+t6Z+z6YC76L6RXHJcbiAgICBfcmVnaXN0ZXJWb2ljZU5vZGVFdmVudHM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICBsZXQgY2hhdFZvaWNlTm9kZSA9IHRoaXMuYnRuQ2hhdFZvaWNlLm5vZGU7XHJcbiAgICAgIHRoaXMuZW5kUmVjb3JkVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgIGNoYXRWb2ljZU5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzZWxmLmVuZFJlY29yZFRpbWUgPj0gMTAwMCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5uYXRpdmVSZWNvcmRBY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHNlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMS4yKTtcclxuICAgICAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIGlmIChzZWxmLl9pc1JlY29yZGluZykge1xyXG4gICAgICAgICAgc2VsZi5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYubmF0aXZlRW5kUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIHNlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAgIH0pO1xyXG4gICAgICBjaGF0Vm9pY2VOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0NBTkNFTCxmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIGlmIChzZWxmLl9pc1JlY29yZGluZykge1xyXG4gICAgICAgICAgc2VsZi5lbmRSZWNvcmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5faXNSZWNvcmRpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHNlbGYubmF0aXZlRW5kUmVjb3JkQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIHNlbGYudm9pY2VSZWNvcmRBbmltYXRpb25Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNjYWxlVG8oMC4xMiwgMSk7XHJcbiAgICAgICAgICAgIHNlbGYuYnRuQ2hhdFZvaWNlLm5vZGUucnVuQWN0aW9uKGFjdGlvbik7XHJcbiAgICAgIH0pO1xyXG4gICAgICBTb2NrZXQuaW5zdGFuY2UudXBsb2FkRmluaXNoID0gZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIGxldCB1c2VySWQgPSBzZWxmLl91c2VySWQ7XHJcbiAgICAgICAgICAgIFNvY2tldC5zZW5kQXVkaW9NZXNzYWdlKHVzZXJJZCwgdXJsKTtcclxuICAgICAgICAgIHNlbGYucGxheVNwZWFrQW5pbWF0aW9uKHNlbGYuX3VzZXJJZCk7XHJcbiAgICAgIH07XHJcbiAgICB9LFxyXG5cclxuICAgIG5hdGl2ZVJlY29yZEFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcInJlY29yZFwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkIGNvbS5sbGluZy5xaWFuamlhbmdsemdcclxuICAgICAgICAgICAganNiLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChLUU5hdGl2ZUludm9rZS5BTkRSSU9EQ2xhc3NOYW1lLCBcInJlY29yZFwiLCBcIigpVlwiKTtcclxuICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBhdXNlTXVzaWMoKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG5hdGl2ZUVuZFJlY29yZEFjdGlvbjpmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoS1FOYXRpdmVJbnZva2UuaXNOYXRpdmVJT1MoKSkge1xyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLklPU0NsYXNzTmFtZSxcImVuZFJlY29yZFwiKTtcclxuICAgICAgICB9IGVsc2UgaWYgKEtRTmF0aXZlSW52b2tlLmlzTmF0aXZlQW5kcm9pZCgpKSB7Ly9BbmRyb2lkXHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuQU5EUklPRENsYXNzTmFtZSwgXCJlbmRSZWNvcmRcIiwgXCIoKVZcIik7XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5pbnN0YW5jZS5yZXN1bWVNdXNpYygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgcGxheUF1ZGlvVXJsOmZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgIGlmIChLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUlPUygpKSB7XHJcbiAgICAgICAgICAgIGpzYi5yZWZsZWN0aW9uLmNhbGxTdGF0aWNNZXRob2QoS1FOYXRpdmVJbnZva2UuSU9TQ2xhc3NOYW1lLFwicGxheVVybDpcIix1cmwpO1xyXG4gICAgICAgIH0gZWxzZSBpZihLUU5hdGl2ZUludm9rZS5pc05hdGl2ZUFuZHJvaWQoKSkgey8vQW5kcm9pZFxyXG4gICAgICAgICAgICBqc2IucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKEtRTmF0aXZlSW52b2tlLkFORFJJT0RDbGFzc05hbWUsIFwicGxheVVybFwiLCBcIihMamF2YS9sYW5nL1N0cmluZzspVlwiLCB1cmwpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzogIOmAgOWHuua4uOaIj+mAu+i+kVxyXG4gICAgX2hhbmRsZVVwZGF0ZURlc2tJbmZvQWJvdXRFeGl0Um9vbTogZnVuY3Rpb24oZGVza0luZm8pIHtcclxuICAgICAgaWYgKCFkZXNrSW5mby5pc0Rpc3NvbHZpbmcpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBkaXNzb2x2ZUxlZnRUaW1lID0gZGVza0luZm8uZGlzc29sdmVMZWZ0VGltZSB8fCAxMjA7XHJcbiAgICAgIGxldCBkaXNzb2x2ZVVzZXJJZCA9IGRlc2tJbmZvLmRpc3NvbHZlVXNlcklkO1xyXG4gICAgICBpZiAoZGlzc29sdmVVc2VySWQgPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENhbmNlbEJ1dHRvbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYnRuQWxlcnRSZXF1ZXN0RXhpdENvbmZpcm1CdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICBsZXQgYWxlcnQgPSB0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcclxuICAgICAgICBhbGVydC5zZXRNZXNzYWdlKFwi5oKo5q2j5Zyo55Sz6K+35Y2P5ZWG6YCA5Ye677yM562J5b6F5YW25LuW546p5a625ZCM5oSPXCIpO1xyXG4gICAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdGFydENvdW50ZG93bihkaXNzb2x2ZUxlZnRUaW1lKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBkaXNzb2x2ZUFuc3dlckluZm9zID0gZGVza0luZm8uZGlzc29sdmVBbnN3ZXJJbmZvO1xyXG4gICAgICBsZXQgY3VycmVudFVzZXJJZEluZGV4ID0gZGVza0luZm8ucGxheWVyc0luZGV4LmZpbmRJbmRleChmdW5jdGlvbih1c2VySWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdXNlcklkID09IHVzZXJJZDtcclxuICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgIGxldCBhbnN3ZXJSZXN1bHQgPSBkaXNzb2x2ZUFuc3dlckluZm9zW2N1cnJlbnRVc2VySWRJbmRleF07XHJcbiAgICAgIGlmIChhbnN3ZXJSZXN1bHQgPT0gLTEpIHtcclxuICAgICAgICAvLyAtMSDooajnpLrmnKrlpITnkIYgIDAg6KGo56S65ouS57udICAx6KGo56S65ZCM5oSPXHJcbiAgICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5hY3RpdmUgPSB0cnVlO1xyXG5cclxuICAgICAgICBsZXQgY291bnRkb3duID0gdGhpcy5hbGVydEFuc293ZXJFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpO1xyXG4gICAgICAgIGNvdW50ZG93bi5zdGFydENvdW50ZG93bihkaXNzb2x2ZUxlZnRUaW1lLCBmdW5jdGlvbihpc1RpbWVvdXQpIHtcclxuICAgICAgICAgIGlmIChpc1RpbWVvdXQpIHtcclxuICAgICAgICAgICAgdGhpcy5jbGlja0FncmVlT3RoZXJQbGF5ZXJFeGl0KCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgLy8g56Gu5a6a6KaB5by65Yi26YCA5Ye65ri45oiPXHJcbiAgICBjbGlja0J1dHRvbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLmJ0bkJ1dHRvbk5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgaWYodGhpcy5idG5CdXR0b25zLnJvdGF0aW9uID09IDI3MCl7XHJcbiAgICAgICAgICAgIGFuaW0ucGxheSgndG9wUmlnaHRCdXR0b25zTGF5b3V0Jyk7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuQnV0dG9ucy5yb3RhdGlvbiA9IDkwO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAvL2FuaW0uc3RvcCgndG9wUmlnaHRCdXR0b25zTGF5b3V0Jyk7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuQnV0dG9uTm9kZS54ID0gODkxO1xyXG4gICAgICAgICAgICB0aGlzLmJ0bkJ1dHRvbnMucm90YXRpb24gPSAyNzA7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyDnoa7lrpropoHlvLrliLbpgIDlh7rmuLjmiI9cclxuICAgIGNsaWNrQ29uZmlybUZvcmNlRXhpdDogZnVuY3Rpb24oKSB7XHJcbiAgICAgIFNvY2tldC5zZW5kRm9yY2VFeGl0Um9vbSh0aGlzLl91c2VySWQpO1xyXG4gICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g56Gu6K6k6K+35rGC6YCA5Ye65ri45oiPXHJcbiAgICBjbGlja0NvbmZpcm1SZXF1ZXN0RXhpdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmJ0bkFsZXJ0UmVxdWVzdEV4aXRDYW5jZWxCdXR0b24ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5idG5BbGVydFJlcXVlc3RFeGl0Q29uZmlybUJ1dHRvbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XHJcbiAgICAgIGFsZXJ0LnNldE1lc3NhZ2UoXCLmgqjmraPlnKjnlLPor7fljY/llYbpgIDlh7rvvIznrYnlvoXlhbbku5bnjqnlrrblkIzmhI9cIik7XHJcbiAgICAgIHRoaXMuYWxlcnRSZXF1ZXN0RXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdGFydENvdW50ZG93bigxMjApO1xyXG5cclxuICAgICAgU29ja2V0LnNlbmRMZWF2ZURlc2sodGhpcy5fdXNlcklkKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g5ZCM5oSP5LuW5Lq66YCA5Ye6XHJcbiAgICBjbGlja0FncmVlT3RoZXJQbGF5ZXJFeGl0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdE5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcclxuICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykudW5zY2hlZHVsZUFsbENhbGxiYWNrcygpO1xyXG4gICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXRDb3VudGRvd25Ob2RlLmdldENvbXBvbmVudCgnQ291bnRkb3duJykuc3RvcCgpO1xyXG5cclxuICAgICAgU29ja2V0LnNlbmRBbnN3ZXJEaXNzb2x2ZSh0aGlzLl91c2VySWQsIDEpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyDkuI3lkIzmhI/ku5bkurrpgIDlh7pcclxuICAgIGNsaWNrRGlzYWdyZWVPdGhlclBsYXllckV4aXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5hbGVydEFuc293ZXJFeGl0Tm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0JykuZGlzbWlzc0FjdGlvbigpO1xyXG4gICAgICB0aGlzLmFsZXJ0QW5zb3dlckV4aXROb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS51bnNjaGVkdWxlQWxsQ2FsbGJhY2tzKCk7XHJcbiAgICAgIHRoaXMuYWxlcnRBbnNvd2VyRXhpdENvdW50ZG93bk5vZGUuZ2V0Q29tcG9uZW50KCdDb3VudGRvd24nKS5zdG9wKCk7XHJcbiAgICAgIFNvY2tldC5zZW5kQW5zd2VyRGlzc29sdmUodGhpcy5fdXNlcklkLCAwKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8g6ZqQ6JeP6K+35rGC6YCA5Ye6IE5vZGVcclxuICAgIF9oaWRlUmVxZXN0RXhpdE5vZGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgaWYgKCF0aGlzLmFsZXJ0UmVxdWVzdEV4aXROb2RlLmFjdGl2ZSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Tm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdGhpcy5hbGVydFJlcXVlc3RFeGl0Q291bnRkb3duTm9kZS5nZXRDb21wb25lbnQoJ0NvdW50ZG93bicpLnN0b3AoKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8vLyDmiZPmnqpcclxuICAgIHBsYXlTaG9vdDogZnVuY3Rpb24gKGZyb21Vc2VySWQsIHRvVXNlcklkKSB7XHJcbiAgICAgIGxldCB1c2VyID0gdGhpcy5fZmluZFBsYXllckluZm9CeVVzZXJJZChmcm9tVXNlcklkKTtcclxuICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICBBdWRpb01hbmFnZXIuaW5zdGFuY2UucGxheUh1bWFuRGFRaWFuZyh1c2VyLnNleCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCB0b1VzZXJJbmRleCA9IHRoaXMuX2ZpbmRQbGF5ZXJJbmRleEJ5VXNlcklkKHRvVXNlcklkKTtcclxuXHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgcGxheWVyLnBsYXlTaG9vdEFuaW1hdGlvbihmcm9tVXNlcklkLCB0b1VzZXJJbmRleCk7XHJcbiAgICAgICAgcGxheWVyLnBsYXlCdWxsZXRIb2xlQW5pbWF0aW9uKHRvVXNlcklkKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIOaSreaUvuWFqOWekuaJk+WKqOaViFxyXG4gICAgcGxheUhvbWVSdW46IGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgbGV0IHVzZXIgPSB0aGlzLl9maW5kUGxheWVySW5mb0J5VXNlcklkKHVzZXJJZCk7XHJcbiAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlIb21lUnVuKHVzZXIuc2V4KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5fcGxheWVyQ29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICBwbGF5ZXIucGxheUhvbWVSdW5BaW1hdGlvbih1c2VySWQpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgcGxheVNwZWFrQW5pbWF0aW9uOiBmdW5jdGlvbiAodXNlcklkKSB7XHJcbiAgICAgIHRoaXMuX3BsYXllckNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7XHJcbiAgICAgICAgcGxheWVyLnBsYXlTcGVha0FuaW1hdGlvbih1c2VySWQpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgX3Nob290RGF0YXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgaG9tZVJ1blVzZXJJZCA9IHRoaXMuX2hvbWVSdW5Vc2VySWQoKTsgLy8g5YWo5Z6S5omTXHJcbiAgICAgICAgbGV0IHNob290RGF0YXMgPSB0aGlzLl9kZXNrSW5mby5zaG90RGF0YS5maWx0ZXIoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGEuZnJvbVVzZXJJZCA9PSBob21lUnVuVXNlcklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBzaG9vdERhdGFzO1xyXG4gICAgfSxcclxuXHJcbiAgICBfc2hvdERhdGE6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgaG9tZVJ1blVzZXJJZCA9IHRoaXMuX2hvbWVSdW5Vc2VySWQoKTsgLy8g5omT5p6qXHJcbiAgICAgICAgbGV0IHNob3REYXRhID0gdGhpcy5fZGVza0luZm8uc2hvdERhdGEuZmlsdGVyKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmZyb21Vc2VySWQgIT0gaG9tZVJ1blVzZXJJZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2hvdERhdGE7XHJcbiAgICB9LFxyXG5cclxuICAgIF9ob21lUnVuVXNlcklkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9kZXNrSW5mby5hbGxTaG90RGF0YTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTUFSSzog5oi/6Ze05L+h5oGv6YOo5YiGXHJcblxyXG4gICAgLy8g6I635Y+W5oi/6Ze055qE546p5rOVXHJcbiAgICBfZGVza0luZm9HYW1lV2F5OiBmdW5jdGlvbigpIHtcclxuICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nMztcclxuICAgICAgaWYoc2V0dGluZyA9PSBudWxsKXtcclxuICAgICAgICAgIHNldHRpbmcgPSAyO1xyXG4gICAgICB9XHJcbiAgICAgIGxldCBuYW1lcyA9IFtcIuW6hOWutuaooeW8j1wiLCBcIuaXoOeJueauiueJjFwiLFwi5pmu6YCa5qih5byPXCJdO1xyXG4gICAgICByZXR1cm4gbmFtZXNbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb051bWJlck9mR2FtZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxldCBzZXR0aW5nID0gdGhpcy5fZGVza0luZm8uc2V0dGluZzE7XHJcbiAgICAgIGxldCBpbmZvcyA9IFsnMTDlsYAnLCAnMjDlsYAnLCAnNDDlsYAnLCAnNeWxgCddO1xyXG4gICAgICAvKmlmIChzZXR0aW5nIDw9IDEpIHtcclxuICAgICAgICByZXR1cm4gJ+adoeaVsO+8micgKyBpbmZvc1tzZXR0aW5nXTtcclxuICAgICAgfSovXHJcbiAgICAgIGlmKHNldHRpbmcgPT0gMil7XHJcbiAgICAgICAgICBzZXR0aW5nID0gMDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmKHNldHRpbmcgPT0gMyl7XHJcbiAgICAgICAgICBzZXR0aW5nID0gMTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmKHNldHRpbmcgPT0gNCl7XHJcbiAgICAgICAgICBzZXR0aW5nID0gMjtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmKHNldHRpbmcgPT0gNSl7XHJcbiAgICAgICAgICBzZXR0aW5nID0gMztcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gJ+WxgOaVsO+8micgKyBpbmZvc1tzZXR0aW5nXTtcclxuICAgIH0sXHJcblxyXG4gICAgX2Rlc2tJbmZvTnVtYmVyT2ZQZW9wbGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcyO1xyXG4gICAgICBsZXQgaW5mb3MgPSBbJzLkuronLCAnM+S6uicsICc05Lq6JywgJzXkuronXTtcclxuICAgICAgcmV0dXJuIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICBfZGVza0luZm9QYXlJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgbGV0IHNldHRpbmcgPSB0aGlzLl9kZXNrSW5mby5zZXR0aW5nNDtcclxuICAgICAgaWYoc2V0dGluZyA9PSBudWxsKXtcclxuICAgICAgICAgIHNldHRpbmcgPSAwO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKHNldHRpbmcgPT0gMCl7XHJcbiAgICAgICAgICBzZXR0aW5nID0gMTtcclxuICAgICAgfVxyXG4gICAgICBsZXQgaW5mb3MgPSBbJ+aIv+S4u+mcuOS4u+W6hCcsICfmiL/otLlBQSddO1xyXG4gICAgICByZXR1cm4gaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb0ppYVlpU2VJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgc2V0dGluZyA9IHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc3ID09IDAgPyAxIDogMDtcclxuICAgICAgICBsZXQgaW5mb3MgPSBbJ+aXoOWkmuS4gOiJsicsICflpJrkuIDoibInXTtcclxuICAgICAgICByZXR1cm4gaW5mb3Nbc2V0dGluZ107XHJcbiAgICB9LFxyXG5cclxuICAgIF9kZXNrSW5mb0d1aVBhaUluZm86IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZXR0aW5nO1xyXG4gICAgICAgIGlmKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmc4ID09IG51bGwpe1xyXG4gICAgICAgICAgICBzZXR0aW5nID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZih0aGlzLl9kZXNrSW5mby5zZXR0aW5nOCA9PSAwKXtcclxuICAgICAgICAgICAgc2V0dGluZyA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYodGhpcy5fZGVza0luZm8uc2V0dGluZzggPT0gMSl7XHJcbiAgICAgICAgICAgIHNldHRpbmcgPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaW5mb3MgPSBbJ+aXoOeOi+eJjCcsICfkuKTlvKDnjovniYwnLCAn5Zub5byg546L54mMJ107XHJcbiAgICAgICAgcmV0dXJuIGluZm9zW3NldHRpbmddO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiDliankvZnml7bpl7RcclxuICAgIF9yZW1haW5UaW1lU3RhcnRVcGRhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAvL3RoaXMuc2NoZWR1bGUodGhpcy5fcmVtYWluVGltZVVwZGF0ZSwgMS4wLCBjYy5tYWNyby5SRVBFQVRfRk9SRVZFUik7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZW1haW5UaW1lVXBkYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMuX2lzUmFuZG9tUm9vbSgpIHx8IFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLl9kZXNrSW5mbyA9PSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICB0aGlzLmxhYmVsUmVtYWluVGltZS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IGlzVGFvU2h1ID0gKHRoaXMuX2Rlc2tJbmZvLnNldHRpbmcxID09IDApIHx8ICh0aGlzLl9kZXNrSW5mby5zZXR0aW5nMSA9PSAxKTtcclxuICAgICAgaWYgKGlzVGFvU2h1KSB7XHJcbiAgICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICghdGhpcy5fZGVza0luZm8uY3JlYXRlVGltZSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICBsZXQgY3JlYXRlVGltZSA9IGZlY2hhLnBhcnNlKHRoaXMuX2Rlc2tJbmZvLmNyZWF0ZVRpbWUsICdZWVlZLU1NLUREIEhIOm1tOnNzJykuZ2V0VGltZSgpO1xyXG4gICAgICBsZXQgb25lSG91ciA9IDYwICogNjA7XHJcbiAgICAgIGxldCByZW1haW4gPSAoRGF0ZS5ub3coKSAtIGNyZWF0ZVRpbWUpIC8gMTAwMDtcclxuICAgICAgcmVtYWluID0gTWF0aC5tYXgob25lSG91ciAtIHJlbWFpbiwgMCk7XHJcblxyXG4gICAgICBsZXQgbWlucyA9IE1hdGguZmxvb3IocmVtYWluIC8gNjApO1xyXG4gICAgICBsZXQgc2VjcyA9IE1hdGguZmxvb3IocmVtYWluICUgNjApO1xyXG4gICAgICBpZiAobWlucyA9PSAwICYmIHNlY3MgPT0gMCkge1xyXG4gICAgICAgIHRoaXMubGFiZWxSZW1haW5UaW1lLnN0cmluZyA9IFwiXCI7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgbWluc1N0cmluZyA9IFwiXCIgKyBtaW5zO1xyXG4gICAgICBpZiAobWluc1N0cmluZy5sZW5ndGggPCAyKSB7XHJcbiAgICAgICAgbWluc1N0cmluZyA9IFwiMFwiICsgbWluc1N0cmluZztcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHNlY3NTdHJpbmcgPSBcIlwiICsgc2VjcztcclxuICAgICAgaWYgKHNlY3NTdHJpbmcubGVuZ3RoIDwgMikge1xyXG4gICAgICAgIHNlY3NTdHJpbmcgPSBcIjBcIiArIHNlY3NTdHJpbmc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBzdHJpbmcgPSBcIuWJqeS9meaXtumXtO+8mjAwOlwiICsgbWluc1N0cmluZyArIFwiOlwiICsgc2Vjc1N0cmluZztcclxuICAgICAgdGhpcy5sYWJlbFJlbWFpblRpbWUuc3RyaW5nID0gc3RyaW5nO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBNQVJLOiDlpITnkIblkIwgSVAg55qE55So5oi3XHJcbiAgICBfaGFuZGxlVGhlU2FtZU9mSVBBZHJlc3M6IGZ1bmN0aW9uKHVzZXJJbmZvcykge1xyXG4gICAgICBpZiAoIXVzZXJJbmZvcyB8fCB1c2VySW5mb3MubGVuZ3RoID09IDApIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxldCBpcFVzZXJJbmZvcyA9IHVzZXJJbmZvcy5yZWR1Y2UoZnVuY3Rpb24oaXBzLCB1c2VySW5mbykge1xyXG4gICAgICAgIGxldCB1c2VycyA9IGlwc1t1c2VySW5mby5pcEFkZHJlc3NdIHx8IFtdO1xyXG4gICAgICAgIHVzZXJzLnB1c2godXNlckluZm8pO1xyXG5cclxuICAgICAgICBpcHNbdXNlckluZm8uaXBBZGRyZXNzXSA9IHVzZXJzO1xyXG4gICAgICAgIHJldHVybiBpcHM7XHJcbiAgICAgIH0sIHt9KTtcclxuXHJcbiAgICAgIGxldCBzYW1lSXBVc2VycyA9IG51bGw7XHJcbiAgICAgIGZvciAobGV0IGlwIGluIGlwVXNlckluZm9zKSB7XHJcbiAgICAgICAgbGV0IHVzZXJzID0gaXBVc2VySW5mb3NbaXBdO1xyXG4gICAgICAgIGlmICh1c2Vycy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICBzYW1lSXBVc2VycyA9IHVzZXJzO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoc2FtZUlwVXNlcnMgPT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5fYWxlcnRTYW1lSXBVc2VySW5mb3Moc2FtZUlwVXNlcnMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBfYWxlcnRTYW1lSXBVc2VySW5mb3M6IGZ1bmN0aW9uKHVzZXJzKSB7XHJcbiAgICAgIGxldCBtZXNzYWdlID0gXCJcIjtcclxuICAgICAgbGV0IHVzZXJJZHMgPSBcIlwiO1xyXG4gICAgICB1c2Vycy5mb3JFYWNoKGZ1bmN0aW9uKHVzZXIsIGluZGV4KSB7XHJcbiAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UgKyAoaW5kZXggPiAwID8gJyDlkowgJyA6ICcnKSArIHVzZXIubmlja25hbWU7XHJcbiAgICAgICAgdXNlcklkcyA9IHVzZXJJZHMgKyB1c2VyLmlkO1xyXG4gICAgICB9KTtcclxuICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UgKyAnIOWcqOWQjOS4gCBJUCDkuIvvvIEnO1xyXG5cclxuICAgICAgdGhpcy5fZGlkQWxlcnRTYW1lSXBNZXNzYWdlID0gdGhpcy5fZGlkQWxlcnRTYW1lSXBNZXNzYWdlIHx8IHt9O1xyXG4gICAgICBpZiAodGhpcy5fZGlkQWxlcnRTYW1lSXBNZXNzYWdlW3VzZXJJZHNdKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLnNob3dBbGVydE1lc3NhZ2UobWVzc2FnZSwgdHJ1ZSk7XHJcbiAgICAgIHRoaXMuX2RpZEFsZXJ0U2FtZUlwTWVzc2FnZVt1c2VySWRzXSA9IHRydWU7XHJcbiAgICB9LFxyXG5cclxufSk7XHJcblBsYXkuZ29uZ1hpTmlTaG93ID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgIHRoaXMuaW5zdGFuY2VzLl9nb25nWGlOaVNob3codHlwZSk7XHJcbn07XHJcbm1vZHVsZS5leHBvcnRzID0gUGxheTtcclxuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgLy8gZm9vOiB7XG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGEgbm9kZSBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgICAgICAgLy8gICAgdXJsOiBjYy5UZXh0dXJlMkQsICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0eXBlb2YgZGVmYXVsdFxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgdmlzaWJsZTogdHJ1ZSwgICAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyB0cnVlXG4gICAgICAgIC8vICAgIGRpc3BsYXlOYW1lOiAnRm9vJywgLy8gb3B0aW9uYWxcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxuICAgICAgICAvLyB9LFxuICAgICAgICAvLyAuLi5cbiAgICAgICAgcHJvZHVjdElkOicnLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG4gICAgXG4gICAgY2xpY2tBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMub25DbGlja0FjdGlvbih0aGlzLnByb2R1Y3RJZCk7ICAgICAgICBcbiAgICB9LFxuICAgIFxuICAgIG9uQ2xpY2tBY3Rpb246ZnVuY3Rpb24ocHJvZHVjdElkKSB7XG4gICAgICAgIFxuICAgIH0sXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJjb25zdCBTb2NrZXQgPSByZXF1aXJlKCdzb2NrZXQnKTtcbmNvbnN0IEtRR2xvYmFsRXZlbnQgPSByZXF1aXJlKCdLUUdsb2JhbEV2ZW50Jyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIG1hdGNoaW5nTGFiZWw6Y2MuTGFiZWwsXG4gICAgICAgIHRpbWVOb2RlOmNjLk5vZGUsXG4gICAgICAgIG1hdGNoaW5nTm9kZTpjYy5Ob2RlLFxuICAgICAgICB3YWl0aW5nUHJlZmFiOiBjYy5QcmVmYWIsXG4gICAgICAgIGFsZXJ0UHJlZmFiOiBjYy5QcmVmYWIsXG5cbiAgICAgICAgdGlzaGk6Y2MuTm9kZSxcblxuICAgICAgICBfdXNlcklkOiBudWxsLFxuICAgICAgICBfcmVzcG9uc2U6IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fdXNlcklkID0gU29ja2V0Lmluc3RhbmNlLnVzZXJJbmZvLmlkO1xuICAgICAgY2MuaXNSb29tVmlld1Nob3cgPSB0cnVlO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZURlc2tJbmZvLCB0aGlzLl9zb2NrZXRSZWNlaXZlRGVza0luZm8gLHRoaXMpO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuU29ja2V0RGlzY29ubmVjdCwgdGhpcy5fc29ja2V0RGlzY29ubmVjdCwgdGhpcyk7XG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0U3VjY2Vzc2VkLCB0aGlzLl9zb2NrZXRDb25uZWN0ZWQsIHRoaXMpO1xuICAgICAgS1FHbG9iYWxFdmVudC5vbihTb2NrZXQuRXZlbnQuUmVjZWl2ZUludGVyUmFuZG9tLCB0aGlzLl9zb2NrZXRSZWNlaXZlSW50ZXJSYW5kb20sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBfc29ja2V0UmVjZWl2ZURlc2tJbmZvOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIGlmICghcmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgfSxcblxuICAgIF9zb2NrZXRSZWNlaXZlSW50ZXJSYW5kb206IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIC8v5pyN5Yqh5Zmo5Y+R6YCBICB7J2FjdGlvbic6J2ludGVyUmFuZG9tJywncmVzdWx0JzpmYWxzZSwnZGF0YSc6eydyZWFzb24nOnJlYXNvbn19XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gcmVzcG9uc2U7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl90aW1lb3V0UmFuZG9tQWN0aW9uKTtcbiAgICAgICAgLy8g5aSE55CG6ZqP5py65Zy65Yy56YWN5LiN5oiQ5Yqf55qE5oOF5Ya1XG4gICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCByZWFzb24gPSByZXNwb25zZS5kYXRhLnJlYXNvbiB8fCBcIuWKoOWFpemaj+acuuWcuuWksei0pVwiO1xuICAgICAgICB0aGlzLnNob3dBbGVydE1lc3NhZ2UocmVhc29uKTtcblxuICAgICAgICBpZiAocmVhc29uID09ICfkvaDlt7Lnu4/lnKjljLnphY3pmJ/liJcnKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93TWF0Y2hpbmcoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVNYXRjaGluZygpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9zb2NrZXREaXNjb25uZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgIC8vIOi/nuaOpeW3suaWreW8gFxuICAgICAgdGhpcy5tYXRjaGluZ05vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB0aGlzLnNob3dOZXR3b3JrTWVzc2FnZSgn572R57uc6ZO+5o6l5pat5byA77yM6YeN5paw6L+e5o6l5LitLi4uJyk7XG4gICAgfSxcblxuICAgIF9zb2NrZXRDb25uZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5oaWRkZW5OZXR3b3JrTWVzc2FnZSgpO1xuICAgIH0sXG5cblxuICAgIG9uRGVzdHJveTogZnVuY3Rpb24gKCkge1xuICAgICAgS1FHbG9iYWxFdmVudC5vZmZUYXJnZXQodGhpcyk7XG4gICAgfSxcblxuICAgIGNsaWNrRXhpdDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoJ2hhbGwnKTtcbiAgICB9LFxuXG4gICAgY2xpY2tTdGFydDogZnVuY3Rpb24gKCkge1xuICAgICAgU29ja2V0LnNlbmRFbnRlclJhbmRvbSh0aGlzLl91c2VySWQpO1xuICAgICAgdGhpcy5fc2hvd01hdGNoaW5nKCk7XG5cbiAgICAgIC8qIyMjIyNiZWdpbiovXG4gICAgICAvL3JlYXNvbuaYr+acjeWKoeWZqOWPkemAgeWbnuadpeeahFxuICAgICAgLyppZih0aGlzLl9yZXNwb25zZS5kYXRhLnJlYXNvbiA9PSBcIuS9oOeahOmSu+efs+S4jei2s1wiKXtcbiAgICAgICAgICB0aGlzLnRpc2hpLmFjdGl2ZSA9IHRydWU7XG4gICAgICB9Ki9cbiAgICAgIC8qIyMjIyNlbmQqL1xuXG4gICAgICB0aGlzLnNjaGVkdWxlT25jZSh0aGlzLl90aW1lb3V0UmFuZG9tQWN0aW9uLCA1KTtcbiAgICB9LFxuICAgIC8qIyMjIyPngrnlh7vnqbrnmb3lnLDmlrnvvIznoJbnn7PkuI3otrPmj5DnpLrmtojlpLEqL1xuICAgIC8qb25CdG5Lb25nOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy50aXNoaS5hY3RpdmUpe1xuICAgICAgICAgICAgdGhpcy50aXNoaS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAvL+S7gOS5iOS5n+S4jeWBmlxuICAgICAgICB9XG4gICAgfSwqL1xuICAgIC8q5Y+W5raI5Yy56YWNKi9cbiAgICBjbGlja0NhbmNlbDpmdW5jdGlvbiAoKSB7XG4gICAgICBTb2NrZXQuc2VuZENhbmNlbFJhbmRvbSh0aGlzLl91c2VySWQpO1xuXG4gICAgICB0aGlzLl9oaWRlTWF0Y2hpbmcoKTtcbiAgICB9LFxuXG4gICAgX3RpbWVvdXRSYW5kb21BY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9oaWRlTWF0Y2hpbmcoKTtcbiAgICAgICAgdGhpcy5zaG93QWxlcnRNZXNzYWdlKCfov5vlhaXljLnphY3lpLHotKUnKTtcbiAgICB9LFxuXG4gICAgX3Nob3dNYXRjaGluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjb21wID0gdGhpcy5tYXRjaGluZ05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpO1xuICAgICAgICBjb21wLmFsZXJ0KCk7XG4gICAgICAgIHRoaXMubWF0Y2hpbmdMYWJlbC5zdHJpbmcgPSAn5q2j5Zyo5Yy56YWN5Lit77yM6K+356iN5ZCOLi4uJztcbiAgICAgICAgbGV0IG51bSA9IDA7XG4gICAgICAgIHRoaXMuc2NoZWR1bGUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBudW0gPSBudW0gKyAwLjU7XG4gICAgICAgICAgICB0aGlzLnRpbWVOb2RlLnJvdGF0aW9uID0gbnVtO1xuICAgICAgICAgfSwgMC4wMSk7XG4gICAgfSxcblxuICAgIF9oaWRlTWF0Y2hpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY29tcCA9IHRoaXMubWF0Y2hpbmdOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgY29tcC5kaXNtaXNzQWN0aW9uKCk7XG4gICAgfSxcblxuICAgICBzaG93TmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24obXNnKSB7XG4gICAgICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl90aW1lb3V0UmFuZG9tQWN0aW9uKTtcblxuICAgICAgICBpZiAodGhpcy5uZXR3b3JrTm9kZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgcmVtb3ZlU2VsZkFjdGlvbiA9IGNjLnJlbW92ZVNlbGYoKTtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUucnVuQWN0aW9uKHJlbW92ZVNlbGZBY3Rpb24pO1xuICAgICAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXR3b3JrTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMud2FpdGluZ1ByZWZhYik7XG4gICAgICAgIHRoaXMubm9kZS5hZGRDaGlsZCh0aGlzLm5ldHdvcmtOb2RlKTtcbiAgICAgICAgdmFyIGNvbXAgPSB0aGlzLm5ldHdvcmtOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBjb21wLm9uRGlzbWlzc0NvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzZWxmLm5ldHdvcmtOb2RlID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgY29tcC5zZXRNZXNzYWdlKG1zZyk7XG4gICAgICAgIGNvbXAuYWxlcnQoKTtcbiAgICB9LFxuXG4gICAgaGlkZGVuTmV0d29ya01lc3NhZ2U6ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtOb2RlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya05vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLmRpc21pc3NBY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzaG93QWxlcnRNZXNzYWdlOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgaWYgKCFtc2cpIHtcbiAgICAgICAgICAgIGNjLmVycm9yKFwi5LiN6IO95pi+56S65Li656m655qE5L+h5oGvXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLmFsZXJ0TWVzc2FnZU5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuYWxlcnRNZXNzYWdlTm9kZSA9IGNjLmluc3RhbnRpYXRlKHRoaXMuYWxlcnRQcmVmYWIpO1xuICAgICAgICAgICAgdGhpcy5ub2RlLmFkZENoaWxkKHRoaXMuYWxlcnRNZXNzYWdlTm9kZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFsZXJ0TWVzc2FnZU5vZGUuZ2V0Q29tcG9uZW50KCdhbGVydCcpLnNldE1lc3NhZ2UobXNnKTtcbiAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2VOb2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5hbGVydCgpO1xuICAgIH0sXG59KTtcbiIsImNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY29uc3QgUGxheWJhY2sgPSByZXF1aXJlKCdQbGF5YmFjaycpO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB0aW1lTGFiZWw6Y2MuTGFiZWwsXG4gICAgICAgIG5pY2tuYW1lTGFiZWxzOltjYy5MYWJlbF0sXG4gICAgICAgIHNjb3JlTGFiZWxzOltjYy5MYWJlbF0sXG4gICAgICAgIG51bU5vZGU6Y2MuTGFiZWwsXG4gICAgICAgIF9wYXJlbnRJZDogbnVsbCxcbiAgICAgICAgcGxheWJhY2tOb2RlOmNjLk5vZGUsLy/lm57mlL7mjInpkq5cbiAgICAgICAgd2F0Y2hOb2RlOmNjLk5vZGUsLy/mn6XnnIvmjInpkq5cblxuICAgICAgICBfcmVjb3JkSXRlbUluZm86IG51bGwsXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgIHNldEluZm86IGZ1bmN0aW9uIChyZWNvcmRJbmZvKSB7XG4gICAgICB0aGlzLl9wYXJlbnRJZCA9IHJlY29yZEluZm8uaWQ7XG4gICAgICB0aGlzLnBsYXliYWNrTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMud2F0Y2hOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICBpZiAocmVjb3JkSW5mby5wbGF5ZXJzSW5mby5sZW5ndGggPT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBwbGF5ZXJzSW5mbyA9IEpTT04ucGFyc2UocmVjb3JkSW5mby5wbGF5ZXJzSW5mbyk7XG4gICAgICB0aGlzLnRpbWVMYWJlbC5zdHJpbmcgPSBcIuWvueaImOaXtumXtO+8mlwiICsgcGxheWVyc0luZm8udGltZTtcbiAgICAgIGZvciAodmFyIGkgPSAwO2kgPCBwbGF5ZXJzSW5mby5wbGF5ZXJzLmxlbmd0aDtpKyspIHtcbiAgICAgICAgdGhpcy5uaWNrbmFtZUxhYmVsc1tpXS5zdHJpbmcgPSBwbGF5ZXJzSW5mby5wbGF5ZXJzW2ldLm5pY2tuYW1lO1xuICAgICAgICB0aGlzLnNjb3JlTGFiZWxzW2ldLnN0cmluZyA9IHBsYXllcnNJbmZvLnBsYXllcnNbaV0udG90YWxTY29yZTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xpY2tBY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMuX3JlY29yZEl0ZW1JbmZvKSB7XG4gICAgICAgIGNjLmxvZyhcIueCueWHu+S6huiusOW9leivpuaDhSBpdGVt77yM5byA5ZCv5Zue5pS+XCIpO1xuICAgICAgICB0aGlzLl9zdGFydFBsYXliYWNrKHRoaXMuX3JlY29yZEl0ZW1JbmZvLl9pbmZvOEFycmF5KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAgIFNvY2tldC5zZW5kR2V0SXRlbVJlY29yZChTb2NrZXQuaW5zdGFuY2UudXNlckluZm8uaWQsdGhpcy5fcGFyZW50SWQpO1xuICAgIH0sXG5cbiAgICBfc3RhcnRQbGF5YmFjazogZnVuY3Rpb24gKHBsYXlCYWNrSW5mbykge1xuICAgICAgUGxheWJhY2suaW5zdGFuY2Uuc2V0UGxheWJhY2tEYXRhcyhwbGF5QmFja0luZm8pO1xuICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKCdwbGF5Jyk7XG4gICAgfSxcblxuICAgIGRldGFpbEFjdGlvbjogZnVuY3Rpb24ocmVjb3JkSXRlbUluZm8sIGluZGV4KSB7XG4gICAgICAgIHRoaXMuX3JlY29yZEl0ZW1JbmZvID0gcmVjb3JkSXRlbUluZm87XG4gICAgICAgIHRoaXMucGxheWJhY2tOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMud2F0Y2hOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm51bU5vZGUuc3RyaW5nID0gXCLnrKxcIiArIChpbmRleCArIDEpICsgXCLlsYBcIjtcbiAgICAgICAgdGhpcy50aW1lTGFiZWwuc3RyaW5nID0gXCLlr7nmiJjml7bpl7TvvJpcIiArIHJlY29yZEl0ZW1JbmZvLmNyZWF0QXQ7XG4gICAgICAgIGxldCBvYmpBcnJheSA9IEpTT04ucGFyc2UocmVjb3JkSXRlbUluZm8uaW5mbzgpO1xuICAgICAgICB0aGlzLl9yZWNvcmRJdGVtSW5mby5faW5mbzhBcnJheSA9IG9iakFycmF5O1xuICAgICAgICBsZXQgcGxheWVyc0FycmF5ID0gb2JqQXJyYXkubWFwKGZ1bmN0aW9uKHN0cil7XG4gICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIHBsYXllcnMgPSBwbGF5ZXJzQXJyYXlbcGxheWVyc0FycmF5Lmxlbmd0aC0xXS5kYXRhLnBsYXllcnM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwO2kgPCBwbGF5ZXJzLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgIHRoaXMubmlja25hbWVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc1tpXS5uaWNrbmFtZTtcbiAgICAgICAgICAgIHRoaXMuc2NvcmVMYWJlbHNbaV0uc3RyaW5nID0gcGxheWVyc1tpXS5jU2NvcmU7XG4gICAgICAgIH1cbiAgICB9LFxuXG5cbn0pO1xuIiwiY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldCcpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgc2Nyb2xsVmlldzpjYy5Ob2RlLFxuICAgICAgICBzdWJTY3JvbGxWaWV3OmNjLk5vZGUsXG4gICAgICAgIHJlY29yZEl0ZW06Y2MuUHJlZmFiLFxuICAgICAgICBzdWJSZWNvcmRJdGVtOmNjLlByZWZhYixcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNTdWJQYWdlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zY3JvbGxWaWV3Q29udGVudCA9IHRoaXMuc2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcbiAgICAgICAgdGhpcy5zdWJTY3JvbGxWaWV3Q29udGVudCA9IHRoaXMuc3ViU2Nyb2xsVmlldy5nZXRDb21wb25lbnQoY2MuU2Nyb2xsVmlldykuY29udGVudDtcblxuICAgICAgICB0aGlzLl9yZWdpc3RlclNvY2tldEV2ZW50KCk7XG4gICAgfSxcblxuICAgIF9yZWdpc3RlclNvY2tldEV2ZW50OiBmdW5jdGlvbiAoKSB7XG4gICAgICBLUUdsb2JhbEV2ZW50Lm9uKFNvY2tldC5FdmVudC5HZXRSZWNvcmQsIHRoaXMuX1JlY2VpdmVSZWNvcmRJbmZvLCB0aGlzKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQub24oU29ja2V0LkV2ZW50LkdldEl0ZW1SZWNvcmQsIHRoaXMuX1JlY2VpdmVSZWNvcmRJdGVtLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgX1JlY2VpdmVSZWNvcmRJbmZvOmZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHRoaXMuaXNTdWJQYWdlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zY3JvbGxWaWV3LmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5zY3JvbGxWaWV3Q29udGVudC5yZW1vdmVBbGxDaGlsZHJlbigpO1xuXG4gICAgICAgIHJlc3BvbnNlLmRhdGEuZmlsdGVyKGZ1bmN0aW9uIChyZWNvcmQpIHtcbiAgICAgICAgICByZXR1cm4gcmVjb3JkLnBsYXllcnNJbmZvLmxlbmd0aCA+IDA7XG4gICAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKHJlY29yZEluZm8pIHtcbiAgICAgICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucmVjb3JkSXRlbSk7XG4gICAgICAgICAgdGhpcy5zY3JvbGxWaWV3Q29udGVudC5hZGRDaGlsZChpdGVtKTtcbiAgICAgICAgICB2YXIgY29tcCA9IGl0ZW0uZ2V0Q29tcG9uZW50KCdyZWNvcmRJbmZvJyk7XG4gICAgICAgICAgY29tcC5zZXRJbmZvKHJlY29yZEluZm8pO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBfUmVjZWl2ZVJlY29yZEl0ZW06ZnVuY3Rpb24oUmVjb3JkSXRlbUluZm8pIHtcbiAgICAgICAgdGhpcy5pc1N1YlBhZ2UgPSB0cnVlO1xuICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXcuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zY3JvbGxWaWV3LmFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlld0NvbnRlbnQucmVtb3ZlQWxsQ2hpbGRyZW4oKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBSZWNvcmRJdGVtSW5mby5kYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucmVjb3JkSXRlbSk7XG4gICAgICAgICAgICB0aGlzLnN1YlNjcm9sbFZpZXdDb250ZW50LmFkZENoaWxkKGl0ZW0pO1xuICAgICAgICAgICAgdmFyIGNvbXAgPSBpdGVtLmdldENvbXBvbmVudCgncmVjb3JkSW5mbycpO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBSZWNvcmRJdGVtSW5mby5kYXRhW2ldO1xuICAgICAgICAgICAgY29tcC5kZXRhaWxBY3Rpb24oaW5mbywgaSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY2xvc2VBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmlzU3ViUGFnZSkge1xuICAgICAgICAgICAgdGhpcy5pc1N1YlBhZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuc3ViU2Nyb2xsVmlldy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVmlldy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ub2RlLmdldENvbXBvbmVudCgnYWxlcnQnKS5kaXNtaXNzQWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICAvLyBmb286IHtcbiAgICAgICAgLy8gICAgZGVmYXVsdDogbnVsbCwgICAgICAvLyBUaGUgZGVmYXVsdCB2YWx1ZSB3aWxsIGJlIHVzZWQgb25seSB3aGVuIHRoZSBjb21wb25lbnQgYXR0YWNoaW5nXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxuICAgICAgICAvLyAgICB1cmw6IGNjLlRleHR1cmUyRCwgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHR5cGVvZiBkZWZhdWx0XG4gICAgICAgIC8vICAgIHNlcmlhbGl6YWJsZTogdHJ1ZSwgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHJ1ZVxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcbiAgICAgICAgLy8gICAgZGlzcGxheU5hbWU6ICdGb28nLCAvLyBvcHRpb25hbFxuICAgICAgICAvLyAgICByZWFkb25seTogZmFsc2UsICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIGZhbHNlXG4gICAgICAgIC8vIH0sXG4gICAgICAgIC8vIC4uLlxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgIH0sXG5cbiAgICBjbGlja0V4aXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnaGFsbCcpO1xuICAgIH0sXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNlbGVjdFpodWFuZ0JnOmNjLk5vZGUsXG4gICAgICAgIHNlbGVjdFpodWFuZ1JpZ2h0OmNjLk5vZGUsXG4gICAgICAgIHNlbGVjdFRlU2h1UGFpQmc6Y2MuTm9kZSxcbiAgICAgICAgc2VsZWN0VGVTaHVQYWlSaWdodDpjYy5Ob2RlLFxuICAgICAgICBfemh1YW5nU2VsZWN0ZWQ6bnVsbCwgICAvL+W6hOWutuaooeW8j+aYr+WQpumAieaLqSAgbnVsbOS4uuS4jemAieaLqe+8jDDkuLrpgInmi6lcbiAgICAgICAgX3RlU2h1UGFpU2VsZWN0ZWQ6bnVsbCwgLy/ml6DnibnmrorniYzmqKHlvI/mmK/lkKbpgInmi6kgIG51bGzkuLrkuI3pgInmi6nvvIwx5Li66YCJ5oupXG4gICAgICAgIHNlbGVjdEluZGV4Om51bGwsICAgICAgIC8v5piv5ZCm6YCJ5oup5bqE5a625qih5byP5oiW6ICF5peg54m55q6K54mMICBudWxs5Li65Lik6ICF6YO95LiN6YCJICAw5Li66YCJ5oup5LqG5bqE5a625qih5byPICAx5Li66YCJ5oup5LqG5peg54m55q6K54mM5qih5byPXG4gICAgfSxcblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgfSxcblxuICAgICAgICAvKiMjIyMj54K55Ye75bqE5a625qih5byPKi9cbiAgICBjbGlja1podWFuSmlhS3Vhbmc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy5femh1YW5nU2VsZWN0ZWQgPT0gMCl7XG4gICAgICAgICAgICAvL+ayoemAieS4iuW6hOWutuaooeW8j1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RaaHVhbmdSaWdodC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3podWFuZ1NlbGVjdGVkID0gbnVsbDtcblxuICAgICAgICAgICAgaWYodGhpcy5fdGVTaHVQYWlTZWxlY3RlZCA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy/pgInkuobml6DnibnmrorniYzlsLHkuI3og73pgInluoTlrrbmqKHlvI9cbiAgICAgICAgICAgIGlmKHRoaXMuX3RlU2h1UGFpU2VsZWN0ZWQgPT0gMCl7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RJbmRleCA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLl96aHVhbmdTZWxlY3RlZCA9PSBudWxsKXtcbiAgICAgICAgICAgIC8v6YCJ5LiK54q25oCBXG4gICAgICAgICAgICB0aGlzLnNlbGVjdFpodWFuZ1JpZ2h0LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl96aHVhbmdTZWxlY3RlZCA9IDA7XG4gICAgICAgICAgICAvL+W6hOWutuaooeW8j+mAieS4iueahOaXtuWAmeaXoOeJueauiueJjOW/hemhu+S4uuS4jemAiVxuICAgICAgICAgICAgaWYodGhpcy5fdGVTaHVQYWlTZWxlY3RlZCA9PSAwKXtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFRlU2h1UGFpUmlnaHQuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGVTaHVQYWlTZWxlY3RlZCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlbGVjdEluZGV4ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnNlbGVjdEluZGV4KTtcbiAgICB9LFxuXG4gICAgLyojIyMjI+eCueWHu+aXoOeJueauiueJjOeahOmAieaLqeahhiovXG4gICAgY2xpY2tUZVNodVBhaUt1YW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuX3RlU2h1UGFpU2VsZWN0ZWQgPT0gMCl7XG4gICAgICAgICAgICAvL+ayoemAieS4ilxuICAgICAgICAgICAgdGhpcy5zZWxlY3RUZVNodVBhaVJpZ2h0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fdGVTaHVQYWlTZWxlY3RlZCA9IG51bGw7XG5cbiAgICAgICAgICAgIC8v5aaC5p6c5bqE5a625qih5byP5Lmf5rKh6YCJ5LiKXG4gICAgICAgICAgICBpZih0aGlzLl96aHVhbmdTZWxlY3RlZCA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0SW5kZXggPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgLy/ngrnlh7vnmoTml7blgJnmiorli77lj7fmiZPlvIDvvIzlsLHmmK/pgInkuIrnirbmgIFcbiAgICAgICAgZWxzZSBpZih0aGlzLl90ZVNodVBhaVNlbGVjdGVkID09IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RUZVNodVBhaVJpZ2h0LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl90ZVNodVBhaVNlbGVjdGVkID0gMDtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0SW5kZXggPSAxO1xuXG4gICAgICAgICAgICBpZih0aGlzLl96aHVhbmdTZWxlY3RlZCA9PSAwKXtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdFpodWFuZ1JpZ2h0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3podWFuZ1NlbGVjdGVkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEluZGV4ID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnNlbGVjdEluZGV4KTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIC8vIGZvbzoge1xyXG4gICAgICAgIC8vICAgIGRlZmF1bHQ6IG51bGwsICAgICAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgd2lsbCBiZSB1c2VkIG9ubHkgd2hlbiB0aGUgY29tcG9uZW50IGF0dGFjaGluZ1xyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gYSBub2RlIGZvciB0aGUgZmlyc3QgdGltZVxyXG4gICAgICAgIC8vICAgIHVybDogY2MuVGV4dHVyZTJELCAgLy8gb3B0aW9uYWwsIGRlZmF1bHQgaXMgdHlwZW9mIGRlZmF1bHRcclxuICAgICAgICAvLyAgICBzZXJpYWxpemFibGU6IHRydWUsIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICB2aXNpYmxlOiB0cnVlLCAgICAgIC8vIG9wdGlvbmFsLCBkZWZhdWx0IGlzIHRydWVcclxuICAgICAgICAvLyAgICBkaXNwbGF5TmFtZTogJ0ZvbycsIC8vIG9wdGlvbmFsXHJcbiAgICAgICAgLy8gICAgcmVhZG9ubHk6IGZhbHNlLCAgICAvLyBvcHRpb25hbCwgZGVmYXVsdCBpcyBmYWxzZVxyXG4gICAgICAgIC8vIH0sXHJcbiAgICAgICAgLy8gLi4uXHJcbiAgICAgICAgcGFpOmNjLk5vZGUsXHJcbiAgICAgICAgbWFwYWk6e1xyXG4gICAgICAgICAgICBkZWZhdWx0OltdLFxyXG4gICAgICAgICAgICB0eXBlOmNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RNYSA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJzZWxlY3RfbWFcIik7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RNYS5vbkxvYWQoKTtcclxuICAgICAgICB0aGlzLmNvbSA9IHRoaXMucGFpLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgfSxcclxuICAgIFxyXG4gICAgY2xpY2tCdG5Db21maXJtOmZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuY29tLnNwcml0ZUZyYW1lID0gdGhpcy5tYXBhaVtjYy5mcm9tLm1hXTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuY29tLnNwcml0ZUZyYW1lKTtcclxuICAgIH0sXHJcbiAgICBcclxuXHJcbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xyXG4gICAgLy8gdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcclxuXHJcbiAgICAvLyB9LFxyXG59KTtcclxuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgcmlnaHRJY29uOltjYy5Ob2RlXSxcbiAgICAgICAgbWFwYWlSaWdodDpjYy5Ob2RlXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZihjYy5mcm9tID09IG51bGwpe1xuICAgICAgICAgICAgY2MuZnJvbSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIC8v5aaC5p6c5LiN5bim6ams77yM5YiZ6ams54mM5Li656m6XG4gICAgICAgIGlmKHRoaXMubWFwYWlSaWdodC5hY3RpdmUgPT0gZmFsc2Upe1xuICAgICAgICAgICAgY2MuZnJvbS5pc1VzZU1hID0gZmFsc2U7XG4gICAgICAgICAgICBjYy5mcm9tLm1hID0gbnVsbDtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBjYy5mcm9tLmlzVXNlTWEgPSB0cnVlO1xuICAgICAgICAgICAgLy/lkKbliJnpqazniYzpu5jorqTkuLrnrKww5Liq77yM5Y2z6buR5qGDNVxuICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLnJpZ2h0SWNvbi5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICBpZihpPT0wKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodEljb25baV0uYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjYy5mcm9tLm1hID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodEljb25baV0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSxcbiAgICBvbk1hUGFpQ2xpY2s6ZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIgdGFyZ2V0TmFtZSA9IGUudGFyZ2V0Lm5hbWU7XG4gICAgICAgIGNjLmxvZyh0YXJnZXROYW1lKVxuICAgICAgICBpZih0YXJnZXROYW1lICE9IHRoaXMuc2VsZWN0LnBhcmVudC5uYW1lKSB7XG4gICAgICAgICAgICBpZih0YXJnZXROYW1lID09IFwic2VsZWN0X2t1YW5nMVwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3QgPSB0aGlzLnJpZ2h0SWNvblsyXTtcbiAgICAgICAgICAgICAgICBjYy5mcm9tLm1hID0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYodGFyZ2V0TmFtZSA9PSBcInNlbGVjdF9rdWFuZzJcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5yaWdodEljb25bMV07XG4gICAgICAgICAgICAgICAgY2MuZnJvbS5tYSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRhcmdldE5hbWUgPT0gXCJzZWxlY3Rfa3VhbmczXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdCA9IHRoaXMucmlnaHRJY29uWzBdO1xuICAgICAgICAgICAgICAgIGNjLmZyb20ubWEgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLnJpZ2h0SWNvbi5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0SWNvbltpXS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coY2MuZnJvbS5tYSk7XG4gICAgfVxuXG5cbn0pO1xuIiwiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYmdOb2RlOmNjLk5vZGUsICAgLy/pgInmi6nmoYZcbiAgICAgICAgc2VsZWN0ZWROb2RlOmNjLk5vZGUsICAvL+WvueWPt1xuICAgICAgICBwYWk6Y2MuTm9kZSxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSB0cnVlO1xuICAgIH0sXG4gICAgXG4gICAgY2xpY2tBY3Rpb246ZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSAhdGhpcy5zZWxlY3RlZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID0gdGhpcy5zZWxlY3RlZDtcbiAgICB9LFxuICAgIFxuICAgIHNldFNlbGVjdGVkOmZ1bmN0aW9uKHNlbGVjdGVkKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBzZWxlY3RlZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUuYWN0aXZlID0gdGhpcy5zZWxlY3RlZDtcbiAgICB9LFxuXG5cbiAgICAvKiMjIyMjKi9cbiAgICBjbGlja1NlbGVjdEt1YW5nOmZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gIXRoaXMuc2VsZWN0ZWQ7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLmFjdGl2ZSA9IHRoaXMuc2VsZWN0ZWQ7XG4gICAgICAgIGNjLmZyb20uaXNVc2VNYSA9IHRoaXMuc2VsZWN0ZWQ7XG4gICAgICAgIHZhciBtYXBhaUNvbSA9IHRoaXMucGFpLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xuICAgICAgICBpZih0aGlzLnNlbGVjdGVkTm9kZS5hY3RpdmUgPT09IGZhbHNlKXtcbiAgICAgICAgICAgIG1hcGFpQ29tLmludGVyYWN0YWJsZSA9IGZhbHNlO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIG1hcGFpQ29tLmludGVyYWN0YWJsZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG5cbiAgICAvLyBjYWxsZWQgZXZlcnkgZnJhbWUsIHVuY29tbWVudCB0aGlzIGZ1bmN0aW9uIHRvIGFjdGl2YXRlIHVwZGF0ZSBjYWxsYmFja1xuICAgIC8vIHVwZGF0ZTogZnVuY3Rpb24gKGR0KSB7XG5cbiAgICAvLyB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBub2RlczpbY2MuTm9kZV0sXG4gICAgICAgIHNlbGVjdGVkSW5kZXg6IDAsXG4gICAgfSxcbi8q5Y6f5p2l55qEKi9cbi8qICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IGlzU2VsZWN0ZWQgPSAodGhpcy5zZWxlY3RlZEluZGV4ID09IGkpO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGlzU2VsZWN0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRDb21wID0gdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgdENvbXAuaW5kZXggPSBpO1xuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXAgPSBzZWxmLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0U2VsZWN0ZWQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRydWUpO1xuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRJbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgICAgICAgICAgICAgc2VsZi5vblNlbGVjdENoYW5nZSh0aGlzLmluZGV4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LFxuKi9cbiAgICAvKiMjIyMqL1xuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IGlzU2VsZWN0ZWQgPSAodGhpcy5zZWxlY3RlZEluZGV4ID09IGkpO1xuICAgICAgICAgICAgdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpLnNldFNlbGVjdGVkKGlzU2VsZWN0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHRDb21wID0gdGhpcy5ub2Rlc1tpXS5nZXRDb21wb25lbnQoJ3NlbGVjdCcpO1xuICAgICAgICAgICAgdENvbXAuaW5kZXggPSBpO1xuICAgICAgICAgICAgdENvbXAuY2xpY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXAgPSBzZWxmLm5vZGVzW2ldLmdldENvbXBvbmVudCgnc2VsZWN0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbXAuc2V0U2VsZWN0ZWQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkKHRydWUpO1xuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRJbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgICAgICAgICAgICAgc2VsZi5vblNlbGVjdENoYW5nZSh0aGlzLmluZGV4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uIChzZWxlY3RJbmRleCkge1xuICAgICAgICBjYy5sb2coc2VsZWN0SW5kZXgpO1xuICAgIH0sXG4gICAgXG59KTtcbiIsImNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGluZGljYXRvck5vZGU6Y2MuTm9kZSxcbiAgICAgICAgYmFja2dyb3VuZE5vZGU6Y2MuTm9kZSxcbiAgICAgICAgc2VsZWN0ZWROb2RlOmNjLk5vZGUsXG5cbiAgICAgICAgdmFsdWU6MCxcbiAgICB9LFxuXG4gICAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5pbmRpY2F0b3JOb2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaW5kaWNhdG9yTm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFLGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcHQgPSBzZWxmLm5vZGUuY29udmVydFRvTm9kZVNwYWNlKGNjLnYyKGV2ZW50LmdldExvY2F0aW9uWCgpLGV2ZW50LmdldExvY2F0aW9uWSgpKSk7XG4gICAgICAgICAgICBzZWxmLnVwZGF0ZVNsaWRlcihwdCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcHQgPSBzZWxmLm5vZGUuY29udmVydFRvTm9kZVNwYWNlKGNjLnYyKGV2ZW50LmdldExvY2F0aW9uWCgpLGV2ZW50LmdldExvY2F0aW9uWSgpKSk7XG4gICAgICAgICAgICBzZWxmLnVwZGF0ZVNsaWRlcihwdCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluZGljYXRvck5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcHQgPSBzZWxmLm5vZGUuY29udmVydFRvTm9kZVNwYWNlKGNjLnYyKGV2ZW50LmdldExvY2F0aW9uWCgpLGV2ZW50LmdldExvY2F0aW9uWSgpKSk7XG4gICAgICAgICAgICBzZWxmLnVwZGF0ZVNsaWRlcihwdCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vdGhpcy5tYXhXaWR0aCA9IHRoaXMubm9kZS53aWR0aCAtIDQwO1xuICAgICAgICB0aGlzLm1heFdpZHRoID0gdGhpcy5ub2RlLndpZHRoLTI4O1xuICAgICAgICB0aGlzLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgIH0sXG5cbiAgICB1cGRhdGVTbGlkZXI6ZnVuY3Rpb24ocHQpIHtcbiAgICAgICAgdmFyIHggPSBwdC54O1xuICAgICAgICBpZiAoeCA8IDApIHtcbiAgICAgICAgICAgIHggPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHggPiB0aGlzLm1heFdpZHRoKSB7XG4gICAgICAgICAgICB4ID0gdGhpcy5tYXhXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldFZhbHVlKHgvdGhpcy5tYXhXaWR0aCk7XG4gICAgICAgIHRoaXMub25WYWx1ZUNoYW5nZSh0aGlzLnZhbHVlKTtcbiAgICB9LFxuXG4gICAgLyowIC0gMSovXG4gICAgc2V0VmFsdWU6ZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBpZiAodGhpcy52YWx1ZSA8IDApIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZhbHVlID4gMSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgLy90aGlzLm1heFdpZHRoID0gdGhpcy5ub2RlLndpZHRoIC0gMzg7XG4gICAgICAgIHRoaXMubWF4V2lkdGggPSB0aGlzLm5vZGUud2lkdGgtMjg7XG4gICAgICAgIHRoaXMuaW5kaWNhdG9yTm9kZS54ID0gdGhpcy52YWx1ZSAqIHRoaXMubWF4V2lkdGgrMTA7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlLndpZHRoID0gdGhpcy52YWx1ZSAqIHRoaXMubWF4V2lkdGggKyB0aGlzLmluZGljYXRvck5vZGUud2lkdGgvMjtcbiAgICB9LFxuXG4gICAgb25WYWx1ZUNoYW5nZTpmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICBjYy5sb2codmFsdWUpO1xuICAgIH0sXG59KTtcbiIsInZhciBtYW5hZ2VyID0gcmVxdWlyZSgnbWFuYWdlcicpO1xuY29uc3QgS1FHbG9iYWxFdmVudCA9IHJlcXVpcmUoJ0tRR2xvYmFsRXZlbnQnKTtcbmNvbnN0IEtRTmF0aXZlSW52b2tlID0gcmVxdWlyZSgnS1FOYXRpdmVJbnZva2UnKTtcblxubGV0IFNvY2tldENvbnN0YW50ID0ge1xuICBNYXhSZWNvbm5lY3RDaGVja0ludGVydmFsOiA1LCAvLyDph43ov57mo4DmtYvml7bpl7TniYdcbn07XG5cbi8qKlxuICog6L+Z5piv5a+5IFdlYlNvY2tldCDnmoTkuIDkuKrlsIHoo4VcbiAqIFxuICog6YeM6Z2i5YyF5ZCr6Ieq5Yqo6YeN6L+e55qE5Yqf6IO9XG4gKi9cbmxldCBTb2NrZXQgPSBjYy5DbGFzcyh7XG4gIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICBwcm9wZXJ0aWVzOiB7XG4gICAgX2xhc3RSZWNlaXZlTXNnVGltZTogMCwgLy8g5pyA5ZCO5LiA5qyh5pS25Yiw5raI5oGv5pe26Ze0KOavq+enkilcbiAgICBfdGltZW91dDogOCwgLy8g6LaF5pe25pe26ZW/IO+8iOenku+8iVxuICB9LFxuXG4gIHN0YXRpY3M6IHtcbiAgICBpbnN0YW5jZTogbnVsbCxcbiAgICB1cmw6ICd3czovLzM5LjEwOC4xMTIuMTE6NTAwMScsXG4gICAgIC8vdXJsOlwid3M6Ly8xOTIuMTY4LjAuMTIwOjUwMDFcIixcbiAgICAvL3VybDpcIndzOi8vMTgzLjMuMjA1LjE0OTo1MDAyXCIsXG4gIH0sXG5cbiAgLy8gdXNlIHRoaXMgZm9yIGluaXRpYWxpemF0aW9uXG4gIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgIFNvY2tldC5pbnN0YW5jZSA9IHRoaXM7XG5cbiAgICB0aGlzLm5hbWUgPSBcInNvY2tldFwiO1xuXG4gICAgY2MuZ2FtZS5hZGRQZXJzaXN0Um9vdE5vZGUodGhpcy5ub2RlKTtcbiAgICBpZiAoY2MuZ2FtZS5pc1BlcnNpc3RSb290Tm9kZSh0aGlzLm5vZGUpKSB7XG4gICAgICBjYy5sb2coJ+a3u+WKoOWFqOWxgOiKgueCuSBTb2NrZXQg5oiQ5YqfJyk7XG4gICAgfVxuXG4gICAgdGhpcy5fcmVnaXN0ZXJBcHBBY3RpdmVDaGFuZ2UoKTtcblxuICAgIHRoaXMuaXNDcmVhdGluZyA9IGZhbHNlO1xuICAgIHRoaXMuY3JlYXRlSW5kZXggPSAwO1xuICAgIHRoaXMuY3JlYXRlU29ja2V0KCk7XG5cbiAgICB0aGlzLnNjaGVkdWxlKGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY2hlY2tDb25uZWN0aW9uKCk7XG4gICAgfSwgNSk7XG5cbiAgICB0aGlzLnJlY3ZUaW1lID0gRGF0ZS5ub3coKTsgLy/mjqXmlLbliLDmnIDmlrDkuIDmnaHmnI3liqHlmajnmoTkv6Hmga/nmoTml7bpl7RcbiAgICAvL2NjLmxvZyhtYW5hZ2VyLnZlcnNpb24pO1xuXG4gICAgdGhpcy5fY2hlY2tTb2NrZXQoKTtcbiAgfSxcblxuICBjaGVja0Nvbm5lY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICAvL+WuouaIt+err+WumuaXtue7meacjeWKoeerr+WPkemAgeeCueaVsOaNru+8jOmYsuatoui/nuaOpeeUseS6jumVv+aXtumXtOayoeaciemAmuiur+iAjOiiq+afkOS6m+iKgueCueeahOmYsueBq+WimeWFs+mXreWvvOiHtOi/nuaOpeaWreW8gOeahOaDheWGteOAglxuICAgIHRoaXMuc2VuZE1lc3NhZ2UoJ2NoZWNrQWN0aW9uJywgJycpO1xuICB9LFxuXG4gIGNyZWF0ZVNvY2tldDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLmNyZWF0ZUluZGV4Kys7IC8v5Yib5bu65qyh5pWw5YqgMVxuICAgIGlmICh0aGlzLmNyZWF0ZUluZGV4ID4gNSkge1xuICAgICAgdGhpcy5uZXR3b3JrRXJyb3IoKTtcbiAgICAgIEtRTmF0aXZlSW52b2tlLmZvcmNlRXhpdEFwcCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmlzQ3JlYXRpbmcgPSB0cnVlO1xuXG4gICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXRDb25uZWN0aW5nKTtcbiAgICB0aGlzLndzID0gbmV3IFdlYlNvY2tldChTb2NrZXQudXJsKTtcbiAgICBpZiAodGhpcy53cyA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5uZXR3b3JrRXJyb3IoKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdEVycm9yLCB7J2RhdGEnOiAnU29ja2V0IOWIm+W7uuWksei0pSd9KTtcbiAgICAgIEtRTmF0aXZlSW52b2tlLmZvcmNlRXhpdEFwcCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNvY2tldEVycm9yID0gZmFsc2U7XG5cbiAgICAvLyBzb2NrZXQg6L+e5o6l5oiQ5YqfXG4gICAgdGhpcy53cy5vbm9wZW4gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIC8vY2MubG9nKFwiV2ViU29ja2V0IOi/nuaOpeaIkOWKn++8mlwiLCBldmVudCk7XG4gICAgICBcbiAgICAgIHNlbGYuX2xhc3RSZWNlaXZlTXNnVGltZSA9IGNjLnN5cy5ub3coKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0Q29ubmVjdFN1Y2Nlc3NlZCwgZXZlbnQpO1xuXG4gICAgICBzZWxmLmlzQ3JlYXRpbmcgPSBmYWxzZTtcbiAgICAgIHNlbGYuc29ja2V0RXJyb3IgPSBmYWxzZTtcbiAgICAgIHNlbGYuY3JlYXRlSW5kZXggPSAwO1xuICAgICAgc2VsZi5jb25uZWN0aW9uU3VjY2VzcygpO1xuICAgICAgc2VsZi5zZW5kUmVjb25uZWN0SW5mbygpO1xuICAgIH07XG5cbiAgICAvLyBzb2NrZXQg5o6l5pS25Yiw5raI5oGvXG4gICAgdGhpcy53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIHNlbGYuX2xhc3RSZWNlaXZlTXNnVGltZSA9IGNjLnN5cy5ub3coKTtcbiAgICAgIEtRR2xvYmFsRXZlbnQuZW1pdChTb2NrZXQuRXZlbnQuU29ja2V0UmVjZWl2ZU1lc3NhZ2UsIGV2ZW50LmRhdGEpO1xuXG4gICAgICBzZWxmLmlzQ3JlYXRpbmcgPSBmYWxzZTtcbiAgICAgIHNlbGYuc29ja2V0RXJyb3IgPSBmYWxzZTtcbiAgICAgIHNlbGYucmVjZXZpY2VNZXNzYWdlKGV2ZW50LmRhdGEpO1xuICAgICAgc2VsZi5fZGlzcGF0Y2hSZXNwb25zZShldmVudC5kYXRhKTtcbiAgICAgIHNlbGYucmVjdlRpbWUgPSBEYXRlLm5vdygpOyAvL+aOpeaUtuacgOaWsOS4gOadoeS/oeaBr+eahOaXtumXtFxuXG4gICAgICAvKiovXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIHNvY2tldCDlj5HnlJ/plJnor69cbiAgICAgKiBcbiAgICAgKiBzb2NrZXQg5pys6Lqr5pyJIGBvbmVycm9yYCDlm57osIPvvIzkvYbkuovlrp7or4HmmI7vvIzlhbbkuI3pnaDosLHvvIxcbiAgICAgKiDmnInlvojlpKfnmoTmnLrnjofmnInor6/miqXnmoTooYzkuLrvvIzluLjluLjlnKjmsqHmnInplJnor6/ml7bvvIzkvJrnu5nplJnor6/lm57osIPjgIJcbiAgICAgKiDkuJTkuI3og73lrprliLbotoXml7bml7bplb9cbiAgICAgKiBcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBcbiAgICAgKi9cbiAgICB0aGlzLndzLl9rcV9vbmVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgIGNjLmVycm9yKGBXZWJTb2NrZXQg6L+e5o6l6ZSZ6K+v77yaJHttZXNzYWdlfWApO1xuXG4gICAgICBLUUdsb2JhbEV2ZW50LmVtaXQoU29ja2V0LkV2ZW50LlNvY2tldENvbm5lY3RFcnJvciwge2RhdGE6IG1lc3NhZ2V9KTtcbiAgICAgIHNlbGYud3MuY2xvc2UoKTtcbiAgICAgIGlmICghc2VsZi53cykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIOiZveeEtuiwg+eUqOS6hiB3ZWJzb2NrZXQg55qEIGNsb3NlIOaWueazle+8jOS9huaYr1xuICAgICAgLy8g5a6D5bm25Lya56uL5Y2z6LCD55SoIG9uY2xvc2Ug5Zue6LCD77yM6ICM5piv5Zyo5pyq5p2l55qE5p+QXG4gICAgICAvLyDkuIDml7bpl7Tlho3lm57osIMgb25jbG9zZe+8m+S9hui/memHjOaYjuaYvuWPr+S7peebtOaOpeWbnuiwg+S6huOAglxuICAgICAgbGV0IHdzID0gc2VsZi53cztcblxuICAgICAgc2VsZi53cy5vbmNsb3NlKCk7XG4gICAgICB3cy5vbmNsb3NlID0gZnVuY3Rpb24oKXt9O1xuICAgIH07XG5cbiAgICAvLyBzb2NrZSDlt7LlhbPpl61cbiAgICB0aGlzLndzLm9uY2xvc2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIC8vY2MubG9nKCdXZWJTb2NrZXQg5bey5YWz6ZetIGNsb3NlIHRpbWU9JyArIERhdGUubm93KCkgKyBcIiBldmVudDogXCIgKyBldmVudCk7XG5cblxuICAgICAgc2VsZi5pc0NyZWF0aW5nID0gZmFsc2U7XG4gICAgICBzZWxmLnNvY2tldEVycm9yID0gdHJ1ZTtcbiAgICAgIHNlbGYud3MgPSBudWxsO1xuICAgICAgc2VsZi5jb25uZWN0aW9uRGlzY29ubmVjdCgpO1xuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KFNvY2tldC5FdmVudC5Tb2NrZXREaXNjb25uZWN0LCBldmVudCk7XG4gICAgICAvL2NjLmxvZygnc29ja2V0IGNsb3NlJytKU09OLnN0cmluZ2lmeShldmVudCkpO1xuICAgIH07XG4gIH0sXG5cbiAgcmVjb25uZWN0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghc2VsZi5pc0NyZWF0aW5nICYmIHNlbGYuc29ja2V0RXJyb3IpIHtcbiAgICAgICAgc2VsZi5jcmVhdGVTb2NrZXQoKTtcbiAgICAgIH1cbiAgICB9LCAyKTtcbiAgfSxcblxuICBzZW5kUmVjb25uZWN0SW5mbzogZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy51c2VySW5mbyAhPSBudWxsKSB7XG4gICAgICAgIHZhciB1c2VySWQgPSBzZWxmLnVzZXJJbmZvLnVzZXJfaWQgfHwgc2VsZi51c2VySW5mby5pZDtcbiAgICAgICAgc2VsZi5zZW5kTWVzc2FnZSgncmVjb25uZWN0Jywge1xuICAgICAgICAgICd1c2VySWQnOiB1c2VySWRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSwgMSk7XG4gIH0sXG5cbiAgcmVjZXZpY2VNZXNzYWdlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICB9LFxuXG4gIGNvbm5lY3Rpb25EaXNjb25uZWN0OiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICBjb25uZWN0aW9uU3VjY2VzczogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgbmV0d29ya0Vycm9yOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICBjaGVja05ldHdvcmtTdGFydDogZnVuY3Rpb24gKCkge1xuXG4gIH0sXG5cbiAgY2hlY2tOZXR3b3JrRW5kOiBmdW5jdGlvbiAoKSB7XG5cbiAgfSxcblxuICBfZGlzcGF0Y2hSZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlU3RyaW5nKSB7XG4gICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg5o6l5pS25Yiw5pyN5Yqh5Zmo5raI5oGv77yaXCIsIHJlc3BvbnNlU3RyaW5nKTtcbiAgICBsZXQgcmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3BvbnNlU3RyaW5nKTtcbiAgICBsZXQgYWN0aW9uID0gcmVzcG9uc2VbXCJhY3Rpb25cIl07XG4gICAgaWYgKGFjdGlvbikge1xuICAgICAgS1FHbG9iYWxFdmVudC5lbWl0KGFjdGlvbiwgcmVzcG9uc2UpO1xuICAgIH1cbiAgfSxcblxuICAvLyBNQVJLOiDliY3lkI7lj7Dmk43kvZxcbiAgX3JlZ2lzdGVyQXBwQWN0aXZlQ2hhbmdlOiBmdW5jdGlvbiAoKSB7XG4gICAgLy9jYy5sb2coXCJXZWJTb2NrZXQg5rOo5YaM5bqU55So6L+b5YWl5YmN44CB5ZCO5Y+w5LqL5Lu2XCIpO1xuICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9ISURFLCB0aGlzLl9hcHBFbnRlckJhY2tncm91bmQsIHRoaXMpO1xuICAgIGNjLmdhbWUub24oY2MuZ2FtZS5FVkVOVF9TSE9XLCB0aGlzLl9hcHBCZWNvbUFjdGl2ZSwgdGhpcyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIOi/m+WFpeWQjuWPsFxuICAgKi9cbiAgX2FwcEVudGVyQmFja2dyb3VuZDogZnVuY3Rpb24gKCkge1xuICAgIGxldCBub3cgPSBjYy5zeXMubm93KCk7XG4gICAgaWYgKG5vdyAtIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lIDwgMTAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2xhc3RBcHBFbnRlckJhY2tncm91bmRUaW1lID0gbm93O1xuICAgIFxuICAgIC8vY2MubG9nKFwiV2ViU29ja2V0IOajgOa1i+WIsOW6lOeUqOi/m+WFpeWQjuWPsO+8mlwiLCBuZXcgRGF0ZSgpKTtcbiAgICBsZXQgaWQgPSB0aGlzLnVzZXJJbmZvID8gdGhpcy51c2VySW5mby5pZCA6IHVuZGVmaW5lZDtcbiAgICBTb2NrZXQuc2VuZEFwcFBhdXNlKGlkKTtcbiAgICB0aGlzLl9jYW5jZWxDaGVja1NvY2tldCgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiDov5vlhaXliY3lj7AgXG4gICAqL1xuICBfYXBwQmVjb21BY3RpdmU6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm93ID0gY2Muc3lzLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLl9sYXN0QXBwQmVjb21BY3RpdmVUaW1lIDwgMTAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX2xhc3RBcHBCZWNvbUFjdGl2ZVRpbWUgPSBub3c7XG5cbiAgICAvL2NjLmxvZyhcIldlYlNvY2tldCDmo4DmtYvliLDlupTnlKjov5vlhaXliY3lj7DvvJpcIiwgbmV3IERhdGUoKSk7XG4gICAgbGV0IGlkID0gdGhpcy51c2VySW5mbyA/IHRoaXMudXNlckluZm8uaWQgOiB1bmRlZmluZWQ7XG4gICAgU29ja2V0LnNlbmRBcHBBY3RpdmUoaWQpO1xuICAgIHRoaXMuX2NoZWNrU29ja2V0KCk7XG5cbiAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpIHtcbiAgICAgIHRoaXMuX2NoZWNrU29ja2V0RXhlY3V0ZSgpO1xuICAgIH0uYmluZCh0aGlzKSwgMS41KTtcbiAgfSxcblxuICAvL+i/m+WFpeWQjuWPsOaTjeS9nFxuICBlbnRlcmJhY2tncm91ZEFjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuX2FwcEVudGVyQmFja2dyb3VuZCgpO1xuICB9LFxuXG4gIC8v6L+b5YWl5YmN5Y+w5pON5L2cXG4gIHJlc3VtZUFjdGlvbjogZnVuY3Rpb24gKCkge1xuICAgIC8v5qOA5p+l572R57ucXG4gICAgdGhpcy5fY2hlY2tOZXR3b3JrKCk7XG4gICAgdGhpcy5fYXBwQmVjb21BY3RpdmUoKTtcbiAgfSxcblxuICBzZW5kTWVzc2FnZTogZnVuY3Rpb24gKGFjdGlvbiwgZGF0YSkge1xuICAgIGRhdGEgPSB0aGlzLl9zdHJvbmdWZXJpZnlEYXRhKGRhdGEpO1xuXG4gICAgaWYgKHRoaXMuc29ja2V0RXJyb3IpIHtcbiAgICAgIGNjLmVycm9yKFwic29ja2V0IOi/nuaOpemUmeivr++8mlwiICsgdGhpcy5zb2NrZXRFcnJvcik7XG4gICAgICB0aGlzLnJlY29ubmVjdCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvL2NjLmxvZygnV2ViU29ja2V0IOWPkemAgea2iOaBr++8micgKyBhY3Rpb24sIGRhdGEpO1xuICAgIGlmIChjYy5zeXMuaXNPYmplY3RWYWxpZCh0aGlzLndzKSkge1xuICAgICAgaWYgKHRoaXMud3MucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcbiAgICAgICAgdGhpcy53cy5zZW5kKHRoaXMuX2NvbnZlcnRQYXJhbWV0ZXJUb1N0cmluZyhhY3Rpb24sIGRhdGEpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb25uZWN0aW9uRGlzY29ubmVjdCgpO1xuICAgIH1cbiAgfSxcblxuICBfc3Ryb25nVmVyaWZ5RGF0YTogZnVuY3Rpb24oZGF0YSA9IHt9KSB7XG4gICAgaWYgKCh0eXBlb2YgZGF0YSkgPT0gJ3N0cmluZycpIHtcbiAgICAgIGRhdGEgPSB7XCJzdHJpbmdcIjogZGF0YX07XG4gICAgfVxuXG4gICAgaWYgKGRhdGEgPT0gbnVsbCkge1xuICAgICAgZGF0YSA9IHt9O1xuICAgIH1cblxuICAgIGlmICghZGF0YVtcInVzZXJJZFwiXSkge1xuICAgICAgaWYgKHRoaXMudXNlckluZm8gJiYgKHR5cGVvZiB0aGlzLnVzZXJJbmZvKSA9PSAnb2JqZWN0JyAmJiB0aGlzLnVzZXJJbmZvLmlkKSB7XG4gICAgICAgIGRhdGFbXCJ1c2VySWRcIl0gPSB0aGlzLnVzZXJJbmZvLmlkO1xuICAgICAgfVxuXG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9LFxuXG4gIF9jb252ZXJ0UGFyYW1ldGVyVG9TdHJpbmc6IGZ1bmN0aW9uIChhY3Rpb24sIGRhdGEgPSB7fSkge1xuICAgIHZhciBvYmogPSB7fTtcbiAgICBvYmouYWN0aW9uID0gYWN0aW9uO1xuICAgIG9iai5kYXRhID0gZGF0YTtcbiAgICBcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgfSxcblxuICAvLyDmo4Dmn6XnvZHnu5xcbiAgX2NoZWNrTmV0d29yazogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmNoZWNrTmV0d29ya05vdykge1xuICAgICAgdGhpcy5jaGVja05ldHdvcmtOb3coKTtcbiAgICB9XG5cbiAgICB0aGlzLnNob3VsZENoZWNrID0gdHJ1ZTtcbiAgICBpZiAoIXRoaXMuc29ja2V0RXJyb3IpIHtcbiAgICAgIHRoaXMucmVjdlRpbWUgPSAwO1xuICAgICAgdGhpcy5zZW5kTWVzc2FnZSgnY2hlY2tBY3Rpb24nLCAnJyk7XG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2hlY2tOZXR3b3JrRW5kKCk7XG4gICAgICAgIHRoaXMuc2hvdWxkQ2hlY2sgPSBmYWxzZTtcbiAgICAgICAgaWYgKHRoaXMucmVjdlRpbWUgPT09IDApIHtcbiAgICAgICAgICB0aGlzLmNvbm5lY3Rpb25EaXNjb25uZWN0KCk7XG4gICAgICAgIH1cbiAgICAgIH0sIDIuNSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvbkRpc2Nvbm5lY3QoKTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gTUFSSzogc29ja2V0IOaOiee6v+WwveaXqeehruiupFxuICBfY2hlY2tTb2NrZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnNjaGVkdWxlKHRoaXMuX2NoZWNrU29ja2V0RXhlY3V0ZSwgU29ja2V0Q29uc3RhbnQuTWF4UmVjb25uZWN0Q2hlY2tJbnRlcnZhbCwgY2MubWFjcm8uUkVQRUFUX0ZPUkVWRVIpO1xuICB9LFxuXG4gIF9jYW5jZWxDaGVja1NvY2tldDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudW5zY2hlZHVsZSh0aGlzLl9jaGVja1NvY2tldEV4ZWN1dGUpO1xuICB9LFxuXG4gIF9jaGVja1NvY2tldEV4ZWN1dGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5faXNTb2NrZXRUaW1lb3V0KCkgJiYgdGhpcy53cykge1xuICAgICAgdGhpcy53cy5fa3Ffb25lcnJvcign6L+e5o6l6LaF5pe2Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9LFxuXG4gIC8vIHNvY2tldCDmmK/lkKblt7LotoXml7ZcbiAgX2lzU29ja2V0VGltZW91dDogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLl9sYXN0UmVjZWl2ZU1lc3NhZ2VJbnRlcnZhbCgpID49IHRoaXMuX3RpbWVvdXQ7XG4gIH0sXG5cbiAgLy8g5LiK5LiA5qyh5pS25Yiw5raI5oGv5Yiw546w5Zyo55qE5pe26Ze06Ze06ZqUXG4gIF9sYXN0UmVjZWl2ZU1lc3NhZ2VJbnRlcnZhbDogZnVuY3Rpb24gKCkge1xuICAgIGxldCBub3cgPSBjYy5zeXMubm93KCk7XG4gICAgbGV0IGludGVydmFsID0gKG5vdyAtIHRoaXMuX2xhc3RSZWNlaXZlTXNnVGltZSkgLyAxMDAwO1xuICAgIC8vY2MubG9nKGBXZWJTb2NrZXQg546w5Zyo6Led5LiK5LiA5p2h5pS25Yiw5raI5oGv55qE5pe26Ze06Ze06ZqU5piv77yaJHtpbnRlcnZhbH0g56eSYCk7XG4gICAgcmV0dXJuIGludGVydmFsO1xuICB9LFxuXG59KTtcblxuLy8gTUFSSzogU29ja2V0IOS6i+S7tuWumuS5iVxuU29ja2V0LkV2ZW50ID0ge1xuICBTb2NrZXRDb25uZWN0aW5nOiBcIlNvY2tldENvbm5lY3RpbmdcIiwgICAgICAgICAgICAgLy8gU29ja2V0IOato+WcqOi/nuaOpVxuICBTb2NrZXRDb25uZWN0U3VjY2Vzc2VkOiBcIlNvY2tldENvbm5lY3RTdWNjZXNzZWRcIiwgLy8g6L+e5o6l5oiQ5YqfXG4gIFNvY2tldERpc2Nvbm5lY3Q6IFwiU29ja2V0RGlzY29ubmVjdFwiLCAgICAgICAgIC8vIFNvY2tldCDmlq3lvIDov57mjqVcbiAgU29ja2V0Q29ubmVjdEVycm9yOiBcIlNvY2tldENvbm5lY3RFcnJvclwiLCAgICAgLy8gU29ja2V0IOi/nuaOpemUmeivr1xuICBTb2NrZXRSZWNlaXZlTWVzc2FnZTogXCJTb2NrZXRSZWNlaXZlTWVzc2FnZVwiLCAvLyBTb2NrZXQg5o6l5pS25Yiw5raI5oGvXG5cbiAgSW52aXRlQ29kZTogXCJpbnZpdGVDb2RlXCIsICAgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAgIOmCgOivt+eggVxuICBKb2luRGVzazogXCJqb2luRGVza1wiLCAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIENyZWF0ZURlc2s6IFwiY3JlYXRlRGVza1wiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcbiAgTGVhdmVEZXNrOiBcImxlYXZlRGVza1wiLCAgICAgICAgICAgICAgIC8vIOemu+W8gOahjOWtkFxuICBEaXNzb2x2ZURlc2s6IFwiZGlzc29sdmVEZXNrXCIsICAgICAgICAgLy8g6Kej5pWj5qGM5a2QXG4gIEFuc3dlckRpc3NvbHZlOiBcImFuc3dlckRpc3NvbHZlXCIsICAgICAvLyDlm57nrZTor7fmsYLpgIDlh7rlkb3ku6RcbiAgR2V0RGVza0luZm86IFwiZ2V0RGVza0luZm9cIiwgICAgICAgICAgIC8vIOWuouaIt+err+WPkemAgVxuICBTZW5kSW1hZ2U6IFwic2VuZEltYWdlXCIsICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCBXG4gIFNlbmRUZXh0OiBcInNlbmRUZXh0XCIsICAgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIFcbiAgU2VuZEF1ZGlvTWVzc2FnZTogXCJzZW5kQXVkaW9NZXNzYWdlXCIsIC8vIOWuouaIt+err+WPkemAgSAg5Y+R6YCB6K+t6Z+z5raI5oGvXG4gIEdldFJlY29yZDogXCJnZXRSZWNvcmRcIiwgICAgICAgICAgICAgICAvLyDojrflj5bmiJjnu6nkv6Hmga9cbiAgR2V0SXRlbVJlY29yZDogXCJnZXRJdGVtUmVjb3JkXCIsICAgICAgIC8vIOiOt+WPluaImOe7qeS/oeaBr1xuICBQbGF5Q2FyZDogXCJwbGF5Q2FyZFwiLCAgICAgICAgICAgICAgICAgLy8g5a6i5oi356uv5Y+R6YCB77yM55So5oi35omT5Ye654mMXG4gIFRpbWVvdXREaXNzb2x2ZTogXCJ0aW1lb3V0RGlzc29sdmVcIiwgICAvLyDor7fmsYLpgIDlh7rotoXml7bml7bvvIzpnIDopoHlj5Hlh7rnmoTmtojmga9cbiAgRmVlZGJhY2s6IFwiZmVlZGJhY2tcIiwgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEgIOWPjemmiOS/oeaBr1xuICBTaGFyZVBuZzogXCJzaGFyZVBuZ1wiLCAgICAgICAgIC8vIOWuouaIt+err+WPkemAgSAg5YiG5Lqr6aKG5Y+W56CW55+zXG4gIEVudGVyUmFuZG9tOiBcImludGVyUmFuZG9tXCIsICAgLy8g5a6i5oi356uv5Y+R6YCBICDov5vlhaXpmo/mnLrlnLpcbiAgQ2FuY2VsUmFuZG9tOiBcImNhbmNlbFJhbmRvbVwiLCAvLyDlrqLmiLfnq6/lj5HpgIEgIOWPlua2iOi/m+WFpemaj+acuuWculxuICBGb3JjZUV4aXRSYW5kb206IFwiZGlzc29sdmVcIiwgIC8vIOWuouaIt+err+WPkemAgSDlvLrliLbpgIDlh7rpmo/mnLrlnLpcbiAgUmVhZHk6IFwicmVhZHlcIiwgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lj5HpgIEg5YeG5aSHXG4gIEdldEhhbGxJbmZvOiBcImdldEhhbGxJbmZvXCIsICAgLy8g5a6i5oi356uv5Y+R6YCBIOiOt+WPluWkp+WOheS/oeaBr1xuICBHZXRVc2VySW5mbzogXCJnZXRVc2VySW5mb1wiLCAgIC8vIOWuouaIt+err+WPkemAgSDojrflj5bnlKjmiLfkv6Hmga9cbiAgQ2hlY2tBY3Rpb246IFwiY2hlY2tBY3Rpb25cIiwgICAvLyDlrqLmiLfnq6/lj5HpgIHvvIznlKjmnaXmo4DmtYvkuI7mnI3liqHlmajnmoTov57pgJrmgKdcbiAgUGF1c2U6IFwicGF1c2VcIiwgICAgICAgICAgICAgICAvLyDlrqLmiLfnq6/ov5vlhaXlkI7lj7Dml7bopoHlj5HpgIHnmoTmtojmga9cbiAgQWN0aXZlOiBcImFjdGl2ZVwiLCAgICAgICAgICAgICAvLyDlrqLmiLfnq6/lm57liLDliY3lj7Dml7bopoHlj5HpgIHnmoTmtojmga9cblxuICBSZWNlaXZlUmVxdWVzdERpc3NvbHZlOiBcInJlcXVlc3REaXNzb2x2ZVwiLCAvLyDor7fmsYLop6PmlaPmoYzlrZAg5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVSZXF1ZXN0RGlzc29sdmVSZXN1bHQ6IFwicmVxdWVzdERpc3NvbHZlUmVzdWx0XCIsIC8vIOivt+axguino+aVo+ahjOWtkOe7k+aenFxuICBSZWNlaXZlQ2hhdFRleHQ6IFwic2VuZFRleHRcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVEZXNrSW5mbzogXCJkZXNrSW5mb1wiLCAvLyDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZUdhbWVPdmVyOiBcImdhbWVPdmVyXCIsIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlRmFQYWk6IFwiZmFwYWlcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVTaGFyZVBuZzogXCJzaGFyZVBuZ3NcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBXG4gIFJlY2VpdmVPbmxpbmVTdGF0dXM6IFwic2VuZE9ubGluZVN0YXR1c1wiLCAvLyDmnI3liqHlmajlj5HpgIFcbiAgUmVjZWl2ZUF1ZGlvTWVzc2FnZTogXCJzZW5kQXVkaW9NZXNzYWdlXCIsIC8vIOacjeWKoeWZqOWPkemAge+8jOaOpeaUtuWIsOeUqOaIt+WPkemAgeS6huivremfs+a2iOaBr1xuICBSZWNlaXZlUGxheUNhcmQ6IFwicGxheUNhcmRcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pyJ55So5oi35bey57uP5YeG5aSH5aW954mMXG4gIFJlY2VpdmVDcmVhdGVEZXNrOiBcImNyZWF0ZURlc2tcIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5Yib5bu65oi/6Ze055qE5Zue6LCDXG4gIFJlY2VpdmVSZWFkeTogXCJyZWFkeVwiLCAvLyDmnI3liqHlmajlj5HpgIHvvIzmnInnlKjmiLfngrnlh7vkuoblh4blpIdcbiAgUmVjZWl2ZUhhbGxJbmZvOiBcImdldEhhbGxJbmZvXCIsIC8vIOacjeWKoeWZqOWPkemAgVxuICBSZWNlaXZlR2V0VXNlckluZm86IFwiZ2V0VXNlckluZm9cIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBIOiOt+WPlueUqOaIt+S/oeaBr1xuICBSZWNlaXZlQ2hlY2tBY3Rpb246IFwiY2hlY2tBY3Rpb25cIiwgLy8g5pyN5Yqh5Zmo5Y+R6YCBICDnlKjmnaXnoa7orqQgU29ja2V0IOi/mOWcqOi/nuedgFxuICBSZWNlaXZlRm9yY2VFeGl0OiBcImZvcmNlRXhpdFwiLCAvLyDmnI3liqHlmajlj5HpgIEgIOeUqOadpeS9v+WuouaIt+err+W8uumAgFxuICBSZWNlaXZlRGlzc29sdmVEZXNrOiBcImRpc3NvbHZlRGVza1wiLCAvLyDmnI3liqHlmajlj5HpgIEgICDlvZPmiL/kuLvpgIDlh7rml7bvvIzop6PmlaPmoYzlrZBcbiAgUmVjZWl2ZUludGVyUmFuZG9tOiBcImludGVyUmFuZG9tXCIsICAgLy8g5pyN5Yqh5Zmo5Y+R6YCBICAg6L+b5YWl6ZqP5py65Zy655qE5Y+N6aaIXG4gIFJlY2VpdmVQYXVzZTogXCJwYXVzZVwiLCAgICAgICAgICAgICAgIC8vIOacjeWKoeWZqOWPkemAgSAgIOW9k+acieeUqOaIt+iuvuWkh+i/m+WFpeWQjuWPsOaXtu+8jOS8muaUtuWIsOi/meadoea2iOaBr1xuICBSZWNlaXZlSW52aXRlQ29kZTogJ2ludml0ZUNvZGUnLCAgICAgLy8g5pyN5Yqh5Zmo5Y+R6YCB77yM5pS25Yiw6YKA6K+356CB55qE5raI5oGvXG4gIC8qKi9cbiAgUmVjZWl2ZUxlYXZlRGVzazogJ2xlYXZlRGVzaycsIC8vIOacjeWKoeWZqOWPkemAge+8jOaUtuWIsOmcgOimgeemu+W8gOahjOWtkOeahOa2iOaBr1xuICAvKiovXG59O1xuXG4vLyBNQVJLOiBTb2NrZXQg5o+Q5L6b55qE5Y+v5Y+R57uZ5pyN5Yqh5Zmo5raI5oGv55qE5pa55rOVXG5cblNvY2tldC5zZW5kQ2hlY2tBY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkNoZWNrQWN0aW9uLCBudWxsKTtcbn07XG4vKiovXG5Tb2NrZXQuc2VuZERpZFJlY2VpdmVHYW1lT3ZlckFjdGlvbiA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY29uc3QgcGFyYW0gPSB1c2VySWQgPyB7XCJ1c2VySWRcIjogdXNlcklkfSA6IG51bGw7XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UoU29ja2V0LkV2ZW50LkRpZFJlY2VpdmVHYW1lT3ZlckFjdGlvbiwgcGFyYW0pO1xufTtcbi8qKi9cblxuXG4vKipcbiAqIOW9kyBBUFAg6L+b5YWl5ZCO5Y+w5pe26KaB5Y+R6YCB55qE5raI5oGvXG4gKi9cblNvY2tldC5zZW5kQXBwUGF1c2UgPSBmdW5jdGlvbih1c2VySWQpIHtcbiAgbGV0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuUGF1c2UsIHBhcmFtKTtcbn07XG5cbi8qKlxuICog5b2TIEFQUCDov5vlhaXliY3lj7Dml7blj5HpgIHnmoTmtojmga9cbiAqL1xuU29ja2V0LnNlbmRBcHBBY3RpdmUgPSBmdW5jdGlvbih1c2VySWQpIHtcbiAgbGV0IHBhcmFtID0gdXNlcklkID8ge1widXNlcklkXCI6IHVzZXJJZH0gOiBudWxsO1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQWN0aXZlLCBwYXJhbSk7XG59O1xuXG4vLyDlvIDmiL9cblNvY2tldC5zZW5kQ3JlYXRlRGVzayA9IGZ1bmN0aW9uIChjcmVhdGVEZXNjSW5mbywgdXNlcklkKSB7XG4gIGNjLmFzc2VydChjcmVhdGVEZXNjSW5mbyk7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuXG4gIGNyZWF0ZURlc2NJbmZvW1widXNlcklkXCJdID0gdXNlcklkO1xuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuQ3JlYXRlRGVzaywgY3JlYXRlRGVzY0luZm8pO1xufTtcblxuLy8g5Yqg5YWl5oi/6Ze0XG5Tb2NrZXQuc2VuZEpvaW5EZXNrID0gZnVuY3Rpb24gKHJvb21JZCwgdXNlcklkKSB7XG4gIGNjLmFzc2VydChyb29tSWQpO1xuICBjYy5hc3NlcnQodXNlcklkKTtcblxuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJyb29tSWRcIjogcm9vbUlkLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkpvaW5EZXNrLCBwYXJhbSk7XG59O1xuXG4vLyDlj5HpgIHpgoDor7fnoIFcblNvY2tldC5zZW5kSW52aXRlQ29kZSA9IGZ1bmN0aW9uKGludml0ZUNvZGUsdXNlcklkKXtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwiaW52aXRlQ29kZVwiOiBpbnZpdGVDb2RlLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50Lkludml0ZUNvZGUsIHBhcmFtKTtcbn07XG5cbi8vIOiOt+WPluaIv+mXtOS/oeaBr1xuU29ja2V0LnNlbmRHZXREZXNja0luZm8gPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXREZXNrSW5mbywgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRUZXh0ID0gZnVuY3Rpb24gKHVzZXJJZCwgdGV4dCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgY2MuYXNzZXJ0KHRleHQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJtc2dcIjogdGV4dCxcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5TZW5kVGV4dCwgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRBdWRpb01lc3NhZ2UgPSBmdW5jdGlvbiAodXNlcklkLCB1cmwgPSBcIlwiKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBjYy5hc3NlcnQodXJsLmxlbmd0aCA+IDApO1xuXG4gIGlmICh1cmwubGVuZ3RoID09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1cmxcIjogdXJsLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlNlbmRBdWRpb01lc3NhZ2UsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kSW1hZ2UgPSBmdW5jdGlvbiAodXNlcklkLCBpbWFnZSkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgY2MuYXNzZXJ0KGltYWdlKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwibXNnXCI6IGltYWdlLFxuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlNlbmRJbWFnZSwgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRHZXRSZWNyb2QgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5HZXRSZWNvcmQsIHBhcmFtKTtcbn07XG5cblNvY2tldC5zZW5kRGlzc29sdmVEZXNrID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkRpc3NvbHZlRGVzaywgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRHZXRJdGVtUmVjb3JkID0gZnVuY3Rpb24gKHVzZXJJZCwgcGFyZW50SWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGNjLmFzc2VydChwYXJlbnRJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgXCJwYXJlbnRJZFwiOiBwYXJlbnRJZCxcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuR2V0SXRlbVJlY29yZCwgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRMZWF2ZURlc2sgPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gICAgbGV0IHBhcmFtID0ge1xuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIH07XG5cbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuTGVhdmVEZXNrLCBwYXJhbSk7XG59LFxuXG4vKipcbiAqIOWbnuetlOmAgOaIv+ivt+axglxuICogXG4gKiBAcGFyYW0gIHtOdW1iZXJ9IHVzZXJJZCDlvZPliY3nlKjmiLcgaWRcbiAqIEBwYXJhbSAge05VbWJlcn0gYW5zd2VyPTEg5Zue562U44CCMSDooajnpLrlkIzmhI/vvJsgMCDooajnpLrmi5Lnu53vvJsgLTEg6KGo56S65pyq6YCJ5oupXG4gKi9cblNvY2tldC5zZW5kQW5zd2VyRGlzc29sdmUgPSBmdW5jdGlvbiAodXNlcklkLCBhbnN3ZXIgPSAwKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIFwiYW5zd2VyXCI6IGFuc3dlclxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5BbnN3ZXJEaXNzb2x2ZSwgcGFyYW0pO1xufSxcblxuICBTb2NrZXQuc2VuZEZvcmNlRXhpdFJvb20gPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gICAgbGV0IHBhcmFtID0ge1xuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIH07XG5cbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuRGlzc29sdmVEZXNrLCBwYXJhbSk7XG4gIH0sXG5cbiAgLy8g5Y2B5LiJ5byg5LitXG4gIC8vIGNhcmRJbmZvIOexu+S8vOS6ju+8mlxuICAvLyBbe1xuICAvLyAgICAgICAgICdjYXJkcyc6W3snc3VpdCc6c3VpdCwnbnVtYmVyJzpudW1iZXJ9LHt9XSwvL+eJueauiueJjOS4jeeUqOS8oFxuICAvLyAgICAgICAgICd0eXBlJzowLFxuICAvLyAgICAgICAgICd2YWx1ZSc6NCxcbiAgLy8gICAgICAgICAnaXNDb250YWluRXh0cmEnOnRydWUsLy8g54m55q6K54mM5piv5ZCm5YyF5ZCr54m55q6K54mMXG4gIC8vICAgICB9LFxuICAvLyAgICAge1xuICAvLyAgICAgICAgICdjYXJkcyc6W3snc3VpdCc6c3VpdCwnbnVtYmVyJzpudW1iZXJ9LHt9XSxcbiAgLy8gICAgICAgICAndHlwZSc6MCxcbiAgLy8gICAgICAgICAndmFsdWUnOjRcbiAgLy8gICAgIH1dXG5Tb2NrZXQuc2VuZFBsYXlDYXJkID0gZnVuY3Rpb24gKHVzZXJJZCwgY2FyZEluZm8pIHtcbiAgICBjYy5hc3NlcnQodXNlcklkKTtcbiAgICBsZXQgcGFyYW0gPSB7XG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgICBcImNhcmRcIjogY2FyZEluZm9cbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlBsYXlDYXJkLCBwYXJhbSk7XG59O1xuXG5Tb2NrZXQuc2VuZFRpbWVvdXREaXNzb2x2ZSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGxldCBwYXJhbSA9IHtcbiAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gIH07XG5cbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlRpbWVvdXREaXNzb2x2ZSwgcGFyYW0pO1xufTtcblxuU29ja2V0LnNlbmRGZWVkYmFjayA9IGZ1bmN0aW9uICh1c2VySWQsIHRleHQpIHtcbiAgY2MuYXNzZXJ0KHVzZXJJZCk7XG4gIGNjLmFzc2VydCh0ZXh0KTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICBcInRleHRcIjogdGV4dFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5GZWVkYmFjaywgcGFyYW0pO1xufVxuXG5Tb2NrZXQuc2VuZFNoYXJlUG5nID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcbiAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LlNoYXJlUG5nLCBwYXJhbSk7XG59O1xuLy8g5byA5aeL5Yy56YWN6ZqP5py65Zy6XG5Tb2NrZXQuc2VuZEVudGVyUmFuZG9tID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICBjYy5hc3NlcnQodXNlcklkKTtcbiAgbGV0IHBhcmFtID0ge1xuICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgfTtcblxuICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuRW50ZXJSYW5kb20sIHBhcmFtKTtcbn07XG5cbi8vIOWPlua2iOWMuemFjemaj+acuuWculxuU29ja2V0LnNlbmRDYW5jZWxSYW5kb20gPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gIGNjLmFzc2VydCh1c2VySWQpO1xuICBsZXQgcGFyYW0gPSB7XG4gICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICB9O1xuXG4gIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5DYW5jZWxSYW5kb20sIHBhcmFtKTtcbn07XG5cbi8vIOWHhuWkh1xuU29ja2V0LnNlbmRSZWFkeSA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICBjYy5hc3NlcnQodXNlcklkKTtcbiAgICBsZXQgcGFyYW0gPSB7XG4gICAgICBcInVzZXJJZFwiOiB1c2VySWQsXG4gICAgfTtcblxuICAgIHRoaXMuaW5zdGFuY2Uuc2VuZE1lc3NhZ2UodGhpcy5FdmVudC5SZWFkeSwgcGFyYW0pO1xuICB9LFxuXG4vLyDojrflj5blpKfljoXkv6Hmga9cblNvY2tldC5zZW5kR2V0SGFsbEluZm8gPSBmdW5jdGlvbiAodXNlcklkKSB7XG4gICAgbGV0IHBhcmFtID0ge1xuICAgICAgXCJ1c2VySWRcIjogdXNlcklkLFxuICAgIH07XG5cbiAgICB0aGlzLmluc3RhbmNlLnNlbmRNZXNzYWdlKHRoaXMuRXZlbnQuR2V0SGFsbEluZm8sIHBhcmFtKTtcbn0sXG5cbi8vIOiOt+WPlueUqOaIt+S/oeaBr1xuU29ja2V0LnNlbmRHZXRVc2VySW5mbyA9IGZ1bmN0aW9uICh1c2VySWQsIG9wZW5JZCkge1xuICAgIGxldCBwYXJhbSA9IHtcbiAgICAgIFwidXNlcklkXCI6IHVzZXJJZCxcbiAgICAgIFwib3BlbklkXCI6IG9wZW5JZCxcbiAgICB9O1xuXG4gICAgdGhpcy5pbnN0YW5jZS5zZW5kTWVzc2FnZSh0aGlzLkV2ZW50LkdldFVzZXJJbmZvLCBwYXJhbSk7XG59LFxuXG5tb2R1bGUuZXhwb3J0cyA9IFNvY2tldDsiLCJjb25zb2xlLmxvZygyPDIpIiwiY29uc3QgQXVkaW9NYW5hZ2VyID0gcmVxdWlyZSgnQXVkaW9NYW5hZ2VyJyk7XG5jb25zdCBQbGF5YmFjayA9IHJlcXVpcmUoJ1BsYXliYWNrJyk7XG5cbmNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNwcml0ZUF2YXRhcjogY2MuU3ByaXRlLFxuICAgICAgICBsYWJlbE5pY2tuYW1lOiBjYy5MYWJlbCxcbiAgICAgICAgbGFiZWxTY29yZTogY2MuTGFiZWwsXG4gICAgICAgIHNwcml0ZU9mZmxpbmU6IGNjLlNwcml0ZSxcbiAgICAgICAgdm9pY2VOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBob21lUnVuTm9kZTogY2MuTm9kZSxcbiAgICAgICAgcmVhZHlOb2RlOiBjYy5Ob2RlLFxuICAgICAgICBzaG9vdE5vZGVzOiBbY2MuTm9kZV0sXG4gICAgICAgIGJhbmtlck5vZGU6IGNjLk5vZGUsXG4gICAgICAgIGZhbmdaaHVOb2RlOiBjYy5Ob2RlLFxuICAgIH0sXG5cbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMudXBkYXRlU2NvcmUoKTtcbiAgICB9LFxuXG4gICAgc2V0UmVhZHlOb2RlVmlzaWJsZTogZnVuY3Rpb24gKHZpc2libGUgPSBmYWxzZSkge1xuICAgICAgdGhpcy5yZWFkeU5vZGUuYWN0aXZlID0gKHZpc2libGUgIT0gZmFsc2UpO1xuICAgIH0sXG5cbiAgICBzZXRGYW5nWmh1Tm9kZVZpc2libGU6IGZ1bmN0aW9uICh2aXNpYmxlID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5mYW5nWmh1Tm9kZS5hY3RpdmUgPSAodmlzaWJsZSAhPSBmYWxzZSk7XG4gICAgfSxcblxuICAgIHVwZGF0ZVNjb3JlOiBmdW5jdGlvbiAoc2NvcmUgPSAwKSB7XG4gICAgICAgIHRoaXMubGFiZWxTY29yZS5zdHJpbmcgPSBcIlwiICsgc2NvcmU7XG4gICAgfSxcblxuICAgIHVwZGF0ZU5pY2tuYW1lOiBmdW5jdGlvbihuaWNrbmFtZSA9IFwiXCIpIHtcbiAgICAgIHRoaXMubGFiZWxOaWNrbmFtZS5zdHJpbmcgPSBuaWNrbmFtZTtcbiAgICB9LFxuXG4gICAgdXBkYXRlQXZhdGFyOiBmdW5jdGlvbiAoYXZhdGFyKSB7XG4gICAgICBpZiAoYXZhdGFyLmVuZHNXaXRoKFwicG5nXCIpXG4gICAgICB8fCBhdmF0YXIuZW5kc1dpdGgoXCJqcGdcIilcbiAgICAgIHx8IGF2YXRhci5lbmRzV2l0aChcImdpZlwiKSkge1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhdmF0YXIgPSBhdmF0YXIgKyBcIi5wbmdcIjtcbiAgICAgIH1cblxuICAgICAgY2MubG9hZGVyLmxvYWQoYXZhdGFyLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZnJhbWUgPSBuZXcgY2MuU3ByaXRlRnJhbWUoZGF0YSk7XG4gICAgICAgIHRoaXMuc3ByaXRlQXZhdGFyLnNwcml0ZUZyYW1lID0gZnJhbWU7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sXG5cbiAgICBzZXRPZmZsaW5lVmlzaWJsZTogZnVuY3Rpb24gKHZpc2libGUgPSBmYWxzZSkge1xuICAgICAgaWYgKFBsYXliYWNrLmluc3RhbmNlLmlzUGxheWJhY2tpbmcoKSkge1xuICAgICAgICAvLyDlpoLmnpzmmK/lpITnkIblm57mlL7nirbmgIHvvIzlsLHkuI3nlKjlho3lpITnkIbnprvnur/mtojmga/kuoZcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNwcml0ZU9mZmxpbmUubm9kZS5hY3RpdmUgPSB2aXNpYmxlO1xuICAgIH0sXG5cbiAgICBzZXRJc0JhbmtlcjogZnVuY3Rpb24oaXNCYW5rZXIgPSBmYWxzZSkge1xuICAgICAgdGhpcy5iYW5rZXJOb2RlLmFjdGl2ZSA9IGlzQmFua2VyO1xuICAgIH0sXG5cbiAgICBwbGF5U2hvb3RBbmltYXRpb246IGZ1bmN0aW9uICh0b0luZGV4ID0gMCkge1xuICAgICAgbGV0IHNob290Tm9kZSA9IHRoaXMuc2hvb3ROb2Rlc1t0b0luZGV4XTtcbiAgICAgIHNob290Tm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgbGV0IGFuaW0gPSBzaG9vdE5vZGUuZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XG4gICAgICBhbmltLnBsYXkoJ3Nob290Jykub24oJ2ZpbmlzaGVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzaG9vdE5vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICB9LCB0aGlzKTtcblxuICAgICAgQXVkaW9NYW5hZ2VyLmluc3RhbmNlLnBsYXlEYVFpYW5nKCk7XG4gICAgfSxcblxuICAgIHBsYXlCdWxsZXRIb2xlQW5pbWF0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgYnVsbGV0SG9sZU5vZGUgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ2J1bGxldEhvbGUnKTtcbiAgICAgIGJ1bGxldEhvbGVOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICBsZXQgYW5pbSA9IGJ1bGxldEhvbGVOb2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgYW5pbS5wbGF5KCdidWxsZXRIb2xlJykub24oJ2ZpbmlzaGVkJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBidWxsZXRIb2xlTm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBwbGF5U3BlYWtBbmltYXRpb246IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMudm9pY2VOb2RlLmFjdGl2ZSA9IHRydWU7XG4gICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudm9pY2VOb2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfS5iaW5kKHRoaXMpLCA0KTtcbiAgICB9LFxuXG4gICAgLy8g5pKt5pS+5YWo5Z6S5omT5Yqo55S7XG4gICAgcGxheUhvbWVSdW5BaW1hdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGFsZXJ0ID0gdGhpcy5ob21lUnVuTm9kZS5nZXRDb21wb25lbnQoJ2FsZXJ0Jyk7XG4gICAgICBhbGVydC5hbGVydCgpO1xuICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmhvbWVSdW5Ob2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfS5iaW5kKHRoaXMpLCAyKTtcbiAgICB9LFxufSk7XG4iLCJjYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICB6aHVhbk51bUxhYmVsOmNjLkxhYmVsLFxuICAgICAgICBqdXNodTpjYy5Ob2RlLFxuICAgICAgICBBQTpjYy5Ob2RlLFxuICAgICAgICBfc2VsZWN0ZWRQZW9wbGVJbmRleDpudWxsLFxuICAgICAgICBfc2VsZWN0ZWRKdXNodUluZGV4Om51bGwsXG4gICAgICAgIF9zZWxlY3RlZEFBSW5kZXg6bnVsbFxuICAgIH0sXG5cbiAgICBvbkxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY3RybCgpO1xuICAgIH0sXG5cbiAgICBjbGlja1Blb3BsZUFjdGlvbjpmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fY3RybCgpO1xuICAgIH0sXG5cbiAgICBjbGlja0FBQWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2N0cmwoKTtcbiAgICB9LFxuXG4gICAgY2xpY2tKdXNodUFjdGlvbjpmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2N0cmwoKTtcbiAgICB9LFxuXG4gICAgIF9jdHJsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoXCJzaW5nbGVTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID0gdGhpcy5qdXNodS5nZXRDb21wb25lbnQoXCJzaW5nbGVTZWxlY3RcIikuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgdGhpcy5fc2VsZWN0ZWRBQUluZGV4ID0gdGhpcy5BQS5nZXRDb21wb25lbnQoXCJjaGVja1NlbGVjdFwiKS5zZWxlY3RlZEluZGV4O1xuICAgICAgICAvL+S6uuaVsOmAiTLkurrml7bkuJTmsqHpgInkuIpBQeWItuaUtui0uVxuICAgICAgICAgdmFyIHJlblNodSA9IDI7XG4gICAgICAgICBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDApe1xuICAgICAgICAgICAgIHJlblNodSA9IDI7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMSl7XG4gICAgICAgICAgICAgcmVuU2h1ID0gMztcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRQZW9wbGVJbmRleCA9PSAyKXtcbiAgICAgICAgICAgICByZW5TaHUgPSA0O1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZFBlb3BsZUluZGV4ID09IDMpe1xuICAgICAgICAgICAgIHJlblNodSA9IDU7XG4gICAgICAgICB9XG4gICAgICAgICB2YXIgemh1YW5nU2hpID0gMjA7XG4gICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gMjA7XG4gICAgICAgICB9XG4gICAgICAgICBlbHNlIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgICAgICB6aHVhbmdTaGkgPSA0MDtcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAgICAgIHpodWFuZ1NoaSA9IDgwO1xuICAgICAgICAgfVxuICAgICAgICAgZWxzZSBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMyl7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gMTA7XG4gICAgICAgICB9XG4gICAgICAgICAvL0FBXG4gICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEFBSW5kZXggIT0gbnVsbCl7XG4gICAgICAgICAgICAgemh1YW5nU2hpID0gTWF0aC5jZWlsKHpodWFuZ1NoaSAvIHJlblNodSk7XG4gICAgICAgICB9XG4gICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gemh1YW5nU2hpO1xuICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMCl7XG4gICAgICAgIC8vICAgIGlmKHRoaXMuX3NlbGVjdGVkQUFJbmRleCA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICAvL+WxgOaVsOmAiTEw5bGA5pe2XG4gICAgICAgICAgICAgICAgLy9pZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMCl7XG4gICAgICAgICAgICAgICAgLy8gICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMTBcIjtcbiAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAvLy8v5bGA5pWw6YCJMjDlsYDml7ZcbiAgICAgICAgICAgICAgICAvL2lmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAxKXtcbiAgICAgICAgICAgICAgICAvLyAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIzMFwiO1xuICAgICAgICAgICAgICAgIC8vfVxuICAgICAgICAgICAgICAgIC8vLy/lsYDmlbDpgIkzMOWxgOaXtlxuICAgICAgICAgICAgICAgIC8vaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDIpe1xuICAgICAgICAgICAgICAgIC8vICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjgwXCI7XG4gICAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAvL31cbiAgICAgICAgLy8gICAgZWxzZXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI4XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMTVcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyM1wiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vXG4gICAgICAgIC8vfVxuICAgICAgICAvL+S6uuaVsOmAiTPkurpcbiAgICAgICAgLy9lbHNlIGlmKHRoaXMuX3NlbGVjdGVkUGVvcGxlSW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgIC8v5rKh6YCJ5LiKQUHliLbmlLbotLlcbiAgICAgICAgLy8gICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ID09IG51bGwpe1xuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjIxXCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiNDJcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI2MFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vICAgIC8v6YCJ5LqGQUHmlLbotLlcbiAgICAgICAgLy8gICAgZWxzZXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI3XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMTRcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyMFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vXG4gICAgICAgIC8vfVxuICAgICAgICAvLy8v5Lq65pWw6YCJNOS6uuS4lOayoemAieS4ikFB5Yi25pS26LS5XG4gICAgICAgIC8vZWxzZXtcbiAgICAgICAgLy8gICAgaWYodGhpcy5fc2VsZWN0ZWRBQUluZGV4ID09IG51bGwpe1xuICAgICAgICAvLyAgICAgICAgLy/lsYDmlbDpgIkxMOWxgOaXtlxuICAgICAgICAvLyAgICAgICAgaWYodGhpcy5fc2VsZWN0ZWRKdXNodUluZGV4ID09IDApe1xuICAgICAgICAvLyAgICAgICAgICAgIHRoaXMuemh1YW5OdW1MYWJlbC5zdHJpbmcgPSBcIjI4XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiNTZcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI4NFwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vICAgIC8vQUHliLbmlLbotLnpgInkuIrkuoZcbiAgICAgICAgLy8gICAgZWxzZXtcbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMTDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAwKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCI3XCI7XG4gICAgICAgIC8vICAgICAgICB9XG4gICAgICAgIC8vICAgICAgICAvL+WxgOaVsOmAiTIw5bGA5pe2XG4gICAgICAgIC8vICAgICAgICBpZih0aGlzLl9zZWxlY3RlZEp1c2h1SW5kZXggPT0gMSl7XG4gICAgICAgIC8vICAgICAgICAgICAgdGhpcy56aHVhbk51bUxhYmVsLnN0cmluZyA9IFwiMTRcIjtcbiAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgLy8gICAgICAgIC8v5bGA5pWw6YCJMzDlsYDml7ZcbiAgICAgICAgLy8gICAgICAgIGlmKHRoaXMuX3NlbGVjdGVkSnVzaHVJbmRleCA9PSAyKXtcbiAgICAgICAgLy8gICAgICAgICAgICB0aGlzLnpodWFuTnVtTGFiZWwuc3RyaW5nID0gXCIyMVwiO1xuICAgICAgICAvLyAgICAgICAgfVxuICAgICAgICAvLyAgICB9XG4gICAgICAgIC8vfVxuICAgIH0sXG59KTtcbiJdfQ==